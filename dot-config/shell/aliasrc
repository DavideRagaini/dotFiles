#!/bin/sh

# Override GNU defaults
alias \
    bc="bc -l" \
    cp="cp -iv" \
    df="df -h" \
    du="du -h" \
    free="free -h" \
    ka="killall" \
    mkd="mkdir -pv" \
    mv="mv -iv" \
    rm="rm -vI" \
    rsync="rsync -uavhrP --info=progress2"
# unxz="unxz -v"

# Colorize commands
alias \
    ccat="bat --pager=never" \
    diff="diff --color=auto" \
    egrep='egrep --color=auto' \
    fgrep='fgrep --color=auto' \
    grep="grep --color=auto" \
    ip='ip -color=auto' \
    l='exa -l' \
    ll='exa -la'

# Abbreviations
alias \
    2f="tmux split -h lfcd; lfcd" \
    e="\$EDITOR" \
    E="\$VISUAL" \
    f="lfcd" \
    pw="pipe-viewer" \
    q="exit" \
    s="doas" \
    smi="doas make install" \
    v="nvim" \
    trr="transmission-remote" \
    udc="udisksctl" \
    x="sxiv -ft *" \
    xclip="xclip -selection clipboard" \
	yt="yt-dlp --embed-metadata -i" \
    zt="zathura"
# samedir="setsid -f $TERMINAL >/dev/null 2>&1" \
# trem="transmission-remote" \
# sudo="doas" \

# fuzzy find
# alias \
#     vfc="find \$HOME/.config/ -maxdepth 1 | fzf | xargs -r -I % \$EDITOR %" \
#     vfd="find \$HOME/.local/src/dotfiles/ | fzf | xargs -r -I % \$EDITOR %" \
#     vfs="find \$HOME/.local/bin/ | fzf | xargs -r -I % \$EDITOR %" \
#     vfz="find \$HOME/.config/zsh/ | fzf | xargs -r -I % \$EDITOR %"

fzfopen() {
    f="$(locate -i "$HOME/$1" | fzf)"
    xdg-open "$f"
}

# git
# alias \
    # g="git" \
    # ga="git add" \
    # gc="git commit -m" \
    # gd="git pull" \
    # gs="git status" \
    # gu="git push" \
    # scommitf="fzf --multi --ansi --preview='head -20 {+}' &&
	# 	git log --oneline |
	# 	fzf --multi --ansi --preview='git show {+1}'"
# gua="git remote | xargs -L1 git push --all"

gcl() {
    git clone "$(xclip -selection clipboard -o)"
}

alias pip='function _pip(){
    if [ $1 = "search" ]; then
        pip_search "$2";
    else pip "$@";
    fi;
};_pip'

pip_upgrade_all() {
    cd ~/.local/share/python/bin
    for i in *
    do
        pip install "$i" --upgrade
    done
    cd -
}

# xbps-install & upgrade
alias \
    xbi="doas xbps-install -S" \
    xu="doas xbps-install -Su"

sxi() {
    LIST="$(xbps-query -Rs "$1" | fzf | cut -d' ' -f2)"
    [ -z $LIST ] && return
    doas xbps-install -Sy $LIST
}

# xbps-query
alias \
    xq="xbps-query -Rs" \
    xgot="xbps-query -l | fzf"

sxq() {
    xbps-query -Rs "$1" | fzf
}

tso(){
    setsid -f "$(ts |
        awk -v n=6 '{ for (i=n; i<=NF; i++) printf "%s%s", $i, (i<NF ? OFS : ORS)}' |
        fzf |
        cut -d']' -f2)"
}

# xbps-remove
alias \
    xr="doas xbps-remove -R" \
    sxr="xbps-query -l | fzf | cut -d ' ' -f 2 | xargs -r -I % doas xbps-remove -Ry %"

# Miscellaneous
alias \
    cleanupdates="doas vkpurge rm all; xr -Ooy" \
    dwmrefresh="kill -HUP \$(pidof -s dwm)" \
    ffmpeg="ffmpeg -hide_banner" \
    ref="shortcuts >/dev/null; source \${XDG_CONFIG_HOME:-\$HOME/.config}/shell/shortcutrc ; source \${XDG_CONFIG_HOME:-\$HOME/.config}/shell/zshnameddirrc" \
    zsh-update-plugins="find "$ZDOTDIR/plugins" -type d -exec test -e '{}/.git' ';' -print0 | xargs -I {} -0 git -C {} pull -q"
# mpv="mpv --input-ipc-server=/tmp/mpvsoc$(date +%s)" \

[ -f "$XINITRC" ] && alias startx="startx \$XINITRC"

[ -x "$(command -v nvim)" ] && alias vim="nvim" vimdiff="nvim -d"
