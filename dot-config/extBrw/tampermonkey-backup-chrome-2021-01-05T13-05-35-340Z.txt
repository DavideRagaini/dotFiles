{"created_by":"Tampermonkey","version":"1","scripts":[{"name":"Youtube RSS feed URL","options":{"awareOfChrome":false,"check_for_updates":false,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://www.youtube.com/*","*://youtube.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609794402412,"data":{}},"enabled":false,"position":1,"uuid":"aa875a49-6eaf-4b9c-8eb0-c3f82ec456da","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBZb3V0dWJlIFJTUyBmZWVkIFVSTAovLyBAdmVyc2lvbiAgICAgIDAuMQovLyBAbWF0Y2ggICAgICAgKjovL3d3dy55b3V0dWJlLmNvbS8qCi8vIEBtYXRjaCAgICAgICAqOi8veW91dHViZS5jb20vKgovLyBAZGVzY3JpcHRpb24gIFJldHVybnMgeW91dHViZSBjaGFubmVsIFJTUyBVUkwKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICAndXNlIHN0cmljdCc7CiAgICBmb3IgKHZhciBhcnJTY3JpcHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpLCBpID0gMDsgaSA8IGFyclNjcmlwdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoYXJyU2NyaXB0c1tpXS50ZXh0Q29udGVudC5pbmRleE9mKCdjaGFubmVsSWQnKSAhPSAtMSkgewogICAgICAgICAgICB2YXIgY2hhbm5lbElkID0gYXJyU2NyaXB0c1tpXS50ZXh0Q29udGVudC5tYXRjaCgvXCJjaGFubmVsSWRcIlxzKlw6XHMqXCIoLio/KVwiLylbMV07CiAgICAgICAgICAgIHZhciBjaGFubmVsUnNzID0gJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2ZlZWRzL3ZpZGVvcy54bWw/Y2hhbm5lbF9pZD0nICsgY2hhbm5lbElkOwogICAgICAgICAgICB2YXIgY2hhbm5lbFRpdGxlID0gZG9jdW1lbnQudGl0bGUubWF0Y2goL1woP1xkKlwpP1xzPyguKj8pXHNcLVxzWW91VHViZS8pWzFdOwogICAgICAgICAgICBjb25zb2xlLmxvZygnVGhlIHJzcyBmZWVkIG9mIHRoZSBjaGFubmVsIFwnJyArIGNoYW5uZWxUaXRsZSArICdcJyBpczpcbicgKyBjaGFubmVsUnNzKTsKICAgICAgICAgICAgYWxlcnQoJ1RoZSByc3MgZmVlZCBvZiB0aGUgY2hhbm5lbCBcJycgKyBjaGFubmVsVGl0bGUgKyAnXCcgaXM6XG4nICsgY2hhbm5lbFJzcyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KfSkoKTs="},{"name":"YouTube RSS Feed","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://www.youtube.com/*","*://youtube.com/*"],"orig_noframes":null,"orig_run_at":"document-end","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609795387408,"data":{}},"enabled":true,"position":2,"file_url":"https://greasyfork.org/scripts/1760-youtube-rss-feed/code/YouTube%20RSS%20Feed.user.js","uuid":"b3181be7-93d5-44f0-b7a6-f9018852d59b","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFlvdVR1YmUgUlNTIEZlZWQKLy8gQG5hbWVzcGFjZSAgIGh0dHA6Ly9ncmVhc3lmb3JrLm9yZy91c2Vycy8yMjQwLWRvb2RsZXMKLy8gQGF1dGhvciAgICAgIERvb2RsZXMKLy8gQHZlcnNpb24gICAgIDE4Ci8vIEBkZXNjcmlwdGlvbiBBZGRzIGFuIFJTUyBmZWVkIGJ1dHRvbiB0byBZb3VUdWJlIGNoYW5uZWxzIG5leHQgdG8gdGhlIHN1YnNjcmliZSBidXR0b24KLy8gQGljb24gICAgICAgIGh0dHA6Ly9pLmltZ3VyLmNvbS9UeTVITmJULnBuZwovLyBAaWNvbjY0ICAgICAgaHR0cDovL2kuaW1ndXIuY29tLzFGZlZ2TnIucG5nCi8vIEBtYXRjaCAgICAgICAqOi8vd3d3LnlvdXR1YmUuY29tLyoKLy8gQG1hdGNoICAgICAgICo6Ly95b3V0dWJlLmNvbS8qCi8vIEBncmFudCAgICAgICBub25lCi8vIEBydW4tYXQgICAgICBkb2N1bWVudC1lbmQKLy8gQHJlcXVpcmUgICAgIGh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzMuMi4xL2pxdWVyeS5taW4uanMKLy8gPT0vVXNlclNjcmlwdD09Cgp0aGlzLiQgPSB0aGlzLmpRdWVyeSA9IGpRdWVyeS5ub0NvbmZsaWN0KHRydWUpOwoKJChmdW5jdGlvbiAoKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICBhZGRSc3NGZWVkU3VwcG9ydCh0cnVlKTsKICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigieXQtbmF2aWdhdGUtZmluaXNoIiwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgYWRkUnNzRmVlZFN1cHBvcnQoZmFsc2UpOwogICAgfSk7Cn0pOwoKZnVuY3Rpb24gYWRkUnNzRmVlZFN1cHBvcnQoZmlyc3RMb2FkKSB7CiAgICBpZiAoaXNQbGF5bGlzdFBhZ2UoKSkgewogICAgICAgIHdhaXRGb3JFbGVtZW50KCJvd25lci1jb250YWluZXIiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBwbGF5bGlzdEZlZWRMaW5rID0gZ2V0UGxheWxpc3RGZWVkKGdldFBsYXRsaXN0SWQoKSk7CiAgICAgICAgICAgIGFkZFJzc0xpbmsocGxheWxpc3RGZWVkTGluayk7CiAgICAgICAgICAgIGFkZFJzc0J1dHRvblBsYXlsaXN0KHBsYXlsaXN0RmVlZExpbmspOwogICAgICAgIH0sIDMzMCk7CiAgICB9IGVsc2UgaWYgKGlzVmlkZW9QYWdlKCkpIHsKICAgICAgICB3YWl0Rm9yRWxlbWVudCgidXBsb2FkLWluZm8iLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBjaGFubmVsRmVlZExpbmsgPSBnZXRDaGFubmVsRmVlZChnZXRDaGFubmVsSWRGcm9tVmlkZW9QYWdlKCkpOwogICAgICAgICAgICByZW1vdmVSc3NMaW5rKCk7CiAgICAgICAgICAgIGFkZFJzc0xpbmsoY2hhbm5lbEZlZWRMaW5rKTsKICAgICAgICAgICAgYWRkUnNzQnV0dG9uKGNoYW5uZWxGZWVkTGluayk7CiAgICAgICAgfSwgMzMwKTsKICAgIH0gZWxzZSBpZiAoaXNDaGFubmVsUGFnZSgpKSB7CiAgICAgICAgd2FpdEZvckVsZW1lbnQoInN1YnNjcmliZS1idXR0b24iLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBjaGFubmVsSWQgPSBnZXRDaGFubmVsSWRGcm9tQ2hhbm5lbFBhZ2UoZmlyc3RMb2FkKTsKICAgICAgICAgICAgaWYgKGNoYW5uZWxJZCA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIHJlbW92ZVJzc0xpbmsoKTsKICAgICAgICAgICAgICAgIGFkZFJlZnJlc2hCdXR0b24oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHZhciBjaGFubmVsRmVlZExpbmsgPSBnZXRDaGFubmVsRmVlZChjaGFubmVsSWQpOwogICAgICAgICAgICAgICAgcmVtb3ZlUnNzTGluaygpOwogICAgICAgICAgICAgICAgYWRkUnNzTGluayhjaGFubmVsRmVlZExpbmspOwogICAgICAgICAgICAgICAgYWRkUnNzQnV0dG9uKGNoYW5uZWxGZWVkTGluayk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzMzApOwogICAgfQp9CgpmdW5jdGlvbiBpc1BsYXlsaXN0UGFnZSgpIHsKICAgIHJldHVybiBkb2N1bWVudC5VUkwuaW5kZXhPZigiL3BsYXlsaXN0P2xpc3Q9IikgIT09IC0xOwp9CgpmdW5jdGlvbiBpc1ZpZGVvUGFnZSgpIHsKICAgIHJldHVybiBkb2N1bWVudC5VUkwuaW5kZXhPZigiL3dhdGNoIikgIT09IC0xICYmIGRvY3VtZW50LlVSTC5pbmRleE9mKCJ2PSIpICE9PSAtMTsKfQoKZnVuY3Rpb24gaXNDaGFubmVsUGFnZSgpIHsKICAgIHJldHVybiAkKCIjY2hhbm5lbC1oZWFkZXIiKS5sZW5ndGggPiAwOwp9CgpmdW5jdGlvbiBnZXRQbGF0bGlzdElkKCkgewogICAgdmFyIHBsYXlsaXN0SWQgPSBkb2N1bWVudC5VUkwuc3BsaXQoImxpc3Q9IilbMV0uc3BsaXQoIiYiKVswXTsKICAgIGlmICghcGxheWxpc3RJZC5zdGFydHNXaXRoKCJQTCIpKSB7CiAgICAgICAgcGxheWxpc3RJZCA9ICJQTCIgKyBwbGF5bGlzdElkOwogICAgfQogICAgcmV0dXJuIHBsYXlsaXN0SWQ7Cn0KCmZ1bmN0aW9uIGdldENoYW5uZWxJZEZyb21WaWRlb1BhZ2UoKSB7CiAgICByZXR1cm4gJCgiI3VwbG9hZC1pbmZvIGFbaHJlZio9Jy9jaGFubmVsLyddOmZpcnN0IikuYXR0cigiaHJlZiIpLnNwbGl0KCIvY2hhbm5lbC8iKVsxXTsKfQoKZnVuY3Rpb24gZ2V0Q2hhbm5lbElkRnJvbUNoYW5uZWxQYWdlKGZpcnN0TG9hZCkgewogICAgaWYgKGRvY3VtZW50LlVSTC5pbmRleE9mKCIvY2hhbm5lbC8iKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gZG9jdW1lbnQuVVJMLnNwbGl0KCIvY2hhbm5lbC8iKVsxXS5zcGxpdCgiLyIpWzBdLnNwbGl0KCI/IilbMF07CiAgICB9IGVsc2UgaWYgKGZpcnN0TG9hZCkgewogICAgICAgIHJldHVybiAkKCJtZXRhW3Byb3BlcnR5PSdvZzp1cmwnXSIpLmF0dHIoImNvbnRlbnQiKS5zcGxpdCgiL2NoYW5uZWwvIilbMV07CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfQoKZnVuY3Rpb24gZ2V0Q2hhbm5lbEZlZWQoY2hhbm5lbElkKSB7CiAgICByZXR1cm4gImh0dHA6Ly93d3cueW91dHViZS5jb20vZmVlZHMvdmlkZW9zLnhtbD9jaGFubmVsX2lkPSIgKyBjaGFubmVsSWQ7Cn0KCmZ1bmN0aW9uIGdldFBsYXlsaXN0RmVlZChwbGF5bGlzdElkKSB7CiAgICByZXR1cm4gImh0dHA6Ly93d3cueW91dHViZS5jb20vZmVlZHMvdmlkZW9zLnhtbD9wbGF5bGlzdF9pZD0iICsgcGxheWxpc3RJZDsKfQoKZnVuY3Rpb24gYWRkUnNzTGluayhsaW5rKSB7CiAgICAkKCJoZWFkIikuYXBwZW5kKCc8bGluayByZWw9ImFsdGVybmF0ZSIgdHlwZT0iYXBwbGljYXRpb24vcnNzK3htbCIgdGl0bGU9IlJTUyIgaHJlZj0iJyArCiAgICAgICAgICAgIGxpbmsgKyAnIiAvPicpOwp9CgpmdW5jdGlvbiByZW1vdmVSc3NMaW5rKCkgewogICAgaWYgKCQoImxpbmtbdHlwZT0nYXBwbGljYXRpb24vcnNzK3htbCddIikubGVuZ3RoID4gMCkgewogICAgICAgICQoImxpbmtbdHlwZT0nYXBwbGljYXRpb24vcnNzK3htbCddIikucmVtb3ZlKCk7CiAgICB9Cn0KCmZ1bmN0aW9uIHdhaXRGb3JFbGVtZW50KGVsZW1lbnRJZCwgY2FsbGJhY2tGdW5jdGlvbiwgaW50ZXJ2YWxMZW5ndGggPSAzMzApIHsKICAgIHZhciB3YWl0Q291bnQgPSAxNTAwMCAvIGludGVydmFsTGVuZ3RoOyAvLyB3YWl0IDE1IHNlY29uZHMgbWF4aW11bQogICAgdmFyIHdhaXQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgd2FpdENvdW50LS07CiAgICAgICAgaWYgKCQoIiMiICsgZWxlbWVudElkKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNhbGxiYWNrRnVuY3Rpb24oKTsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh3YWl0KTsKICAgICAgICB9IGVsc2UgaWYgKHdhaXRDb3VudCA8PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJZb3VUdWJlIFJTUyBGZWVkIFVzZXJTY3JpcHQgLSB3YWl0IGZvciBlbGVtZW50IFwiIyIgKyBlbGVtZW50SWQgKyAKICAgICAgICAgICAgICAgICAgICAiXCIgZmFpbGVkISBUaW1lIGxpbWl0ICgxNSBzZWNvbmRzKSBleGNlZWRlZC4iKTsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh3YWl0KTsKICAgICAgICB9CiAgICB9LCBpbnRlcnZhbExlbmd0aCk7Cn0KCmZ1bmN0aW9uIGFkZFJzc0J1dHRvbihsaW5rKSB7CiAgICBpZiAoJCgiI3Jzc1N1YkJ1dHRvbiIpLmxlbmd0aCA+IDApIHsKICAgICAgICAkKCIjcnNzU3ViQnV0dG9uIikucmVtb3ZlKCk7CiAgICB9CiAgICAkKCIjc3Vic2NyaWJlLWJ1dHRvbiIpCiAgICAgICAgICAgIC5jc3MoewogICAgICAgICAgICAgICAgImRpc3BsYXkiOiAiZmxleCIsCiAgICAgICAgICAgICAgICAiZmxleC1mbG93IjogIm5vd3JhcCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIjM3cHgiCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5wcmVwZW5kKG1ha2VSc3NCdXR0b24obGluaykpOwp9CgpmdW5jdGlvbiBhZGRSc3NCdXR0b25QbGF5bGlzdChsaW5rKSB7CiAgICBpZiAoJCgiI3Jzc1N1YkJ1dHRvbiIpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICQoIiNvd25lci1jb250YWluZXIgPiAjYnV0dG9uIikKICAgICAgICAgICAgICAgIC5jc3MoewogICAgICAgICAgICAgICAgICAgICJkaXNwbGF5IjogImZsZXgiLAogICAgICAgICAgICAgICAgICAgICJmbGV4LWZsb3ciOiAibm93cmFwIiwKICAgICAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIjM3cHgiCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnByZXBlbmQobWFrZVJzc0J1dHRvbihsaW5rKSk7CiAgICB9Cn0KCmZ1bmN0aW9uIG1ha2VSc3NCdXR0b24obGluaykgewogICAgcmV0dXJuICQoIjxhPlJTUzwvYT4iKQogICAgICAgICAgICAuYXR0cigiaWQiLCAicnNzU3ViQnV0dG9uIikKICAgICAgICAgICAgLmF0dHIoInRhcmdldCIsICJfYmxhbmsiKQogICAgICAgICAgICAuYXR0cigiaHJlZiIsIGxpbmspCiAgICAgICAgICAgIC5jc3MoewogICAgICAgICAgICAgICAgImJhY2tncm91bmQtY29sb3IiOiAiI2ZkOWIxMiIsCiAgICAgICAgICAgICAgICAiYm9yZGVyLXJhZGl1cyI6ICIzcHgiLAogICAgICAgICAgICAgICAgInBhZGRpbmciOiAiMTBweCAxNnB4IiwKICAgICAgICAgICAgICAgICJjb2xvciI6ICIjZmZmZmZmIiwKICAgICAgICAgICAgICAgICJmb250LXNpemUiOiAiMTRweCIsCiAgICAgICAgICAgICAgICAidGV4dC1kZWNvcmF0aW9uIjogIm5vbmUiLAogICAgICAgICAgICAgICAgInRleHQtdHJhbnNmb3JtIjogInVwcGVyY2FzZSIsCiAgICAgICAgICAgICAgICAibWFyZ2luLXJpZ2h0IjogIjVweCIKICAgICAgICAgICAgfSk7Cn0KCmZ1bmN0aW9uIGFkZFJlZnJlc2hCdXR0b24oKSB7CiAgICB2YXIgcmVmcmVzaEJ1dHRvbiA9ICQoIjxhPlJlZnJlc2g8L2E+IikKICAgICAgICAgICAgLmF0dHIoImlkIiwgInJzc1N1YkJ1dHRvbiIpCiAgICAgICAgICAgIC5hdHRyKCJocmVmIiwgIiMiKQogICAgICAgICAgICAuY3NzKHsKICAgICAgICAgICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yIjogIiNmZDliMTIiLAogICAgICAgICAgICAgICAgImJvcmRlci1yYWRpdXMiOiAiM3B4IiwKICAgICAgICAgICAgICAgICJwYWRkaW5nIjogIjEwcHggMTZweCIsCiAgICAgICAgICAgICAgICAiY29sb3IiOiAiI2ZmZmZmZiIsCiAgICAgICAgICAgICAgICAiZm9udC1zaXplIjogIjE0cHgiLAogICAgICAgICAgICAgICAgInRleHQtZGVjb3JhdGlvbiI6ICJub25lIiwKICAgICAgICAgICAgICAgICJ0ZXh0LXRyYW5zZm9ybSI6ICJ1cHBlcmNhc2UiLAogICAgICAgICAgICAgICAgIm1hcmdpbi1yaWdodCI6ICI1cHgiCiAgICAgICAgICAgIH0pOwogICAgJChyZWZyZXNoQnV0dG9uKS5jbGljayhmdW5jdGlvbiAoZSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB2YXIgciA9IGNvbmZpcm0oIkR1ZSB0byBob3cgWW91VHViZSBsb2FkIHBhZ2VzLCB0aGVyZSBpc24ndCBhIHJlbGlhYmxlIHdheSB0byBnZXQgY2hhbm5lbCIgKyAKICAgICAgICAgICAgICAgICIgSURzIGZyb20gY2hhbm5lbCBwYWdlcyBpZiB5b3UndmUgbmF2aWdhdGVkIHRvIHRoZW0gZnJvbSBhbm90aGVyIFlvdVR1YmUgcGFnZS4iICsgCiAgICAgICAgICAgICAgICAiIFRoZSBzb2x1dGlvbiBpcyB0byByZWxvYWQgdGhlIHBhZ2UuXG5cbldvdWxkIHlvdSBsaWtlIHRvIHJlbG9hZCB0aGUgcGFnZT8iKTsKICAgICAgICBpZiAociA9PT0gdHJ1ZSkgewogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgfQogICAgfSk7CiAgICBpZiAoJCgiI3Jzc1N1YkJ1dHRvbiIpLmxlbmd0aCA+IDApIHsKICAgICAgICAkKCIjcnNzU3ViQnV0dG9uIikucmVtb3ZlKCk7CiAgICB9CiAgICAkKCIjc3Vic2NyaWJlLWJ1dHRvbiIpCiAgICAgICAgICAgIC5jc3MoewogICAgICAgICAgICAgICAgImRpc3BsYXkiOiAiZmxleCIsCiAgICAgICAgICAgICAgICAiZmxleC1mbG93IjogIm5vd3JhcCIsCiAgICAgICAgICAgICAgICAiaGVpZ2h0IjogIjM3cHgiCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5wcmVwZW5kKHJlZnJlc2hCdXR0b24pOwp9","requires":[{"meta":{"name":"jquery.min.js","url":"https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js","ts":1609795387839,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2My4yLjEgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovCiFmdW5jdGlvbihhLGIpeyJ1c2Ugc3RyaWN0Ijsib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmIm9iamVjdCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1hLmRvY3VtZW50P2IoYSwhMCk6ZnVuY3Rpb24oYSl7aWYoIWEuZG9jdW1lbnQpdGhyb3cgbmV3IEVycm9yKCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50Iik7cmV0dXJuIGIoYSl9OmIoYSl9KCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp0aGlzLGZ1bmN0aW9uKGEsYil7InVzZSBzdHJpY3QiO3ZhciBjPVtdLGQ9YS5kb2N1bWVudCxlPU9iamVjdC5nZXRQcm90b3R5cGVPZixmPWMuc2xpY2UsZz1jLmNvbmNhdCxoPWMucHVzaCxpPWMuaW5kZXhPZixqPXt9LGs9ai50b1N0cmluZyxsPWouaGFzT3duUHJvcGVydHksbT1sLnRvU3RyaW5nLG49bS5jYWxsKE9iamVjdCksbz17fTtmdW5jdGlvbiBwKGEsYil7Yj1ifHxkO3ZhciBjPWIuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7Yy50ZXh0PWEsYi5oZWFkLmFwcGVuZENoaWxkKGMpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYyl9dmFyIHE9IjMuMi4xIixyPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyByLmZuLmluaXQoYSxiKX0scz0vXltcc1x1RkVGRlx4QTBdK3xbXHNcdUZFRkZceEEwXSskL2csdD0vXi1tcy0vLHU9Ly0oW2Etel0pL2csdj1mdW5jdGlvbihhLGIpe3JldHVybiBiLnRvVXBwZXJDYXNlKCl9O3IuZm49ci5wcm90b3R5cGU9e2pxdWVyeTpxLGNvbnN0cnVjdG9yOnIsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBmLmNhbGwodGhpcyl9LGdldDpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT9mLmNhbGwodGhpcyk6YTwwP3RoaXNbYSt0aGlzLmxlbmd0aF06dGhpc1thXX0scHVzaFN0YWNrOmZ1bmN0aW9uKGEpe3ZhciBiPXIubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGEpO3JldHVybiBiLnByZXZPYmplY3Q9dGhpcyxifSxlYWNoOmZ1bmN0aW9uKGEpe3JldHVybiByLmVhY2godGhpcyxhKX0sbWFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhyLm1hcCh0aGlzLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEuY2FsbChiLGMsYil9KSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGYuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXE6ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5sZW5ndGgsYz0rYSsoYTwwP2I6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGM+PTAmJmM8Yj9bdGhpc1tjXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKCl9LHB1c2g6aCxzb3J0OmMuc29ydCxzcGxpY2U6Yy5zcGxpY2V9LHIuZXh0ZW5kPXIuZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGEsYixjLGQsZSxmLGc9YXJndW1lbnRzWzBdfHx7fSxoPTEsaT1hcmd1bWVudHMubGVuZ3RoLGo9ITE7Zm9yKCJib29sZWFuIj09dHlwZW9mIGcmJihqPWcsZz1hcmd1bWVudHNbaF18fHt9LGgrKyksIm9iamVjdCI9PXR5cGVvZiBnfHxyLmlzRnVuY3Rpb24oZyl8fChnPXt9KSxoPT09aSYmKGc9dGhpcyxoLS0pO2g8aTtoKyspaWYobnVsbCE9KGE9YXJndW1lbnRzW2hdKSlmb3IoYiBpbiBhKWM9Z1tiXSxkPWFbYl0sZyE9PWQmJihqJiZkJiYoci5pc1BsYWluT2JqZWN0KGQpfHwoZT1BcnJheS5pc0FycmF5KGQpKSk/KGU/KGU9ITEsZj1jJiZBcnJheS5pc0FycmF5KGMpP2M6W10pOmY9YyYmci5pc1BsYWluT2JqZWN0KGMpP2M6e30sZ1tiXT1yLmV4dGVuZChqLGYsZCkpOnZvaWQgMCE9PWQmJihnW2JdPWQpKTtyZXR1cm4gZ30sci5leHRlbmQoe2V4cGFuZG86ImpRdWVyeSIrKHErTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywiIiksaXNSZWFkeTohMCxlcnJvcjpmdW5jdGlvbihhKXt0aHJvdyBuZXcgRXJyb3IoYSl9LG5vb3A6ZnVuY3Rpb24oKXt9LGlzRnVuY3Rpb246ZnVuY3Rpb24oYSl7cmV0dXJuImZ1bmN0aW9uIj09PXIudHlwZShhKX0saXNXaW5kb3c6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGwhPWEmJmE9PT1hLndpbmRvd30saXNOdW1lcmljOmZ1bmN0aW9uKGEpe3ZhciBiPXIudHlwZShhKTtyZXR1cm4oIm51bWJlciI9PT1ifHwic3RyaW5nIj09PWIpJiYhaXNOYU4oYS1wYXJzZUZsb2F0KGEpKX0saXNQbGFpbk9iamVjdDpmdW5jdGlvbihhKXt2YXIgYixjO3JldHVybiEoIWF8fCJbb2JqZWN0IE9iamVjdF0iIT09ay5jYWxsKGEpKSYmKCEoYj1lKGEpKXx8KGM9bC5jYWxsKGIsImNvbnN0cnVjdG9yIikmJmIuY29uc3RydWN0b3IsImZ1bmN0aW9uIj09dHlwZW9mIGMmJm0uY2FsbChjKT09PW4pKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXt2YXIgYjtmb3IoYiBpbiBhKXJldHVybiExO3JldHVybiEwfSx0eXBlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hP2ErIiI6Im9iamVjdCI9PXR5cGVvZiBhfHwiZnVuY3Rpb24iPT10eXBlb2YgYT9qW2suY2FsbChhKV18fCJvYmplY3QiOnR5cGVvZiBhfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGEpe3AoYSl9LGNhbWVsQ2FzZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5yZXBsYWNlKHQsIm1zLSIpLnJlcGxhY2UodSx2KX0sZWFjaDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MDtpZih3KGEpKXtmb3IoYz1hLmxlbmd0aDtkPGM7ZCsrKWlmKGIuY2FsbChhW2RdLGQsYVtkXSk9PT0hMSlicmVha31lbHNlIGZvcihkIGluIGEpaWYoYi5jYWxsKGFbZF0sZCxhW2RdKT09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hPyIiOihhKyIiKS5yZXBsYWNlKHMsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbXTtyZXR1cm4gbnVsbCE9YSYmKHcoT2JqZWN0KGEpKT9yLm1lcmdlKGMsInN0cmluZyI9PXR5cGVvZiBhP1thXTphKTpoLmNhbGwoYyxhKSksY30saW5BcnJheTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/LTE6aS5jYWxsKGIsYSxjKX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9K2IubGVuZ3RoLGQ9MCxlPWEubGVuZ3RoO2Q8YztkKyspYVtlKytdPWJbZF07cmV0dXJuIGEubGVuZ3RoPWUsYX0sZ3JlcDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkLGU9W10sZj0wLGc9YS5sZW5ndGgsaD0hYztmPGc7ZisrKWQ9IWIoYVtmXSxmKSxkIT09aCYmZS5wdXNoKGFbZl0pO3JldHVybiBlfSxtYXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj0wLGg9W107aWYodyhhKSlmb3IoZD1hLmxlbmd0aDtmPGQ7ZisrKWU9YihhW2ZdLGYsYyksbnVsbCE9ZSYmaC5wdXNoKGUpO2Vsc2UgZm9yKGYgaW4gYSllPWIoYVtmXSxmLGMpLG51bGwhPWUmJmgucHVzaChlKTtyZXR1cm4gZy5hcHBseShbXSxoKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlO2lmKCJzdHJpbmciPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxyLmlzRnVuY3Rpb24oYSkpcmV0dXJuIGQ9Zi5jYWxsKGFyZ3VtZW50cywyKSxlPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxkLmNvbmNhdChmLmNhbGwoYXJndW1lbnRzKSkpfSxlLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8ci5ndWlkKyssZX0sbm93OkRhdGUubm93LHN1cHBvcnQ6b30pLCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihyLmZuW1N5bWJvbC5pdGVyYXRvcl09Y1tTeW1ib2wuaXRlcmF0b3JdKSxyLmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7alsiW29iamVjdCAiK2IrIl0iXT1iLnRvTG93ZXJDYXNlKCl9KTtmdW5jdGlvbiB3KGEpe3ZhciBiPSEhYSYmImxlbmd0aCJpbiBhJiZhLmxlbmd0aCxjPXIudHlwZShhKTtyZXR1cm4iZnVuY3Rpb24iIT09YyYmIXIuaXNXaW5kb3coYSkmJigiYXJyYXkiPT09Y3x8MD09PWJ8fCJudW1iZXIiPT10eXBlb2YgYiYmYj4wJiZiLTEgaW4gYSl9dmFyIHg9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaSxqLGssbCxtLG4sbyxwLHEscixzLHQsdT0ic2l6emxlIisxKm5ldyBEYXRlLHY9YS5kb2N1bWVudCx3PTAseD0wLHk9aGEoKSx6PWhhKCksQT1oYSgpLEI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWImJihsPSEwKSwwfSxDPXt9Lmhhc093blByb3BlcnR5LEQ9W10sRT1ELnBvcCxGPUQucHVzaCxHPUQucHVzaCxIPUQuc2xpY2UsST1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylpZihhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sSj0iY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLEs9IltcXHgyMFxcdFxcclxcblxcZl0iLEw9Iig/OlxcXFwufFtcXHctXXxbXlwwLVxceGEwXSkrIixNPSJcXFsiK0srIiooIitMKyIpKD86IitLKyIqKFsqXiR8IX5dPz0pIitLKyIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIrTCsiKSl8KSIrSysiKlxcXSIsTj0iOigiK0wrIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK00rIikqKXwuKilcXCl8KSIsTz1uZXcgUmVnRXhwKEsrIisiLCJnIiksUD1uZXcgUmVnRXhwKCJeIitLKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK0srIiskIiwiZyIpLFE9bmV3IFJlZ0V4cCgiXiIrSysiKiwiK0srIioiKSxSPW5ldyBSZWdFeHAoIl4iK0srIiooWz4rfl18IitLKyIpIitLKyIqIiksUz1uZXcgUmVnRXhwKCI9IitLKyIqKFteXFxdJ1wiXSo/KSIrSysiKlxcXSIsImciKSxUPW5ldyBSZWdFeHAoTiksVT1uZXcgUmVnRXhwKCJeIitMKyIkIiksVj17SUQ6bmV3IFJlZ0V4cCgiXiMoIitMKyIpIiksQ0xBU1M6bmV3IFJlZ0V4cCgiXlxcLigiK0wrIikiKSxUQUc6bmV3IFJlZ0V4cCgiXigiK0wrInxbKl0pIiksQVRUUjpuZXcgUmVnRXhwKCJeIitNKSxQU0VVRE86bmV3IFJlZ0V4cCgiXiIrTiksQ0hJTEQ6bmV3IFJlZ0V4cCgiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFwoIitLKyIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIitLKyIqKD86KFsrLV18KSIrSysiKihcXGQrKXwpKSIrSysiKlxcKXwpIiwiaSIpLGJvb2w6bmV3IFJlZ0V4cCgiXig/OiIrSisiKSQiLCJpIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoIl4iK0srIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrSysiKigoPzotXFxkKT9cXGQqKSIrSysiKlxcKXwpKD89W14tXXwkKSIsImkiKX0sVz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFg9L15oXGQkL2ksWT0vXltee10rXHtccypcW25hdGl2ZSBcdy8sWj0vXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLCQ9L1srfl0vLF89bmV3IFJlZ0V4cCgiXFxcXChbXFxkYS1mXXsxLDZ9IitLKyI/fCgiK0srIil8LikiLCJpZyIpLGFhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0iMHgiK2ItNjU1MzY7cmV0dXJuIGQhPT1kfHxjP2I6ZDwwP1N0cmluZy5mcm9tQ2hhckNvZGUoZCs2NTUzNik6U3RyaW5nLmZyb21DaGFyQ29kZShkPj4xMHw1NTI5NiwxMDIzJmR8NTYzMjApfSxiYT0vKFtcMC1ceDFmXHg3Zl18Xi0/XGQpfF4tJHxbXlwwLVx4MWZceDdmLVx1RkZGRlx3LV0vZyxjYT1mdW5jdGlvbihhLGIpe3JldHVybiBiPyJcMCI9PT1hPyJcdWZmZmQiOmEuc2xpY2UoMCwtMSkrIlxcIithLmNoYXJDb2RlQXQoYS5sZW5ndGgtMSkudG9TdHJpbmcoMTYpKyIgIjoiXFwiK2F9LGRhPWZ1bmN0aW9uKCl7bSgpfSxlYT10YShmdW5jdGlvbihhKXtyZXR1cm4gYS5kaXNhYmxlZD09PSEwJiYoImZvcm0iaW4gYXx8ImxhYmVsImluIGEpfSx7ZGlyOiJwYXJlbnROb2RlIixuZXh0OiJsZWdlbmQifSk7dHJ5e0cuYXBwbHkoRD1ILmNhbGwodi5jaGlsZE5vZGVzKSx2LmNoaWxkTm9kZXMpLERbdi5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZmEpe0c9e2FwcGx5OkQubGVuZ3RoP2Z1bmN0aW9uKGEsYil7Ri5hcHBseShhLEguY2FsbChiKSl9OmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5sZW5ndGgsZD0wO3doaWxlKGFbYysrXT1iW2QrK10pO2EubGVuZ3RoPWMtMX19fWZ1bmN0aW9uIGdhKGEsYixkLGUpe3ZhciBmLGgsaixrLGwsbyxyLHM9YiYmYi5vd25lckRvY3VtZW50LHc9Yj9iLm5vZGVUeXBlOjk7aWYoZD1kfHxbXSwic3RyaW5nIiE9dHlwZW9mIGF8fCFhfHwxIT09dyYmOSE9PXcmJjExIT09dylyZXR1cm4gZDtpZighZSYmKChiP2Iub3duZXJEb2N1bWVudHx8Yjp2KSE9PW4mJm0oYiksYj1ifHxuLHApKXtpZigxMSE9PXcmJihsPVouZXhlYyhhKSkpaWYoZj1sWzFdKXtpZig5PT09dyl7aWYoIShqPWIuZ2V0RWxlbWVudEJ5SWQoZikpKXJldHVybiBkO2lmKGouaWQ9PT1mKXJldHVybiBkLnB1c2goaiksZH1lbHNlIGlmKHMmJihqPXMuZ2V0RWxlbWVudEJ5SWQoZikpJiZ0KGIsaikmJmouaWQ9PT1mKXJldHVybiBkLnB1c2goaiksZH1lbHNle2lmKGxbMl0pcmV0dXJuIEcuYXBwbHkoZCxiLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpKSxkO2lmKChmPWxbM10pJiZjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gRy5hcHBseShkLGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShmKSksZH1pZihjLnFzYSYmIUFbYSsiICJdJiYoIXF8fCFxLnRlc3QoYSkpKXtpZigxIT09dylzPWIscj1hO2Vsc2UgaWYoIm9iamVjdCIhPT1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpeyhrPWIuZ2V0QXR0cmlidXRlKCJpZCIpKT9rPWsucmVwbGFjZShiYSxjYSk6Yi5zZXRBdHRyaWJ1dGUoImlkIixrPXUpLG89ZyhhKSxoPW8ubGVuZ3RoO3doaWxlKGgtLSlvW2hdPSIjIitrKyIgIitzYShvW2hdKTtyPW8uam9pbigiLCIpLHM9JC50ZXN0KGEpJiZxYShiLnBhcmVudE5vZGUpfHxifWlmKHIpdHJ5e3JldHVybiBHLmFwcGx5KGQscy5xdWVyeVNlbGVjdG9yQWxsKHIpKSxkfWNhdGNoKHgpe31maW5hbGx5e2s9PT11JiZiLnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiBpKGEucmVwbGFjZShQLCIkMSIpLGIsZCxlKX1mdW5jdGlvbiBoYSgpe3ZhciBhPVtdO2Z1bmN0aW9uIGIoYyxlKXtyZXR1cm4gYS5wdXNoKGMrIiAiKT5kLmNhY2hlTGVuZ3RoJiZkZWxldGUgYlthLnNoaWZ0KCldLGJbYysiICJdPWV9cmV0dXJuIGJ9ZnVuY3Rpb24gaWEoYSl7cmV0dXJuIGFbdV09ITAsYX1mdW5jdGlvbiBqYShhKXt2YXIgYj1uLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0Iik7dHJ5e3JldHVybiEhYShiKX1jYXRjaChjKXtyZXR1cm4hMX1maW5hbGx5e2IucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpLGI9bnVsbH19ZnVuY3Rpb24ga2EoYSxiKXt2YXIgYz1hLnNwbGl0KCJ8IiksZT1jLmxlbmd0aDt3aGlsZShlLS0pZC5hdHRySGFuZGxlW2NbZV1dPWJ9ZnVuY3Rpb24gbGEoYSxiKXt2YXIgYz1iJiZhLGQ9YyYmMT09PWEubm9kZVR5cGUmJjE9PT1iLm5vZGVUeXBlJiZhLnNvdXJjZUluZGV4LWIuc291cmNlSW5kZXg7aWYoZClyZXR1cm4gZDtpZihjKXdoaWxlKGM9Yy5uZXh0U2libGluZylpZihjPT09YilyZXR1cm4tMTtyZXR1cm4gYT8xOi0xfWZ1bmN0aW9uIG1hKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWMmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG5hKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKCJpbnB1dCI9PT1jfHwiYnV0dG9uIj09PWMpJiZiLnR5cGU9PT1hfX1mdW5jdGlvbiBvYShhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuImZvcm0iaW4gYj9iLnBhcmVudE5vZGUmJmIuZGlzYWJsZWQ9PT0hMT8ibGFiZWwiaW4gYj8ibGFiZWwiaW4gYi5wYXJlbnROb2RlP2IucGFyZW50Tm9kZS5kaXNhYmxlZD09PWE6Yi5kaXNhYmxlZD09PWE6Yi5pc0Rpc2FibGVkPT09YXx8Yi5pc0Rpc2FibGVkIT09IWEmJmVhKGIpPT09YTpiLmRpc2FibGVkPT09YToibGFiZWwiaW4gYiYmYi5kaXNhYmxlZD09PWF9fWZ1bmN0aW9uIHBhKGEpe3JldHVybiBpYShmdW5jdGlvbihiKXtyZXR1cm4gYj0rYixpYShmdW5jdGlvbihjLGQpe3ZhciBlLGY9YShbXSxjLmxlbmd0aCxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSljW2U9ZltnXV0mJihjW2VdPSEoZFtlXT1jW2VdKSl9KX0pfWZ1bmN0aW9uIHFhKGEpe3JldHVybiBhJiYidW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmF9Yz1nYS5zdXBwb3J0PXt9LGY9Z2EuaXNYTUw9ZnVuY3Rpb24oYSl7dmFyIGI9YSYmKGEub3duZXJEb2N1bWVudHx8YSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiEhYiYmIkhUTUwiIT09Yi5ub2RlTmFtZX0sbT1nYS5zZXREb2N1bWVudD1mdW5jdGlvbihhKXt2YXIgYixlLGc9YT9hLm93bmVyRG9jdW1lbnR8fGE6djtyZXR1cm4gZyE9PW4mJjk9PT1nLm5vZGVUeXBlJiZnLmRvY3VtZW50RWxlbWVudD8obj1nLG89bi5kb2N1bWVudEVsZW1lbnQscD0hZihuKSx2IT09biYmKGU9bi5kZWZhdWx0VmlldykmJmUudG9wIT09ZSYmKGUuYWRkRXZlbnRMaXN0ZW5lcj9lLmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsZGEsITEpOmUuYXR0YWNoRXZlbnQmJmUuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixkYSkpLGMuYXR0cmlidXRlcz1qYShmdW5jdGlvbihhKXtyZXR1cm4gYS5jbGFzc05hbWU9ImkiLCFhLmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIil9KSxjLmdldEVsZW1lbnRzQnlUYWdOYW1lPWphKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFwcGVuZENoaWxkKG4uY3JlYXRlQ29tbWVudCgiIikpLCFhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RofSksYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPVkudGVzdChuLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLGMuZ2V0QnlJZD1qYShmdW5jdGlvbihhKXtyZXR1cm4gby5hcHBlbmRDaGlsZChhKS5pZD11LCFuLmdldEVsZW1lbnRzQnlOYW1lfHwhbi5nZXRFbGVtZW50c0J5TmFtZSh1KS5sZW5ndGh9KSxjLmdldEJ5SWQ/KGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShfLGFhKTtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0QXR0cmlidXRlKCJpZCIpPT09Yn19LGQuZmluZC5JRD1mdW5jdGlvbihhLGIpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50QnlJZCYmcCl7dmFyIGM9Yi5nZXRFbGVtZW50QnlJZChhKTtyZXR1cm4gYz9bY106W119fSk6KGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShfLGFhKTtyZXR1cm4gZnVuY3Rpb24oYSl7dmFyIGM9InVuZGVmaW5lZCIhPXR5cGVvZiBhLmdldEF0dHJpYnV0ZU5vZGUmJmEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTtyZXR1cm4gYyYmYy52YWx1ZT09PWJ9fSxkLmZpbmQuSUQ9ZnVuY3Rpb24oYSxiKXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGIuZ2V0RWxlbWVudEJ5SWQmJnApe3ZhciBjLGQsZSxmPWIuZ2V0RWxlbWVudEJ5SWQoYSk7aWYoZil7aWYoYz1mLmdldEF0dHJpYnV0ZU5vZGUoImlkIiksYyYmYy52YWx1ZT09PWEpcmV0dXJuW2ZdO2U9Yi5nZXRFbGVtZW50c0J5TmFtZShhKSxkPTA7d2hpbGUoZj1lW2QrK10paWYoYz1mLmdldEF0dHJpYnV0ZU5vZGUoImlkIiksYyYmYy52YWx1ZT09PWEpcmV0dXJuW2ZdfXJldHVybltdfX0pLGQuZmluZC5UQUc9Yy5nZXRFbGVtZW50c0J5VGFnTmFtZT9mdW5jdGlvbihhLGIpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50c0J5VGFnTmFtZT9iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpOmMucXNhP2IucXVlcnlTZWxlY3RvckFsbChhKTp2b2lkIDB9OmZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPTAsZj1iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpO2lmKCIqIj09PWEpe3doaWxlKGM9ZltlKytdKTE9PT1jLm5vZGVUeXBlJiZkLnB1c2goYyk7cmV0dXJuIGR9cmV0dXJuIGZ9LGQuZmluZC5DTEFTUz1jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmZ1bmN0aW9uKGEsYil7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJnApcmV0dXJuIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhKX0scj1bXSxxPVtdLChjLnFzYT1ZLnRlc3Qobi5xdWVyeVNlbGVjdG9yQWxsKSkmJihqYShmdW5jdGlvbihhKXtvLmFwcGVuZENoaWxkKGEpLmlubmVySFRNTD0iPGEgaWQ9JyIrdSsiJz48L2E+PHNlbGVjdCBpZD0nIit1KyItXHJcXCcgbXNhbGxvd2NhcHR1cmU9Jyc+PG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVjdD4iLGEucXVlcnlTZWxlY3RvckFsbCgiW21zYWxsb3djYXB0dXJlXj0nJ10iKS5sZW5ndGgmJnEucHVzaCgiWypeJF09IitLKyIqKD86Jyd8XCJcIikiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGh8fHEucHVzaCgiXFxbIitLKyIqKD86dmFsdWV8IitKKyIpIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJbaWR+PSIrdSsiLV0iKS5sZW5ndGh8fHEucHVzaCgifj0iKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RofHxxLnB1c2goIjpjaGVja2VkIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJhIyIrdSsiKyoiKS5sZW5ndGh8fHEucHVzaCgiLiMuK1srfl0iKX0pLGphKGZ1bmN0aW9uKGEpe2EuaW5uZXJIVE1MPSI8YSBocmVmPScnIGRpc2FibGVkPSdkaXNhYmxlZCc+PC9hPjxzZWxlY3QgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0aW9uLz48L3NlbGVjdD4iO3ZhciBiPW4uY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtiLnNldEF0dHJpYnV0ZSgidHlwZSIsImhpZGRlbiIpLGEuYXBwZW5kQ2hpbGQoYikuc2V0QXR0cmlidXRlKCJuYW1lIiwiRCIpLGEucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGgmJnEucHVzaCgibmFtZSIrSysiKlsqXiR8IX5dPz0iKSwyIT09YS5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCYmcS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLG8uYXBwZW5kQ2hpbGQoYSkuZGlzYWJsZWQ9ITAsMiE9PWEucXVlcnlTZWxlY3RvckFsbCgiOmRpc2FibGVkIikubGVuZ3RoJiZxLnB1c2goIjplbmFibGVkIiwiOmRpc2FibGVkIiksYS5xdWVyeVNlbGVjdG9yQWxsKCIqLDp4IikscS5wdXNoKCIsLio6Iil9KSksKGMubWF0Y2hlc1NlbGVjdG9yPVkudGVzdChzPW8ubWF0Y2hlc3x8by53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fG8ubW96TWF0Y2hlc1NlbGVjdG9yfHxvLm9NYXRjaGVzU2VsZWN0b3J8fG8ubXNNYXRjaGVzU2VsZWN0b3IpKSYmamEoZnVuY3Rpb24oYSl7Yy5kaXNjb25uZWN0ZWRNYXRjaD1zLmNhbGwoYSwiKiIpLHMuY2FsbChhLCJbcyE9JyddOngiKSxyLnB1c2goIiE9IixOKX0pLHE9cS5sZW5ndGgmJm5ldyBSZWdFeHAocS5qb2luKCJ8IikpLHI9ci5sZW5ndGgmJm5ldyBSZWdFeHAoci5qb2luKCJ8IikpLGI9WS50ZXN0KG8uY29tcGFyZURvY3VtZW50UG9zaXRpb24pLHQ9Ynx8WS50ZXN0KG8uY29udGFpbnMpP2Z1bmN0aW9uKGEsYil7dmFyIGM9OT09PWEubm9kZVR5cGU/YS5kb2N1bWVudEVsZW1lbnQ6YSxkPWImJmIucGFyZW50Tm9kZTtyZXR1cm4gYT09PWR8fCEoIWR8fDEhPT1kLm5vZGVUeXBlfHwhKGMuY29udGFpbnM/Yy5jb250YWlucyhkKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQpKSl9OmZ1bmN0aW9uKGEsYil7aWYoYil3aGlsZShiPWIucGFyZW50Tm9kZSlpZihiPT09YSlyZXR1cm4hMDtyZXR1cm4hMX0sQj1iP2Z1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgZD0hYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbi0hYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjtyZXR1cm4gZD9kOihkPShhLm93bmVyRG9jdW1lbnR8fGEpPT09KGIub3duZXJEb2N1bWVudHx8Yik/YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKToxLDEmZHx8IWMuc29ydERldGFjaGVkJiZiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGEpPT09ZD9hPT09bnx8YS5vd25lckRvY3VtZW50PT09diYmdCh2LGEpPy0xOmI9PT1ufHxiLm93bmVyRG9jdW1lbnQ9PT12JiZ0KHYsYik/MTprP0koayxhKS1JKGssYik6MDo0JmQ/LTE6MSl9OmZ1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgYyxkPTAsZT1hLnBhcmVudE5vZGUsZj1iLnBhcmVudE5vZGUsZz1bYV0saD1bYl07aWYoIWV8fCFmKXJldHVybiBhPT09bj8tMTpiPT09bj8xOmU/LTE6Zj8xOms/SShrLGEpLUkoayxiKTowO2lmKGU9PT1mKXJldHVybiBsYShhLGIpO2M9YTt3aGlsZShjPWMucGFyZW50Tm9kZSlnLnVuc2hpZnQoYyk7Yz1iO3doaWxlKGM9Yy5wYXJlbnROb2RlKWgudW5zaGlmdChjKTt3aGlsZShnW2RdPT09aFtkXSlkKys7cmV0dXJuIGQ/bGEoZ1tkXSxoW2RdKTpnW2RdPT09dj8tMTpoW2RdPT09dj8xOjB9LG4pOm59LGdhLm1hdGNoZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2EoYSxudWxsLG51bGwsYil9LGdhLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihhLGIpe2lmKChhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSxiPWIucmVwbGFjZShTLCI9JyQxJ10iKSxjLm1hdGNoZXNTZWxlY3RvciYmcCYmIUFbYisiICJdJiYoIXJ8fCFyLnRlc3QoYikpJiYoIXF8fCFxLnRlc3QoYikpKXRyeXt2YXIgZD1zLmNhbGwoYSxiKTtpZihkfHxjLmRpc2Nvbm5lY3RlZE1hdGNofHxhLmRvY3VtZW50JiYxMSE9PWEuZG9jdW1lbnQubm9kZVR5cGUpcmV0dXJuIGR9Y2F0Y2goZSl7fXJldHVybiBnYShiLG4sbnVsbCxbYV0pLmxlbmd0aD4wfSxnYS5jb250YWlucz1mdW5jdGlvbihhLGIpe3JldHVybihhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSx0KGEsYil9LGdhLmF0dHI9ZnVuY3Rpb24oYSxiKXsoYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSk7dmFyIGU9ZC5hdHRySGFuZGxlW2IudG9Mb3dlckNhc2UoKV0sZj1lJiZDLmNhbGwoZC5hdHRySGFuZGxlLGIudG9Mb3dlckNhc2UoKSk/ZShhLGIsIXApOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09Zj9mOmMuYXR0cmlidXRlc3x8IXA/YS5nZXRBdHRyaWJ1dGUoYik6KGY9YS5nZXRBdHRyaWJ1dGVOb2RlKGIpKSYmZi5zcGVjaWZpZWQ/Zi52YWx1ZTpudWxsfSxnYS5lc2NhcGU9ZnVuY3Rpb24oYSl7cmV0dXJuKGErIiIpLnJlcGxhY2UoYmEsY2EpfSxnYS5lcnJvcj1mdW5jdGlvbihhKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrYSl9LGdhLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oYSl7dmFyIGIsZD1bXSxlPTAsZj0wO2lmKGw9IWMuZGV0ZWN0RHVwbGljYXRlcyxrPSFjLnNvcnRTdGFibGUmJmEuc2xpY2UoMCksYS5zb3J0KEIpLGwpe3doaWxlKGI9YVtmKytdKWI9PT1hW2ZdJiYoZT1kLnB1c2goZikpO3doaWxlKGUtLSlhLnNwbGljZShkW2VdLDEpfXJldHVybiBrPW51bGwsYX0sZT1nYS5nZXRUZXh0PWZ1bmN0aW9uKGEpe3ZhciBiLGM9IiIsZD0wLGY9YS5ub2RlVHlwZTtpZihmKXtpZigxPT09Znx8OT09PWZ8fDExPT09Zil7aWYoInN0cmluZyI9PXR5cGVvZiBhLnRleHRDb250ZW50KXJldHVybiBhLnRleHRDb250ZW50O2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZyljKz1lKGEpfWVsc2UgaWYoMz09PWZ8fDQ9PT1mKXJldHVybiBhLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKGI9YVtkKytdKWMrPWUoYik7cmV0dXJuIGN9LGQ9Z2Euc2VsZWN0b3JzPXtjYWNoZUxlbmd0aDo1MCxjcmVhdGVQc2V1ZG86aWEsbWF0Y2g6VixhdHRySGFuZGxlOnt9LGZpbmQ6e30scmVsYXRpdmU6eyI+Ijp7ZGlyOiJwYXJlbnROb2RlIixmaXJzdDohMH0sIiAiOntkaXI6InBhcmVudE5vZGUifSwiKyI6e2RpcjoicHJldmlvdXNTaWJsaW5nIixmaXJzdDohMH0sIn4iOntkaXI6InByZXZpb3VzU2libGluZyJ9fSxwcmVGaWx0ZXI6e0FUVFI6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS5yZXBsYWNlKF8sYWEpLGFbM109KGFbM118fGFbNF18fGFbNV18fCIiKS5yZXBsYWNlKF8sYWEpLCJ+PSI9PT1hWzJdJiYoYVszXT0iICIrYVszXSsiICIpLGEuc2xpY2UoMCw0KX0sQ0hJTEQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS50b0xvd2VyQ2FzZSgpLCJudGgiPT09YVsxXS5zbGljZSgwLDMpPyhhWzNdfHxnYS5lcnJvcihhWzBdKSxhWzRdPSsoYVs0XT9hWzVdKyhhWzZdfHwxKToyKigiZXZlbiI9PT1hWzNdfHwib2RkIj09PWFbM10pKSxhWzVdPSsoYVs3XSthWzhdfHwib2RkIj09PWFbM10pKTphWzNdJiZnYS5lcnJvcihhWzBdKSxhfSxQU0VVRE86ZnVuY3Rpb24oYSl7dmFyIGIsYz0hYVs2XSYmYVsyXTtyZXR1cm4gVi5DSElMRC50ZXN0KGFbMF0pP251bGw6KGFbM10/YVsyXT1hWzRdfHxhWzVdfHwiIjpjJiZULnRlc3QoYykmJihiPWcoYywhMCkpJiYoYj1jLmluZGV4T2YoIikiLGMubGVuZ3RoLWIpLWMubGVuZ3RoKSYmKGFbMF09YVswXS5zbGljZSgwLGIpLGFbMl09Yy5zbGljZSgwLGIpKSxhLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKF8sYWEpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIioiPT09YT9mdW5jdGlvbigpe3JldHVybiEwfTpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yn19LENMQVNTOmZ1bmN0aW9uKGEpe3ZhciBiPXlbYSsiICJdO3JldHVybiBifHwoYj1uZXcgUmVnRXhwKCIoXnwiK0srIikiK2ErIigiK0srInwkKSIpKSYmeShhLGZ1bmN0aW9uKGEpe3JldHVybiBiLnRlc3QoInN0cmluZyI9PXR5cGVvZiBhLmNsYXNzTmFtZSYmYS5jbGFzc05hbWV8fCJ1bmRlZmluZWQiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIil9KX0sQVRUUjpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlPWdhLmF0dHIoZCxhKTtyZXR1cm4gbnVsbD09ZT8iIT0iPT09YjohYnx8KGUrPSIiLCI9Ij09PWI/ZT09PWM6IiE9Ij09PWI/ZSE9PWM6Il49Ij09PWI/YyYmMD09PWUuaW5kZXhPZihjKToiKj0iPT09Yj9jJiZlLmluZGV4T2YoYyk+LTE6IiQ9Ij09PWI/YyYmZS5zbGljZSgtYy5sZW5ndGgpPT09Yzoifj0iPT09Yj8oIiAiK2UucmVwbGFjZShPLCIgIikrIiAiKS5pbmRleE9mKGMpPi0xOiJ8PSI9PT1iJiYoZT09PWN8fGUuc2xpY2UoMCxjLmxlbmd0aCsxKT09PWMrIi0iKSl9fSxDSElMRDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPSJudGgiIT09YS5zbGljZSgwLDMpLGc9Imxhc3QiIT09YS5zbGljZSgtNCksaD0ib2YtdHlwZSI9PT1iO3JldHVybiAxPT09ZCYmMD09PWU/ZnVuY3Rpb24oYSl7cmV0dXJuISFhLnBhcmVudE5vZGV9OmZ1bmN0aW9uKGIsYyxpKXt2YXIgaixrLGwsbSxuLG8scD1mIT09Zz8ibmV4dFNpYmxpbmciOiJwcmV2aW91c1NpYmxpbmciLHE9Yi5wYXJlbnROb2RlLHI9aCYmYi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLHM9IWkmJiFoLHQ9ITE7aWYocSl7aWYoZil7d2hpbGUocCl7bT1iO3doaWxlKG09bVtwXSlpZihoP20ubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PW0ubm9kZVR5cGUpcmV0dXJuITE7bz1wPSJvbmx5Ij09PWEmJiFvJiYibmV4dFNpYmxpbmcifXJldHVybiEwfWlmKG89W2c/cS5maXJzdENoaWxkOnEubGFzdENoaWxkXSxnJiZzKXttPXEsbD1tW3VdfHwobVt1XT17fSksaz1sW20udW5pcXVlSURdfHwobFttLnVuaXF1ZUlEXT17fSksaj1rW2FdfHxbXSxuPWpbMF09PT13JiZqWzFdLHQ9biYmalsyXSxtPW4mJnEuY2hpbGROb2Rlc1tuXTt3aGlsZShtPSsrbiYmbSYmbVtwXXx8KHQ9bj0wKXx8by5wb3AoKSlpZigxPT09bS5ub2RlVHlwZSYmKyt0JiZtPT09Yil7a1thXT1bdyxuLHRdO2JyZWFrfX1lbHNlIGlmKHMmJihtPWIsbD1tW3VdfHwobVt1XT17fSksaz1sW20udW5pcXVlSURdfHwobFttLnVuaXF1ZUlEXT17fSksaj1rW2FdfHxbXSxuPWpbMF09PT13JiZqWzFdLHQ9biksdD09PSExKXdoaWxlKG09KytuJiZtJiZtW3BdfHwodD1uPTApfHxvLnBvcCgpKWlmKChoP20ubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PW0ubm9kZVR5cGUpJiYrK3QmJihzJiYobD1tW3VdfHwobVt1XT17fSksaz1sW20udW5pcXVlSURdfHwobFttLnVuaXF1ZUlEXT17fSksa1thXT1bdyx0XSksbT09PWIpKWJyZWFrO3JldHVybiB0LT1lLHQ9PT1kfHx0JWQ9PT0wJiZ0L2Q+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGEsYil7dmFyIGMsZT1kLnBzZXVkb3NbYV18fGQuc2V0RmlsdGVyc1thLnRvTG93ZXJDYXNlKCldfHxnYS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2EpO3JldHVybiBlW3VdP2UoYik6ZS5sZW5ndGg+MT8oYz1bYSxhLCIiLGJdLGQuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShhLnRvTG93ZXJDYXNlKCkpP2lhKGZ1bmN0aW9uKGEsYyl7dmFyIGQsZj1lKGEsYiksZz1mLmxlbmd0aDt3aGlsZShnLS0pZD1JKGEsZltnXSksYVtkXT0hKGNbZF09ZltnXSl9KTpmdW5jdGlvbihhKXtyZXR1cm4gZShhLDAsYyl9KTplfX0scHNldWRvczp7bm90OmlhKGZ1bmN0aW9uKGEpe3ZhciBiPVtdLGM9W10sZD1oKGEucmVwbGFjZShQLCIkMSIpKTtyZXR1cm4gZFt1XT9pYShmdW5jdGlvbihhLGIsYyxlKXt2YXIgZixnPWQoYSxudWxsLGUsW10pLGg9YS5sZW5ndGg7d2hpbGUoaC0tKShmPWdbaF0pJiYoYVtoXT0hKGJbaF09ZikpfSk6ZnVuY3Rpb24oYSxlLGYpe3JldHVybiBiWzBdPWEsZChiLG51bGwsZixjKSxiWzBdPW51bGwsIWMucG9wKCl9fSksaGFzOmlhKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZ2EoYSxiKS5sZW5ndGg+MH19KSxjb250YWluczppYShmdW5jdGlvbihhKXtyZXR1cm4gYT1hLnJlcGxhY2UoXyxhYSksZnVuY3Rpb24oYil7cmV0dXJuKGIudGV4dENvbnRlbnR8fGIuaW5uZXJUZXh0fHxlKGIpKS5pbmRleE9mKGEpPi0xfX0pLGxhbmc6aWEoZnVuY3Rpb24oYSl7cmV0dXJuIFUudGVzdChhfHwiIil8fGdhLmVycm9yKCJ1bnN1cHBvcnRlZCBsYW5nOiAiK2EpLGE9YS5yZXBsYWNlKF8sYWEpLnRvTG93ZXJDYXNlKCksZnVuY3Rpb24oYil7dmFyIGM7ZG8gaWYoYz1wP2IubGFuZzpiLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKXx8Yi5nZXRBdHRyaWJ1dGUoImxhbmciKSlyZXR1cm4gYz1jLnRvTG93ZXJDYXNlKCksYz09PWF8fDA9PT1jLmluZGV4T2YoYSsiLSIpO3doaWxlKChiPWIucGFyZW50Tm9kZSkmJjE9PT1iLm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24oYil7dmFyIGM9YS5sb2NhdGlvbiYmYS5sb2NhdGlvbi5oYXNoO3JldHVybiBjJiZjLnNsaWNlKDEpPT09Yi5pZH0scm9vdDpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW99LGZvY3VzOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09bi5hY3RpdmVFbGVtZW50JiYoIW4uaGFzRm9jdXN8fG4uaGFzRm9jdXMoKSkmJiEhKGEudHlwZXx8YS5ocmVmfHx+YS50YWJJbmRleCl9LGVuYWJsZWQ6b2EoITEpLGRpc2FibGVkOm9hKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YiYmISFhLmNoZWNrZWR8fCJvcHRpb24iPT09YiYmISFhLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxhLnNlbGVjdGVkPT09ITB9LGVtcHR5OmZ1bmN0aW9uKGEpe2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZylpZihhLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihhKXtyZXR1cm4hZC5wc2V1ZG9zLmVtcHR5KGEpfSxoZWFkZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIFgudGVzdChhLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIFcudGVzdChhLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YiYmImJ1dHRvbiI9PT1hLnR5cGV8fCJidXR0b24iPT09Yn0sdGV4dDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4iaW5wdXQiPT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYidGV4dCI9PT1hLnR5cGUmJihudWxsPT0oYj1hLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09Yi50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6cGEoZnVuY3Rpb24oKXtyZXR1cm5bMF19KSxsYXN0OnBhKGZ1bmN0aW9uKGEsYil7cmV0dXJuW2ItMV19KSxlcTpwYShmdW5jdGlvbihhLGIsYyl7cmV0dXJuW2M8MD9jK2I6Y119KSxldmVuOnBhKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTA7YzxiO2MrPTIpYS5wdXNoKGMpO3JldHVybiBhfSksb2RkOnBhKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTE7YzxiO2MrPTIpYS5wdXNoKGMpO3JldHVybiBhfSksbHQ6cGEoZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD1jPDA/YytiOmM7LS1kPj0wOylhLnB1c2goZCk7cmV0dXJuIGF9KSxndDpwYShmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPWM8MD9jK2I6YzsrK2Q8YjspYS5wdXNoKGQpO3JldHVybiBhfSl9fSxkLnBzZXVkb3MubnRoPWQucHNldWRvcy5lcTtmb3IoYiBpbntyYWRpbzohMCxjaGVja2JveDohMCxmaWxlOiEwLHBhc3N3b3JkOiEwLGltYWdlOiEwfSlkLnBzZXVkb3NbYl09bWEoYik7Zm9yKGIgaW57c3VibWl0OiEwLHJlc2V0OiEwfSlkLnBzZXVkb3NbYl09bmEoYik7ZnVuY3Rpb24gcmEoKXt9cmEucHJvdG90eXBlPWQuZmlsdGVycz1kLnBzZXVkb3MsZC5zZXRGaWx0ZXJzPW5ldyByYSxnPWdhLnRva2VuaXplPWZ1bmN0aW9uKGEsYil7dmFyIGMsZSxmLGcsaCxpLGosaz16W2ErIiAiXTtpZihrKXJldHVybiBiPzA6ay5zbGljZSgwKTtoPWEsaT1bXSxqPWQucHJlRmlsdGVyO3doaWxlKGgpe2MmJiEoZT1RLmV4ZWMoaCkpfHwoZSYmKGg9aC5zbGljZShlWzBdLmxlbmd0aCl8fGgpLGkucHVzaChmPVtdKSksYz0hMSwoZT1SLmV4ZWMoaCkpJiYoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZVswXS5yZXBsYWNlKFAsIiAiKX0pLGg9aC5zbGljZShjLmxlbmd0aCkpO2ZvcihnIGluIGQuZmlsdGVyKSEoZT1WW2ddLmV4ZWMoaCkpfHxqW2ddJiYhKGU9altnXShlKSl8fChjPWUuc2hpZnQoKSxmLnB1c2goe3ZhbHVlOmMsdHlwZTpnLG1hdGNoZXM6ZX0pLGg9aC5zbGljZShjLmxlbmd0aCkpO2lmKCFjKWJyZWFrfXJldHVybiBiP2gubGVuZ3RoOmg/Z2EuZXJyb3IoYSk6eihhLGkpLnNsaWNlKDApfTtmdW5jdGlvbiBzYShhKXtmb3IodmFyIGI9MCxjPWEubGVuZ3RoLGQ9IiI7YjxjO2IrKylkKz1hW2JdLnZhbHVlO3JldHVybiBkfWZ1bmN0aW9uIHRhKGEsYixjKXt2YXIgZD1iLmRpcixlPWIubmV4dCxmPWV8fGQsZz1jJiYicGFyZW50Tm9kZSI9PT1mLGg9eCsrO3JldHVybiBiLmZpcnN0P2Z1bmN0aW9uKGIsYyxlKXt3aGlsZShiPWJbZF0paWYoMT09PWIubm9kZVR5cGV8fGcpcmV0dXJuIGEoYixjLGUpO3JldHVybiExfTpmdW5jdGlvbihiLGMsaSl7dmFyIGosayxsLG09W3csaF07aWYoaSl7d2hpbGUoYj1iW2RdKWlmKCgxPT09Yi5ub2RlVHlwZXx8ZykmJmEoYixjLGkpKXJldHVybiEwfWVsc2Ugd2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxnKWlmKGw9Ylt1XXx8KGJbdV09e30pLGs9bFtiLnVuaXF1ZUlEXXx8KGxbYi51bmlxdWVJRF09e30pLGUmJmU9PT1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpYj1iW2RdfHxiO2Vsc2V7aWYoKGo9a1tmXSkmJmpbMF09PT13JiZqWzFdPT09aClyZXR1cm4gbVsyXT1qWzJdO2lmKGtbZl09bSxtWzJdPWEoYixjLGkpKXJldHVybiEwfXJldHVybiExfX1mdW5jdGlvbiB1YShhKXtyZXR1cm4gYS5sZW5ndGg+MT9mdW5jdGlvbihiLGMsZCl7dmFyIGU9YS5sZW5ndGg7d2hpbGUoZS0tKWlmKCFhW2VdKGIsYyxkKSlyZXR1cm4hMTtyZXR1cm4hMH06YVswXX1mdW5jdGlvbiB2YShhLGIsYyl7Zm9yKHZhciBkPTAsZT1iLmxlbmd0aDtkPGU7ZCsrKWdhKGEsYltkXSxjKTtyZXR1cm4gY31mdW5jdGlvbiB3YShhLGIsYyxkLGUpe2Zvcih2YXIgZixnPVtdLGg9MCxpPWEubGVuZ3RoLGo9bnVsbCE9YjtoPGk7aCsrKShmPWFbaF0pJiYoYyYmIWMoZixkLGUpfHwoZy5wdXNoKGYpLGomJmIucHVzaChoKSkpO3JldHVybiBnfWZ1bmN0aW9uIHhhKGEsYixjLGQsZSxmKXtyZXR1cm4gZCYmIWRbdV0mJihkPXhhKGQpKSxlJiYhZVt1XSYmKGU9eGEoZSxmKSksaWEoZnVuY3Rpb24oZixnLGgsaSl7dmFyIGosayxsLG09W10sbj1bXSxvPWcubGVuZ3RoLHA9Znx8dmEoYnx8IioiLGgubm9kZVR5cGU/W2hdOmgsW10pLHE9IWF8fCFmJiZiP3A6d2EocCxtLGEsaCxpKSxyPWM/ZXx8KGY/YTpvfHxkKT9bXTpnOnE7aWYoYyYmYyhxLHIsaCxpKSxkKXtqPXdhKHIsbiksZChqLFtdLGgsaSksaz1qLmxlbmd0aDt3aGlsZShrLS0pKGw9altrXSkmJihyW25ba11dPSEocVtuW2tdXT1sKSl9aWYoZil7aWYoZXx8YSl7aWYoZSl7aj1bXSxrPXIubGVuZ3RoO3doaWxlKGstLSkobD1yW2tdKSYmai5wdXNoKHFba109bCk7ZShudWxsLHI9W10saixpKX1rPXIubGVuZ3RoO3doaWxlKGstLSkobD1yW2tdKSYmKGo9ZT9JKGYsbCk6bVtrXSk+LTEmJihmW2pdPSEoZ1tqXT1sKSl9fWVsc2Ugcj13YShyPT09Zz9yLnNwbGljZShvLHIubGVuZ3RoKTpyKSxlP2UobnVsbCxnLHIsaSk6Ry5hcHBseShnLHIpfSl9ZnVuY3Rpb24geWEoYSl7Zm9yKHZhciBiLGMsZSxmPWEubGVuZ3RoLGc9ZC5yZWxhdGl2ZVthWzBdLnR5cGVdLGg9Z3x8ZC5yZWxhdGl2ZVsiICJdLGk9Zz8xOjAsaz10YShmdW5jdGlvbihhKXtyZXR1cm4gYT09PWJ9LGgsITApLGw9dGEoZnVuY3Rpb24oYSl7cmV0dXJuIEkoYixhKT4tMX0saCwhMCksbT1bZnVuY3Rpb24oYSxjLGQpe3ZhciBlPSFnJiYoZHx8YyE9PWopfHwoKGI9Yykubm9kZVR5cGU/ayhhLGMsZCk6bChhLGMsZCkpO3JldHVybiBiPW51bGwsZX1dO2k8ZjtpKyspaWYoYz1kLnJlbGF0aXZlW2FbaV0udHlwZV0pbT1bdGEodWEobSksYyldO2Vsc2V7aWYoYz1kLmZpbHRlclthW2ldLnR5cGVdLmFwcGx5KG51bGwsYVtpXS5tYXRjaGVzKSxjW3VdKXtmb3IoZT0rK2k7ZTxmO2UrKylpZihkLnJlbGF0aXZlW2FbZV0udHlwZV0pYnJlYWs7cmV0dXJuIHhhKGk+MSYmdWEobSksaT4xJiZzYShhLnNsaWNlKDAsaS0xKS5jb25jYXQoe3ZhbHVlOiIgIj09PWFbaS0yXS50eXBlPyIqIjoiIn0pKS5yZXBsYWNlKFAsIiQxIiksYyxpPGUmJnlhKGEuc2xpY2UoaSxlKSksZTxmJiZ5YShhPWEuc2xpY2UoZSkpLGU8ZiYmc2EoYSkpfW0ucHVzaChjKX1yZXR1cm4gdWEobSl9ZnVuY3Rpb24gemEoYSxiKXt2YXIgYz1iLmxlbmd0aD4wLGU9YS5sZW5ndGg+MCxmPWZ1bmN0aW9uKGYsZyxoLGksayl7dmFyIGwsbyxxLHI9MCxzPSIwIix0PWYmJltdLHU9W10sdj1qLHg9Znx8ZSYmZC5maW5kLlRBRygiKiIsaykseT13Kz1udWxsPT12PzE6TWF0aC5yYW5kb20oKXx8LjEsej14Lmxlbmd0aDtmb3IoayYmKGo9Zz09PW58fGd8fGspO3MhPT16JiZudWxsIT0obD14W3NdKTtzKyspe2lmKGUmJmwpe289MCxnfHxsLm93bmVyRG9jdW1lbnQ9PT1ufHwobShsKSxoPSFwKTt3aGlsZShxPWFbbysrXSlpZihxKGwsZ3x8bixoKSl7aS5wdXNoKGwpO2JyZWFrfWsmJih3PXkpfWMmJigobD0hcSYmbCkmJnItLSxmJiZ0LnB1c2gobCkpfWlmKHIrPXMsYyYmcyE9PXIpe289MDt3aGlsZShxPWJbbysrXSlxKHQsdSxnLGgpO2lmKGYpe2lmKHI+MCl3aGlsZShzLS0pdFtzXXx8dVtzXXx8KHVbc109RS5jYWxsKGkpKTt1PXdhKHUpfUcuYXBwbHkoaSx1KSxrJiYhZiYmdS5sZW5ndGg+MCYmcitiLmxlbmd0aD4xJiZnYS51bmlxdWVTb3J0KGkpfXJldHVybiBrJiYodz15LGo9diksdH07cmV0dXJuIGM/aWEoZik6Zn1yZXR1cm4gaD1nYS5jb21waWxlPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPVtdLGY9QVthKyIgIl07aWYoIWYpe2J8fChiPWcoYSkpLGM9Yi5sZW5ndGg7d2hpbGUoYy0tKWY9eWEoYltjXSksZlt1XT9kLnB1c2goZik6ZS5wdXNoKGYpO2Y9QShhLHphKGUsZCkpLGYuc2VsZWN0b3I9YX1yZXR1cm4gZn0saT1nYS5zZWxlY3Q9ZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGYsaSxqLGssbCxtPSJmdW5jdGlvbiI9PXR5cGVvZiBhJiZhLG49IWUmJmcoYT1tLnNlbGVjdG9yfHxhKTtpZihjPWN8fFtdLDE9PT1uLmxlbmd0aCl7aWYoaT1uWzBdPW5bMF0uc2xpY2UoMCksaS5sZW5ndGg+MiYmIklEIj09PShqPWlbMF0pLnR5cGUmJjk9PT1iLm5vZGVUeXBlJiZwJiZkLnJlbGF0aXZlW2lbMV0udHlwZV0pe2lmKGI9KGQuZmluZC5JRChqLm1hdGNoZXNbMF0ucmVwbGFjZShfLGFhKSxiKXx8W10pWzBdLCFiKXJldHVybiBjO20mJihiPWIucGFyZW50Tm9kZSksYT1hLnNsaWNlKGkuc2hpZnQoKS52YWx1ZS5sZW5ndGgpfWY9Vi5uZWVkc0NvbnRleHQudGVzdChhKT8wOmkubGVuZ3RoO3doaWxlKGYtLSl7aWYoaj1pW2ZdLGQucmVsYXRpdmVbaz1qLnR5cGVdKWJyZWFrO2lmKChsPWQuZmluZFtrXSkmJihlPWwoai5tYXRjaGVzWzBdLnJlcGxhY2UoXyxhYSksJC50ZXN0KGlbMF0udHlwZSkmJnFhKGIucGFyZW50Tm9kZSl8fGIpKSl7aWYoaS5zcGxpY2UoZiwxKSxhPWUubGVuZ3RoJiZzYShpKSwhYSlyZXR1cm4gRy5hcHBseShjLGUpLGM7YnJlYWt9fX1yZXR1cm4obXx8aChhLG4pKShlLGIsIXAsYywhYnx8JC50ZXN0KGEpJiZxYShiLnBhcmVudE5vZGUpfHxiKSxjfSxjLnNvcnRTdGFibGU9dS5zcGxpdCgiIikuc29ydChCKS5qb2luKCIiKT09PXUsYy5kZXRlY3REdXBsaWNhdGVzPSEhbCxtKCksYy5zb3J0RGV0YWNoZWQ9amEoZnVuY3Rpb24oYSl7cmV0dXJuIDEmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihuLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IikpfSksamEoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5uZXJIVE1MPSI8YSBocmVmPScjJz48L2E+IiwiIyI9PT1hLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIil9KXx8a2EoInR5cGV8aHJlZnxoZWlnaHR8d2lkdGgiLGZ1bmN0aW9uKGEsYixjKXtpZighYylyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoYiwidHlwZSI9PT1iLnRvTG93ZXJDYXNlKCk/MToyKX0pLGMuYXR0cmlidXRlcyYmamEoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5uZXJIVE1MPSI8aW5wdXQvPiIsYS5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSgidmFsdWUiLCIiKSwiIj09PWEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoInZhbHVlIil9KXx8a2EoInZhbHVlIixmdW5jdGlvbihhLGIsYyl7aWYoIWMmJiJpbnB1dCI9PT1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpcmV0dXJuIGEuZGVmYXVsdFZhbHVlfSksamEoZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWEuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpfSl8fGthKEosZnVuY3Rpb24oYSxiLGMpe3ZhciBkO2lmKCFjKXJldHVybiBhW2JdPT09ITA/Yi50b0xvd2VyQ2FzZSgpOihkPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmQuc3BlY2lmaWVkP2QudmFsdWU6bnVsbH0pLGdhfShhKTtyLmZpbmQ9eCxyLmV4cHI9eC5zZWxlY3RvcnMsci5leHByWyI6Il09ci5leHByLnBzZXVkb3Msci51bmlxdWVTb3J0PXIudW5pcXVlPXgudW5pcXVlU29ydCxyLnRleHQ9eC5nZXRUZXh0LHIuaXNYTUxEb2M9eC5pc1hNTCxyLmNvbnRhaW5zPXguY29udGFpbnMsci5lc2NhcGVTZWxlY3Rvcj14LmVzY2FwZTt2YXIgeT1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZT12b2lkIDAhPT1jO3doaWxlKChhPWFbYl0pJiY5IT09YS5ub2RlVHlwZSlpZigxPT09YS5ub2RlVHlwZSl7aWYoZSYmcihhKS5pcyhjKSlicmVhaztkLnB1c2goYSl9cmV0dXJuIGR9LHo9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W107YTthPWEubmV4dFNpYmxpbmcpMT09PWEubm9kZVR5cGUmJmEhPT1iJiZjLnB1c2goYSk7cmV0dXJuIGN9LEE9ci5leHByLm1hdGNoLm5lZWRzQ29udGV4dDtmdW5jdGlvbiBCKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWIudG9Mb3dlckNhc2UoKX12YXIgQz0vXjwoW2Etel1bXlwvXDA+Olx4MjBcdFxyXG5cZl0qKVtceDIwXHRcclxuXGZdKlwvPz4oPzo8XC9cMT58KSQvaSxEPS9eLlteOiNcW1wuLF0qJC87ZnVuY3Rpb24gRShhLGIsYyl7cmV0dXJuIHIuaXNGdW5jdGlvbihiKT9yLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiEhYi5jYWxsKGEsZCxhKSE9PWN9KTpiLm5vZGVUeXBlP3IuZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiBhPT09YiE9PWN9KToic3RyaW5nIiE9dHlwZW9mIGI/ci5ncmVwKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGkuY2FsbChiLGEpPi0xIT09Y30pOkQudGVzdChiKT9yLmZpbHRlcihiLGEsYyk6KGI9ci5maWx0ZXIoYixhKSxyLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gaS5jYWxsKGIsYSk+LTEhPT1jJiYxPT09YS5ub2RlVHlwZX0pKX1yLmZpbHRlcj1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9YlswXTtyZXR1cm4gYyYmKGE9Ijpub3QoIithKyIpIiksMT09PWIubGVuZ3RoJiYxPT09ZC5ub2RlVHlwZT9yLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGQsYSk/W2RdOltdOnIuZmluZC5tYXRjaGVzKGEsci5ncmVwKGIsZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfSkpfSxyLmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihhKXt2YXIgYixjLGQ9dGhpcy5sZW5ndGgsZT10aGlzO2lmKCJzdHJpbmciIT10eXBlb2YgYSlyZXR1cm4gdGhpcy5wdXNoU3RhY2socihhKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IoYj0wO2I8ZDtiKyspaWYoci5jb250YWlucyhlW2JdLHRoaXMpKXJldHVybiEwfSkpO2ZvcihjPXRoaXMucHVzaFN0YWNrKFtdKSxiPTA7YjxkO2IrKylyLmZpbmQoYSxlW2JdLGMpO3JldHVybiBkPjE/ci51bmlxdWVTb3J0KGMpOmN9LGZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soRSh0aGlzLGF8fFtdLCExKSl9LG5vdDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soRSh0aGlzLGF8fFtdLCEwKSl9LGlzOmZ1bmN0aW9uKGEpe3JldHVybiEhRSh0aGlzLCJzdHJpbmciPT10eXBlb2YgYSYmQS50ZXN0KGEpP3IoYSk6YXx8W10sITEpLmxlbmd0aH19KTt2YXIgRixHPS9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKykpJC8sSD1yLmZuLmluaXQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBlLGY7aWYoIWEpcmV0dXJuIHRoaXM7aWYoYz1jfHxGLCJzdHJpbmciPT10eXBlb2YgYSl7aWYoZT0iPCI9PT1hWzBdJiYiPiI9PT1hW2EubGVuZ3RoLTFdJiZhLmxlbmd0aD49Mz9bbnVsbCxhLG51bGxdOkcuZXhlYyhhKSwhZXx8IWVbMV0mJmIpcmV0dXJuIWJ8fGIuanF1ZXJ5PyhifHxjKS5maW5kKGEpOnRoaXMuY29uc3RydWN0b3IoYikuZmluZChhKTtpZihlWzFdKXtpZihiPWIgaW5zdGFuY2VvZiByP2JbMF06YixyLm1lcmdlKHRoaXMsci5wYXJzZUhUTUwoZVsxXSxiJiZiLm5vZGVUeXBlP2Iub3duZXJEb2N1bWVudHx8YjpkLCEwKSksQy50ZXN0KGVbMV0pJiZyLmlzUGxhaW5PYmplY3QoYikpZm9yKGUgaW4gYilyLmlzRnVuY3Rpb24odGhpc1tlXSk/dGhpc1tlXShiW2VdKTp0aGlzLmF0dHIoZSxiW2VdKTtyZXR1cm4gdGhpc31yZXR1cm4gZj1kLmdldEVsZW1lbnRCeUlkKGVbMl0pLGYmJih0aGlzWzBdPWYsdGhpcy5sZW5ndGg9MSksdGhpc31yZXR1cm4gYS5ub2RlVHlwZT8odGhpc1swXT1hLHRoaXMubGVuZ3RoPTEsdGhpcyk6ci5pc0Z1bmN0aW9uKGEpP3ZvaWQgMCE9PWMucmVhZHk/Yy5yZWFkeShhKTphKHIpOnIubWFrZUFycmF5KGEsdGhpcyl9O0gucHJvdG90eXBlPXIuZm4sRj1yKGQpO3ZhciBJPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLEo9e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07ci5mbi5leHRlbmQoe2hhczpmdW5jdGlvbihhKXt2YXIgYj1yKGEsdGhpcyksYz1iLmxlbmd0aDtyZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodmFyIGE9MDthPGM7YSsrKWlmKHIuY29udGFpbnModGhpcyxiW2FdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGEsYil7dmFyIGMsZD0wLGU9dGhpcy5sZW5ndGgsZj1bXSxnPSJzdHJpbmciIT10eXBlb2YgYSYmcihhKTtpZighQS50ZXN0KGEpKWZvcig7ZDxlO2QrKylmb3IoYz10aGlzW2RdO2MmJmMhPT1iO2M9Yy5wYXJlbnROb2RlKWlmKGMubm9kZVR5cGU8MTEmJihnP2cuaW5kZXgoYyk+LTE6MT09PWMubm9kZVR5cGUmJnIuZmluZC5tYXRjaGVzU2VsZWN0b3IoYyxhKSkpe2YucHVzaChjKTticmVha31yZXR1cm4gdGhpcy5wdXNoU3RhY2soZi5sZW5ndGg+MT9yLnVuaXF1ZVNvcnQoZik6Zil9LGluZGV4OmZ1bmN0aW9uKGEpe3JldHVybiBhPyJzdHJpbmciPT10eXBlb2YgYT9pLmNhbGwocihhKSx0aGlzWzBdKTppLmNhbGwodGhpcyxhLmpxdWVyeT9hWzBdOmEpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHIudW5pcXVlU29ydChyLm1lcmdlKHRoaXMuZ2V0KCkscihhLGIpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmFkZChudWxsPT1hP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGEpKX19KTtmdW5jdGlvbiBLKGEsYil7d2hpbGUoKGE9YVtiXSkmJjEhPT1hLm5vZGVUeXBlKTtyZXR1cm4gYX1yLmVhY2goe3BhcmVudDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJjExIT09Yi5ub2RlVHlwZT9iOm51bGx9LHBhcmVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSwicGFyZW50Tm9kZSIpfSxwYXJlbnRzVW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB5KGEsInBhcmVudE5vZGUiLGMpfSxuZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBLKGEsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIEsoYSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIHkoYSwibmV4dFNpYmxpbmciKX0scHJldkFsbDpmdW5jdGlvbihhKXtyZXR1cm4geShhLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dFVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4geShhLCJuZXh0U2libGluZyIsYyl9LHByZXZVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHkoYSwicHJldmlvdXNTaWJsaW5nIixjKX0sc2libGluZ3M6ZnVuY3Rpb24oYSl7cmV0dXJuIHooKGEucGFyZW50Tm9kZXx8e30pLmZpcnN0Q2hpbGQsYSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3JldHVybiB6KGEuZmlyc3RDaGlsZCl9LGNvbnRlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBCKGEsImlmcmFtZSIpP2EuY29udGVudERvY3VtZW50OihCKGEsInRlbXBsYXRlIikmJihhPWEuY29udGVudHx8YSksci5tZXJnZShbXSxhLmNoaWxkTm9kZXMpKX19LGZ1bmN0aW9uKGEsYil7ci5mblthXT1mdW5jdGlvbihjLGQpe3ZhciBlPXIubWFwKHRoaXMsYixjKTtyZXR1cm4iVW50aWwiIT09YS5zbGljZSgtNSkmJihkPWMpLGQmJiJzdHJpbmciPT10eXBlb2YgZCYmKGU9ci5maWx0ZXIoZCxlKSksdGhpcy5sZW5ndGg+MSYmKEpbYV18fHIudW5pcXVlU29ydChlKSxJLnRlc3QoYSkmJmUucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhlKX19KTt2YXIgTD0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIE0oYSl7dmFyIGI9e307cmV0dXJuIHIuZWFjaChhLm1hdGNoKEwpfHxbXSxmdW5jdGlvbihhLGMpe2JbY109ITB9KSxifXIuQ2FsbGJhY2tzPWZ1bmN0aW9uKGEpe2E9InN0cmluZyI9PXR5cGVvZiBhP00oYSk6ci5leHRlbmQoe30sYSk7dmFyIGIsYyxkLGUsZj1bXSxnPVtdLGg9LTEsaT1mdW5jdGlvbigpe2ZvcihlPWV8fGEub25jZSxkPWI9ITA7Zy5sZW5ndGg7aD0tMSl7Yz1nLnNoaWZ0KCk7d2hpbGUoKytoPGYubGVuZ3RoKWZbaF0uYXBwbHkoY1swXSxjWzFdKT09PSExJiZhLnN0b3BPbkZhbHNlJiYoaD1mLmxlbmd0aCxjPSExKX1hLm1lbW9yeXx8KGM9ITEpLGI9ITEsZSYmKGY9Yz9bXToiIil9LGo9e2FkZDpmdW5jdGlvbigpe3JldHVybiBmJiYoYyYmIWImJihoPWYubGVuZ3RoLTEsZy5wdXNoKGMpKSxmdW5jdGlvbiBkKGIpe3IuZWFjaChiLGZ1bmN0aW9uKGIsYyl7ci5pc0Z1bmN0aW9uKGMpP2EudW5pcXVlJiZqLmhhcyhjKXx8Zi5wdXNoKGMpOmMmJmMubGVuZ3RoJiYic3RyaW5nIiE9PXIudHlwZShjKSYmZChjKX0pfShhcmd1bWVudHMpLGMmJiFiJiZpKCkpLHRoaXN9LHJlbW92ZTpmdW5jdGlvbigpe3JldHVybiByLmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKGEsYil7dmFyIGM7d2hpbGUoKGM9ci5pbkFycmF5KGIsZixjKSk+LTEpZi5zcGxpY2UoYywxKSxjPD1oJiZoLS19KSx0aGlzfSxoYXM6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/ci5pbkFycmF5KGEsZik+LTE6Zi5sZW5ndGg+MH0sZW1wdHk6ZnVuY3Rpb24oKXtyZXR1cm4gZiYmKGY9W10pLHRoaXN9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gZT1nPVtdLGY9Yz0iIix0aGlzfSxkaXNhYmxlZDpmdW5jdGlvbigpe3JldHVybiFmfSxsb2NrOmZ1bmN0aW9uKCl7cmV0dXJuIGU9Zz1bXSxjfHxifHwoZj1jPSIiKSx0aGlzfSxsb2NrZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIWV9LGZpcmVXaXRoOmZ1bmN0aW9uKGEsYyl7cmV0dXJuIGV8fChjPWN8fFtdLGM9W2EsYy5zbGljZT9jLnNsaWNlKCk6Y10sZy5wdXNoKGMpLGJ8fGkoKSksdGhpc30sZmlyZTpmdW5jdGlvbigpe3JldHVybiBqLmZpcmVXaXRoKHRoaXMsYXJndW1lbnRzKSx0aGlzfSxmaXJlZDpmdW5jdGlvbigpe3JldHVybiEhZH19O3JldHVybiBqfTtmdW5jdGlvbiBOKGEpe3JldHVybiBhfWZ1bmN0aW9uIE8oYSl7dGhyb3cgYX1mdW5jdGlvbiBQKGEsYixjLGQpe3ZhciBlO3RyeXthJiZyLmlzRnVuY3Rpb24oZT1hLnByb21pc2UpP2UuY2FsbChhKS5kb25lKGIpLmZhaWwoYyk6YSYmci5pc0Z1bmN0aW9uKGU9YS50aGVuKT9lLmNhbGwoYSxiLGMpOmIuYXBwbHkodm9pZCAwLFthXS5zbGljZShkKSl9Y2F0Y2goYSl7Yy5hcHBseSh2b2lkIDAsW2FdKX19ci5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKGIpe3ZhciBjPVtbIm5vdGlmeSIsInByb2dyZXNzIixyLkNhbGxiYWNrcygibWVtb3J5Iiksci5DYWxsYmFja3MoIm1lbW9yeSIpLDJdLFsicmVzb2x2ZSIsImRvbmUiLHIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDAsInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIixyLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSxyLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwxLCJyZWplY3RlZCJdXSxkPSJwZW5kaW5nIixlPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiBkfSxhbHdheXM6ZnVuY3Rpb24oKXtyZXR1cm4gZi5kb25lKGFyZ3VtZW50cykuZmFpbChhcmd1bWVudHMpLHRoaXN9LCJjYXRjaCI6ZnVuY3Rpb24oYSl7cmV0dXJuIGUudGhlbihudWxsLGEpfSxwaXBlOmZ1bmN0aW9uKCl7dmFyIGE9YXJndW1lbnRzO3JldHVybiByLkRlZmVycmVkKGZ1bmN0aW9uKGIpe3IuZWFjaChjLGZ1bmN0aW9uKGMsZCl7dmFyIGU9ci5pc0Z1bmN0aW9uKGFbZFs0XV0pJiZhW2RbNF1dO2ZbZFsxXV0oZnVuY3Rpb24oKXt2YXIgYT1lJiZlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTthJiZyLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9hLnByb21pc2UoKS5wcm9ncmVzcyhiLm5vdGlmeSkuZG9uZShiLnJlc29sdmUpLmZhaWwoYi5yZWplY3QpOmJbZFswXSsiV2l0aCJdKHRoaXMsZT9bYV06YXJndW1lbnRzKX0pfSksYT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKGIsZCxlKXt2YXIgZj0wO2Z1bmN0aW9uIGcoYixjLGQsZSl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGg9dGhpcyxpPWFyZ3VtZW50cyxqPWZ1bmN0aW9uKCl7dmFyIGEsajtpZighKGI8Zikpe2lmKGE9ZC5hcHBseShoLGkpLGE9PT1jLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTtqPWEmJigib2JqZWN0Ij09dHlwZW9mIGF8fCJmdW5jdGlvbiI9PXR5cGVvZiBhKSYmYS50aGVuLHIuaXNGdW5jdGlvbihqKT9lP2ouY2FsbChhLGcoZixjLE4sZSksZyhmLGMsTyxlKSk6KGYrKyxqLmNhbGwoYSxnKGYsYyxOLGUpLGcoZixjLE8sZSksZyhmLGMsTixjLm5vdGlmeVdpdGgpKSk6KGQhPT1OJiYoaD12b2lkIDAsaT1bYV0pLChlfHxjLnJlc29sdmVXaXRoKShoLGkpKX19LGs9ZT9qOmZ1bmN0aW9uKCl7dHJ5e2ooKX1jYXRjaChhKXtyLkRlZmVycmVkLmV4Y2VwdGlvbkhvb2smJnIuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayhhLGsuc3RhY2tUcmFjZSksYisxPj1mJiYoZCE9PU8mJihoPXZvaWQgMCxpPVthXSksYy5yZWplY3RXaXRoKGgsaSkpfX07Yj9rKCk6KHIuRGVmZXJyZWQuZ2V0U3RhY2tIb29rJiYoay5zdGFja1RyYWNlPXIuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKCkpLGEuc2V0VGltZW91dChrKSl9fXJldHVybiByLkRlZmVycmVkKGZ1bmN0aW9uKGEpe2NbMF1bM10uYWRkKGcoMCxhLHIuaXNGdW5jdGlvbihlKT9lOk4sYS5ub3RpZnlXaXRoKSksY1sxXVszXS5hZGQoZygwLGEsci5pc0Z1bmN0aW9uKGIpP2I6TikpLGNbMl1bM10uYWRkKGcoMCxhLHIuaXNGdW5jdGlvbihkKT9kOk8pKX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbCE9YT9yLmV4dGVuZChhLGUpOmV9fSxmPXt9O3JldHVybiByLmVhY2goYyxmdW5jdGlvbihhLGIpe3ZhciBnPWJbMl0saD1iWzVdO2VbYlsxXV09Zy5hZGQsaCYmZy5hZGQoZnVuY3Rpb24oKXtkPWh9LGNbMy1hXVsyXS5kaXNhYmxlLGNbMF1bMl0ubG9jayksZy5hZGQoYlszXS5maXJlKSxmW2JbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIGZbYlswXSsiV2l0aCJdKHRoaXM9PT1mP3ZvaWQgMDp0aGlzLGFyZ3VtZW50cyksdGhpc30sZltiWzBdKyJXaXRoIl09Zy5maXJlV2l0aH0pLGUucHJvbWlzZShmKSxiJiZiLmNhbGwoZixmKSxmfSx3aGVuOmZ1bmN0aW9uKGEpe3ZhciBiPWFyZ3VtZW50cy5sZW5ndGgsYz1iLGQ9QXJyYXkoYyksZT1mLmNhbGwoYXJndW1lbnRzKSxnPXIuRGVmZXJyZWQoKSxoPWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihjKXtkW2FdPXRoaXMsZVthXT1hcmd1bWVudHMubGVuZ3RoPjE/Zi5jYWxsKGFyZ3VtZW50cyk6YywtLWJ8fGcucmVzb2x2ZVdpdGgoZCxlKX19O2lmKGI8PTEmJihQKGEsZy5kb25lKGgoYykpLnJlc29sdmUsZy5yZWplY3QsIWIpLCJwZW5kaW5nIj09PWcuc3RhdGUoKXx8ci5pc0Z1bmN0aW9uKGVbY10mJmVbY10udGhlbikpKXJldHVybiBnLnRoZW4oKTt3aGlsZShjLS0pUChlW2NdLGgoYyksZy5yZWplY3QpO3JldHVybiBnLnByb21pc2UoKX19KTt2YXIgUT0vXihFdmFsfEludGVybmFsfFJhbmdlfFJlZmVyZW5jZXxTeW50YXh8VHlwZXxVUkkpRXJyb3IkLztyLkRlZmVycmVkLmV4Y2VwdGlvbkhvb2s9ZnVuY3Rpb24oYixjKXthLmNvbnNvbGUmJmEuY29uc29sZS53YXJuJiZiJiZRLnRlc3QoYi5uYW1lKSYmYS5jb25zb2xlLndhcm4oImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246ICIrYi5tZXNzYWdlLGIuc3RhY2ssYyl9LHIucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24oYil7YS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dGhyb3cgYn0pfTt2YXIgUj1yLkRlZmVycmVkKCk7ci5mbi5yZWFkeT1mdW5jdGlvbihhKXtyZXR1cm4gUi50aGVuKGEpWyJjYXRjaCJdKGZ1bmN0aW9uKGEpe3IucmVhZHlFeGNlcHRpb24oYSl9KSx0aGlzfSxyLmV4dGVuZCh7aXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxyZWFkeTpmdW5jdGlvbihhKXsoYT09PSEwPy0tci5yZWFkeVdhaXQ6ci5pc1JlYWR5KXx8KHIuaXNSZWFkeT0hMCxhIT09ITAmJi0tci5yZWFkeVdhaXQ+MHx8Ui5yZXNvbHZlV2l0aChkLFtyXSkpfX0pLHIucmVhZHkudGhlbj1SLnRoZW47ZnVuY3Rpb24gUygpe2QucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsUyksCmEucmVtb3ZlRXZlbnRMaXN0ZW5lcigibG9hZCIsUyksci5yZWFkeSgpfSJjb21wbGV0ZSI9PT1kLnJlYWR5U3RhdGV8fCJsb2FkaW5nIiE9PWQucmVhZHlTdGF0ZSYmIWQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsP2Euc2V0VGltZW91dChyLnJlYWR5KTooZC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixTKSxhLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLFMpKTt2YXIgVD1mdW5jdGlvbihhLGIsYyxkLGUsZixnKXt2YXIgaD0wLGk9YS5sZW5ndGgsaj1udWxsPT1jO2lmKCJvYmplY3QiPT09ci50eXBlKGMpKXtlPSEwO2ZvcihoIGluIGMpVChhLGIsaCxjW2hdLCEwLGYsZyl9ZWxzZSBpZih2b2lkIDAhPT1kJiYoZT0hMCxyLmlzRnVuY3Rpb24oZCl8fChnPSEwKSxqJiYoZz8oYi5jYWxsKGEsZCksYj1udWxsKTooaj1iLGI9ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBqLmNhbGwocihhKSxjKX0pKSxiKSlmb3IoO2g8aTtoKyspYihhW2hdLGMsZz9kOmQuY2FsbChhW2hdLGgsYihhW2hdLGMpKSk7cmV0dXJuIGU/YTpqP2IuY2FsbChhKTppP2IoYVswXSxjKTpmfSxVPWZ1bmN0aW9uKGEpe3JldHVybiAxPT09YS5ub2RlVHlwZXx8OT09PWEubm9kZVR5cGV8fCErYS5ub2RlVHlwZX07ZnVuY3Rpb24gVigpe3RoaXMuZXhwYW5kbz1yLmV4cGFuZG8rVi51aWQrK31WLnVpZD0xLFYucHJvdG90eXBlPXtjYWNoZTpmdW5jdGlvbihhKXt2YXIgYj1hW3RoaXMuZXhwYW5kb107cmV0dXJuIGJ8fChiPXt9LFUoYSkmJihhLm5vZGVUeXBlP2FbdGhpcy5leHBhbmRvXT1iOk9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLHRoaXMuZXhwYW5kbyx7dmFsdWU6Yixjb25maWd1cmFibGU6ITB9KSkpLGJ9LHNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZT10aGlzLmNhY2hlKGEpO2lmKCJzdHJpbmciPT10eXBlb2YgYillW3IuY2FtZWxDYXNlKGIpXT1jO2Vsc2UgZm9yKGQgaW4gYillW3IuY2FtZWxDYXNlKGQpXT1iW2RdO3JldHVybiBlfSxnZXQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdm9pZCAwPT09Yj90aGlzLmNhY2hlKGEpOmFbdGhpcy5leHBhbmRvXSYmYVt0aGlzLmV4cGFuZG9dW3IuY2FtZWxDYXNlKGIpXX0sYWNjZXNzOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdm9pZCAwPT09Ynx8YiYmInN0cmluZyI9PXR5cGVvZiBiJiZ2b2lkIDA9PT1jP3RoaXMuZ2V0KGEsYik6KHRoaXMuc2V0KGEsYixjKSx2b2lkIDAhPT1jP2M6Yil9LHJlbW92ZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9YVt0aGlzLmV4cGFuZG9dO2lmKHZvaWQgMCE9PWQpe2lmKHZvaWQgMCE9PWIpe0FycmF5LmlzQXJyYXkoYik/Yj1iLm1hcChyLmNhbWVsQ2FzZSk6KGI9ci5jYW1lbENhc2UoYiksYj1iIGluIGQ/W2JdOmIubWF0Y2goTCl8fFtdKSxjPWIubGVuZ3RoO3doaWxlKGMtLSlkZWxldGUgZFtiW2NdXX0odm9pZCAwPT09Ynx8ci5pc0VtcHR5T2JqZWN0KGQpKSYmKGEubm9kZVR5cGU/YVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgYVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oYSl7dmFyIGI9YVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT1iJiYhci5pc0VtcHR5T2JqZWN0KGIpfX07dmFyIFc9bmV3IFYsWD1uZXcgVixZPS9eKD86XHtbXHdcV10qXH18XFtbXHdcV10qXF0pJC8sWj0vW0EtWl0vZztmdW5jdGlvbiAkKGEpe3JldHVybiJ0cnVlIj09PWF8fCJmYWxzZSIhPT1hJiYoIm51bGwiPT09YT9udWxsOmE9PT0rYSsiIj8rYTpZLnRlc3QoYSk/SlNPTi5wYXJzZShhKTphKX1mdW5jdGlvbiBfKGEsYixjKXt2YXIgZDtpZih2b2lkIDA9PT1jJiYxPT09YS5ub2RlVHlwZSlpZihkPSJkYXRhLSIrYi5yZXBsYWNlKFosIi0kJiIpLnRvTG93ZXJDYXNlKCksYz1hLmdldEF0dHJpYnV0ZShkKSwic3RyaW5nIj09dHlwZW9mIGMpe3RyeXtjPSQoYyl9Y2F0Y2goZSl7fVguc2V0KGEsYixjKX1lbHNlIGM9dm9pZCAwO3JldHVybiBjfXIuZXh0ZW5kKHtoYXNEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiBYLmhhc0RhdGEoYSl8fFcuaGFzRGF0YShhKX0sZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIFguYWNjZXNzKGEsYixjKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihhLGIpe1gucmVtb3ZlKGEsYil9LF9kYXRhOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gVy5hY2Nlc3MoYSxiLGMpfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihhLGIpe1cucmVtb3ZlKGEsYil9fSksci5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZj10aGlzWzBdLGc9ZiYmZi5hdHRyaWJ1dGVzO2lmKHZvaWQgMD09PWEpe2lmKHRoaXMubGVuZ3RoJiYoZT1YLmdldChmKSwxPT09Zi5ub2RlVHlwZSYmIVcuZ2V0KGYsImhhc0RhdGFBdHRycyIpKSl7Yz1nLmxlbmd0aDt3aGlsZShjLS0pZ1tjXSYmKGQ9Z1tjXS5uYW1lLDA9PT1kLmluZGV4T2YoImRhdGEtIikmJihkPXIuY2FtZWxDYXNlKGQuc2xpY2UoNSkpLF8oZixkLGVbZF0pKSk7Vy5zZXQoZiwiaGFzRGF0YUF0dHJzIiwhMCl9cmV0dXJuIGV9cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBhP3RoaXMuZWFjaChmdW5jdGlvbigpe1guc2V0KHRoaXMsYSl9KTpUKHRoaXMsZnVuY3Rpb24oYil7dmFyIGM7aWYoZiYmdm9pZCAwPT09Yil7aWYoYz1YLmdldChmLGEpLHZvaWQgMCE9PWMpcmV0dXJuIGM7aWYoYz1fKGYsYSksdm9pZCAwIT09YylyZXR1cm4gY31lbHNlIHRoaXMuZWFjaChmdW5jdGlvbigpe1guc2V0KHRoaXMsYSxiKX0pfSxudWxsLGIsYXJndW1lbnRzLmxlbmd0aD4xLG51bGwsITApfSxyZW1vdmVEYXRhOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtYLnJlbW92ZSh0aGlzLGEpfSl9fSksci5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZDtpZihhKXJldHVybiBiPShifHwiZngiKSsicXVldWUiLGQ9Vy5nZXQoYSxiKSxjJiYoIWR8fEFycmF5LmlzQXJyYXkoYyk/ZD1XLmFjY2VzcyhhLGIsci5tYWtlQXJyYXkoYykpOmQucHVzaChjKSksZHx8W119LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fCJmeCI7dmFyIGM9ci5xdWV1ZShhLGIpLGQ9Yy5sZW5ndGgsZT1jLnNoaWZ0KCksZj1yLl9xdWV1ZUhvb2tzKGEsYiksZz1mdW5jdGlvbigpe3IuZGVxdWV1ZShhLGIpfTsiaW5wcm9ncmVzcyI9PT1lJiYoZT1jLnNoaWZ0KCksZC0tKSxlJiYoImZ4Ij09PWImJmMudW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBmLnN0b3AsZS5jYWxsKGEsZyxmKSksIWQmJmYmJmYuZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihhLGIpe3ZhciBjPWIrInF1ZXVlSG9va3MiO3JldHVybiBXLmdldChhLGMpfHxXLmFjY2VzcyhhLGMse2VtcHR5OnIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe1cucmVtb3ZlKGEsW2IrInF1ZXVlIixjXSl9KX0pfX0pLHIuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9ImZ4IixjLS0pLGFyZ3VtZW50cy5sZW5ndGg8Yz9yLnF1ZXVlKHRoaXNbMF0sYSk6dm9pZCAwPT09Yj90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPXIucXVldWUodGhpcyxhLGIpO3IuX3F1ZXVlSG9va3ModGhpcyxhKSwiZngiPT09YSYmImlucHJvZ3Jlc3MiIT09Y1swXSYmci5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ci5kZXF1ZXVlKHRoaXMsYSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MSxlPXIuRGVmZXJyZWQoKSxmPXRoaXMsZz10aGlzLmxlbmd0aCxoPWZ1bmN0aW9uKCl7LS1kfHxlLnJlc29sdmVXaXRoKGYsW2ZdKX07InN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxhPWF8fCJmeCI7d2hpbGUoZy0tKWM9Vy5nZXQoZltnXSxhKyJxdWV1ZUhvb2tzIiksYyYmYy5lbXB0eSYmKGQrKyxjLmVtcHR5LmFkZChoKSk7cmV0dXJuIGgoKSxlLnByb21pc2UoYil9fSk7dmFyIGFhPS9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8uc291cmNlLGJhPW5ldyBSZWdFeHAoIl4oPzooWystXSk9fCkoIithYSsiKShbYS16JV0qKSQiLCJpIiksY2E9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxkYT1mdW5jdGlvbihhLGIpe3JldHVybiBhPWJ8fGEsIm5vbmUiPT09YS5zdHlsZS5kaXNwbGF5fHwiIj09PWEuc3R5bGUuZGlzcGxheSYmci5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSkmJiJub25lIj09PXIuY3NzKGEsImRpc3BsYXkiKX0sZWE9ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnPXt9O2ZvcihmIGluIGIpZ1tmXT1hLnN0eWxlW2ZdLGEuc3R5bGVbZl09YltmXTtlPWMuYXBwbHkoYSxkfHxbXSk7Zm9yKGYgaW4gYilhLnN0eWxlW2ZdPWdbZl07cmV0dXJuIGV9O2Z1bmN0aW9uIGZhKGEsYixjLGQpe3ZhciBlLGY9MSxnPTIwLGg9ZD9mdW5jdGlvbigpe3JldHVybiBkLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiByLmNzcyhhLGIsIiIpfSxpPWgoKSxqPWMmJmNbM118fChyLmNzc051bWJlcltiXT8iIjoicHgiKSxrPShyLmNzc051bWJlcltiXXx8InB4IiE9PWomJitpKSYmYmEuZXhlYyhyLmNzcyhhLGIpKTtpZihrJiZrWzNdIT09ail7aj1qfHxrWzNdLGM9Y3x8W10saz0raXx8MTtkbyBmPWZ8fCIuNSIsay89ZixyLnN0eWxlKGEsYixrK2opO3doaWxlKGYhPT0oZj1oKCkvaSkmJjEhPT1mJiYtLWcpfXJldHVybiBjJiYoaz0ra3x8K2l8fDAsZT1jWzFdP2srKGNbMV0rMSkqY1syXTorY1syXSxkJiYoZC51bml0PWosZC5zdGFydD1rLGQuZW5kPWUpKSxlfXZhciBnYT17fTtmdW5jdGlvbiBoYShhKXt2YXIgYixjPWEub3duZXJEb2N1bWVudCxkPWEubm9kZU5hbWUsZT1nYVtkXTtyZXR1cm4gZT9lOihiPWMuYm9keS5hcHBlbmRDaGlsZChjLmNyZWF0ZUVsZW1lbnQoZCkpLGU9ci5jc3MoYiwiZGlzcGxheSIpLGIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKSwibm9uZSI9PT1lJiYoZT0iYmxvY2siKSxnYVtkXT1lLGUpfWZ1bmN0aW9uIGlhKGEsYil7Zm9yKHZhciBjLGQsZT1bXSxmPTAsZz1hLmxlbmd0aDtmPGc7ZisrKWQ9YVtmXSxkLnN0eWxlJiYoYz1kLnN0eWxlLmRpc3BsYXksYj8oIm5vbmUiPT09YyYmKGVbZl09Vy5nZXQoZCwiZGlzcGxheSIpfHxudWxsLGVbZl18fChkLnN0eWxlLmRpc3BsYXk9IiIpKSwiIj09PWQuc3R5bGUuZGlzcGxheSYmZGEoZCkmJihlW2ZdPWhhKGQpKSk6Im5vbmUiIT09YyYmKGVbZl09Im5vbmUiLFcuc2V0KGQsImRpc3BsYXkiLGMpKSk7Zm9yKGY9MDtmPGc7ZisrKW51bGwhPWVbZl0mJihhW2ZdLnN0eWxlLmRpc3BsYXk9ZVtmXSk7cmV0dXJuIGF9ci5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oKXtyZXR1cm4gaWEodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gaWEodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihhKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBhP2E/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7ZGEodGhpcyk/cih0aGlzKS5zaG93KCk6cih0aGlzKS5oaWRlKCl9KX19KTt2YXIgamE9L14oPzpjaGVja2JveHxyYWRpbykkL2ksa2E9LzwoW2Etel1bXlwvXDA+XHgyMFx0XHJcblxmXSspL2ksbGE9L14kfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLG1hPXtvcHRpb246WzEsIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCI8L3NlbGVjdD4iXSx0aGVhZDpbMSwiPHRhYmxlPiIsIjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSx0cjpbMiwiPHRhYmxlPjx0Ym9keT4iLCI8L3Rib2R5PjwvdGFibGU+Il0sdGQ6WzMsIjx0YWJsZT48dGJvZHk+PHRyPiIsIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07bWEub3B0Z3JvdXA9bWEub3B0aW9uLG1hLnRib2R5PW1hLnRmb290PW1hLmNvbGdyb3VwPW1hLmNhcHRpb249bWEudGhlYWQsbWEudGg9bWEudGQ7ZnVuY3Rpb24gbmEoYSxiKXt2YXIgYztyZXR1cm4gYz0idW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWU/YS5nZXRFbGVtZW50c0J5VGFnTmFtZShifHwiKiIpOiJ1bmRlZmluZWQiIT10eXBlb2YgYS5xdWVyeVNlbGVjdG9yQWxsP2EucXVlcnlTZWxlY3RvckFsbChifHwiKiIpOltdLHZvaWQgMD09PWJ8fGImJkIoYSxiKT9yLm1lcmdlKFthXSxjKTpjfWZ1bmN0aW9uIG9hKGEsYil7Zm9yKHZhciBjPTAsZD1hLmxlbmd0aDtjPGQ7YysrKVcuc2V0KGFbY10sImdsb2JhbEV2YWwiLCFifHxXLmdldChiW2NdLCJnbG9iYWxFdmFsIikpfXZhciBwYT0vPHwmIz9cdys7LztmdW5jdGlvbiBxYShhLGIsYyxkLGUpe2Zvcih2YXIgZixnLGgsaSxqLGssbD1iLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxtPVtdLG49MCxvPWEubGVuZ3RoO248bztuKyspaWYoZj1hW25dLGZ8fDA9PT1mKWlmKCJvYmplY3QiPT09ci50eXBlKGYpKXIubWVyZ2UobSxmLm5vZGVUeXBlP1tmXTpmKTtlbHNlIGlmKHBhLnRlc3QoZikpe2c9Z3x8bC5hcHBlbmRDaGlsZChiLmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxoPShrYS5leGVjKGYpfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLGk9bWFbaF18fG1hLl9kZWZhdWx0LGcuaW5uZXJIVE1MPWlbMV0rci5odG1sUHJlZmlsdGVyKGYpK2lbMl0saz1pWzBdO3doaWxlKGstLSlnPWcubGFzdENoaWxkO3IubWVyZ2UobSxnLmNoaWxkTm9kZXMpLGc9bC5maXJzdENoaWxkLGcudGV4dENvbnRlbnQ9IiJ9ZWxzZSBtLnB1c2goYi5jcmVhdGVUZXh0Tm9kZShmKSk7bC50ZXh0Q29udGVudD0iIixuPTA7d2hpbGUoZj1tW24rK10paWYoZCYmci5pbkFycmF5KGYsZCk+LTEpZSYmZS5wdXNoKGYpO2Vsc2UgaWYoaj1yLmNvbnRhaW5zKGYub3duZXJEb2N1bWVudCxmKSxnPW5hKGwuYXBwZW5kQ2hpbGQoZiksInNjcmlwdCIpLGomJm9hKGcpLGMpe2s9MDt3aGlsZShmPWdbaysrXSlsYS50ZXN0KGYudHlwZXx8IiIpJiZjLnB1c2goZil9cmV0dXJuIGx9IWZ1bmN0aW9uKCl7dmFyIGE9ZC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksYj1hLmFwcGVuZENoaWxkKGQuY3JlYXRlRWxlbWVudCgiZGl2IikpLGM9ZC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpO2Muc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSxjLnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSxjLnNldEF0dHJpYnV0ZSgibmFtZSIsInQiKSxiLmFwcGVuZENoaWxkKGMpLG8uY2hlY2tDbG9uZT1iLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxiLmlubmVySFRNTD0iPHRleHRhcmVhPng8L3RleHRhcmVhPiIsby5ub0Nsb25lQ2hlY2tlZD0hIWIuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlfSgpO3ZhciByYT1kLmRvY3VtZW50RWxlbWVudCxzYT0vXmtleS8sdGE9L14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLHVhPS9eKFteLl0qKSg/OlwuKC4rKXwpLztmdW5jdGlvbiB2YSgpe3JldHVybiEwfWZ1bmN0aW9uIHdhKCl7cmV0dXJuITF9ZnVuY3Rpb24geGEoKXt0cnl7cmV0dXJuIGQuYWN0aXZlRWxlbWVudH1jYXRjaChhKXt9fWZ1bmN0aW9uIHlhKGEsYixjLGQsZSxmKXt2YXIgZyxoO2lmKCJvYmplY3QiPT10eXBlb2YgYil7InN0cmluZyIhPXR5cGVvZiBjJiYoZD1kfHxjLGM9dm9pZCAwKTtmb3IoaCBpbiBiKXlhKGEsaCxjLGQsYltoXSxmKTtyZXR1cm4gYX1pZihudWxsPT1kJiZudWxsPT1lPyhlPWMsZD1jPXZvaWQgMCk6bnVsbD09ZSYmKCJzdHJpbmciPT10eXBlb2YgYz8oZT1kLGQ9dm9pZCAwKTooZT1kLGQ9YyxjPXZvaWQgMCkpLGU9PT0hMSllPXdhO2Vsc2UgaWYoIWUpcmV0dXJuIGE7cmV0dXJuIDE9PT1mJiYoZz1lLGU9ZnVuY3Rpb24oYSl7cmV0dXJuIHIoKS5vZmYoYSksZy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGUuZ3VpZD1nLmd1aWR8fChnLmd1aWQ9ci5ndWlkKyspKSxhLmVhY2goZnVuY3Rpb24oKXtyLmV2ZW50LmFkZCh0aGlzLGIsZSxkLGMpfSl9ci5ldmVudD17Z2xvYmFsOnt9LGFkZDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmLGcsaCxpLGosayxsLG0sbixvLHAscT1XLmdldChhKTtpZihxKXtjLmhhbmRsZXImJihmPWMsYz1mLmhhbmRsZXIsZT1mLnNlbGVjdG9yKSxlJiZyLmZpbmQubWF0Y2hlc1NlbGVjdG9yKHJhLGUpLGMuZ3VpZHx8KGMuZ3VpZD1yLmd1aWQrKyksKGk9cS5ldmVudHMpfHwoaT1xLmV2ZW50cz17fSksKGc9cS5oYW5kbGUpfHwoZz1xLmhhbmRsZT1mdW5jdGlvbihiKXtyZXR1cm4idW5kZWZpbmVkIiE9dHlwZW9mIHImJnIuZXZlbnQudHJpZ2dlcmVkIT09Yi50eXBlP3IuZXZlbnQuZGlzcGF0Y2guYXBwbHkoYSxhcmd1bWVudHMpOnZvaWQgMH0pLGI9KGJ8fCIiKS5tYXRjaChMKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSloPXVhLmV4ZWMoYltqXSl8fFtdLG49cD1oWzFdLG89KGhbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxuJiYobD1yLmV2ZW50LnNwZWNpYWxbbl18fHt9LG49KGU/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG4sbD1yLmV2ZW50LnNwZWNpYWxbbl18fHt9LGs9ci5leHRlbmQoe3R5cGU6bixvcmlnVHlwZTpwLGRhdGE6ZCxoYW5kbGVyOmMsZ3VpZDpjLmd1aWQsc2VsZWN0b3I6ZSxuZWVkc0NvbnRleHQ6ZSYmci5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGUpLG5hbWVzcGFjZTpvLmpvaW4oIi4iKX0sZiksKG09aVtuXSl8fChtPWlbbl09W10sbS5kZWxlZ2F0ZUNvdW50PTAsbC5zZXR1cCYmbC5zZXR1cC5jYWxsKGEsZCxvLGcpIT09ITF8fGEuYWRkRXZlbnRMaXN0ZW5lciYmYS5hZGRFdmVudExpc3RlbmVyKG4sZykpLGwuYWRkJiYobC5hZGQuY2FsbChhLGspLGsuaGFuZGxlci5ndWlkfHwoay5oYW5kbGVyLmd1aWQ9Yy5ndWlkKSksZT9tLnNwbGljZShtLmRlbGVnYXRlQ291bnQrKywwLGspOm0ucHVzaChrKSxyLmV2ZW50Lmdsb2JhbFtuXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG4sbyxwLHE9Vy5oYXNEYXRhKGEpJiZXLmdldChhKTtpZihxJiYoaT1xLmV2ZW50cykpe2I9KGJ8fCIiKS5tYXRjaChMKXx8WyIiXSxqPWIubGVuZ3RoO3doaWxlKGotLSlpZihoPXVhLmV4ZWMoYltqXSl8fFtdLG49cD1oWzFdLG89KGhbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxuKXtsPXIuZXZlbnQuc3BlY2lhbFtuXXx8e30sbj0oZD9sLmRlbGVnYXRlVHlwZTpsLmJpbmRUeXBlKXx8bixtPWlbbl18fFtdLGg9aFsyXSYmbmV3IFJlZ0V4cCgiKF58XFwuKSIrby5qb2luKCJcXC4oPzouKlxcLnwpIikrIihcXC58JCkiKSxnPWY9bS5sZW5ndGg7d2hpbGUoZi0tKWs9bVtmXSwhZSYmcCE9PWsub3JpZ1R5cGV8fGMmJmMuZ3VpZCE9PWsuZ3VpZHx8aCYmIWgudGVzdChrLm5hbWVzcGFjZSl8fGQmJmQhPT1rLnNlbGVjdG9yJiYoIioqIiE9PWR8fCFrLnNlbGVjdG9yKXx8KG0uc3BsaWNlKGYsMSksay5zZWxlY3RvciYmbS5kZWxlZ2F0ZUNvdW50LS0sbC5yZW1vdmUmJmwucmVtb3ZlLmNhbGwoYSxrKSk7ZyYmIW0ubGVuZ3RoJiYobC50ZWFyZG93biYmbC50ZWFyZG93bi5jYWxsKGEsbyxxLmhhbmRsZSkhPT0hMXx8ci5yZW1vdmVFdmVudChhLG4scS5oYW5kbGUpLGRlbGV0ZSBpW25dKX1lbHNlIGZvcihuIGluIGkpci5ldmVudC5yZW1vdmUoYSxuK2Jbal0sYyxkLCEwKTtyLmlzRW1wdHlPYmplY3QoaSkmJlcucmVtb3ZlKGEsImhhbmRsZSBldmVudHMiKX19LGRpc3BhdGNoOmZ1bmN0aW9uKGEpe3ZhciBiPXIuZXZlbnQuZml4KGEpLGMsZCxlLGYsZyxoLGk9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLGo9KFcuZ2V0KHRoaXMsImV2ZW50cyIpfHx7fSlbYi50eXBlXXx8W10saz1yLmV2ZW50LnNwZWNpYWxbYi50eXBlXXx8e307Zm9yKGlbMF09YixjPTE7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKylpW2NdPWFyZ3VtZW50c1tjXTtpZihiLmRlbGVnYXRlVGFyZ2V0PXRoaXMsIWsucHJlRGlzcGF0Y2h8fGsucHJlRGlzcGF0Y2guY2FsbCh0aGlzLGIpIT09ITEpe2g9ci5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsYixqKSxjPTA7d2hpbGUoKGY9aFtjKytdKSYmIWIuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSl7Yi5jdXJyZW50VGFyZ2V0PWYuZWxlbSxkPTA7d2hpbGUoKGc9Zi5oYW5kbGVyc1tkKytdKSYmIWIuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSliLnJuYW1lc3BhY2UmJiFiLnJuYW1lc3BhY2UudGVzdChnLm5hbWVzcGFjZSl8fChiLmhhbmRsZU9iaj1nLGIuZGF0YT1nLmRhdGEsZT0oKHIuZXZlbnQuc3BlY2lhbFtnLm9yaWdUeXBlXXx8e30pLmhhbmRsZXx8Zy5oYW5kbGVyKS5hcHBseShmLmVsZW0saSksdm9pZCAwIT09ZSYmKGIucmVzdWx0PWUpPT09ITEmJihiLnByZXZlbnREZWZhdWx0KCksYi5zdG9wUHJvcGFnYXRpb24oKSkpfXJldHVybiBrLnBvc3REaXNwYXRjaCYmay5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLGIpLGIucmVzdWx0fX0saGFuZGxlcnM6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkLGUsZixnLGg9W10saT1iLmRlbGVnYXRlQ291bnQsaj1hLnRhcmdldDtpZihpJiZqLm5vZGVUeXBlJiYhKCJjbGljayI9PT1hLnR5cGUmJmEuYnV0dG9uPj0xKSlmb3IoO2ohPT10aGlzO2o9ai5wYXJlbnROb2RlfHx0aGlzKWlmKDE9PT1qLm5vZGVUeXBlJiYoImNsaWNrIiE9PWEudHlwZXx8ai5kaXNhYmxlZCE9PSEwKSl7Zm9yKGY9W10sZz17fSxjPTA7YzxpO2MrKylkPWJbY10sZT1kLnNlbGVjdG9yKyIgIix2b2lkIDA9PT1nW2VdJiYoZ1tlXT1kLm5lZWRzQ29udGV4dD9yKGUsdGhpcykuaW5kZXgoaik+LTE6ci5maW5kKGUsdGhpcyxudWxsLFtqXSkubGVuZ3RoKSxnW2VdJiZmLnB1c2goZCk7Zi5sZW5ndGgmJmgucHVzaCh7ZWxlbTpqLGhhbmRsZXJzOmZ9KX1yZXR1cm4gaj10aGlzLGk8Yi5sZW5ndGgmJmgucHVzaCh7ZWxlbTpqLGhhbmRsZXJzOmIuc2xpY2UoaSl9KSxofSxhZGRQcm9wOmZ1bmN0aW9uKGEsYil7T2JqZWN0LmRlZmluZVByb3BlcnR5KHIuRXZlbnQucHJvdG90eXBlLGEse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLGdldDpyLmlzRnVuY3Rpb24oYik/ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIGIodGhpcy5vcmlnaW5hbEV2ZW50KX06ZnVuY3Rpb24oKXtpZih0aGlzLm9yaWdpbmFsRXZlbnQpcmV0dXJuIHRoaXMub3JpZ2luYWxFdmVudFthXX0sc2V0OmZ1bmN0aW9uKGIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLGEse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwLHZhbHVlOmJ9KX19KX0sZml4OmZ1bmN0aW9uKGEpe3JldHVybiBhW3IuZXhwYW5kb10/YTpuZXcgci5FdmVudChhKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGZvY3VzOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcyE9PXhhKCkmJnRoaXMuZm9jdXMpcmV0dXJuIHRoaXMuZm9jdXMoKSwhMX0sZGVsZWdhdGVUeXBlOiJmb2N1c2luIn0sYmx1cjp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKHRoaXM9PT14YSgpJiZ0aGlzLmJsdXIpcmV0dXJuIHRoaXMuYmx1cigpLCExfSxkZWxlZ2F0ZVR5cGU6ImZvY3Vzb3V0In0sY2xpY2s6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZigiY2hlY2tib3giPT09dGhpcy50eXBlJiZ0aGlzLmNsaWNrJiZCKHRoaXMsImlucHV0IikpcmV0dXJuIHRoaXMuY2xpY2soKSwhMX0sX2RlZmF1bHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIEIoYS50YXJnZXQsImEiKX19LGJlZm9yZXVubG9hZDp7cG9zdERpc3BhdGNoOmZ1bmN0aW9uKGEpe3ZvaWQgMCE9PWEucmVzdWx0JiZhLm9yaWdpbmFsRXZlbnQmJihhLm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWU9YS5yZXN1bHQpfX19fSxyLnJlbW92ZUV2ZW50PWZ1bmN0aW9uKGEsYixjKXthLnJlbW92ZUV2ZW50TGlzdGVuZXImJmEucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLGMpfSxyLkV2ZW50PWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMgaW5zdGFuY2VvZiByLkV2ZW50PyhhJiZhLnR5cGU/KHRoaXMub3JpZ2luYWxFdmVudD1hLHRoaXMudHlwZT1hLnR5cGUsdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9YS5kZWZhdWx0UHJldmVudGVkfHx2b2lkIDA9PT1hLmRlZmF1bHRQcmV2ZW50ZWQmJmEucmV0dXJuVmFsdWU9PT0hMT92YTp3YSx0aGlzLnRhcmdldD1hLnRhcmdldCYmMz09PWEudGFyZ2V0Lm5vZGVUeXBlP2EudGFyZ2V0LnBhcmVudE5vZGU6YS50YXJnZXQsdGhpcy5jdXJyZW50VGFyZ2V0PWEuY3VycmVudFRhcmdldCx0aGlzLnJlbGF0ZWRUYXJnZXQ9YS5yZWxhdGVkVGFyZ2V0KTp0aGlzLnR5cGU9YSxiJiZyLmV4dGVuZCh0aGlzLGIpLHRoaXMudGltZVN0YW1wPWEmJmEudGltZVN0YW1wfHxyLm5vdygpLHZvaWQodGhpc1tyLmV4cGFuZG9dPSEwKSk6bmV3IHIuRXZlbnQoYSxiKX0sci5FdmVudC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOnIuRXZlbnQsaXNEZWZhdWx0UHJldmVudGVkOndhLGlzUHJvcGFnYXRpb25TdG9wcGVkOndhLGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOndhLGlzU2ltdWxhdGVkOiExLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPXZhLGEmJiF0aGlzLmlzU2ltdWxhdGVkJiZhLnByZXZlbnREZWZhdWx0KCl9LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkPXZhLGEmJiF0aGlzLmlzU2ltdWxhdGVkJiZhLnN0b3BQcm9wYWdhdGlvbigpfSxzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD12YSxhJiYhdGhpcy5pc1NpbXVsYXRlZCYmYS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0aGlzLnN0b3BQcm9wYWdhdGlvbigpfX0sci5lYWNoKHthbHRLZXk6ITAsYnViYmxlczohMCxjYW5jZWxhYmxlOiEwLGNoYW5nZWRUb3VjaGVzOiEwLGN0cmxLZXk6ITAsZGV0YWlsOiEwLGV2ZW50UGhhc2U6ITAsbWV0YUtleTohMCxwYWdlWDohMCxwYWdlWTohMCxzaGlmdEtleTohMCx2aWV3OiEwLCJjaGFyIjohMCxjaGFyQ29kZTohMCxrZXk6ITAsa2V5Q29kZTohMCxidXR0b246ITAsYnV0dG9uczohMCxjbGllbnRYOiEwLGNsaWVudFk6ITAsb2Zmc2V0WDohMCxvZmZzZXRZOiEwLHBvaW50ZXJJZDohMCxwb2ludGVyVHlwZTohMCxzY3JlZW5YOiEwLHNjcmVlblk6ITAsdGFyZ2V0VG91Y2hlczohMCx0b0VsZW1lbnQ6ITAsdG91Y2hlczohMCx3aGljaDpmdW5jdGlvbihhKXt2YXIgYj1hLmJ1dHRvbjtyZXR1cm4gbnVsbD09YS53aGljaCYmc2EudGVzdChhLnR5cGUpP251bGwhPWEuY2hhckNvZGU/YS5jaGFyQ29kZTphLmtleUNvZGU6IWEud2hpY2gmJnZvaWQgMCE9PWImJnRhLnRlc3QoYS50eXBlKT8xJmI/MToyJmI/Mzo0JmI/MjowOmEud2hpY2h9fSxyLmV2ZW50LmFkZFByb3ApLHIuZWFjaCh7bW91c2VlbnRlcjoibW91c2VvdmVyIixtb3VzZWxlYXZlOiJtb3VzZW91dCIscG9pbnRlcmVudGVyOiJwb2ludGVyb3ZlciIscG9pbnRlcmxlYXZlOiJwb2ludGVyb3V0In0sZnVuY3Rpb24oYSxiKXtyLmV2ZW50LnNwZWNpYWxbYV09e2RlbGVnYXRlVHlwZTpiLGJpbmRUeXBlOmIsaGFuZGxlOmZ1bmN0aW9uKGEpe3ZhciBjLGQ9dGhpcyxlPWEucmVsYXRlZFRhcmdldCxmPWEuaGFuZGxlT2JqO3JldHVybiBlJiYoZT09PWR8fHIuY29udGFpbnMoZCxlKSl8fChhLnR5cGU9Zi5vcmlnVHlwZSxjPWYuaGFuZGxlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksYS50eXBlPWIpLGN9fX0pLHIuZm4uZXh0ZW5kKHtvbjpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4geWEodGhpcyxhLGIsYyxkKX0sb25lOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB5YSh0aGlzLGEsYixjLGQsMSl9LG9mZjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZTtpZihhJiZhLnByZXZlbnREZWZhdWx0JiZhLmhhbmRsZU9iailyZXR1cm4gZD1hLmhhbmRsZU9iaixyKGEuZGVsZWdhdGVUYXJnZXQpLm9mZihkLm5hbWVzcGFjZT9kLm9yaWdUeXBlKyIuIitkLm5hbWVzcGFjZTpkLm9yaWdUeXBlLGQuc2VsZWN0b3IsZC5oYW5kbGVyKSx0aGlzO2lmKCJvYmplY3QiPT10eXBlb2YgYSl7Zm9yKGUgaW4gYSl0aGlzLm9mZihlLGIsYVtlXSk7cmV0dXJuIHRoaXN9cmV0dXJuIGIhPT0hMSYmImZ1bmN0aW9uIiE9dHlwZW9mIGJ8fChjPWIsYj12b2lkIDApLGM9PT0hMSYmKGM9d2EpLHRoaXMuZWFjaChmdW5jdGlvbigpe3IuZXZlbnQucmVtb3ZlKHRoaXMsYSxjLGIpfSl9fSk7dmFyIHphPS88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0qKVtePl0qKVwvPi9naSxBYT0vPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSxCYT0vY2hlY2tlZFxzKig/OltePV18PVxzKi5jaGVja2VkLikvaSxDYT0vXnRydWVcLyguKikvLERhPS9eXHMqPCEoPzpcW0NEQVRBXFt8LS0pfCg/OlxdXF18LS0pPlxzKiQvZztmdW5jdGlvbiBFYShhLGIpe3JldHVybiBCKGEsInRhYmxlIikmJkIoMTEhPT1iLm5vZGVUeXBlP2I6Yi5maXJzdENoaWxkLCJ0ciIpP3IoIj50Ym9keSIsYSlbMF18fGE6YX1mdW5jdGlvbiBGYShhKXtyZXR1cm4gYS50eXBlPShudWxsIT09YS5nZXRBdHRyaWJ1dGUoInR5cGUiKSkrIi8iK2EudHlwZSxhfWZ1bmN0aW9uIEdhKGEpe3ZhciBiPUNhLmV4ZWMoYS50eXBlKTtyZXR1cm4gYj9hLnR5cGU9YlsxXTphLnJlbW92ZUF0dHJpYnV0ZSgidHlwZSIpLGF9ZnVuY3Rpb24gSGEoYSxiKXt2YXIgYyxkLGUsZixnLGgsaSxqO2lmKDE9PT1iLm5vZGVUeXBlKXtpZihXLmhhc0RhdGEoYSkmJihmPVcuYWNjZXNzKGEpLGc9Vy5zZXQoYixmKSxqPWYuZXZlbnRzKSl7ZGVsZXRlIGcuaGFuZGxlLGcuZXZlbnRzPXt9O2ZvcihlIGluIGopZm9yKGM9MCxkPWpbZV0ubGVuZ3RoO2M8ZDtjKyspci5ldmVudC5hZGQoYixlLGpbZV1bY10pfVguaGFzRGF0YShhKSYmKGg9WC5hY2Nlc3MoYSksaT1yLmV4dGVuZCh7fSxoKSxYLnNldChiLGkpKX19ZnVuY3Rpb24gSWEoYSxiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7ImlucHV0Ij09PWMmJmphLnRlc3QoYS50eXBlKT9iLmNoZWNrZWQ9YS5jaGVja2VkOiJpbnB1dCIhPT1jJiYidGV4dGFyZWEiIT09Y3x8KGIuZGVmYXVsdFZhbHVlPWEuZGVmYXVsdFZhbHVlKX1mdW5jdGlvbiBKYShhLGIsYyxkKXtiPWcuYXBwbHkoW10sYik7dmFyIGUsZixoLGksaixrLGw9MCxtPWEubGVuZ3RoLG49bS0xLHE9YlswXSxzPXIuaXNGdW5jdGlvbihxKTtpZihzfHxtPjEmJiJzdHJpbmciPT10eXBlb2YgcSYmIW8uY2hlY2tDbG9uZSYmQmEudGVzdChxKSlyZXR1cm4gYS5lYWNoKGZ1bmN0aW9uKGUpe3ZhciBmPWEuZXEoZSk7cyYmKGJbMF09cS5jYWxsKHRoaXMsZSxmLmh0bWwoKSkpLEphKGYsYixjLGQpfSk7aWYobSYmKGU9cWEoYixhWzBdLm93bmVyRG9jdW1lbnQsITEsYSxkKSxmPWUuZmlyc3RDaGlsZCwxPT09ZS5jaGlsZE5vZGVzLmxlbmd0aCYmKGU9ZiksZnx8ZCkpe2ZvcihoPXIubWFwKG5hKGUsInNjcmlwdCIpLEZhKSxpPWgubGVuZ3RoO2w8bTtsKyspaj1lLGwhPT1uJiYoaj1yLmNsb25lKGosITAsITApLGkmJnIubWVyZ2UoaCxuYShqLCJzY3JpcHQiKSkpLGMuY2FsbChhW2xdLGosbCk7aWYoaSlmb3Ioaz1oW2gubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsci5tYXAoaCxHYSksbD0wO2w8aTtsKyspaj1oW2xdLGxhLnRlc3Qoai50eXBlfHwiIikmJiFXLmFjY2VzcyhqLCJnbG9iYWxFdmFsIikmJnIuY29udGFpbnMoayxqKSYmKGouc3JjP3IuX2V2YWxVcmwmJnIuX2V2YWxVcmwoai5zcmMpOnAoai50ZXh0Q29udGVudC5yZXBsYWNlKERhLCIiKSxrKSl9cmV0dXJuIGF9ZnVuY3Rpb24gS2EoYSxiLGMpe2Zvcih2YXIgZCxlPWI/ci5maWx0ZXIoYixhKTphLGY9MDtudWxsIT0oZD1lW2ZdKTtmKyspY3x8MSE9PWQubm9kZVR5cGV8fHIuY2xlYW5EYXRhKG5hKGQpKSxkLnBhcmVudE5vZGUmJihjJiZyLmNvbnRhaW5zKGQub3duZXJEb2N1bWVudCxkKSYmb2EobmEoZCwic2NyaXB0IikpLGQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkKSk7cmV0dXJuIGF9ci5leHRlbmQoe2h0bWxQcmVmaWx0ZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSh6YSwiPCQxPjwvJDI+Iil9LGNsb25lOmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuY2xvbmVOb2RlKCEwKSxpPXIuY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpO2lmKCEoby5ub0Nsb25lQ2hlY2tlZHx8MSE9PWEubm9kZVR5cGUmJjExIT09YS5ub2RlVHlwZXx8ci5pc1hNTERvYyhhKSkpZm9yKGc9bmEoaCksZj1uYShhKSxkPTAsZT1mLmxlbmd0aDtkPGU7ZCsrKUlhKGZbZF0sZ1tkXSk7aWYoYilpZihjKWZvcihmPWZ8fG5hKGEpLGc9Z3x8bmEoaCksZD0wLGU9Zi5sZW5ndGg7ZDxlO2QrKylIYShmW2RdLGdbZF0pO2Vsc2UgSGEoYSxoKTtyZXR1cm4gZz1uYShoLCJzY3JpcHQiKSxnLmxlbmd0aD4wJiZvYShnLCFpJiZuYShhLCJzY3JpcHQiKSksaH0sY2xlYW5EYXRhOmZ1bmN0aW9uKGEpe2Zvcih2YXIgYixjLGQsZT1yLmV2ZW50LnNwZWNpYWwsZj0wO3ZvaWQgMCE9PShjPWFbZl0pO2YrKylpZihVKGMpKXtpZihiPWNbVy5leHBhbmRvXSl7aWYoYi5ldmVudHMpZm9yKGQgaW4gYi5ldmVudHMpZVtkXT9yLmV2ZW50LnJlbW92ZShjLGQpOnIucmVtb3ZlRXZlbnQoYyxkLGIuaGFuZGxlKTtjW1cuZXhwYW5kb109dm9pZCAwfWNbWC5leHBhbmRvXSYmKGNbWC5leHBhbmRvXT12b2lkIDApfX19KSxyLmZuLmV4dGVuZCh7ZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiBLYSh0aGlzLGEsITApfSxyZW1vdmU6ZnVuY3Rpb24oYSl7cmV0dXJuIEthKHRoaXMsYSl9LHRleHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIFQodGhpcyxmdW5jdGlvbihhKXtyZXR1cm4gdm9pZCAwPT09YT9yLnRleHQodGhpcyk6dGhpcy5lbXB0eSgpLmVhY2goZnVuY3Rpb24oKXsxIT09dGhpcy5ub2RlVHlwZSYmMTEhPT10aGlzLm5vZGVUeXBlJiY5IT09dGhpcy5ub2RlVHlwZXx8KHRoaXMudGV4dENvbnRlbnQ9YSl9KX0sbnVsbCxhLGFyZ3VtZW50cy5sZW5ndGgpfSxhcHBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gSmEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciBiPUVhKHRoaXMsYSk7Yi5hcHBlbmRDaGlsZChhKX19KX0scHJlcGVuZDpmdW5jdGlvbigpe3JldHVybiBKYSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihhKXtpZigxPT09dGhpcy5ub2RlVHlwZXx8MTE9PT10aGlzLm5vZGVUeXBlfHw5PT09dGhpcy5ub2RlVHlwZSl7dmFyIGI9RWEodGhpcyxhKTtiLmluc2VydEJlZm9yZShhLGIuZmlyc3RDaGlsZCl9fSl9LGJlZm9yZTpmdW5jdGlvbigpe3JldHVybiBKYSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihhKXt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzKX0pfSxhZnRlcjpmdW5jdGlvbigpe3JldHVybiBKYSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihhKXt0aGlzLnBhcmVudE5vZGUmJnRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzLm5leHRTaWJsaW5nKX0pfSxlbXB0eTpmdW5jdGlvbigpe2Zvcih2YXIgYSxiPTA7bnVsbCE9KGE9dGhpc1tiXSk7YisrKTE9PT1hLm5vZGVUeXBlJiYoci5jbGVhbkRhdGEobmEoYSwhMSkpLGEudGV4dENvbnRlbnQ9IiIpO3JldHVybiB0aGlzfSxjbG9uZTpmdW5jdGlvbihhLGIpe3JldHVybiBhPW51bGwhPWEmJmEsYj1udWxsPT1iP2E6Yix0aGlzLm1hcChmdW5jdGlvbigpe3JldHVybiByLmNsb25lKHRoaXMsYSxiKX0pfSxodG1sOmZ1bmN0aW9uKGEpe3JldHVybiBUKHRoaXMsZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXXx8e30sYz0wLGQ9dGhpcy5sZW5ndGg7aWYodm9pZCAwPT09YSYmMT09PWIubm9kZVR5cGUpcmV0dXJuIGIuaW5uZXJIVE1MO2lmKCJzdHJpbmciPT10eXBlb2YgYSYmIUFhLnRlc3QoYSkmJiFtYVsoa2EuZXhlYyhhKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2E9ci5odG1sUHJlZmlsdGVyKGEpO3RyeXtmb3IoO2M8ZDtjKyspYj10aGlzW2NdfHx7fSwxPT09Yi5ub2RlVHlwZSYmKHIuY2xlYW5EYXRhKG5hKGIsITEpKSxiLmlubmVySFRNTD1hKTtiPTB9Y2F0Y2goZSl7fX1iJiZ0aGlzLmVtcHR5KCkuYXBwZW5kKGEpfSxudWxsLGEsYXJndW1lbnRzLmxlbmd0aCl9LHJlcGxhY2VXaXRoOmZ1bmN0aW9uKCl7dmFyIGE9W107cmV0dXJuIEphKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGIpe3ZhciBjPXRoaXMucGFyZW50Tm9kZTtyLmluQXJyYXkodGhpcyxhKTwwJiYoci5jbGVhbkRhdGEobmEodGhpcykpLGMmJmMucmVwbGFjZUNoaWxkKGIsdGhpcykpfSxhKX19KSxyLmVhY2goe2FwcGVuZFRvOiJhcHBlbmQiLHByZXBlbmRUbzoicHJlcGVuZCIsaW5zZXJ0QmVmb3JlOiJiZWZvcmUiLGluc2VydEFmdGVyOiJhZnRlciIscmVwbGFjZUFsbDoicmVwbGFjZVdpdGgifSxmdW5jdGlvbihhLGIpe3IuZm5bYV09ZnVuY3Rpb24oYSl7Zm9yKHZhciBjLGQ9W10sZT1yKGEpLGY9ZS5sZW5ndGgtMSxnPTA7Zzw9ZjtnKyspYz1nPT09Zj90aGlzOnRoaXMuY2xvbmUoITApLHIoZVtnXSlbYl0oYyksaC5hcHBseShkLGMuZ2V0KCkpO3JldHVybiB0aGlzLnB1c2hTdGFjayhkKX19KTt2YXIgTGE9L15tYXJnaW4vLE1hPW5ldyBSZWdFeHAoIl4oIithYSsiKSg/IXB4KVthLXolXSskIiwiaSIpLE5hPWZ1bmN0aW9uKGIpe3ZhciBjPWIub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztyZXR1cm4gYyYmYy5vcGVuZXJ8fChjPWEpLGMuZ2V0Q29tcHV0ZWRTdHlsZShiKX07IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYigpe2lmKGkpe2kuc3R5bGUuY3NzVGV4dD0iYm94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt0b3A6MSU7d2lkdGg6NTAlIixpLmlubmVySFRNTD0iIixyYS5hcHBlbmRDaGlsZChoKTt2YXIgYj1hLmdldENvbXB1dGVkU3R5bGUoaSk7Yz0iMSUiIT09Yi50b3AsZz0iMnB4Ij09PWIubWFyZ2luTGVmdCxlPSI0cHgiPT09Yi53aWR0aCxpLnN0eWxlLm1hcmdpblJpZ2h0PSI1MCUiLGY9IjRweCI9PT1iLm1hcmdpblJpZ2h0LHJhLnJlbW92ZUNoaWxkKGgpLGk9bnVsbH19dmFyIGMsZSxmLGcsaD1kLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGk9ZC5jcmVhdGVFbGVtZW50KCJkaXYiKTtpLnN0eWxlJiYoaS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giLGkuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIixvLmNsZWFyQ2xvbmVTdHlsZT0iY29udGVudC1ib3giPT09aS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCxoLnN0eWxlLmNzc1RleHQ9ImJvcmRlcjowO3dpZHRoOjhweDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7cGFkZGluZzowO21hcmdpbi10b3A6MXB4O3Bvc2l0aW9uOmFic29sdXRlIixoLmFwcGVuZENoaWxkKGkpLHIuZXh0ZW5kKG8se3BpeGVsUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gYigpLGN9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGIoKSxlfSxwaXhlbE1hcmdpblJpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIGIoKSxmfSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gYigpLGd9fSkpfSgpO2Z1bmN0aW9uIE9hKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuc3R5bGU7cmV0dXJuIGM9Y3x8TmEoYSksYyYmKGc9Yy5nZXRQcm9wZXJ0eVZhbHVlKGIpfHxjW2JdLCIiIT09Z3x8ci5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl8fChnPXIuc3R5bGUoYSxiKSksIW8ucGl4ZWxNYXJnaW5SaWdodCgpJiZNYS50ZXN0KGcpJiZMYS50ZXN0KGIpJiYoZD1oLndpZHRoLGU9aC5taW5XaWR0aCxmPWgubWF4V2lkdGgsaC5taW5XaWR0aD1oLm1heFdpZHRoPWgud2lkdGg9ZyxnPWMud2lkdGgsaC53aWR0aD1kLGgubWluV2lkdGg9ZSxoLm1heFdpZHRoPWYpKSx2b2lkIDAhPT1nP2crIiI6Z31mdW5jdGlvbiBQYShhLGIpe3JldHVybntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYSgpP3ZvaWQgZGVsZXRlIHRoaXMuZ2V0Oih0aGlzLmdldD1iKS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX12YXIgUWE9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLFJhPS9eLS0vLFNhPXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxUYT17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn0sVWE9WyJXZWJraXQiLCJNb3oiLCJtcyJdLFZhPWQuY3JlYXRlRWxlbWVudCgiZGl2Iikuc3R5bGU7ZnVuY3Rpb24gV2EoYSl7aWYoYSBpbiBWYSlyZXR1cm4gYTt2YXIgYj1hWzBdLnRvVXBwZXJDYXNlKCkrYS5zbGljZSgxKSxjPVVhLmxlbmd0aDt3aGlsZShjLS0paWYoYT1VYVtjXStiLGEgaW4gVmEpcmV0dXJuIGF9ZnVuY3Rpb24gWGEoYSl7dmFyIGI9ci5jc3NQcm9wc1thXTtyZXR1cm4gYnx8KGI9ci5jc3NQcm9wc1thXT1XYShhKXx8YSksYn1mdW5jdGlvbiBZYShhLGIsYyl7dmFyIGQ9YmEuZXhlYyhiKTtyZXR1cm4gZD9NYXRoLm1heCgwLGRbMl0tKGN8fDApKSsoZFszXXx8InB4Iik6Yn1mdW5jdGlvbiBaYShhLGIsYyxkLGUpe3ZhciBmLGc9MDtmb3IoZj1jPT09KGQ/ImJvcmRlciI6ImNvbnRlbnQiKT80OiJ3aWR0aCI9PT1iPzE6MDtmPDQ7Zis9MikibWFyZ2luIj09PWMmJihnKz1yLmNzcyhhLGMrY2FbZl0sITAsZSkpLGQ/KCJjb250ZW50Ij09PWMmJihnLT1yLmNzcyhhLCJwYWRkaW5nIitjYVtmXSwhMCxlKSksIm1hcmdpbiIhPT1jJiYoZy09ci5jc3MoYSwiYm9yZGVyIitjYVtmXSsiV2lkdGgiLCEwLGUpKSk6KGcrPXIuY3NzKGEsInBhZGRpbmciK2NhW2ZdLCEwLGUpLCJwYWRkaW5nIiE9PWMmJihnKz1yLmNzcyhhLCJib3JkZXIiK2NhW2ZdKyJXaWR0aCIsITAsZSkpKTtyZXR1cm4gZ31mdW5jdGlvbiAkYShhLGIsYyl7dmFyIGQsZT1OYShhKSxmPU9hKGEsYixlKSxnPSJib3JkZXItYm94Ij09PXIuY3NzKGEsImJveFNpemluZyIsITEsZSk7cmV0dXJuIE1hLnRlc3QoZik/ZjooZD1nJiYoby5ib3hTaXppbmdSZWxpYWJsZSgpfHxmPT09YS5zdHlsZVtiXSksImF1dG8iPT09ZiYmKGY9YVsib2Zmc2V0IitiWzBdLnRvVXBwZXJDYXNlKCkrYi5zbGljZSgxKV0pLGY9cGFyc2VGbG9hdChmKXx8MCxmK1phKGEsYixjfHwoZz8iYm9yZGVyIjoiY29udGVudCIpLGQsZSkrInB4Iil9ci5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oYSxiKXtpZihiKXt2YXIgYz1PYShhLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1jPyIxIjpjfX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGNvbHVtbkNvdW50OiEwLGZpbGxPcGFjaXR5OiEwLGZsZXhHcm93OiEwLGZsZXhTaHJpbms6ITAsZm9udFdlaWdodDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITB9LGNzc1Byb3BzOnsiZmxvYXQiOiJjc3NGbG9hdCJ9LHN0eWxlOmZ1bmN0aW9uKGEsYixjLGQpe2lmKGEmJjMhPT1hLm5vZGVUeXBlJiY4IT09YS5ub2RlVHlwZSYmYS5zdHlsZSl7dmFyIGUsZixnLGg9ci5jYW1lbENhc2UoYiksaT1SYS50ZXN0KGIpLGo9YS5zdHlsZTtyZXR1cm4gaXx8KGI9WGEoaCkpLGc9ci5jc3NIb29rc1tiXXx8ci5jc3NIb29rc1toXSx2b2lkIDA9PT1jP2cmJiJnZXQiaW4gZyYmdm9pZCAwIT09KGU9Zy5nZXQoYSwhMSxkKSk/ZTpqW2JdOihmPXR5cGVvZiBjLCJzdHJpbmciPT09ZiYmKGU9YmEuZXhlYyhjKSkmJmVbMV0mJihjPWZhKGEsYixlKSxmPSJudW1iZXIiKSxudWxsIT1jJiZjPT09YyYmKCJudW1iZXIiPT09ZiYmKGMrPWUmJmVbM118fChyLmNzc051bWJlcltoXT8iIjoicHgiKSksby5jbGVhckNsb25lU3R5bGV8fCIiIT09Y3x8MCE9PWIuaW5kZXhPZigiYmFja2dyb3VuZCIpfHwoaltiXT0iaW5oZXJpdCIpLGcmJiJzZXQiaW4gZyYmdm9pZCAwPT09KGM9Zy5zZXQoYSxjLGQpKXx8KGk/ai5zZXRQcm9wZXJ0eShiLGMpOmpbYl09YykpLHZvaWQgMCl9fSxjc3M6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnLGg9ci5jYW1lbENhc2UoYiksaT1SYS50ZXN0KGIpO3JldHVybiBpfHwoYj1YYShoKSksZz1yLmNzc0hvb2tzW2JdfHxyLmNzc0hvb2tzW2hdLGcmJiJnZXQiaW4gZyYmKGU9Zy5nZXQoYSwhMCxjKSksdm9pZCAwPT09ZSYmKGU9T2EoYSxiLGQpKSwibm9ybWFsIj09PWUmJmIgaW4gVGEmJihlPVRhW2JdKSwiIj09PWN8fGM/KGY9cGFyc2VGbG9hdChlKSxjPT09ITB8fGlzRmluaXRlKGYpP2Z8fDA6ZSk6ZX19KSxyLmVhY2goWyJoZWlnaHQiLCJ3aWR0aCJdLGZ1bmN0aW9uKGEsYil7ci5jc3NIb29rc1tiXT17Z2V0OmZ1bmN0aW9uKGEsYyxkKXtpZihjKXJldHVybiFRYS50ZXN0KHIuY3NzKGEsImRpc3BsYXkiKSl8fGEuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJmEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg/JGEoYSxiLGQpOmVhKGEsU2EsZnVuY3Rpb24oKXtyZXR1cm4gJGEoYSxiLGQpfSl9LHNldDpmdW5jdGlvbihhLGMsZCl7dmFyIGUsZj1kJiZOYShhKSxnPWQmJlphKGEsYixkLCJib3JkZXItYm94Ij09PXIuY3NzKGEsImJveFNpemluZyIsITEsZiksZik7cmV0dXJuIGcmJihlPWJhLmV4ZWMoYykpJiYicHgiIT09KGVbM118fCJweCIpJiYoYS5zdHlsZVtiXT1jLGM9ci5jc3MoYSxiKSksWWEoYSxjLGcpfX19KSxyLmNzc0hvb2tzLm1hcmdpbkxlZnQ9UGEoby5yZWxpYWJsZU1hcmdpbkxlZnQsZnVuY3Rpb24oYSxiKXtpZihiKXJldHVybihwYXJzZUZsb2F0KE9hKGEsIm1hcmdpbkxlZnQiKSl8fGEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdC1lYShhLHttYXJnaW5MZWZ0OjB9LGZ1bmN0aW9uKCl7cmV0dXJuIGEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdH0pKSsicHgifSksci5lYWNoKHttYXJnaW46IiIscGFkZGluZzoiIixib3JkZXI6IldpZHRoIn0sZnVuY3Rpb24oYSxiKXtyLmNzc0hvb2tzW2ErYl09e2V4cGFuZDpmdW5jdGlvbihjKXtmb3IodmFyIGQ9MCxlPXt9LGY9InN0cmluZyI9PXR5cGVvZiBjP2Muc3BsaXQoIiAiKTpbY107ZDw0O2QrKyllW2ErY2FbZF0rYl09ZltkXXx8ZltkLTJdfHxmWzBdO3JldHVybiBlfX0sTGEudGVzdChhKXx8KHIuY3NzSG9va3NbYStiXS5zZXQ9WWEpfSksci5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihhLGIpe3JldHVybiBUKHRoaXMsZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj17fSxnPTA7aWYoQXJyYXkuaXNBcnJheShiKSl7Zm9yKGQ9TmEoYSksZT1iLmxlbmd0aDtnPGU7ZysrKWZbYltnXV09ci5jc3MoYSxiW2ddLCExLGQpO3JldHVybiBmfXJldHVybiB2b2lkIDAhPT1jP3Iuc3R5bGUoYSxiLGMpOnIuY3NzKGEsYil9LGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfX0pO2Z1bmN0aW9uIF9hKGEsYixjLGQsZSl7cmV0dXJuIG5ldyBfYS5wcm90b3R5cGUuaW5pdChhLGIsYyxkLGUpfXIuVHdlZW49X2EsX2EucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpfYSxpbml0OmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt0aGlzLmVsZW09YSx0aGlzLnByb3A9Yyx0aGlzLmVhc2luZz1lfHxyLmVhc2luZy5fZGVmYXVsdCx0aGlzLm9wdGlvbnM9Yix0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCksdGhpcy5lbmQ9ZCx0aGlzLnVuaXQ9Znx8KHIuY3NzTnVtYmVyW2NdPyIiOiJweCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgYT1fYS5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gYSYmYS5nZXQ/YS5nZXQodGhpcyk6X2EucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGEpe3ZhciBiLGM9X2EucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMub3B0aW9ucy5kdXJhdGlvbj90aGlzLnBvcz1iPXIuZWFzaW5nW3RoaXMuZWFzaW5nXShhLHRoaXMub3B0aW9ucy5kdXJhdGlvbiphLDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pOnRoaXMucG9zPWI9YSx0aGlzLm5vdz0odGhpcy5lbmQtdGhpcy5zdGFydCkqYit0aGlzLnN0YXJ0LHRoaXMub3B0aW9ucy5zdGVwJiZ0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSx0aGlzLm5vdyx0aGlzKSxjJiZjLnNldD9jLnNldCh0aGlzKTpfYS5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpLHRoaXN9fSxfYS5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGU9X2EucHJvdG90eXBlLF9hLnByb3BIb29rcz17X2RlZmF1bHQ6e2dldDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gMSE9PWEuZWxlbS5ub2RlVHlwZXx8bnVsbCE9YS5lbGVtW2EucHJvcF0mJm51bGw9PWEuZWxlbS5zdHlsZVthLnByb3BdP2EuZWxlbVthLnByb3BdOihiPXIuY3NzKGEuZWxlbSxhLnByb3AsIiIpLGImJiJhdXRvIiE9PWI/YjowKX0sc2V0OmZ1bmN0aW9uKGEpe3IuZnguc3RlcFthLnByb3BdP3IuZnguc3RlcFthLnByb3BdKGEpOjEhPT1hLmVsZW0ubm9kZVR5cGV8fG51bGw9PWEuZWxlbS5zdHlsZVtyLmNzc1Byb3BzW2EucHJvcF1dJiYhci5jc3NIb29rc1thLnByb3BdP2EuZWxlbVthLnByb3BdPWEubm93OnIuc3R5bGUoYS5lbGVtLGEucHJvcCxhLm5vdythLnVuaXQpfX19LF9hLnByb3BIb29rcy5zY3JvbGxUb3A9X2EucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihhKXthLmVsZW0ubm9kZVR5cGUmJmEuZWxlbS5wYXJlbnROb2RlJiYoYS5lbGVtW2EucHJvcF09YS5ub3cpfX0sci5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihhKXtyZXR1cm4gYX0sc3dpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuLjUtTWF0aC5jb3MoYSpNYXRoLlBJKS8yfSxfZGVmYXVsdDoic3dpbmcifSxyLmZ4PV9hLnByb3RvdHlwZS5pbml0LHIuZnguc3RlcD17fTt2YXIgYWIsYmIsY2I9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLGRiPS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gZWIoKXtiYiYmKGQuaGlkZGVuPT09ITEmJmEucmVxdWVzdEFuaW1hdGlvbkZyYW1lP2EucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGViKTphLnNldFRpbWVvdXQoZWIsci5meC5pbnRlcnZhbCksci5meC50aWNrKCkpfWZ1bmN0aW9uIGZiKCl7cmV0dXJuIGEuc2V0VGltZW91dChmdW5jdGlvbigpe2FiPXZvaWQgMH0pLGFiPXIubm93KCl9ZnVuY3Rpb24gZ2IoYSxiKXt2YXIgYyxkPTAsZT17aGVpZ2h0OmF9O2ZvcihiPWI/MTowO2Q8NDtkKz0yLWIpYz1jYVtkXSxlWyJtYXJnaW4iK2NdPWVbInBhZGRpbmciK2NdPWE7cmV0dXJuIGImJihlLm9wYWNpdHk9ZS53aWR0aD1hKSxlfWZ1bmN0aW9uIGhiKGEsYixjKXtmb3IodmFyIGQsZT0oa2IudHdlZW5lcnNbYl18fFtdKS5jb25jYXQoa2IudHdlZW5lcnNbIioiXSksZj0wLGc9ZS5sZW5ndGg7ZjxnO2YrKylpZihkPWVbZl0uY2FsbChjLGIsYSkpcmV0dXJuIGR9ZnVuY3Rpb24gaWIoYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGssbD0id2lkdGgiaW4gYnx8ImhlaWdodCJpbiBiLG09dGhpcyxuPXt9LG89YS5zdHlsZSxwPWEubm9kZVR5cGUmJmRhKGEpLHE9Vy5nZXQoYSwiZnhzaG93Iik7Yy5xdWV1ZXx8KGc9ci5fcXVldWVIb29rcyhhLCJmeCIpLG51bGw9PWcudW5xdWV1ZWQmJihnLnVucXVldWVkPTAsaD1nLmVtcHR5LmZpcmUsZy5lbXB0eS5maXJlPWZ1bmN0aW9uKCl7Zy51bnF1ZXVlZHx8aCgpfSksZy51bnF1ZXVlZCsrLG0uYWx3YXlzKGZ1bmN0aW9uKCl7bS5hbHdheXMoZnVuY3Rpb24oKXtnLnVucXVldWVkLS0sci5xdWV1ZShhLCJmeCIpLmxlbmd0aHx8Zy5lbXB0eS5maXJlKCl9KX0pKTtmb3IoZCBpbiBiKWlmKGU9YltkXSxjYi50ZXN0KGUpKXtpZihkZWxldGUgYltkXSxmPWZ8fCJ0b2dnbGUiPT09ZSxlPT09KHA/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWV8fCFxfHx2b2lkIDA9PT1xW2RdKWNvbnRpbnVlO3A9ITB9bltkXT1xJiZxW2RdfHxyLnN0eWxlKGEsZCl9aWYoaT0hci5pc0VtcHR5T2JqZWN0KGIpLGl8fCFyLmlzRW1wdHlPYmplY3Qobikpe2wmJjE9PT1hLm5vZGVUeXBlJiYoYy5vdmVyZmxvdz1bby5vdmVyZmxvdyxvLm92ZXJmbG93WCxvLm92ZXJmbG93WV0saj1xJiZxLmRpc3BsYXksbnVsbD09aiYmKGo9Vy5nZXQoYSwiZGlzcGxheSIpKSxrPXIuY3NzKGEsImRpc3BsYXkiKSwibm9uZSI9PT1rJiYoaj9rPWo6KGlhKFthXSwhMCksaj1hLnN0eWxlLmRpc3BsYXl8fGosaz1yLmNzcyhhLCJkaXNwbGF5IiksaWEoW2FdKSkpLCgiaW5saW5lIj09PWt8fCJpbmxpbmUtYmxvY2siPT09ayYmbnVsbCE9aikmJiJub25lIj09PXIuY3NzKGEsImZsb2F0IikmJihpfHwobS5kb25lKGZ1bmN0aW9uKCl7by5kaXNwbGF5PWp9KSxudWxsPT1qJiYoaz1vLmRpc3BsYXksaj0ibm9uZSI9PT1rPyIiOmspKSxvLmRpc3BsYXk9ImlubGluZS1ibG9jayIpKSxjLm92ZXJmbG93JiYoby5vdmVyZmxvdz0iaGlkZGVuIixtLmFsd2F5cyhmdW5jdGlvbigpe28ub3ZlcmZsb3c9Yy5vdmVyZmxvd1swXSxvLm92ZXJmbG93WD1jLm92ZXJmbG93WzFdLG8ub3ZlcmZsb3dZPWMub3ZlcmZsb3dbMl19KSksaT0hMTtmb3IoZCBpbiBuKWl8fChxPyJoaWRkZW4iaW4gcSYmKHA9cS5oaWRkZW4pOnE9Vy5hY2Nlc3MoYSwiZnhzaG93Iix7ZGlzcGxheTpqfSksZiYmKHEuaGlkZGVuPSFwKSxwJiZpYShbYV0sITApLG0uZG9uZShmdW5jdGlvbigpe3B8fGlhKFthXSksVy5yZW1vdmUoYSwiZnhzaG93Iik7Zm9yKGQgaW4gbilyLnN0eWxlKGEsZCxuW2RdKX0pKSxpPWhiKHA/cVtkXTowLGQsbSksZCBpbiBxfHwocVtkXT1pLnN0YXJ0LHAmJihpLmVuZD1pLnN0YXJ0LGkuc3RhcnQ9MCkpfX1mdW5jdGlvbiBqYihhLGIpe3ZhciBjLGQsZSxmLGc7Zm9yKGMgaW4gYSlpZihkPXIuY2FtZWxDYXNlKGMpLGU9YltkXSxmPWFbY10sQXJyYXkuaXNBcnJheShmKSYmKGU9ZlsxXSxmPWFbY109ZlswXSksYyE9PWQmJihhW2RdPWYsZGVsZXRlIGFbY10pLGc9ci5jc3NIb29rc1tkXSxnJiYiZXhwYW5kImluIGcpe2Y9Zy5leHBhbmQoZiksZGVsZXRlIGFbZF07Zm9yKGMgaW4gZiljIGluIGF8fChhW2NdPWZbY10sYltjXT1lKX1lbHNlIGJbZF09ZX1mdW5jdGlvbiBrYihhLGIsYyl7dmFyIGQsZSxmPTAsZz1rYi5wcmVmaWx0ZXJzLmxlbmd0aCxoPXIuRGVmZXJyZWQoKS5hbHdheXMoZnVuY3Rpb24oKXtkZWxldGUgaS5lbGVtfSksaT1mdW5jdGlvbigpe2lmKGUpcmV0dXJuITE7Zm9yKHZhciBiPWFifHxmYigpLGM9TWF0aC5tYXgoMCxqLnN0YXJ0VGltZStqLmR1cmF0aW9uLWIpLGQ9Yy9qLmR1cmF0aW9ufHwwLGY9MS1kLGc9MCxpPWoudHdlZW5zLmxlbmd0aDtnPGk7ZysrKWoudHdlZW5zW2ddLnJ1bihmKTtyZXR1cm4gaC5ub3RpZnlXaXRoKGEsW2osZixjXSksZjwxJiZpP2M6KGl8fGgubm90aWZ5V2l0aChhLFtqLDEsMF0pLGgucmVzb2x2ZVdpdGgoYSxbal0pLCExKX0saj1oLnByb21pc2Uoe2VsZW06YSxwcm9wczpyLmV4dGVuZCh7fSxiKSxvcHRzOnIuZXh0ZW5kKCEwLHtzcGVjaWFsRWFzaW5nOnt9LGVhc2luZzpyLmVhc2luZy5fZGVmYXVsdH0sYyksb3JpZ2luYWxQcm9wZXJ0aWVzOmIsb3JpZ2luYWxPcHRpb25zOmMsc3RhcnRUaW1lOmFifHxmYigpLGR1cmF0aW9uOmMuZHVyYXRpb24sdHdlZW5zOltdLGNyZWF0ZVR3ZWVuOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9ci5Ud2VlbihhLGoub3B0cyxiLGMsai5vcHRzLnNwZWNpYWxFYXNpbmdbYl18fGoub3B0cy5lYXNpbmcpO3JldHVybiBqLnR3ZWVucy5wdXNoKGQpLGR9LHN0b3A6ZnVuY3Rpb24oYil7dmFyIGM9MCxkPWI/ai50d2VlbnMubGVuZ3RoOjA7aWYoZSlyZXR1cm4gdGhpcztmb3IoZT0hMDtjPGQ7YysrKWoudHdlZW5zW2NdLnJ1bigxKTtyZXR1cm4gYj8oaC5ub3RpZnlXaXRoKGEsW2osMSwwXSksaC5yZXNvbHZlV2l0aChhLFtqLGJdKSk6aC5yZWplY3RXaXRoKGEsW2osYl0pLHRoaXN9fSksaz1qLnByb3BzO2ZvcihqYihrLGoub3B0cy5zcGVjaWFsRWFzaW5nKTtmPGc7ZisrKWlmKGQ9a2IucHJlZmlsdGVyc1tmXS5jYWxsKGosYSxrLGoub3B0cykpcmV0dXJuIHIuaXNGdW5jdGlvbihkLnN0b3ApJiYoci5fcXVldWVIb29rcyhqLmVsZW0sai5vcHRzLnF1ZXVlKS5zdG9wPXIucHJveHkoZC5zdG9wLGQpKSxkO3JldHVybiByLm1hcChrLGhiLGopLHIuaXNGdW5jdGlvbihqLm9wdHMuc3RhcnQpJiZqLm9wdHMuc3RhcnQuY2FsbChhLGopLGoucHJvZ3Jlc3Moai5vcHRzLnByb2dyZXNzKS5kb25lKGoub3B0cy5kb25lLGoub3B0cy5jb21wbGV0ZSkuZmFpbChqLm9wdHMuZmFpbCkuYWx3YXlzKGoub3B0cy5hbHdheXMpLHIuZngudGltZXIoci5leHRlbmQoaSx7ZWxlbTphLGFuaW06aixxdWV1ZTpqLm9wdHMucXVldWV9KSksan1yLkFuaW1hdGlvbj1yLmV4dGVuZChrYix7dHdlZW5lcnM6eyIqIjpbZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLmNyZWF0ZVR3ZWVuKGEsYik7cmV0dXJuIGZhKGMuZWxlbSxhLGJhLmV4ZWMoYiksYyksY31dfSx0d2VlbmVyOmZ1bmN0aW9uKGEsYil7ci5pc0Z1bmN0aW9uKGEpPyhiPWEsYT1bIioiXSk6YT1hLm1hdGNoKEwpO2Zvcih2YXIgYyxkPTAsZT1hLmxlbmd0aDtkPGU7ZCsrKWM9YVtkXSxrYi50d2VlbmVyc1tjXT1rYi50d2VlbmVyc1tjXXx8W10sa2IudHdlZW5lcnNbY10udW5zaGlmdChiKX0scHJlZmlsdGVyczpbaWJdLHByZWZpbHRlcjpmdW5jdGlvbihhLGIpe2I/a2IucHJlZmlsdGVycy51bnNoaWZ0KGEpOmtiLnByZWZpbHRlcnMucHVzaChhKX19KSxyLnNwZWVkPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1hJiYib2JqZWN0Ij09dHlwZW9mIGE/ci5leHRlbmQoe30sYSk6e2NvbXBsZXRlOmN8fCFjJiZifHxyLmlzRnVuY3Rpb24oYSkmJmEsZHVyYXRpb246YSxlYXNpbmc6YyYmYnx8YiYmIXIuaXNGdW5jdGlvbihiKSYmYn07cmV0dXJuIHIuZngub2ZmP2QuZHVyYXRpb249MDoibnVtYmVyIiE9dHlwZW9mIGQuZHVyYXRpb24mJihkLmR1cmF0aW9uIGluIHIuZnguc3BlZWRzP2QuZHVyYXRpb249ci5meC5zcGVlZHNbZC5kdXJhdGlvbl06ZC5kdXJhdGlvbj1yLmZ4LnNwZWVkcy5fZGVmYXVsdCksbnVsbCE9ZC5xdWV1ZSYmZC5xdWV1ZSE9PSEwfHwoZC5xdWV1ZT0iZngiKSxkLm9sZD1kLmNvbXBsZXRlLGQuY29tcGxldGU9ZnVuY3Rpb24oKXtyLmlzRnVuY3Rpb24oZC5vbGQpJiZkLm9sZC5jYWxsKHRoaXMpLGQucXVldWUmJnIuZGVxdWV1ZSh0aGlzLGQucXVldWUpfSxkfSxyLmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmZpbHRlcihkYSkuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGMsZCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ci5pc0VtcHR5T2JqZWN0KGEpLGY9ci5zcGVlZChiLGMsZCksZz1mdW5jdGlvbigpe3ZhciBiPWtiKHRoaXMsci5leHRlbmQoe30sYSksZik7KGV8fFcuZ2V0KHRoaXMsImZpbmlzaCIpKSYmYi5zdG9wKCEwKX07cmV0dXJuIGcuZmluaXNoPWcsZXx8Zi5xdWV1ZT09PSExP3RoaXMuZWFjaChnKTp0aGlzLnF1ZXVlKGYucXVldWUsZyl9LHN0b3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWZ1bmN0aW9uKGEpe3ZhciBiPWEuc3RvcDtkZWxldGUgYS5zdG9wLGIoYyl9O3JldHVybiJzdHJpbmciIT10eXBlb2YgYSYmKGM9YixiPWEsYT12b2lkIDApLGImJmEhPT0hMSYmdGhpcy5xdWV1ZShhfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj0hMCxlPW51bGwhPWEmJmErInF1ZXVlSG9va3MiLGY9ci50aW1lcnMsZz1XLmdldCh0aGlzKTtpZihlKWdbZV0mJmdbZV0uc3RvcCYmZChnW2VdKTtlbHNlIGZvcihlIGluIGcpZ1tlXSYmZ1tlXS5zdG9wJiZkYi50ZXN0KGUpJiZkKGdbZV0pO2ZvcihlPWYubGVuZ3RoO2UtLTspZltlXS5lbGVtIT09dGhpc3x8bnVsbCE9YSYmZltlXS5xdWV1ZSE9PWF8fChmW2VdLmFuaW0uc3RvcChjKSxiPSExLGYuc3BsaWNlKGUsMSkpOyFiJiZjfHxyLmRlcXVldWUodGhpcyxhKX0pfSxmaW5pc2g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEhPT0hMSYmKGE9YXx8ImZ4IiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGIsYz1XLmdldCh0aGlzKSxkPWNbYSsicXVldWUiXSxlPWNbYSsicXVldWVIb29rcyJdLGY9ci50aW1lcnMsZz1kP2QubGVuZ3RoOjA7Zm9yKGMuZmluaXNoPSEwLHIucXVldWUodGhpcyxhLFtdKSxlJiZlLnN0b3AmJmUuc3RvcC5jYWxsKHRoaXMsITApLGI9Zi5sZW5ndGg7Yi0tOylmW2JdLmVsZW09PT10aGlzJiZmW2JdLnF1ZXVlPT09YSYmKGZbYl0uYW5pbS5zdG9wKCEwKSxmLnNwbGljZShiLDEpKTtmb3IoYj0wO2I8ZztiKyspZFtiXSYmZFtiXS5maW5pc2gmJmRbYl0uZmluaXNoLmNhbGwodGhpcyk7ZGVsZXRlIGMuZmluaXNofSl9fSksci5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihhLGIpe3ZhciBjPXIuZm5bYl07ci5mbltiXT1mdW5jdGlvbihhLGQsZSl7cmV0dXJuIG51bGw9PWF8fCJib29sZWFuIj09dHlwZW9mIGE/Yy5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpcy5hbmltYXRlKGdiKGIsITApLGEsZCxlKX19KSxyLmVhY2goe3NsaWRlRG93bjpnYigic2hvdyIpLHNsaWRlVXA6Z2IoImhpZGUiKSxzbGlkZVRvZ2dsZTpnYigidG9nZ2xlIiksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6InRvZ2dsZSJ9fSxmdW5jdGlvbihhLGIpe3IuZm5bYV09ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLmFuaW1hdGUoYixhLGMsZCl9fSksci50aW1lcnM9W10sci5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGEsYj0wLGM9ci50aW1lcnM7Zm9yKGFiPXIubm93KCk7YjxjLmxlbmd0aDtiKyspYT1jW2JdLGEoKXx8Y1tiXSE9PWF8fGMuc3BsaWNlKGItLSwxKTtjLmxlbmd0aHx8ci5meC5zdG9wKCksYWI9dm9pZCAwfSxyLmZ4LnRpbWVyPWZ1bmN0aW9uKGEpe3IudGltZXJzLnB1c2goYSksci5meC5zdGFydCgpfSxyLmZ4LmludGVydmFsPTEzLHIuZnguc3RhcnQ9ZnVuY3Rpb24oKXtiYnx8KGJiPSEwLGViKCkpfSxyLmZ4LnN0b3A9ZnVuY3Rpb24oKXtiYj1udWxsfSxyLmZ4LnNwZWVkcz17c2xvdzo2MDAsZmFzdDoyMDAsX2RlZmF1bHQ6NDAwfSxyLmZuLmRlbGF5PWZ1bmN0aW9uKGIsYyl7cmV0dXJuIGI9ci5meD9yLmZ4LnNwZWVkc1tiXXx8YjpiLGM9Y3x8ImZ4Iix0aGlzLnF1ZXVlKGMsZnVuY3Rpb24oYyxkKXt2YXIgZT1hLnNldFRpbWVvdXQoYyxiKTtkLnN0b3A9ZnVuY3Rpb24oKXthLmNsZWFyVGltZW91dChlKX19KX0sZnVuY3Rpb24oKXt2YXIgYT1kLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYj1kLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLGM9Yi5hcHBlbmRDaGlsZChkLmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTthLnR5cGU9ImNoZWNrYm94IixvLmNoZWNrT249IiIhPT1hLnZhbHVlLG8ub3B0U2VsZWN0ZWQ9Yy5zZWxlY3RlZCxhPWQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSxhLnZhbHVlPSJ0IixhLnR5cGU9InJhZGlvIixvLnJhZGlvVmFsdWU9InQiPT09YS52YWx1ZX0oKTt2YXIgbGIsbWI9ci5leHByLmF0dHJIYW5kbGU7ci5mbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gVCh0aGlzLHIuYXR0cixhLGIsYXJndW1lbnRzLmxlbmd0aD4xKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ci5yZW1vdmVBdHRyKHRoaXMsYSl9KX19KSxyLmV4dGVuZCh7YXR0cjpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPWEubm9kZVR5cGU7aWYoMyE9PWYmJjghPT1mJiYyIT09ZilyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIGEuZ2V0QXR0cmlidXRlP3IucHJvcChhLGIsYyk6KDE9PT1mJiZyLmlzWE1MRG9jKGEpfHwoZT1yLmF0dHJIb29rc1tiLnRvTG93ZXJDYXNlKCldfHwoci5leHByLm1hdGNoLmJvb2wudGVzdChiKT9sYjp2b2lkIDApKSx2b2lkIDAhPT1jP251bGw9PT1jP3ZvaWQgci5yZW1vdmVBdHRyKGEsYik6ZSYmInNldCJpbiBlJiZ2b2lkIDAhPT0oZD1lLnNldChhLGMsYikpP2Q6KGEuc2V0QXR0cmlidXRlKGIsYysiIiksYyk6ZSYmImdldCJpbiBlJiZudWxsIT09KGQ9ZS5nZXQoYSxiKSk/ZDooZD1yLmZpbmQuYXR0cihhLGIpLApudWxsPT1kP3ZvaWQgMDpkKSl9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGEsYil7aWYoIW8ucmFkaW9WYWx1ZSYmInJhZGlvIj09PWImJkIoYSwiaW5wdXQiKSl7dmFyIGM9YS52YWx1ZTtyZXR1cm4gYS5zZXRBdHRyaWJ1dGUoInR5cGUiLGIpLGMmJihhLnZhbHVlPWMpLGJ9fX19LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPTAsZT1iJiZiLm1hdGNoKEwpO2lmKGUmJjE9PT1hLm5vZGVUeXBlKXdoaWxlKGM9ZVtkKytdKWEucmVtb3ZlQXR0cmlidXRlKGMpfX0pLGxiPXtzZXQ6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBiPT09ITE/ci5yZW1vdmVBdHRyKGEsYyk6YS5zZXRBdHRyaWJ1dGUoYyxjKSxjfX0sci5lYWNoKHIuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXHcrL2cpLGZ1bmN0aW9uKGEsYil7dmFyIGM9bWJbYl18fHIuZmluZC5hdHRyO21iW2JdPWZ1bmN0aW9uKGEsYixkKXt2YXIgZSxmLGc9Yi50b0xvd2VyQ2FzZSgpO3JldHVybiBkfHwoZj1tYltnXSxtYltnXT1lLGU9bnVsbCE9YyhhLGIsZCk/ZzpudWxsLG1iW2ddPWYpLGV9fSk7dmFyIG5iPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksb2I9L14oPzphfGFyZWEpJC9pO3IuZm4uZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGEsYil7cmV0dXJuIFQodGhpcyxyLnByb3AsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW3IucHJvcEZpeFthXXx8YV19KX19KSxyLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmPWEubm9kZVR5cGU7aWYoMyE9PWYmJjghPT1mJiYyIT09ZilyZXR1cm4gMT09PWYmJnIuaXNYTUxEb2MoYSl8fChiPXIucHJvcEZpeFtiXXx8YixlPXIucHJvcEhvb2tzW2JdKSx2b2lkIDAhPT1jP2UmJiJzZXQiaW4gZSYmdm9pZCAwIT09KGQ9ZS5zZXQoYSxjLGIpKT9kOmFbYl09YzplJiYiZ2V0ImluIGUmJm51bGwhPT0oZD1lLmdldChhLGIpKT9kOmFbYl19LHByb3BIb29rczp7dGFiSW5kZXg6e2dldDpmdW5jdGlvbihhKXt2YXIgYj1yLmZpbmQuYXR0cihhLCJ0YWJpbmRleCIpO3JldHVybiBiP3BhcnNlSW50KGIsMTApOm5iLnRlc3QoYS5ub2RlTmFtZSl8fG9iLnRlc3QoYS5ub2RlTmFtZSkmJmEuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLG8ub3B0U2VsZWN0ZWR8fChyLnByb3BIb29rcy5zZWxlY3RlZD17Z2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEucGFyZW50Tm9kZTtyZXR1cm4gYiYmYi5wYXJlbnROb2RlJiZiLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxudWxsfSxzZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO2ImJihiLnNlbGVjdGVkSW5kZXgsYi5wYXJlbnROb2RlJiZiLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCl9fSksci5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXtyLnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXT10aGlzfSk7ZnVuY3Rpb24gcGIoYSl7dmFyIGI9YS5tYXRjaChMKXx8W107cmV0dXJuIGIuam9pbigiICIpfWZ1bmN0aW9uIHFiKGEpe3JldHVybiBhLmdldEF0dHJpYnV0ZSYmYS5nZXRBdHRyaWJ1dGUoImNsYXNzIil8fCIifXIuZm4uZXh0ZW5kKHthZGRDbGFzczpmdW5jdGlvbihhKXt2YXIgYixjLGQsZSxmLGcsaCxpPTA7aWYoci5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7cih0aGlzKS5hZGRDbGFzcyhhLmNhbGwodGhpcyxiLHFiKHRoaXMpKSl9KTtpZigic3RyaW5nIj09dHlwZW9mIGEmJmEpe2I9YS5tYXRjaChMKXx8W107d2hpbGUoYz10aGlzW2krK10paWYoZT1xYihjKSxkPTE9PT1jLm5vZGVUeXBlJiYiICIrcGIoZSkrIiAiKXtnPTA7d2hpbGUoZj1iW2crK10pZC5pbmRleE9mKCIgIitmKyIgIik8MCYmKGQrPWYrIiAiKTtoPXBiKGQpLGUhPT1oJiZjLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGgpfX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaT0wO2lmKHIuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3IodGhpcykucmVtb3ZlQ2xhc3MoYS5jYWxsKHRoaXMsYixxYih0aGlzKSkpfSk7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuYXR0cigiY2xhc3MiLCIiKTtpZigic3RyaW5nIj09dHlwZW9mIGEmJmEpe2I9YS5tYXRjaChMKXx8W107d2hpbGUoYz10aGlzW2krK10paWYoZT1xYihjKSxkPTE9PT1jLm5vZGVUeXBlJiYiICIrcGIoZSkrIiAiKXtnPTA7d2hpbGUoZj1iW2crK10pd2hpbGUoZC5pbmRleE9mKCIgIitmKyIgIik+LTEpZD1kLnJlcGxhY2UoIiAiK2YrIiAiLCIgIik7aD1wYihkKSxlIT09aCYmYy5zZXRBdHRyaWJ1dGUoImNsYXNzIixoKX19cmV0dXJuIHRoaXN9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dHlwZW9mIGE7cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgYiYmInN0cmluZyI9PT1jP2I/dGhpcy5hZGRDbGFzcyhhKTp0aGlzLnJlbW92ZUNsYXNzKGEpOnIuaXNGdW5jdGlvbihhKT90aGlzLmVhY2goZnVuY3Rpb24oYyl7cih0aGlzKS50b2dnbGVDbGFzcyhhLmNhbGwodGhpcyxjLHFiKHRoaXMpLGIpLGIpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGIsZCxlLGY7aWYoInN0cmluZyI9PT1jKXtkPTAsZT1yKHRoaXMpLGY9YS5tYXRjaChMKXx8W107d2hpbGUoYj1mW2QrK10pZS5oYXNDbGFzcyhiKT9lLnJlbW92ZUNsYXNzKGIpOmUuYWRkQ2xhc3MoYil9ZWxzZSB2b2lkIDAhPT1hJiYiYm9vbGVhbiIhPT1jfHwoYj1xYih0aGlzKSxiJiZXLnNldCh0aGlzLCJfX2NsYXNzTmFtZV9fIixiKSx0aGlzLnNldEF0dHJpYnV0ZSYmdGhpcy5zZXRBdHRyaWJ1dGUoImNsYXNzIixifHxhPT09ITE/IiI6Vy5nZXQodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIikpfSl9LGhhc0NsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZD0wO2I9IiAiK2ErIiAiO3doaWxlKGM9dGhpc1tkKytdKWlmKDE9PT1jLm5vZGVUeXBlJiYoIiAiK3BiKHFiKGMpKSsiICIpLmluZGV4T2YoYik+LTEpcmV0dXJuITA7cmV0dXJuITF9fSk7dmFyIHJiPS9cci9nO3IuZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGU9dGhpc1swXTt7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gZD1yLmlzRnVuY3Rpb24oYSksdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3ZhciBlOzE9PT10aGlzLm5vZGVUeXBlJiYoZT1kP2EuY2FsbCh0aGlzLGMscih0aGlzKS52YWwoKSk6YSxudWxsPT1lP2U9IiI6Im51bWJlciI9PXR5cGVvZiBlP2UrPSIiOkFycmF5LmlzQXJyYXkoZSkmJihlPXIubWFwKGUsZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/IiI6YSsiIn0pKSxiPXIudmFsSG9va3NbdGhpcy50eXBlXXx8ci52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJiJzZXQiaW4gYiYmdm9pZCAwIT09Yi5zZXQodGhpcyxlLCJ2YWx1ZSIpfHwodGhpcy52YWx1ZT1lKSl9KTtpZihlKXJldHVybiBiPXIudmFsSG9va3NbZS50eXBlXXx8ci52YWxIb29rc1tlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJiJnZXQiaW4gYiYmdm9pZCAwIT09KGM9Yi5nZXQoZSwidmFsdWUiKSk/YzooYz1lLnZhbHVlLCJzdHJpbmciPT10eXBlb2YgYz9jLnJlcGxhY2UocmIsIiIpOm51bGw9PWM/IiI6Yyl9fX0pLHIuZXh0ZW5kKHt2YWxIb29rczp7b3B0aW9uOntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9ci5maW5kLmF0dHIoYSwidmFsdWUiKTtyZXR1cm4gbnVsbCE9Yj9iOnBiKHIudGV4dChhKSl9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihhKXt2YXIgYixjLGQsZT1hLm9wdGlvbnMsZj1hLnNlbGVjdGVkSW5kZXgsZz0ic2VsZWN0LW9uZSI9PT1hLnR5cGUsaD1nP251bGw6W10saT1nP2YrMTplLmxlbmd0aDtmb3IoZD1mPDA/aTpnP2Y6MDtkPGk7ZCsrKWlmKGM9ZVtkXSwoYy5zZWxlY3RlZHx8ZD09PWYpJiYhYy5kaXNhYmxlZCYmKCFjLnBhcmVudE5vZGUuZGlzYWJsZWR8fCFCKGMucGFyZW50Tm9kZSwib3B0Z3JvdXAiKSkpe2lmKGI9cihjKS52YWwoKSxnKXJldHVybiBiO2gucHVzaChiKX1yZXR1cm4gaH0sc2V0OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlPWEub3B0aW9ucyxmPXIubWFrZUFycmF5KGIpLGc9ZS5sZW5ndGg7d2hpbGUoZy0tKWQ9ZVtnXSwoZC5zZWxlY3RlZD1yLmluQXJyYXkoci52YWxIb29rcy5vcHRpb24uZ2V0KGQpLGYpPi0xKSYmKGM9ITApO3JldHVybiBjfHwoYS5zZWxlY3RlZEluZGV4PS0xKSxmfX19fSksci5lYWNoKFsicmFkaW8iLCJjaGVja2JveCJdLGZ1bmN0aW9uKCl7ci52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGEsYil7aWYoQXJyYXkuaXNBcnJheShiKSlyZXR1cm4gYS5jaGVja2VkPXIuaW5BcnJheShyKGEpLnZhbCgpLGIpPi0xfX0sby5jaGVja09ufHwoci52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PT1hLmdldEF0dHJpYnV0ZSgidmFsdWUiKT8ib24iOmEudmFsdWV9KX0pO3ZhciBzYj0vXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC87ci5leHRlbmQoci5ldmVudCx7dHJpZ2dlcjpmdW5jdGlvbihiLGMsZSxmKXt2YXIgZyxoLGksaixrLG0sbixvPVtlfHxkXSxwPWwuY2FsbChiLCJ0eXBlIik/Yi50eXBlOmIscT1sLmNhbGwoYiwibmFtZXNwYWNlIik/Yi5uYW1lc3BhY2Uuc3BsaXQoIi4iKTpbXTtpZihoPWk9ZT1lfHxkLDMhPT1lLm5vZGVUeXBlJiY4IT09ZS5ub2RlVHlwZSYmIXNiLnRlc3QocCtyLmV2ZW50LnRyaWdnZXJlZCkmJihwLmluZGV4T2YoIi4iKT4tMSYmKHE9cC5zcGxpdCgiLiIpLHA9cS5zaGlmdCgpLHEuc29ydCgpKSxrPXAuaW5kZXhPZigiOiIpPDAmJiJvbiIrcCxiPWJbci5leHBhbmRvXT9iOm5ldyByLkV2ZW50KHAsIm9iamVjdCI9PXR5cGVvZiBiJiZiKSxiLmlzVHJpZ2dlcj1mPzI6MyxiLm5hbWVzcGFjZT1xLmpvaW4oIi4iKSxiLnJuYW1lc3BhY2U9Yi5uYW1lc3BhY2U/bmV3IFJlZ0V4cCgiKF58XFwuKSIrcS5qb2luKCJcXC4oPzouKlxcLnwpIikrIihcXC58JCkiKTpudWxsLGIucmVzdWx0PXZvaWQgMCxiLnRhcmdldHx8KGIudGFyZ2V0PWUpLGM9bnVsbD09Yz9bYl06ci5tYWtlQXJyYXkoYyxbYl0pLG49ci5ldmVudC5zcGVjaWFsW3BdfHx7fSxmfHwhbi50cmlnZ2VyfHxuLnRyaWdnZXIuYXBwbHkoZSxjKSE9PSExKSl7aWYoIWYmJiFuLm5vQnViYmxlJiYhci5pc1dpbmRvdyhlKSl7Zm9yKGo9bi5kZWxlZ2F0ZVR5cGV8fHAsc2IudGVzdChqK3ApfHwoaD1oLnBhcmVudE5vZGUpO2g7aD1oLnBhcmVudE5vZGUpby5wdXNoKGgpLGk9aDtpPT09KGUub3duZXJEb2N1bWVudHx8ZCkmJm8ucHVzaChpLmRlZmF1bHRWaWV3fHxpLnBhcmVudFdpbmRvd3x8YSl9Zz0wO3doaWxlKChoPW9bZysrXSkmJiFiLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpYi50eXBlPWc+MT9qOm4uYmluZFR5cGV8fHAsbT0oVy5nZXQoaCwiZXZlbnRzIil8fHt9KVtiLnR5cGVdJiZXLmdldChoLCJoYW5kbGUiKSxtJiZtLmFwcGx5KGgsYyksbT1rJiZoW2tdLG0mJm0uYXBwbHkmJlUoaCkmJihiLnJlc3VsdD1tLmFwcGx5KGgsYyksYi5yZXN1bHQ9PT0hMSYmYi5wcmV2ZW50RGVmYXVsdCgpKTtyZXR1cm4gYi50eXBlPXAsZnx8Yi5pc0RlZmF1bHRQcmV2ZW50ZWQoKXx8bi5fZGVmYXVsdCYmbi5fZGVmYXVsdC5hcHBseShvLnBvcCgpLGMpIT09ITF8fCFVKGUpfHxrJiZyLmlzRnVuY3Rpb24oZVtwXSkmJiFyLmlzV2luZG93KGUpJiYoaT1lW2tdLGkmJihlW2tdPW51bGwpLHIuZXZlbnQudHJpZ2dlcmVkPXAsZVtwXSgpLHIuZXZlbnQudHJpZ2dlcmVkPXZvaWQgMCxpJiYoZVtrXT1pKSksYi5yZXN1bHR9fSxzaW11bGF0ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9ci5leHRlbmQobmV3IHIuRXZlbnQsYyx7dHlwZTphLGlzU2ltdWxhdGVkOiEwfSk7ci5ldmVudC50cmlnZ2VyKGQsbnVsbCxiKX19KSxyLmZuLmV4dGVuZCh7dHJpZ2dlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtyLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGEsYil7dmFyIGM9dGhpc1swXTtpZihjKXJldHVybiByLmV2ZW50LnRyaWdnZXIoYSxiLGMsITApfX0pLHIuZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IHJlc2l6ZSBzY3JvbGwgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBjb250ZXh0bWVudSIuc3BsaXQoIiAiKSxmdW5jdGlvbihhLGIpe3IuZm5bYl09ZnVuY3Rpb24oYSxjKXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD4wP3RoaXMub24oYixudWxsLGEsYyk6dGhpcy50cmlnZ2VyKGIpfX0pLHIuZm4uZXh0ZW5kKHtob3ZlcjpmdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLm1vdXNlZW50ZXIoYSkubW91c2VsZWF2ZShifHxhKX19KSxvLmZvY3VzaW49Im9uZm9jdXNpbiJpbiBhLG8uZm9jdXNpbnx8ci5lYWNoKHtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQifSxmdW5jdGlvbihhLGIpe3ZhciBjPWZ1bmN0aW9uKGEpe3IuZXZlbnQuc2ltdWxhdGUoYixhLnRhcmdldCxyLmV2ZW50LmZpeChhKSl9O3IuZXZlbnQuc3BlY2lhbFtiXT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgZD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsZT1XLmFjY2VzcyhkLGIpO2V8fGQuYWRkRXZlbnRMaXN0ZW5lcihhLGMsITApLFcuYWNjZXNzKGQsYiwoZXx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIGQ9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLGU9Vy5hY2Nlc3MoZCxiKS0xO2U/Vy5hY2Nlc3MoZCxiLGUpOihkLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxjLCEwKSxXLnJlbW92ZShkLGIpKX19fSk7dmFyIHRiPWEubG9jYXRpb24sdWI9ci5ub3coKSx2Yj0vXD8vO3IucGFyc2VYTUw9ZnVuY3Rpb24oYil7dmFyIGM7aWYoIWJ8fCJzdHJpbmciIT10eXBlb2YgYilyZXR1cm4gbnVsbDt0cnl7Yz0obmV3IGEuRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcoYiwidGV4dC94bWwiKX1jYXRjaChkKXtjPXZvaWQgMH1yZXR1cm4gYyYmIWMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIikubGVuZ3RofHxyLmVycm9yKCJJbnZhbGlkIFhNTDogIitiKSxjfTt2YXIgd2I9L1xbXF0kLyx4Yj0vXHI/XG4vZyx5Yj0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksemI9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIEFiKGEsYixjLGQpe3ZhciBlO2lmKEFycmF5LmlzQXJyYXkoYikpci5lYWNoKGIsZnVuY3Rpb24oYixlKXtjfHx3Yi50ZXN0KGEpP2QoYSxlKTpBYihhKyJbIisoIm9iamVjdCI9PXR5cGVvZiBlJiZudWxsIT1lP2I6IiIpKyJdIixlLGMsZCl9KTtlbHNlIGlmKGN8fCJvYmplY3QiIT09ci50eXBlKGIpKWQoYSxiKTtlbHNlIGZvcihlIGluIGIpQWIoYSsiWyIrZSsiXSIsYltlXSxjLGQpfXIucGFyYW09ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9ZnVuY3Rpb24oYSxiKXt2YXIgYz1yLmlzRnVuY3Rpb24oYik/YigpOmI7ZFtkLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGEpKyI9IitlbmNvZGVVUklDb21wb25lbnQobnVsbD09Yz8iIjpjKX07aWYoQXJyYXkuaXNBcnJheShhKXx8YS5qcXVlcnkmJiFyLmlzUGxhaW5PYmplY3QoYSkpci5lYWNoKGEsZnVuY3Rpb24oKXtlKHRoaXMubmFtZSx0aGlzLnZhbHVlKX0pO2Vsc2UgZm9yKGMgaW4gYSlBYihjLGFbY10sYixlKTtyZXR1cm4gZC5qb2luKCImIil9LHIuZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gci5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpfSxzZXJpYWxpemVBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXIucHJvcCh0aGlzLCJlbGVtZW50cyIpO3JldHVybiBhP3IubWFrZUFycmF5KGEpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgYT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIXIodGhpcykuaXMoIjpkaXNhYmxlZCIpJiZ6Yi50ZXN0KHRoaXMubm9kZU5hbWUpJiYheWIudGVzdChhKSYmKHRoaXMuY2hlY2tlZHx8IWphLnRlc3QoYSkpfSkubWFwKGZ1bmN0aW9uKGEsYil7dmFyIGM9cih0aGlzKS52YWwoKTtyZXR1cm4gbnVsbD09Yz9udWxsOkFycmF5LmlzQXJyYXkoYyk/ci5tYXAoYyxmdW5jdGlvbihhKXtyZXR1cm57bmFtZTpiLm5hbWUsdmFsdWU6YS5yZXBsYWNlKHhiLCJcclxuIil9fSk6e25hbWU6Yi5uYW1lLHZhbHVlOmMucmVwbGFjZSh4YiwiXHJcbiIpfX0pLmdldCgpfX0pO3ZhciBCYj0vJTIwL2csQ2I9LyMuKiQvLERiPS8oWz8mXSlfPVteJl0qLyxFYj0vXiguKj8pOlsgXHRdKihbXlxyXG5dKikkL2dtLEZiPS9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLEdiPS9eKD86R0VUfEhFQUQpJC8sSGI9L15cL1wvLyxJYj17fSxKYj17fSxLYj0iKi8iLmNvbmNhdCgiKiIpLExiPWQuY3JlYXRlRWxlbWVudCgiYSIpO0xiLmhyZWY9dGIuaHJlZjtmdW5jdGlvbiBNYihhKXtyZXR1cm4gZnVuY3Rpb24oYixjKXsic3RyaW5nIiE9dHlwZW9mIGImJihjPWIsYj0iKiIpO3ZhciBkLGU9MCxmPWIudG9Mb3dlckNhc2UoKS5tYXRjaChMKXx8W107aWYoci5pc0Z1bmN0aW9uKGMpKXdoaWxlKGQ9ZltlKytdKSIrIj09PWRbMF0/KGQ9ZC5zbGljZSgxKXx8IioiLChhW2RdPWFbZF18fFtdKS51bnNoaWZ0KGMpKTooYVtkXT1hW2RdfHxbXSkucHVzaChjKX19ZnVuY3Rpb24gTmIoYSxiLGMsZCl7dmFyIGU9e30sZj1hPT09SmI7ZnVuY3Rpb24gZyhoKXt2YXIgaTtyZXR1cm4gZVtoXT0hMCxyLmVhY2goYVtoXXx8W10sZnVuY3Rpb24oYSxoKXt2YXIgaj1oKGIsYyxkKTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGp8fGZ8fGVbal0/Zj8hKGk9aik6dm9pZCAwOihiLmRhdGFUeXBlcy51bnNoaWZ0KGopLGcoaiksITEpfSksaX1yZXR1cm4gZyhiLmRhdGFUeXBlc1swXSl8fCFlWyIqIl0mJmcoIioiKX1mdW5jdGlvbiBPYihhLGIpe3ZhciBjLGQsZT1yLmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9uc3x8e307Zm9yKGMgaW4gYil2b2lkIDAhPT1iW2NdJiYoKGVbY10/YTpkfHwoZD17fSkpW2NdPWJbY10pO3JldHVybiBkJiZyLmV4dGVuZCghMCxhLGQpLGF9ZnVuY3Rpb24gUGIoYSxiLGMpe3ZhciBkLGUsZixnLGg9YS5jb250ZW50cyxpPWEuZGF0YVR5cGVzO3doaWxlKCIqIj09PWlbMF0paS5zaGlmdCgpLHZvaWQgMD09PWQmJihkPWEubWltZVR5cGV8fGIuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTtpZihkKWZvcihlIGluIGgpaWYoaFtlXSYmaFtlXS50ZXN0KGQpKXtpLnVuc2hpZnQoZSk7YnJlYWt9aWYoaVswXWluIGMpZj1pWzBdO2Vsc2V7Zm9yKGUgaW4gYyl7aWYoIWlbMF18fGEuY29udmVydGVyc1tlKyIgIitpWzBdXSl7Zj1lO2JyZWFrfWd8fChnPWUpfWY9Znx8Z31pZihmKXJldHVybiBmIT09aVswXSYmaS51bnNoaWZ0KGYpLGNbZl19ZnVuY3Rpb24gUWIoYSxiLGMsZCl7dmFyIGUsZixnLGgsaSxqPXt9LGs9YS5kYXRhVHlwZXMuc2xpY2UoKTtpZihrWzFdKWZvcihnIGluIGEuY29udmVydGVycylqW2cudG9Mb3dlckNhc2UoKV09YS5jb252ZXJ0ZXJzW2ddO2Y9ay5zaGlmdCgpO3doaWxlKGYpaWYoYS5yZXNwb25zZUZpZWxkc1tmXSYmKGNbYS5yZXNwb25zZUZpZWxkc1tmXV09YiksIWkmJmQmJmEuZGF0YUZpbHRlciYmKGI9YS5kYXRhRmlsdGVyKGIsYS5kYXRhVHlwZSkpLGk9ZixmPWsuc2hpZnQoKSlpZigiKiI9PT1mKWY9aTtlbHNlIGlmKCIqIiE9PWkmJmkhPT1mKXtpZihnPWpbaSsiICIrZl18fGpbIiogIitmXSwhZylmb3IoZSBpbiBqKWlmKGg9ZS5zcGxpdCgiICIpLGhbMV09PT1mJiYoZz1qW2krIiAiK2hbMF1dfHxqWyIqICIraFswXV0pKXtnPT09ITA/Zz1qW2VdOmpbZV0hPT0hMCYmKGY9aFswXSxrLnVuc2hpZnQoaFsxXSkpO2JyZWFrfWlmKGchPT0hMClpZihnJiZhWyJ0aHJvd3MiXSliPWcoYik7ZWxzZSB0cnl7Yj1nKGIpfWNhdGNoKGwpe3JldHVybntzdGF0ZToicGFyc2VyZXJyb3IiLGVycm9yOmc/bDoiTm8gY29udmVyc2lvbiBmcm9tICIraSsiIHRvICIrZn19fXJldHVybntzdGF0ZToic3VjY2VzcyIsZGF0YTpifX1yLmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6dGIuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6RmIudGVzdCh0Yi5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjpLYix0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpKU09OLnBhcnNlLCJ0ZXh0IHhtbCI6ci5wYXJzZVhNTH0sZmxhdE9wdGlvbnM6e3VybDohMCxjb250ZXh0OiEwfX0sYWpheFNldHVwOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGI/T2IoT2IoYSxyLmFqYXhTZXR0aW5ncyksYik6T2Ioci5hamF4U2V0dGluZ3MsYSl9LGFqYXhQcmVmaWx0ZXI6TWIoSWIpLGFqYXhUcmFuc3BvcnQ6TWIoSmIpLGFqYXg6ZnVuY3Rpb24oYixjKXsib2JqZWN0Ij09dHlwZW9mIGImJihjPWIsYj12b2lkIDApLGM9Y3x8e307dmFyIGUsZixnLGgsaSxqLGssbCxtLG4sbz1yLmFqYXhTZXR1cCh7fSxjKSxwPW8uY29udGV4dHx8byxxPW8uY29udGV4dCYmKHAubm9kZVR5cGV8fHAuanF1ZXJ5KT9yKHApOnIuZXZlbnQscz1yLkRlZmVycmVkKCksdD1yLkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx1PW8uc3RhdHVzQ29kZXx8e30sdj17fSx3PXt9LHg9ImNhbmNlbGVkIix5PXtyZWFkeVN0YXRlOjAsZ2V0UmVzcG9uc2VIZWFkZXI6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoayl7aWYoIWgpe2g9e307d2hpbGUoYj1FYi5leGVjKGcpKWhbYlsxXS50b0xvd2VyQ2FzZSgpXT1iWzJdfWI9aFthLnRvTG93ZXJDYXNlKCldfXJldHVybiBudWxsPT1iP251bGw6Yn0sZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOmZ1bmN0aW9uKCl7cmV0dXJuIGs/ZzpudWxsfSxzZXRSZXF1ZXN0SGVhZGVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIG51bGw9PWsmJihhPXdbYS50b0xvd2VyQ2FzZSgpXT13W2EudG9Mb3dlckNhc2UoKV18fGEsdlthXT1iKSx0aGlzfSxvdmVycmlkZU1pbWVUeXBlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1rJiYoby5taW1lVHlwZT1hKSx0aGlzfSxzdGF0dXNDb2RlOmZ1bmN0aW9uKGEpe3ZhciBiO2lmKGEpaWYoayl5LmFsd2F5cyhhW3kuc3RhdHVzXSk7ZWxzZSBmb3IoYiBpbiBhKXVbYl09W3VbYl0sYVtiXV07cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGEpe3ZhciBiPWF8fHg7cmV0dXJuIGUmJmUuYWJvcnQoYiksQSgwLGIpLHRoaXN9fTtpZihzLnByb21pc2UoeSksby51cmw9KChifHxvLnVybHx8dGIuaHJlZikrIiIpLnJlcGxhY2UoSGIsdGIucHJvdG9jb2wrIi8vIiksby50eXBlPWMubWV0aG9kfHxjLnR5cGV8fG8ubWV0aG9kfHxvLnR5cGUsby5kYXRhVHlwZXM9KG8uZGF0YVR5cGV8fCIqIikudG9Mb3dlckNhc2UoKS5tYXRjaChMKXx8WyIiXSxudWxsPT1vLmNyb3NzRG9tYWluKXtqPWQuY3JlYXRlRWxlbWVudCgiYSIpO3RyeXtqLmhyZWY9by51cmwsai5ocmVmPWouaHJlZixvLmNyb3NzRG9tYWluPUxiLnByb3RvY29sKyIvLyIrTGIuaG9zdCE9ai5wcm90b2NvbCsiLy8iK2ouaG9zdH1jYXRjaCh6KXtvLmNyb3NzRG9tYWluPSEwfX1pZihvLmRhdGEmJm8ucHJvY2Vzc0RhdGEmJiJzdHJpbmciIT10eXBlb2Ygby5kYXRhJiYoby5kYXRhPXIucGFyYW0oby5kYXRhLG8udHJhZGl0aW9uYWwpKSxOYihJYixvLGMseSksaylyZXR1cm4geTtsPXIuZXZlbnQmJm8uZ2xvYmFsLGwmJjA9PT1yLmFjdGl2ZSsrJiZyLmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpLG8udHlwZT1vLnR5cGUudG9VcHBlckNhc2UoKSxvLmhhc0NvbnRlbnQ9IUdiLnRlc3Qoby50eXBlKSxmPW8udXJsLnJlcGxhY2UoQ2IsIiIpLG8uaGFzQ29udGVudD9vLmRhdGEmJm8ucHJvY2Vzc0RhdGEmJjA9PT0oby5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiYoby5kYXRhPW8uZGF0YS5yZXBsYWNlKEJiLCIrIikpOihuPW8udXJsLnNsaWNlKGYubGVuZ3RoKSxvLmRhdGEmJihmKz0odmIudGVzdChmKT8iJiI6Ij8iKStvLmRhdGEsZGVsZXRlIG8uZGF0YSksby5jYWNoZT09PSExJiYoZj1mLnJlcGxhY2UoRGIsIiQxIiksbj0odmIudGVzdChmKT8iJiI6Ij8iKSsiXz0iK3ViKysgK24pLG8udXJsPWYrbiksby5pZk1vZGlmaWVkJiYoci5sYXN0TW9kaWZpZWRbZl0mJnkuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLHIubGFzdE1vZGlmaWVkW2ZdKSxyLmV0YWdbZl0mJnkuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsci5ldGFnW2ZdKSksKG8uZGF0YSYmby5oYXNDb250ZW50JiZvLmNvbnRlbnRUeXBlIT09ITF8fGMuY29udGVudFR5cGUpJiZ5LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsby5jb250ZW50VHlwZSkseS5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLG8uZGF0YVR5cGVzWzBdJiZvLmFjY2VwdHNbby5kYXRhVHlwZXNbMF1dP28uYWNjZXB0c1tvLmRhdGFUeXBlc1swXV0rKCIqIiE9PW8uZGF0YVR5cGVzWzBdPyIsICIrS2IrIjsgcT0wLjAxIjoiIik6by5hY2NlcHRzWyIqIl0pO2ZvcihtIGluIG8uaGVhZGVycyl5LnNldFJlcXVlc3RIZWFkZXIobSxvLmhlYWRlcnNbbV0pO2lmKG8uYmVmb3JlU2VuZCYmKG8uYmVmb3JlU2VuZC5jYWxsKHAseSxvKT09PSExfHxrKSlyZXR1cm4geS5hYm9ydCgpO2lmKHg9ImFib3J0Iix0LmFkZChvLmNvbXBsZXRlKSx5LmRvbmUoby5zdWNjZXNzKSx5LmZhaWwoby5lcnJvciksZT1OYihKYixvLGMseSkpe2lmKHkucmVhZHlTdGF0ZT0xLGwmJnEudHJpZ2dlcigiYWpheFNlbmQiLFt5LG9dKSxrKXJldHVybiB5O28uYXN5bmMmJm8udGltZW91dD4wJiYoaT1hLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt5LmFib3J0KCJ0aW1lb3V0Iil9LG8udGltZW91dCkpO3RyeXtrPSExLGUuc2VuZCh2LEEpfWNhdGNoKHope2lmKGspdGhyb3cgejtBKC0xLHopfX1lbHNlIEEoLTEsIk5vIFRyYW5zcG9ydCIpO2Z1bmN0aW9uIEEoYixjLGQsaCl7dmFyIGosbSxuLHYsdyx4PWM7a3x8KGs9ITAsaSYmYS5jbGVhclRpbWVvdXQoaSksZT12b2lkIDAsZz1ofHwiIix5LnJlYWR5U3RhdGU9Yj4wPzQ6MCxqPWI+PTIwMCYmYjwzMDB8fDMwND09PWIsZCYmKHY9UGIobyx5LGQpKSx2PVFiKG8sdix5LGopLGo/KG8uaWZNb2RpZmllZCYmKHc9eS5nZXRSZXNwb25zZUhlYWRlcigiTGFzdC1Nb2RpZmllZCIpLHcmJihyLmxhc3RNb2RpZmllZFtmXT13KSx3PXkuZ2V0UmVzcG9uc2VIZWFkZXIoImV0YWciKSx3JiYoci5ldGFnW2ZdPXcpKSwyMDQ9PT1ifHwiSEVBRCI9PT1vLnR5cGU/eD0ibm9jb250ZW50IjozMDQ9PT1iP3g9Im5vdG1vZGlmaWVkIjooeD12LnN0YXRlLG09di5kYXRhLG49di5lcnJvcixqPSFuKSk6KG49eCwhYiYmeHx8KHg9ImVycm9yIixiPDAmJihiPTApKSkseS5zdGF0dXM9Yix5LnN0YXR1c1RleHQ9KGN8fHgpKyIiLGo/cy5yZXNvbHZlV2l0aChwLFttLHgseV0pOnMucmVqZWN0V2l0aChwLFt5LHgsbl0pLHkuc3RhdHVzQ29kZSh1KSx1PXZvaWQgMCxsJiZxLnRyaWdnZXIoaj8iYWpheFN1Y2Nlc3MiOiJhamF4RXJyb3IiLFt5LG8saj9tOm5dKSx0LmZpcmVXaXRoKHAsW3kseF0pLGwmJihxLnRyaWdnZXIoImFqYXhDb21wbGV0ZSIsW3ksb10pLC0tci5hY3RpdmV8fHIuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSkpfXJldHVybiB5fSxnZXRKU09OOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gci5nZXQoYSxiLGMsImpzb24iKX0sZ2V0U2NyaXB0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIHIuZ2V0KGEsdm9pZCAwLGIsInNjcmlwdCIpfX0pLHIuZWFjaChbImdldCIsInBvc3QiXSxmdW5jdGlvbihhLGIpe3JbYl09ZnVuY3Rpb24oYSxjLGQsZSl7cmV0dXJuIHIuaXNGdW5jdGlvbihjKSYmKGU9ZXx8ZCxkPWMsYz12b2lkIDApLHIuYWpheChyLmV4dGVuZCh7dXJsOmEsdHlwZTpiLGRhdGFUeXBlOmUsZGF0YTpjLHN1Y2Nlc3M6ZH0sci5pc1BsYWluT2JqZWN0KGEpJiZhKSl9fSksci5fZXZhbFVybD1mdW5jdGlvbihhKXtyZXR1cm4gci5hamF4KHt1cmw6YSx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGNhY2hlOiEwLGFzeW5jOiExLGdsb2JhbDohMSwidGhyb3dzIjohMH0pfSxyLmZuLmV4dGVuZCh7d3JhcEFsbDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gdGhpc1swXSYmKHIuaXNGdW5jdGlvbihhKSYmKGE9YS5jYWxsKHRoaXNbMF0pKSxiPXIoYSx0aGlzWzBdLm93bmVyRG9jdW1lbnQpLmVxKDApLmNsb25lKCEwKSx0aGlzWzBdLnBhcmVudE5vZGUmJmIuaW5zZXJ0QmVmb3JlKHRoaXNbMF0pLGIubWFwKGZ1bmN0aW9uKCl7dmFyIGE9dGhpczt3aGlsZShhLmZpcnN0RWxlbWVudENoaWxkKWE9YS5maXJzdEVsZW1lbnRDaGlsZDtyZXR1cm4gYX0pLmFwcGVuZCh0aGlzKSksdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGEpe3JldHVybiByLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3IodGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLGIpKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPXIodGhpcyksYz1iLmNvbnRlbnRzKCk7Yy5sZW5ndGg/Yy53cmFwQWxsKGEpOmIuYXBwZW5kKGEpfSl9LHdyYXA6ZnVuY3Rpb24oYSl7dmFyIGI9ci5pc0Z1bmN0aW9uKGEpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYyl7cih0aGlzKS53cmFwQWxsKGI/YS5jYWxsKHRoaXMsYyk6YSl9KX0sdW53cmFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnBhcmVudChhKS5ub3QoImJvZHkiKS5lYWNoKGZ1bmN0aW9uKCl7cih0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpfSksdGhpc319KSxyLmV4cHIucHNldWRvcy5oaWRkZW49ZnVuY3Rpb24oYSl7cmV0dXJuIXIuZXhwci5wc2V1ZG9zLnZpc2libGUoYSl9LHIuZXhwci5wc2V1ZG9zLnZpc2libGU9ZnVuY3Rpb24oYSl7cmV0dXJuISEoYS5vZmZzZXRXaWR0aHx8YS5vZmZzZXRIZWlnaHR8fGEuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgpfSxyLmFqYXhTZXR0aW5ncy54aHI9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIG5ldyBhLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGIpe319O3ZhciBSYj17MDoyMDAsMTIyMzoyMDR9LFNiPXIuYWpheFNldHRpbmdzLnhocigpO28uY29ycz0hIVNiJiYid2l0aENyZWRlbnRpYWxzImluIFNiLG8uYWpheD1TYj0hIVNiLHIuYWpheFRyYW5zcG9ydChmdW5jdGlvbihiKXt2YXIgYyxkO2lmKG8uY29yc3x8U2ImJiFiLmNyb3NzRG9tYWluKXJldHVybntzZW5kOmZ1bmN0aW9uKGUsZil7dmFyIGcsaD1iLnhocigpO2lmKGgub3BlbihiLnR5cGUsYi51cmwsYi5hc3luYyxiLnVzZXJuYW1lLGIucGFzc3dvcmQpLGIueGhyRmllbGRzKWZvcihnIGluIGIueGhyRmllbGRzKWhbZ109Yi54aHJGaWVsZHNbZ107Yi5taW1lVHlwZSYmaC5vdmVycmlkZU1pbWVUeXBlJiZoLm92ZXJyaWRlTWltZVR5cGUoYi5taW1lVHlwZSksYi5jcm9zc0RvbWFpbnx8ZVsiWC1SZXF1ZXN0ZWQtV2l0aCJdfHwoZVsiWC1SZXF1ZXN0ZWQtV2l0aCJdPSJYTUxIdHRwUmVxdWVzdCIpO2ZvcihnIGluIGUpaC5zZXRSZXF1ZXN0SGVhZGVyKGcsZVtnXSk7Yz1mdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtjJiYoYz1kPWgub25sb2FkPWgub25lcnJvcj1oLm9uYWJvcnQ9aC5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbCwiYWJvcnQiPT09YT9oLmFib3J0KCk6ImVycm9yIj09PWE/Im51bWJlciIhPXR5cGVvZiBoLnN0YXR1cz9mKDAsImVycm9yIik6ZihoLnN0YXR1cyxoLnN0YXR1c1RleHQpOmYoUmJbaC5zdGF0dXNdfHxoLnN0YXR1cyxoLnN0YXR1c1RleHQsInRleHQiIT09KGgucmVzcG9uc2VUeXBlfHwidGV4dCIpfHwic3RyaW5nIiE9dHlwZW9mIGgucmVzcG9uc2VUZXh0P3tiaW5hcnk6aC5yZXNwb25zZX06e3RleHQ6aC5yZXNwb25zZVRleHR9LGguZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpKX19LGgub25sb2FkPWMoKSxkPWgub25lcnJvcj1jKCJlcnJvciIpLHZvaWQgMCE9PWgub25hYm9ydD9oLm9uYWJvcnQ9ZDpoLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpezQ9PT1oLnJlYWR5U3RhdGUmJmEuc2V0VGltZW91dChmdW5jdGlvbigpe2MmJmQoKX0pfSxjPWMoImFib3J0Iik7dHJ5e2guc2VuZChiLmhhc0NvbnRlbnQmJmIuZGF0YXx8bnVsbCl9Y2F0Y2goaSl7aWYoYyl0aHJvdyBpfX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX0pLHIuYWpheFByZWZpbHRlcihmdW5jdGlvbihhKXthLmNyb3NzRG9tYWluJiYoYS5jb250ZW50cy5zY3JpcHQ9ITEpfSksci5hamF4U2V0dXAoe2FjY2VwdHM6e3NjcmlwdDoidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQifSxjb250ZW50czp7c2NyaXB0Oi9cYig/OmphdmF8ZWNtYSlzY3JpcHRcYi99LGNvbnZlcnRlcnM6eyJ0ZXh0IHNjcmlwdCI6ZnVuY3Rpb24oYSl7cmV0dXJuIHIuZ2xvYmFsRXZhbChhKSxhfX19KSxyLmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsZnVuY3Rpb24oYSl7dm9pZCAwPT09YS5jYWNoZSYmKGEuY2FjaGU9ITEpLGEuY3Jvc3NEb21haW4mJihhLnR5cGU9IkdFVCIpfSksci5hamF4VHJhbnNwb3J0KCJzY3JpcHQiLGZ1bmN0aW9uKGEpe2lmKGEuY3Jvc3NEb21haW4pe3ZhciBiLGM7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSxmKXtiPXIoIjxzY3JpcHQ+IikucHJvcCh7Y2hhcnNldDphLnNjcmlwdENoYXJzZXQsc3JjOmEudXJsfSkub24oImxvYWQgZXJyb3IiLGM9ZnVuY3Rpb24oYSl7Yi5yZW1vdmUoKSxjPW51bGwsYSYmZigiZXJyb3IiPT09YS50eXBlPzQwNDoyMDAsYS50eXBlKX0pLGQuaGVhZC5hcHBlbmRDaGlsZChiWzBdKX0sYWJvcnQ6ZnVuY3Rpb24oKXtjJiZjKCl9fX19KTt2YXIgVGI9W10sVWI9Lyg9KVw/KD89JnwkKXxcP1w/LztyLmFqYXhTZXR1cCh7anNvbnA6ImNhbGxiYWNrIixqc29ucENhbGxiYWNrOmZ1bmN0aW9uKCl7dmFyIGE9VGIucG9wKCl8fHIuZXhwYW5kbysiXyIrdWIrKztyZXR1cm4gdGhpc1thXT0hMCxhfX0pLHIuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoPWIuanNvbnAhPT0hMSYmKFViLnRlc3QoYi51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgYi5kYXRhJiYwPT09KGIuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmVWIudGVzdChiLmRhdGEpJiYiZGF0YSIpO2lmKGh8fCJqc29ucCI9PT1iLmRhdGFUeXBlc1swXSlyZXR1cm4gZT1iLmpzb25wQ2FsbGJhY2s9ci5pc0Z1bmN0aW9uKGIuanNvbnBDYWxsYmFjayk/Yi5qc29ucENhbGxiYWNrKCk6Yi5qc29ucENhbGxiYWNrLGg/YltoXT1iW2hdLnJlcGxhY2UoVWIsIiQxIitlKTpiLmpzb25wIT09ITEmJihiLnVybCs9KHZiLnRlc3QoYi51cmwpPyImIjoiPyIpK2IuanNvbnArIj0iK2UpLGIuY29udmVydGVyc1sic2NyaXB0IGpzb24iXT1mdW5jdGlvbigpe3JldHVybiBnfHxyLmVycm9yKGUrIiB3YXMgbm90IGNhbGxlZCIpLGdbMF19LGIuZGF0YVR5cGVzWzBdPSJqc29uIixmPWFbZV0sYVtlXT1mdW5jdGlvbigpe2c9YXJndW1lbnRzfSxkLmFsd2F5cyhmdW5jdGlvbigpe3ZvaWQgMD09PWY/cihhKS5yZW1vdmVQcm9wKGUpOmFbZV09ZixiW2VdJiYoYi5qc29ucENhbGxiYWNrPWMuanNvbnBDYWxsYmFjayxUYi5wdXNoKGUpKSxnJiZyLmlzRnVuY3Rpb24oZikmJmYoZ1swXSksZz1mPXZvaWQgMH0pLCJzY3JpcHQifSksby5jcmVhdGVIVE1MRG9jdW1lbnQ9ZnVuY3Rpb24oKXt2YXIgYT1kLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keTtyZXR1cm4gYS5pbm5lckhUTUw9Ijxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IiwyPT09YS5jaGlsZE5vZGVzLmxlbmd0aH0oKSxyLnBhcnNlSFRNTD1mdW5jdGlvbihhLGIsYyl7aWYoInN0cmluZyIhPXR5cGVvZiBhKXJldHVybltdOyJib29sZWFuIj09dHlwZW9mIGImJihjPWIsYj0hMSk7dmFyIGUsZixnO3JldHVybiBifHwoby5jcmVhdGVIVE1MRG9jdW1lbnQ/KGI9ZC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoIiIpLGU9Yi5jcmVhdGVFbGVtZW50KCJiYXNlIiksZS5ocmVmPWQubG9jYXRpb24uaHJlZixiLmhlYWQuYXBwZW5kQ2hpbGQoZSkpOmI9ZCksZj1DLmV4ZWMoYSksZz0hYyYmW10sZj9bYi5jcmVhdGVFbGVtZW50KGZbMV0pXTooZj1xYShbYV0sYixnKSxnJiZnLmxlbmd0aCYmcihnKS5yZW1vdmUoKSxyLm1lcmdlKFtdLGYuY2hpbGROb2RlcykpfSxyLmZuLmxvYWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnPXRoaXMsaD1hLmluZGV4T2YoIiAiKTtyZXR1cm4gaD4tMSYmKGQ9cGIoYS5zbGljZShoKSksYT1hLnNsaWNlKDAsaCkpLHIuaXNGdW5jdGlvbihiKT8oYz1iLGI9dm9pZCAwKTpiJiYib2JqZWN0Ij09dHlwZW9mIGImJihlPSJQT1NUIiksZy5sZW5ndGg+MCYmci5hamF4KHt1cmw6YSx0eXBlOmV8fCJHRVQiLGRhdGFUeXBlOiJodG1sIixkYXRhOmJ9KS5kb25lKGZ1bmN0aW9uKGEpe2Y9YXJndW1lbnRzLGcuaHRtbChkP3IoIjxkaXY+IikuYXBwZW5kKHIucGFyc2VIVE1MKGEpKS5maW5kKGQpOmEpfSkuYWx3YXlzKGMmJmZ1bmN0aW9uKGEsYil7Zy5lYWNoKGZ1bmN0aW9uKCl7Yy5hcHBseSh0aGlzLGZ8fFthLnJlc3BvbnNlVGV4dCxiLGFdKX0pfSksdGhpc30sci5lYWNoKFsiYWpheFN0YXJ0IiwiYWpheFN0b3AiLCJhamF4Q29tcGxldGUiLCJhamF4RXJyb3IiLCJhamF4U3VjY2VzcyIsImFqYXhTZW5kIl0sZnVuY3Rpb24oYSxiKXtyLmZuW2JdPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLm9uKGIsYSl9fSksci5leHByLnBzZXVkb3MuYW5pbWF0ZWQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHIuZ3JlcChyLnRpbWVycyxmdW5jdGlvbihiKXtyZXR1cm4gYT09PWIuZWxlbX0pLmxlbmd0aH0sci5vZmZzZXQ9e3NldE9mZnNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaCxpLGosaz1yLmNzcyhhLCJwb3NpdGlvbiIpLGw9cihhKSxtPXt9OyJzdGF0aWMiPT09ayYmKGEuc3R5bGUucG9zaXRpb249InJlbGF0aXZlIiksaD1sLm9mZnNldCgpLGY9ci5jc3MoYSwidG9wIiksaT1yLmNzcyhhLCJsZWZ0Iiksaj0oImFic29sdXRlIj09PWt8fCJmaXhlZCI9PT1rKSYmKGYraSkuaW5kZXhPZigiYXV0byIpPi0xLGo/KGQ9bC5wb3NpdGlvbigpLGc9ZC50b3AsZT1kLmxlZnQpOihnPXBhcnNlRmxvYXQoZil8fDAsZT1wYXJzZUZsb2F0KGkpfHwwKSxyLmlzRnVuY3Rpb24oYikmJihiPWIuY2FsbChhLGMsci5leHRlbmQoe30saCkpKSxudWxsIT1iLnRvcCYmKG0udG9wPWIudG9wLWgudG9wK2cpLG51bGwhPWIubGVmdCYmKG0ubGVmdD1iLmxlZnQtaC5sZWZ0K2UpLCJ1c2luZyJpbiBiP2IudXNpbmcuY2FsbChhLG0pOmwuY3NzKG0pfX0sci5mbi5leHRlbmQoe29mZnNldDpmdW5jdGlvbihhKXtpZihhcmd1bWVudHMubGVuZ3RoKXJldHVybiB2b2lkIDA9PT1hP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3Iub2Zmc2V0LnNldE9mZnNldCh0aGlzLGEsYil9KTt2YXIgYixjLGQsZSxmPXRoaXNbMF07aWYoZilyZXR1cm4gZi5nZXRDbGllbnRSZWN0cygpLmxlbmd0aD8oZD1mLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGI9Zi5vd25lckRvY3VtZW50LGM9Yi5kb2N1bWVudEVsZW1lbnQsZT1iLmRlZmF1bHRWaWV3LHt0b3A6ZC50b3ArZS5wYWdlWU9mZnNldC1jLmNsaWVudFRvcCxsZWZ0OmQubGVmdCtlLnBhZ2VYT2Zmc2V0LWMuY2xpZW50TGVmdH0pOnt0b3A6MCxsZWZ0OjB9fSxwb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXNbMF0pe3ZhciBhLGIsYz10aGlzWzBdLGQ9e3RvcDowLGxlZnQ6MH07cmV0dXJuImZpeGVkIj09PXIuY3NzKGMsInBvc2l0aW9uIik/Yj1jLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOihhPXRoaXMub2Zmc2V0UGFyZW50KCksYj10aGlzLm9mZnNldCgpLEIoYVswXSwiaHRtbCIpfHwoZD1hLm9mZnNldCgpKSxkPXt0b3A6ZC50b3Arci5jc3MoYVswXSwiYm9yZGVyVG9wV2lkdGgiLCEwKSxsZWZ0OmQubGVmdCtyLmNzcyhhWzBdLCJib3JkZXJMZWZ0V2lkdGgiLCEwKX0pLHt0b3A6Yi50b3AtZC50b3Atci5jc3MoYywibWFyZ2luVG9wIiwhMCksbGVmdDpiLmxlZnQtZC5sZWZ0LXIuY3NzKGMsIm1hcmdpbkxlZnQiLCEwKX19fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9mZnNldFBhcmVudDt3aGlsZShhJiYic3RhdGljIj09PXIuY3NzKGEsInBvc2l0aW9uIikpYT1hLm9mZnNldFBhcmVudDtyZXR1cm4gYXx8cmF9KX19KSxyLmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24oYSxiKXt2YXIgYz0icGFnZVlPZmZzZXQiPT09YjtyLmZuW2FdPWZ1bmN0aW9uKGQpe3JldHVybiBUKHRoaXMsZnVuY3Rpb24oYSxkLGUpe3ZhciBmO3JldHVybiByLmlzV2luZG93KGEpP2Y9YTo5PT09YS5ub2RlVHlwZSYmKGY9YS5kZWZhdWx0Vmlldyksdm9pZCAwPT09ZT9mP2ZbYl06YVtkXTp2b2lkKGY/Zi5zY3JvbGxUbyhjP2YucGFnZVhPZmZzZXQ6ZSxjP2U6Zi5wYWdlWU9mZnNldCk6YVtkXT1lKX0sYSxkLGFyZ3VtZW50cy5sZW5ndGgpfX0pLHIuZWFjaChbInRvcCIsImxlZnQiXSxmdW5jdGlvbihhLGIpe3IuY3NzSG9va3NbYl09UGEoby5waXhlbFBvc2l0aW9uLGZ1bmN0aW9uKGEsYyl7aWYoYylyZXR1cm4gYz1PYShhLGIpLE1hLnRlc3QoYyk/cihhKS5wb3NpdGlvbigpW2JdKyJweCI6Y30pfSksci5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24oYSxiKXtyLmVhY2goe3BhZGRpbmc6ImlubmVyIithLGNvbnRlbnQ6YiwiIjoib3V0ZXIiK2F9LGZ1bmN0aW9uKGMsZCl7ci5mbltkXT1mdW5jdGlvbihlLGYpe3ZhciBnPWFyZ3VtZW50cy5sZW5ndGgmJihjfHwiYm9vbGVhbiIhPXR5cGVvZiBlKSxoPWN8fChlPT09ITB8fGY9PT0hMD8ibWFyZ2luIjoiYm9yZGVyIik7cmV0dXJuIFQodGhpcyxmdW5jdGlvbihiLGMsZSl7dmFyIGY7cmV0dXJuIHIuaXNXaW5kb3coYik/MD09PWQuaW5kZXhPZigib3V0ZXIiKT9iWyJpbm5lciIrYV06Yi5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrYV06OT09PWIubm9kZVR5cGU/KGY9Yi5kb2N1bWVudEVsZW1lbnQsTWF0aC5tYXgoYi5ib2R5WyJzY3JvbGwiK2FdLGZbInNjcm9sbCIrYV0sYi5ib2R5WyJvZmZzZXQiK2FdLGZbIm9mZnNldCIrYV0sZlsiY2xpZW50IithXSkpOnZvaWQgMD09PWU/ci5jc3MoYixjLGgpOnIuc3R5bGUoYixjLGUsaCl9LGIsZz9lOnZvaWQgMCxnKX19KX0pLHIuZm4uZXh0ZW5kKHtiaW5kOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gdGhpcy5vbihhLG51bGwsYixjKX0sdW5iaW5kOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMub2ZmKGEsbnVsbCxiKX0sZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMub24oYixhLGMsZCl9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLm9mZihhLCIqKiIpOnRoaXMub2ZmKGIsYXx8IioqIixjKX19KSxyLmhvbGRSZWFkeT1mdW5jdGlvbihhKXthP3IucmVhZHlXYWl0Kys6ci5yZWFkeSghMCl9LHIuaXNBcnJheT1BcnJheS5pc0FycmF5LHIucGFyc2VKU09OPUpTT04ucGFyc2Usci5ub2RlTmFtZT1CLCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZSgianF1ZXJ5IixbXSxmdW5jdGlvbigpe3JldHVybiByfSk7dmFyIFZiPWEualF1ZXJ5LFdiPWEuJDtyZXR1cm4gci5ub0NvbmZsaWN0PWZ1bmN0aW9uKGIpe3JldHVybiBhLiQ9PT1yJiYoYS4kPVdiKSxiJiZhLmpRdWVyeT09PXImJihhLmpRdWVyeT1WYikscn0sYnx8KGEualF1ZXJ5PWEuJD1yKSxyfSk7Cg=="}]},{"name":"4chan x","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["http://boards.4chan.org/*","https://boards.4chan.org/*","http://boards.4channel.org/*","https://boards.4channel.org/*","http://sys.4chan.org/*","https://sys.4chan.org/*","http://a.4cdn.org/*","https://a.4cdn.org/*","http://i.4cdn.org/*","https://i.4cdn.org/*","http://is.4chan.org/*","https://is.4chan.org/*","http://is2.4chan.org/*","https://is2.4chan.org/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609795819692,"data":{}},"enabled":true,"position":3,"file_url":"https://github.com/loadletter/4chan-x/raw/master/4chan_x.user.js","uuid":"b761e789-cd53-42ce-a3bb-5db0cdf59a18","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgIDRjaGFuIHgKLy8gQHZlcnNpb24gICAgICAgIDIuNDAuNzcKLy8gQG5hbWVzcGFjZSAgICAgIGFlb3N5bnRoCi8vIEBkZXNjcmlwdGlvbiAgICBBZGRzIHZhcmlvdXMgZmVhdHVyZXMuCi8vIEBjb3B5cmlnaHQgICAgICAyMDA5LTIwMTEgSmFtZXMgQ2FtcG9zIDxqYW1lcy5yLmNhbXBvc0BnbWFpbC5jb20+Ci8vIEBjb3B5cmlnaHQgICAgICAyMDEyLTIwMTMgTmljb2xhcyBTdGVwaWVuIDxzdGVwaWVuLm5pY29sYXNAZ21haWwuY29tPgovLyBAbGljZW5zZSAgICAgICAgTUlUOyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01pdF9saWNlbnNlCi8vIEBpbmNsdWRlICAgICAgICBodHRwOi8vYm9hcmRzLjRjaGFuLm9yZy8qCi8vIEBpbmNsdWRlICAgICAgICBodHRwczovL2JvYXJkcy40Y2hhbi5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cDovL2JvYXJkcy40Y2hhbm5lbC5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cHM6Ly9ib2FyZHMuNGNoYW5uZWwub3JnLyoKLy8gQGluY2x1ZGUgICAgICAgIGh0dHA6Ly9zeXMuNGNoYW4ub3JnLyoKLy8gQGluY2x1ZGUgICAgICAgIGh0dHBzOi8vc3lzLjRjaGFuLm9yZy8qCi8vIEBpbmNsdWRlICAgICAgICBodHRwOi8vYS40Y2RuLm9yZy8qCi8vIEBpbmNsdWRlICAgICAgICBodHRwczovL2EuNGNkbi5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cDovL2kuNGNkbi5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cHM6Ly9pLjRjZG4ub3JnLyoKLy8gQGluY2x1ZGUgICAgICAgIGh0dHA6Ly9pcy40Y2hhbi5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cHM6Ly9pcy40Y2hhbi5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cDovL2lzMi40Y2hhbi5vcmcvKgovLyBAaW5jbHVkZSAgICAgICAgaHR0cHM6Ly9pczIuNGNoYW4ub3JnLyoKLy8gQGdyYW50ICAgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgICBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgICAgR01fZGVsZXRlVmFsdWUKLy8gQGdyYW50ICAgICAgICAgIEdNX29wZW5JblRhYgovLyBAZ3JhbnQgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQHJ1bi1hdCAgICAgICAgIGRvY3VtZW50LXN0YXJ0Ci8vIEB1cGRhdGVVUkwgICAgICBodHRwczovL2dpdGh1Yi5jb20vbG9hZGxldHRlci80Y2hhbi14L3Jhdy9tYXN0ZXIvNGNoYW5feC5tZXRhLmpzCi8vIEBkb3dubG9hZFVSTCAgICBodHRwczovL2dpdGh1Yi5jb20vbG9hZGxldHRlci80Y2hhbi14L3Jhdy9tYXN0ZXIvNGNoYW5feC51c2VyLmpzCi8vIEBpY29uICAgICAgICAgICBkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhFQUFRQUtFQ0FBQUFBR2JNTS8vLy8vLy8veUg1QkFFS0FBSUFMQUFBQUFBUUFCQUFBQUl4bEkrcHErRDlEQWdVb0ZrUERsYnM3bEdpSTJiU1ZuS2dsbkpNT0w2b21jenhWWkszZEgvNDFBRzZMaDdpNnFVb0FBQTcKLy8gPT0vVXNlclNjcmlwdD09CgovKiBMSUNFTlNFCiAqCiAqIENvcHlyaWdodCAoYykgMjAwOS0yMDExIEphbWVzIENhbXBvcyA8amFtZXMuci5jYW1wb3NAZ21haWwuY29tPgogKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAxMyBOaWNvbGFzIFN0ZXBpZW4gPHN0ZXBpZW4ubmljb2xhc0BnbWFpbC5jb20+CiAqIGh0dHA6Ly9tYXloZW15ZGcuZ2l0aHViLmlvLzRjaGFuLXgvCiAqIDRjaGFuIFggMi4zOS43CiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uCiAqIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uCiAqIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQKICogcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsCiAqIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZQogKiBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZwogKiBjb25kaXRpb25zOgogKgogKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZQogKiBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsCiAqIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUwogKiBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORAogKiBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVAogKiBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwKICogV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HCiAqIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IKICogT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgogKgogKiBIQUNLSU5HCiAqCiAqIDRjaGFuIFggaXMgd3JpdHRlbiBpbiBDb2ZmZWVTY3JpcHRbMV0sIGFuZCBkZXZlbG9wZWQgb24gR2l0SHViWzJdLgogKgogKiBbMV06IGh0dHA6Ly9jb2ZmZWVzY3JpcHQub3JnLwogKiBbMl06IGh0dHBzOi8vZ2l0aHViLmNvbS9NYXloZW1ZREcvNGNoYW4teAogKgogKiBDT05UUklCVVRPUlMKICoKICogbm9mYWNlIC0gdW5pcXVlIElEIGZpeGVzCiAqIGRlc3V3YSAtIEZpcmVmb3ggZmlsZW5hbWUgdXBsb2FkIGZpeAogKiBzZWF3ZWVkIC0gYm90dG9tIHBhZGRpbmcgZm9yIGltYWdlIGhvdmVyCiAqIGUwMDAgLSBjb29sZG93biBzYW5pdHkgY2hlY2sKICogYWhvZGVzdWthIC0gc2Nyb2xsIGJhY2sgd2hlbiB1bmV4cGFuZGluZyBpbWFnZXMsIGZpbGUgaW5mbyBmb3JtYXR0aW5nCiAqIFNob3UtIC0gcGVudGFkYWN0eWwgZml4ZXMKICogZmVyb25nciAtIG5ldyBmYXZpY29ucwogKiB4YXQtIC0gbmV3IGZhdmljb25zCiAqIFppeGFwaGlyIC0gZml4IHFyIHRleHRhcmVhIC0gY2FwdGNoYS1pbWFnZSBnYXAKICogT25ncG90IC0gc2Z3IGZhdmljb24KICogdGhpc2lzYW5vbiAtIG5zZncgKyA0MDQgZmF2aWNvbnMKICogQW5vbnltb3VzIC0gZW1wdHkgZmF2aWNvbgogKiBTZWliYSAtIGNocm9tZSBxdWljayByZXBseSBmb2N1c2luZwogKiBoZXJwYWRlcnBkZXJwIC0gcmVjYXB0Y2hhIGZpeGVzCiAqIFdha2lNaWtvIC0gcmVjYXB0Y2hhIHRhYiBvcmRlciBodHRwOi8vdXNlcnNjcmlwdHMub3JnL3NjcmlwdHMvc2hvdy84MjY1NwogKiBidG1jc3dlZW5leSAtIGFsbG93IHVzZXJzIHRvIHNwZWNpZnkgdGV4dCBmb3Igc2F1Y2UgbGlua3MKICoKICogQWxsIHRoZSBwZW9wbGUgd2hvJ3ZlIHRha2VuIHRoZSB0aW1lIHRvIHdyaXRlIGJ1ZyByZXBvcnRzLgogKgogKiBUaGFuayB5b3UuCiAqLwoKKGZ1bmN0aW9uKCkgewogIHZhciAkLCAkJCwgQWx3YXlzQ2RuLCBBbHdheXNIVFRQUywgQW5vbnltaXplLCBBcmNoaXZlTGluaywgQXV0b0dpZiwgQnVpbGQsIENhdGFsb2dMaW5rcywgQ29uZiwgQ29uZmlnLCBEZWxldGVMaW5rLCBEb3dubG9hZExpbmssIEV4cGFuZENvbW1lbnQsIEV4cGFuZFRocmVhZCwgRmF2aWNvbiwgRmlsZUluZm8sIEZpbHRlciwgR2V0LCBJbWFnZUV4cGFuZCwgSW1hZ2VIb3ZlciwgS2V5YmluZHMsIE1haW4sIE1lbnUsIE5hdiwgT3B0aW9ucywgUVIsIFF1b3RlQmFja2xpbmssIFF1b3RlQ1QsIFF1b3RlSW5saW5lLCBRdW90ZU9QLCBRdW90ZVlvdSwgUXVvdGVQcmV2aWV3LCBRdW90aWZ5LCBSZWRpcmVjdCwgUmVsYXRpdmVEYXRlcywgUmVtb3ZlU2x1ZywgUmVwbGFjZUpwZywgUmVwbGFjZVBuZywgUmVwbHlIaWRpbmcsIFJlcG9ydExpbmssIFJldmVhbFNwb2lsZXJzLCBTYXVjZSwgU3RyaWtldGhyb3VnaFF1b3RlcywgVGhyZWFkSGlkaW5nLCBUaHJlYWRTdGF0cywgVGltZSwgVGl0bGVQb3N0LCBVSSwgVW5yZWFkLCBVcGRhdGVyLCBXYXRjaGVyLCBkLCBnLCBfYmFzZSwgQ2FwdGNoYUlzU2V0dXA7CiAgQ2FwdGNoYUlzU2V0dXAgPSBmYWxzZTsKICAKICAvKiBZb3VyIHBvc3RzIHRvIGFkZCAoWW91KSBiYWNrbGlua3MgdG8gKi8KICB2YXIgeW91clBvc3RzID0gbmV3IEFycmF5KCk7CiAgCiAgQ29uZmlnID0gewogICAgbWFpbjogewogICAgICBFbmhhbmNpbmc6IHsKICAgICAgICAnRGlzYWJsZSA0Y2hhblwncyBleHRlbnNpb24nOiBbdHJ1ZSwgJ0F2b2lkIGNvbmZsaWN0cyBiZXR3ZWVuIDRjaGFuIFggYW5kIDRjaGFuXCdzIGlubGluZSBleHRlbnNpb24nXSwKICAgICAgICAnQ2F0YWxvZyBMaW5rcyc6IFt0cnVlLCAnVHVybiBOYXZpZ2F0aW9uIGxpbmtzIGludG8gbGlua3MgdG8gZWFjaCBib2FyZFwncyBjYXRhbG9nJ10sCiAgICAgICAgJzQwNCBSZWRpcmVjdCc6IFt0cnVlLCAnUmVkaXJlY3QgZGVhZCB0aHJlYWRzIGFuZCBpbWFnZXMnXSwKICAgICAgICAnS2V5YmluZHMnOiBbdHJ1ZSwgJ0JpbmRzIGFjdGlvbnMgdG8ga2V5cyddLAogICAgICAgICdUaW1lIEZvcm1hdHRpbmcnOiBbdHJ1ZSwgJ0FyYml0cmFyaWx5IGZvcm1hdHRlZCB0aW1lc3RhbXBzLCB1c2luZyB5b3VyIGxvY2FsIHRpbWUnXSwKICAgICAgICAnUmVsYXRpdmUgUG9zdCBEYXRlcyc6IFtmYWxzZSwgJ0Rpc3BsYXkgZGF0ZXMgYXMgIjMgbWludXRlcyBhZ28iIGYuZS4sIHRvb2x0aXAgc2hvd3MgdGhlIHRpbWVzdGFtcCddLAogICAgICAgICdGaWxlIEluZm8gRm9ybWF0dGluZyc6IFt0cnVlLCAnUmVmb3JtYXRzIHRoZSBmaWxlIGluZm9ybWF0aW9uJ10sCiAgICAgICAgJ0NvbW1lbnQgRXhwYW5zaW9uJzogW3RydWUsICdFeHBhbmQgdG9vIGxvbmcgY29tbWVudHMnXSwKICAgICAgICAnQ29tbWVudCBBdXRvLUV4cGFuc2lvbic6IFtmYWxzZSwgJ0F1dG9leHBhbmQgdG9vIGxvbmcgY29tbWVudHMnXSwKICAgICAgICAnVGhyZWFkIEV4cGFuc2lvbic6IFt0cnVlLCAnVmlldyBhbGwgcmVwbGllcyddLAogICAgICAgICdJbmRleCBOYXZpZ2F0aW9uJzogW3RydWUsICdOYXZpZ2F0ZSB0byBwcmV2aW91cyAvIG5leHQgdGhyZWFkJ10sCiAgICAgICAgJ1JlcGx5IE5hdmlnYXRpb24nOiBbZmFsc2UsICdOYXZpZ2F0ZSB0byB0b3AgLyBib3R0b20gb2YgdGhyZWFkJ10sCiAgICAgICAgJ1JlbW92ZSBTbHVnJzogW2ZhbHNlLCAnQ3V0IHVzZWxlc3MgY29tbWVudC9wb3N0IGZyb20gdGhlIFVSTCddLAogICAgICAgICdBbHdheXMgSFRUUFMnOiBbZmFsc2UsICdSZWRpcmVjdCBwYWdlcyB0byBIVFRQUyddLAogICAgICAgICdDaGVjayBmb3IgVXBkYXRlcyc6IFt0cnVlLCAnQ2hlY2sgZm9yIHVwZGF0ZWQgdmVyc2lvbnMgb2YgNGNoYW4gWCddCiAgICAgIH0sCiAgICAgIEZpbHRlcmluZzogewogICAgICAgICdBbm9ueW1pemUnOiBbZmFsc2UsICdNYWtlIGV2ZXJ5Ym9keSBhbm9ueW1vdXMnXSwKICAgICAgICAnRmlsdGVyJzogW3RydWUsICdTZWxmLW1vZGVyYXRpb24gcGxhY2VibyddLAogICAgICAgICdSZWN1cnNpdmUgRmlsdGVyaW5nJzogW3RydWUsICdGaWx0ZXIgcmVwbGllcyBvZiBmaWx0ZXJlZCBwb3N0cywgcmVjdXJzaXZlbHknXSwKICAgICAgICAnUmVwbHkgSGlkaW5nJzogW3RydWUsICdIaWRlIHNpbmdsZSByZXBsaWVzJ10sCiAgICAgICAgJ1RocmVhZCBIaWRpbmcnOiBbdHJ1ZSwgJ0hpZGUgZW50aXJlIHRocmVhZHMnXSwKICAgICAgICAnU2hvdyBTdHVicyc6IFt0cnVlLCAnT2YgaGlkZGVuIHRocmVhZHMgLyByZXBsaWVzJ10KICAgICAgfSwKICAgICAgSW1hZ2luZzogewogICAgICAgICdBbHdheXMgQ0ROJzogW2ZhbHNlLCAnQWx3YXlzIHVzZSBpbWFnZXMgZnJvbSBDbG91ZGZsYXJlIHNlcnZlcnMnXSwKICAgICAgICAnSW1hZ2UgQXV0by1HaWYnOiBbZmFsc2UsICdBbmltYXRlIGdpZiB0aHVtYm5haWxzJ10sCiAgICAgICAgJ1JlcGxhY2UgUE5HJzogW2ZhbHNlLCAnUmVwbGFjZSB0aHVtYm5haWwgd2l0aCBvcmlnaW5hbCBQTkcgaW1hZ2UnXSwKICAgICAgICAnUmVwbGFjZSBKUEcnOiBbZmFsc2UsICdSZXBsYWNlIHRodW1ibmFpbCB3aXRoIG9yaWdpbmFsIEpQRyBpbWFnZSddLAogICAgICAgICdJbWFnZSBFeHBhbnNpb24nOiBbdHJ1ZSwgJ0V4cGFuZCBpbWFnZXMnXSwKICAgICAgICAnRXhwYW5kIEFsbCBXZWJNJzogW3RydWUsICdFeHBhbmQgYWxsIFdlYk1zIHRvbywgY2FuIGNhdXNlIGhpZ2ggcmVzb3VyY2UgdXNhZ2UhJ10sCiAgICAgICAgJ0ltYWdlIEhvdmVyJzogW2ZhbHNlLCAnU2hvdyBmdWxsIGltYWdlIG9uIG1vdXNlb3ZlciddLAogICAgICAgICdTYXVjZSc6IFt0cnVlLCAnQWRkIHNhdWNlIHRvIGltYWdlcyddLAogICAgICAgICdSZXZlYWwgU3BvaWxlcnMnOiBbZmFsc2UsICdSZXBsYWNlIHNwb2lsZXIgdGh1bWJuYWlscyBieSB0aGUgb3JpZ2luYWwgdGh1bWJuYWlsJ10sCiAgICAgICAgJ0V4cGFuZCBGcm9tIEN1cnJlbnQnOiBbZmFsc2UsICdFeHBhbmQgaW1hZ2VzIGZyb20gY3VycmVudCBwb3NpdGlvbiB0byB0aHJlYWQgZW5kJ10KICAgICAgfSwKICAgICAgTWVudTogewogICAgICAgICdNZW51JzogW3RydWUsICdBZGQgYSBkcm9wLWRvd24gbWVudSBpbiBwb3N0cyddLAogICAgICAgICdSZXBvcnQgTGluayc6IFt0cnVlLCAnQWRkIGEgcmVwb3J0IGxpbmsgdG8gdGhlIG1lbnUnXSwKICAgICAgICAnRGVsZXRlIExpbmsnOiBbdHJ1ZSwgJ0FkZCBwb3N0IGFuZCBpbWFnZSBkZWxldGlvbiBsaW5rcyB0byB0aGUgbWVudSddLAogICAgICAgICdEb3dubG9hZCBMaW5rJzogW3RydWUsICdBZGQgYSBkb3dubG9hZCB3aXRoIG9yaWdpbmFsIGZpbGVuYW1lIGxpbmsgdG8gdGhlIG1lbnUnXSwKICAgICAgICAnQXJjaGl2ZSBMaW5rJzogW3RydWUsICdBZGQgYW4gYXJjaGl2ZSBsaW5rIHRvIHRoZSBtZW51J10KICAgICAgfSwKICAgICAgTW9uaXRvcmluZzogewogICAgICAgICdUaHJlYWQgVXBkYXRlcic6IFt0cnVlLCAnVXBkYXRlIHRocmVhZHMuIEhhcyBtb3JlIG9wdGlvbnMgaW4gaXRzIG93biBkaWFsb2cuJ10sCiAgICAgICAgJ1VucmVhZCBDb3VudCc6IFt0cnVlLCAnU2hvdyB1bnJlYWQgcG9zdCBjb3VudCBpbiB0YWIgdGl0bGUnXSwKICAgICAgICAnVW5yZWFkIEZhdmljb24nOiBbdHJ1ZSwgJ1Nob3cgYSBkaWZmZXJlbnQgZmF2aWNvbiB3aGVuIHRoZXJlIGFyZSB1bnJlYWQgcG9zdHMnXSwKICAgICAgICAnUG9zdCBpbiBUaXRsZSc6IFt0cnVlLCAnU2hvdyB0aGUgb3BcJ3MgcG9zdCBpbiB0aGUgdGFiIHRpdGxlJ10sCiAgICAgICAgJ1RocmVhZCBTdGF0cyc6IFt0cnVlLCAnRGlzcGxheSByZXBseSwgaW1hZ2UgYW5kIHBvc3RlciBjb3VudCddLAogICAgICAgICdDdXJyZW50IFBhZ2UnOiBbdHJ1ZSwgJ0Rpc3BsYXkgcG9zaXRpb24gb2YgdGhlIHRocmVhZCBpbiB0aGUgcGFnZSBpbmRleCddLAogICAgICAgICdDdXJyZW50IFBhZ2UgUG9zaXRpb24nOiBbZmFsc2UsICdBbHNvIGRpc3BsYXkgcG9zaXRpb24gb2YgdGhlIHRocmVhZCBpbiBpbmRleCddLAogICAgICAgICdUaHJlYWQgV2F0Y2hlcic6IFt0cnVlLCAnQm9va21hcmsgdGhyZWFkcyddLAogICAgICAgICdBdXRvIFdhdGNoJzogW3RydWUsICdBdXRvbWF0aWNhbGx5IHdhdGNoIHRocmVhZHMgdGhhdCB5b3Ugc3RhcnQnXSwKICAgICAgICAnQXV0byBXYXRjaCBSZXBseSc6IFtmYWxzZSwgJ0F1dG9tYXRpY2FsbHkgd2F0Y2ggdGhyZWFkcyB0aGF0IHlvdSByZXBseSB0byddCiAgICAgIH0sCiAgICAgIFBvc3Rpbmc6IHsKICAgICAgICAnUXVpY2sgUmVwbHknOiBbdHJ1ZSwgJ1JlcGx5IHdpdGhvdXQgbGVhdmluZyB0aGUgcGFnZSddLAogICAgICAgICdDb29sZG93bic6IFt0cnVlLCAnUHJldmVudCAiZmxvb2QgZGV0ZWN0ZWQiIGVycm9ycyddLAogICAgICAgICdBbHRlcm5hdGl2ZSBjYXB0Y2hhJzogW2ZhbHNlLCAnVXNlIHRoZSBjbGFzc2ljIHRleHQgcmVjYXB0Y2hhIGluIHJlcGxpZXMgYW5kIHJlcG9ydCB3aW5kb3cnXSwKICAgICAgICAnQWx0IGluZGV4IGNhcHRjaGEnOiBbZmFsc2UsICdBbHNvIHVzZSB0ZXh0IGNhcHRjaGEgaW4gYm9hcmQgaW5kZXggKG1pZ2h0IG5vdCBhbGxvdyBjcmVhdGluZyBuZXcgdGhyZWFkcyknXSwKICAgICAgICAnQXV0byBTdWJtaXQnOiBbdHJ1ZSwgJ1N1Ym1pdCBhdXRvbWF0aWNhbGx5IHdoZW4gY2FwdGNoYSBoYXMgYmVlbiBzb2x2ZWQnXSwKICAgICAgICAnUGVyc2lzdGVudCBRUic6IFtmYWxzZSwgJ1RoZSBRdWljayByZXBseSB3b25cJ3QgZGlzYXBwZWFyIGFmdGVyIHBvc3RpbmcnXSwKICAgICAgICAnQXV0byBIaWRlIFFSJzogW3RydWUsICdBdXRvbWF0aWNhbGx5IGhpZGUgdGhlIHF1aWNrIHJlcGx5IHdoZW4gcG9zdGluZyddLAogICAgICAgICdPcGVuIFJlcGx5IGluIE5ldyBUYWInOiBbZmFsc2UsICdPcGVuIHJlcGxpZXMgaW4gYSBuZXcgdGFiIHRoYXQgYXJlIG1hZGUgZnJvbSB0aGUgbWFpbiBib2FyZCddLAogICAgICAgICdSZW1lbWJlciBRUiBzaXplJzogW2ZhbHNlLCAnUmVtZW1iZXIgdGhlIHNpemUgb2YgdGhlIFF1aWNrIHJlcGx5IChGaXJlZm94IG9ubHkpJ10sCiAgICAgICAgJ1JlbWVtYmVyIFN1YmplY3QnOiBbZmFsc2UsICdSZW1lbWJlciB0aGUgc3ViamVjdCBmaWVsZCwgaW5zdGVhZCBvZiByZXNldHRpbmcgYWZ0ZXIgcG9zdGluZyddLAogICAgICAgICdSZW1lbWJlciBTcG9pbGVyJzogW2ZhbHNlLCAnUmVtZW1iZXIgdGhlIHNwb2lsZXIgc3RhdGUsIGluc3RlYWQgb2YgcmVzZXR0aW5nIGFmdGVyIHBvc3RpbmcnXSwKICAgICAgICAnSGlkZSBPcmlnaW5hbCBQb3N0IEZvcm0nOiBbdHJ1ZSwgJ1JlcGxhY2UgdGhlIG5vcm1hbCBwb3N0IGZvcm0gd2l0aCBhIHNob3J0Y3V0IHRvIG9wZW4gdGhlIFFSJ10KICAgICAgfSwKICAgICAgUXVvdGluZzogewogICAgICAgICdRdW90ZSBCYWNrbGlua3MnOiBbdHJ1ZSwgJ0FkZCBxdW90ZSBiYWNrbGlua3MnXSwKICAgICAgICAnT1AgQmFja2xpbmtzJzogW2ZhbHNlLCAnQWRkIGJhY2tsaW5rcyB0byB0aGUgT1AnXSwKICAgICAgICAnUXVvdGUgSGlnaGxpZ2h0aW5nJzogW3RydWUsICdIaWdobGlnaHQgdGhlIHByZXZpZXdlZCBwb3N0J10sCiAgICAgICAgJ1F1b3RlIElubGluZSc6IFt0cnVlLCAnU2hvdyBxdW90ZWQgcG9zdCBpbmxpbmUgb24gcXVvdGUgY2xpY2snXSwKICAgICAgICAnUXVvdGUgUHJldmlldyc6IFt0cnVlLCAnU2hvdyBxdW90ZSBjb250ZW50IG9uIGhvdmVyJ10sCiAgICAgICAgJ1Jlc3VycmVjdCBRdW90ZXMnOiBbdHJ1ZSwgJ0xpbmtpZnkgZGVhZCBxdW90ZXMgdG8gYXJjaGl2ZXMnXSwKICAgICAgICAnSW5kaWNhdGUgT1AgcXVvdGUnOiBbdHJ1ZSwgJ0FkZCBcJyhPUClcJyB0byBPUCBxdW90ZXMnXSwKICAgICAgICAvKiBBZGQgKFlvdSkgZmVhdHVyZSAqLwogICAgICAgICdJbmRpY2F0ZSBZb3UgcXVvdGUnOiBbdHJ1ZSwgJ0FkZCBcJyhZb3UpXCcgdG8geW91ciBxdW90ZWQgcG9zdHMnXSwKICAgICAgICAnSW5kaWNhdGUgQ3Jvc3MtdGhyZWFkIFF1b3Rlcyc6IFt0cnVlLCAnQWRkIFwnKENyb3NzLXRocmVhZClcJyB0byBjcm9zcy10aHJlYWRzIHF1b3RlcyddLAogICAgICAgICdGb3J3YXJkIEhpZGluZyc6IFt0cnVlLCAnSGlkZSBvcmlnaW5hbCBwb3N0cyBvZiBpbmxpbmVkIGJhY2tsaW5rcyddCiAgICAgIH0KICAgIH0sCiAgICBmaWx0ZXI6IHsKICAgICAgbmFtZTogWycjIEZpbHRlciBhbnkgbmFtZWZhZ3M6JywgJyMvXig/IUFub255bW91cyQpLyddLmpvaW4oJ1xuJyksCiAgICAgIHBhc3M6IFsnJ10uam9pbignXG4nKSwKICAgICAgdW5pcXVlaWQ6IFsnIyBGaWx0ZXIgYSBzcGVjaWZpYyBJRDonLCAnIy9UeGh2azFUbC8nXS5qb2luKCdcbicpLAogICAgICB0cmlwY29kZTogWycjIEZpbHRlciBhbnkgdHJpcGZhZ3MnLCAnIy9eIS8nXS5qb2luKCdcbicpLAogICAgICBtb2Q6IFsnIyBTZXQgYSBjdXN0b20gY2xhc3MgZm9yIG1vZHM6JywgJyMvTW9kJC87aGlnaGxpZ2h0Om1vZDtvcDp5ZXMnLCAnIyBTZXQgYSBjdXN0b20gY2xhc3MgZm9yIG1vb3Q6JywgJyMvQWRtaW4kLztoaWdobGlnaHQ6bW9vdDtvcDp5ZXMnXS5qb2luKCdcbicpLAogICAgICBlbWFpbDogWycjIEZpbHRlciBhbnkgZS1tYWlscyB0aGF0IGFyZSBub3QgYHNhZ2VgIG9uIC9hLyBhbmQgL2pwLzonLCAnIy9eKD8hc2FnZSQpLztib2FyZHM6YSxqcCddLmpvaW4oJ1xuJyksCiAgICAgIHN1YmplY3Q6IFsnIyBGaWx0ZXIgR2VuZXJhbHMgb24gL3YvOicsICcjL2dlbmVyYWwvaTtib2FyZHM6djtvcDpvbmx5J10uam9pbignXG4nKSwKICAgICAgY29tbWVudDogWycjIEZpbHRlciBTdGFsbG1hbiBjb3B5cGFzdGEgb24gL2cvOicsICcjL3doYXQgeW91XCdyZSByZWZlcitpbmcgdG8gYXMgbGludXgvaTtib2FyZHM6ZyddLmpvaW4oJ1xuJyksCiAgICAgIGNvdW50cnk6IFsnJ10uam9pbignXG4nKSwKICAgICAgZmlsZW5hbWU6IFsnJ10uam9pbignXG4nKSwKICAgICAgZGltZW5zaW9uczogWycjIEhpZ2hsaWdodCBwb3RlbnRpYWwgd2FsbHBhcGVyczonLCAnIy8xOTIweDEwODAvO29wOnllcztoaWdobGlnaHQ7dG9wOm5vO2JvYXJkczp3LHdnJ10uam9pbignXG4nKSwKICAgICAgZmlsZXNpemU6IFsnJ10uam9pbignXG4nKSwKICAgICAgbWQ1OiBbJyddLmpvaW4oJ1xuJykKICAgIH0sCiAgICBzYXVjZXM6IFsnaHR0cDovL2lxZGIub3JnLz91cmw9JDEnLCAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2hieWltYWdlP2ltYWdlX3VybD0kMScsICdodHRwczovL3d3dy55YW5kZXguY29tL2ltYWdlcy9zZWFyY2g/cnB0PWltYWdldmlldyZpbWdfdXJsPSQxJywgJyNodHRwOi8vdGluZXllLmNvbS9zZWFyY2g/dXJsPSQxJywgJyNodHRwOi8vc2F1Y2VuYW8uY29tL3NlYXJjaC5waHA/ZGI9OTk5JnVybD0kMScsICcjaHR0cDovLzNkLmlxZGIub3JnLz91cmw9JDEnLCAnI2h0dHA6Ly9yZWdleC5pbmZvL2V4aWYuY2dpP2ltZ3VybD0kMicsICcjIHVwbG9hZGVyczonLCAnI2h0dHA6Ly9pbWd1ci5jb20vdXBsb2FkP3VybD0kMjt0ZXh0OlVwbG9hZCB0byBpbWd1cicsICcjaHR0cDovL29tcGxvYWRlci5vcmcvdXBsb2FkP3VybDE9JDI7dGV4dDpVcGxvYWQgdG8gb21wbG9hZGVyJywgJyMgIlZpZXcgU2FtZSIgaW4gYXJjaGl2ZXM6JywgJyNodHRwczovL2FyY2hpdmUubW9lL18vc2VhcmNoL2ltYWdlLyQzLzt0ZXh0OlZpZXcgc2FtZSBvbiBtb2UnLCAnI2h0dHBzOi8vYXJjaGl2ZS5tb2UvJDQvc2VhcmNoL2ltYWdlLyQzLzt0ZXh0OlZpZXcgc2FtZSBvbiBtb2UgLyQ0LycsICcjaHR0cHM6Ly9yYnQuYXNpYS8kNC9pbWFnZS8kMzt0ZXh0OlZpZXcgc2FtZSBvbiByYnQgLyQ0LyddLmpvaW4oJ1xuJyksCiAgICB0aW1lOiAnMjAleS0lbS0lZCglYSklSDolTScsCiAgICBiYWNrbGluazogJz4+JWlkJywKICAgIGZpbGVJbmZvOiAnJWwgKCVwJXMsICVyKScsCiAgICBmYXZpY29uOiAnZmVyb25ncicsCiAgICBob3RrZXlzOiB7CiAgICAgIG9wZW5RUjogWydpJywgJ09wZW4gUVIgd2l0aCBwb3N0IG51bWJlciBpbnNlcnRlZCddLAogICAgICBvcGVuRW1wdHlRUjogWydJJywgJ09wZW4gUVIgd2l0aG91dCBwb3N0IG51bWJlciBpbnNlcnRlZCddLAogICAgICBvcGVuT3B0aW9uczogWydjdHJsK28nLCAnT3BlbiBPcHRpb25zJ10sCiAgICAgIGNsb3NlOiBbJ0VzYycsICdDbG9zZSBPcHRpb25zIG9yIFFSJ10sCiAgICAgIHNwb2lsZXI6IFsnY3RybCtzJywgJ1F1aWNrIHNwb2lsZXIgdGFncyddLAogICAgICBzYWdlcnU6IFsnYWx0K24nLCAnU2FnZSBrZXliaW5kJ10sCiAgICAgIGNvZGU6IFsnYWx0K2MnLCAnUXVpY2sgY29kZSB0YWdzJ10sCiAgICAgIHNqaXM6IFsnYWx0K2EnLCAnU0pJUyB0YWdzJ10sCiAgICAgIHN1Ym1pdDogWydhbHQrcycsICdTdWJtaXQgcG9zdCddLAogICAgICB3YXRjaDogWyd3JywgJ1dhdGNoIHRocmVhZCddLAogICAgICB1cGRhdGU6IFsndScsICdVcGRhdGUgbm93J10sCiAgICAgIHVucmVhZENvdW50VG8wOiBbJ3onLCAnTWFyayB0aHJlYWQgYXMgcmVhZCddLAogICAgICBleHBhbmRJbWFnZTogWydtJywgJ0V4cGFuZCBzZWxlY3RlZCBpbWFnZSddLAogICAgICBleHBhbmRBbGxJbWFnZXM6IFsnTScsICdFeHBhbmQgYWxsIGltYWdlcyddLAogICAgICB6ZXJvOiBbJzAnLCAnSnVtcCB0byBwYWdlIDAnXSwKICAgICAgbmV4dFBhZ2U6IFsnTCcsICdKdW1wIHRvIHRoZSBuZXh0IHBhZ2UnXSwKICAgICAgcHJldmlvdXNQYWdlOiBbJ0gnLCAnSnVtcCB0byB0aGUgcHJldmlvdXMgcGFnZSddLAogICAgICBuZXh0VGhyZWFkOiBbJ24nLCAnU2VlIG5leHQgdGhyZWFkJ10sCiAgICAgIHByZXZpb3VzVGhyZWFkOiBbJ3AnLCAnU2VlIHByZXZpb3VzIHRocmVhZCddLAogICAgICBleHBhbmRUaHJlYWQ6IFsnZScsICdFeHBhbmQgdGhyZWFkJ10sCiAgICAgIG9wZW5UaHJlYWRUYWI6IFsnbycsICdPcGVuIHRocmVhZCBpbiBjdXJyZW50IHRhYiddLAogICAgICBvcGVuVGhyZWFkOiBbJ08nLCAnT3BlbiB0aHJlYWQgaW4gbmV3IHRhYiddLAogICAgICBuZXh0UmVwbHk6IFsnSicsICdTZWxlY3QgbmV4dCByZXBseSddLAogICAgICBwcmV2aW91c1JlcGx5OiBbJ0snLCAnU2VsZWN0IHByZXZpb3VzIHJlcGx5J10sCiAgICAgIGhpZGU6IFsneCcsICdIaWRlIHRocmVhZCddCiAgICB9LAogICAgdXBkYXRlcjogewogICAgICBjaGVja2JveDogewogICAgICAgICdCZWVwJzogW2ZhbHNlLCAnQmVlcCBvbiBuZXcgcG9zdCB0byBjb21wbGV0ZWx5IHJlYWQgdGhyZWFkJ10sCiAgICAgICAgJ1Njcm9sbGluZyc6IFtmYWxzZSwgJ1Njcm9sbCB1cGRhdGVkIHBvc3RzIGludG8gdmlldy4gT25seSBlbmFibGVkIGF0IGJvdHRvbSBvZiBwYWdlLiddLAogICAgICAgICdTY3JvbGwgQkcnOiBbZmFsc2UsICdTY3JvbGwgYmFja2dyb3VuZCB0YWJzJ10sCiAgICAgICAgJ1ZlcmJvc2UnOiBbdHJ1ZSwgJ1Nob3cgY291bnRkb3duIHRpbWVyLCBuZXcgcG9zdCBjb3VudCddLAogICAgICAgICdBdXRvIFVwZGF0ZSc6IFt0cnVlLCAnQXV0b21hdGljYWxseSBmZXRjaCBuZXcgcG9zdHMnXQogICAgICB9LAogICAgICAnSW50ZXJ2YWwnOiAzMAogICAgfQogIH07CgogIENvbmYgPSB7fTsKCiAgZCA9IGRvY3VtZW50OwoKICBnID0ge307CgogIFVJID0gewogICAgZGlhbG9nOiBmdW5jdGlvbihpZCwgcG9zaXRpb24sIGh0bWwpIHsKICAgICAgdmFyIGVsOwogICAgICBlbCA9IGQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgIGVsLmNsYXNzTmFtZSA9ICdyZXBseSBkaWFsb2cnOwogICAgICBlbC5pbm5lckhUTUwgPSBodG1sOwogICAgICBlbC5pZCA9IGlkOwogICAgICBlbC5zdHlsZS5jc3NUZXh0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oIiIgKyBNYWluLm5hbWVzcGFjZSArIGlkICsgIi5wb3NpdGlvbiIpIHx8IHBvc2l0aW9uOwogICAgICBlbC5xdWVyeVNlbGVjdG9yKCcubW92ZScpLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIFVJLmRyYWdzdGFydCwgZmFsc2UpOwogICAgICByZXR1cm4gZWw7CiAgICB9LAogICAgZHJhZ3N0YXJ0OiBmdW5jdGlvbihlKSB7CiAgICAgIHZhciBlbCwgcmVjdDsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBVSS5lbCA9IGVsID0gdGhpcy5wYXJlbnROb2RlOwogICAgICBkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIFVJLmRyYWcsIGZhbHNlKTsKICAgICAgZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgVUkuZHJhZ2VuZCwgZmFsc2UpOwogICAgICByZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIFVJLmR4ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0OwogICAgICBVSS5keSA9IGUuY2xpZW50WSAtIHJlY3QudG9wOwogICAgICBVSS53aWR0aCA9IGQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIC0gcmVjdC53aWR0aDsKICAgICAgcmV0dXJuIFVJLmhlaWdodCA9IGQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHJlY3QuaGVpZ2h0OwogICAgfSwKICAgIGRyYWc6IGZ1bmN0aW9uKGUpIHsKICAgICAgdmFyIGxlZnQsIHN0eWxlLCB0b3A7CiAgICAgIGxlZnQgPSBlLmNsaWVudFggLSBVSS5keDsKICAgICAgdG9wID0gZS5jbGllbnRZIC0gVUkuZHk7CiAgICAgIGxlZnQgPSBsZWZ0IDwgMTAgPyAnMHB4JyA6IFVJLndpZHRoIC0gbGVmdCA8IDEwID8gbnVsbCA6IGxlZnQgKyAncHgnOwogICAgICB0b3AgPSB0b3AgPCAxMCA/ICcwcHgnIDogVUkuaGVpZ2h0IC0gdG9wIDwgMTAgPyBudWxsIDogdG9wICsgJ3B4JzsKICAgICAgc3R5bGUgPSBVSS5lbC5zdHlsZTsKICAgICAgc3R5bGUubGVmdCA9IGxlZnQ7CiAgICAgIHN0eWxlLnRvcCA9IHRvcDsKICAgICAgc3R5bGUucmlnaHQgPSBsZWZ0ID09PSBudWxsID8gJzBweCcgOiBudWxsOwogICAgICByZXR1cm4gc3R5bGUuYm90dG9tID0gdG9wID09PSBudWxsID8gJzBweCcgOiBudWxsOwogICAgfSwKICAgIGRyYWdlbmQ6IGZ1bmN0aW9uKCkgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiIiArIE1haW4ubmFtZXNwYWNlICsgVUkuZWwuaWQgKyAiLnBvc2l0aW9uIiwgVUkuZWwuc3R5bGUuY3NzVGV4dCk7CiAgICAgIGQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgVUkuZHJhZywgZmFsc2UpOwogICAgICBkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBVSS5kcmFnZW5kLCBmYWxzZSk7CiAgICAgIHJldHVybiBkZWxldGUgVUkuZWw7CiAgICB9LAogICAgaG92ZXI6IGZ1bmN0aW9uKGUpIHsKICAgICAgdmFyIGNsaWVudEhlaWdodCwgY2xpZW50V2lkdGgsIGNsaWVudFgsIGNsaWVudFksIGhlaWdodCwgc3R5bGUsIHRvcCwgX3JlZjsKICAgICAgY2xpZW50WCA9IGUuY2xpZW50WCwgY2xpZW50WSA9IGUuY2xpZW50WTsKICAgICAgc3R5bGUgPSBVSS5lbC5zdHlsZTsKICAgICAgX3JlZiA9IGQuZG9jdW1lbnRFbGVtZW50LCBjbGllbnRIZWlnaHQgPSBfcmVmLmNsaWVudEhlaWdodCwgY2xpZW50V2lkdGggPSBfcmVmLmNsaWVudFdpZHRoOwogICAgICBoZWlnaHQgPSBVSS5lbC5vZmZzZXRIZWlnaHQ7CiAgICAgIHRvcCA9IGNsaWVudFkgLSAxMjA7CiAgICAgIHN0eWxlLnRvcCA9IGNsaWVudEhlaWdodCA8PSBoZWlnaHQgfHwgdG9wIDw9IDAgPyAnMHB4JyA6IHRvcCArIGhlaWdodCA+PSBjbGllbnRIZWlnaHQgPyBjbGllbnRIZWlnaHQgLSBoZWlnaHQgKyAncHgnIDogdG9wICsgJ3B4JzsKICAgICAgaWYgKGNsaWVudFggPD0gY2xpZW50V2lkdGggLSA0MDApIHsKICAgICAgICBzdHlsZS5sZWZ0ID0gY2xpZW50WCArIDQ1ICsgJ3B4JzsKICAgICAgICByZXR1cm4gc3R5bGUucmlnaHQgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIHN0eWxlLmxlZnQgPSBudWxsOwogICAgICAgIHJldHVybiBzdHlsZS5yaWdodCA9IGNsaWVudFdpZHRoIC0gY2xpZW50WCArIDQ1ICsgJ3B4JzsKICAgICAgfQogICAgfSwKICAgIGhvdmVyZW5kOiBmdW5jdGlvbigpIHsKICAgICAgJC5ybShVSS5lbCk7CiAgICAgIHJldHVybiBkZWxldGUgVUkuZWw7CiAgICB9CiAgfTsKCiAgLyoKICBsb29zZWx5IGZvbGxvd3MgdGhlIGpxdWVyeSBhcGk6CiAgaHR0cDovL2FwaS5qcXVlcnkuY29tLwogIG5vdCBjaGFpbmFibGUKICAqLwoKCiAgJCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByb290KSB7CiAgICBpZiAocm9vdCA9PSBudWxsKSB7CiAgICAgIHJvb3QgPSBkLmJvZHk7CiAgICB9CiAgICByZXR1cm4gcm9vdC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsKICB9OwoKICAkLmV4dGVuZCA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydGllcykgewogICAgdmFyIGtleSwgdmFsOwogICAgZm9yIChrZXkgaW4gcHJvcGVydGllcykgewogICAgICB2YWwgPSBwcm9wZXJ0aWVzW2tleV07CiAgICAgIG9iamVjdFtrZXldID0gdmFsOwogICAgfQogIH07CgogICQuZXh0ZW5kKCQsIHsKICAgIFNFQ09ORDogMTAwMCwKICAgIE1JTlVURTogMTAwMCAqIDYwLAogICAgSE9VUjogMTAwMCAqIDYwICogNjAsCiAgICBEQVk6IDEwMDAgKiA2MCAqIDYwICogMjQsCiAgICBsb2c6IHR5cGVvZiAoX2Jhc2UgPSBjb25zb2xlLmxvZykuYmluZCA9PT0gImZ1bmN0aW9uIiA/IF9iYXNlLmJpbmQoY29uc29sZSkgOiB2b2lkIDAsCiAgICBlbmdpbmU6IC9XZWJLaXR8UHJlc3RvfEdlY2tvLy5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQpWzBdLnRvTG93ZXJDYXNlKCksCiAgICByZWFkeTogZnVuY3Rpb24oZmMpIHsKICAgICAgdmFyIGNiOwogICAgICBpZiAoL2ludGVyYWN0aXZlfGNvbXBsZXRlLy50ZXN0KGQucmVhZHlTdGF0ZSkpIHsKICAgICAgICByZXR1cm4gc2V0VGltZW91dChmYyk7CiAgICAgIH0KICAgICAgY2IgPSBmdW5jdGlvbigpIHsKICAgICAgICAkLm9mZihkLCAnRE9NQ29udGVudExvYWRlZCcsIGNiKTsKICAgICAgICByZXR1cm4gZmMoKTsKICAgICAgfTsKICAgICAgcmV0dXJuICQub24oZCwgJ0RPTUNvbnRlbnRMb2FkZWQnLCBjYik7CiAgICB9LAogICAgc3luYzogZnVuY3Rpb24oa2V5LCBjYikgewogICAgICBrZXkgPSBNYWluLm5hbWVzcGFjZSArIGtleTsKICAgICAgcmV0dXJuICQub24od2luZG93LCAnc3RvcmFnZScsIGZ1bmN0aW9uKGUpIHsKICAgICAgICBpZiAoZS5rZXkgPT09IGtleSkgewogICAgICAgICAgcmV0dXJuIGNiKEpTT04ucGFyc2UoZS5uZXdWYWx1ZSkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaWQ6IGZ1bmN0aW9uKGlkKSB7CiAgICAgIHJldHVybiBkLmdldEVsZW1lbnRCeUlkKGlkKTsKICAgIH0sCiAgICBmb3JtRGF0YTogZnVuY3Rpb24oYXJnKSB7CiAgICAgIHZhciBmZCwga2V5LCB2YWw7CiAgICAgIGlmIChhcmcgaW5zdGFuY2VvZiBIVE1MRm9ybUVsZW1lbnQpIHsKICAgICAgICBmZCA9IG5ldyBGb3JtRGF0YShhcmcpOwogICAgICB9IGVsc2UgewogICAgICAgIGZkID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZm9yIChrZXkgaW4gYXJnKSB7CiAgICAgICAgICB2YWwgPSBhcmdba2V5XTsKICAgICAgICAgIGlmICh2YWwpIHsKICAgICAgICAgICAgZmQuYXBwZW5kKGtleSwgdmFsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZkOwogICAgfSwKICAgIGFqYXg6IGZ1bmN0aW9uKHVybCwgY2FsbGJhY2tzLCBvcHRzKSB7CiAgICAgIHZhciBmb3JtLCBoZWFkZXJzLCBrZXksIHIsIHR5cGUsIHVwQ2FsbGJhY2tzLCB2YWw7CiAgICAgIGlmIChvcHRzID09IG51bGwpIHsKICAgICAgICBvcHRzID0ge307CiAgICAgIH0KICAgICAgdHlwZSA9IG9wdHMudHlwZSwgaGVhZGVycyA9IG9wdHMuaGVhZGVycywgdXBDYWxsYmFja3MgPSBvcHRzLnVwQ2FsbGJhY2tzLCBmb3JtID0gb3B0cy5mb3JtOwogICAgICByID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgIHR5cGUgfHwgKHR5cGUgPSBmb3JtICYmICdwb3N0JyB8fCAnZ2V0Jyk7CiAgICAgIHIub3Blbih0eXBlLCB1cmwsIHRydWUpOwogICAgICBmb3IgKGtleSBpbiBoZWFkZXJzKSB7CiAgICAgICAgdmFsID0gaGVhZGVyc1trZXldOwogICAgICAgIHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbCk7CiAgICAgIH0KICAgICAgJC5leHRlbmQociwgY2FsbGJhY2tzKTsKICAgICAgJC5leHRlbmQoci51cGxvYWQsIHVwQ2FsbGJhY2tzKTsKICAgICAgaWYgKHR5cGUgPT09ICdwb3N0JykgewogICAgICAgIHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTsKICAgICAgfQogICAgICByLnNlbmQoZm9ybSk7CiAgICAgIHJldHVybiByOwogICAgfSwKICAgIGNhY2hlOiBmdW5jdGlvbih1cmwsIGNiKSB7CiAgICAgIHZhciByZXE7CiAgICAgIGlmIChyZXEgPSAkLmNhY2hlLnJlcXVlc3RzW3VybF0pIHsKICAgICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT09IDQpIHsKICAgICAgICAgIHJldHVybiBjYi5jYWxsKHJlcSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiByZXEuY2FsbGJhY2tzLnB1c2goY2IpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXEgPSAkLmFqYXgodXJsLCB7CiAgICAgICAgICBvbmxvYWQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzOwogICAgICAgICAgICBfcmVmID0gdGhpcy5jYWxsYmFja3M7CiAgICAgICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgICAgICAgIGNiID0gX3JlZltfaV07CiAgICAgICAgICAgICAgX3Jlc3VsdHMucHVzaChjYi5jYWxsKHRoaXMpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICAgICAgICB9LAogICAgICAgICAgb25hYm9ydDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBkZWxldGUgJC5jYWNoZS5yZXF1ZXN0c1t1cmxdOwogICAgICAgICAgfSwKICAgICAgICAgIG9uZXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gZGVsZXRlICQuY2FjaGUucmVxdWVzdHNbdXJsXTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICByZXEuY2FsbGJhY2tzID0gW2NiXTsKICAgICAgICByZXR1cm4gJC5jYWNoZS5yZXF1ZXN0c1t1cmxdID0gcmVxOwogICAgICB9CiAgICB9LAogICAgY2I6IHsKICAgICAgY2hlY2tlZDogZnVuY3Rpb24oKSB7CiAgICAgICAgJC5zZXQodGhpcy5uYW1lLCB0aGlzLmNoZWNrZWQpOwogICAgICAgIHJldHVybiBDb25mW3RoaXMubmFtZV0gPSB0aGlzLmNoZWNrZWQ7CiAgICAgIH0sCiAgICAgIHZhbHVlOiBmdW5jdGlvbigpIHsKICAgICAgICAkLnNldCh0aGlzLm5hbWUsIHRoaXMudmFsdWUudHJpbSgpKTsKICAgICAgICByZXR1cm4gQ29uZlt0aGlzLm5hbWVdID0gdGhpcy52YWx1ZTsKICAgICAgfQogICAgfSwKICAgIGFkZFN0eWxlOiBmdW5jdGlvbihjc3MpIHsKICAgICAgdmFyIGYsIHN0eWxlOwogICAgICBzdHlsZSA9ICQuZWwoJ3N0eWxlJywgewogICAgICAgIHRleHRDb250ZW50OiBjc3MKICAgICAgfSk7CiAgICAgIGYgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgcm9vdDsKICAgICAgICBpZiAocm9vdCA9IGQuaGVhZCB8fCBkLmRvY3VtZW50RWxlbWVudCkgewogICAgICAgICAgcmV0dXJuICQuYWRkKHJvb3QsIHN0eWxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZiwgMjApOwogICAgICAgIH0KICAgICAgfTsKICAgICAgZigpOwogICAgICByZXR1cm4gc3R5bGU7CiAgICB9LAogICAgeDogZnVuY3Rpb24ocGF0aCwgcm9vdCkgewogICAgICBpZiAocm9vdCA9PSBudWxsKSB7CiAgICAgICAgcm9vdCA9IGQuYm9keTsKICAgICAgfQogICAgICByZXR1cm4gZC5ldmFsdWF0ZShwYXRoLCByb290LCBudWxsLCA4LCBudWxsKS5zaW5nbGVOb2RlVmFsdWU7CiAgICB9LAogICAgYWRkQ2xhc3M6IGZ1bmN0aW9uKGVsLCBjbGFzc05hbWUpIHsKICAgICAgcmV0dXJuIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTsKICAgIH0sCiAgICBybUNsYXNzOiBmdW5jdGlvbihlbCwgY2xhc3NOYW1lKSB7CiAgICAgIHJldHVybiBlbC5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7CiAgICB9LAogICAgcm06IGZ1bmN0aW9uKGVsKSB7CiAgICAgIHJldHVybiBlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTsKICAgIH0sCiAgICB0bjogZnVuY3Rpb24ocykgewogICAgICByZXR1cm4gZC5jcmVhdGVUZXh0Tm9kZShzKTsKICAgIH0sCiAgICBub2RlczogZnVuY3Rpb24obm9kZXMpIHsKICAgICAgdmFyIGZyYWcsIG5vZGUsIF9pLCBfbGVuOwogICAgICBpZiAoIShub2RlcyBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIHJldHVybiBub2RlczsKICAgICAgfQogICAgICBmcmFnID0gZC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gbm9kZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBub2RlID0gbm9kZXNbX2ldOwogICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQobm9kZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGZyYWc7CiAgICB9LAogICAgYWRkOiBmdW5jdGlvbihwYXJlbnQsIGNoaWxkcmVuKSB7CiAgICAgIHJldHVybiBwYXJlbnQuYXBwZW5kQ2hpbGQoJC5ub2RlcyhjaGlsZHJlbikpOwogICAgfSwKICAgIHByZXBlbmQ6IGZ1bmN0aW9uKHBhcmVudCwgY2hpbGRyZW4pIHsKICAgICAgcmV0dXJuIHBhcmVudC5pbnNlcnRCZWZvcmUoJC5ub2RlcyhjaGlsZHJlbiksIHBhcmVudC5maXJzdENoaWxkKTsKICAgIH0sCiAgICBhZnRlcjogZnVuY3Rpb24ocm9vdCwgZWwpIHsKICAgICAgcmV0dXJuIHJvb3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoJC5ub2RlcyhlbCksIHJvb3QubmV4dFNpYmxpbmcpOwogICAgfSwKICAgIGJlZm9yZTogZnVuY3Rpb24ocm9vdCwgZWwpIHsKICAgICAgcmV0dXJuIHJvb3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoJC5ub2RlcyhlbCksIHJvb3QpOwogICAgfSwKICAgIHJlcGxhY2U6IGZ1bmN0aW9uKHJvb3QsIGVsKSB7CiAgICAgIHJldHVybiByb290LnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKCQubm9kZXMoZWwpLCByb290KTsKICAgIH0sCiAgICBlbDogZnVuY3Rpb24odGFnLCBwcm9wZXJ0aWVzKSB7CiAgICAgIHZhciBlbDsKICAgICAgZWwgPSBkLmNyZWF0ZUVsZW1lbnQodGFnKTsKICAgICAgaWYgKHByb3BlcnRpZXMpIHsKICAgICAgICAkLmV4dGVuZChlbCwgcHJvcGVydGllcyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGVsOwogICAgfSwKICAgIG9uOiBmdW5jdGlvbihlbCwgZXZlbnRzLCBoYW5kbGVyKSB7CiAgICAgIHZhciBldmVudCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIF9yZWYgPSBldmVudHMuc3BsaXQoJyAnKTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZXZlbnQgPSBfcmVmW19pXTsKICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBmYWxzZSk7CiAgICAgIH0KICAgIH0sCiAgICBvZmY6IGZ1bmN0aW9uKGVsLCBldmVudHMsIGhhbmRsZXIpIHsKICAgICAgdmFyIGV2ZW50LCBfaSwgX2xlbiwgX3JlZjsKICAgICAgX3JlZiA9IGV2ZW50cy5zcGxpdCgnICcpOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBldmVudCA9IF9yZWZbX2ldOwogICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIGZhbHNlKTsKICAgICAgfQogICAgfSwKICAgIG9wZW46IGZ1bmN0aW9uKHVybCkgewogICAgICByZXR1cm4gKEdNX29wZW5JblRhYiB8fCB3aW5kb3cub3BlbikobG9jYXRpb24ucHJvdG9jb2wgKyB1cmwsICdfYmxhbmsnKTsKICAgIH0sCiAgICBldmVudDogZnVuY3Rpb24oZXZlbnQsIGRldGFpbCwgcm9vdCkgewogICAgICBpZiAocm9vdCA9PSBudWxsKSB7CiAgICAgICAgcm9vdCA9IGQ7CiAgICAgIH0KICAgICAgaWYgKChkZXRhaWwgIT0gbnVsbCkgJiYgdHlwZW9mIGNsb25lSW50byA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGRldGFpbCA9IGNsb25lSW50byhkZXRhaWwsIGRvY3VtZW50LmRlZmF1bHRWaWV3KTsKICAgICAgfQogICAgICByZXR1cm4gcm9vdC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChldmVudCwgewogICAgICAgIGJ1YmJsZXM6IHRydWUsCiAgICAgICAgZGV0YWlsOiBkZXRhaWwKICAgICAgfSkpOwogICAgfSwKICAgIGdsb2JhbEV2YWw6IGZ1bmN0aW9uKGNvZGUpIHsKICAgICAgdmFyIHNjcmlwdDsKICAgICAgc2NyaXB0ID0gJC5lbCgnc2NyaXB0JywgewogICAgICAgIHRleHRDb250ZW50OiBjb2RlCiAgICAgIH0pOwogICAgICAkLmFkZChkLmhlYWQsIHNjcmlwdCk7CiAgICAgIHJldHVybiAkLnJtKHNjcmlwdCk7CiAgICB9LAogICAgYnl0ZXNUb1N0cmluZzogZnVuY3Rpb24oc2l6ZSkgewogICAgICB2YXIgdW5pdDsKICAgICAgdW5pdCA9IDA7CiAgICAgIHdoaWxlIChzaXplID49IDEwMjQpIHsKICAgICAgICBzaXplIC89IDEwMjQ7CiAgICAgICAgdW5pdCsrOwogICAgICB9CiAgICAgIHNpemUgPSB1bml0ID4gMSA/IE1hdGgucm91bmQoc2l6ZSAqIDEwMCkgLyAxMDAgOiBNYXRoLnJvdW5kKHNpemUpOwogICAgICByZXR1cm4gIiIgKyBzaXplICsgIiAiICsgWydCJywgJ0tCJywgJ01CJywgJ0dCJ11bdW5pdF07CiAgICB9LAogICAgZGVib3VuY2U6IGZ1bmN0aW9uKHdhaXQsIGZuKSB7CiAgICAgIHZhciB0aW1lb3V0OwogICAgICB0aW1lb3V0ID0gbnVsbDsKICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICAgIGlmICh0aW1lb3V0KSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aW1lb3V0ID0gc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdGltZW91dCA9IG51bGw7CiAgICAgICAgfSksIHdhaXQpOwogICAgICB9OwogICAgfQogIH0pOwoKICAkLmNhY2hlLnJlcXVlc3RzID0ge307CgogICQuZXh0ZW5kKCQsIHR5cGVvZiBHTV9kZWxldGVWYWx1ZSAhPT0gInVuZGVmaW5lZCIgJiYgR01fZGVsZXRlVmFsdWUgIT09IG51bGwgPyB7CiAgICAiZGVsZXRlIjogZnVuY3Rpb24obmFtZSkgewogICAgICBuYW1lID0gTWFpbi5uYW1lc3BhY2UgKyBuYW1lOwogICAgICByZXR1cm4gR01fZGVsZXRlVmFsdWUobmFtZSk7CiAgICB9LAogICAgZ2V0OiBmdW5jdGlvbihuYW1lLCBkZWZhdWx0VmFsdWUpIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBuYW1lID0gTWFpbi5uYW1lc3BhY2UgKyBuYW1lOwogICAgICBpZiAodmFsdWUgPSBHTV9nZXRWYWx1ZShuYW1lKSkgewogICAgICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZGVmYXVsdFZhbHVlOwogICAgICB9CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICBuYW1lID0gTWFpbi5uYW1lc3BhY2UgKyBuYW1lOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShuYW1lLCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogICAgICByZXR1cm4gR01fc2V0VmFsdWUobmFtZSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTsKICAgIH0KICB9IDogewogICAgImRlbGV0ZSI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKE1haW4ubmFtZXNwYWNlICsgbmFtZSk7CiAgICB9LAogICAgZ2V0OiBmdW5jdGlvbihuYW1lLCBkZWZhdWx0VmFsdWUpIHsKICAgICAgdmFyIHZhbHVlOwogICAgICBpZiAodmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShNYWluLm5hbWVzcGFjZSArIG5hbWUpKSB7CiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7CiAgICAgIH0KICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShNYWluLm5hbWVzcGFjZSArIG5hbWUsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7CiAgICB9CiAgfSk7CgogICQkID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJvb3QpIHsKICAgIGlmIChyb290ID09IG51bGwpIHsKICAgICAgcm9vdCA9IGQuYm9keTsKICAgIH0KICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChyb290LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTsKICB9OwoKICBGaWx0ZXIgPSB7CiAgICBmaWx0ZXJzOiB7fSwKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYm9hcmRzLCBlcnIsIGZpbHRlciwgaGwsIGtleSwgb3AsIHJlZ2V4cCwgc3R1YiwgdG9wLCBfaSwgX2xlbiwgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMywgX3JlZjQ7CiAgICAgIGZvciAoa2V5IGluIENvbmZpZy5maWx0ZXIpIHsKICAgICAgICB0aGlzLmZpbHRlcnNba2V5XSA9IFtdOwogICAgICAgIF9yZWYgPSBDb25mW2tleV0uc3BsaXQoJ1xuJyk7CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBmaWx0ZXIgPSBfcmVmW19pXTsKICAgICAgICAgIGlmIChmaWx0ZXJbMF0gPT09ICcjJykgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghKHJlZ2V4cCA9IGZpbHRlci5tYXRjaCgvXC8oLispXC8oXHcqKS8pKSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGZpbHRlciA9IGZpbHRlci5yZXBsYWNlKHJlZ2V4cFswXSwgJycpOwogICAgICAgICAgYm9hcmRzID0gKChfcmVmMSA9IGZpbHRlci5tYXRjaCgvYm9hcmRzOihbXjtdKykvKSkgIT0gbnVsbCA/IF9yZWYxWzFdLnRvTG93ZXJDYXNlKCkgOiB2b2lkIDApIHx8ICdnbG9iYWwnOwogICAgICAgICAgaWYgKGJvYXJkcyAhPT0gJ2dsb2JhbCcgJiYgYm9hcmRzLnNwbGl0KCcsJykuaW5kZXhPZihnLkJPQVJEKSA9PT0gLTEpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoa2V5ID09PSAnbWQ1JykgewogICAgICAgICAgICByZWdleHAgPSByZWdleHBbMV07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJlZ2V4cCA9IFJlZ0V4cChyZWdleHBbMV0sIHJlZ2V4cFsyXSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKF9lcnJvcikgewogICAgICAgICAgICAgIGVyciA9IF9lcnJvcjsKICAgICAgICAgICAgICBhbGVydChlcnIubWVzc2FnZSk7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIG9wID0gKChfcmVmMiA9IGZpbHRlci5tYXRjaCgvW150XW9wOih5ZXN8bm98b25seSkvKSkgIT0gbnVsbCA/IF9yZWYyWzFdIDogdm9pZCAwKSB8fCAnbm8nOwogICAgICAgICAgc3R1YiA9IChmdW5jdGlvbigpIHsKICAgICAgICAgICAgdmFyIF9yZWYzOwogICAgICAgICAgICBzd2l0Y2ggKChfcmVmMyA9IGZpbHRlci5tYXRjaCgvc3R1YjooeWVzfG5vKS8pKSAhPSBudWxsID8gX3JlZjNbMV0gOiB2b2lkIDApIHsKICAgICAgICAgICAgICBjYXNlICd5ZXMnOgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgY2FzZSAnbm8nOgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gQ29uZlsnU2hvdyBTdHVicyddOwogICAgICAgICAgICB9CiAgICAgICAgICB9KSgpOwogICAgICAgICAgaWYgKGhsID0gL2hpZ2hsaWdodC8udGVzdChmaWx0ZXIpKSB7CiAgICAgICAgICAgIGhsID0gKChfcmVmMyA9IGZpbHRlci5tYXRjaCgvaGlnaGxpZ2h0OihcdyspLykpICE9IG51bGwgPyBfcmVmM1sxXSA6IHZvaWQgMCkgfHwgJ2ZpbHRlcl9oaWdobGlnaHQnOwogICAgICAgICAgICB0b3AgPSAoKF9yZWY0ID0gZmlsdGVyLm1hdGNoKC90b3A6KHllc3xubykvKSkgIT0gbnVsbCA/IF9yZWY0WzFdIDogdm9pZCAwKSB8fCAneWVzJzsKICAgICAgICAgICAgdG9wID0gdG9wID09PSAneWVzJzsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZmlsdGVyc1trZXldLnB1c2godGhpcy5jcmVhdGVGaWx0ZXIocmVnZXhwLCBvcCwgc3R1YiwgaGwsIHRvcCkpOwogICAgICAgIH0KICAgICAgICBpZiAoIXRoaXMuZmlsdGVyc1trZXldLmxlbmd0aCkgewogICAgICAgICAgZGVsZXRlIHRoaXMuZmlsdGVyc1trZXldOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5maWx0ZXJzKS5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgICB9CiAgICB9LAogICAgY3JlYXRlRmlsdGVyOiBmdW5jdGlvbihyZWdleHAsIG9wLCBzdHViLCBobCwgdG9wKSB7CiAgICAgIHZhciBzZXR0aW5ncywgdGVzdDsKICAgICAgdGVzdCA9IHR5cGVvZiByZWdleHAgPT09ICdzdHJpbmcnID8gZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICByZXR1cm4gcmVnZXhwID09PSB2YWx1ZTsKICAgICAgfSA6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHJlZ2V4cC50ZXN0KHZhbHVlKTsKICAgICAgfTsKICAgICAgc2V0dGluZ3MgPSB7CiAgICAgICAgaGlkZTogIWhsLAogICAgICAgIHN0dWI6IHN0dWIsCiAgICAgICAgImNsYXNzIjogaGwsCiAgICAgICAgdG9wOiB0b3AKICAgICAgfTsKICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpc09QKSB7CiAgICAgICAgaWYgKGlzT1AgJiYgb3AgPT09ICdubycgfHwgIWlzT1AgJiYgb3AgPT09ICdvbmx5JykgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIXRlc3QodmFsdWUpKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZXR0aW5nczsKICAgICAgfTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBmaWx0ZXIsIGZpcnN0VGhyZWFkLCBpc09QLCBrZXksIHJlc3VsdCwgcm9vdCwgdGhpc1RocmVhZCwgdmFsdWUsIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAocG9zdC5pc0lubGluZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaXNPUCA9IHBvc3QuSUQgPT09IHBvc3QudGhyZWFkSUQ7CiAgICAgIHJvb3QgPSBwb3N0LnJvb3Q7CiAgICAgIGZvciAoa2V5IGluIEZpbHRlci5maWx0ZXJzKSB7CiAgICAgICAgdmFsdWUgPSBGaWx0ZXJba2V5XShwb3N0KTsKICAgICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgX3JlZiA9IEZpbHRlci5maWx0ZXJzW2tleV07CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBmaWx0ZXIgPSBfcmVmW19pXTsKICAgICAgICAgIGlmICghKHJlc3VsdCA9IGZpbHRlcih2YWx1ZSwgaXNPUCkpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHJlc3VsdC5oaWRlKSB7CiAgICAgICAgICAgIGlmIChpc09QKSB7CiAgICAgICAgICAgICAgaWYgKCFnLlJFUExZKSB7CiAgICAgICAgICAgICAgICBUaHJlYWRIaWRpbmcuaGlkZShyb290LnBhcmVudE5vZGUsIHJlc3VsdC5zdHViKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFJlcGx5SGlkaW5nLmhpZGUocm9vdCwgcmVzdWx0LnN0dWIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgICQuYWRkQ2xhc3Mocm9vdCwgcmVzdWx0WyJjbGFzcyJdKTsKICAgICAgICAgIGlmIChpc09QICYmIHJlc3VsdC50b3AgJiYgIWcuUkVQTFkpIHsKICAgICAgICAgICAgdGhpc1RocmVhZCA9IHJvb3QucGFyZW50Tm9kZTsKICAgICAgICAgICAgaWYgKGZpcnN0VGhyZWFkID0gJCgnZGl2W2NsYXNzPSJwb3N0Q29udGFpbmVyIG9wQ29udGFpbmVyIl0nKSkgewogICAgICAgICAgICAgIGlmIChmaXJzdFRocmVhZCAhPT0gcm9vdCkgewogICAgICAgICAgICAgICAgJC5iZWZvcmUoZmlyc3RUaHJlYWQucGFyZW50Tm9kZSwgW3RoaXNUaHJlYWQsIHRoaXNUaHJlYWQubmV4dEVsZW1lbnRTaWJsaW5nXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbmFtZTogZnVuY3Rpb24ocG9zdCkgewogICAgICByZXR1cm4gJCgnLm5hbWUnLCBwb3N0LmVsKS50ZXh0Q29udGVudDsKICAgIH0sCiAgICBwYXNzOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBzaW5jZTRwYXNzOwogICAgICBpZiAoc2luY2U0cGFzcyA9ICQoJy5uLXB1JywgcG9zdC5lbCkpIHsKICAgICAgICByZXR1cm4gc2luY2U0cGFzcy50aXRsZTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgdW5pcXVlaWQ6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIHVpZDsKICAgICAgaWYgKHVpZCA9ICQoJy5wb3N0ZXJ1aWQnLCBwb3N0LmVsKSkgewogICAgICAgIHJldHVybiB1aWQuZmlyc3RFbGVtZW50Q2hpbGQudGV4dENvbnRlbnQ7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHRyaXBjb2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciB0cmlwOwogICAgICBpZiAodHJpcCA9ICQoJy5wb3N0ZXJ0cmlwJywgcG9zdC5lbCkpIHsKICAgICAgICByZXR1cm4gdHJpcC50ZXh0Q29udGVudDsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgbW9kOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBtb2Q7CiAgICAgIGlmIChtb2QgPSAkKCcuY2FwY29kZS5oYW5kJywgcG9zdC5lbCkpIHsKICAgICAgICByZXR1cm4gbW9kLnRleHRDb250ZW50LnJlcGxhY2UoJyMjICcsICcnKTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgc3ViamVjdDogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgc3ViamVjdDsKICAgICAgaWYgKHN1YmplY3QgPSAkKCcucG9zdEluZm8gLnN1YmplY3QnLCBwb3N0LmVsKSkgewogICAgICAgIHJldHVybiBzdWJqZWN0LnRleHRDb250ZW50OwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBjb21tZW50OiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBkYXRhLCBpLCBub2RlcywgdGV4dCwgX2ksIF9yZWY7CiAgICAgIHRleHQgPSBbXTsKICAgICAgbm9kZXMgPSBkLmV2YWx1YXRlKCcuLy9icnwuLy90ZXh0KCknLCBwb3N0LmJsb2NrcXVvdGUsIG51bGwsIDcsIG51bGwpOwogICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBub2Rlcy5zbmFwc2hvdExlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICB0ZXh0LnB1c2goKGRhdGEgPSBub2Rlcy5zbmFwc2hvdEl0ZW0oaSkuZGF0YSkgPyBkYXRhIDogJ1xuJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRleHQuam9pbignJyk7CiAgICB9LAogICAgY291bnRyeTogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgZmxhZzsKICAgICAgaWYgKGZsYWcgPSAkKCcuZmxhZycsIHBvc3QuZWwpKSB7CiAgICAgICAgcmV0dXJuIGZsYWcudGl0bGU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGZpbGVuYW1lOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBmaWxlSW5mbywgbmFtZU5vZGUsIGZuYW1lOwogICAgICBpZiAocG9zdC5maWxlSW5mbyAmJiAobmFtZU5vZGUgPSAkKCdhJywgcG9zdC5maWxlSW5mbykpICYmIChmbmFtZSA9IG5hbWVOb2RlLnRpdGxlIHx8IHBvc3QuZmlsZUluZm8udGl0bGUgfHwgbmFtZU5vZGUudGV4dENvbnRlbnQpKSB7CiAgICAgICAgcmV0dXJuIGZuYW1lOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBkaW1lbnNpb25zOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBmaWxlSW5mbywgbWF0Y2g7CiAgICAgIGZpbGVJbmZvID0gcG9zdC5maWxlSW5mbzsKICAgICAgaWYgKGZpbGVJbmZvICYmIChtYXRjaCA9IGZpbGVJbmZvLmxhc3RDaGlsZC50ZXh0Q29udGVudC5tYXRjaCgvXGQreFxkKy8pKSkgewogICAgICAgIHJldHVybiBtYXRjaFswXTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgZmlsZXNpemU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGltZzsKICAgICAgaW1nID0gcG9zdC5pbWc7CiAgICAgIGlmIChpbWcpIHsKICAgICAgICByZXR1cm4gaW1nLmFsdDsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgbWQ1OiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBpbWc7CiAgICAgIGltZyA9IHBvc3QuaW1nOwogICAgICBpZiAoaW1nKSB7CiAgICAgICAgcmV0dXJuIGltZy5kYXRhc2V0Lm1kNTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgbWVudUluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZGl2LCBlbnRyeSwgdHlwZSwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGRpdiA9ICQuZWwoJ2RpdicsIHsKICAgICAgICB0ZXh0Q29udGVudDogJ0ZpbHRlcicKICAgICAgfSk7CiAgICAgIGVudHJ5ID0gewogICAgICAgIGVsOiBkaXYsCiAgICAgICAgb3BlbjogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGNoaWxkcmVuOiBbXQogICAgICB9OwogICAgICBfcmVmID0gW1snTmFtZScsICduYW1lJ10sIFsnUGFzcyB1c2VyJywgJ3Bhc3MnXSwgWydVbmlxdWUgSUQnLCAndW5pcXVlaWQnXSwgWydUcmlwY29kZScsICd0cmlwY29kZSddLCBbJ0FkbWluL01vZCcsICdtb2QnXSwgWydTdWJqZWN0JywgJ3N1YmplY3QnXSwgWydDb21tZW50JywgJ2NvbW1lbnQnXSwgWydDb3VudHJ5JywgJ2NvdW50cnknXSwgWydGaWxlbmFtZScsICdmaWxlbmFtZSddLCBbJ0ltYWdlIGRpbWVuc2lvbnMnLCAnZGltZW5zaW9ucyddLCBbJ0ZpbGVzaXplJywgJ2ZpbGVzaXplJ10sIFsnSW1hZ2UgTUQ1JywgJ21kNSddXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgdHlwZSA9IF9yZWZbX2ldOwogICAgICAgIGVudHJ5LmNoaWxkcmVuLnB1c2goRmlsdGVyLmNyZWF0ZVN1YkVudHJ5KHR5cGVbMF0sIHR5cGVbMV0pKTsKICAgICAgfQogICAgICByZXR1cm4gTWVudS5hZGRFbnRyeShlbnRyeSk7CiAgICB9LAogICAgY3JlYXRlU3ViRW50cnk6IGZ1bmN0aW9uKHRleHQsIHR5cGUpIHsKICAgICAgdmFyIGVsLCBvbmNsaWNrLCBvcGVuOwogICAgICBlbCA9ICQuZWwoJ2EnLCB7CiAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycsCiAgICAgICAgdGV4dENvbnRlbnQ6IHRleHQKICAgICAgfSk7CiAgICAgIG9uY2xpY2sgPSBudWxsOwogICAgICBvcGVuID0gZnVuY3Rpb24ocG9zdCkgewogICAgICAgIHZhciB2YWx1ZTsKICAgICAgICB2YWx1ZSA9IEZpbHRlclt0eXBlXShwb3N0KTsKICAgICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgICQub2ZmKGVsLCAnY2xpY2snLCBvbmNsaWNrKTsKICAgICAgICBvbmNsaWNrID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgcmUsIHNhdmUsIHNlbGVjdCwgdGEsIHRsOwogICAgICAgICAgcmUgPSB0eXBlID09PSAnbWQ1JyA/IHZhbHVlIDogdmFsdWUucmVwbGFjZSgvXC98XFx8XF58XCR8XG58XC58XCh8XCl8XHt8XH18XFt8XF18XD98XCp8XCt8XHwvZywgZnVuY3Rpb24oYykgewogICAgICAgICAgICBpZiAoYyA9PT0gJ1xuJykgewogICAgICAgICAgICAgIHJldHVybiAnXFxuJzsKICAgICAgICAgICAgfSBlbHNlIGlmIChjID09PSAnXFwnKSB7CiAgICAgICAgICAgICAgcmV0dXJuICdcXFxcJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm4gIlxcIiArIGM7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgcmUgPSB0eXBlID09PSAnbWQ1JyA/ICIvIiArIHZhbHVlICsgIi8iIDogIi9eIiArIHJlICsgIiQvIjsKICAgICAgICAgIGlmICgvXGJvcFxiLy50ZXN0KHBvc3RbImNsYXNzIl0pKSB7CiAgICAgICAgICAgIHJlICs9ICc7b3A6eWVzJzsKICAgICAgICAgIH0KICAgICAgICAgIHNhdmUgPSAoc2F2ZSA9ICQuZ2V0KHR5cGUsICcnKSkgPyAiIiArIHNhdmUgKyAiXG4iICsgcmUgOiByZTsKICAgICAgICAgICQuc2V0KHR5cGUsIHNhdmUpOwogICAgICAgICAgT3B0aW9ucy5kaWFsb2coKTsKICAgICAgICAgIHNlbGVjdCA9ICQoJ3NlbGVjdFtuYW1lPWZpbHRlcl0nLCAkLmlkKCdvcHRpb25zJykpOwogICAgICAgICAgc2VsZWN0LnZhbHVlID0gdHlwZTsKICAgICAgICAgIHNlbGVjdC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnY2hhbmdlJykpOwogICAgICAgICAgJC5pZCgnZmlsdGVyX3RhYicpLmNoZWNrZWQgPSB0cnVlOwogICAgICAgICAgdGEgPSBzZWxlY3QubmV4dEVsZW1lbnRTaWJsaW5nOwogICAgICAgICAgdGwgPSB0YS50ZXh0TGVuZ3RoOwogICAgICAgICAgdGEuc2V0U2VsZWN0aW9uUmFuZ2UodGwsIHRsKTsKICAgICAgICAgIHJldHVybiB0YS5mb2N1cygpOwogICAgICAgIH07CiAgICAgICAgJC5vbihlbCwgJ2NsaWNrJywgb25jbGljayk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH07CiAgICAgIHJldHVybiB7CiAgICAgICAgZWw6IGVsLAogICAgICAgIG9wZW46IG9wZW4KICAgICAgfTsKICAgIH0KICB9OwoKICBTdHJpa2V0aHJvdWdoUXVvdGVzID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBNYWluLmNhbGxiYWNrcy5wdXNoKHRoaXMubm9kZSk7CiAgICB9LAogICAgbm9kZTogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgZWwsIHF1b3RlLCBzaG93X3N0dWIsIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAocG9zdC5pc0lubGluZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgX3JlZiA9IHBvc3QucXVvdGVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBxdW90ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICghKChlbCA9ICQuaWQocXVvdGUuaGFzaC5zbGljZSgxKSkpICYmIChxdW90ZS5ob3N0bmFtZSA9PT0gJ2JvYXJkcy40Y2hhbi5vcmcnIHx8IHF1b3RlLmhvc3RuYW1lID09PSAnYm9hcmRzLjRjaGFubmVsLm9yZycpICYmICEvY2F0YWxvZyQvLnRlc3QocXVvdGUucGF0aG5hbWUpICYmIGVsLmhpZGRlbikpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICAkLmFkZENsYXNzKHF1b3RlLCAnZmlsdGVyZWQnKTsKICAgICAgICBpZiAoQ29uZlsnUmVjdXJzaXZlIEZpbHRlcmluZyddICYmIHBvc3QuSUQgIT09IHBvc3QudGhyZWFkSUQpIHsKICAgICAgICAgIHNob3dfc3R1YiA9ICEhJC54KCdwcmVjZWRpbmctc2libGluZzo6ZGl2W2NvbnRhaW5zKEBjbGFzcywic3R1YiIpXScsIGVsKTsKICAgICAgICAgIFJlcGx5SGlkaW5nLmhpZGUocG9zdC5yb290LCBzaG93X3N0dWIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIEV4cGFuZENvbW1lbnQgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGEsIF9pLCBfbGVuLCBfcmVmOwogICAgICBfcmVmID0gJCQoJy5hYmJyJyk7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGEgPSBfcmVmW19pXTsKICAgICAgICAkLm9uKGEuZmlyc3RFbGVtZW50Q2hpbGQsICdjbGljaycsIEV4cGFuZENvbW1lbnQuZXhwYW5kKTsKICAgICAgICBpZiAoQ29uZlsnQ29tbWVudCBBdXRvLUV4cGFuc2lvbiddKSB7CiAgICAgICAgICBhLmZpcnN0RWxlbWVudENoaWxkLmNsaWNrKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZXhwYW5kOiBmdW5jdGlvbihlKSB7CiAgICAgIHZhciBhLCByZXBseUlELCB0aHJlYWRJRCwgXywgX3JlZjsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBfcmVmID0gdGhpcy5ocmVmLm1hdGNoKC8oXGQrKSNwKFxkKykvKSwgXyA9IF9yZWZbMF0sIHRocmVhZElEID0gX3JlZlsxXSwgcmVwbHlJRCA9IF9yZWZbMl07CiAgICAgIHRoaXMudGV4dENvbnRlbnQgPSAiTG9hZGluZyBOby4iICsgcmVwbHlJRCArICIuLi4iOwogICAgICBhID0gdGhpczsKICAgICAgcmV0dXJuICQuY2FjaGUoIi8vYS40Y2RuLm9yZyIgKyB0aGlzLnBhdGhuYW1lICsgIi5qc29uIiwgZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIEV4cGFuZENvbW1lbnQucGFyc2UodGhpcywgYSwgdGhyZWFkSUQsIHJlcGx5SUQpOwogICAgICB9KTsKICAgIH0sCiAgICBwYXJzZTogZnVuY3Rpb24ocmVxLCBhLCB0aHJlYWRJRCwgcmVwbHlJRCkgewogICAgICB2YXIgYnEsIGNsb25lLCBocmVmLCBwb3N0LCBwb3N0cywgcXVvdGUsIHF1b3Rlcywgc3BvaWxlclJhbmdlLCBfaSwgX2osIF9sZW4sIF9sZW4xOwogICAgICBpZiAocmVxLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgYS50ZXh0Q29udGVudCA9ICIiICsgcmVxLnN0YXR1cyArICIgIiArIHJlcS5zdGF0dXNUZXh0OwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBwb3N0cyA9IEpTT04ucGFyc2UocmVxLnJlc3BvbnNlKS5wb3N0czsKICAgICAgaWYgKHNwb2lsZXJSYW5nZSA9IHBvc3RzWzBdLmN1c3RvbV9zcG9pbGVyKSB7CiAgICAgICAgQnVpbGQuc3BvaWxlclJhbmdlW2cuQk9BUkRdID0gc3BvaWxlclJhbmdlOwogICAgICB9CiAgICAgIHJlcGx5SUQgPSArcmVwbHlJRDsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBwb3N0cy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHBvc3QgPSBwb3N0c1tfaV07CiAgICAgICAgaWYgKHBvc3Qubm8gPT09IHJlcGx5SUQpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAocG9zdC5ubyAhPT0gcmVwbHlJRCkgewogICAgICAgIGEudGV4dENvbnRlbnQgPSAnTm8uI3tyZXBseUlEfSBub3QgZm91bmQuJzsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYnEgPSAkLmlkKCJtIiArIHJlcGx5SUQpOwogICAgICBjbG9uZSA9IGJxLmNsb25lTm9kZShmYWxzZSk7CiAgICAgIGNsb25lLmlubmVySFRNTCA9IHBvc3QuY29tOwogICAgICBxdW90ZXMgPSBjbG9uZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdxdW90ZWxpbmsnKTsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gcXVvdGVzLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIHF1b3RlID0gcXVvdGVzW19qXTsKICAgICAgICBocmVmID0gcXVvdGUuZ2V0QXR0cmlidXRlKCdocmVmJyk7CiAgICAgICAgaWYgKGhyZWZbMF0gPT09ICcvJykgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHF1b3RlLmhyZWYgPSAidGhyZWFkLyIgKyBocmVmOwogICAgICB9CiAgICAgIHBvc3QgPSB7CiAgICAgICAgYmxvY2txdW90ZTogY2xvbmUsCiAgICAgICAgdGhyZWFkSUQ6IHRocmVhZElELAogICAgICAgIHF1b3RlczogcXVvdGVzLAogICAgICAgIGJhY2tsaW5rczogW10KICAgICAgfTsKICAgICAgaWYgKENvbmZbJ1Jlc3VycmVjdCBRdW90ZXMnXSkgewogICAgICAgIFF1b3RpZnkubm9kZShwb3N0KTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnUXVvdGUgUHJldmlldyddKSB7CiAgICAgICAgUXVvdGVQcmV2aWV3Lm5vZGUocG9zdCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1F1b3RlIElubGluZSddKSB7CiAgICAgICAgUXVvdGVJbmxpbmUubm9kZShwb3N0KTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnSW5kaWNhdGUgT1AgcXVvdGUnXSkgewogICAgICAgIFF1b3RlT1Aubm9kZShwb3N0KTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnSW5kaWNhdGUgWW91IHF1b3RlJ10pIHsKICAgICAgICBRdW90ZVlvdS5ub2RlKHBvc3QpOwogICAgICB9CiAgICAgIGlmIChDb25mWydJbmRpY2F0ZSBDcm9zcy10aHJlYWQgUXVvdGVzJ10pIHsKICAgICAgICBRdW90ZUNULm5vZGUocG9zdCk7CiAgICAgIH0KICAgICAgJC5yZXBsYWNlKGJxLCBjbG9uZSk7CiAgICAgIHJldHVybiBNYWluLnByZXR0aWZ5KGNsb25lKTsKICAgIH0KICB9OwoKICBFeHBhbmRUaHJlYWQgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGEsIHNwYW4sIF9pLCBfbGVuLCBfcmVmLCBfcmVzdWx0czsKICAgICAgX3JlZiA9ICQkKCcuc3VtbWFyeScpOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBzcGFuID0gX3JlZltfaV07CiAgICAgICAgYSA9ICQuZWwoJ2EnLCB7CiAgICAgICAgICB0ZXh0Q29udGVudDogIisgIiArIHNwYW4udGV4dENvbnRlbnQsCiAgICAgICAgICBjbGFzc05hbWU6ICdzdW1tYXJ5IGRlc2t0b3AnLAogICAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycKICAgICAgICB9KTsKICAgICAgICAkLm9uKGEsICdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIEV4cGFuZFRocmVhZC50b2dnbGUodGhpcy5wYXJlbnROb2RlKTsKICAgICAgICB9KTsKICAgICAgICBfcmVzdWx0cy5wdXNoKCQucmVwbGFjZShzcGFuLCBhKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfSwKICAgIHRvZ2dsZTogZnVuY3Rpb24odGhyZWFkKSB7CiAgICAgIHZhciBhLCBudW0sIHJlcGxpZXMsIHJlcGx5LCB1cmwsIF9pLCBfbGVuOwogICAgICB1cmwgPSAiLy9hLjRjZG4ub3JnLyIgKyBnLkJPQVJEICsgIi90aHJlYWQvIiArIHRocmVhZC5pZC5zbGljZSgxKSArICIuanNvbiI7CiAgICAgIGEgPSAkKCcuc3VtbWFyeScsIHRocmVhZCk7CiAgICAgIHN3aXRjaCAoYS50ZXh0Q29udGVudFswXSkgewogICAgICAgIGNhc2UgJysnOgogICAgICAgICAgYS50ZXh0Q29udGVudCA9IGEudGV4dENvbnRlbnQucmVwbGFjZSgnKycsICfDlyBMb2FkaW5nLi4uJyk7CiAgICAgICAgICAkLmNhY2hlKHVybCwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBFeHBhbmRUaHJlYWQucGFyc2UodGhpcywgdGhyZWFkLCBhKTsKICAgICAgICAgIH0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnw5cnOgogICAgICAgICAgYS50ZXh0Q29udGVudCA9IGEudGV4dENvbnRlbnQucmVwbGFjZSgnw5cgTG9hZGluZy4uLicsICcrJyk7CiAgICAgICAgICAkLmNhY2hlLnJlcXVlc3RzW3VybF0uYWJvcnQoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJy0nOgogICAgICAgICAgYS50ZXh0Q29udGVudCA9IGEudGV4dENvbnRlbnQucmVwbGFjZSgnLScsICcrJyk7CiAgICAgICAgICBudW0gPSAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHN3aXRjaCAoZy5CT0FSRCkgewogICAgICAgICAgICAgIGNhc2UgJ2InOgogICAgICAgICAgICAgIGNhc2UgJ3ZnJzoKICAgICAgICAgICAgICAgIHJldHVybiAzOwogICAgICAgICAgICAgIGNhc2UgJ3QnOgogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiA1OwogICAgICAgICAgICB9CiAgICAgICAgICB9KSgpOwogICAgICAgICAgcmVwbGllcyA9ICQkKCcucmVwbHlDb250YWluZXInLCB0aHJlYWQpOwogICAgICAgICAgcmVwbGllcy5zcGxpY2UocmVwbGllcy5sZW5ndGggLSBudW0sIG51bSk7CiAgICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IHJlcGxpZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgICAgcmVwbHkgPSByZXBsaWVzW19pXTsKICAgICAgICAgICAgJC5ybShyZXBseSk7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBwYXJzZTogZnVuY3Rpb24ocmVxLCB0aHJlYWQsIGEpIHsKICAgICAgdmFyIGJhY2tsaW5rLCBpZCwgbGluaywgbm9kZXMsIHBvc3QsIHBvc3RzLCByZXBsaWVzLCByZXBseSwgc3BvaWxlclJhbmdlLCB0aHJlYWRJRCwgX2ksIF9qLCBfaywgX2xlbiwgX2xlbjEsIF9sZW4yLCBfcmVmLCBfcmVmMTsKICAgICAgaWYgKHJlcS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIGEudGV4dENvbnRlbnQgPSAiIiArIHJlcS5zdGF0dXMgKyAiICIgKyByZXEuc3RhdHVzVGV4dDsKICAgICAgICAkLm9mZihhLCAnY2xpY2snLCBFeHBhbmRUaHJlYWQuY2IudG9nZ2xlKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYS50ZXh0Q29udGVudCA9IGEudGV4dENvbnRlbnQucmVwbGFjZSgnw5cgTG9hZGluZy4uLicsICctJyk7CiAgICAgIHBvc3RzID0gSlNPTi5wYXJzZShyZXEucmVzcG9uc2UpLnBvc3RzOwogICAgICBpZiAoc3BvaWxlclJhbmdlID0gcG9zdHNbMF0uY3VzdG9tX3Nwb2lsZXIpIHsKICAgICAgICBCdWlsZC5zcG9pbGVyUmFuZ2VbZy5CT0FSRF0gPSBzcG9pbGVyUmFuZ2U7CiAgICAgIH0KICAgICAgcmVwbGllcyA9IHBvc3RzLnNsaWNlKDEpOwogICAgICB0aHJlYWRJRCA9IHRocmVhZC5pZC5zbGljZSgxKTsKICAgICAgbm9kZXMgPSBbXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSByZXBsaWVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgcmVwbHkgPSByZXBsaWVzW19pXTsKICAgICAgICBwb3N0ID0gQnVpbGQucG9zdEZyb21PYmplY3QocmVwbHksIGcuQk9BUkQpOwogICAgICAgIGlkID0gcmVwbHkubm87CiAgICAgICAgbGluayA9ICQoJ2FbdGl0bGU9IkxpbmsgdG8gdGhpcyBwb3N0Il0nLCBwb3N0KTsKICAgICAgICBsaW5rLmhyZWYgPSAidGhyZWFkLyIgKyB0aHJlYWRJRCArICIjcCIgKyBpZDsKICAgICAgICBsaW5rLm5leHRTaWJsaW5nLmhyZWYgPSAidGhyZWFkLyIgKyB0aHJlYWRJRCArICIjcSIgKyBpZDsKICAgICAgICBub2Rlcy5wdXNoKHBvc3QpOwogICAgICB9CiAgICAgIF9yZWYgPSAkJCgnLnN1bW1hcnkgfiAucmVwbHlDb250YWluZXInLCBhLnBhcmVudE5vZGUpOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIHBvc3QgPSBfcmVmW19qXTsKICAgICAgICAkLnJtKHBvc3QpOwogICAgICB9CiAgICAgIF9yZWYxID0gJCQoJy5iYWNrbGluaycsIGEucHJldmlvdXNFbGVtZW50U2libGluZyk7CiAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IF9yZWYxLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgIGJhY2tsaW5rID0gX3JlZjFbX2tdOwogICAgICAgIGlmICghJC5pZChiYWNrbGluay5oYXNoLnNsaWNlKDEpKSkgewogICAgICAgICAgJC5ybShiYWNrbGluayk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiAkLmFmdGVyKGEsIG5vZGVzKTsKICAgIH0KICB9OwoKICBUaHJlYWRIaWRpbmcgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGEsIGhpZGRlblRocmVhZHMsIHRocmVhZCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGhpZGRlblRocmVhZHMgPSBUaHJlYWRIaWRpbmcuc3luYygpOwogICAgICBpZiAoZy5DQVRBTE9HKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIF9yZWYgPSAkJCgnLnRocmVhZCcpOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICB0aHJlYWQgPSBfcmVmW19pXTsKICAgICAgICBhID0gJC5lbCgnYScsIHsKICAgICAgICAgIGNsYXNzTmFtZTogJ2hpZGVfdGhyZWFkX2J1dHRvbicsCiAgICAgICAgICBpbm5lckhUTUw6ICc8c3Bhbj5bIC0gXTwvc3Bhbj4nLAogICAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycKICAgICAgICB9KTsKICAgICAgICAkLm9uKGEsICdjbGljaycsIFRocmVhZEhpZGluZy5jYik7CiAgICAgICAgJC5wcmVwZW5kKHRocmVhZCwgYSk7CiAgICAgICAgaWYgKHRocmVhZC5pZC5zbGljZSgxKSBpbiBoaWRkZW5UaHJlYWRzKSB7CiAgICAgICAgICBUaHJlYWRIaWRpbmcuaGlkZSh0aHJlYWQpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHN5bmM6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaGlkZGVuVGhyZWFkcywgaGlkZGVuVGhyZWFkc0NhdGFsb2csIGlkOwogICAgICBoaWRkZW5UaHJlYWRzID0gJC5nZXQoImhpZGRlblRocmVhZHMvIiArIGcuQk9BUkQgKyAiLyIsIHt9KTsKICAgICAgaGlkZGVuVGhyZWFkc0NhdGFsb2cgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCI0Y2hhbi1oaWRlLXQtIiArIGcuQk9BUkQpKSB8fCB7fTsKICAgICAgaWYgKGcuQ0FUQUxPRykgewogICAgICAgIGZvciAoaWQgaW4gaGlkZGVuVGhyZWFkcykgewogICAgICAgICAgaGlkZGVuVGhyZWFkc0NhdGFsb2dbaWRdID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oIjRjaGFuLWhpZGUtdC0iICsgZy5CT0FSRCwgSlNPTi5zdHJpbmdpZnkoaGlkZGVuVGhyZWFkc0NhdGFsb2cpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGlkIGluIGhpZGRlblRocmVhZHNDYXRhbG9nKSB7CiAgICAgICAgICBpZiAoIShpZCBpbiBoaWRkZW5UaHJlYWRzKSkgewogICAgICAgICAgICBoaWRkZW5UaHJlYWRzW2lkXSA9IERhdGUubm93KCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICQuc2V0KCJoaWRkZW5UaHJlYWRzLyIgKyBnLkJPQVJEICsgIi8iLCBoaWRkZW5UaHJlYWRzKTsKICAgICAgfQogICAgICByZXR1cm4gaGlkZGVuVGhyZWFkczsKICAgIH0sCiAgICBjYjogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBUaHJlYWRIaWRpbmcudG9nZ2xlKCQueCgnYW5jZXN0b3I6OmRpdltwYXJlbnQ6OmRpdltAY2xhc3M9ImJvYXJkIl1dJywgdGhpcykpOwogICAgfSwKICAgIHRvZ2dsZTogZnVuY3Rpb24odGhyZWFkKSB7CiAgICAgIHZhciBoaWRkZW5UaHJlYWRzLCBpZDsKICAgICAgaGlkZGVuVGhyZWFkcyA9ICQuZ2V0KCJoaWRkZW5UaHJlYWRzLyIgKyBnLkJPQVJEICsgIi8iLCB7fSk7CiAgICAgIGlkID0gdGhyZWFkLmlkLnNsaWNlKDEpOwogICAgICBpZiAodGhyZWFkLmhpZGRlbiB8fCAvXGJoaWRkZW5fdGhyZWFkXGIvLnRlc3QodGhyZWFkLmZpcnN0Q2hpbGQuY2xhc3NOYW1lKSkgewogICAgICAgIFRocmVhZEhpZGluZy5zaG93KHRocmVhZCk7CiAgICAgICAgZGVsZXRlIGhpZGRlblRocmVhZHNbaWRdOwogICAgICB9IGVsc2UgewogICAgICAgIFRocmVhZEhpZGluZy5oaWRlKHRocmVhZCk7CiAgICAgICAgaGlkZGVuVGhyZWFkc1tpZF0gPSBEYXRlLm5vdygpOwogICAgICB9CiAgICAgIHJldHVybiAkLnNldCgiaGlkZGVuVGhyZWFkcy8iICsgZy5CT0FSRCArICIvIiwgaGlkZGVuVGhyZWFkcyk7CiAgICB9LAogICAgaGlkZTogZnVuY3Rpb24odGhyZWFkLCBzaG93X3N0dWIpIHsKICAgICAgdmFyIGEsIG1lbnVCdXR0b24sIG51bSwgb3BJbmZvLCBzcGFuLCBzdHViLCB0ZXh0OwogICAgICBpZiAoc2hvd19zdHViID09IG51bGwpIHsKICAgICAgICBzaG93X3N0dWIgPSBDb25mWydTaG93IFN0dWJzJ107CiAgICAgIH0KICAgICAgaWYgKCFzaG93X3N0dWIpIHsKICAgICAgICB0aHJlYWQuaGlkZGVuID0gdHJ1ZTsKICAgICAgICB0aHJlYWQubmV4dEVsZW1lbnRTaWJsaW5nLmhpZGRlbiA9IHRydWU7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICgvXGJoaWRkZW5fdGhyZWFkXGIvLnRlc3QodGhyZWFkLmZpcnN0Q2hpbGQuY2xhc3NOYW1lKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBudW0gPSAwOwogICAgICBpZiAoc3BhbiA9ICQoJy5zdW1tYXJ5JywgdGhyZWFkKSkgewogICAgICAgIG51bSA9IE51bWJlcihzcGFuLnRleHRDb250ZW50Lm1hdGNoKC9cZCsvKSk7CiAgICAgIH0KICAgICAgbnVtICs9ICQkKCcub3BDb250YWluZXIgfiAucmVwbHlDb250YWluZXInLCB0aHJlYWQpLmxlbmd0aDsKICAgICAgdGV4dCA9IG51bSA9PT0gMSA/ICcxIHJlcGx5JyA6ICIiICsgbnVtICsgIiByZXBsaWVzIjsKICAgICAgb3BJbmZvID0gJCgnLmRlc2t0b3AgPiAubmFtZUJsb2NrJywgdGhyZWFkKS50ZXh0Q29udGVudDsKICAgICAgc3R1YiA9ICQuZWwoJ2RpdicsIHsKICAgICAgICBjbGFzc05hbWU6ICdoaWRlX3RocmVhZF9idXR0b24gaGlkZGVuX3RocmVhZCcsCiAgICAgICAgaW5uZXJIVE1MOiAnPGEgaHJlZj0iamF2YXNjcmlwdDo7Ij48c3Bhbj5bICsgXTwvc3Bhbj4gPC9hPicKICAgICAgfSk7CiAgICAgIGEgPSBzdHViLmZpcnN0Q2hpbGQ7CiAgICAgICQub24oYSwgJ2NsaWNrJywgVGhyZWFkSGlkaW5nLmNiKTsKICAgICAgJC5hZGQoYSwgJC50bigiIiArIG9wSW5mbyArICIgKCIgKyB0ZXh0ICsgIikiKSk7CiAgICAgIGlmIChDb25mWydNZW51J10pIHsKICAgICAgICBtZW51QnV0dG9uID0gTWVudS5hLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAkLm9uKG1lbnVCdXR0b24sICdjbGljaycsIE1lbnUudG9nZ2xlKTsKICAgICAgICAkLmFkZChzdHViLCBbJC50bignICcpLCBtZW51QnV0dG9uXSk7CiAgICAgIH0KICAgICAgcmV0dXJuICQucHJlcGVuZCh0aHJlYWQsIHN0dWIpOwogICAgfSwKICAgIHNob3c6IGZ1bmN0aW9uKHRocmVhZCkgewogICAgICB2YXIgc3R1YjsKICAgICAgaWYgKHN0dWIgPSAkKCcuaGlkZGVuX3RocmVhZCcsIHRocmVhZCkpIHsKICAgICAgICAkLnJtKHN0dWIpOwogICAgICB9CiAgICAgIHRocmVhZC5oaWRkZW4gPSBmYWxzZTsKICAgICAgcmV0dXJuIHRocmVhZC5uZXh0RWxlbWVudFNpYmxpbmcuaGlkZGVuID0gZmFsc2U7CiAgICB9CiAgfTsKCiAgUmVwbHlIaWRpbmcgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBzaWRlOwogICAgICBpZiAocG9zdC5pc0lubGluZWQgfHwgcG9zdC5JRCA9PT0gcG9zdC50aHJlYWRJRCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzaWRlID0gJCgnLnNpZGVBcnJvd3MnLCBwb3N0LnJvb3QpOwogICAgICAkLmFkZENsYXNzKHNpZGUsICdoaWRlX3JlcGx5X2J1dHRvbicpOwogICAgICBzaWRlLmlubmVySFRNTCA9ICc8YSBocmVmPSJqYXZhc2NyaXB0OjsiPjxzcGFuPlsgLSBdPC9zcGFuPjwvYT4nOwogICAgICAkLm9uKHNpZGUuZmlyc3RDaGlsZCwgJ2NsaWNrJywgUmVwbHlIaWRpbmcudG9nZ2xlKTsKICAgICAgaWYgKHBvc3QuSUQgaW4gZy5oaWRkZW5SZXBsaWVzKSB7CiAgICAgICAgcmV0dXJuIFJlcGx5SGlkaW5nLmhpZGUocG9zdC5yb290KTsKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZTogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBidXR0b24sIGlkLCBxdW90ZSwgcXVvdGVzLCByb290LCBfaSwgX2osIF9sZW4sIF9sZW4xOwogICAgICBidXR0b24gPSB0aGlzLnBhcmVudE5vZGU7CiAgICAgIHJvb3QgPSBidXR0b24ucGFyZW50Tm9kZTsKICAgICAgaWQgPSByb290LmlkLnNsaWNlKDIpOwogICAgICBxdW90ZXMgPSAkJCgiLnF1b3RlbGlua1tocmVmJD0nI3AiICsgaWQgKyAiJ10sIC5iYWNrbGlua1tocmVmJD0nI3AiICsgaWQgKyAiJ10iKTsKICAgICAgaWYgKC9cYnN0dWJcYi8udGVzdChidXR0b24uY2xhc3NOYW1lKSkgewogICAgICAgIFJlcGx5SGlkaW5nLnNob3cocm9vdCk7CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBxdW90ZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIHF1b3RlID0gcXVvdGVzW19pXTsKICAgICAgICAgICQucm1DbGFzcyhxdW90ZSwgJ2ZpbHRlcmVkJyk7CiAgICAgICAgfQogICAgICAgIGRlbGV0ZSBnLmhpZGRlblJlcGxpZXNbaWRdOwogICAgICB9IGVsc2UgewogICAgICAgIFJlcGx5SGlkaW5nLmhpZGUocm9vdCk7CiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gcXVvdGVzLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgcXVvdGUgPSBxdW90ZXNbX2pdOwogICAgICAgICAgJC5hZGRDbGFzcyhxdW90ZSwgJ2ZpbHRlcmVkJyk7CiAgICAgICAgfQogICAgICAgIGcuaGlkZGVuUmVwbGllc1tpZF0gPSBEYXRlLm5vdygpOwogICAgICB9CiAgICAgIHJldHVybiAkLnNldCgiaGlkZGVuUmVwbGllcy8iICsgZy5CT0FSRCArICIvIiwgZy5oaWRkZW5SZXBsaWVzKTsKICAgIH0sCiAgICBoaWRlOiBmdW5jdGlvbihyb290LCBzaG93X3N0dWIpIHsKICAgICAgdmFyIGEsIGVsLCBtZW51QnV0dG9uLCBzaWRlLCBzdHViOwogICAgICBpZiAoc2hvd19zdHViID09IG51bGwpIHsKICAgICAgICBzaG93X3N0dWIgPSBDb25mWydTaG93IFN0dWJzJ107CiAgICAgIH0KICAgICAgc2lkZSA9ICQoJy5zaWRlQXJyb3dzJywgcm9vdCk7CiAgICAgIGlmIChzaWRlLmhpZGRlbikgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzaWRlLmhpZGRlbiA9IHRydWU7CiAgICAgIGVsID0gc2lkZS5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICAgIGVsLmhpZGRlbiA9IHRydWU7CiAgICAgIGlmICghc2hvd19zdHViKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHN0dWIgPSAkLmVsKCdkaXYnLCB7CiAgICAgICAgY2xhc3NOYW1lOiAnaGlkZV9yZXBseV9idXR0b24gc3R1YicsCiAgICAgICAgaW5uZXJIVE1MOiAnPGEgaHJlZj0iamF2YXNjcmlwdDo7Ij48c3Bhbj5bICsgXTwvc3Bhbj4gPC9hPicKICAgICAgfSk7CiAgICAgIGEgPSBzdHViLmZpcnN0Q2hpbGQ7CiAgICAgICQub24oYSwgJ2NsaWNrJywgUmVwbHlIaWRpbmcudG9nZ2xlKTsKICAgICAgJC5hZGQoYSwgJC50bihDb25mWydBbm9ueW1pemUnXSA/ICdBbm9ueW1vdXMnIDogJCgnLmRlc2t0b3AgPiAubmFtZUJsb2NrJywgZWwpLnRleHRDb250ZW50KSk7CiAgICAgIGlmIChDb25mWydNZW51J10pIHsKICAgICAgICBtZW51QnV0dG9uID0gTWVudS5hLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAkLm9uKG1lbnVCdXR0b24sICdjbGljaycsIE1lbnUudG9nZ2xlKTsKICAgICAgICAkLmFkZChzdHViLCBbJC50bignICcpLCBtZW51QnV0dG9uXSk7CiAgICAgIH0KICAgICAgcmV0dXJuICQucHJlcGVuZChyb290LCBzdHViKTsKICAgIH0sCiAgICBzaG93OiBmdW5jdGlvbihyb290KSB7CiAgICAgIHZhciBzdHViOwogICAgICBpZiAoc3R1YiA9ICQoJy5zdHViJywgcm9vdCkpIHsKICAgICAgICAkLnJtKHN0dWIpOwogICAgICB9CiAgICAgICQoJy5zaWRlQXJyb3dzJywgcm9vdCkuaGlkZGVuID0gZmFsc2U7CiAgICAgIHJldHVybiAkKCcucG9zdCcsIHJvb3QpLmhpZGRlbiA9IGZhbHNlOwogICAgfQogIH07CgogIE1lbnUgPSB7CiAgICBlbnRyaWVzOiBbXSwKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmEgPSAkLmVsKCdhJywgewogICAgICAgIGNsYXNzTmFtZTogJ21lbnVfYnV0dG9uJywKICAgICAgICBocmVmOiAnamF2YXNjcmlwdDo7JywKICAgICAgICBpbm5lckhUTUw6ICdbPHNwYW4+PC9zcGFuPl0nCiAgICAgIH0pOwogICAgICB0aGlzLmVsID0gJC5lbCgnZGl2JywgewogICAgICAgIGNsYXNzTmFtZTogJ3JlcGx5IGRpYWxvZycsCiAgICAgICAgaWQ6ICdtZW51JywKICAgICAgICB0YWJJbmRleDogMAogICAgICB9KTsKICAgICAgJC5vbih0aGlzLmVsLCAnY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgcmV0dXJuIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0pOwogICAgICAkLm9uKHRoaXMuZWwsICdrZXlkb3duJywgdGhpcy5rZXliaW5kcyk7CiAgICAgICQub24oZCwgJ0FkZE1lbnVFbnRyeScsIGZ1bmN0aW9uKGUpIHsKICAgICAgICByZXR1cm4gTWVudS5hZGRFbnRyeShlLmRldGFpbCk7CiAgICAgIH0pOwogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGE7CiAgICAgIGlmIChwb3N0LmlzSW5saW5lZCAmJiAhcG9zdC5pc0Nyb3NzcG9zdCkgewogICAgICAgIGEgPSAkKCcubWVudV9idXR0b24nLCBwb3N0LmVsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBhID0gTWVudS5hLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAkLmFkZCgkKCcucG9zdEluZm8nLCBwb3N0LmVsKSwgWyQudG4oJ1x1MDBBMCcpLCBhXSk7CiAgICAgIH0KICAgICAgcmV0dXJuICQub24oYSwgJ2NsaWNrJywgTWVudS50b2dnbGUpOwogICAgfSwKICAgIHRvZ2dsZTogZnVuY3Rpb24oZSkgewogICAgICB2YXIgbGFzdE9wZW5lciwgcG9zdDsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICBpZiAoTWVudS5lbC5wYXJlbnROb2RlKSB7CiAgICAgICAgbGFzdE9wZW5lciA9IE1lbnUubGFzdE9wZW5lcjsKICAgICAgICBNZW51LmNsb3NlKCk7CiAgICAgICAgaWYgKGxhc3RPcGVuZXIgPT09IHRoaXMpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgTWVudS5sYXN0T3BlbmVyID0gdGhpczsKICAgICAgcG9zdCA9IC9cYmhpZGRlbl90aHJlYWRcYi8udGVzdCh0aGlzLnBhcmVudE5vZGUuY2xhc3NOYW1lKSA/ICQueCgnYW5jZXN0b3I6OmRpdltwYXJlbnQ6OmRpdltAY2xhc3M9ImJvYXJkIl1dL2NoaWxkOjpkaXZbY29udGFpbnMoQGNsYXNzLCJvcENvbnRhaW5lciIpXScsIHRoaXMpIDogJC54KCdhbmNlc3Rvcjo6ZGl2W2NvbnRhaW5zKEBjbGFzcywicG9zdENvbnRhaW5lciIpXVsxXScsIHRoaXMpOwogICAgICByZXR1cm4gTWVudS5vcGVuKHRoaXMsIE1haW4ucHJlUGFyc2UocG9zdCkpOwogICAgfSwKICAgIG9wZW46IGZ1bmN0aW9uKGJ1dHRvbiwgcG9zdCkgewogICAgICB2YXIgYkxlZnQsIGJSZWN0LCBiVG9wLCBlbCwgZW50cnksIGZ1bmssIG1SZWN0LCBfaSwgX2xlbiwgX3JlZjsKICAgICAgZWwgPSBNZW51LmVsOwogICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBwb3N0LklEKTsKICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXJvb3RpZCcsIHBvc3Qucm9vdC5pZCk7CiAgICAgIGZ1bmsgPSBmdW5jdGlvbihlbnRyeSwgcGFyZW50KSB7CiAgICAgICAgdmFyIGNoaWxkLCBjaGlsZHJlbiwgc3ViTWVudSwgX2ksIF9sZW47CiAgICAgICAgY2hpbGRyZW4gPSBlbnRyeS5jaGlsZHJlbjsKICAgICAgICBpZiAoIWVudHJ5Lm9wZW4ocG9zdCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgJC5hZGQocGFyZW50LCBlbnRyeS5lbCk7CiAgICAgICAgaWYgKCFjaGlsZHJlbikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoc3ViTWVudSA9ICQoJy5zdWJNZW51JywgZW50cnkuZWwpKSB7CiAgICAgICAgICAkLnJtKHN1Yk1lbnUpOwogICAgICAgIH0KICAgICAgICBzdWJNZW51ID0gJC5lbCgnZGl2JywgewogICAgICAgICAgY2xhc3NOYW1lOiAncmVwbHkgZGlhbG9nIHN1Yk1lbnUnCiAgICAgICAgfSk7CiAgICAgICAgJC5hZGQoZW50cnkuZWwsIHN1Yk1lbnUpOwogICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gY2hpbGRyZW4ubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIGNoaWxkID0gY2hpbGRyZW5bX2ldOwogICAgICAgICAgZnVuayhjaGlsZCwgc3ViTWVudSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBfcmVmID0gTWVudS5lbnRyaWVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBlbnRyeSA9IF9yZWZbX2ldOwogICAgICAgIGZ1bmsoZW50cnksIGVsKTsKICAgICAgfQogICAgICBNZW51LmZvY3VzKCQoJy5lbnRyeScsIE1lbnUuZWwpKTsKICAgICAgJC5vbihkLCAnY2xpY2snLCBNZW51LmNsb3NlKTsKICAgICAgJC5hZGQoZC5ib2R5LCBlbCk7CiAgICAgIG1SZWN0ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIGJSZWN0ID0gYnV0dG9uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICBiVG9wID0gZC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wICsgZC5ib2R5LnNjcm9sbFRvcCArIGJSZWN0LnRvcDsKICAgICAgYkxlZnQgPSBkLmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0ICsgZC5ib2R5LnNjcm9sbExlZnQgKyBiUmVjdC5sZWZ0OwogICAgICBlbC5zdHlsZS50b3AgPSBiUmVjdC50b3AgKyBiUmVjdC5oZWlnaHQgKyBtUmVjdC5oZWlnaHQgPCBkLmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgPyBiVG9wICsgYlJlY3QuaGVpZ2h0ICsgMiArICdweCcgOiBiVG9wIC0gbVJlY3QuaGVpZ2h0IC0gMiArICdweCc7CiAgICAgIGVsLnN0eWxlLmxlZnQgPSBiUmVjdC5sZWZ0ICsgbVJlY3Qud2lkdGggPCBkLmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA/IGJMZWZ0ICsgJ3B4JyA6IGJMZWZ0ICsgYlJlY3Qud2lkdGggLSBtUmVjdC53aWR0aCArICdweCc7CiAgICAgIHJldHVybiBlbC5mb2N1cygpOwogICAgfSwKICAgIGNsb3NlOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGVsLCBmb2N1c2VkLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgZWwgPSBNZW51LmVsOwogICAgICAkLnJtKGVsKTsKICAgICAgX3JlZiA9ICQkKCcuZm9jdXNlZC5lbnRyeScsIGVsKTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZm9jdXNlZCA9IF9yZWZbX2ldOwogICAgICAgICQucm1DbGFzcyhmb2N1c2VkLCAnZm9jdXNlZCcpOwogICAgICB9CiAgICAgIGVsLmlubmVySFRNTCA9IG51bGw7CiAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgZGVsZXRlIE1lbnUubGFzdE9wZW5lcjsKICAgICAgZGVsZXRlIE1lbnUuZm9jdXNlZEVudHJ5OwogICAgICByZXR1cm4gJC5vZmYoZCwgJ2NsaWNrJywgTWVudS5jbG9zZSk7CiAgICB9LAogICAga2V5YmluZHM6IGZ1bmN0aW9uKGUpIHsKICAgICAgdmFyIGVsLCBuZXh0LCBzdWJNZW51OwogICAgICBlbCA9IE1lbnUuZm9jdXNlZEVudHJ5OwogICAgICBzd2l0Y2ggKEtleWJpbmRzLmtleUNvZGUoZSkgfHwgZS5rZXlDb2RlKSB7CiAgICAgICAgY2FzZSAnRXNjJzoKICAgICAgICAgIE1lbnUubGFzdE9wZW5lci5mb2N1cygpOwogICAgICAgICAgTWVudS5jbG9zZSgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMzoKICAgICAgICBjYXNlIDMyOgogICAgICAgICAgZWwuY2xpY2soKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ1VwJzoKICAgICAgICAgIGlmIChuZXh0ID0gZWwucHJldmlvdXNFbGVtZW50U2libGluZykgewogICAgICAgICAgICBNZW51LmZvY3VzKG5leHQpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnRG93bic6CiAgICAgICAgICBpZiAobmV4dCA9IGVsLm5leHRFbGVtZW50U2libGluZykgewogICAgICAgICAgICBNZW51LmZvY3VzKG5leHQpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnUmlnaHQnOgogICAgICAgICAgaWYgKChzdWJNZW51ID0gJCgnLnN1Yk1lbnUnLCBlbCkpICYmIChuZXh0ID0gc3ViTWVudS5maXJzdEVsZW1lbnRDaGlsZCkpIHsKICAgICAgICAgICAgTWVudS5mb2N1cyhuZXh0KTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ0xlZnQnOgogICAgICAgICAgaWYgKG5leHQgPSAkLngoJ3BhcmVudDo6Kltjb250YWlucyhAY2xhc3MsInN1Yk1lbnUiKV0vcGFyZW50OjoqJywgZWwpKSB7CiAgICAgICAgICAgIE1lbnUuZm9jdXMobmV4dCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgcmV0dXJuIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9LAogICAgZm9jdXM6IGZ1bmN0aW9uKGVsKSB7CiAgICAgIHZhciBmb2N1c2VkLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaWYgKGZvY3VzZWQgPSAkLngoJ3BhcmVudDo6Ki9jaGlsZDo6Kltjb250YWlucyhAY2xhc3MsImZvY3VzZWQiKV0nLCBlbCkpIHsKICAgICAgICAkLnJtQ2xhc3MoZm9jdXNlZCwgJ2ZvY3VzZWQnKTsKICAgICAgfQogICAgICBfcmVmID0gJCQoJy5mb2N1c2VkJywgZWwpOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBmb2N1c2VkID0gX3JlZltfaV07CiAgICAgICAgJC5ybUNsYXNzKGZvY3VzZWQsICdmb2N1c2VkJyk7CiAgICAgIH0KICAgICAgTWVudS5mb2N1c2VkRW50cnkgPSBlbDsKICAgICAgcmV0dXJuICQuYWRkQ2xhc3MoZWwsICdmb2N1c2VkJyk7CiAgICB9LAogICAgYWRkRW50cnk6IGZ1bmN0aW9uKGVudHJ5KSB7CiAgICAgIHZhciBmdW5rOwogICAgICBmdW5rID0gZnVuY3Rpb24oZW50cnkpIHsKICAgICAgICB2YXIgY2hpbGQsIGNoaWxkcmVuLCBlbCwgX2ksIF9sZW47CiAgICAgICAgZWwgPSBlbnRyeS5lbCwgY2hpbGRyZW4gPSBlbnRyeS5jaGlsZHJlbjsKICAgICAgICAkLmFkZENsYXNzKGVsLCAnZW50cnknKTsKICAgICAgICAkLm9uKGVsLCAnZm9jdXMgbW91c2VvdmVyJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgIHJldHVybiBNZW51LmZvY3VzKHRoaXMpOwogICAgICAgIH0pOwogICAgICAgIGlmICghY2hpbGRyZW4pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgJC5hZGRDbGFzcyhlbCwgJ2hhc1N1Yk1lbnUnKTsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNoaWxkcmVuLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBjaGlsZCA9IGNoaWxkcmVuW19pXTsKICAgICAgICAgIGZ1bmsoY2hpbGQpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgZnVuayhlbnRyeSk7CiAgICAgIHJldHVybiBNZW51LmVudHJpZXMucHVzaChlbnRyeSk7CiAgICB9CiAgfTsKCiAgS2V5YmluZHMgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIG5vZGUsIF9pLCBfbGVuLCBfcmVmOwogICAgICBfcmVmID0gJCQoJ1thY2Nlc3NrZXldJyk7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIG5vZGUgPSBfcmVmW19pXTsKICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSgnYWNjZXNza2V5Jyk7CiAgICAgIH0KICAgICAgcmV0dXJuICQub24oZCwgJ2tleWRvd24nLCBLZXliaW5kcy5rZXlkb3duKTsKICAgIH0sCiAgICBrZXlkb3duOiBmdW5jdGlvbihlKSB7CiAgICAgIHZhciBmb3JtLCBrZXksIG8sIHRhcmdldCwgdGhyZWFkOwogICAgICBpZiAoIShrZXkgPSBLZXliaW5kcy5rZXlDb2RlKGUpKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0YXJnZXQgPSBlLnRhcmdldDsKICAgICAgaWYgKC9URVhUQVJFQXxJTlBVVC8udGVzdCh0YXJnZXQubm9kZU5hbWUpKSB7CiAgICAgICAgaWYgKCEoKGtleSA9PT0gJ0VzYycpIHx8ICgvXCsvLnRlc3Qoa2V5KSkpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICAgIHRocmVhZCA9IE5hdi5nZXRUaHJlYWQoKTsKICAgICAgc3dpdGNoIChrZXkpIHsKICAgICAgICBjYXNlIENvbmYub3BlblFSOgogICAgICAgICAgS2V5YmluZHMucXIodGhyZWFkLCB0cnVlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgQ29uZi5vcGVuRW1wdHlRUjoKICAgICAgICAgIEtleWJpbmRzLnFyKHRocmVhZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYub3Blbk9wdGlvbnM6CiAgICAgICAgICBpZiAoISQuaWQoJ292ZXJsYXknKSkgewogICAgICAgICAgICBPcHRpb25zLmRpYWxvZygpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLmNsb3NlOgogICAgICAgICAgaWYgKG8gPSAkLmlkKCdvdmVybGF5JykpIHsKICAgICAgICAgICAgT3B0aW9ucy5jbG9zZS5jYWxsKG8pOwogICAgICAgICAgfSBlbHNlIGlmIChRUi5lbCkgewogICAgICAgICAgICBRUi5jbG9zZSgpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLnN1Ym1pdDoKICAgICAgICAgIGlmIChRUi5lbCAmJiAhUVIuc3RhdHVzKCkpIHsKICAgICAgICAgICAgUVIuc3VibWl0KCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYuc3BvaWxlcjoKICAgICAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUgIT09ICdURVhUQVJFQScpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgS2V5YmluZHMudGFncygnc3BvaWxlcicsIHRhcmdldCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYuY29kZToKICAgICAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUgIT09ICdURVhUQVJFQScpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgS2V5YmluZHMudGFncygnY29kZScsIHRhcmdldCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYuc2ppc++7vzoKICAgICAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUgIT09ICdURVhUQVJFQScpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgS2V5YmluZHMudGFncygnc2ppc++7vycsIHRhcmdldCk7CiAgICAgICAgICAkLmFkZENsYXNzKFFSLmVsLCAnc2ppcy1wcmV2aWV3Jyk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYuc2FnZXJ1OgogICAgICAgICAgJCgiW25hbWU9ZW1haWxdIiwgUVIuZWwpLnZhbHVlID0gInNhZ2UiOwogICAgICAgICAgUVIuc2VsZWN0ZWQuZW1haWwgPSAic2FnZSI7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYud2F0Y2g6CiAgICAgICAgICBXYXRjaGVyLnRvZ2dsZSh0aHJlYWQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLnVwZGF0ZToKICAgICAgICAgIFVwZGF0ZXIudXBkYXRlKCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYudW5yZWFkQ291bnRUbzA6CiAgICAgICAgICBVbnJlYWQucmVwbGllcyA9IFtdOwogICAgICAgICAgVW5yZWFkLnVwZGF0ZSh0cnVlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgQ29uZi5leHBhbmRJbWFnZToKICAgICAgICAgIEtleWJpbmRzLmltZyh0aHJlYWQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLmV4cGFuZEFsbEltYWdlczoKICAgICAgICAgIEtleWJpbmRzLmltZyh0aHJlYWQsIHRydWUpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLnplcm86CiAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSAiLyIgKyBnLkJPQVJEICsgIi8wI2RlbGZvcm0iOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLm5leHRQYWdlOgogICAgICAgICAgaWYgKGZvcm0gPSAkKCcubmV4dCBmb3JtJykpIHsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gZm9ybS5hY3Rpb247CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYucHJldmlvdXNQYWdlOgogICAgICAgICAgaWYgKGZvcm0gPSAkKCcucHJldiBmb3JtJykpIHsKICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gZm9ybS5hY3Rpb247CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYubmV4dFRocmVhZDoKICAgICAgICAgIGlmIChnLlJFUExZKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIE5hdi5zY3JvbGwoKzEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLnByZXZpb3VzVGhyZWFkOgogICAgICAgICAgaWYgKGcuUkVQTFkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgTmF2LnNjcm9sbCgtMSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYuZXhwYW5kVGhyZWFkOgogICAgICAgICAgRXhwYW5kVGhyZWFkLnRvZ2dsZSh0aHJlYWQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBDb25mLm9wZW5UaHJlYWQ6CiAgICAgICAgICBLZXliaW5kcy5vcGVuKHRocmVhZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYub3BlblRocmVhZFRhYjoKICAgICAgICAgIEtleWJpbmRzLm9wZW4odGhyZWFkLCB0cnVlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgQ29uZi5uZXh0UmVwbHk6CiAgICAgICAgICBLZXliaW5kcy5obCgrMSwgdGhyZWFkKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgQ29uZi5wcmV2aW91c1JlcGx5OgogICAgICAgICAgS2V5YmluZHMuaGwoLTEsIHRocmVhZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIENvbmYuaGlkZToKICAgICAgICAgIGlmICgvXGJ0aHJlYWRcYi8udGVzdCh0aHJlYWQuY2xhc3NOYW1lKSkgewogICAgICAgICAgICBUaHJlYWRIaWRpbmcudG9nZ2xlKHRocmVhZCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJldHVybiBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB9LAogICAga2V5Q29kZTogZnVuY3Rpb24oZSkgewogICAgICB2YXIgYywga2MsIGtleTsKICAgICAga2V5ID0gKGZ1bmN0aW9uKCkgewogICAgICAgIHN3aXRjaCAoa2MgPSBlLmtleUNvZGUpIHsKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgcmV0dXJuICdFbnRlcic7CiAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICByZXR1cm4gJ0VzYyc7CiAgICAgICAgICBjYXNlIDM3OgogICAgICAgICAgICByZXR1cm4gJ0xlZnQnOwogICAgICAgICAgY2FzZSAzODoKICAgICAgICAgICAgcmV0dXJuICdVcCc7CiAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICByZXR1cm4gJ1JpZ2h0JzsKICAgICAgICAgIGNhc2UgNDA6CiAgICAgICAgICAgIHJldHVybiAnRG93bic7CiAgICAgICAgICBjYXNlIDQ4OgogICAgICAgICAgY2FzZSA0OToKICAgICAgICAgIGNhc2UgNTA6CiAgICAgICAgICBjYXNlIDUxOgogICAgICAgICAgY2FzZSA1MjoKICAgICAgICAgIGNhc2UgNTM6CiAgICAgICAgICBjYXNlIDU0OgogICAgICAgICAgY2FzZSA1NToKICAgICAgICAgIGNhc2UgNTY6CiAgICAgICAgICBjYXNlIDU3OgogICAgICAgICAgY2FzZSA2NToKICAgICAgICAgIGNhc2UgNjY6CiAgICAgICAgICBjYXNlIDY3OgogICAgICAgICAgY2FzZSA2ODoKICAgICAgICAgIGNhc2UgNjk6CiAgICAgICAgICBjYXNlIDcwOgogICAgICAgICAgY2FzZSA3MToKICAgICAgICAgIGNhc2UgNzI6CiAgICAgICAgICBjYXNlIDczOgogICAgICAgICAgY2FzZSA3NDoKICAgICAgICAgIGNhc2UgNzU6CiAgICAgICAgICBjYXNlIDc2OgogICAgICAgICAgY2FzZSA3NzoKICAgICAgICAgIGNhc2UgNzg6CiAgICAgICAgICBjYXNlIDc5OgogICAgICAgICAgY2FzZSA4MDoKICAgICAgICAgIGNhc2UgODE6CiAgICAgICAgICBjYXNlIDgyOgogICAgICAgICAgY2FzZSA4MzoKICAgICAgICAgIGNhc2UgODQ6CiAgICAgICAgICBjYXNlIDg1OgogICAgICAgICAgY2FzZSA4NjoKICAgICAgICAgIGNhc2UgODc6CiAgICAgICAgICBjYXNlIDg4OgogICAgICAgICAgY2FzZSA4OToKICAgICAgICAgIGNhc2UgOTA6CiAgICAgICAgICAgIGMgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGtjKTsKICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHsKICAgICAgICAgICAgICByZXR1cm4gYzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm4gYy50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgICBpZiAoa2V5KSB7CiAgICAgICAgaWYgKGUuYWx0S2V5KSB7CiAgICAgICAgICBrZXkgPSAnYWx0KycgKyBrZXk7CiAgICAgICAgfQogICAgICAgIGlmIChlLmN0cmxLZXkpIHsKICAgICAgICAgIGtleSA9ICdjdHJsKycgKyBrZXk7CiAgICAgICAgfQogICAgICAgIGlmIChlLm1ldGFLZXkpIHsKICAgICAgICAgIGtleSA9ICdtZXRhKycgKyBrZXk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBrZXk7CiAgICB9LAogICAgdGFnczogZnVuY3Rpb24odGFnLCB0YSkgewogICAgICB2YXIgcmFuZ2UsIHNlbEVuZCwgc2VsU3RhcnQsIHZhbHVlOwogICAgICB2YWx1ZSA9IHRhLnZhbHVlOwogICAgICBzZWxTdGFydCA9IHRhLnNlbGVjdGlvblN0YXJ0OwogICAgICBzZWxFbmQgPSB0YS5zZWxlY3Rpb25FbmQ7CiAgICAgIHRhLnZhbHVlID0gdmFsdWUuc2xpY2UoMCwgc2VsU3RhcnQpICsgKCJbIiArIHRhZyArICJdIikgKyB2YWx1ZS5zbGljZShzZWxTdGFydCwgc2VsRW5kKSArICgiWy8iICsgdGFnICsgIl0iKSArIHZhbHVlLnNsaWNlKHNlbEVuZCk7CiAgICAgIHJhbmdlID0gKCJbIiArIHRhZyArICJdIikubGVuZ3RoICsgc2VsRW5kOwogICAgICB0YS5zZXRTZWxlY3Rpb25SYW5nZShyYW5nZSwgcmFuZ2UpOwogICAgICByZXR1cm4gdGEuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ2lucHV0JykpOwogICAgfSwKICAgIGltZzogZnVuY3Rpb24odGhyZWFkLCBhbGwpIHsKICAgICAgdmFyIHRodW1iOwogICAgICBpZiAoYWxsKSB7CiAgICAgICAgcmV0dXJuICQuaWQoJ2ltYWdlRXhwYW5kJykuY2xpY2soKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHVtYiA9ICQoJ2ltZ1tkYXRhLW1kNV0nLCAkKCcucG9zdC5oaWdobGlnaHQnLCB0aHJlYWQpIHx8IHRocmVhZCk7CiAgICAgICAgcmV0dXJuIEltYWdlRXhwYW5kLnRvZ2dsZSh0aHVtYi5wYXJlbnROb2RlKTsKICAgICAgfQogICAgfSwKICAgIHFyOiBmdW5jdGlvbih0aHJlYWQsIHF1b3RlKSB7CiAgICAgIGlmIChxdW90ZSkgewogICAgICAgIFFSLnF1b3RlLmNhbGwoJCgnYVt0aXRsZT0iUmVwbHkgdG8gdGhpcyBwb3N0Il0nLCAkKCcucG9zdC5oaWdobGlnaHQnLCB0aHJlYWQpIHx8IHRocmVhZCkpOwogICAgICB9IGVsc2UgewogICAgICAgIFFSLm9wZW4oKTsKICAgICAgfQogICAgICByZXR1cm4gJCgndGV4dGFyZWEnLCBRUi5lbCkuZm9jdXMoKTsKICAgIH0sCiAgICBvcGVuOiBmdW5jdGlvbih0aHJlYWQsIHRhYikgewogICAgICB2YXIgaWQsIHVybDsKICAgICAgaWYgKGcuUkVQTFkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWQgPSB0aHJlYWQuaWQuc2xpY2UoMSk7CiAgICAgIHVybCA9ICIvL2JvYXJkcy40Y2hhbi5vcmcvIiArIGcuQk9BUkQgKyAiL3RocmVhZC8iICsgaWQ7CiAgICAgIGlmICh0YWIpIHsKICAgICAgICByZXR1cm4gJC5vcGVuKHVybCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGxvY2F0aW9uLmhyZWYgPSB1cmw7CiAgICAgIH0KICAgIH0sCiAgICBobDogZnVuY3Rpb24oZGVsdGEsIHRocmVhZCkgewogICAgICB2YXIgbmV4dCwgcG9zdCwgcmVjdCwgcmVwbGllcywgcmVwbHksIF9pLCBfbGVuOwogICAgICBpZiAocG9zdCA9ICQoJy5yZXBseS5oaWdobGlnaHQnLCB0aHJlYWQpKSB7CiAgICAgICAgJC5ybUNsYXNzKHBvc3QsICdoaWdobGlnaHQnKTsKICAgICAgICBwb3N0LnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTsKICAgICAgICByZWN0ID0gcG9zdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBpZiAocmVjdC5ib3R0b20gPj0gMCAmJiByZWN0LnRvcCA8PSBkLmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpIHsKICAgICAgICAgIG5leHQgPSAkLngoJ2NoaWxkOjpkaXZbY29udGFpbnMoQGNsYXNzLCJwb3N0IHJlcGx5IildJywgZGVsdGEgPT09ICsxID8gcG9zdC5wYXJlbnROb2RlLm5leHRFbGVtZW50U2libGluZyA6IHBvc3QucGFyZW50Tm9kZS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nKTsKICAgICAgICAgIGlmICghbmV4dCkgewogICAgICAgICAgICB0aGlzLmZvY3VzKHBvc3QpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIShnLlJFUExZIHx8ICQueCgnYW5jZXN0b3I6OmRpdltwYXJlbnQ6OmRpdltAY2xhc3M9ImJvYXJkIl1dJywgbmV4dCkgPT09IHRocmVhZCkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgcmVjdCA9IG5leHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICBpZiAocmVjdC50b3AgPCAwIHx8IHJlY3QuYm90dG9tID4gZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7CiAgICAgICAgICAgIG5leHQuc2Nyb2xsSW50b1ZpZXcoZGVsdGEgPT09IC0xKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuZm9jdXMobmV4dCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICAgIHJlcGxpZXMgPSAkJCgnLnJlcGx5JywgdGhyZWFkKTsKICAgICAgaWYgKGRlbHRhID09PSAtMSkgewogICAgICAgIHJlcGxpZXMucmV2ZXJzZSgpOwogICAgICB9CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gcmVwbGllcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHJlcGx5ID0gcmVwbGllc1tfaV07CiAgICAgICAgcmVjdCA9IHJlcGx5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgIGlmIChkZWx0YSA9PT0gKzEgJiYgcmVjdC50b3AgPj0gMCB8fCBkZWx0YSA9PT0gLTEgJiYgcmVjdC5ib3R0b20gPD0gZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7CiAgICAgICAgICB0aGlzLmZvY3VzKHJlcGx5KTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBmb2N1czogZnVuY3Rpb24ocG9zdCkgewogICAgICAkLmFkZENsYXNzKHBvc3QsICdoaWdobGlnaHQnKTsKICAgICAgcG9zdC50YWJJbmRleCA9IDA7CiAgICAgIHJldHVybiBwb3N0LmZvY3VzKCk7CiAgICB9CiAgfTsKCiAgTmF2ID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBuZXh0LCBwcmV2LCBzcGFuOwogICAgICBzcGFuID0gJC5lbCgnc3BhbicsIHsKICAgICAgICBpZDogJ25hdmxpbmtzJwogICAgICB9KTsKICAgICAgcHJldiA9ICQuZWwoJ2EnLCB7CiAgICAgICAgdGV4dENvbnRlbnQ6ICfilrInLAogICAgICAgIGhyZWY6ICdqYXZhc2NyaXB0OjsnCiAgICAgIH0pOwogICAgICBuZXh0ID0gJC5lbCgnYScsIHsKICAgICAgICB0ZXh0Q29udGVudDogJ+KWvCcsCiAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycKICAgICAgfSk7CiAgICAgIG9wZW5RUiA9ICQuZWwoJ2EnLCB7CiAgICAgICAgdGV4dENvbnRlbnQ6ICdRUicsCiAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycKICAgICAgfSk7CiAgICAgICQub24ocHJldiwgJ2NsaWNrJywgdGhpcy5wcmV2KTsKICAgICAgJC5vbihuZXh0LCAnY2xpY2snLCB0aGlzLm5leHQpOwogICAgICAkLm9uKG9wZW5RUiwgJ2NsaWNrJywgdGhpcy5vcGVuUVIpOwogICAgICAkLmFkZChzcGFuLCBbb3BlblFSLCAkLnRuKCcgJyksIHByZXYsICQudG4oJyAnKSwgbmV4dF0pOwogICAgICByZXR1cm4gJC5hZGQoZC5ib2R5LCBzcGFuKTsKICAgIH0sCiAgICBwcmV2OiBmdW5jdGlvbigpIHsKICAgICAgaWYgKGcuUkVQTFkpIHsKICAgICAgICByZXR1cm4gd2luZG93LnNjcm9sbFRvKDAsIDApOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBOYXYuc2Nyb2xsKC0xKTsKICAgICAgfQogICAgfSwKICAgIG5leHQ6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoZy5SRVBMWSkgewogICAgICAgIHJldHVybiB3aW5kb3cuc2Nyb2xsVG8oMCwgZC5ib2R5LnNjcm9sbEhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIE5hdi5zY3JvbGwoKzEpOwogICAgICB9CiAgICB9LAogICAgb3BlblFSOiBmdW5jdGlvbigpIHsKICAgICAgUVIub3BlbigpOwogICAgICBpZiAoIWcuUkVQTFkpIHsKICAgICAgICBRUi50aHJlYWRTZWxlY3Rvci52YWx1ZSA9IGcuQk9BUkQgPT09ICdmJyA/ICc5OTk5JyA6ICduZXcnOwogICAgICB9CiAgICAgIHJldHVybiAkKCd0ZXh0YXJlYScsIFFSLmVsKS5mb2N1cygpOwogICAgfSwKICAgIGdldFRocmVhZDogZnVuY3Rpb24oZnVsbCkgewogICAgICB2YXIgYm90dG9tLCBpLCByZWN0LCB0aHJlYWQsIF9pLCBfbGVuLCBfcmVmOwogICAgICBOYXYudGhyZWFkcyA9ICQkKCcudGhyZWFkOm5vdChbaGlkZGVuXSknKTsKICAgICAgX3JlZiA9IE5hdi50aHJlYWRzOwogICAgICBmb3IgKGkgPSBfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBpID0gKytfaSkgewogICAgICAgIHRocmVhZCA9IF9yZWZbaV07CiAgICAgICAgcmVjdCA9IHRocmVhZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBib3R0b20gPSByZWN0LmJvdHRvbTsKICAgICAgICBpZiAoYm90dG9tID4gMCkgewogICAgICAgICAgaWYgKGZ1bGwpIHsKICAgICAgICAgICAgcmV0dXJuIFt0aHJlYWQsIGksIHJlY3RdOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRocmVhZDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuICQoJy5ib2FyZCcpOwogICAgfSwKICAgIHNjcm9sbDogZnVuY3Rpb24oZGVsdGEpIHsKICAgICAgdmFyIGksIHJlY3QsIHRocmVhZCwgdG9wLCBfcmVmLCBfcmVmMTsKICAgICAgX3JlZiA9IE5hdi5nZXRUaHJlYWQodHJ1ZSksIHRocmVhZCA9IF9yZWZbMF0sIGkgPSBfcmVmWzFdLCByZWN0ID0gX3JlZlsyXTsKICAgICAgdG9wID0gcmVjdC50b3A7CiAgICAgIGlmICghKChkZWx0YSA9PT0gLTEgJiYgTWF0aC5jZWlsKHRvcCkgPCAwKSB8fCAoZGVsdGEgPT09ICsxICYmIHRvcCA+IDEpKSkgewogICAgICAgIGkgKz0gZGVsdGE7CiAgICAgIH0KICAgICAgdG9wID0gKF9yZWYxID0gTmF2LnRocmVhZHNbaV0pICE9IG51bGwgPyBfcmVmMS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgOiB2b2lkIDA7CiAgICAgIHJldHVybiB3aW5kb3cuc2Nyb2xsQnkoMCwgdG9wKTsKICAgIH0KICB9OwoKICBRUiA9IHsKICAgIG1pbWVUeXBlczogWydpbWFnZS9qcGVnJywgJ2ltYWdlL3BuZycsICdpbWFnZS9naWYnLCAnYXBwbGljYXRpb24vcGRmJywgJ2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJywgJ3ZpZGVvL3dlYm0nLCAnJ10sCiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgaWYgKCEkLmlkKCdwb3N0Rm9ybScpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgICAgcmV0dXJuIHNldFRpbWVvdXQodGhpcy5hc3luY0luaXQpOwogICAgfSwKICAgIGFzeW5jSW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBsaW5rOwogICAgICBpZiAoQ29uZlsnSGlkZSBPcmlnaW5hbCBQb3N0IEZvcm0nXSkgewogICAgICAgIGxpbmsgPSAkLmVsKCdoMScsIHsKICAgICAgICAgIGlubmVySFRNTDogIjxhIGhyZWY9amF2YXNjcmlwdDo7PiIgKyAoZy5SRVBMWSA/ICdSZXBseSB0byBUaHJlYWQnIDogJ1N0YXJ0IGEgVGhyZWFkJykgKyAiPC9hPiIKICAgICAgICB9KTsKICAgICAgICAkLm9uKGxpbmsuZmlyc3RDaGlsZCwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICBRUi5vcGVuKCk7CiAgICAgICAgICBpZiAoIWcuUkVQTFkpIHsKICAgICAgICAgICAgUVIudGhyZWFkU2VsZWN0b3IudmFsdWUgPSBnLkJPQVJEID09PSAnZicgPyAnOTk5OScgOiAnbmV3JzsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiAkKCd0ZXh0YXJlYScsIFFSLmVsKS5mb2N1cygpOwogICAgICAgIH0pOwogICAgICAgICQuYmVmb3JlKCQuaWQoJ3Bvc3RGb3JtJyksIGxpbmspOwogICAgICAgICQuaWQoJ3Bvc3RGb3JtJykuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgICAgICAkLmlkKCd0b2dnbGVQb3N0Rm9ybUxpbmsnKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICB9CiAgICAgIGlmIChDb25mWydQZXJzaXN0ZW50IFFSJ10pIHsKICAgICAgICBRUi5kaWFsb2coKTsKICAgICAgICBpZiAoQ29uZlsnQXV0byBIaWRlIFFSJ10pIHsKICAgICAgICAgIFFSLmhpZGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgJC5vbihkLCAnZHJhZ292ZXInLCBRUi5kcmFnT3Zlcik7CiAgICAgICQub24oZCwgJ2Ryb3AnLCBRUi5kcm9wRmlsZSk7CiAgICAgIHJldHVybiAkLm9uKGQsICdkcmFnc3RhcnQgZHJhZ2VuZCcsIFFSLmRyYWcpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgcmV0dXJuICQub24oJCgnYVt0aXRsZT0iUmVwbHkgdG8gdGhpcyBwb3N0Il0nLCAkKCcucG9zdEluZm8nLCBwb3N0LmVsKSksICdjbGljaycsIFFSLnF1b3RlKTsKICAgIH0sCiAgICBvcGVuOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKFFSLmVsKSB7CiAgICAgICAgUVIuZWwuaGlkZGVuID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIFFSLnVuaGlkZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBRUi5kaWFsb2coKTsKICAgICAgfQogICAgfSwKICAgIGNsb3NlOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGksIHNwb2lsZXIsIF9pLCBfbGVuLCBfcmVmOwogICAgICBRUi5lbC5oaWRkZW4gPSB0cnVlOwogICAgICBRUi5hYm9ydCgpOwogICAgICBkLmFjdGl2ZUVsZW1lbnQuYmx1cigpOwogICAgICAkLnJtQ2xhc3MoUVIuZWwsICdkdW1wJyk7CiAgICAgIF9yZWYgPSBRUi5yZXBsaWVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBpID0gX3JlZltfaV07CiAgICAgICAgUVIucmVwbGllc1swXS5ybSgpOwogICAgICB9CiAgICAgIFFSLmNvb2xkb3duLmF1dG8gPSBmYWxzZTsKICAgICAgUVIuc3RhdHVzKCk7CiAgICAgIFFSLnJlc2V0RmlsZUlucHV0KCk7CiAgICAgIGlmICghQ29uZlsnUmVtZW1iZXIgU3BvaWxlciddICYmIChzcG9pbGVyID0gJC5pZCgnc3BvaWxlcicpKS5jaGVja2VkKSB7CiAgICAgICAgc3BvaWxlci5jbGljaygpOwogICAgICB9CiAgICAgIHJldHVybiBRUi5jbGVhbkVycm9yKCk7CiAgICB9LAogICAgaGlkZTogZnVuY3Rpb24oKSB7CiAgICAgIGQuYWN0aXZlRWxlbWVudC5ibHVyKCk7CiAgICAgICQuYWRkQ2xhc3MoUVIuZWwsICdhdXRvaGlkZScpOwogICAgICByZXR1cm4gJC5pZCgnYXV0b2hpZGUnKS5jaGVja2VkID0gdHJ1ZTsKICAgIH0sCiAgICB1bmhpZGU6IGZ1bmN0aW9uKCkgewogICAgICAkLnJtQ2xhc3MoUVIuZWwsICdhdXRvaGlkZScpOwogICAgICByZXR1cm4gJC5pZCgnYXV0b2hpZGUnKS5jaGVja2VkID0gZmFsc2U7CiAgICB9LAogICAgdG9nZ2xlSGlkZTogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmNoZWNrZWQgJiYgUVIuaGlkZSgpIHx8IFFSLnVuaGlkZSgpOwogICAgfSwKICAgIGVycm9yOiBmdW5jdGlvbihlcnIpIHsKICAgICAgdmFyIGVsOwogICAgICBlbCA9ICQoJy53YXJuaW5nJywgUVIuZWwpOwogICAgICBpZiAodHlwZW9mIGVyciA9PT0gJ3N0cmluZycpIHsKICAgICAgICBlbC50ZXh0Q29udGVudCA9IGVycjsKICAgICAgfSBlbHNlIHsKICAgICAgICBlbC5pbm5lckhUTUwgPSBudWxsOwogICAgICAgICQuYWRkKGVsLCBlcnIpOwogICAgICB9CiAgICAgIFFSLm9wZW4oKTsKICAgICAgaWYgKGQuaGlkZGVuKSB7CiAgICAgICAgcmV0dXJuIGFsZXJ0KGVsLnRleHRDb250ZW50KTsKICAgICAgfQogICAgfSwKICAgIGNsZWFuRXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gJCgnLndhcm5pbmcnLCBRUi5lbCkudGV4dENvbnRlbnQgPSBudWxsOwogICAgfSwKICAgIHN0YXR1czogZnVuY3Rpb24oZGF0YSkgewogICAgICB2YXIgZGlzYWJsZWQsIGlucHV0LCB2YWx1ZTsKICAgICAgaWYgKGRhdGEgPT0gbnVsbCkgewogICAgICAgIGRhdGEgPSB7fTsKICAgICAgfQogICAgICBpZiAoIVFSLmVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChnLmRlYWQpIHsKICAgICAgICB2YWx1ZSA9IDQwNDsKICAgICAgICBkaXNhYmxlZCA9IHRydWU7CiAgICAgICAgUVIuY29vbGRvd24uYXV0byA9IGZhbHNlOwogICAgICB9CiAgICAgIHZhbHVlID0gZGF0YS5wcm9ncmVzcyB8fCBRUi5jb29sZG93bi5zZWNvbmRzIHx8IHZhbHVlOwogICAgICBpbnB1dCA9IFFSLnN0YXR1cy5pbnB1dDsKICAgICAgaW5wdXQudmFsdWUgPSBRUi5jb29sZG93bi5hdXRvICYmIENvbmZbJ0Nvb2xkb3duJ10gPyB2YWx1ZSA/ICJBdXRvICIgKyB2YWx1ZSA6ICdBdXRvJyA6IHZhbHVlIHx8ICdTdWJtaXQnOwogICAgICByZXR1cm4gaW5wdXQuZGlzYWJsZWQgPSBkaXNhYmxlZCB8fCBmYWxzZTsKICAgIH0sCiAgICBjb29sZG93bjogewogICAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoIUNvbmZbJ0Nvb2xkb3duJ10pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgUVIuY29vbGRvd24udHlwZXMgPSB7CiAgICAgICAgICB0aHJlYWQ6IChmdW5jdGlvbigpIHsKICAgICAgICAgICAgc3dpdGNoIChnLkJPQVJEKSB7CiAgICAgICAgICAgICAgY2FzZSAnanAnOgogICAgICAgICAgICAgICAgcmV0dXJuIDM2MDA7CiAgICAgICAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICAgICAgY2FzZSAnc29jJzoKICAgICAgICAgICAgICBjYXNlICdyOWsnOgogICAgICAgICAgICAgICAgcmV0dXJuIDYwMDsKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIDMwMDsKICAgICAgICAgICAgfQogICAgICAgICAgfSkoKSwKICAgICAgICAgIHNhZ2U6IDYwLAogICAgICAgICAgZmlsZTogZy5CT0FSRCA9PT0gJ3ZnJyA/IDEyMCA6IDYwLAogICAgICAgICAgcG9zdDogZy5CT0FSRCA9PT0gJ3ZnJyA/IDkwIDogNjAKICAgICAgICB9OwogICAgICAgIFFSLmNvb2xkb3duLmNvb2xkb3ducyA9ICQuZ2V0KCIiICsgZy5CT0FSRCArICIuY29vbGRvd24iLCB7fSk7CiAgICAgICAgUVIuY29vbGRvd24uc3RhcnQoKTsKICAgICAgICByZXR1cm4gJC5zeW5jKCIiICsgZy5CT0FSRCArICIuY29vbGRvd24iLCBRUi5jb29sZG93bi5zeW5jKTsKICAgICAgfSwKICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChRUi5jb29sZG93bi5pc0NvdW50aW5nKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIFFSLmNvb2xkb3duLmlzQ291bnRpbmcgPSB0cnVlOwogICAgICAgIHJldHVybiBRUi5jb29sZG93bi5jb3VudCgpOwogICAgICB9LAogICAgICBzeW5jOiBmdW5jdGlvbihjb29sZG93bnMpIHsKICAgICAgICB2YXIgaWQ7CiAgICAgICAgZm9yIChpZCBpbiBjb29sZG93bnMpIHsKICAgICAgICAgIFFSLmNvb2xkb3duLmNvb2xkb3duc1tpZF0gPSBjb29sZG93bnNbaWRdOwogICAgICAgIH0KICAgICAgICByZXR1cm4gUVIuY29vbGRvd24uc3RhcnQoKTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgdmFyIGNvb2xkb3duLCBoYXNGaWxlLCBpc1JlcGx5LCBpc1NhZ2UsIHN0YXJ0LCB0eXBlOwogICAgICAgIGlmICghQ29uZlsnQ29vbGRvd24nXSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzdGFydCA9IERhdGUubm93KCk7CiAgICAgICAgaWYgKGRhdGEuZGVsYXkpIHsKICAgICAgICAgIGNvb2xkb3duID0gewogICAgICAgICAgICBkZWxheTogZGF0YS5kZWxheQogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaXNTYWdlID0gL3NhZ2UvaS50ZXN0KGRhdGEucG9zdC5lbWFpbCk7CiAgICAgICAgICBoYXNGaWxlID0gISFkYXRhLnBvc3QuZmlsZTsKICAgICAgICAgIGlzUmVwbHkgPSBkYXRhLmlzUmVwbHk7CiAgICAgICAgICB0eXBlID0gIWlzUmVwbHkgPyAndGhyZWFkJyA6IGlzU2FnZSA/ICdzYWdlJyA6IGhhc0ZpbGUgPyAnZmlsZScgOiAncG9zdCc7CiAgICAgICAgICBjb29sZG93biA9IHsKICAgICAgICAgICAgaXNSZXBseTogaXNSZXBseSwKICAgICAgICAgICAgaXNTYWdlOiBpc1NhZ2UsCiAgICAgICAgICAgIGhhc0ZpbGU6IGhhc0ZpbGUsCiAgICAgICAgICAgIHRpbWVvdXQ6IHN0YXJ0ICsgUVIuY29vbGRvd24udHlwZXNbdHlwZV0gKiAkLlNFQ09ORAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgUVIuY29vbGRvd24uY29vbGRvd25zW3N0YXJ0XSA9IGNvb2xkb3duOwogICAgICAgICQuc2V0KCIiICsgZy5CT0FSRCArICIuY29vbGRvd24iLCBRUi5jb29sZG93bi5jb29sZG93bnMpOwogICAgICAgIHJldHVybiBRUi5jb29sZG93bi5zdGFydCgpOwogICAgICB9LAogICAgICB1bnNldDogZnVuY3Rpb24oaWQpIHsKICAgICAgICBkZWxldGUgUVIuY29vbGRvd24uY29vbGRvd25zW2lkXTsKICAgICAgICByZXR1cm4gJC5zZXQoIiIgKyBnLkJPQVJEICsgIi5jb29sZG93biIsIFFSLmNvb2xkb3duLmNvb2xkb3ducyk7CiAgICAgIH0sCiAgICAgIGNvdW50OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgY29vbGRvd24sIGNvb2xkb3ducywgZWxhcHNlZCwgaGFzRmlsZSwgaXNSZXBseSwgaXNTYWdlLCBub3csIHBvc3QsIHNlY29uZHMsIHN0YXJ0LCB0eXBlLCB0eXBlcywgdXBkYXRlLCBfcmVmOwogICAgICAgIGlmIChPYmplY3Qua2V5cyhRUi5jb29sZG93bi5jb29sZG93bnMpLmxlbmd0aCkgewogICAgICAgICAgc2V0VGltZW91dChRUi5jb29sZG93bi5jb3VudCwgMTAwMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICRbImRlbGV0ZSJdKCIiICsgZy5CT0FSRCArICIuY29vbGRvd24iKTsKICAgICAgICAgIGRlbGV0ZSBRUi5jb29sZG93bi5pc0NvdW50aW5nOwogICAgICAgICAgZGVsZXRlIFFSLmNvb2xkb3duLnNlY29uZHM7CiAgICAgICAgICBRUi5zdGF0dXMoKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKChpc1JlcGx5ID0gZy5SRVBMWSA/IHRydWUgOiBRUi50aHJlYWRTZWxlY3Rvci52YWx1ZSAhPT0gJ25ldycpKSB7CiAgICAgICAgICBwb3N0ID0gUVIucmVwbGllc1swXTsKICAgICAgICAgIGlzU2FnZSA9IC9zYWdlL2kudGVzdChwb3N0LmVtYWlsKTsKICAgICAgICAgIGhhc0ZpbGUgPSAhIXBvc3QuZmlsZTsKICAgICAgICB9CiAgICAgICAgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgICBzZWNvbmRzID0gbnVsbDsKICAgICAgICBfcmVmID0gUVIuY29vbGRvd24sIHR5cGVzID0gX3JlZi50eXBlcywgY29vbGRvd25zID0gX3JlZi5jb29sZG93bnM7CiAgICAgICAgZm9yIChzdGFydCBpbiBjb29sZG93bnMpIHsKICAgICAgICAgIGNvb2xkb3duID0gY29vbGRvd25zW3N0YXJ0XTsKICAgICAgICAgIGlmICgnZGVsYXknIGluIGNvb2xkb3duKSB7CiAgICAgICAgICAgIGlmIChjb29sZG93bi5kZWxheSkgewogICAgICAgICAgICAgIHNlY29uZHMgPSBNYXRoLm1heChzZWNvbmRzLCBjb29sZG93bi5kZWxheS0tKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZWNvbmRzID0gTWF0aC5tYXgoc2Vjb25kcywgMCk7CiAgICAgICAgICAgICAgUVIuY29vbGRvd24udW5zZXQoc3RhcnQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGlzUmVwbHkgPT09IGNvb2xkb3duLmlzUmVwbHkpIHsKICAgICAgICAgICAgdHlwZSA9ICFpc1JlcGx5ID8gJ3RocmVhZCcgOiBpc1NhZ2UgJiYgY29vbGRvd24uaXNTYWdlID8gJ3NhZ2UnIDogaGFzRmlsZSAmJiBjb29sZG93bi5oYXNGaWxlID8gJ2ZpbGUnIDogJ3Bvc3QnOwogICAgICAgICAgICBlbGFwc2VkID0gTWF0aC5mbG9vcigobm93IC0gc3RhcnQpIC8gMTAwMCk7CiAgICAgICAgICAgIGlmIChlbGFwc2VkID49IDApIHsKICAgICAgICAgICAgICBzZWNvbmRzID0gTWF0aC5tYXgoc2Vjb25kcywgdHlwZXNbdHlwZV0gLSBlbGFwc2VkKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYgKCEoKHN0YXJ0IDw9IG5vdyAmJiBub3cgPD0gY29vbGRvd24udGltZW91dCkpKSB7CiAgICAgICAgICAgIFFSLmNvb2xkb3duLnVuc2V0KHN0YXJ0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdXBkYXRlID0gc2Vjb25kcyAhPT0gbnVsbCB8fCAhIVFSLmNvb2xkb3duLnNlY29uZHM7CiAgICAgICAgUVIuY29vbGRvd24uc2Vjb25kcyA9IHNlY29uZHM7CiAgICAgICAgaWYgKHVwZGF0ZSkgewogICAgICAgICAgUVIuc3RhdHVzKCk7CiAgICAgICAgfQogICAgICAgIGlmIChzZWNvbmRzID09PSAwICYmIFFSLmNvb2xkb3duLmF1dG8pIHsKICAgICAgICAgIHJldHVybiBRUi5zdWJtaXQoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBxdW90ZTogZnVuY3Rpb24oZSkgewogICAgICB2YXIgY2FyZXRQb3MsIGlkLCByYW5nZSwgcywgc2VsLCB0YSwgdGV4dCwgX3JlZjsKICAgICAgaWYgKGUgIT0gbnVsbCkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgICBRUi5vcGVuKCk7CiAgICAgIHRhID0gJCgndGV4dGFyZWEnLCBRUi5lbCk7CiAgICAgIGlmICghKGcuUkVQTFkgfHwgdGEudmFsdWUpKSB7CiAgICAgICAgUVIudGhyZWFkU2VsZWN0b3IudmFsdWUgPSAkLngoJ2FuY2VzdG9yOjpkaXZbcGFyZW50OjpkaXZbQGNsYXNzPSJib2FyZCJdXScsIHRoaXMpLmlkLnNsaWNlKDEpOwogICAgICB9CiAgICAgIGlkID0gdGhpcy5wcmV2aW91c1NpYmxpbmcuaGFzaC5zbGljZSgyKTsKICAgICAgdGV4dCA9ICI+PiIgKyBpZCArICJcbiI7CiAgICAgIHNlbCA9IGQuZ2V0U2VsZWN0aW9uKCk7CiAgICAgIGlmICgocyA9IHNlbC50b1N0cmluZygpLnRyaW0oKSkgJiYgaWQgPT09ICgoX3JlZiA9ICQueCgnYW5jZXN0b3Itb3Itc2VsZjo6YmxvY2txdW90ZScsIHNlbC5hbmNob3JOb2RlKSkgIT0gbnVsbCA/IF9yZWYuaWQubWF0Y2goL1xkKyQvKVswXSA6IHZvaWQgMCkpIHsKICAgICAgICBzID0gcy5yZXBsYWNlKC9cbi9nLCAnXG4+Jyk7CiAgICAgICAgdGV4dCArPSAiPiIgKyBzICsgIlxuIjsKICAgICAgfQogICAgICBjYXJldFBvcyA9IHRhLnNlbGVjdGlvblN0YXJ0OwogICAgICB0YS52YWx1ZSA9IHRhLnZhbHVlLnNsaWNlKDAsIGNhcmV0UG9zKSArIHRleHQgKyB0YS52YWx1ZS5zbGljZSh0YS5zZWxlY3Rpb25FbmQpOwogICAgICByYW5nZSA9IGNhcmV0UG9zICsgdGV4dC5sZW5ndGg7CiAgICAgIHRhLnNldFNlbGVjdGlvblJhbmdlKHJhbmdlLCByYW5nZSk7CiAgICAgIHRhLmZvY3VzKCk7CiAgICAgIHJldHVybiB0YS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnaW5wdXQnKSk7CiAgICB9LAogICAgY2hhcmFjdGVyQ291bnQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY291bnQsIGNvdW50ZXI7CiAgICAgIGNvdW50ZXIgPSBRUi5jaGFyYUNvdW50ZXI7CiAgICAgIGNvdW50ID0gdGhpcy50ZXh0TGVuZ3RoOwogICAgICBjb3VudGVyLnRleHRDb250ZW50ID0gY291bnQ7CiAgICAgIGNvdW50ZXIuaGlkZGVuID0gY291bnQgPCAoUVIubWF4Q29tbWVudCAvIDIpOwogICAgICByZXR1cm4gKGNvdW50ID4gUVIubWF4Q29tbWVudCA/ICQuYWRkQ2xhc3MgOiAkLnJtQ2xhc3MpKGNvdW50ZXIsICd3YXJuaW5nJyk7CiAgICB9LAogICAgZHJhZzogZnVuY3Rpb24oZSkgewogICAgICB2YXIgdG9nZ2xlOwogICAgICB0b2dnbGUgPSBlLnR5cGUgPT09ICdkcmFnc3RhcnQnID8gJC5vZmYgOiAkLm9uOwogICAgICB0b2dnbGUoZCwgJ2RyYWdvdmVyJywgUVIuZHJhZ092ZXIpOwogICAgICByZXR1cm4gdG9nZ2xlKGQsICdkcm9wJywgUVIuZHJvcEZpbGUpOwogICAgfSwKICAgIGRyYWdPdmVyOiBmdW5jdGlvbihlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgcmV0dXJuIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnY29weSc7CiAgICB9LAogICAgZHJvcEZpbGU6IGZ1bmN0aW9uKGUpIHsKICAgICAgaWYgKCFlLmRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBRUi5vcGVuKCk7CiAgICAgIFFSLmZpbGVJbnB1dC5jYWxsKGUuZGF0YVRyYW5zZmVyKTsKICAgICAgcmV0dXJuICQuYWRkQ2xhc3MoUVIuZWwsICdkdW1wJyk7CiAgICB9LAogICAgZmlsZUlucHV0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGZpbGUsIF9pLCBfbGVuLCBfcmVmOwogICAgICBRUi5jbGVhbkVycm9yKCk7CiAgICAgIGlmICh0aGlzLmZpbGVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIGZpbGUgPSB0aGlzLmZpbGVzWzBdOwogICAgICAgIGlmIChmaWxlLnNpemUgPiB0aGlzLm1heCkgewogICAgICAgICAgUVIuZXJyb3IoJ0ZpbGUgdG9vIGxhcmdlLicpOwogICAgICAgICAgUVIucmVzZXRGaWxlSW5wdXQoKTsKICAgICAgICB9IGVsc2UgaWYgKC0xID09PSBRUi5taW1lVHlwZXMuaW5kZXhPZihmaWxlLnR5cGUpKSB7CiAgICAgICAgICBRUi5lcnJvcignVW5zdXBwb3J0ZWQgZmlsZSB0eXBlLicpOwogICAgICAgICAgUVIucmVzZXRGaWxlSW5wdXQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgUVIuc2VsZWN0ZWQuc2V0RmlsZShmaWxlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIF9yZWYgPSB0aGlzLmZpbGVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBmaWxlID0gX3JlZltfaV07CiAgICAgICAgaWYgKGZpbGUuc2l6ZSA+IHRoaXMubWF4KSB7CiAgICAgICAgICBRUi5lcnJvcigiRmlsZSAiICsgZmlsZS5uYW1lICsgIiBpcyB0b28gbGFyZ2UuIik7CiAgICAgICAgICBicmVhazsKICAgICAgICB9IGVsc2UgaWYgKC0xID09PSBRUi5taW1lVHlwZXMuaW5kZXhPZihmaWxlLnR5cGUpKSB7CiAgICAgICAgICBRUi5lcnJvcigiIiArIGZpbGUubmFtZSArICI6IFVuc3VwcG9ydGVkIGZpbGUgdHlwZS4iKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpZiAoIVFSLnJlcGxpZXNbUVIucmVwbGllcy5sZW5ndGggLSAxXS5maWxlKSB7CiAgICAgICAgICBRUi5yZXBsaWVzW1FSLnJlcGxpZXMubGVuZ3RoIC0gMV0uc2V0RmlsZShmaWxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmV3IFFSLnJlcGx5KCkuc2V0RmlsZShmaWxlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgJC5hZGRDbGFzcyhRUi5lbCwgJ2R1bXAnKTsKICAgICAgcmV0dXJuIFFSLnJlc2V0RmlsZUlucHV0KCk7CiAgICB9LAogICAgcmVzZXRGaWxlSW5wdXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gJCgnW3R5cGU9ZmlsZV0nLCBRUi5lbCkudmFsdWUgPSBudWxsOwogICAgfSwKICAgIHJlcGxpZXM6IFtdLAogICAgcmVwbHk6IChmdW5jdGlvbigpIHsKICAgICAgZnVuY3Rpb24gX0NsYXNzKCkgewogICAgICAgIHZhciBwZXJzb25hLCBwcmV2LAogICAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICAgIHByZXYgPSBRUi5yZXBsaWVzW1FSLnJlcGxpZXMubGVuZ3RoIC0gMV07CiAgICAgICAgcGVyc29uYSA9ICQuZ2V0KCdRUi5wZXJzb25hJywge30pOwogICAgICAgIHRoaXMubmFtZSA9IHByZXYgPyBwcmV2Lm5hbWUgOiBwZXJzb25hLm5hbWUgfHwgbnVsbDsKICAgICAgICB0aGlzLmVtYWlsID0gcHJldiAmJiAhL15zYWdlJC8udGVzdChwcmV2LmVtYWlsKSA/IHByZXYuZW1haWwgOiBwZXJzb25hLmVtYWlsIHx8IG51bGw7CiAgICAgICAgdGhpcy5zdWIgPSBwcmV2ICYmIENvbmZbJ1JlbWVtYmVyIFN1YmplY3QnXSA/IHByZXYuc3ViIDogQ29uZlsnUmVtZW1iZXIgU3ViamVjdCddID8gcGVyc29uYS5zdWIgOiBudWxsOwogICAgICAgIHRoaXMuc3BvaWxlciA9IHByZXYgJiYgQ29uZlsnUmVtZW1iZXIgU3BvaWxlciddID8gcHJldi5zcG9pbGVyIDogZmFsc2U7CiAgICAgICAgdGhpcy5jb20gPSBudWxsOwogICAgICAgIHRoaXMuZWwgPSAkLmVsKCdhJywgewogICAgICAgICAgY2xhc3NOYW1lOiAndGh1bWJuYWlsJywKICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSwKICAgICAgICAgIGhyZWY6ICdqYXZhc2NyaXB0OjsnLAogICAgICAgICAgaW5uZXJIVE1MOiAnPGEgY2xhc3M9cmVtb3ZlPsOXPC9hPjxsYWJlbCBoaWRkZW4+PGlucHV0IHR5cGU9Y2hlY2tib3g+IFNwb2lsZXI8L2xhYmVsPjxzcGFuPjwvc3Bhbj4nCiAgICAgICAgfSk7CiAgICAgICAgJCgnaW5wdXQnLCB0aGlzLmVsKS5jaGVja2VkID0gdGhpcy5zcG9pbGVyOwogICAgICAgICQub24odGhpcy5lbCwgJ2NsaWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuc2VsZWN0KCk7CiAgICAgICAgfSk7CiAgICAgICAgJC5vbigkKCcucmVtb3ZlJywgdGhpcy5lbCksICdjbGljaycsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICByZXR1cm4gX3RoaXMucm0oKTsKICAgICAgICB9KTsKICAgICAgICAkLm9uKCQoJ2xhYmVsJywgdGhpcy5lbCksICdjbGljaycsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIHJldHVybiBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIH0pOwogICAgICAgICQub24oJCgnaW5wdXQnLCB0aGlzLmVsKSwgJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIF90aGlzLnNwb2lsZXIgPSBlLnRhcmdldC5jaGVja2VkOwogICAgICAgICAgaWYgKF90aGlzLmVsLmlkID09PSAnc2VsZWN0ZWQnKSB7CiAgICAgICAgICAgIHJldHVybiAkLmlkKCdzcG9pbGVyJykuY2hlY2tlZCA9IF90aGlzLnNwb2lsZXI7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgJC5iZWZvcmUoJCgnI2FkZFJlcGx5JywgUVIuZWwpLCB0aGlzLmVsKTsKICAgICAgICAkLm9uKHRoaXMuZWwsICdkcmFnc3RhcnQnLCB0aGlzLmRyYWdTdGFydCk7CiAgICAgICAgJC5vbih0aGlzLmVsLCAnZHJhZ2VudGVyJywgdGhpcy5kcmFnRW50ZXIpOwogICAgICAgICQub24odGhpcy5lbCwgJ2RyYWdsZWF2ZScsIHRoaXMuZHJhZ0xlYXZlKTsKICAgICAgICAkLm9uKHRoaXMuZWwsICdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXIpOwogICAgICAgICQub24odGhpcy5lbCwgJ2RyYWdlbmQnLCB0aGlzLmRyYWdFbmQpOwogICAgICAgICQub24odGhpcy5lbCwgJ2Ryb3AnLCB0aGlzLmRyb3ApOwogICAgICAgIFFSLnJlcGxpZXMucHVzaCh0aGlzKTsKICAgICAgfQoKICAgICAgX0NsYXNzLnByb3RvdHlwZS5zZXRGaWxlID0gZnVuY3Rpb24oZmlsZSkgewogICAgICAgIHZhciBmaWxlVXJsLCBpbWcsIHVybCwKICAgICAgICAgIF90aGlzID0gdGhpczsKICAgICAgICB0aGlzLmZpbGUgPSBmaWxlOwogICAgICAgIHRoaXMuZWwudGl0bGUgPSAiIiArIGZpbGUubmFtZSArICIgKCIgKyAoJC5ieXRlc1RvU3RyaW5nKGZpbGUuc2l6ZSkpICsgIikiOwogICAgICAgIGlmIChRUi5zcG9pbGVyKSB7CiAgICAgICAgICAkKCdsYWJlbCcsIHRoaXMuZWwpLmhpZGRlbiA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAoIS9eaW1hZ2UvLnRlc3QoZmlsZS50eXBlKSkgewogICAgICAgICAgdGhpcy5lbC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBudWxsOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoISh1cmwgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkwpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHVybC5yZXZva2VPYmplY3RVUkwodGhpcy51cmwpOwogICAgICAgIGZpbGVVcmwgPSB1cmwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpOwogICAgICAgIGltZyA9ICQuZWwoJ2ltZycpOwogICAgICAgICQub24oaW1nLCAnbG9hZCcsIGZ1bmN0aW9uKCkgewogICAgICAgICAgdmFyIGMsIGRhdGEsIGksIGwsIHMsIHVpOGEsIF9pOwogICAgICAgICAgcyA9IDkwICogMzsKICAgICAgICAgIGlmIChpbWcuaGVpZ2h0IDwgcyB8fCBpbWcud2lkdGggPCBzKSB7CiAgICAgICAgICAgIF90aGlzLnVybCA9IGZpbGVVcmw7CiAgICAgICAgICAgIF90aGlzLmVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICJ1cmwoIiArIF90aGlzLnVybCArICIpIjsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGltZy5oZWlnaHQgPD0gaW1nLndpZHRoKSB7CiAgICAgICAgICAgIGltZy53aWR0aCA9IHMgLyBpbWcuaGVpZ2h0ICogaW1nLndpZHRoOwogICAgICAgICAgICBpbWcuaGVpZ2h0ID0gczsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGltZy5oZWlnaHQgPSBzIC8gaW1nLndpZHRoICogaW1nLmhlaWdodDsKICAgICAgICAgICAgaW1nLndpZHRoID0gczsKICAgICAgICAgIH0KICAgICAgICAgIGMgPSAkLmVsKCdjYW52YXMnKTsKICAgICAgICAgIGMuaGVpZ2h0ID0gaW1nLmhlaWdodDsKICAgICAgICAgIGMud2lkdGggPSBpbWcud2lkdGg7CiAgICAgICAgICBjLmdldENvbnRleHQoJzJkJykuZHJhd0ltYWdlKGltZywgMCwgMCwgaW1nLndpZHRoLCBpbWcuaGVpZ2h0KTsKICAgICAgICAgIGRhdGEgPSBhdG9iKGMudG9EYXRhVVJMKCkuc3BsaXQoJywnKVsxXSk7CiAgICAgICAgICBsID0gZGF0YS5sZW5ndGg7CiAgICAgICAgICB1aThhID0gbmV3IFVpbnQ4QXJyYXkobCk7CiAgICAgICAgICBmb3IgKGkgPSBfaSA9IDA7IDAgPD0gbCA/IF9pIDwgbCA6IF9pID4gbDsgaSA9IDAgPD0gbCA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICAgIHVpOGFbaV0gPSBkYXRhLmNoYXJDb2RlQXQoaSk7CiAgICAgICAgICB9CiAgICAgICAgICBfdGhpcy51cmwgPSB1cmwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFt1aThhXSwgewogICAgICAgICAgICB0eXBlOiAnaW1hZ2UvcG5nJwogICAgICAgICAgfSkpOwogICAgICAgICAgX3RoaXMuZWwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gInVybCgiICsgX3RoaXMudXJsICsgIikiOwogICAgICAgICAgcmV0dXJuIHR5cGVvZiB1cmwucmV2b2tlT2JqZWN0VVJMID09PSAiZnVuY3Rpb24iID8gdXJsLnJldm9rZU9iamVjdFVSTChmaWxlVXJsKSA6IHZvaWQgMDsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gaW1nLnNyYyA9IGZpbGVVcmw7CiAgICAgIH07CgogICAgICBfQ2xhc3MucHJvdG90eXBlLnJtRmlsZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBfYmFzZTE7CiAgICAgICAgUVIucmVzZXRGaWxlSW5wdXQoKTsKICAgICAgICBkZWxldGUgdGhpcy5maWxlOwogICAgICAgIHRoaXMuZWwudGl0bGUgPSBudWxsOwogICAgICAgIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gbnVsbDsKICAgICAgICBpZiAoUVIuc3BvaWxlcikgewogICAgICAgICAgJCgnbGFiZWwnLCB0aGlzLmVsKS5oaWRkZW4gPSB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHlwZW9mIChfYmFzZTEgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkwpLnJldm9rZU9iamVjdFVSTCA9PT0gImZ1bmN0aW9uIiA/IF9iYXNlMS5yZXZva2VPYmplY3RVUkwodGhpcy51cmwpIDogdm9pZCAwOwogICAgICB9OwoKICAgICAgX0NsYXNzLnByb3RvdHlwZS5zZWxlY3QgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgZGF0YSwgcmVjdEVsLCByZWN0TGlzdCwgX2ksIF9sZW4sIF9yZWYsIF9yZWYxOwogICAgICAgIGlmICgoX3JlZiA9IFFSLnNlbGVjdGVkKSAhPSBudWxsKSB7CiAgICAgICAgICBfcmVmLmVsLmlkID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgUVIuc2VsZWN0ZWQgPSB0aGlzOwogICAgICAgIHRoaXMuZWwuaWQgPSAnc2VsZWN0ZWQnOwogICAgICAgIHJlY3RFbCA9IHRoaXMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgcmVjdExpc3QgPSB0aGlzLmVsLnBhcmVudE5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgdGhpcy5lbC5wYXJlbnROb2RlLnNjcm9sbExlZnQgKz0gcmVjdEVsLmxlZnQgKyByZWN0RWwud2lkdGggLyAyIC0gcmVjdExpc3QubGVmdCAtIHJlY3RMaXN0LndpZHRoIC8gMjsKICAgICAgICBfcmVmMSA9IFsnbmFtZScsICdlbWFpbCcsICdzdWInLCAnY29tJ107CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmMS5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgICAgZGF0YSA9IF9yZWYxW19pXTsKICAgICAgICAgICQoIltuYW1lPSIgKyBkYXRhICsgIl0iLCBRUi5lbCkudmFsdWUgPSB0aGlzW2RhdGFdOwogICAgICAgIH0KICAgICAgICBRUi5jaGFyYWN0ZXJDb3VudC5jYWxsKCQoJ3RleHRhcmVhJywgUVIuZWwpKTsKICAgICAgICByZXR1cm4gJCgnI3Nwb2lsZXInLCBRUi5lbCkuY2hlY2tlZCA9IHRoaXMuc3BvaWxlcjsKICAgICAgfTsKCiAgICAgIF9DbGFzcy5wcm90b3R5cGUuZHJhZ1N0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICQuYWRkQ2xhc3ModGhpcywgJ2RyYWcnKTsKICAgICAgfTsKCiAgICAgIF9DbGFzcy5wcm90b3R5cGUuZHJhZ0VudGVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICQuYWRkQ2xhc3ModGhpcywgJ292ZXInKTsKICAgICAgfTsKCiAgICAgIF9DbGFzcy5wcm90b3R5cGUuZHJhZ0xlYXZlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICQucm1DbGFzcyh0aGlzLCAnb3ZlcicpOwogICAgICB9OwoKICAgICAgX0NsYXNzLnByb3RvdHlwZS5kcmFnT3ZlciA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgcmV0dXJuIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnbW92ZSc7CiAgICAgIH07CgogICAgICBfQ2xhc3MucHJvdG90eXBlLmRyb3AgPSBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgZWwsIGluZGV4LCBuZXdJbmRleCwgb2xkSW5kZXgsIHJlcGx5OwogICAgICAgIGVsID0gJCgnLmRyYWcnLCB0aGlzLnBhcmVudE5vZGUpOwogICAgICAgIGluZGV4ID0gZnVuY3Rpb24oZWwpIHsKICAgICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlbC5wYXJlbnROb2RlLmNoaWxkcmVuKS5pbmRleE9mKGVsKTsKICAgICAgICB9OwogICAgICAgIG9sZEluZGV4ID0gaW5kZXgoZWwpOwogICAgICAgIG5ld0luZGV4ID0gaW5kZXgodGhpcyk7CiAgICAgICAgaWYgKG9sZEluZGV4IDwgbmV3SW5kZXgpIHsKICAgICAgICAgICQuYWZ0ZXIodGhpcywgZWwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkLmJlZm9yZSh0aGlzLCBlbCk7CiAgICAgICAgfQogICAgICAgIHJlcGx5ID0gUVIucmVwbGllcy5zcGxpY2Uob2xkSW5kZXgsIDEpWzBdOwogICAgICAgIHJldHVybiBRUi5yZXBsaWVzLnNwbGljZShuZXdJbmRleCwgMCwgcmVwbHkpOwogICAgICB9OwoKICAgICAgX0NsYXNzLnByb3RvdHlwZS5kcmFnRW5kID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGVsOwogICAgICAgICQucm1DbGFzcyh0aGlzLCAnZHJhZycpOwogICAgICAgIGlmIChlbCA9ICQoJy5vdmVyJywgdGhpcy5wYXJlbnROb2RlKSkgewogICAgICAgICAgcmV0dXJuICQucm1DbGFzcyhlbCwgJ292ZXInKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBfQ2xhc3MucHJvdG90eXBlLnJtID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGluZGV4LCBfYmFzZTE7CiAgICAgICAgUVIucmVzZXRGaWxlSW5wdXQoKTsKICAgICAgICAkLnJtKHRoaXMuZWwpOwogICAgICAgIGluZGV4ID0gUVIucmVwbGllcy5pbmRleE9mKHRoaXMpOwogICAgICAgIGlmIChRUi5yZXBsaWVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgbmV3IFFSLnJlcGx5KCkuc2VsZWN0KCk7CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmVsLmlkID09PSAnc2VsZWN0ZWQnKSB7CiAgICAgICAgICAoUVIucmVwbGllc1tpbmRleCAtIDFdIHx8IFFSLnJlcGxpZXNbaW5kZXggKyAxXSkuc2VsZWN0KCk7CiAgICAgICAgfQogICAgICAgIFFSLnJlcGxpZXMuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICByZXR1cm4gdHlwZW9mIChfYmFzZTEgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkwpLnJldm9rZU9iamVjdFVSTCA9PT0gImZ1bmN0aW9uIiA/IF9iYXNlMS5yZXZva2VPYmplY3RVUkwodGhpcy51cmwpIDogdm9pZCAwOwogICAgICB9OwoKICAgICAgcmV0dXJuIF9DbGFzczsKCiAgICB9KSgpLAogICAgY2FwdGNoYTogewogICAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoLTEgIT09IGQuY29va2llLmluZGV4T2YoJ3Bhc3NfZW5hYmxlZD0nKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoISh0aGlzLmlzRW5hYmxlZCA9ICEhJC5pZCgnZy1yZWNhcHRjaGEnKSkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucmVhZHkoKTsKICAgICAgfSwKICAgICAgcmVhZHk6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmKCFDYXB0Y2hhSXNTZXR1cCkgewogICAgICAgICAgaWYoIUNvbmZbJ0FsdGVybmF0aXZlIGNhcHRjaGEnXSB8fCAoIWcuUkVQTFkgJiYgIUNvbmZbJ0FsdCBpbmRleCBjYXB0Y2hhJ10pKSB7CiAgICAgICAgICAgICQuYWZ0ZXIoJCgnLnRleHRhcmVhJywgUVIuZWwpLCAkLmVsKCdpbnB1dCcsIHsKICAgICAgICAgICAgICB0eXBlOiAnaGlkZGVuJywKICAgICAgICAgICAgICBpZDogJ3JlY2FwdGNoYV9yZXNwb25zZV9maWVsZCcsCiAgICAgICAgICAgICAgdmFsdWU6ICcnCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgJC5hZGRDbGFzcyhRUi5lbCwgJ2NhcHRjaGEnKTsKICAgICAgICAgICAgJC5nbG9iYWxFdmFsKCcoZnVuY3Rpb24gKCkge3dpbmRvdy5ncmVjYXB0Y2hhLnJlbmRlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZy1yZWNhcHRjaGEiKSwge3NpdGVrZXk6ICI2TGRwMmJzU0FBQUFBQUo1dXl4X2x4MzRsSmVFcFRMVmtQNWswNHFjIiwgdGhlbWU6ICJsaWdodCIsIGNhbGxiYWNrOiAoJyArIChDb25mWydBdXRvIFN1Ym1pdCddID8gJ2Z1bmN0aW9uIChyZXMpIHt2YXIgc2IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieF9RUl9TdWJtaXQiKTsgaWYoc2IpIHNiLmNsaWNrKCk7IH0nIDogJ2Z1bmN0aW9uIChyZXMpIHt9JykgKyAnKSB9KTt9KSgpJyk7CiAgICAgICAgICAgICQuYWZ0ZXIoJCgnLnRleHRhcmVhJywgUVIuZWwpLCAkLmlkKCdnLXJlY2FwdGNoYScpKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICQuYWRkQ2xhc3MoUVIuZWwsICdjYXB0Y2hhJyk7CiAgICAgICAgICAgICQuYWZ0ZXIoJCgnLnRleHRhcmVhJywgUVIuZWwpLCAkLmVsKCdkaXYnLCB7CiAgICAgICAgICAgICAgaWQ6ICdyZWNhcHRjaGFfd2lkZ2V0JywKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICAkLmdsb2JhbEV2YWwoIlJlY2FwdGNoYS5jcmVhdGUoJzZMZHAyYnNTQUFBQUFBSjV1eXhfbHgzNGxKZUVwVExWa1A1azA0cWMnLCAncmVjYXB0Y2hhX3dpZGdldCcsIHt0aGVtZTogJ2NsZWFuJ30pOyIpOwogICAgICAgICAgICB2YXIgYXNhcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAoISgkLmlkKCdyZWNhcHRjaGFfcmVzcG9uc2VfZmllbGQnKSkpIHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXNhcCwgMjAwKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgJC5vbigkLmlkKCdyZWNhcHRjaGFfcmVzcG9uc2VfZmllbGQnKSwgJ2tleWRvd24nLCBRUi5jYXB0Y2hhLmtleWRvd24pOwogICAgICAgICAgICAgICQuZ2xvYmFsRXZhbCgnKGZ1bmN0aW9uICgpIHt3aW5kb3cub251bmxvYWQ9ZnVuY3Rpb24gKCkge3dpbmRvdy5SZWNhcHRjaGEuZGVzdHJveSgpO307fSkoKTsnKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgYXNhcCgpOwogICAgICAgICAgfQogICAgICAgICAgQ2FwdGNoYUlzU2V0dXAgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2V0UmVzcG9uc2U6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmKCFDb25mWydBbHRlcm5hdGl2ZSBjYXB0Y2hhJ10gfHwgKCFnLlJFUExZICYmICFDb25mWydBbHQgaW5kZXggY2FwdGNoYSddKSkgewogICAgICAgICAgJC5nbG9iYWxFdmFsKCdkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVjYXB0Y2hhX3Jlc3BvbnNlX2ZpZWxkIikudmFsdWUgPSB3aW5kb3cuZ3JlY2FwdGNoYS5nZXRSZXNwb25zZSgpOycpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJC5pZCgncmVjYXB0Y2hhX3Jlc3BvbnNlX2ZpZWxkJykudmFsdWU7CiAgICAgIH0sCiAgICAgIGdldENoYWxsZW5nZTogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICQuaWQoJ3JlY2FwdGNoYV9jaGFsbGVuZ2VfZmllbGQnKS52YWx1ZTsKICAgICAgfSwKICAgICAgcmVzZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmKCFDb25mWydBbHRlcm5hdGl2ZSBjYXB0Y2hhJ10gfHwgKCFnLlJFUExZICYmICFDb25mWydBbHQgaW5kZXggY2FwdGNoYSddKSkgewogICAgICAgICAgJC5nbG9iYWxFdmFsKCd3aW5kb3cuZ3JlY2FwdGNoYS5yZXNldCgpOycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkLmdsb2JhbEV2YWwoJ3dpbmRvdy5SZWNhcHRjaGEucmVsb2FkKCk7IFJlY2FwdGNoYS5zaG91bGRfZm9jdXMgPSBmYWxzZTsnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGtleWRvd246IGZ1bmN0aW9uKGUpIHsKICAgICAgICB2YXIgcmVzcGZpZWxkID0gJC5pZCgncmVjYXB0Y2hhX3Jlc3BvbnNlX2ZpZWxkJyk7CiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gOCAmJiAhcmVzcGZpZWxkLnZhbHVlKSB7CiAgICAgICAgICBRUi5jYXB0Y2hhLnJlc2V0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgfQogICAgfSwKICAgIGRpYWxvZzogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBmaWxlSW5wdXQsIGlkLCBtaW1lVHlwZXMsIG5hbWUsIHNwb2lsZXIsIHRhLCB0aHJlYWQsIHRocmVhZHMsIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWYsIF9yZWYxOwogICAgICBRUi5lbCA9IFVJLmRpYWxvZygncXInLCAndG9wOjA7cmlnaHQ6MDsnLCAnXAo8ZGl2IGNsYXNzPW1vdmU+XAogIFF1aWNrIFJlcGx5IDxpbnB1dCB0eXBlPWNoZWNrYm94IGlkPWF1dG9oaWRlIHRpdGxlPUF1dG8taGlkZT5cCiAgPHNwYW4+IDxhIGNsYXNzPWNsb3NlIHRpdGxlPUNsb3NlPsOXPC9hPjwvc3Bhbj5cCjwvZGl2PlwKPGZvcm0+XAogIDxkaXY+PGlucHV0IGlkPWR1bXAgdHlwZT1idXR0b24gdGl0bGU9IkR1bXAgbGlzdCIgdmFsdWU9KyBjbGFzcz1maWVsZD48aW5wdXQgbmFtZT1uYW1lIHRpdGxlPU5hbWUgcGxhY2Vob2xkZXI9TmFtZSBjbGFzcz1maWVsZCBzaXplPTE+PGlucHV0IG5hbWU9ZW1haWwgdGl0bGU9RS1tYWlsIHBsYWNlaG9sZGVyPUUtbWFpbCBjbGFzcz1maWVsZCBzaXplPTE+PGlucHV0IG5hbWU9c3ViIHRpdGxlPVN1YmplY3QgcGxhY2Vob2xkZXI9U3ViamVjdCBjbGFzcz1maWVsZCBzaXplPTE+PC9kaXY+XAogIDxkaXYgaWQ9cmVwbGllcz48ZGl2PjxhIGlkPWFkZFJlcGx5IGhyZWY9amF2YXNjcmlwdDo7IHRpdGxlPSJBZGQgYSByZXBseSI+KzwvYT48L2Rpdj48L2Rpdj5cCiAgPGRpdiBjbGFzcz10ZXh0YXJlYT48dGV4dGFyZWEgbmFtZT1jb20gdGl0bGU9Q29tbWVudCBwbGFjZWhvbGRlcj1Db21tZW50IGNsYXNzPWZpZWxkIGlkPWNvbW1lbnRUZXh0QXJlYT48L3RleHRhcmVhPjxzcGFuIGlkPWNoYXJDb3VudD48L3NwYW4+PC9kaXY+XAogIDxkaXY+PGlucHV0IHR5cGU9ZmlsZSB0aXRsZT0iU2hpZnQrQ2xpY2sgdG8gcmVtb3ZlIHRoZSBzZWxlY3RlZCBmaWxlLiIgbXVsdGlwbGUgc2l6ZT0xNj48aW5wdXQgdHlwZT1zdWJtaXQgaWQ9InhfUVJfU3VibWl0Ij48L2Rpdj5cCiAgPGxhYmVsIGlkPXNwb2lsZXJMYWJlbD48aW5wdXQgdHlwZT1jaGVja2JveCBpZD1zcG9pbGVyPiBTcG9pbGVyIEltYWdlPC9sYWJlbD5cCiAgPGRpdiBjbGFzcz13YXJuaW5nPjwvZGl2PlwKPC9mb3JtPicpOwogICAgICBpZiAoQ29uZlsnUmVtZW1iZXIgUVIgc2l6ZSddICYmICQuZW5naW5lID09PSAnZ2Vja28nKSB7CiAgICAgICAgJC5vbih0YSA9ICQoJ3RleHRhcmVhJywgUVIuZWwpLCAnbW91c2V1cCcsIGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuICQuc2V0KCdRUi5zaXplJywgdGhpcy5zdHlsZS5jc3NUZXh0KTsKICAgICAgICB9KTsKICAgICAgICB0YS5zdHlsZS5jc3NUZXh0ID0gJC5nZXQoJ1FSLnNpemUnLCAnJyk7CiAgICAgIH0KICAgICAgZmlsZUlucHV0ID0gJCgnaW5wdXRbdHlwZT1maWxlXScsIFFSLmVsKTsKICAgICAgZmlsZUlucHV0Lm1heCA9ICQoJ2lucHV0W25hbWU9TUFYX0ZJTEVfU0laRV0nKS52YWx1ZTsKICAgICAgaWYgKCQuZW5naW5lICE9PSAncHJlc3RvJykgewogICAgICAgIGZpbGVJbnB1dC5hY2NlcHQgPSBtaW1lVHlwZXM7CiAgICAgIH0KICAgICAgUVIuc3BvaWxlciA9ICEhJCgnaW5wdXRbbmFtZT1zcG9pbGVyXScpOwogICAgICBzcG9pbGVyID0gJCgnI3Nwb2lsZXJMYWJlbCcsIFFSLmVsKTsKICAgICAgc3BvaWxlci5oaWRkZW4gPSAhUVIuc3BvaWxlcjsKICAgICAgUVIubWF4Q29tbWVudCA9IGcuQk9BUkQgPT09ICdqcCcgPyA1MDAwIDogMjAwMDsKICAgICAgUVIuY2hhcmFDb3VudGVyID0gJCgnI2NoYXJDb3VudCcsIFFSLmVsKTsKICAgICAgdGEgPSAkKCd0ZXh0YXJlYScsIFFSLmVsKTsKICAgICAgaWYgKCFnLlJFUExZKSB7CiAgICAgICAgdGhyZWFkcyA9ICc8b3B0aW9uIHZhbHVlPW5ldz5OZXcgdGhyZWFkPC9vcHRpb24+JzsKICAgICAgICBfcmVmID0gJCQoJy50aHJlYWQnKTsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIHRocmVhZCA9IF9yZWZbX2ldOwogICAgICAgICAgaWQgPSB0aHJlYWQuaWQuc2xpY2UoMSk7CiAgICAgICAgICB0aHJlYWRzICs9ICI8b3B0aW9uIHZhbHVlPSIgKyBpZCArICI+VGhyZWFkICIgKyBpZCArICI8L29wdGlvbj4iOwogICAgICAgIH0KICAgICAgICBRUi50aHJlYWRTZWxlY3RvciA9IGcuQk9BUkQgPT09ICdmJyA/ICQoJ3NlbGVjdFtuYW1lPWZpbGV0YWddJykuY2xvbmVOb2RlKHRydWUpIDogJC5lbCgnc2VsZWN0JywgewogICAgICAgICAgaW5uZXJIVE1MOiB0aHJlYWRzLAogICAgICAgICAgdGl0bGU6ICdDcmVhdGUgYSBuZXcgdGhyZWFkIC8gUmVwbHkgdG8gYSB0aHJlYWQnCiAgICAgICAgfSk7CiAgICAgICAgJC5wcmVwZW5kKCQoJy5tb3ZlID4gc3BhbicsIFFSLmVsKSwgUVIudGhyZWFkU2VsZWN0b3IpOwogICAgICAgICQub24oUVIudGhyZWFkU2VsZWN0b3IsICdtb3VzZWRvd24nLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICAkLm9uKCQoJyNhdXRvaGlkZScsIFFSLmVsKSwgJ2NoYW5nZScsIFFSLnRvZ2dsZUhpZGUpOwogICAgICAkLm9uKCQoJy5jbG9zZScsIFFSLmVsKSwgJ2NsaWNrJywgUVIuY2xvc2UpOwogICAgICAkLm9uKCQoJyNkdW1wJywgUVIuZWwpLCAnY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gUVIuZWwuY2xhc3NMaXN0LnRvZ2dsZSgnZHVtcCcpOwogICAgICB9KTsKICAgICAgJC5vbigkKCcjYWRkUmVwbHknLCBRUi5lbCksICdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBuZXcgUVIucmVwbHkoKS5zZWxlY3QoKTsKICAgICAgfSk7CiAgICAgICQub24oJCgnZm9ybScsIFFSLmVsKSwgJ3N1Ym1pdCcsIFFSLnN1Ym1pdCk7CiAgICAgICQub24odGEsICdpbnB1dCcsIGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBRUi5zZWxlY3RlZC5lbC5sYXN0Q2hpbGQudGV4dENvbnRlbnQgPSB0aGlzLnZhbHVlOwogICAgICB9KTsKICAgICAgJC5vbih0YSwgJ2lucHV0JywgUVIuY2hhcmFjdGVyQ291bnQpOwogICAgICAkLm9uKGZpbGVJbnB1dCwgJ2NoYW5nZScsIFFSLmZpbGVJbnB1dCk7CiAgICAgICQub24oZmlsZUlucHV0LCAnY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHsKICAgICAgICAgIHJldHVybiBRUi5zZWxlY3RlZC5ybUZpbGUoKSB8fCBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgJC5vbihzcG9pbGVyLmZpcnN0Q2hpbGQsICdjaGFuZ2UnLCBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gJCgnaW5wdXQnLCBRUi5zZWxlY3RlZC5lbCkuY2xpY2soKTsKICAgICAgfSk7CiAgICAgICQub24oJCgnLndhcm5pbmcnLCBRUi5lbCksICdjbGljaycsIFFSLmNsZWFuRXJyb3IpOwogICAgICBuZXcgUVIucmVwbHkoKS5zZWxlY3QoKTsKICAgICAgX3JlZjEgPSBbJ25hbWUnLCAnZW1haWwnLCAnc3ViJywgJ2NvbSddOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBuYW1lID0gX3JlZjFbX2pdOwogICAgICAgICQub24oJCgiW25hbWU9IiArIG5hbWUgKyAiXSIsIFFSLmVsKSwgJ2lucHV0JywgZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgX3JlZjI7CiAgICAgICAgICBRUi5zZWxlY3RlZFt0aGlzLm5hbWVdID0gdGhpcy52YWx1ZTsKICAgICAgICAgIGlmIChRUi5jb29sZG93bi5hdXRvICYmIFFSLnNlbGVjdGVkID09PSBRUi5yZXBsaWVzWzBdICYmICgwIDwgKF9yZWYyID0gUVIuY29vbGRvd24uc2Vjb25kcykgJiYgX3JlZjIgPD0gNSkpIHsKICAgICAgICAgICAgcmV0dXJuIFFSLmNvb2xkb3duLmF1dG8gPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgICBRUi5zdGF0dXMuaW5wdXQgPSAkKCdpbnB1dFt0eXBlPXN1Ym1pdF0nLCBRUi5lbCk7CiAgICAgIFFSLnN0YXR1cygpOwogICAgICBRUi5jb29sZG93bi5pbml0KCk7CiAgICAgIFFSLmNhcHRjaGEuaW5pdCgpOwogICAgICAkLmFkZChkLmJvZHksIFFSLmVsKTsKICAgICAgcmV0dXJuICQuZXZlbnQoJ1FSRGlhbG9nQ3JlYXRpb24nLCBudWxsLCBRUi5lbCk7CiAgICB9LAogICAgc3VibWl0OiBmdW5jdGlvbihlKSB7CiAgICAgIHZhciBjYWxsYmFja3MsIGVyciwgZmlsZXRhZywgbSwgb3B0cywgcG9zdCwgcmVwbHksIHJlc3BvbnNlLCB0ZXh0T25seSwgdGhyZWFkSUQ7CiAgICAgIGlmIChlICE9IG51bGwpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0KICAgICAgaWYgKFFSLmNvb2xkb3duLnNlY29uZHMpIHsKICAgICAgICBRUi5jb29sZG93bi5hdXRvID0gIVFSLmNvb2xkb3duLmF1dG87CiAgICAgICAgUVIuc3RhdHVzKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIFFSLmFib3J0KCk7CiAgICAgIHJlcGx5ID0gUVIucmVwbGllc1swXTsKICAgICAgaWYgKGcuQk9BUkQgPT09ICdmJyAmJiAhZy5SRVBMWSkgewogICAgICAgIGZpbGV0YWcgPSBRUi50aHJlYWRTZWxlY3Rvci52YWx1ZTsKICAgICAgICB0aHJlYWRJRCA9ICduZXcnOwogICAgICB9IGVsc2UgewogICAgICAgIHRocmVhZElEID0gZy5USFJFQURfSUQgfHwgUVIudGhyZWFkU2VsZWN0b3IudmFsdWU7CiAgICAgIH0KICAgICAgaWYgKHRocmVhZElEID09PSAnbmV3JykgewogICAgICAgIHRocmVhZElEID0gbnVsbDsKICAgICAgICBpZiAoZy5CT0FSRCA9PT0gJ3ZnJyAmJiAhcmVwbHkuc3ViKSB7CiAgICAgICAgICBlcnIgPSAnTmV3IHRocmVhZHMgcmVxdWlyZSBhIHN1YmplY3QuJzsKICAgICAgICB9IGVsc2UgaWYgKCEocmVwbHkuZmlsZSB8fCAodGV4dE9ubHkgPSAhISQoJ2lucHV0W25hbWU9dGV4dG9ubHldJywgJC5pZCgncG9zdEZvcm0nKSkpKSkgewogICAgICAgICAgZXJyID0gJ05vIGZpbGUgc2VsZWN0ZWQuJzsKICAgICAgICB9IGVsc2UgaWYgKGcuQk9BUkQgPT09ICdmJyAmJiBmaWxldGFnID09PSAnOTk5OScpIHsKICAgICAgICAgIGVyciA9ICdJbnZhbGlkIHRhZyBzcGVjaWZpZWQuJzsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIShyZXBseS5jb20gfHwgcmVwbHkuZmlsZSkpIHsKICAgICAgICBlcnIgPSAnTm8gZmlsZSBzZWxlY3RlZC4nOwogICAgICB9CiAgICAgIGlmIChRUi5jYXB0Y2hhLmlzRW5hYmxlZCAmJiAhZXJyKSB7CiAgICAgICAgcmVzcG9uc2UgPSBRUi5jYXB0Y2hhLmdldFJlc3BvbnNlKCk7CiAgICAgICAgaWYgKCFyZXNwb25zZSkgewogICAgICAgICAgZXJyID0gJ05vIHZhbGlkIGNhcHRjaGEuJzsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGVycikgewogICAgICAgIFFSLmNvb2xkb3duLmF1dG8gPSBmYWxzZTsKICAgICAgICBRUi5zdGF0dXMoKTsKICAgICAgICBRUi5lcnJvcihlcnIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBRUi5jbGVhbkVycm9yKCk7CiAgICAgIFFSLmNvb2xkb3duLmF1dG8gPSBRUi5yZXBsaWVzLmxlbmd0aCA+IDE7CiAgICAgIGlmIChDb25mWydBdXRvIEhpZGUgUVInXSAmJiAhUVIuY29vbGRvd24uYXV0bykgewogICAgICAgIFFSLmhpZGUoKTsKICAgICAgfQogICAgICBpZiAoIVFSLmNvb2xkb3duLmF1dG8gJiYgJC54KCdhbmNlc3Rvcjo6ZGl2W0BpZD0icXIiXScsIGQuYWN0aXZlRWxlbWVudCkpIHsKICAgICAgICBkLmFjdGl2ZUVsZW1lbnQuYmx1cigpOwogICAgICB9CiAgICAgIFFSLnN0YXR1cyh7CiAgICAgICAgcHJvZ3Jlc3M6ICcuLi4nCiAgICAgIH0pOwogICAgICBwb3N0ID0gewogICAgICAgIHJlc3RvOiB0aHJlYWRJRCwKICAgICAgICBuYW1lOiByZXBseS5uYW1lLAogICAgICAgIGVtYWlsOiByZXBseS5lbWFpbCwKICAgICAgICBzdWI6IHJlcGx5LnN1YiwKICAgICAgICBjb206IHJlcGx5LmNvbSwKICAgICAgICB1cGZpbGU6IHJlcGx5LmZpbGUsCiAgICAgICAgZmlsZXRhZzogZmlsZXRhZywKICAgICAgICBzcG9pbGVyOiByZXBseS5zcG9pbGVyLAogICAgICAgIHRleHRvbmx5OiB0ZXh0T25seSwKICAgICAgICBtb2RlOiAncmVnaXN0JywKICAgICAgICBwd2Q6IChtID0gZC5jb29raWUubWF0Y2goLzRjaGFuX3Bhc3M9KFteO10rKS8pKSA/IGRlY29kZVVSSUNvbXBvbmVudChtWzFdKSA6ICQoJ2lucHV0W25hbWU9cHdkXScpLnZhbHVlLAogICAgICB9OwogICAgICBpZiAoUVIuY2FwdGNoYS5pc0VuYWJsZWQpIHsKICAgICAgICBpZighQ29uZlsnQWx0ZXJuYXRpdmUgY2FwdGNoYSddIHx8ICghZy5SRVBMWSAmJiAhQ29uZlsnQWx0IGluZGV4IGNhcHRjaGEnXSkpIHsKICAgICAgICAgIHBvc3RbJ2ctcmVjYXB0Y2hhLXJlc3BvbnNlJ10gPSByZXNwb25zZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcG9zdFsncmVjYXB0Y2hhX3Jlc3BvbnNlX2ZpZWxkJ10gPSByZXNwb25zZTsKICAgICAgICAgIHBvc3RbJ3JlY2FwdGNoYV9jaGFsbGVuZ2VfZmllbGQnXSA9IFFSLmNhcHRjaGEuZ2V0Q2hhbGxlbmdlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIAogICAgICBjYWxsYmFja3MgPSB7CiAgICAgICAgb25sb2FkOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBRUi5yZXNwb25zZSh0aGlzLnJlc3BvbnNlKTsKICAgICAgICB9LAogICAgICAgIG9uZXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgICAgaWYgKFFSLmNhcHRjaGEuaXNFbmFibGVkKSB7CiAgICAgICAgICAgIFFSLmNhcHRjaGEucmVzZXQoKTsKICAgICAgICAgIH0KICAgICAgICAgIFFSLmNvb2xkb3duLmF1dG8gPSBmYWxzZTsKICAgICAgICAgIFFSLnN0YXR1cygpOwogICAgICAgICAgcmV0dXJuIFFSLmVycm9yKCQuZWwoJ2EnLCB7CiAgICAgICAgICAgIGhyZWY6ICcvL3d3dy40Y2hhbi5vcmcvYmFubmVkJywKICAgICAgICAgICAgdGFyZ2V0OiAnX2JsYW5rJywKICAgICAgICAgICAgdGV4dENvbnRlbnQ6ICdDb25uZWN0aW9uIGVycm9yLCBvciB5b3UgYXJlIGJhbm5lZC4nCiAgICAgICAgICB9KSk7CiAgICAgICAgfQogICAgICB9OwogICAgICBvcHRzID0gewogICAgICAgIGZvcm06ICQuZm9ybURhdGEocG9zdCksCiAgICAgICAgdXBDYWxsYmFja3M6IHsKICAgICAgICAgIG9ubG9hZDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBRUi5zdGF0dXMoewogICAgICAgICAgICAgIHByb2dyZXNzOiAnLi4uJwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0sCiAgICAgICAgICBvbnByb2dyZXNzOiBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHJldHVybiBRUi5zdGF0dXMoewogICAgICAgICAgICAgIHByb2dyZXNzOiAiIiArIChNYXRoLnJvdW5kKGUubG9hZGVkIC8gZS50b3RhbCAqIDEwMCkpICsgIiUiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIFFSLmFqYXggPSAkLmFqYXgoJC5pZCgncG9zdEZvcm0nKS5wYXJlbnROb2RlLmFjdGlvbiwgY2FsbGJhY2tzLCBvcHRzKTsKICAgIH0sCiAgICByZXNwb25zZTogZnVuY3Rpb24oaHRtbCkgewogICAgICB2YXIgYmFuLCBib2FyZCwgY2xvbmUsIGRvYywgZXJyLCBvYmosIHBlcnNvbmEsIHBvc3RJRCwgcmVwbHksIHRocmVhZElELCBfLCBfcmVmLCBfcmVmMTsKICAgICAgaWYgKFFSLmNhcHRjaGEuaXNFbmFibGVkKSB7CiAgICAgICAgUVIuY2FwdGNoYS5yZXNldCgpOwogICAgICB9CiAgICAgIGRvYyA9IGQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCcnKTsKICAgICAgZG9jLmRvY3VtZW50RWxlbWVudC5pbm5lckhUTUwgPSBodG1sOwogICAgICBpZiAoYmFuID0gJCgnLmJhblR5cGUnLCBkb2MpKSB7CiAgICAgICAgYm9hcmQgPSAkKCcuYm9hcmQnLCBkb2MpLmlubmVySFRNTDsKICAgICAgICBlcnIgPSAkLmVsKCdzcGFuJywgewogICAgICAgICAgaW5uZXJIVE1MOiBiYW4udGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKSA9PT0gJ2Jhbm5lZCcgPyAoIllvdSBhcmUgYmFubmVkIG9uICIgKyBib2FyZCArICIhIDtfOzxicj4iKSArICJDbGljayA8YSBocmVmPS8vd3d3LjRjaGFuLm9yZy9iYW5uZWQgdGFyZ2V0PV9ibGFuaz5oZXJlPC9hPiB0byBzZWUgdGhlIHJlYXNvbi4iIDogKCJZb3Ugd2VyZSBpc3N1ZWQgYSB3YXJuaW5nIG9uICIgKyBib2FyZCArICIgYXMgIiArICgkKCcubmFtZUJsb2NrJywgZG9jKS5pbm5lckhUTUwpICsgIi48YnI+IikgKyAoIlJlYXNvbjogIiArICgkKCcucmVhc29uJywgZG9jKS5pbm5lckhUTUwpKQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKGVyciA9IGRvYy5nZXRFbGVtZW50QnlJZCgnZXJybXNnJykpIHsKICAgICAgICBpZiAoKF9yZWYgPSAkKCdhJywgZXJyKSkgIT0gbnVsbCkgewogICAgICAgICAgX3JlZi50YXJnZXQgPSAnX2JsYW5rJzsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZG9jLnRpdGxlICE9PSAnUG9zdCBzdWNjZXNzZnVsIScpIHsKICAgICAgICBlcnIgPSAnQ29ubmVjdGlvbiBlcnJvciB3aXRoIHN5cy40Y2hhbi5vcmcuJzsKICAgICAgfQogICAgICBpZiAoZXJyKSB7CiAgICAgICAgaWYgKC9jYXB0Y2hhfHZlcmlmaWNhdGlvbi9pLnRlc3QoZXJyLnRleHRDb250ZW50KSB8fCBlcnIgPT09ICdDb25uZWN0aW9uIGVycm9yIHdpdGggc3lzLjRjaGFuLm9yZy4nKSB7CiAgICAgICAgICBpZiAoL21pc3R5cGVkL2kudGVzdChlcnIudGV4dENvbnRlbnQpKSB7CiAgICAgICAgICAgIGVyciA9ICdFcnJvcjogWW91IHNlZW0gdG8gaGF2ZSBtaXN0eXBlZCB0aGUgQ0FQVENIQS4nOwogICAgICAgICAgfQogICAgICAgICAgUVIuY29vbGRvd24uYXV0byA9IGZhbHNlOwogICAgICAgICAgUVIuY29vbGRvd24uc2V0KHsKICAgICAgICAgICAgZGVsYXk6IDIKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBRUi5jb29sZG93bi5hdXRvID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIFFSLnN0YXR1cygpOwogICAgICAgIFFSLmVycm9yKGVycik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJlcGx5ID0gUVIucmVwbGllc1swXTsKICAgICAgcGVyc29uYSA9ICQuZ2V0KCdRUi5wZXJzb25hJywge30pOwogICAgICBwZXJzb25hID0gewogICAgICAgIG5hbWU6IHJlcGx5Lm5hbWUsCiAgICAgICAgZW1haWw6IC9ec2FnZSQvLnRlc3QocmVwbHkuZW1haWwpID8gcGVyc29uYS5lbWFpbCA6IHJlcGx5LmVtYWlsLAogICAgICAgIHN1YjogQ29uZlsnUmVtZW1iZXIgU3ViamVjdCddID8gcmVwbHkuc3ViIDogbnVsbAogICAgICB9OwogICAgICAkLnNldCgnUVIucGVyc29uYScsIHBlcnNvbmEpOwogICAgICBfcmVmMSA9IGRvYy5ib2R5Lmxhc3RDaGlsZC50ZXh0Q29udGVudC5tYXRjaCgvdGhyZWFkOihcZCspLG5vOihcZCspLyksIF8gPSBfcmVmMVswXSwgdGhyZWFkSUQgPSBfcmVmMVsxXSwgcG9zdElEID0gX3JlZjFbMl07CiAgICAgIG9iaiA9IHtib2FyZElEOiBnLkJPQVJELCB0aHJlYWRJRDogdGhyZWFkSUQsIHBvc3RJRDogcG9zdElEfTsKICAgICAgY2xvbmUgPSAodHlwZW9mKGNsb25lSW50bykgPT09ICdmdW5jdGlvbicgJiYgY2xvbmVJbnRvKG9iaiwgZG9jdW1lbnQuZGVmYXVsdFZpZXcpKSB8fCBvYmo7CiAgICAgICQuZXZlbnQoJ1FSUG9zdFN1Y2Nlc3NmdWwnLCBjbG9uZSwgUVIuZWwpOwogICAgICAKICAgICAgLyogQWRkIHlvdXIgb3duIHJlcGxpZXMgdG8geW91clBvc3RzIGFuZCBzdG9yYWdlIHRvIHdhdGNoIGZvciByZXBsaWVzICovCiAgICAgIGlmIChDb25mWydJbmRpY2F0ZSBZb3UgcXVvdGUnXSkgewogICAgICAgIHlvdXJQb3N0cy5wdXNoKHBvc3RJRCk7CiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgneW91clBvc3RzJywgSlNPTi5zdHJpbmdpZnkoeW91clBvc3RzKSk7CiAgICAgIH0KICAgICAgCiAgICAgIFFSLmNvb2xkb3duLnNldCh7CiAgICAgICAgcG9zdDogcmVwbHksCiAgICAgICAgaXNSZXBseTogdGhyZWFkSUQgIT09ICcwJwogICAgICB9KTsKICAgICAgaWYgKHRocmVhZElEID09PSAnMCcpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGxvY2F0aW9uLnBhdGhuYW1lID0gIi8iICsgZy5CT0FSRCArICIvdGhyZWFkLyIgKyBwb3N0SUQ7CiAgICAgICAgfSwgMzAwMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgUVIuY29vbGRvd24uYXV0byA9IFFSLnJlcGxpZXMubGVuZ3RoID4gMTsKICAgICAgICBpZiAoQ29uZlsnT3BlbiBSZXBseSBpbiBOZXcgVGFiJ10gJiYgIWcuUkVQTFkgJiYgIVFSLmNvb2xkb3duLmF1dG8pIHsKICAgICAgICAgICQub3BlbigiLy9ib2FyZHMuNGNoYW4ub3JnLyIgKyBnLkJPQVJEICsgIi90aHJlYWQvIiArIHRocmVhZElEICsgIiNwIiArIHBvc3RJRCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChDb25mWydQZXJzaXN0ZW50IFFSJ10gfHwgUVIuY29vbGRvd24uYXV0bykgewogICAgICAgIHJlcGx5LnJtKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgUVIuY2xvc2UoKTsKICAgICAgfQogICAgICBRUi5zdGF0dXMoKTsKICAgICAgcmV0dXJuIFFSLnJlc2V0RmlsZUlucHV0KCk7CiAgICB9LAogICAgYWJvcnQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgX3JlZjsKICAgICAgaWYgKChfcmVmID0gUVIuYWpheCkgIT0gbnVsbCkgewogICAgICAgIF9yZWYuYWJvcnQoKTsKICAgICAgfQogICAgICBkZWxldGUgUVIuYWpheDsKICAgICAgcmV0dXJuIFFSLnN0YXR1cygpOwogICAgfQogIH07CgogIE9wdGlvbnMgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuICQucmVhZHkoT3B0aW9ucy5pbml0UmVhZHkpOwogICAgfSwKICAgIGluaXRSZWFkeTogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhLCBub3RpY2UsIHNldHRpbmc7CiAgICAgIGEgPSAkLmVsKCdhJywgewogICAgICAgIGhyZWY6ICdqYXZhc2NyaXB0OjsnLAogICAgICAgIGNsYXNzTmFtZTogJ3NldHRpbmdzV2luZG93TGluaycsCiAgICAgICAgdGV4dENvbnRlbnQ6ICc0Y2hhbiBYIFNldHRpbmdzJwogICAgICB9KTsKICAgICAgJC5vbihhLCAnY2xpY2snLCBPcHRpb25zLmRpYWxvZyk7CiAgICAgIHNldHRpbmcgPSAkLmlkKCduYXZ0b3ByaWdodCcpOwogICAgICBpZiAoQ29uZlsnRGlzYWJsZSA0Y2hhblwncyBleHRlbnNpb24nXSkgewogICAgICAgICQucmVwbGFjZShzZXR0aW5nLmZpcnN0RWxlbWVudENoaWxkLCBhKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkLnByZXBlbmQoc2V0dGluZywgWyQudG4oJ1snKSwgYSwgJC50bignXSAnKV0pOwogICAgICB9CiAgICAgIG5vdGljZSA9ICQuZWwoJ2EnLCB7CiAgICAgICAgdGV4dENvbnRlbnQ6ICd2MiBpcyBuZXZlciBvdXRkYXRlZC4nLAogICAgICAgIGhyZWY6ICdodHRwczovL2dpdGh1Yi5jb20vbG9hZGxldHRlci80Y2hhbi14JywKICAgICAgICB0YXJnZXQ6ICdfYmxhbmsnCiAgICAgIH0pOwogICAgICBub3RpY2Uuc3R5bGUuY29sb3IgPSAncmVkJzsKICAgICAgJC5wcmVwZW5kKHNldHRpbmcsIFskLnRuKCdbJyksIG5vdGljZSwgJC50bignXSAnKV0pOwogICAgICAkLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBuYXZib3RMaW5rID0gJCgnI25hdmJvdHJpZ2h0ID4gLnNldHRpbmdzV2luZG93TGluaycpOwogICAgICAgICAgaWYgKG5hdmJvdExpbmspIHsKICAgICAgICAgICAgJC5vbihuYXZib3RMaW5rLCAnY2xpY2snLCBPcHRpb25zLmRpYWxvZyk7CiAgICAgICAgICB9CiAgICAgICAgfSwgMCk7CiAgICAgIH0pOwogICAgICBpZiAoISQuZ2V0KCdmaXJzdHJ1bicpKSB7CiAgICAgICAgJC5zZXQoJ2ZpcnN0cnVuJywgdHJ1ZSk7CiAgICAgICAgaWYgKCFGYXZpY29uLmVsKSB7CiAgICAgICAgICBGYXZpY29uLmluaXQoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIE9wdGlvbnMuZGlhbG9nKCk7CiAgICAgIH0KICAgIH0sCiAgICBkaWFsb2c6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYXJyLCBiYWNrLCBjaGVja2VkLCBkZXNjcmlwdGlvbiwgZGlhbG9nLCBmYXZpY29uLCBmaWxlSW5mbywgZmlsdGVyLCBoaWRkZW5OdW0sIGhpZGRlblRocmVhZHMsIGluZGljYXRvciwgaW5kaWNhdG9ycywgaW5wdXQsIGtleSwgbGksIG9iaiwgb3ZlcmxheSwgc2F1Y2UsIHRpbWUsIHRyLCB1bCwgX2ksIF9sZW4sIF9yZWYsIF9yZWYxLCBfcmVmMjsKICAgICAgZGlhbG9nID0gJC5lbCgnZGl2JywgewogICAgICAgIGlkOiAnb3B0aW9ucycsCiAgICAgICAgY2xhc3NOYW1lOiAncmVwbHkgZGlhbG9nJywKICAgICAgICBpbm5lckhUTUw6ICc8ZGl2IGlkPW9wdGlvbnNiYXI+XAogIDxkaXYgaWQ9Y3JlZGl0cz5cCiAgICA8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9aHR0cHM6Ly9naXRodWIuY29tL2xvYWRsZXR0ZXIvNGNoYW4teD40Y2hhbiBYPC9hPlwKICAgIHwgPGEgdGFyZ2V0PV9ibGFuayBocmVmPWh0dHBzOi8vZ2l0aHViLmNvbS9sb2FkbGV0dGVyLzRjaGFuLXgvY29tbWl0cy9tYXN0ZXI+JyArIE1haW4udmVyc2lvbiArICc8L2E+XAogICAgfCA8YSB0YXJnZXQ9X2JsYW5rIGhyZWY9aHR0cHM6Ly9naXRodWIuY29tL2xvYWRsZXR0ZXIvNGNoYW4teC9pc3N1ZXM+SXNzdWVzPC9hPlwKICA8L2Rpdj5cCiAgPGRpdj5cCiAgICA8bGFiZWwgZm9yPW1haW5fdGFiPk1haW48L2xhYmVsPlwKICAgIHwgPGxhYmVsIGZvcj1maWx0ZXJfdGFiPkZpbHRlcjwvbGFiZWw+XAogICAgfCA8bGFiZWwgZm9yPXNhdWNlc190YWI+U2F1Y2U8L2xhYmVsPlwKICAgIHwgPGxhYmVsIGZvcj1yaWNlX3RhYj5SaWNlPC9sYWJlbD5cCiAgICB8IDxsYWJlbCBmb3I9a2V5YmluZHNfdGFiPktleWJpbmRzPC9sYWJlbD5cCiAgPC9kaXY+XAo8L2Rpdj5cCjxocj5cCjxkaXYgaWQ9Y29udGVudD5cCiAgPGlucHV0IHR5cGU9cmFkaW8gbmFtZT10YWIgaGlkZGVuIGlkPW1haW5fdGFiIGNoZWNrZWQ+XAogIDxkaXY+XAogICAgPGRpdiBjbGFzcz1pbXAtZXhwPlwKICAgICAgPGJ1dHRvbiBjbGFzcz1leHBvcnQ+RXhwb3J0IHNldHRpbmdzPC9idXR0b24+XAogICAgICA8YnV0dG9uIGNsYXNzPWltcG9ydD5JbXBvcnQgc2V0dGluZ3M8L2J1dHRvbj5cCiAgICAgIDxpbnB1dCB0eXBlPWZpbGUgc3R5bGU9InZpc2liaWxpdHk6aGlkZGVuIj5cCiAgICA8L2Rpdj5cCiAgICA8cCBjbGFzcz1pbXAtZXhwLXJlc3VsdD48L3A+XAogIDwvZGl2PlwKICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPXRhYiBoaWRkZW4gaWQ9c2F1Y2VzX3RhYj5cCiAgPGRpdj5cCiAgICA8ZGl2IGNsYXNzPXdhcm5pbmc+PGNvZGU+U2F1Y2U8L2NvZGU+IGlzIGRpc2FibGVkLjwvZGl2PlwKICAgIExpbmVzIHN0YXJ0aW5nIHdpdGggYSA8Y29kZT4jPC9jb2RlPiB3aWxsIGJlIGlnbm9yZWQuPGJyPlwKICAgIFlvdSBjYW4gc3BlY2lmeSBhIGNlcnRhaW4gZGlzcGxheSB0ZXh0IGJ5IGFwcGVuZGluZyA8Y29kZT47dGV4dDpbdGV4dF08L2NvZGU+IHRvIHRoZSB1cmwuXAogICAgPHVsPlRoZXNlIHBhcmFtZXRlcnMgd2lsbCBiZSByZXBsYWNlZCBieSB0aGVpciBjb3JyZXNwb25kaW5nIHZhbHVlczpcCiAgICAgIDxsaT4kMTogVGh1bWJuYWlsIHVybC48L2xpPlwKICAgICAgPGxpPiQyOiBGdWxsIGltYWdlIHVybC48L2xpPlwKICAgICAgPGxpPiQzOiBNRDUgaGFzaC48L2xpPlwKICAgICAgPGxpPiQ0OiBDdXJyZW50IGJvYXJkLjwvbGk+XAogICAgPC91bD5cCiAgICA8dGV4dGFyZWEgbmFtZT1zYXVjZXMgaWQ9c2F1Y2VzIGNsYXNzPWZpZWxkPjwvdGV4dGFyZWE+XAogIDwvZGl2PlwKICA8aW5wdXQgdHlwZT1yYWRpbyBuYW1lPXRhYiBoaWRkZW4gaWQ9ZmlsdGVyX3RhYj5cCiAgPGRpdj5cCiAgICA8ZGl2IGNsYXNzPXdhcm5pbmc+PGNvZGU+RmlsdGVyPC9jb2RlPiBpcyBkaXNhYmxlZC48L2Rpdj5cCiAgICA8c2VsZWN0IG5hbWU9ZmlsdGVyPlwKICAgICAgPG9wdGlvbiB2YWx1ZT1ndWlkZT5HdWlkZTwvb3B0aW9uPlwKICAgICAgPG9wdGlvbiB2YWx1ZT1uYW1lPk5hbWU8L29wdGlvbj5cCiAgICAgIDxvcHRpb24gdmFsdWU9cGFzcz5QYXNzIFVzZXI8L29wdGlvbj5cCiAgICAgIDxvcHRpb24gdmFsdWU9dW5pcXVlaWQ+VW5pcXVlIElEPC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPXRyaXBjb2RlPlRyaXBjb2RlPC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPW1vZD5BZG1pbi9Nb2Q8L29wdGlvbj5cCiAgICAgIDxvcHRpb24gdmFsdWU9c3ViamVjdD5TdWJqZWN0PC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPWNvbW1lbnQ+Q29tbWVudDwvb3B0aW9uPlwKICAgICAgPG9wdGlvbiB2YWx1ZT1jb3VudHJ5PkNvdW50cnk8L29wdGlvbj5cCiAgICAgIDxvcHRpb24gdmFsdWU9ZmlsZW5hbWU+RmlsZW5hbWU8L29wdGlvbj5cCiAgICAgIDxvcHRpb24gdmFsdWU9ZGltZW5zaW9ucz5JbWFnZSBkaW1lbnNpb25zPC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPWZpbGVzaXplPkZpbGVzaXplPC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPW1kNT5JbWFnZSBNRDUgKHVzZXMgZXhhY3Qgc3RyaW5nIG1hdGNoaW5nLCBub3QgcmVndWxhciBleHByZXNzaW9ucyk8L29wdGlvbj5cCiAgICA8L3NlbGVjdD5cCiAgPC9kaXY+XAogIDxpbnB1dCB0eXBlPXJhZGlvIG5hbWU9dGFiIGhpZGRlbiBpZD1yaWNlX3RhYj5cCiAgPGRpdj5cCiAgICA8ZGl2IGNsYXNzPXdhcm5pbmc+PGNvZGU+UXVvdGUgQmFja2xpbmtzPC9jb2RlPiBhcmUgZGlzYWJsZWQuPC9kaXY+XAogICAgPHVsPlwKICAgICAgQmFja2xpbmsgZm9ybWF0dGluZ1wKICAgICAgPGxpPjxpbnB1dCBuYW1lPWJhY2tsaW5rIGNsYXNzPWZpZWxkPiA6IDxzcGFuIGlkPWJhY2tsaW5rUHJldmlldz48L3NwYW4+PC9saT5cCiAgICA8L3VsPlwKICAgIDxkaXYgY2xhc3M9d2FybmluZz48Y29kZT5UaW1lIEZvcm1hdHRpbmc8L2NvZGU+IGlzIGRpc2FibGVkLjwvZGl2PlwKICAgIDx1bD5cCiAgICAgIFRpbWUgZm9ybWF0dGluZ1wKICAgICAgPGxpPjxpbnB1dCBuYW1lPXRpbWUgY2xhc3M9ZmllbGQ+IDogPHNwYW4gaWQ9dGltZVByZXZpZXc+PC9zcGFuPjwvbGk+XAogICAgICA8bGk+U3VwcG9ydGVkIDxhIGhyZWY9aHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9EYXRlXyUyOFVuaXglMjkjRm9ybWF0dGluZz5mb3JtYXQgc3BlY2lmaWVyczwvYT46PC9saT5cCiAgICAgIDxsaT5EYXk6ICVhLCAlQSwgJWQsICVlPC9saT5cCiAgICAgIDxsaT5Nb250aDogJW0sICViLCAlQjwvbGk+XAogICAgICA8bGk+WWVhcjogJXk8L2xpPlwKICAgICAgPGxpPkhvdXI6ICVrLCAlSCwgJWwgKGxvd2VyY2FzZSBMKSwgJUkgKHVwcGVyY2FzZSBpKSwgJXAsICVQPC9saT5cCiAgICAgIDxsaT5NaW51dGVzOiAlTTwvbGk+XAogICAgICA8bGk+U2Vjb25kczogJVM8L2xpPlwKICAgIDwvdWw+XAogICAgPGRpdiBjbGFzcz13YXJuaW5nPjxjb2RlPkZpbGUgSW5mbyBGb3JtYXR0aW5nPC9jb2RlPiBpcyBkaXNhYmxlZC48L2Rpdj5cCiAgICA8dWw+XAogICAgICBGaWxlIEluZm8gRm9ybWF0dGluZ1wKICAgICAgPGxpPjxpbnB1dCBuYW1lPWZpbGVJbmZvIGNsYXNzPWZpZWxkPiA6IDxzcGFuIGlkPWZpbGVJbmZvUHJldmlldyBjbGFzcz1maWxlVGV4dD48L3NwYW4+PC9saT5cCiAgICAgIDxsaT5MaW5rOiAlbCAobG93ZXJjYXNlIEwsIHRydW5jYXRlZCksICVMICh1bnRydW5jYXRlZCksICVUIChVbml4IHRpbWVzdGFtcCk8L2xpPlwKICAgICAgPGxpPk9yaWdpbmFsIGZpbGUgbmFtZTogJW4gKHRydW5jYXRlZCksICVOICh1bnRydW5jYXRlZCksICV0IChVbml4IHRpbWVzdGFtcCk8L2xpPlwKICAgICAgPGxpPlNwb2lsZXIgaW5kaWNhdG9yOiAlcDwvbGk+XAogICAgICA8bGk+U2l6ZTogJUIgKEJ5dGVzKSwgJUsgKEtCKSwgJU0gKE1CKSwgJXMgKDRjaGFuIGRlZmF1bHQpPC9saT5cCiAgICAgIDxsaT5SZXNvbHV0aW9uOiAlciAoRGlzcGxheXMgUERGIG9uIC9wby8sIGZvciBQREZzKTwvbGk+XAogICAgPC91bD5cCiAgICA8ZGl2IGNsYXNzPXdhcm5pbmc+PGNvZGU+VW5yZWFkIEZhdmljb248L2NvZGU+IGlzIGRpc2FibGVkLjwvZGl2PlwKICAgIFVucmVhZCBmYXZpY29uczxicj5cCiAgICA8c2VsZWN0IG5hbWU9ZmF2aWNvbj5cCiAgICAgIDxvcHRpb24gdmFsdWU9ZmVyb25ncj5mZXJvbmdyPC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPXhhdC0+eGF0LTwvb3B0aW9uPlwKICAgICAgPG9wdGlvbiB2YWx1ZT1NYXloZW0+TWF5aGVtPC9vcHRpb24+XAogICAgICA8b3B0aW9uIHZhbHVlPU9yaWdpbmFsPk9yaWdpbmFsPC9vcHRpb24+XAogICAgPC9zZWxlY3Q+XAogICAgPHNwYW4+PC9zcGFuPlwKICA8L2Rpdj5cCiAgPGlucHV0IHR5cGU9cmFkaW8gbmFtZT10YWIgaGlkZGVuIGlkPWtleWJpbmRzX3RhYj5cCiAgPGRpdj5cCiAgICA8ZGl2IGNsYXNzPXdhcm5pbmc+PGNvZGU+S2V5YmluZHM8L2NvZGU+IGFyZSBkaXNhYmxlZC48L2Rpdj5cCiAgICA8ZGl2PkFsbG93ZWQga2V5czogQ3RybCwgQWx0LCBNZXRhLCBhLXosIEEtWiwgMC05LCBVcCwgRG93biwgUmlnaHQsIExlZnQuPC9kaXY+XAogICAgPHRhYmxlPjx0Ym9keT5cCiAgICAgIDx0cj48dGg+QWN0aW9uczwvdGg+PHRoPktleWJpbmRzPC90aD48L3RyPlwKICAgIDwvdGJvZHk+PC90YWJsZT5cCiAgPC9kaXY+XAo8L2Rpdj4nCiAgICAgIH0pOwogICAgICAkLm9uKCQoJyNtYWluX3RhYiArIGRpdiAuZXhwb3J0JywgZGlhbG9nKSwgJ2NsaWNrJywgT3B0aW9uc1siZXhwb3J0Il0pOwogICAgICAkLm9uKCQoJyNtYWluX3RhYiArIGRpdiAuaW1wb3J0JywgZGlhbG9nKSwgJ2NsaWNrJywgT3B0aW9uc1siaW1wb3J0Il0pOwogICAgICAkLm9uKCQoJyNtYWluX3RhYiArIGRpdiBpbnB1dCcsIGRpYWxvZyksICdjaGFuZ2UnLCBPcHRpb25zLm9uSW1wb3J0KTsKICAgICAgX3JlZiA9IENvbmZpZy5tYWluOwogICAgICBmb3IgKGtleSBpbiBfcmVmKSB7CiAgICAgICAgb2JqID0gX3JlZltrZXldOwogICAgICAgIHVsID0gJC5lbCgndWwnLCB7CiAgICAgICAgICB0ZXh0Q29udGVudDoga2V5CiAgICAgICAgfSk7CiAgICAgICAgZm9yIChrZXkgaW4gb2JqKSB7CiAgICAgICAgICBhcnIgPSBvYmpba2V5XTsKICAgICAgICAgIGNoZWNrZWQgPSAkLmdldChrZXksIENvbmZba2V5XSkgPyAnY2hlY2tlZCcgOiAnJzsKICAgICAgICAgIGRlc2NyaXB0aW9uID0gYXJyWzFdOwogICAgICAgICAgbGkgPSAkLmVsKCdsaScsIHsKICAgICAgICAgICAgaW5uZXJIVE1MOiAiPGxhYmVsPjxpbnB1dCB0eXBlPWNoZWNrYm94IG5hbWU9XCIiICsga2V5ICsgIlwiICIgKyBjaGVja2VkICsgIj4iICsga2V5ICsgIjwvbGFiZWw+PHNwYW4gY2xhc3M9ZGVzY3JpcHRpb24+OiAiICsgZGVzY3JpcHRpb24gKyAiPC9zcGFuPiIKICAgICAgICAgIH0pOwogICAgICAgICAgJC5vbigkKCdpbnB1dCcsIGxpKSwgJ2NsaWNrJywgJC5jYi5jaGVja2VkKTsKICAgICAgICAgICQuYWRkKHVsLCBsaSk7CiAgICAgICAgfQogICAgICAgICQuYWRkKCQoJyNtYWluX3RhYiArIGRpdicsIGRpYWxvZyksIHVsKTsKICAgICAgfQogICAgICBoaWRkZW5UaHJlYWRzID0gJC5nZXQoImhpZGRlblRocmVhZHMvIiArIGcuQk9BUkQgKyAiLyIsIHt9KTsKICAgICAgaGlkZGVuTnVtID0gT2JqZWN0LmtleXMoZy5oaWRkZW5SZXBsaWVzKS5sZW5ndGggKyBPYmplY3Qua2V5cyhoaWRkZW5UaHJlYWRzKS5sZW5ndGg7CiAgICAgIGxpID0gJC5lbCgnbGknLCB7CiAgICAgICAgaW5uZXJIVE1MOiAiPGJ1dHRvbj5oaWRkZW46ICIgKyBoaWRkZW5OdW0gKyAiPC9idXR0b24+IDxzcGFuIGNsYXNzPWRlc2NyaXB0aW9uPjogRm9yZ2V0IGFsbCBoaWRkZW4gcG9zdHMuIFVzZWZ1bCBpZiB5b3UgYWNjaWRlbnRhbGx5IGhpZGUgYSBwb3N0IGFuZCBoYXZlIFwiU2hvdyBTdHVic1wiIGRpc2FibGVkLiIKICAgICAgfSk7CiAgICAgICQub24oJCgnYnV0dG9uJywgbGkpLCAnY2xpY2snLCBPcHRpb25zLmNsZWFySGlkZGVuKTsKICAgICAgJC5hZGQoJCgndWw6bnRoLWNoaWxkKDIpJywgZGlhbG9nKSwgbGkpOwogICAgICBmaWx0ZXIgPSAkKCdzZWxlY3RbbmFtZT1maWx0ZXJdJywgZGlhbG9nKTsKICAgICAgJC5vbihmaWx0ZXIsICdjaGFuZ2UnLCBPcHRpb25zLmZpbHRlcik7CiAgICAgIHNhdWNlID0gJCgnI3NhdWNlcycsIGRpYWxvZyk7CiAgICAgIHNhdWNlLnZhbHVlID0gJC5nZXQoc2F1Y2UubmFtZSwgQ29uZltzYXVjZS5uYW1lXSk7CiAgICAgICQub24oc2F1Y2UsICdjaGFuZ2UnLCAkLmNiLnZhbHVlKTsKICAgICAgKGJhY2sgPSAkKCdbbmFtZT1iYWNrbGlua10nLCBkaWFsb2cpKS52YWx1ZSA9ICQuZ2V0KCdiYWNrbGluaycsIENvbmZbJ2JhY2tsaW5rJ10pOwogICAgICAodGltZSA9ICQoJ1tuYW1lPXRpbWVdJywgZGlhbG9nKSkudmFsdWUgPSAkLmdldCgndGltZScsIENvbmZbJ3RpbWUnXSk7CiAgICAgIChmaWxlSW5mbyA9ICQoJ1tuYW1lPWZpbGVJbmZvXScsIGRpYWxvZykpLnZhbHVlID0gJC5nZXQoJ2ZpbGVJbmZvJywgQ29uZlsnZmlsZUluZm8nXSk7CiAgICAgICQub24oYmFjaywgJ2lucHV0JywgJC5jYi52YWx1ZSk7CiAgICAgICQub24oYmFjaywgJ2lucHV0JywgT3B0aW9ucy5iYWNrbGluayk7CiAgICAgICQub24odGltZSwgJ2lucHV0JywgJC5jYi52YWx1ZSk7CiAgICAgICQub24odGltZSwgJ2lucHV0JywgT3B0aW9ucy50aW1lKTsKICAgICAgJC5vbihmaWxlSW5mbywgJ2lucHV0JywgJC5jYi52YWx1ZSk7CiAgICAgICQub24oZmlsZUluZm8sICdpbnB1dCcsIE9wdGlvbnMuZmlsZUluZm8pOwogICAgICBmYXZpY29uID0gJCgnc2VsZWN0W25hbWU9ZmF2aWNvbl0nLCBkaWFsb2cpOwogICAgICBmYXZpY29uLnZhbHVlID0gJC5nZXQoJ2Zhdmljb24nLCBDb25mWydmYXZpY29uJ10pOwogICAgICAkLm9uKGZhdmljb24sICdjaGFuZ2UnLCAkLmNiLnZhbHVlKTsKICAgICAgJC5vbihmYXZpY29uLCAnY2hhbmdlJywgT3B0aW9ucy5mYXZpY29uKTsKICAgICAgX3JlZjEgPSBDb25maWcuaG90a2V5czsKICAgICAgZm9yIChrZXkgaW4gX3JlZjEpIHsKICAgICAgICBhcnIgPSBfcmVmMVtrZXldOwogICAgICAgIHRyID0gJC5lbCgndHInLCB7CiAgICAgICAgICBpbm5lckhUTUw6ICI8dGQ+IiArIGFyclsxXSArICI8L3RkPjx0ZD48aW5wdXQgbmFtZT0iICsga2V5ICsgIiBjbGFzcz1maWVsZD48L3RkPiIKICAgICAgICB9KTsKICAgICAgICBpbnB1dCA9ICQoJ2lucHV0JywgdHIpOwogICAgICAgIGlucHV0LnZhbHVlID0gJC5nZXQoa2V5LCBDb25mW2tleV0pOwogICAgICAgICQub24oaW5wdXQsICdrZXlkb3duJywgT3B0aW9ucy5rZXliaW5kKTsKICAgICAgICAkLmFkZCgkKCcja2V5YmluZHNfdGFiICsgZGl2IHRib2R5JywgZGlhbG9nKSwgdHIpOwogICAgICB9CiAgICAgIGluZGljYXRvcnMgPSB7fTsKICAgICAgX3JlZjIgPSAkJCgnLndhcm5pbmcnLCBkaWFsb2cpOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYyLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgaW5kaWNhdG9yID0gX3JlZjJbX2ldOwogICAgICAgIGtleSA9IGluZGljYXRvci5maXJzdENoaWxkLnRleHRDb250ZW50OwogICAgICAgIGluZGljYXRvci5oaWRkZW4gPSAkLmdldChrZXksIENvbmZba2V5XSk7CiAgICAgICAgaW5kaWNhdG9yc1trZXldID0gaW5kaWNhdG9yOwogICAgICAgICQub24oJCgiW25hbWU9JyIgKyBrZXkgKyAiJ10iLCBkaWFsb2cpLCAnY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBpbmRpY2F0b3JzW3RoaXMubmFtZV0uaGlkZGVuID0gdGhpcy5jaGVja2VkOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIG92ZXJsYXkgPSAkLmVsKCdkaXYnLCB7CiAgICAgICAgaWQ6ICdvdmVybGF5JwogICAgICB9KTsKICAgICAgJC5vbihvdmVybGF5LCAnY2xpY2snLCBPcHRpb25zLmNsb3NlKTsKICAgICAgJC5vbihkaWFsb2csICdjbGljaycsIGZ1bmN0aW9uKGUpIHsKICAgICAgICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgfSk7CiAgICAgICQuYWRkKG92ZXJsYXksIGRpYWxvZyk7CiAgICAgICQuYWRkKGQuYm9keSwgb3ZlcmxheSk7CiAgICAgIGQuYm9keS5zdHlsZS5zZXRQcm9wZXJ0eSgnd2lkdGgnLCAiIiArIGQuYm9keS5jbGllbnRXaWR0aCArICJweCIsIG51bGwpOwogICAgICAkLmFkZENsYXNzKGQuYm9keSwgJ3Vuc2Nyb2xsJyk7CiAgICAgIE9wdGlvbnMuZmlsdGVyLmNhbGwoZmlsdGVyKTsKICAgICAgT3B0aW9ucy5iYWNrbGluay5jYWxsKGJhY2spOwogICAgICBPcHRpb25zLnRpbWUuY2FsbCh0aW1lKTsKICAgICAgT3B0aW9ucy5maWxlSW5mby5jYWxsKGZpbGVJbmZvKTsKICAgICAgcmV0dXJuIE9wdGlvbnMuZmF2aWNvbi5jYWxsKGZhdmljb24pOwogICAgfSwKICAgIGNsb3NlOiBmdW5jdGlvbigpIHsKICAgICAgJC5ybSh0aGlzKTsKICAgICAgZC5ib2R5LnN0eWxlLnJlbW92ZVByb3BlcnR5KCd3aWR0aCcpOwogICAgICByZXR1cm4gJC5ybUNsYXNzKGQuYm9keSwgJ3Vuc2Nyb2xsJyk7CiAgICB9LAogICAgY2xlYXJIaWRkZW46IGZ1bmN0aW9uKCkgewogICAgICAkWyJkZWxldGUiXSgiaGlkZGVuUmVwbGllcy8iICsgZy5CT0FSRCArICIvIik7CiAgICAgICRbImRlbGV0ZSJdKCJoaWRkZW5UaHJlYWRzLyIgKyBnLkJPQVJEICsgIi8iKTsKICAgICAgdGhpcy50ZXh0Q29udGVudCA9ICJoaWRkZW46IDAiOwogICAgICByZXR1cm4gZy5oaWRkZW5SZXBsaWVzID0ge307CiAgICB9LAogICAga2V5YmluZDogZnVuY3Rpb24oZSkgewogICAgICB2YXIga2V5OwogICAgICBpZiAoZS5rZXlDb2RlID09PSA5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgaWYgKChrZXkgPSBLZXliaW5kcy5rZXlDb2RlKGUpKSA9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMudmFsdWUgPSBrZXk7CiAgICAgIHJldHVybiAkLmNiLnZhbHVlLmNhbGwodGhpcyk7CiAgICB9LAogICAgZmlsdGVyOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGVsLCBuYW1lLCB0YTsKICAgICAgZWwgPSB0aGlzLm5leHRTaWJsaW5nOwogICAgICBpZiAoKG5hbWUgPSB0aGlzLnZhbHVlKSAhPT0gJ2d1aWRlJykgewogICAgICAgIHRhID0gJC5lbCgndGV4dGFyZWEnLCB7CiAgICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgICAgY2xhc3NOYW1lOiAnZmllbGQnLAogICAgICAgICAgdmFsdWU6ICQuZ2V0KG5hbWUsIENvbmZbbmFtZV0pCiAgICAgICAgfSk7CiAgICAgICAgJC5vbih0YSwgJ2NoYW5nZScsICQuY2IudmFsdWUpOwogICAgICAgICQucmVwbGFjZShlbCwgdGEpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoZWwpIHsKICAgICAgICAkLnJtKGVsKTsKICAgICAgfQogICAgICByZXR1cm4gJC5hZnRlcih0aGlzLCAkLmVsKCdhcnRpY2xlJywgewogICAgICAgIGlubmVySFRNTDogJzxwPlVzZSA8YSBocmVmPWh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvR3VpZGUvUmVndWxhcl9FeHByZXNzaW9ucz5yZWd1bGFyIGV4cHJlc3Npb25zPC9hPiwgb25lIHBlciBsaW5lLjxicj5cCiAgTGluZXMgc3RhcnRpbmcgd2l0aCBhIDxjb2RlPiM8L2NvZGU+IHdpbGwgYmUgaWdub3JlZC48YnI+XAogIEZvciBleGFtcGxlLCA8Y29kZT4vd2VlYWJvby9pPC9jb2RlPiB3aWxsIGZpbHRlciBwb3N0cyBjb250YWluaW5nIHRoZSBzdHJpbmcgYDxjb2RlPndlZWFib288L2NvZGU+YCwgY2FzZS1pbnNlbnNpdGl2ZS48L3A+XAogIDx1bD5Zb3UgY2FuIHVzZSB0aGVzZSBzZXR0aW5ncyB3aXRoIGVhY2ggcmVndWxhciBleHByZXNzaW9uLCBzZXBhcmF0ZSB0aGVtIHdpdGggc2VtaWNvbG9uczpcCiAgICA8bGk+XAogICAgICBQZXIgYm9hcmRzLCBzZXBhcmF0ZSB0aGVtIHdpdGggY29tbWFzLiBJdCBpcyBnbG9iYWwgaWYgbm90IHNwZWNpZmllZC48YnI+XAogICAgICBGb3IgZXhhbXBsZTogPGNvZGU+Ym9hcmRzOmEsanA7PC9jb2RlPi5cCiAgICA8L2xpPlwKICAgIDxsaT5cCiAgICAgIEZpbHRlciBPUHMgb25seSBhbG9uZyB3aXRoIHRoZWlyIHRocmVhZHMgKGBvbmx5YCksIHJlcGxpZXMgb25seSAoYG5vYCwgdGhpcyBpcyBkZWZhdWx0KSwgb3IgYm90aCAoYHllc2ApLjxicj5cCiAgICAgIEZvciBleGFtcGxlOiA8Y29kZT5vcDpvbmx5OzwvY29kZT4sIDxjb2RlPm9wOm5vOzwvY29kZT4gb3IgPGNvZGU+b3A6eWVzOzwvY29kZT4uXAogICAgPC9saT5cCiAgICA8bGk+XAogICAgICBPdmVycnVsZSB0aGUgYFNob3cgU3R1YnNgIHNldHRpbmcgaWYgc3BlY2lmaWVkOiBjcmVhdGUgYSBzdHViIChgeWVzYCkgb3Igbm90IChgbm9gKS48YnI+XAogICAgICBGb3IgZXhhbXBsZTogPGNvZGU+c3R1Yjp5ZXM7PC9jb2RlPiBvciA8Y29kZT5zdHViOm5vOzwvY29kZT4uXAogICAgPC9saT5cCiAgICA8bGk+XAogICAgICBIaWdobGlnaHQgaW5zdGVhZCBvZiBoaWRpbmcuIFlvdSBjYW4gc3BlY2lmeSBhIGNsYXNzIG5hbWUgdG8gdXNlIHdpdGggYSB1c2Vyc3R5bGUuPGJyPlwKICAgICAgRm9yIGV4YW1wbGU6IDxjb2RlPmhpZ2hsaWdodDs8L2NvZGU+IG9yIDxjb2RlPmhpZ2hsaWdodDp3YWxscGFwZXI7PC9jb2RlPi5cCiAgICA8L2xpPlwKICAgIDxsaT5cCiAgICAgIEhpZ2hsaWdodGVkIE9QcyB3aWxsIGhhdmUgdGhlaXIgdGhyZWFkcyBwdXQgb24gdG9wIG9mIGJvYXJkIHBhZ2VzIGJ5IGRlZmF1bHQuPGJyPlwKICAgICAgRm9yIGV4YW1wbGU6IDxjb2RlPnRvcDp5ZXM7PC9jb2RlPiBvciA8Y29kZT50b3A6bm87PC9jb2RlPi5cCiAgICA8L2xpPlwKICA8L3VsPicKICAgICAgfSkpOwogICAgfSwKICAgIHRpbWU6IGZ1bmN0aW9uKCkgewogICAgICBUaW1lLmRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICByZXR1cm4gJC5pZCgndGltZVByZXZpZXcnKS50ZXh0Q29udGVudCA9IFRpbWUuZnVuaygpOwogICAgfSwKICAgIGJhY2tsaW5rOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuICQuaWQoJ2JhY2tsaW5rUHJldmlldycpLnRleHRDb250ZW50ID0gQ29uZlsnYmFja2xpbmsnXS5yZXBsYWNlKC8laWQvLCAnMTIzNDU2Nzg5Jyk7CiAgICB9LAogICAgZmlsZUluZm86IGZ1bmN0aW9uKCkgewogICAgICBGaWxlSW5mby5kYXRhID0gewogICAgICAgIGxpbms6ICcvL2kuNGNkbi5vcmcvZy8xMzM0NDM3NzIzNzIwLmpwZycsCiAgICAgICAgc3BvaWxlcjogdHJ1ZSwKICAgICAgICBzaXplOiAnMjc2JywKICAgICAgICB1bml0OiAnS0InLAogICAgICAgIHJlc29sdXRpb246ICcxMjgweDcyMCcsCiAgICAgICAgZnVsbG5hbWU6ICdkOWJiMmVmYzk4ZGQwZGYxNDFhOTQzOTlmZjU4ODBiNy5qcGcnLAogICAgICAgIHNob3J0bmFtZTogJ2Q5YmIyZWZjOThkZDBkZjE0MWE5NDM5OWZmNTg4MCguLi4pLmpwZycKICAgICAgfTsKICAgICAgcmV0dXJuICQuaWQoJ2ZpbGVJbmZvUHJldmlldycpLmlubmVySFRNTCA9IEZpbGVJbmZvLmZ1bmsoKTsKICAgIH0sCiAgICBmYXZpY29uOiBmdW5jdGlvbigpIHsKICAgICAgRmF2aWNvblsic3dpdGNoIl0oKTsKICAgICAgVW5yZWFkLnVwZGF0ZSh0cnVlKTsKICAgICAgcmV0dXJuIHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nLmlubmVySFRNTCA9ICI8aW1nIHNyYz0iICsgRmF2aWNvbi51bnJlYWRTRlcgKyAiPiA8aW1nIHNyYz0iICsgRmF2aWNvbi51bnJlYWROU0ZXICsgIj4gPGltZyBzcmM9IiArIEZhdmljb24udW5yZWFkRGVhZCArICI+IjsKICAgIH0sCiAgICAiZXhwb3J0IjogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhLCBkYXRhLCBub3csIG91dHB1dDsKICAgICAgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgZGF0YSA9IHsKICAgICAgICB2ZXJzaW9uOiBNYWluLnZlcnNpb24sCiAgICAgICAgZGF0ZTogbm93LAogICAgICAgIENvbmY6IENvbmYsCiAgICAgICAgV2F0Y2hlZFRocmVhZHM6ICQuZ2V0KCd3YXRjaGVkJywge30pCiAgICAgIH07CiAgICAgIGEgPSAkLmVsKCdhJywgewogICAgICAgIGNsYXNzTmFtZTogJ3dhcm5pbmcnLAogICAgICAgIHRleHRDb250ZW50OiAnU2F2ZSBtZSEnLAogICAgICAgIGRvd25sb2FkOiAiNGNoYW4gWCB2IiArIE1haW4udmVyc2lvbiArICItIiArIG5vdyArICIuanNvbiIsCiAgICAgICAgaHJlZjogImRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsIiArIChidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShkYXRhKSkpKSksCiAgICAgICAgdGFyZ2V0OiAnX2JsYW5rJwogICAgICB9KTsKICAgICAgaWYgKCQuZW5naW5lICE9PSAnZ2Vja28nKSB7CiAgICAgICAgYS5jbGljaygpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBvdXRwdXQgPSB0aGlzLnBhcmVudE5vZGUubmV4dEVsZW1lbnRTaWJsaW5nOwogICAgICBvdXRwdXQuaW5uZXJIVE1MID0gbnVsbDsKICAgICAgcmV0dXJuICQuYWRkKG91dHB1dCwgYSk7CiAgICB9LAogICAgImltcG9ydCI6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5uZXh0RWxlbWVudFNpYmxpbmcuY2xpY2soKTsKICAgIH0sCiAgICBvbkltcG9ydDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBmaWxlLCBvdXRwdXQsIHJlYWRlcjsKICAgICAgaWYgKCEoZmlsZSA9IHRoaXMuZmlsZXNbMF0pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIG91dHB1dCA9IHRoaXMucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmc7CiAgICAgIGlmICghY29uZmlybSgnWW91ciBjdXJyZW50IHNldHRpbmdzIHdpbGwgYmUgZW50aXJlbHkgb3ZlcndyaXR0ZW4sIGFyZSB5b3Ugc3VyZT8nKSkgewogICAgICAgIG91dHB1dC50ZXh0Q29udGVudCA9ICdJbXBvcnQgYWJvcnRlZC4nOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24oZSkgewogICAgICAgIHZhciBkYXRhLCBlcnI7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGUudGFyZ2V0LnJlc3VsdCk7CiAgICAgICAgICBPcHRpb25zLmxvYWRTZXR0aW5ncyhkYXRhKTsKICAgICAgICAgIGlmIChjb25maXJtKCdJbXBvcnQgc3VjY2Vzc2Z1bC4gUmVmcmVzaCBub3c/JykpIHsKICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChfZXJyb3IpIHsKICAgICAgICAgIGVyciA9IF9lcnJvcjsKICAgICAgICAgIHJldHVybiBvdXRwdXQudGV4dENvbnRlbnQgPSAnSW1wb3J0IGZhaWxlZCBkdWUgdG8gYW4gZXJyb3IuJzsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHJldHVybiByZWFkZXIucmVhZEFzVGV4dChmaWxlKTsKICAgIH0sCiAgICBsb2FkU2V0dGluZ3M6IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgdmFyIGtleSwgdmFsLCBfcmVmOwogICAgICBfcmVmID0gZGF0YS5Db25mOwogICAgICBmb3IgKGtleSBpbiBfcmVmKSB7CiAgICAgICAgdmFsID0gX3JlZltrZXldOwogICAgICAgICQuc2V0KGtleSwgdmFsKTsKICAgICAgfQogICAgICByZXR1cm4gJC5zZXQoJ3dhdGNoZWQnLCBkYXRhLldhdGNoZWRUaHJlYWRzKTsKICAgIH0KICB9OwoKICBVcGRhdGVyID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjaGVja2JveCwgY2hlY2tlZCwgZGlhbG9nLCBodG1sLCBpbnB1dCwgbmFtZSwgdGl0bGUsIF9pLCBfbGVuLCBfcmVmOwogICAgICBodG1sID0gJzxkaXYgY2xhc3M9bW92ZT48c3BhbiBpZD1jb3VudD48L3NwYW4+IDxzcGFuIGlkPXRpbWVyPjwvc3Bhbj48L2Rpdj4nOwogICAgICBjaGVja2JveCA9IENvbmZpZy51cGRhdGVyLmNoZWNrYm94OwogICAgICBmb3IgKG5hbWUgaW4gY2hlY2tib3gpIHsKICAgICAgICB0aXRsZSA9IGNoZWNrYm94W25hbWVdWzFdOwogICAgICAgIGNoZWNrZWQgPSBDb25mW25hbWVdID8gJ2NoZWNrZWQnIDogJyc7CiAgICAgICAgaHRtbCArPSAiPGRpdj48bGFiZWwgdGl0bGU9JyIgKyB0aXRsZSArICInPiIgKyBuYW1lICsgIjxpbnB1dCBuYW1lPSciICsgbmFtZSArICInIHR5cGU9Y2hlY2tib3ggIiArIGNoZWNrZWQgKyAiPjwvbGFiZWw+PC9kaXY+IjsKICAgICAgfQogICAgICBjaGVja2VkID0gQ29uZlsnQXV0byBVcGRhdGUnXSA/ICdjaGVja2VkJyA6ICcnOwogICAgICBodG1sICs9ICIgICAgICA8ZGl2PjxsYWJlbCB0aXRsZT0nQ29udHJvbHMgd2hldGhlciAqdGhpcyogdGhyZWFkIGF1dG9tYXRpY2FsbHkgdXBkYXRlcyBvciBub3QnPkF1dG8gVXBkYXRlIFRoaXM8aW5wdXQgbmFtZT0nQXV0byBVcGRhdGUgVGhpcycgdHlwZT1jaGVja2JveCAiICsgY2hlY2tlZCArICI+PC9sYWJlbD48L2Rpdj4gICAgICA8ZGl2PjxsYWJlbD5JbnRlcnZhbCAocyk8aW5wdXQgdHlwZT1udW1iZXIgbmFtZT1JbnRlcnZhbCBjbGFzcz1maWVsZCBtaW49NT48L2xhYmVsPjwvZGl2PiAgICAgIDxkaXY+PGlucHV0IHZhbHVlPSdVcGRhdGUgTm93JyB0eXBlPWJ1dHRvbiBuYW1lPSdVcGRhdGUgTm93Jz48L2Rpdj4iOwogICAgICBkaWFsb2cgPSBVSS5kaWFsb2coJ3VwZGF0ZXInLCAnYm90dG9tOiAwOyByaWdodDogMDsnLCBodG1sKTsKICAgICAgdGhpcy5jb3VudCA9ICQoJyNjb3VudCcsIGRpYWxvZyk7CiAgICAgIHRoaXMudGltZXIgPSAkKCcjdGltZXInLCBkaWFsb2cpOwogICAgICB0aGlzLnRocmVhZCA9ICQuaWQoInQiICsgZy5USFJFQURfSUQpOwogICAgICB0aGlzLmxhc3RNb2RpZmllZCA9ICcwJzsKICAgICAgX3JlZiA9ICQkKCdpbnB1dCcsIGRpYWxvZyk7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGlucHV0ID0gX3JlZltfaV07CiAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09ICdjaGVja2JveCcpIHsKICAgICAgICAgICQub24oaW5wdXQsICdjbGljaycsICQuY2IuY2hlY2tlZCk7CiAgICAgICAgfQogICAgICAgIHN3aXRjaCAoaW5wdXQubmFtZSkgewogICAgICAgICAgY2FzZSAnU2Nyb2xsIEJHJzoKICAgICAgICAgICAgJC5vbihpbnB1dCwgJ2NsaWNrJywgdGhpcy5jYi5zY3JvbGxCRyk7CiAgICAgICAgICAgIHRoaXMuY2Iuc2Nyb2xsQkcuY2FsbChpbnB1dCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnVmVyYm9zZSc6CiAgICAgICAgICAgICQub24oaW5wdXQsICdjbGljaycsIHRoaXMuY2IudmVyYm9zZSk7CiAgICAgICAgICAgIHRoaXMuY2IudmVyYm9zZS5jYWxsKGlucHV0KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdBdXRvIFVwZGF0ZSBUaGlzJzoKICAgICAgICAgICAgJC5vbihpbnB1dCwgJ2NsaWNrJywgdGhpcy5jYi5hdXRvVXBkYXRlKTsKICAgICAgICAgICAgdGhpcy5jYi5hdXRvVXBkYXRlLmNhbGwoaW5wdXQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgJ0ludGVydmFsJzoKICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBDb25mWydJbnRlcnZhbCddOwogICAgICAgICAgICAkLm9uKGlucHV0LCAnY2hhbmdlJywgdGhpcy5jYi5pbnRlcnZhbCk7CiAgICAgICAgICAgIHRoaXMuY2IuaW50ZXJ2YWwuY2FsbChpbnB1dCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnVXBkYXRlIE5vdyc6CiAgICAgICAgICAgICQub24oaW5wdXQsICdjbGljaycsIHRoaXMudXBkYXRlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgJC5hZGQoZC5ib2R5LCBkaWFsb2cpOwogICAgICAkLm9uKGQsICdRUlBvc3RTdWNjZXNzZnVsJywgdGhpcy5jYi5wb3N0KTsKICAgICAgcmV0dXJuICQub24oZCwgJ3Zpc2liaWxpdHljaGFuZ2UnLCB0aGlzLmNiLnZpc2liaWxpdHkpOwogICAgfSwKICAgIC8qCiAgICBodHRwOi8vZnJlZXNvdW5kLm9yZy9wZW9wbGUvcGllcnJlY2FydG9vbnMxOTc5L3NvdW5kcy85MDExMi8KICAgIGNjLWJ5LW5jLTMuMAogICAgKi8KCiAgICBhdWRpbzogJC5lbCgnYXVkaW8nLCB7CiAgICAgIHNyYzogJ2RhdGE6YXVkaW8vd2F2O2Jhc2U2NCxVa2xHUmpRREFBQlhRVlpGWm0xMElCQUFBQUFCQUFFQWdENEFBSUErQUFBQkFBZ0FjMjF3YkR3QUFBQkJBQUFEQUFBQUFBQUFBQUE4QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFCa1lYUmh6QUlBQUdNbXM4ZW0wdGxlTVY0eklwTFZvOG5oZlNsY1BSMTAyS2krNUpzcFZFa2RWdEt6cytLMU5FaFVJVDdEd0tyY3kwZzZXeWdzck0yazFOcGlMbDB6SVkvV3BNcmpnQ2RiUGh4dzJLcSs1WjRxVWtrZFU5SzFzK0s1TmtWVElUekJ3cW5jemtvM1dpa3JxTStsMU54bExGMHpJSXZYcHNuamd5ZFpQaHhzMmF5OTVhSXJVRWtkVWRDM3N1SzhOME5VSWpxK3hLcmN6MDAyV2lvcHBkR20wOTFwSzF3MElJallwOGpraHlkWFB4eHEySzI5NWFVclRrb2VUczY1c3VLK09VRlVJemk3eHFyYjBWQTBXU29vb3RLbTB0NXRLbG8xSDRUWXFNZmtpeWRXUUJ4bTE2Kzg1YWN0VEVzZVM4eTdzZUhBUEQ5VEl6YTV5S3JhMDFReVdTc29uOU9uMGQ1d0tWazJINERZcWNma2ppZFVRQjFqMXJHNzVLc3ZTa3NlU2N1OHNlRENQejFUSkRXMnlhcmExRll4V1N3bm05U24wTjl6S1ZnMkgzM1pxc1hra2loU1FSMWcxYks2NUswd1NFc2ZSOGkrc2VERVFUeFVKVE96eTZyWTFWb3dXQzBtbU5Xb3o5OTNLVmMzSDNyWXE4VGtsU2xSUWgxZDFMUzY0N0F5UjB3Z1JNYkFzTi9HUkRwVEpUS3d6S3JYMWw0dlZ5NGxsZFdwenQ5N0tWWTRJWGJVcjhMWmxqVlBSQ3hodzdXM3o2WklTa3cxVksrNHNNV3ZYRWhTUGs2YnVheTlzbTVKVmtaTmlMV3F0ckorVGxkTlRucXVxYkN3aWxaWFUxQndwS2lycnBOZ1dGaFRhWm1ucHF1WmJGbGJWbVdPcGFPb25IWmNYbGxqaGFHaHBaMStZV0JkWW4yY242R2RobWRoWUdOM2xwMmVuSXR0WTJKamNvK2JuSnVPZEdabFpYQ0ltSnFha0hwb1oyWnVnNVdZbVpKL2JHbG9iWDZSbHBlU2czQnFhVzE2alpTVmtvWjBiR3R0ZUltU2s1S0llRzV0Ym5hRmtKS1Jpbnh4Ym05MWdZMlFrSXQvYzNCd2RINktqNCtMZ25aeGNYUjhpSTJPaklSNWMzSjBlNFdMall1RmUzVnpkSG1DaW95TGhuNTJkSFI1Z0lpS2lvZUFlSFYxZUgrR2lZcUhnWHAyZG5oOWhJaUpoNEo4ZUhkNGZJS0hpSWVEZlhsNGVIeUJob2VIaEg5NmVIbUEnCiAgICB9KSwKICAgIGNiOiB7CiAgICAgIHBvc3Q6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmICghQ29uZlsnQXV0byBVcGRhdGUgVGhpcyddKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZXRUaW1lb3V0KFVwZGF0ZXIudXBkYXRlLCA1MDApOwogICAgICB9LAogICAgICB2aXNpYmlsaXR5OiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoZC5oaWRkZW4pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKFVwZGF0ZXIudGltZXIudGV4dENvbnRlbnQgPCAtQ29uZlsnSW50ZXJ2YWwnXSkgewogICAgICAgICAgcmV0dXJuIFVwZGF0ZXIuc2V0KCd0aW1lcicsIC1Db25mWydJbnRlcnZhbCddKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGludGVydmFsOiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgdmFsOwogICAgICAgIHZhbCA9IHBhcnNlSW50KHRoaXMudmFsdWUsIDEwKTsKICAgICAgICB0aGlzLnZhbHVlID0gdmFsID4gNSA/IHZhbCA6IDU7CiAgICAgICAgJC5jYi52YWx1ZS5jYWxsKHRoaXMpOwogICAgICAgIHJldHVybiBVcGRhdGVyLnNldCgndGltZXInLCAtQ29uZlsnSW50ZXJ2YWwnXSk7CiAgICAgIH0sCiAgICAgIHZlcmJvc2U6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChDb25mWydWZXJib3NlJ10pIHsKICAgICAgICAgIFVwZGF0ZXIuc2V0KCdjb3VudCcsICcrMCcpOwogICAgICAgICAgcmV0dXJuIFVwZGF0ZXIudGltZXIuaGlkZGVuID0gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIFVwZGF0ZXIuc2V0KCdjb3VudCcsICdUaHJlYWQgVXBkYXRlcicpOwogICAgICAgICAgVXBkYXRlci5jb3VudC5jbGFzc05hbWUgPSAnJzsKICAgICAgICAgIHJldHVybiBVcGRhdGVyLnRpbWVyLmhpZGRlbiA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBhdXRvVXBkYXRlOiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoQ29uZlsnQXV0byBVcGRhdGUgVGhpcyddID0gdGhpcy5jaGVja2VkKSB7CiAgICAgICAgICByZXR1cm4gVXBkYXRlci50aW1lb3V0SUQgPSBzZXRUaW1lb3V0KFVwZGF0ZXIudGltZW91dCwgMTAwMCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQoVXBkYXRlci50aW1lb3V0SUQpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2Nyb2xsQkc6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBVcGRhdGVyLnNjcm9sbEJHID0gdGhpcy5jaGVja2VkID8gZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IDogZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gIWQuaGlkZGVuOwogICAgICAgIH07CiAgICAgIH0sCiAgICAgIGJ1cnlEZWFkOiBmdW5jdGlvbigpIHsKICAgICAgICBVcGRhdGVyLnNldCgndGltZXInLCAnJyk7CiAgICAgICAgVXBkYXRlci5zZXQoJ2NvdW50JywgNDA0KTsKICAgICAgICBVcGRhdGVyLmNvdW50LmNsYXNzTmFtZSA9ICd3YXJuaW5nJzsKICAgICAgICBjbGVhclRpbWVvdXQoVXBkYXRlci50aW1lb3V0SUQpOwogICAgICAgIGcuZGVhZCA9IHRydWU7CiAgICAgICAgaWYgKENvbmZbJ1VucmVhZCBDb3VudCddKSB7CiAgICAgICAgICBVbnJlYWQudGl0bGUgPSBVbnJlYWQudGl0bGUubWF0Y2goL14uKy0vKVswXSArICcgNDA0JzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZC50aXRsZSA9IGQudGl0bGUubWF0Y2goL14uKy0vKVswXSArICcgNDA0JzsKICAgICAgICB9CiAgICAgICAgVW5yZWFkLnVwZGF0ZSh0cnVlKTsKICAgICAgICBRUi5hYm9ydCgpOwogICAgICAgIHJldHVybiAkLmV2ZW50KCdUaHJlYWRVcGRhdGUnLCB7CiAgICAgICAgICA0MDQ6IHRydWUsCiAgICAgICAgICB0aHJlYWRJRDogZy5USFJFQURfSUQKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgbG9hZDogZnVuY3Rpb24oKSB7CiAgICAgICAgc3dpdGNoICh0aGlzLnN0YXR1cykgewogICAgICAgICAgY2FzZSA0MDQ6CiAgICAgICAgICAgIFVwZGF0ZXIuY2IuYnVyeURlYWQoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICBjYXNlIDMwNDoKICAgICAgICAgICAgLyoKICAgICAgICAgICAgU3RhdHVzIENvZGUgMzA0OiBOb3QgbW9kaWZpZWQKICAgICAgICAgICAgQnkgc2VuZGluZyB0aGUgYElmLU1vZGlmaWVkLVNpbmNlYCBoZWFkZXIgd2UgZ2V0IGEgcHJvcGVyIHN0YXR1cyBjb2RlLCBhbmQgbm8gcmVzcG9uc2UuCiAgICAgICAgICAgIFRoaXMgc2F2ZXMgYmFuZHdpZHRoIGZvciBib3RoIHRoZSB1c2VyIGFuZCB0aGUgc2VydmVycyBhbmQgYXZvaWQgdW5uZWNlc3NhcnkgY29tcHV0YXRpb24uCiAgICAgICAgICAgICovCgogICAgICAgICAgICBVcGRhdGVyLnNldCgndGltZXInLCAtQ29uZlsnSW50ZXJ2YWwnXSk7CiAgICAgICAgICAgIGlmIChDb25mWydWZXJib3NlJ10pIHsKICAgICAgICAgICAgICBVcGRhdGVyLnNldCgnY291bnQnLCAnKzAnKTsKICAgICAgICAgICAgICBVcGRhdGVyLmNvdW50LmNsYXNzTmFtZSA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDIwMDoKICAgICAgICAgICAgVXBkYXRlci5sYXN0TW9kaWZpZWQgPSB0aGlzLmdldFJlc3BvbnNlSGVhZGVyKCdMYXN0LU1vZGlmaWVkJyk7CiAgICAgICAgICAgIHZhciBwYXJzZWRfcG9zdHMgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2UpLnBvc3RzOwogICAgICAgICAgICBpZiAoJ2FyY2hpdmVkJyBpbiBwYXJzZWRfcG9zdHNbMF0gJiYgcGFyc2VkX3Bvc3RzWzBdLmFyY2hpdmVkID09PSAxKSB7CiAgICAgICAgICAgICAgVXBkYXRlci5jYi5idXJ5RGVhZCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIFVwZGF0ZXIuY2IudXBkYXRlKHBhcnNlZF9wb3N0cyk7CiAgICAgICAgICAgICAgVXBkYXRlci5zZXQoJ3RpbWVyJywgLUNvbmZbJ0ludGVydmFsJ10pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgVXBkYXRlci5zZXQoJ3RpbWVyJywgLUNvbmZbJ0ludGVydmFsJ10pOwogICAgICAgICAgICBpZiAoQ29uZlsnVmVyYm9zZSddKSB7CiAgICAgICAgICAgICAgVXBkYXRlci5zZXQoJ2NvdW50JywgdGhpcy5zdGF0dXNUZXh0KTsKICAgICAgICAgICAgICBVcGRhdGVyLmNvdW50LmNsYXNzTmFtZSA9ICd3YXJuaW5nJzsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZGVsZXRlIFVwZGF0ZXIucmVxdWVzdDsKICAgICAgfSwKICAgICAgdXBkYXRlOiBmdW5jdGlvbihwb3N0cykgewogICAgICAgIHZhciBjb3VudCwgaWQsIGxhc3RQb3N0LCBub2RlcywgcG9zdCwgcG9zdGVyQ291bnQsIHNjcm9sbCwgc3BvaWxlclJhbmdlLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgICBpZiAoc3BvaWxlclJhbmdlID0gcG9zdHNbMF0uY3VzdG9tX3Nwb2lsZXIpIHsKICAgICAgICAgIEJ1aWxkLnNwb2lsZXJSYW5nZVtnLkJPQVJEXSA9IHNwb2lsZXJSYW5nZTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbmZbJ1RocmVhZCBTdGF0cyddICYmIChwb3N0ZXJDb3VudCA9IHBvc3RzWzBdLnVuaXF1ZV9pcHMpKSB7CiAgICAgICAgICBUaHJlYWRTdGF0cy5wb3N0ZXJDb3VudChwb3N0ZXJDb3VudCk7CiAgICAgICAgfQogICAgICAgIGxhc3RQb3N0ID0gVXBkYXRlci50aHJlYWQubGFzdEVsZW1lbnRDaGlsZDsKICAgICAgICBpZCA9ICtsYXN0UG9zdC5pZC5zbGljZSgyKTsKICAgICAgICBub2RlcyA9IFtdOwogICAgICAgIF9yZWYgPSBwb3N0cy5yZXZlcnNlKCk7CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBwb3N0ID0gX3JlZltfaV07CiAgICAgICAgICBpZiAocG9zdC5ubyA8PSBpZCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIG5vZGVzLnB1c2goQnVpbGQucG9zdEZyb21PYmplY3QocG9zdCwgZy5CT0FSRCkpOwogICAgICAgIH0KICAgICAgICBjb3VudCA9IG5vZGVzLmxlbmd0aDsKICAgICAgICBpZiAoQ29uZlsnVmVyYm9zZSddKSB7CiAgICAgICAgICBVcGRhdGVyLnNldCgnY291bnQnLCAiKyIgKyBjb3VudCk7CiAgICAgICAgICBVcGRhdGVyLmNvdW50LmNsYXNzTmFtZSA9IGNvdW50ID8gJ25ldycgOiBudWxsOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoY291bnQgJiYgQ29uZlsnQmVlcCddICYmIGQuaGlkZGVuICYmIChVbnJlYWQucmVwbGllcy5sZW5ndGggPT09IDApKSB7CiAgICAgICAgICBVcGRhdGVyLmF1ZGlvLnBsYXkoKTsKICAgICAgICAgIC8vcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzY3JvbGwgPSBDb25mWydTY3JvbGxpbmcnXSAmJiBVcGRhdGVyLnNjcm9sbEJHKCkgJiYgbGFzdFBvc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tIC0gZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IDwgMjU7CiAgICAgICAgJC5hZGQoVXBkYXRlci50aHJlYWQsIG5vZGVzLnJldmVyc2UoKSk7CiAgICAgICAgaWYgKHNjcm9sbCkgewogICAgICAgICAgbm9kZXNbMF0uc2Nyb2xsSW50b1ZpZXcoKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAkLmV2ZW50KCdUaHJlYWRVcGRhdGUnLCB7CiAgICAgICAgICA0MDQ6IGZhbHNlLAogICAgICAgICAgdGhyZWFkSUQ6IGcuVEhSRUFEX0lELAogICAgICAgICAgbmV3UG9zdHM6IG5vZGVzLm1hcChmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgIHJldHVybiBkYXRhLmlkLnJlcGxhY2UoJ3BjJywgZy5CT0FSRCArICcuJyk7CiAgICAgICAgICB9KQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2V0OiBmdW5jdGlvbihuYW1lLCB0ZXh0KSB7CiAgICAgIHZhciBlbCwgbm9kZTsKICAgICAgZWwgPSBVcGRhdGVyW25hbWVdOwogICAgICBpZiAobm9kZSA9IGVsLmZpcnN0Q2hpbGQpIHsKICAgICAgICByZXR1cm4gbm9kZS5kYXRhID0gdGV4dDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZWwudGV4dENvbnRlbnQgPSB0ZXh0OwogICAgICB9CiAgICB9LAogICAgdGltZW91dDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBuOwogICAgICBVcGRhdGVyLnRpbWVvdXRJRCA9IHNldFRpbWVvdXQoVXBkYXRlci50aW1lb3V0LCAxMDAwKTsKICAgICAgbiA9IDEgKyBOdW1iZXIoVXBkYXRlci50aW1lci5maXJzdENoaWxkLmRhdGEpOwogICAgICBpZiAobiA9PT0gMCkgewogICAgICAgIHJldHVybiBVcGRhdGVyLnVwZGF0ZSgpOwogICAgICB9IGVsc2UgaWYgKG4gPj0gQ29uZlsnSW50ZXJ2YWwnXSkgewogICAgICAgIFVwZGF0ZXIuc2V0KCdjb3VudCcsICdSZXRyeScpOwogICAgICAgIFVwZGF0ZXIuY291bnQuY2xhc3NOYW1lID0gbnVsbDsKICAgICAgICByZXR1cm4gVXBkYXRlci51cGRhdGUoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gVXBkYXRlci5zZXQoJ3RpbWVyJywgbik7CiAgICAgIH0KICAgIH0sCiAgICB1cGRhdGU6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcmVxdWVzdCwgdXJsOwogICAgICBVcGRhdGVyLnNldCgndGltZXInLCAwKTsKICAgICAgcmVxdWVzdCA9IFVwZGF0ZXIucmVxdWVzdDsKICAgICAgaWYgKHJlcXVlc3QpIHsKICAgICAgICByZXF1ZXN0Lm9ubG9hZGVuZCA9IG51bGw7CiAgICAgICAgcmVxdWVzdC5hYm9ydCgpOwogICAgICB9CiAgICAgIHVybCA9ICIvL2EuNGNkbi5vcmcvIiArIGcuQk9BUkQgKyAiL3RocmVhZC8iICsgZy5USFJFQURfSUQgKyAiLmpzb24iOwogICAgICByZXR1cm4gVXBkYXRlci5yZXF1ZXN0ID0gJC5hamF4KHVybCwgewogICAgICAgIG9ubG9hZGVuZDogVXBkYXRlci5jYi5sb2FkCiAgICAgIH0sIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnSWYtTW9kaWZpZWQtU2luY2UnOiBVcGRhdGVyLmxhc3RNb2RpZmllZAogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfTsKCiAgV2F0Y2hlciA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZmF2aWNvbiwgaHRtbCwgaW5wdXQsIF9pLCBfbGVuLCBfcmVmOwogICAgICBodG1sID0gJzxkaXYgY2xhc3M9bW92ZT5UaHJlYWQgV2F0Y2hlcjwvZGl2Pic7CiAgICAgIHRoaXMuZGlhbG9nID0gVUkuZGlhbG9nKCd3YXRjaGVyJywgJ3RvcDogNTBweDsgbGVmdDogMHB4OycsIGh0bWwpOwogICAgICAkLmFkZChkLmJvZHksIHRoaXMuZGlhbG9nKTsKICAgICAgX3JlZiA9ICQkKCcub3AgaW5wdXQnKTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgaW5wdXQgPSBfcmVmW19pXTsKICAgICAgICBmYXZpY29uID0gJC5lbCgnaW1nJywgewogICAgICAgICAgY2xhc3NOYW1lOiAnZmF2aWNvbicKICAgICAgICB9KTsKICAgICAgICAkLm9uKGZhdmljb24sICdjbGljaycsIHRoaXMuY2IudG9nZ2xlKTsKICAgICAgICAkLmJlZm9yZShpbnB1dCwgZmF2aWNvbik7CiAgICAgIH0KICAgICAgaWYgKGcuVEhSRUFEX0lEID09PSAkLmdldCgnYXV0b1dhdGNoJywgMCkpIHsKICAgICAgICB0aGlzLndhdGNoKGcuVEhSRUFEX0lEKTsKICAgICAgICAkWyJkZWxldGUiXSgnYXV0b1dhdGNoJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgIH0KICAgICAgJC5vbihkLCAnUVJQb3N0U3VjY2Vzc2Z1bCcsIHRoaXMuY2IucG9zdCk7CiAgICAgIHJldHVybiAkLnN5bmMoJ3dhdGNoZWQnLCB0aGlzLnJlZnJlc2gpOwogICAgfSwKICAgIHJlZnJlc2g6IGZ1bmN0aW9uKHdhdGNoZWQpIHsKICAgICAgdmFyIGJvYXJkLCBkaXYsIGZhdmljb24sIGlkLCBsaW5rLCBub2RlcywgcHJvcHMsIHdhdGNoZWRCb2FyZCwgeCwgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZiwgX3JlZjEsIF9yZWYyOwogICAgICB3YXRjaGVkIHx8ICh3YXRjaGVkID0gJC5nZXQoJ3dhdGNoZWQnLCB7fSkpOwogICAgICBub2RlcyA9IFtdOwogICAgICBmb3IgKGJvYXJkIGluIHdhdGNoZWQpIHsKICAgICAgICBfcmVmID0gd2F0Y2hlZFtib2FyZF07CiAgICAgICAgZm9yIChpZCBpbiBfcmVmKSB7CiAgICAgICAgICBwcm9wcyA9IF9yZWZbaWRdOwogICAgICAgICAgeCA9ICQuZWwoJ2EnLCB7CiAgICAgICAgICAgIHRleHRDb250ZW50OiAnw5cnLAogICAgICAgICAgICBocmVmOiAnamF2YXNjcmlwdDo7JwogICAgICAgICAgfSk7CiAgICAgICAgICAkLm9uKHgsICdjbGljaycsIFdhdGNoZXIuY2IueCk7CiAgICAgICAgICBsaW5rID0gJC5lbCgnYScsIHByb3BzKTsKICAgICAgICAgIGxpbmsudGl0bGUgPSBsaW5rLnRleHRDb250ZW50OwogICAgICAgICAgZGl2ID0gJC5lbCgnZGl2Jyk7CiAgICAgICAgICAkLmFkZChkaXYsIFt4LCAkLnRuKCcgJyksIGxpbmtdKTsKICAgICAgICAgIG5vZGVzLnB1c2goZGl2KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgX3JlZjEgPSAkJCgnZGl2Om5vdCgubW92ZSknLCBXYXRjaGVyLmRpYWxvZyk7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZjEubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBkaXYgPSBfcmVmMVtfaV07CiAgICAgICAgJC5ybShkaXYpOwogICAgICB9CiAgICAgICQuYWRkKFdhdGNoZXIuZGlhbG9nLCBub2Rlcyk7CiAgICAgIHdhdGNoZWRCb2FyZCA9IHdhdGNoZWRbZy5CT0FSRF0gfHwge307CiAgICAgIF9yZWYyID0gJCQoJy5mYXZpY29uJyk7CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYyLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIGZhdmljb24gPSBfcmVmMltfal07CiAgICAgICAgaWQgPSBmYXZpY29uLm5leHRTaWJsaW5nLm5hbWU7CiAgICAgICAgaWYgKGlkIGluIHdhdGNoZWRCb2FyZCkgewogICAgICAgICAgZmF2aWNvbi5zcmMgPSBGYXZpY29uWyJkZWZhdWx0Il07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZhdmljb24uc3JjID0gRmF2aWNvbi5lbXB0eTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBjYjogewogICAgICB0b2dnbGU6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBXYXRjaGVyLnRvZ2dsZSh0aGlzLnBhcmVudE5vZGUpOwogICAgICB9LAogICAgICB4OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgdGhyZWFkOwogICAgICAgIHRocmVhZCA9IHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nLnBhdGhuYW1lLnNwbGl0KCcvJyk7CiAgICAgICAgcmV0dXJuIFdhdGNoZXIudW53YXRjaCh0aHJlYWRbM10sIHRocmVhZFsxXSk7CiAgICAgIH0sCiAgICAgIHBvc3Q6IGZ1bmN0aW9uKGUpIHsKICAgICAgICB2YXIgcG9zdElELCB0aHJlYWRJRCwgX3JlZjsKICAgICAgICBfcmVmID0gZS5kZXRhaWwsIHBvc3RJRCA9IF9yZWYucG9zdElELCB0aHJlYWRJRCA9IF9yZWYudGhyZWFkSUQ7CiAgICAgICAgaWYgKHRocmVhZElEID09PSAnMCcpIHsKICAgICAgICAgIGlmIChDb25mWydBdXRvIFdhdGNoJ10pIHsKICAgICAgICAgICAgcmV0dXJuICQuc2V0KCdhdXRvV2F0Y2gnLCBwb3N0SUQpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoQ29uZlsnQXV0byBXYXRjaCBSZXBseSddKSB7CiAgICAgICAgICByZXR1cm4gV2F0Y2hlci53YXRjaCh0aHJlYWRJRCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdG9nZ2xlOiBmdW5jdGlvbih0aHJlYWQpIHsKICAgICAgdmFyIGlkOwogICAgICBpZCA9ICQoJy5mYXZpY29uICsgaW5wdXQnLCB0aHJlYWQpLm5hbWU7CiAgICAgIHJldHVybiBXYXRjaGVyLndhdGNoKGlkKSB8fCBXYXRjaGVyLnVud2F0Y2goaWQsIGcuQk9BUkQpOwogICAgfSwKICAgIHVud2F0Y2g6IGZ1bmN0aW9uKGlkLCBib2FyZCkgewogICAgICB2YXIgd2F0Y2hlZDsKICAgICAgd2F0Y2hlZCA9ICQuZ2V0KCd3YXRjaGVkJywge30pOwogICAgICBkZWxldGUgd2F0Y2hlZFtib2FyZF1baWRdOwogICAgICAkLnNldCgnd2F0Y2hlZCcsIHdhdGNoZWQpOwogICAgICByZXR1cm4gV2F0Y2hlci5yZWZyZXNoKCk7CiAgICB9LAogICAgd2F0Y2g6IGZ1bmN0aW9uKGlkKSB7CiAgICAgIHZhciB0aHJlYWQsIHdhdGNoZWQsIF9uYW1lOwogICAgICB0aHJlYWQgPSAkLmlkKCJ0IiArIGlkKTsKICAgICAgaWYgKCQoJy5mYXZpY29uJywgdGhyZWFkKS5zcmMgPT09IEZhdmljb25bImRlZmF1bHQiXSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB3YXRjaGVkID0gJC5nZXQoJ3dhdGNoZWQnLCB7fSk7CiAgICAgIHdhdGNoZWRbX25hbWUgPSBnLkJPQVJEXSB8fCAod2F0Y2hlZFtfbmFtZV0gPSB7fSk7CiAgICAgIHdhdGNoZWRbZy5CT0FSRF1baWRdID0gewogICAgICAgIGhyZWY6ICIvIiArIGcuQk9BUkQgKyAiL3RocmVhZC8iICsgaWQsCiAgICAgICAgdGV4dENvbnRlbnQ6IEdldC50aXRsZSh0aHJlYWQpCiAgICAgIH07CiAgICAgICQuc2V0KCd3YXRjaGVkJywgd2F0Y2hlZCk7CiAgICAgIFdhdGNoZXIucmVmcmVzaCgpOwogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9OwoKICBBbm9ueW1pemUgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBuYW1lLCBwYXJlbnQsIHRyaXA7CiAgICAgIGlmIChwb3N0LmlzSW5saW5lZCAmJiAhcG9zdC5pc0Nyb3NzcG9zdCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBuYW1lID0gJCgnLnBvc3RJbmZvIC5uYW1lJywgcG9zdC5lbCk7CiAgICAgIG5hbWUudGV4dENvbnRlbnQgPSAnQW5vbnltb3VzJzsKICAgICAgaWYgKCh0cmlwID0gbmFtZS5uZXh0RWxlbWVudFNpYmxpbmcpICYmIHRyaXAuY2xhc3NOYW1lID09PSAncG9zdGVydHJpcCcpIHsKICAgICAgICAkLnJtKHRyaXApOwogICAgICB9CiAgICAgIGlmICgocGFyZW50ID0gbmFtZS5wYXJlbnROb2RlKS5jbGFzc05hbWUgPT09ICd1c2VyZW1haWwnICYmICEvXm1haWx0bzpzYWdlJC9pLnRlc3QocGFyZW50LmhyZWYpKSB7CiAgICAgICAgcmV0dXJuICQucmVwbGFjZShwYXJlbnQsIG5hbWUpOwogICAgICB9CiAgICB9CiAgfTsKCiAgU2F1Y2UgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGxpbmssIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAoZy5CT0FSRCA9PT0gJ2YnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMubGlua3MgPSBbXTsKICAgICAgX3JlZiA9IENvbmZbJ3NhdWNlcyddLnNwbGl0KCdcbicpOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBsaW5rID0gX3JlZltfaV07CiAgICAgICAgaWYgKGxpbmtbMF0gPT09ICcjJyB8fCBsaW5rLnRyaW0oKSA9PT0gJycpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICB0aGlzLmxpbmtzLnB1c2godGhpcy5jcmVhdGVTYXVjZUxpbmsobGluay50cmltKCkpKTsKICAgICAgfQogICAgICBpZiAoIXRoaXMubGlua3MubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJldHVybiBNYWluLmNhbGxiYWNrcy5wdXNoKHRoaXMubm9kZSk7CiAgICB9LAogICAgY3JlYXRlU2F1Y2VMaW5rOiBmdW5jdGlvbihsaW5rKSB7CiAgICAgIHZhciBkb21haW4sIGVsLCBocmVmLCBtOwogICAgICBsaW5rID0gbGluay5yZXBsYWNlKC9cJDQvZywgZy5CT0FSRCk7CiAgICAgIGRvbWFpbiA9IChtID0gbGluay5tYXRjaCgvO3RleHQ6KC4rKSQvKSkgPyBtWzFdIDogbGluay5tYXRjaCgvKFx3KylcLlx3K1wvLylbMV07CiAgICAgIGhyZWYgPSBsaW5rLnJlcGxhY2UoLzt0ZXh0Oi4rJC8sICcnKTsKICAgICAgZWwgPSAkLmVsKCdhJywgewogICAgICAgIHRhcmdldDogJ19ibGFuaycsCiAgICAgICAgdGV4dENvbnRlbnQ6IGRvbWFpbgogICAgICB9KTsKICAgICAgcmV0dXJuIGZ1bmN0aW9uKGltZywgaXNBcmNoaXZlZCkgewogICAgICAgIHZhciBhOwogICAgICAgIGEgPSBlbC5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgYS5ocmVmID0gaHJlZi5yZXBsYWNlKC8oXCRcZCkvZywgZnVuY3Rpb24ocGFyYW1ldGVyKSB7CiAgICAgICAgICBzd2l0Y2ggKHBhcmFtZXRlcikgewogICAgICAgICAgICBjYXNlICckMSc6CiAgICAgICAgICAgICAgcmV0dXJuIGlzQXJjaGl2ZWQgPyBpbWcuZmlyc3RDaGlsZC5zcmMgOiAnaHR0cDovL2kuNGNkbi5vcmcnICsgaW1nLnBhdGhuYW1lLnJlcGxhY2UoLyhcZCspXC4uKyQvLCAnJDFzLmpwZycpOwogICAgICAgICAgICBjYXNlICckMic6CiAgICAgICAgICAgICAgcmV0dXJuIGltZy5ocmVmOwogICAgICAgICAgICBjYXNlICckMyc6CiAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChpbWcuZmlyc3RDaGlsZC5kYXRhc2V0Lm1kNSk7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtZXRlcjsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gYTsKICAgICAgfTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBpbWcsIGxpbmssIG5vZGVzLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaW1nID0gcG9zdC5pbWc7CiAgICAgIGlmIChwb3N0LmlzSW5saW5lZCAmJiAhcG9zdC5pc0Nyb3NzcG9zdCB8fCAhaW1nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGltZyA9IGltZy5wYXJlbnROb2RlOwogICAgICBub2RlcyA9IFtdOwogICAgICBfcmVmID0gU2F1Y2UubGlua3M7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGxpbmsgPSBfcmVmW19pXTsKICAgICAgICBub2Rlcy5wdXNoKCQudG4oJ1x1MDBBMCcpLCBsaW5rKGltZywgcG9zdC5pc0FyY2hpdmVkKSk7CiAgICAgIH0KICAgICAgcmV0dXJuICQuYWRkKHBvc3QuZmlsZUluZm8sIG5vZGVzKTsKICAgIH0KICB9OwoKICBSZXZlYWxTcG9pbGVycyA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGltZywgczsKICAgICAgaW1nID0gcG9zdC5pbWc7CiAgICAgIGlmICghKGltZyAmJiAkKCcuaW1nc3BvaWxlcicsIHBvc3QuZWwpKSB8fCBwb3N0LmlzSW5saW5lZCAmJiAhcG9zdC5pc0Nyb3NzcG9zdCB8fCBwb3N0LmlzQXJjaGl2ZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaW1nLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTsKICAgICAgcyA9IGltZy5zdHlsZTsKICAgICAgcy5tYXhIZWlnaHQgPSBzLm1heFdpZHRoID0gL1xib3BcYi8udGVzdChwb3N0WyJjbGFzcyJdKSA/ICcyNTBweCcgOiAnMTI1cHgnOwogICAgICAvKmlmIChwb3N0LmZpbGVJbmZvLmZpcnN0RWxlbWVudENoaWxkKSB7CiAgICAgICAgcG9zdC5maWxlSW5mby5maXJzdEVsZW1lbnRDaGlsZC50ZXh0Q29udGVudCA9IHBvc3QuZWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZmlsZVRleHQnKVswXS50aXRsZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb3N0LmZpbGVJbmZvLnRleHRDb250ZW50ID0gcG9zdC5maWxlSW5mby50ZXh0Q29udGVudC5yZXBsYWNlKCdTcG9pbGVyIEltYWdlJywgcG9zdC5lbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmaWxlVGV4dCcpWzBdLnRpdGxlKTsKICAgICAgfSovCiAgICAgIHJldHVybiBpbWcuc3JjID0gIi8vaS40Y2RuLm9yZyIgKyAoaW1nLnBhcmVudE5vZGUucGF0aG5hbWUucmVwbGFjZSgvKFxkKykuKyQvLCAnJDFzLmpwZycpKTsKICAgIH0KICB9OwoKICBUaW1lID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBNYWluLmNhbGxiYWNrcy5wdXNoKHRoaXMubm9kZSk7CiAgICB9LAogICAgbm9kZTogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgbm9kZTsKICAgICAgaWYgKHBvc3QuaXNJbmxpbmVkICYmICFwb3N0LmlzQ3Jvc3Nwb3N0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIG5vZGUgPSAkKCcucG9zdEluZm8gPiAuZGF0ZVRpbWUnLCBwb3N0LmVsKTsKICAgICAgVGltZS5kYXRlID0gbmV3IERhdGUobm9kZS5kYXRhc2V0LnV0YyAqIDEwMDApOwogICAgICByZXR1cm4gbm9kZS50ZXh0Q29udGVudCA9IFRpbWUuZnVuaygpOwogICAgfSwKICAgIGZ1bms6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gQ29uZlsndGltZSddLnJlcGxhY2UoLyUoW0EtWmEtel0pL2csIGZ1bmN0aW9uKHMsIGMpIHsKICAgICAgICBpZiAoYyBpbiBUaW1lLmZvcm1hdHRlcnMpIHsKICAgICAgICAgIHJldHVybiBUaW1lLmZvcm1hdHRlcnNbY10oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHM7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBkYXk6IFsnU3VuZGF5JywgJ01vbmRheScsICdUdWVzZGF5JywgJ1dlZG5lc2RheScsICdUaHVyc2RheScsICdGcmlkYXknLCAnU2F0dXJkYXknXSwKICAgIG1vbnRoOiBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXSwKICAgIHplcm9QYWQ6IGZ1bmN0aW9uKG4pIHsKICAgICAgaWYgKG4gPCAxMCkgewogICAgICAgIHJldHVybiAnMCcgKyBuOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuOwogICAgICB9CiAgICB9LAogICAgZm9ybWF0dGVyczogewogICAgICBhOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gVGltZS5kYXlbVGltZS5kYXRlLmdldERheSgpXS5zbGljZSgwLCAzKTsKICAgICAgfSwKICAgICAgQTogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIFRpbWUuZGF5W1RpbWUuZGF0ZS5nZXREYXkoKV07CiAgICAgIH0sCiAgICAgIGI6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBUaW1lLm1vbnRoW1RpbWUuZGF0ZS5nZXRNb250aCgpXS5zbGljZSgwLCAzKTsKICAgICAgfSwKICAgICAgQjogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIFRpbWUubW9udGhbVGltZS5kYXRlLmdldE1vbnRoKCldOwogICAgICB9LAogICAgICBkOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gVGltZS56ZXJvUGFkKFRpbWUuZGF0ZS5nZXREYXRlKCkpOwogICAgICB9LAogICAgICBlOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gVGltZS5kYXRlLmdldERhdGUoKTsKICAgICAgfSwKICAgICAgSDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIFRpbWUuemVyb1BhZChUaW1lLmRhdGUuZ2V0SG91cnMoKSk7CiAgICAgIH0sCiAgICAgIEk6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBUaW1lLnplcm9QYWQoVGltZS5kYXRlLmdldEhvdXJzKCkgJSAxMiB8fCAxMik7CiAgICAgIH0sCiAgICAgIGs6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBUaW1lLmRhdGUuZ2V0SG91cnMoKTsKICAgICAgfSwKICAgICAgbDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIFRpbWUuZGF0ZS5nZXRIb3VycygpICUgMTIgfHwgMTI7CiAgICAgIH0sCiAgICAgIG06IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBUaW1lLnplcm9QYWQoVGltZS5kYXRlLmdldE1vbnRoKCkgKyAxKTsKICAgICAgfSwKICAgICAgTTogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIFRpbWUuemVyb1BhZChUaW1lLmRhdGUuZ2V0TWludXRlcygpKTsKICAgICAgfSwKICAgICAgcDogZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKFRpbWUuZGF0ZS5nZXRIb3VycygpIDwgMTIpIHsKICAgICAgICAgIHJldHVybiAnQU0nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gJ1BNJzsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIFA6IGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChUaW1lLmRhdGUuZ2V0SG91cnMoKSA8IDEyKSB7CiAgICAgICAgICByZXR1cm4gJ2FtJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuICdwbSc7CiAgICAgICAgfQogICAgICB9LAogICAgICBTOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gVGltZS56ZXJvUGFkKFRpbWUuZGF0ZS5nZXRTZWNvbmRzKCkpOwogICAgICB9LAogICAgICB5OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gVGltZS5kYXRlLmdldEZ1bGxZZWFyKCkgLSAyMDAwOwogICAgICB9CiAgICB9CiAgfTsKCiAgUmVsYXRpdmVEYXRlcyA9IHsKICAgIElOVEVSVkFMOiAkLk1JTlVURSwKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICBNYWluLmNhbGxiYWNrcy5wdXNoKHRoaXMubm9kZSk7CiAgICAgIHJldHVybiAkLm9uKGQsICd2aXNpYmlsaXR5Y2hhbmdlJywgdGhpcy5mbHVzaCk7CiAgICB9LAogICAgbm9kZTogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgZGF0ZUVsLCBkaWZmLCB1dGM7CiAgICAgIGRhdGVFbCA9ICQoJy5wb3N0SW5mbyA+IC5kYXRlVGltZScsIHBvc3QuZWwpOwogICAgICBkYXRlRWwudGl0bGUgPSBkYXRlRWwudGV4dENvbnRlbnQ7CiAgICAgIHV0YyA9IGRhdGVFbC5kYXRhc2V0LnV0YyAqIDEwMDA7CiAgICAgIGRpZmYgPSBEYXRlLm5vdygpIC0gdXRjOwogICAgICBkYXRlRWwudGV4dENvbnRlbnQgPSBSZWxhdGl2ZURhdGVzLnJlbGF0aXZlKGRpZmYpOwogICAgICBSZWxhdGl2ZURhdGVzLnNldFVwZGF0ZShkYXRlRWwsIHV0YywgZGlmZik7CiAgICAgIHJldHVybiBSZWxhdGl2ZURhdGVzLmZsdXNoKCk7CiAgICB9LAogICAgcmVsYXRpdmU6IGZ1bmN0aW9uKGRpZmYpIHsKICAgICAgdmFyIG51bWJlciwgcm91bmRlZCwgdW5pdDsKICAgICAgdW5pdCA9IChudW1iZXIgPSBkaWZmIC8gJC5EQVkpID4gMSA/ICdkYXknIDogKG51bWJlciA9IGRpZmYgLyAkLkhPVVIpID4gMSA/ICdob3VyJyA6IChudW1iZXIgPSBkaWZmIC8gJC5NSU5VVEUpID4gMSA/ICdtaW51dGUnIDogKG51bWJlciA9IGRpZmYgLyAkLlNFQ09ORCwgJ3NlY29uZCcpOwogICAgICByb3VuZGVkID0gTWF0aC5yb3VuZChudW1iZXIpOwogICAgICBpZiAocm91bmRlZCAhPT0gMSkgewogICAgICAgIHVuaXQgKz0gJ3MnOwogICAgICB9CiAgICAgIHJldHVybiAiIiArIHJvdW5kZWQgKyAiICIgKyB1bml0ICsgIiBhZ28iOwogICAgfSwKICAgIHN0YWxlOiBbXSwKICAgIGZsdXNoOiAkLmRlYm91bmNlKCQuU0VDT05ELCBmdW5jdGlvbigpIHsKICAgICAgdmFyIG5vdywgdXBkYXRlLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaWYgKGQuaGlkZGVuKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIG5vdyA9IERhdGUubm93KCk7CiAgICAgIF9yZWYgPSBSZWxhdGl2ZURhdGVzLnN0YWxlOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICB1cGRhdGUgPSBfcmVmW19pXTsKICAgICAgICB1cGRhdGUobm93KTsKICAgICAgfQogICAgICBSZWxhdGl2ZURhdGVzLnN0YWxlID0gW107CiAgICAgIGNsZWFyVGltZW91dChSZWxhdGl2ZURhdGVzLnRpbWVvdXQpOwogICAgICByZXR1cm4gUmVsYXRpdmVEYXRlcy50aW1lb3V0ID0gc2V0VGltZW91dChSZWxhdGl2ZURhdGVzLmZsdXNoLCBSZWxhdGl2ZURhdGVzLklOVEVSVkFMKTsKICAgIH0pLAogICAgc2V0VXBkYXRlOiBmdW5jdGlvbihkYXRlRWwsIHV0YywgZGlmZikgewogICAgICB2YXIgbWFya1N0YWxlLCBzZXRPd25UaW1lb3V0LCB1cGRhdGU7CiAgICAgIHNldE93blRpbWVvdXQgPSBmdW5jdGlvbihkaWZmKSB7CiAgICAgICAgdmFyIGRlbGF5OwogICAgICAgIGRlbGF5ID0gZGlmZiA8ICQuTUlOVVRFID8gJC5TRUNPTkQgLSAoZGlmZiArICQuU0VDT05EIC8gMikgJSAkLlNFQ09ORCA6IGRpZmYgPCAkLkhPVVIgPyAkLk1JTlVURSAtIChkaWZmICsgJC5NSU5VVEUgLyAyKSAlICQuTUlOVVRFIDogJC5IT1VSIC0gKGRpZmYgKyAkLkhPVVIgLyAyKSAlICQuSE9VUjsKICAgICAgICByZXR1cm4gc2V0VGltZW91dChtYXJrU3RhbGUsIGRlbGF5KTsKICAgICAgfTsKICAgICAgdXBkYXRlID0gZnVuY3Rpb24obm93KSB7CiAgICAgICAgaWYgKGQuY29udGFpbnMoZGF0ZUVsKSkgewogICAgICAgICAgZGlmZiA9IG5vdyAtIHV0YzsKICAgICAgICAgIGRhdGVFbC50ZXh0Q29udGVudCA9IFJlbGF0aXZlRGF0ZXMucmVsYXRpdmUoZGlmZik7CiAgICAgICAgICByZXR1cm4gc2V0T3duVGltZW91dChkaWZmKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIG1hcmtTdGFsZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBSZWxhdGl2ZURhdGVzLnN0YWxlLnB1c2godXBkYXRlKTsKICAgICAgfTsKICAgICAgcmV0dXJuIHNldE93blRpbWVvdXQoZGlmZik7CiAgICB9CiAgfTsKCiAgRmlsZUluZm8gPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgaWYgKGcuQk9BUkQgPT09ICdmJykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGFsdCwgZmlsZW5hbWUsIF9yZWYsIG5hbWVOb2RlOwogICAgICBpZiAocG9zdC5pc0lubGluZWQgJiYgIXBvc3QuaXNDcm9zc3Bvc3QgfHwgIXBvc3QuZmlsZUluZm8pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYWx0ID0gcG9zdC5pbWcuYWx0OwogICAgICBuYW1lTm9kZSA9ICQoJ2EnLCBwb3N0LmZpbGVJbmZvKTsKICAgICAgZmlsZW5hbWUgPSBuYW1lTm9kZS50aXRsZSB8fCBwb3N0LmZpbGVJbmZvLnRpdGxlIHx8IG5hbWVOb2RlLnRleHRDb250ZW50OwogICAgICBGaWxlSW5mby5kYXRhID0gewogICAgICAgIGxpbms6IHBvc3QuaW1nLnBhcmVudE5vZGUuaHJlZiwKICAgICAgICBzcG9pbGVyOiAvXlNwb2lsZXIvLnRlc3QobmFtZU5vZGUudGV4dENvbnRlbnQpLAogICAgICAgIHNpemU6IGFsdC5tYXRjaCgvXGQrXC4/XGQqLylbMF0sCiAgICAgICAgdW5pdDogYWx0Lm1hdGNoKC9cdyskLylbMF0sCiAgICAgICAgcmVzb2x1dGlvbjogcG9zdC5maWxlSW5mby5jaGlsZE5vZGVzWzJdLnRleHRDb250ZW50Lm1hdGNoKC9cZCt4XGQrfFBERi8pWzBdLAogICAgICAgIGZ1bGxuYW1lOiBmaWxlbmFtZSwKICAgICAgICBzaG9ydG5hbWU6IEJ1aWxkLnNob3J0RmlsZW5hbWUoZmlsZW5hbWUsIHBvc3QuSUQgPT09IHBvc3QudGhyZWFkSUQpCiAgICAgIH07CiAgICAgIHBvc3QuZmlsZUluZm8uc2V0QXR0cmlidXRlKCdkYXRhLWZpbGVuYW1lJywgZmlsZW5hbWUpOwogICAgICByZXR1cm4gcG9zdC5maWxlSW5mby5pbm5lckhUTUwgPSBGaWxlSW5mby5mdW5rKCk7CiAgICB9LAogICAgZnVuazogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBDb25mWydmaWxlSW5mbyddLnJlcGxhY2UoLyUoLil8W14lXSsvZywgZnVuY3Rpb24ocywgYykgewogICAgICAgIGlmIChjIGluIEZpbGVJbmZvLmZvcm1hdHRlcnMpIHsKICAgICAgICAgIHJldHVybiBGaWxlSW5mby5mb3JtYXR0ZXJzW2NdKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBCdWlsZC5lc2NhcGUocyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjb252ZXJ0VW5pdDogZnVuY3Rpb24odW5pdFQpIHsKICAgICAgdmFyIGksIHNpemUsIHVuaXRGLCB1bml0czsKICAgICAgc2l6ZSA9IHRoaXMuZGF0YS5zaXplOwogICAgICB1bml0RiA9IHRoaXMuZGF0YS51bml0OwogICAgICBpZiAodW5pdEYgIT09IHVuaXRUKSB7CiAgICAgICAgdW5pdHMgPSBbJ0InLCAnS0InLCAnTUInXTsKICAgICAgICBpID0gdW5pdHMuaW5kZXhPZih1bml0RikgLSB1bml0cy5pbmRleE9mKHVuaXRUKTsKICAgICAgICBpZiAodW5pdFQgPT09ICdCJykgewogICAgICAgICAgdW5pdFQgPSAnQnl0ZXMnOwogICAgICAgIH0KICAgICAgICBpZiAoaSA+IDApIHsKICAgICAgICAgIHdoaWxlIChpLS0gPiAwKSB7CiAgICAgICAgICAgIHNpemUgKj0gMTAyNDsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGkgPCAwKSB7CiAgICAgICAgICB3aGlsZSAoaSsrIDwgMCkgewogICAgICAgICAgICBzaXplIC89IDEwMjQ7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChzaXplIDwgMSAmJiBzaXplLnRvU3RyaW5nKCkubGVuZ3RoID4gc2l6ZS50b0ZpeGVkKDIpLmxlbmd0aCkgewogICAgICAgICAgc2l6ZSA9IHNpemUudG9GaXhlZCgyKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuICIiICsgc2l6ZSArICIgIiArIHVuaXRUOwogICAgfSwKICAgIGZvcm1hdHRlcnM6IHsKICAgICAgdDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIEZpbGVJbmZvLmRhdGEubGluay5tYXRjaCgvXGQrXC5cdyskLylbMF07CiAgICAgIH0sCiAgICAgIFQ6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiAnPGEgaHJlZj0iJyArIEJ1aWxkLmVzY2FwZShGaWxlSW5mby5kYXRhLmxpbmspICsgJyIgdGFyZ2V0PSJfYmxhbmsiPicgKyAodGhpcy50KCkpICsgJzwvYT4nOwogICAgICB9LAogICAgICBsOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gJzxhIGhyZWY9IicgKyBCdWlsZC5lc2NhcGUoRmlsZUluZm8uZGF0YS5saW5rKSArICciIHRhcmdldD0iX2JsYW5rIj4nICsgKHRoaXMubigpKSArICc8L2E+JzsKICAgICAgfSwKICAgICAgTDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICc8YSBocmVmPSInICsgQnVpbGQuZXNjYXBlKEZpbGVJbmZvLmRhdGEubGluaykgKyAnIiB0YXJnZXQ9Il9ibGFuayI+JyArICh0aGlzLk4oKSkgKyAnPC9hPic7CiAgICAgIH0sCiAgICAgIG46IGZ1bmN0aW9uKCkgewogICAgICAgIGlmIChGaWxlSW5mby5kYXRhLmZ1bGxuYW1lID09PSBGaWxlSW5mby5kYXRhLnNob3J0bmFtZSkgewogICAgICAgICAgcmV0dXJuIEJ1aWxkLmVzY2FwZShGaWxlSW5mby5kYXRhLmZ1bGxuYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz0iZm50cnVuYyI+JyArIEJ1aWxkLmVzY2FwZShGaWxlSW5mby5kYXRhLnNob3J0bmFtZSkgKyAnPC9zcGFuPjxzcGFuIGNsYXNzPSJmbmZ1bGwiPicgKyBCdWlsZC5lc2NhcGUoRmlsZUluZm8uZGF0YS5mdWxsbmFtZSkgKyAnPC9zcGFuPic7CiAgICAgICAgfQogICAgICB9LAogICAgICBOOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gQnVpbGQuZXNjYXBlKEZpbGVJbmZvLmRhdGEuZnVsbG5hbWUpOwogICAgICB9LAogICAgICBwOiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoRmlsZUluZm8uZGF0YS5zcG9pbGVyKSB7CiAgICAgICAgICByZXR1cm4gJ1Nwb2lsZXIsICc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHM6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiAiIiArIEZpbGVJbmZvLmRhdGEuc2l6ZSArICIgIiArIEZpbGVJbmZvLmRhdGEudW5pdDsKICAgICAgfSwKICAgICAgQjogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIEZpbGVJbmZvLmNvbnZlcnRVbml0KCdCJyk7CiAgICAgIH0sCiAgICAgIEs6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBGaWxlSW5mby5jb252ZXJ0VW5pdCgnS0InKTsKICAgICAgfSwKICAgICAgTTogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIEZpbGVJbmZvLmNvbnZlcnRVbml0KCdNQicpOwogICAgICB9LAogICAgICByOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gRmlsZUluZm8uZGF0YS5yZXNvbHV0aW9uOwogICAgICB9CiAgICB9CiAgfTsKCiAgR2V0ID0gewogICAgY2xvbmVXaXRob3V0VmlkZW86IGZ1bmN0aW9uKG5vZGUpIHsKICAgICAgdmFyIGNoaWxkLCBjbG9uZSwgaywgbGVuMSwgcmVmOwogICAgICBpZiAobm9kZS50YWdOYW1lID09PSAnVklERU8nICYmICFub2RlLmRhdGFzZXQubWQ1KSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9IGVsc2UgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFICYmICQoJ3ZpZGVvJywgbm9kZSkpIHsKICAgICAgICBjbG9uZSA9IG5vZGUuY2xvbmVOb2RlKGZhbHNlKTsKICAgICAgICByZWYgPSBub2RlLmNoaWxkTm9kZXM7CiAgICAgICAgZm9yIChrID0gMCwgbGVuMSA9IHJlZi5sZW5ndGg7IGsgPCBsZW4xOyBrKyspIHsKICAgICAgICAgIGNoaWxkID0gcmVmW2tdOwogICAgICAgICAgJC5hZGQoY2xvbmUsIHRoaXMuY2xvbmVXaXRob3V0VmlkZW8oY2hpbGQpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNsb25lOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBub2RlLmNsb25lTm9kZSh0cnVlKTsKICAgICAgfQogICAgfSwKICAgIHBvc3RXaXRob3V0VmlkZW86IGZ1bmN0aW9uKGJvYXJkLCB0aHJlYWRJRCwgcG9zdElELCByb290LCBjYikgewogICAgICB2YXIgcG9zdCwgdXJsOwogICAgICBpZiAoYm9hcmQgPT09IGcuQk9BUkQgJiYgKHBvc3QgPSAkLmlkKCJwYyIgKyBwb3N0SUQpKSkgewogICAgICAgICQuYWRkKHJvb3QsIEdldC5jbGVhblBvc3QoR2V0LmNsb25lV2l0aG91dFZpZGVvKHBvc3QpKSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJvb3QudGV4dENvbnRlbnQgPSAiTG9hZGluZyBwb3N0IE5vLiIgKyBwb3N0SUQgKyAiLi4uIjsKICAgICAgaWYgKHRocmVhZElEKSB7CiAgICAgICAgcmV0dXJuICQuY2FjaGUoIi8vYS40Y2RuLm9yZy8iICsgYm9hcmQgKyAiL3RocmVhZC8iICsgdGhyZWFkSUQgKyAiLmpzb24iLCBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBHZXQucGFyc2VQb3N0KHRoaXMsIGJvYXJkLCB0aHJlYWRJRCwgcG9zdElELCByb290LCBjYik7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodXJsID0gUmVkaXJlY3QucG9zdChib2FyZCwgcG9zdElEKSkgewogICAgICAgIHJldHVybiAkLmNhY2hlKHVybCwgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gR2V0LnBhcnNlQXJjaGl2ZWRQb3N0KHRoaXMsIGJvYXJkLCBwb3N0SUQsIHJvb3QsIGNiKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHBvc3Q6IGZ1bmN0aW9uKGJvYXJkLCB0aHJlYWRJRCwgcG9zdElELCByb290LCBjYikgewogICAgICB2YXIgcG9zdCwgdXJsOwogICAgICBpZiAoYm9hcmQgPT09IGcuQk9BUkQgJiYgKHBvc3QgPSAkLmlkKCJwYyIgKyBwb3N0SUQpKSkgewogICAgICAgICQuYWRkKHJvb3QsIEdldC5jbGVhblBvc3QocG9zdC5jbG9uZU5vZGUodHJ1ZSkpKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcm9vdC50ZXh0Q29udGVudCA9ICJMb2FkaW5nIHBvc3QgTm8uIiArIHBvc3RJRCArICIuLi4iOwogICAgICBpZiAodGhyZWFkSUQpIHsKICAgICAgICByZXR1cm4gJC5jYWNoZSgiLy9hLjRjZG4ub3JnLyIgKyBib2FyZCArICIvdGhyZWFkLyIgKyB0aHJlYWRJRCArICIuanNvbiIsIGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIEdldC5wYXJzZVBvc3QodGhpcywgYm9hcmQsIHRocmVhZElELCBwb3N0SUQsIHJvb3QsIGNiKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICh1cmwgPSBSZWRpcmVjdC5wb3N0KGJvYXJkLCBwb3N0SUQpKSB7CiAgICAgICAgcmV0dXJuICQuY2FjaGUodXJsLCBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBHZXQucGFyc2VBcmNoaXZlZFBvc3QodGhpcywgYm9hcmQsIHBvc3RJRCwgcm9vdCwgY2IpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgcGFyc2VQb3N0OiBmdW5jdGlvbihyZXEsIGJvYXJkLCB0aHJlYWRJRCwgcG9zdElELCByb290LCBjYikgewogICAgICB2YXIgcG9zdCwgcG9zdHMsIHNwb2lsZXJSYW5nZSwgc3RhdHVzLCB1cmwsIF9pLCBfbGVuOwogICAgICBzdGF0dXMgPSByZXEuc3RhdHVzOwogICAgICBpZiAoc3RhdHVzICE9PSAyMDApIHsKICAgICAgICBpZiAodXJsID0gUmVkaXJlY3QucG9zdChib2FyZCwgcG9zdElEKSkgewogICAgICAgICAgJC5jYWNoZSh1cmwsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gR2V0LnBhcnNlQXJjaGl2ZWRQb3N0KHRoaXMsIGJvYXJkLCBwb3N0SUQsIHJvb3QsIGNiKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkLmFkZENsYXNzKHJvb3QsICd3YXJuaW5nJyk7CiAgICAgICAgICByb290LnRleHRDb250ZW50ID0gc3RhdHVzID09PSA0MDQgPyAiVGhyZWFkIE5vLiIgKyB0aHJlYWRJRCArICIgNDA0J2QuIiA6ICJFcnJvciAiICsgcmVxLnN0YXR1cyArICI6ICIgKyByZXEuc3RhdHVzVGV4dCArICIuIjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHBvc3RzID0gSlNPTi5wYXJzZShyZXEucmVzcG9uc2UpLnBvc3RzOwogICAgICBpZiAoc3BvaWxlclJhbmdlID0gcG9zdHNbMF0uY3VzdG9tX3Nwb2lsZXIpIHsKICAgICAgICBCdWlsZC5zcG9pbGVyUmFuZ2VbYm9hcmRdID0gc3BvaWxlclJhbmdlOwogICAgICB9CiAgICAgIHBvc3RJRCA9ICtwb3N0SUQ7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gcG9zdHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwb3N0ID0gcG9zdHNbX2ldOwogICAgICAgIGlmIChwb3N0Lm5vID09PSBwb3N0SUQpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpZiAocG9zdC5ubyA+IHBvc3RJRCkgewogICAgICAgICAgaWYgKHVybCA9IFJlZGlyZWN0LnBvc3QoYm9hcmQsIHBvc3RJRCkpIHsKICAgICAgICAgICAgJC5jYWNoZSh1cmwsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHJldHVybiBHZXQucGFyc2VBcmNoaXZlZFBvc3QodGhpcywgYm9hcmQsIHBvc3RJRCwgcm9vdCwgY2IpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICQuYWRkQ2xhc3Mocm9vdCwgJ3dhcm5pbmcnKTsKICAgICAgICAgICAgcm9vdC50ZXh0Q29udGVudCA9ICJQb3N0IE5vLiIgKyBwb3N0SUQgKyAiIHdhcyBub3QgZm91bmQuIjsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgJC5yZXBsYWNlKHJvb3QuZmlyc3RDaGlsZCwgR2V0LmNsZWFuUG9zdChCdWlsZC5wb3N0RnJvbU9iamVjdChwb3N0LCBib2FyZCkpKTsKICAgICAgaWYgKGNiKSB7CiAgICAgICAgcmV0dXJuIGNiKCk7CiAgICAgIH0KICAgIH0sCiAgICBlc2NhcGU6IGZ1bmN0aW9uKHRleHQpIHsKICAgICAgcmV0dXJuICh0ZXh0ID09IG51bGwpID8gbnVsbCA6IEJ1aWxkLmVzY2FwZSh0ZXh0KTsKICAgIH0sCiAgICBwYXJzZUFyY2hpdmVkUG9zdDogZnVuY3Rpb24ocmVxLCBib2FyZCwgcG9zdElELCByb290LCBjYikgewogICAgICB2YXIgYnEsIGNvbW1lbnQsIGRhdGEsIG8sIF9yZWY7CiAgICAgIGRhdGEgPSBKU09OLnBhcnNlKHJlcS5yZXNwb25zZSk7CiAgICAgIGlmIChkYXRhLmVycm9yKSB7CiAgICAgICAgJC5hZGRDbGFzcyhyb290LCAnd2FybmluZycpOwogICAgICAgIHJvb3QudGV4dENvbnRlbnQgPSBkYXRhLmVycm9yOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBicSA9ICQuZWwoJ2Jsb2NrcXVvdGUnLCB7CiAgICAgICAgdGV4dENvbnRlbnQ6IGRhdGEuY29tbWVudAogICAgICB9KTsKICAgICAgYnEuaW5uZXJIVE1MID0gYnEuaW5uZXJIVE1MLnJlcGxhY2UoL1xufFxbXC8/YlxdfFxbXC8/c3BvaWxlclxdfFxbXC8/Y29kZVxdfFxbXC8/bW9vdFxdfFxbXC8/YmFubmVkXF0vZywgZnVuY3Rpb24odGV4dCkgewogICAgICAgIHN3aXRjaCAodGV4dCkgewogICAgICAgICAgY2FzZSAnXG4nOgogICAgICAgICAgICByZXR1cm4gJzxicj4nOwogICAgICAgICAgY2FzZSAnW2JdJzoKICAgICAgICAgICAgcmV0dXJuICc8Yj4nOwogICAgICAgICAgY2FzZSAnWy9iXSc6CiAgICAgICAgICAgIHJldHVybiAnPC9iPic7CiAgICAgICAgICBjYXNlICdbc3BvaWxlcl0nOgogICAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPXNwb2lsZXI+JzsKICAgICAgICAgIGNhc2UgJ1svc3BvaWxlcl0nOgogICAgICAgICAgICByZXR1cm4gJzwvc3Bhbj4nOwogICAgICAgICAgY2FzZSAnW2NvZGVdJzoKICAgICAgICAgICAgcmV0dXJuICc8cHJlIGNsYXNzPXByZXR0eXByaW50Pic7CiAgICAgICAgICBjYXNlICdbL2NvZGVdJzoKICAgICAgICAgICAgcmV0dXJuICc8L3ByZT4nOwogICAgICAgICAgY2FzZSAnW21vb3RdJzoKICAgICAgICAgICAgcmV0dXJuICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjVweDttYXJnaW4tbGVmdDouNWVtO2JvcmRlci1jb2xvcjojZmFhO2JvcmRlcjoycHggZGFzaGVkIHJnYmEoMjU1LDAsMCwuMSk7Ym9yZGVyLXJhZGl1czoycHgiPic7CiAgICAgICAgICBjYXNlICdbL21vb3RdJzoKICAgICAgICAgICAgcmV0dXJuICc8L2Rpdj4nOwogICAgICAgICAgY2FzZSAnW2Jhbm5lZF0nOgogICAgICAgICAgICByZXR1cm4gJzxiIHN0eWxlPSJjb2xvcjogcmVkOyI+JzsKICAgICAgICAgIGNhc2UgJ1svYmFubmVkXSc6CiAgICAgICAgICAgIHJldHVybiAnPC9iPic7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgY29tbWVudCA9IGJxLmlubmVySFRNTC5yZXBsYWNlKC8oXnw+KSgmZ3Q7W148JF0qKSg8fCQpL2csICckMTxzcGFuIGNsYXNzPXF1b3RlPiQyPC9zcGFuPiQzJyk7CiAgICAgIGNvbW1lbnQgPSBjb21tZW50LnJlcGxhY2UoLygoJmd0Oyl7Mn0oJmd0O1wvW2EtelxkXStcLyk/XGQrKS9nLCAnPHNwYW4gY2xhc3M9ZGVhZGxpbms+JDE8L3NwYW4+Jyk7CiAgICAgIG8gPSB7CiAgICAgICAgcG9zdElEOiBwb3N0SUQsCiAgICAgICAgdGhyZWFkSUQ6IEdldC5lc2NhcGUoZGF0YS50aHJlYWRfbnVtKSwKICAgICAgICBib2FyZDogYm9hcmQsCiAgICAgICAgbmFtZTogR2V0LmVzY2FwZShkYXRhLm5hbWUpLAogICAgICAgIGNhcGNvZGU6IChmdW5jdGlvbigpIHsKICAgICAgICAgIHN3aXRjaCAoZGF0YS5jYXBjb2RlKSB7CiAgICAgICAgICAgIGNhc2UgJ00nOgogICAgICAgICAgICAgIHJldHVybiAnbW9kJzsKICAgICAgICAgICAgY2FzZSAnQSc6CiAgICAgICAgICAgICAgcmV0dXJuICdhZG1pbic7CiAgICAgICAgICAgIGNhc2UgJ0QnOgogICAgICAgICAgICAgIHJldHVybiAnZGV2ZWxvcGVyJzsKICAgICAgICAgIH0KICAgICAgICB9KSgpLAogICAgICAgIHRyaXBjb2RlOiBHZXQuZXNjYXBlKGRhdGEudHJpcCksCiAgICAgICAgdW5pcXVlSUQ6IEdldC5lc2NhcGUoZGF0YS5wb3N0ZXJfaGFzaCksCiAgICAgICAgZW1haWw6IGRhdGEuZW1haWwgPyBHZXQuZXNjYXBlKGVuY29kZVVSSShkYXRhLmVtYWlsKSkgOiAnJywKICAgICAgICBzdWJqZWN0OiBHZXQuZXNjYXBlKGRhdGEudGl0bGUpLAogICAgICAgIGZsYWdDb2RlOiBHZXQuZXNjYXBlKGRhdGEucG9zdGVyX2NvdW50cnkpLAogICAgICAgIGZsYWdOYW1lOiBkYXRhLnBvc3Rlcl9jb3VudHJ5X25hbWUgPyBHZXQuZXNjYXBlKGRhdGEucG9zdGVyX2NvdW50cnlfbmFtZSkgOiAnJywKICAgICAgICBkYXRlOiBHZXQuZXNjYXBlKGRhdGEuZm91cmNoYW5fZGF0ZSksCiAgICAgICAgZGF0ZVVUQzogK2RhdGEudGltZXN0YW1wLAogICAgICAgIGNvbW1lbnQ6IGNvbW1lbnQKICAgICAgfTsKICAgICAgaWYgKChfcmVmID0gZGF0YS5tZWRpYSkgIT0gbnVsbCA/IF9yZWYubWVkaWFfZmlsZW5hbWUgOiB2b2lkIDApIHsKICAgICAgICBvLmZpbGUgPSB7CiAgICAgICAgICBuYW1lOiBHZXQuZXNjYXBlKGRhdGEubWVkaWEubWVkaWFfZmlsZW5hbWUpLAogICAgICAgICAgdGltZXN0YW1wOiBHZXQuZXNjYXBlKGRhdGEubWVkaWEubWVkaWFfb3JpZyksCiAgICAgICAgICB1cmw6IEdldC5lc2NhcGUoZGF0YS5tZWRpYS5tZWRpYV9saW5rIHx8IGRhdGEubWVkaWEucmVtb3RlX21lZGlhX2xpbmspLAogICAgICAgICAgaGVpZ2h0OiBHZXQuZXNjYXBlKGRhdGEubWVkaWEubWVkaWFfaCksCiAgICAgICAgICB3aWR0aDogR2V0LmVzY2FwZShkYXRhLm1lZGlhLm1lZGlhX3cpLAogICAgICAgICAgTUQ1OiBHZXQuZXNjYXBlKGRhdGEubWVkaWEubWVkaWFfaGFzaCksCiAgICAgICAgICBzaXplOiBHZXQuZXNjYXBlKGRhdGEubWVkaWEubWVkaWFfc2l6ZSksCiAgICAgICAgICB0dXJsOiBHZXQuZXNjYXBlKGRhdGEubWVkaWEudGh1bWJfbGluayB8fCAoIi8vaS40Y2RuLm9yZy8iICsgYm9hcmQgKyAiLyIgKyBkYXRhLm1lZGlhLnByZXZpZXdfb3JpZykpLAogICAgICAgICAgdGhlaWdodDogR2V0LmVzY2FwZShkYXRhLm1lZGlhLnByZXZpZXdfaCksCiAgICAgICAgICB0d2lkdGg6IEdldC5lc2NhcGUoZGF0YS5tZWRpYS5wcmV2aWV3X3cpLAogICAgICAgICAgaXNTcG9pbGVyOiBkYXRhLm1lZGlhLnNwb2lsZXIgPT09ICcxJwogICAgICAgIH07CiAgICAgIH0KICAgICAgJC5yZXBsYWNlKHJvb3QuZmlyc3RDaGlsZCwgR2V0LmNsZWFuUG9zdChCdWlsZC5wb3N0KG8sIHRydWUpKSk7CiAgICAgIGlmIChjYikgewogICAgICAgIHJldHVybiBjYigpOwogICAgICB9CiAgICB9LAogICAgY2xlYW5Qb3N0OiBmdW5jdGlvbihyb290KSB7CiAgICAgIHZhciBjaGlsZCwgZWwsIGVscywgaW5saW5lLCBpbmxpbmVkLCBub3csIHBvc3QsIF9pLCBfaiwgX2ssIF9sLCBfbGVuLCBfbGVuMSwgX2xlbjIsIF9sZW4zLCBfcmVmLCBfcmVmMSwgX3JlZjI7CiAgICAgIHBvc3QgPSAkKCcucG9zdCcsIHJvb3QpOwogICAgICBfcmVmID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwocm9vdC5jaGlsZE5vZGVzKTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgY2hpbGQgPSBfcmVmW19pXTsKICAgICAgICBpZiAoY2hpbGQgIT09IHBvc3QpIHsKICAgICAgICAgICQucm0oY2hpbGQpOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmMSA9ICQkKCcuaW5saW5lJywgcG9zdCk7CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIGlubGluZSA9IF9yZWYxW19qXTsKICAgICAgICAkLnJtKGlubGluZSk7CiAgICAgIH0KICAgICAgX3JlZjIgPSAkJCgnLmlubGluZWQnLCBwb3N0KTsKICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gX3JlZjIubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7CiAgICAgICAgaW5saW5lZCA9IF9yZWYyW19rXTsKICAgICAgICAkLnJtQ2xhc3MoaW5saW5lZCwgJ2lubGluZWQnKTsKICAgICAgfQogICAgICBub3cgPSBEYXRlLm5vdygpOwogICAgICBlbHMgPSAkJCgnW2lkXScsIHJvb3QpOwogICAgICBlbHMucHVzaChyb290KTsKICAgICAgZm9yIChfbCA9IDAsIF9sZW4zID0gZWxzLmxlbmd0aDsgX2wgPCBfbGVuMzsgX2wrKykgewogICAgICAgIGVsID0gZWxzW19sXTsKICAgICAgICBlbC5pZCA9ICIiICsgbm93ICsgIl8iICsgZWwuaWQ7CiAgICAgIH0KICAgICAgJC5ybUNsYXNzKHJvb3QsICdmb3J3YXJkZWQnKTsKICAgICAgJC5ybUNsYXNzKHJvb3QsICdxcGhsJyk7CiAgICAgICQucm1DbGFzcyhwb3N0LCAnaGlnaGxpZ2h0Jyk7CiAgICAgICQucm1DbGFzcyhwb3N0LCAncXBobCcpOwogICAgICByb290LmhpZGRlbiA9IHBvc3QuaGlkZGVuID0gZmFsc2U7CiAgICAgIHJldHVybiByb290OwogICAgfSwKICAgIHRpdGxlOiBmdW5jdGlvbih0aHJlYWQpIHsKICAgICAgdmFyIGVsLCBvcCwgc3BhbjsKICAgICAgb3AgPSAkKCcub3AnLCB0aHJlYWQpOwogICAgICBlbCA9ICQoJy5wb3N0SW5mbyAuc3ViamVjdCcsIG9wKTsKICAgICAgaWYgKCFlbC50ZXh0Q29udGVudCkgewogICAgICAgIGVsID0gJCgnYmxvY2txdW90ZScsIG9wKTsKICAgICAgICBpZiAoIWVsLnRleHRDb250ZW50KSB7CiAgICAgICAgICBlbCA9ICQoJy5uYW1lQmxvY2snLCBvcCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHNwYW4gPSAkLmVsKCdzcGFuJywgewogICAgICAgIGlubmVySFRNTDogZWwuaW5uZXJIVE1MLnJlcGxhY2UoLzxicj4vZywgJyAnKQogICAgICB9KTsKICAgICAgcmV0dXJuICIvIiArIGcuQk9BUkQgKyAiLyAtICIgKyAoc3Bhbi50ZXh0Q29udGVudC50cmltKCkpOwogICAgfQogIH07CgogIEJ1aWxkID0gewogICAgZXNjYXBlOiBmdW5jdGlvbih0ZXh0KSB7CiAgICAgIHJldHVybiAodGV4dCArICcnKS5yZXBsYWNlKC9bJiInPD5dL2csIGZ1bmN0aW9uKGMpIHsKICAgICAgICByZXR1cm4geycmJzogJyZhbXA7JywgIiciOiAnJiMwMzk7JywgJyInOiAnJnF1b3Q7JywgJzwnOiAnJmx0OycsICc+JzogJyZndDsnfVtjXTsKICAgICAgfSk7CiAgICB9LAogICAgc3BvaWxlclJhbmdlOiB7fSwKICAgIHNob3J0RmlsZW5hbWU6IGZ1bmN0aW9uKGZpbGVuYW1lLCBpc09QKSB7CiAgICAgIHZhciB0aHJlc2hvbGQ7CiAgICAgIHRocmVzaG9sZCA9IGlzT1AgPyA0MCA6IDMwOwogICAgICBpZiAoZmlsZW5hbWUubGVuZ3RoIC0gNCA+IHRocmVzaG9sZCkgewogICAgICAgIHJldHVybiAiIiArIGZpbGVuYW1lLnNsaWNlKDAsIHRocmVzaG9sZCAtIDUpICsgIiguLi4pLiIgKyBmaWxlbmFtZS5zbGljZSgtMyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZpbGVuYW1lOwogICAgICB9CiAgICB9LAogICAgcG9zdEZyb21PYmplY3Q6IGZ1bmN0aW9uKGRhdGEsIGJvYXJkKSB7CiAgICAgIHZhciBvOwogICAgICBvID0gewogICAgICAgIHBvc3RJRDogZGF0YS5ubywKICAgICAgICB0aHJlYWRJRDogZGF0YS5yZXN0byB8fCBkYXRhLm5vLAogICAgICAgIGJvYXJkOiBib2FyZCwKICAgICAgICBuYW1lOiBkYXRhLm5hbWUsCiAgICAgICAgY2FwY29kZTogZGF0YS5jYXBjb2RlLAogICAgICAgIHRyaXBjb2RlOiBkYXRhLnRyaXAsCiAgICAgICAgc2luY2U0cGFzczogZGF0YS5zaW5jZTRwYXNzLAogICAgICAgIHVuaXF1ZUlEOiBkYXRhLmlkLAogICAgICAgIGVtYWlsOiBkYXRhLmVtYWlsID8gZW5jb2RlVVJJKGRhdGEuZW1haWwucmVwbGFjZSgvJnF1b3Q7L2csICciJykpIDogJycsCiAgICAgICAgc3ViamVjdDogZGF0YS5zdWIsCiAgICAgICAgZmxhZ0NvZGU6IGRhdGEuY291bnRyeSwKICAgICAgICBmbGFnTmFtZTogZGF0YS5jb3VudHJ5X25hbWUsCiAgICAgICAgZGF0ZTogZGF0YS5ub3csCiAgICAgICAgZGF0ZVVUQzogZGF0YS50aW1lLAogICAgICAgIGNvbW1lbnQ6IGRhdGEuY29tLAogICAgICAgIGlzU3RpY2t5OiAhIWRhdGEuc3RpY2t5LAogICAgICAgIGlzQ2xvc2VkOiAhIWRhdGEuY2xvc2VkCiAgICAgIH07CiAgICAgIGlmIChkYXRhLmV4dCB8fCBkYXRhLmZpbGVkZWxldGVkKSB7CiAgICAgICAgby5maWxlID0gewogICAgICAgICAgbmFtZTogZGF0YS5maWxlbmFtZSArIGRhdGEuZXh0LAogICAgICAgICAgdGltZXN0YW1wOiAiIiArIGRhdGEudGltICsgZGF0YS5leHQsCiAgICAgICAgICB1cmw6IGJvYXJkID09PSAnZicgPyAiLy9pLjRjZG4ub3JnLyIgKyBib2FyZCArICIvIiArIChlbmNvZGVVUklDb21wb25lbnQoZGF0YS5maWxlbmFtZSkpICsgZGF0YS5leHQgOiAiLy9pLjRjZG4ub3JnLyIgKyBib2FyZCArICIvIiArIGRhdGEudGltICsgZGF0YS5leHQsCiAgICAgICAgICBoZWlnaHQ6IGRhdGEuaCwKICAgICAgICAgIHdpZHRoOiBkYXRhLncsCiAgICAgICAgICBNRDU6IGRhdGEubWQ1LAogICAgICAgICAgc2l6ZTogZGF0YS5mc2l6ZSwKICAgICAgICAgIHR1cmw6ICIvL2kuNGNkbi5vcmcvIiArIGJvYXJkICsgIi8iICsgZGF0YS50aW0gKyAicy5qcGciLAogICAgICAgICAgdGhlaWdodDogZGF0YS50bl9oLAogICAgICAgICAgdHdpZHRoOiBkYXRhLnRuX3csCiAgICAgICAgICBpc1Nwb2lsZXI6ICEhZGF0YS5zcG9pbGVyLAogICAgICAgICAgaXNEZWxldGVkOiAhIWRhdGEuZmlsZWRlbGV0ZWQKICAgICAgICB9OwogICAgICB9CiAgICAgIHJldHVybiBCdWlsZC5wb3N0KG8pOwogICAgfSwKICAgIHBvc3Q6IGZ1bmN0aW9uKG8sIGlzQXJjaGl2ZWQpIHsKICAgICAgLyoKICAgICAgVGhpcyBmdW5jdGlvbiBjb250YWlucyBjb2RlIGZyb20gNGNoYW4tSlMgKGh0dHBzOi8vZ2l0aHViLmNvbS80Y2hhbi80Y2hhbi1KUykuCiAgICAgIEBsaWNlbnNlOiBodHRwczovL2dpdGh1Yi5jb20vNGNoYW4vNGNoYW4tSlMvYmxvYi9tYXN0ZXIvTElDRU5TRQogICAgICAqLwoKICAgICAgdmFyIGEsIGJvYXJkLCBjYXBjb2RlLCBjYXBjb2RlQ2xhc3MsIGNhcGNvZGVTdGFydCwgY2xvc2VkLCBjb21tZW50LCBjb250YWluZXIsIGRhdGUsIGRhdGVVVEMsIGVtYWlsLCBlbWFpbEVuZCwgZW1haWxTdGFydCwgZXh0LCBmaWxlLCBmaWxlRGltcywgZmlsZUhUTUwsIGZpbGVJbmZvLCBmaWxlU2l6ZSwgZmlsZVRodW1iLCBmaWxlbmFtZSwgZmxhZywgZmxhZ0NvZGUsIGZsYWdOYW1lLCBocmVmLCBpbWdTcmMsIGlzQ2xvc2VkLCBpc09QLCBpc1N0aWNreSwgbmFtZSwgcG9zdElELCBxdW90ZSwgc2hvcnRGaWxlbmFtZSwgc3BvaWxlclJhbmdlLCBzdGF0aWNQYXRoLCBzdGlja3ksIHNpbmNlNHBhc3MsIHN1YmplY3QsIHRocmVhZElELCB0cmlwY29kZSwgdW5pcXVlSUQsIHVzZXJJRCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIHBvc3RJRCA9IG8ucG9zdElELCB0aHJlYWRJRCA9IG8udGhyZWFkSUQsIGJvYXJkID0gby5ib2FyZCwgbmFtZSA9IG8ubmFtZSwgY2FwY29kZSA9IG8uY2FwY29kZSwgdHJpcGNvZGUgPSBvLnRyaXBjb2RlLCBzaW5jZTRwYXNzID0gby5zaW5jZTRwYXNzLCB1bmlxdWVJRCA9IG8udW5pcXVlSUQsIGVtYWlsID0gby5lbWFpbCwgc3ViamVjdCA9IG8uc3ViamVjdCwgZmxhZ0NvZGUgPSBvLmZsYWdDb2RlLCBmbGFnTmFtZSA9IG8uZmxhZ05hbWUsIGRhdGUgPSBvLmRhdGUsIGRhdGVVVEMgPSBvLmRhdGVVVEMsIGlzU3RpY2t5ID0gby5pc1N0aWNreSwgaXNDbG9zZWQgPSBvLmlzQ2xvc2VkLCBjb21tZW50ID0gby5jb21tZW50LCBmaWxlID0gby5maWxlOwogICAgICBpc09QID0gcG9zdElEID09PSB0aHJlYWRJRDsKICAgICAgc3RhdGljUGF0aCA9ICcvL3MuNGNkbi5vcmcnOwogICAgICBpZiAoZW1haWwpIHsKICAgICAgICBlbWFpbFN0YXJ0ID0gJzxhIGhyZWY9Im1haWx0bzonICsgZW1haWwgKyAnIiBjbGFzcz0idXNlcmVtYWlsIj4nOwogICAgICAgIGVtYWlsRW5kID0gJzwvYT4nOwogICAgICB9IGVsc2UgewogICAgICAgIGVtYWlsU3RhcnQgPSAnJzsKICAgICAgICBlbWFpbEVuZCA9ICcnOwogICAgICB9CiAgICAgIHN1YmplY3QgPSAnPHNwYW4gY2xhc3M9InN1YmplY3QiPicgKyAoc3ViamVjdCB8fCAnJykgKyAnPC9zcGFuPic7CiAgICAgIHVzZXJJRCA9ICFjYXBjb2RlICYmIHVuaXF1ZUlEID8gJyA8c3BhbiBjbGFzcz0icG9zdGVydWlkIGlkXycgKyB1bmlxdWVJRCArICciPihJRDogPHNwYW4gY2xhc3M9ImhhbmQiIHRpdGxlPSJIaWdobGlnaHQgcG9zdHMgYnkgdGhpcyBJRCI+JyArIHVuaXF1ZUlEICsgJzwvc3Bhbj4pPC9zcGFuPiAnIDogJyc7CiAgICAgIHN3aXRjaCAoY2FwY29kZSkgewogICAgICAgIGNhc2UgJ2FkbWluJzoKICAgICAgICBjYXNlICdhZG1pbl9oaWdobGlnaHQnOgogICAgICAgICAgY2FwY29kZUNsYXNzID0gJyBjYXBjb2RlQWRtaW4nOwogICAgICAgICAgY2FwY29kZVN0YXJ0ID0gJyA8c3Ryb25nIGNsYXNzPSJjYXBjb2RlIGhhbmQgaWRfYWRtaW4iIHRpdGxlPSJIaWdobGlnaHQgcG9zdHMgYnkgdGhlIEFkbWluaXN0cmF0b3IiPiMjIEFkbWluPC9zdHJvbmc+JzsKICAgICAgICAgIGNhcGNvZGUgPSAnIDxpbWcgc3JjPSInICsgc3RhdGljUGF0aCArICcvaW1hZ2UvYWRtaW5pY29uLmdpZiIgYWx0PSJUaGlzIHVzZXIgaXMgdGhlIDRjaGFuIEFkbWluaXN0cmF0b3IuIiB0aXRsZT0iVGhpcyB1c2VyIGlzIHRoZSA0Y2hhbiBBZG1pbmlzdHJhdG9yLiIgY2xhc3M9ImlkZW50aXR5SWNvbiI+JzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ21vZCc6CiAgICAgICAgICBjYXBjb2RlQ2xhc3MgPSAnIGNhcGNvZGVNb2QnOwogICAgICAgICAgY2FwY29kZVN0YXJ0ID0gJyA8c3Ryb25nIGNsYXNzPSJjYXBjb2RlIGhhbmQgaWRfbW9kIiB0aXRsZT0iSGlnaGxpZ2h0IHBvc3RzIGJ5IE1vZGVyYXRvcnMiPiMjIE1vZDwvc3Ryb25nPic7CiAgICAgICAgICBjYXBjb2RlID0gJyA8aW1nIHNyYz0iJyArIHN0YXRpY1BhdGggKyAnL2ltYWdlL21vZGljb24uZ2lmIiBhbHQ9IlRoaXMgdXNlciBpcyBhIDRjaGFuIE1vZGVyYXRvci4iIHRpdGxlPSJUaGlzIHVzZXIgaXMgYSA0Y2hhbiBNb2RlcmF0b3IuIiBjbGFzcz0iaWRlbnRpdHlJY29uIj4nOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnZGV2ZWxvcGVyJzoKICAgICAgICAgIGNhcGNvZGVDbGFzcyA9ICcgY2FwY29kZURldmVsb3Blcic7CiAgICAgICAgICBjYXBjb2RlU3RhcnQgPSAnIDxzdHJvbmcgY2xhc3M9ImNhcGNvZGUgaGFuZCBpZF9kZXZlbG9wZXIiIHRpdGxlPSJIaWdobGlnaHQgcG9zdHMgYnkgRGV2ZWxvcGVycyI+IyMgRGV2ZWxvcGVyPC9zdHJvbmc+JzsKICAgICAgICAgIGNhcGNvZGUgPSAnIDxpbWcgc3JjPSInICsgc3RhdGljUGF0aCArICcvaW1hZ2UvZGV2ZWxvcGVyaWNvbi5naWYiIGFsdD0iVGhpcyB1c2VyIGlzIGEgNGNoYW4gRGV2ZWxvcGVyLiIgdGl0bGU9IlRoaXMgdXNlciBpcyBhIDRjaGFuIERldmVsb3Blci4iIGNsYXNzPSJpZGVudGl0eUljb24iPic7CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgY2FwY29kZUNsYXNzID0gJyc7CiAgICAgICAgICBjYXBjb2RlU3RhcnQgPSAnJzsKICAgICAgICAgIGNhcGNvZGUgPSAnJzsKICAgICAgfQogICAgICBmbGFnID0gZmxhZ0NvZGUgPyAnIDxzcGFuIHRpdGxlPSInICsgZmxhZ05hbWUgKyAnIiBjbGFzcz0iZmxhZyBmbGFnLScgKyBmbGFnQ29kZS50b0xvd2VyQ2FzZSgpICsgJyI+IDwvc3Bhbj4nIDogJyc7CiAgICAgIGlmIChmaWxlICE9IG51bGwgPyBmaWxlLmlzRGVsZXRlZCA6IHZvaWQgMCkgewogICAgICAgIGZpbGVIVE1MID0gaXNPUCA/ICc8ZGl2IGNsYXNzPSJmaWxlIiBpZD0iZicgKyBwb3N0SUQgKyAnIj48ZGl2IGNsYXNzPSJmaWxlSW5mbyI+PC9kaXY+PHNwYW4gY2xhc3M9ImZpbGVUaHVtYiI+PGltZyBzcmM9IicgKyBzdGF0aWNQYXRoICsgJy9pbWFnZS9maWxlZGVsZXRlZC5naWYiIGFsdD0iRmlsZSBkZWxldGVkLiIgY2xhc3M9ImZpbGVEZWxldGVkIHJldGluYSI+PC9zcGFuPjwvZGl2PicgOiAnPGRpdiBpZD0iZicgKyBwb3N0SUQgKyAnIiBjbGFzcz0iZmlsZSI+PHNwYW4gY2xhc3M9ImZpbGVUaHVtYiI+PGltZyBzcmM9IicgKyBzdGF0aWNQYXRoICsgJy9pbWFnZS9maWxlZGVsZXRlZC1yZXMuZ2lmIiBhbHQ9IkZpbGUgZGVsZXRlZC4iIGNsYXNzPSJmaWxlRGVsZXRlZFJlcyByZXRpbmEiPjwvc3Bhbj48L2Rpdj4nOwogICAgICB9IGVsc2UgaWYgKGZpbGUpIHsKICAgICAgICBleHQgPSBmaWxlLm5hbWUuc2xpY2UoLTMpOwogICAgICAgIGlmICghZmlsZS50d2lkdGggJiYgIWZpbGUudGhlaWdodCAmJiBleHQgPT09ICdnaWYnKSB7CiAgICAgICAgICBmaWxlLnR3aWR0aCA9IGZpbGUud2lkdGg7CiAgICAgICAgICBmaWxlLnRoZWlnaHQgPSBmaWxlLmhlaWdodDsKICAgICAgICB9CiAgICAgICAgZmlsZVNpemUgPSAkLmJ5dGVzVG9TdHJpbmcoZmlsZS5zaXplKTsKICAgICAgICBmaWxlVGh1bWIgPSBmaWxlLnR1cmw7CiAgICAgICAgaWYgKGZpbGUuaXNTcG9pbGVyKSB7CiAgICAgICAgICBmaWxlU2l6ZSA9ICdTcG9pbGVyIEltYWdlLCAnICsgZmlsZVNpemU7CiAgICAgICAgICBpZiAoIWlzQXJjaGl2ZWQpIHsKICAgICAgICAgICAgZmlsZVRodW1iID0gJy8vcy40Y2RuLm9yZy9pbWFnZS9zcG9pbGVyJzsKICAgICAgICAgICAgaWYgKHNwb2lsZXJSYW5nZSA9IEJ1aWxkLnNwb2lsZXJSYW5nZVtib2FyZF0pIHsKICAgICAgICAgICAgICBmaWxlVGh1bWIgKz0gJy0nICsgYm9hcmQgKyBNYXRoLmZsb29yKDEgKyBzcG9pbGVyUmFuZ2UgKiBNYXRoLnJhbmRvbSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmaWxlVGh1bWIgKz0gJy5wbmcnOwogICAgICAgICAgICBmaWxlLnR3aWR0aCA9IGZpbGUudGhlaWdodCA9IDEwMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaW1nU3JjID0gYm9hcmQgPT09ICdmJyA/ICcnIDogJzxhIGNsYXNzPSJmaWxlVGh1bWInICsgKGZpbGUuaXNTcG9pbGVyID8gJyBpbWdzcG9pbGVyJyA6ICcnKSArICciIGhyZWY9IicgKyBmaWxlLnVybCArICciIHRhcmdldD0iX2JsYW5rIj48aW1nIHNyYz0iJyArIGZpbGVUaHVtYiArICciIGFsdD0iJyArIGZpbGVTaXplICsgJyIgZGF0YS1tZDU9IicgKyBmaWxlLk1ENSArICciIHN0eWxlPSJ3aWR0aDonICsgZmlsZS50d2lkdGggKyAncHg7aGVpZ2h0OicgKyBmaWxlLnRoZWlnaHQgKyAncHgiPjwvYT4nOwogICAgICAgIGZpbGVuYW1lID0gZmlsZS5uYW1lLnJlcGxhY2UoLyYoYW1wfCMwMzl8cXVvdHxsdHxndCk7L2csIGZ1bmN0aW9uIChjKSB7CiAgICAgICAgICByZXR1cm4geycmYW1wOyc6ICcmJywgJyYjMDM5Oyc6ICInIiwgJyZxdW90Oyc6ICciJywgJyZsdDsnOiAnPCcsICcmZ3Q7JzogJz4nfVtjXTsKICAgICAgICB9KS5yZXBsYWNlKC8lMjIvZywgJyInKTsKICAgICAgICBzaG9ydEZpbGVuYW1lID0gQnVpbGQuZXNjYXBlKEJ1aWxkLnNob3J0RmlsZW5hbWUoZmlsZW5hbWUpKTsKICAgICAgICBmaWxlbmFtZSA9IEJ1aWxkLmVzY2FwZShmaWxlbmFtZSk7CiAgICAgICAgZmlsZURpbXMgPSBleHQgPT09ICdwZGYnID8gJ1BERicgOiAnJyArIGZpbGUud2lkdGggKyAneCcgKyBmaWxlLmhlaWdodDsKICAgICAgICBmaWxlSW5mbyA9ICc8ZGl2IGNsYXNzPSJmaWxlVGV4dCIgaWQ9ImZUJyArIHBvc3RJRCArICciJyArIChmaWxlLmlzU3BvaWxlciA/ICcgdGl0bGU9IicgKyBmaWxlbmFtZSArICciJyA6ICcnKSArICc+RmlsZTogPGEnICsgKChmaWxlbmFtZSAhPT0gc2hvcnRGaWxlbmFtZSAmJiAhZmlsZS5pc1Nwb2lsZXIpID8gJyB0aXRsZT0iJyArIGZpbGVuYW1lICsgJyInIDogJycpICsgJyBocmVmPSInICsgZmlsZS51cmwgKyAnIiB0YXJnZXQ9Il9ibGFuayI+JyArIChmaWxlLmlzU3BvaWxlciA/ICdTcG9pbGVyIEltYWdlJyA6IHNob3J0RmlsZW5hbWUpICsgJzwvYT4tKCcgKyBmaWxlU2l6ZSArICcsICcgKyBmaWxlRGltcyArICcpPC9kaXY+JzsKICAgICAgICBmaWxlSFRNTCA9ICc8ZGl2IGNsYXNzPSJmaWxlIiBpZD0iZicgKyBwb3N0SUQgKyAnIj4nICsgZmlsZUluZm8gKyBpbWdTcmMgKyAnPC9kaXY+JzsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWxlSFRNTCA9ICcnOwogICAgICB9CiAgICAgIHNpbmNlNHBhc3MgPSBzaW5jZTRwYXNzID8gJyA8c3BhbiB0aXRsZT0iUGFzcyB1c2VyIHNpbmNlICcgKyBzaW5jZTRwYXNzICsgJyIgY2xhc3M9Im4tcHUiPjwvc3Bhbj4nIDogJyc7CiAgICAgIHRyaXBjb2RlID0gdHJpcGNvZGUgPyAnIDxzcGFuIGNsYXNzPSJwb3N0ZXJ0cmlwIj4nICsgdHJpcGNvZGUgKyAnPC9zcGFuPicgOiAnJzsKICAgICAgc3RpY2t5ID0gaXNTdGlja3kgPyAnIDxpbWcgc3JjPSIvL3MuNGNkbi5vcmcvaW1hZ2Uvc3RpY2t5LmdpZiIgYWx0PSJTdGlja3kiIHRpdGxlPSJTdGlja3kiIHN0eWxlPSJoZWlnaHQ6MTZweDt3aWR0aDoxNnB4Ij4nIDogJyc7CiAgICAgIGNsb3NlZCA9IGlzQ2xvc2VkID8gJyA8aW1nIHNyYz0iLy9zLjRjZG4ub3JnL2ltYWdlL2Nsb3NlZC5naWYiIGFsdD0iQ2xvc2VkIiB0aXRsZT0iQ2xvc2VkIiBzdHlsZT0iaGVpZ2h0OjE2cHg7d2lkdGg6MTZweCI+JyA6ICcnOwogICAgICBjb250YWluZXIgPSAkLmVsKCdkaXYnLCB7CiAgICAgICAgaWQ6ICdwYycgKyBwb3N0SUQsCiAgICAgICAgY2xhc3NOYW1lOiAncG9zdENvbnRhaW5lciAnICsgKGlzT1AgPyAnb3AnIDogJ3JlcGx5JykgKyAnQ29udGFpbmVyJywKICAgICAgICBpbm5lckhUTUw6IChpc09QID8gJycgOiAnPGRpdiBjbGFzcz0ic2lkZUFycm93cyIgaWQ9InNhJyArIHBvc3RJRCArICciPiZndDsmZ3Q7PC9kaXY+JykgKyAnPGRpdiBpZD0icCcgKyBwb3N0SUQgKyAnIiBjbGFzcz0icG9zdCAnICsgKGlzT1AgPyAnb3AnIDogJ3JlcGx5JykgKyAoY2FwY29kZSA9PT0gJ2FkbWluX2hpZ2hsaWdodCcgPyAnIGhpZ2hsaWdodFBvc3QnIDogJycpICsgJyI+PGRpdiBjbGFzcz0icG9zdEluZm9NIG1vYmlsZSIgaWQ9InBpbScgKyBwb3N0SUQgKyAnIj48c3BhbiBjbGFzcz0ibmFtZUJsb2NrJyArIGNhcGNvZGVDbGFzcyArICciPjxzcGFuIGNsYXNzPSJuYW1lIj4nICsgKG5hbWUgfHwgJycpICsgJzwvc3Bhbj4nICsgdHJpcGNvZGUgKyBjYXBjb2RlU3RhcnQgKyBjYXBjb2RlICsgc2luY2U0cGFzcyArIHVzZXJJRCArIGZsYWcgKyBzdGlja3kgKyBjbG9zZWQgKyAnPGJyPicgKyBzdWJqZWN0ICsgJzwvc3Bhbj48c3BhbiBjbGFzcz0iZGF0ZVRpbWUgcG9zdE51bSIgZGF0YS11dGM9IicgKyBkYXRlVVRDICsgJyI+JyArIGRhdGUgKyAnPGJyPjxlbT48YSBocmVmPSIvJyArIGJvYXJkICsgJy90aHJlYWQvJyArIHRocmVhZElEICsgJyNwJyArIHBvc3RJRCArICciPk5vLjwvYT48YSBocmVmPSInICsgKGcuUkVQTFkgJiYgZy5USFJFQURfSUQgPT09IHRocmVhZElEID8gJ2phdmFzY3JpcHQ6cXVvdGUoJyArIHBvc3RJRCArICcpJyA6ICcvJyArIGJvYXJkICsgJy90aHJlYWQvJyArIHRocmVhZElEICsgJyNxJyArIHBvc3RJRCkgKyAnIj4nICsgcG9zdElEICsgJzwvYT48L2VtPjwvc3Bhbj48L2Rpdj4nICsgKGlzT1AgPyBmaWxlSFRNTCA6ICcnKSArICc8ZGl2IGNsYXNzPSJwb3N0SW5mbyBkZXNrdG9wIiBpZD0icGknICsgcG9zdElEICsgJyI+PGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSInICsgcG9zdElEICsgJyIgdmFsdWU9ImRlbGV0ZSI+ICcgKyBzdWJqZWN0ICsgJyA8c3BhbiBjbGFzcz0ibmFtZUJsb2NrJyArIGNhcGNvZGVDbGFzcyArICciPicgKyBlbWFpbFN0YXJ0ICsgJzxzcGFuIGNsYXNzPSJuYW1lIj4nICsgKG5hbWUgfHwgJycpICsgJzwvc3Bhbj4nICsgdHJpcGNvZGUgKyBjYXBjb2RlU3RhcnQgKyBlbWFpbEVuZCArIGNhcGNvZGUgKyBzaW5jZTRwYXNzICsgdXNlcklEICsgZmxhZyArIHN0aWNreSArIGNsb3NlZCArICcgPC9zcGFuPiA8c3BhbiBjbGFzcz0iZGF0ZVRpbWUiIGRhdGEtdXRjPSInICsgZGF0ZVVUQyArICciPicgKyBkYXRlICsgJzwvc3Bhbj4gPHNwYW4gY2xhc3M9InBvc3ROdW0gZGVza3RvcCI+PGEgaHJlZj0iLycgKyBib2FyZCArICcvdGhyZWFkLycgKyB0aHJlYWRJRCArICcjcCcgKyBwb3N0SUQgKyAnIiB0aXRsZT0iTGluayB0byB0aGlzIHBvc3QiPk5vLjwvYT48YSBocmVmPSInICsgKGcuUkVQTFkgJiYgK2cuVEhSRUFEX0lEID09PSB0aHJlYWRJRCA/ICdqYXZhc2NyaXB0OnF1b3RlKCcgKyBwb3N0SUQgKyAnKScgOiAnLycgKyBib2FyZCArICcvdGhyZWFkLycgKyB0aHJlYWRJRCArICcjcScgKyBwb3N0SUQpICsgJyIgdGl0bGU9IlJlcGx5IHRvIHRoaXMgcG9zdCI+JyArIHBvc3RJRCArICc8L2E+PC9zcGFuPjwvZGl2PicgKyAoaXNPUCA/ICcnIDogZmlsZUhUTUwpICsgJzxibG9ja3F1b3RlIGNsYXNzPSJwb3N0TWVzc2FnZSIgaWQ9Im0nICsgcG9zdElEICsgJyI+JyArIChjb21tZW50IHx8ICcnKSArICc8L2Jsb2NrcXVvdGU+IDwvZGl2PicKICAgICAgfSk7CiAgICAgIF9yZWYgPSAkJCgnLnF1b3RlbGluaycsIGNvbnRhaW5lcik7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHF1b3RlID0gX3JlZltfaV07CiAgICAgICAgaHJlZiA9IHF1b3RlLmdldEF0dHJpYnV0ZSgnaHJlZicpOwogICAgICAgIGlmIChocmVmWzBdID09PSAnLycpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBxdW90ZS5ocmVmID0gJy8nICsgYm9hcmQgKyAnL3RocmVhZC8nICsgdGhyZWFkSUQgKyBocmVmOwogICAgICB9CiAgICAgIHJldHVybiBjb250YWluZXI7CiAgICB9CiAgfTsKCiAgVGl0bGVQb3N0ID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIGlmKENvbmZbJ1Bvc3QgaW4gVGl0bGUnXSkgewogICAgICAgIHJldHVybiBkLnRpdGxlID0gR2V0LnRpdGxlKCk7CiAgICAgIH0KICAgICAgdmFyIGJvYXJkVGl0bGU7CiAgICAgIHJldHVybiBkLnRpdGxlID0gKChib2FyZFRpdGxlID0gJCgnLmJvYXJkVGl0bGUnLCBkKSkgJiYgYm9hcmRUaXRsZS50ZXh0Q29udGVudCkgfHwgKChib2FyZFRpdGxlID0gJCgnI2JvYXJkTmF2RGVza3RvcCAuY3VycmVudCcsIGQpKSAmJiAiLyIgKyBnLkJPQVJEICsgIi8gLSAiICsgYm9hcmRUaXRsZS50aXRsZSkgfHwgKCIvIiArIGcuQk9BUkQgKyAiLyIpOwogICAgfQogIH07CgogIFF1b3RlQmFja2xpbmsgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBmdW5rOiBmdW5jdGlvbihpZCkgewogICAgICByZXR1cm4gQ29uZlsnYmFja2xpbmsnXS5yZXBsYWNlKC8laWQvZywgaWQpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGEsIGNvbnRhaW5lciwgZWwsIGxpbmssIHFpZCwgcXVvdGUsIHF1b3RlcywgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGlmIChwb3N0LmlzSW5saW5lZCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBxdW90ZXMgPSB7fTsKICAgICAgX3JlZiA9IHBvc3QucXVvdGVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBxdW90ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmIChxdW90ZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NOYW1lID09PSAnY2FwY29kZVJlcGxpZXMnKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYgKChxdW90ZS5ob3N0bmFtZSA9PT0gJ2JvYXJkcy40Y2hhbi5vcmcnIHx8IHF1b3RlLmhvc3RuYW1lID09PSAnYm9hcmRzLjRjaGFubmVsLm9yZycpICYmICEvY2F0YWxvZyQvLnRlc3QocXVvdGUucGF0aG5hbWUpICYmIChxaWQgPSBxdW90ZS5oYXNoLnNsaWNlKDIpKSkgewogICAgICAgICAgcXVvdGVzW3FpZF0gPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICBhID0gJC5lbCgnYScsIHsKICAgICAgICBocmVmOiAiLyIgKyBnLkJPQVJEICsgIi90aHJlYWQvIiArIHBvc3QudGhyZWFkSUQgKyAiI3AiICsgcG9zdC5JRCwKICAgICAgICBjbGFzc05hbWU6IHBvc3QuZWwuaGlkZGVuID8gJ2ZpbHRlcmVkIGJhY2tsaW5rJyA6ICdiYWNrbGluaycsCiAgICAgICAgdGV4dENvbnRlbnQ6IFF1b3RlQmFja2xpbmsuZnVuayhwb3N0LklEKQogICAgICB9KTsKICAgICAgZm9yIChxaWQgaW4gcXVvdGVzKSB7CiAgICAgICAgaWYgKCEoZWwgPSAkLmlkKCJwaSIgKyBxaWQpKSB8fCAhQ29uZlsnT1AgQmFja2xpbmtzJ10gJiYgL1xib3BcYi8udGVzdChlbC5wYXJlbnROb2RlLmNsYXNzTmFtZSkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBsaW5rID0gYS5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgaWYgKENvbmZbJ1F1b3RlIFByZXZpZXcnXSkgewogICAgICAgICAgJC5vbihsaW5rLCAnbW91c2VvdmVyJywgUXVvdGVQcmV2aWV3Lm1vdXNlb3Zlcik7CiAgICAgICAgfQogICAgICAgIGlmIChDb25mWydRdW90ZSBJbmxpbmUnXSkgewogICAgICAgICAgJC5vbihsaW5rLCAnY2xpY2snLCBRdW90ZUlubGluZS50b2dnbGUpOwogICAgICAgIH0KICAgICAgICBpZiAoIShjb250YWluZXIgPSAkLmlkKCJibGMiICsgcWlkKSkpIHsKICAgICAgICAgIGNvbnRhaW5lciA9ICQuZWwoJ3NwYW4nLCB7CiAgICAgICAgICAgIGNsYXNzTmFtZTogJ2NvbnRhaW5lcicsCiAgICAgICAgICAgIGlkOiAiYmxjIiArIHFpZAogICAgICAgICAgfSk7CiAgICAgICAgICAkLmFkZChlbCwgY29udGFpbmVyKTsKICAgICAgICB9CiAgICAgICAgJC5hZGQoY29udGFpbmVyLCBbJC50bignICcpLCBsaW5rXSk7CiAgICAgIH0KICAgIH0KICB9OwoKICBRdW90ZUlubGluZSA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIHF1b3RlLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMTsKICAgICAgX3JlZiA9IHBvc3QucXVvdGVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBxdW90ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICghKHF1b3RlLmhhc2ggJiYgKHF1b3RlLmhvc3RuYW1lID09PSAnYm9hcmRzLjRjaGFuLm9yZycgfHwgcXVvdGUuaG9zdG5hbWUgPT09ICdib2FyZHMuNGNoYW5uZWwub3JnJykgJiYgIS9jYXRhbG9nJC8udGVzdChxdW90ZS5wYXRobmFtZSkgfHwgL1xiZGVhZGxpbmtcYi8udGVzdChxdW90ZS5jbGFzc05hbWUpKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgICQub24ocXVvdGUsICdjbGljaycsIFF1b3RlSW5saW5lLnRvZ2dsZSk7CiAgICAgIH0KICAgICAgX3JlZjEgPSBwb3N0LmJhY2tsaW5rczsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgcXVvdGUgPSBfcmVmMVtfal07CiAgICAgICAgJC5vbihxdW90ZSwgJ2NsaWNrJywgUXVvdGVJbmxpbmUudG9nZ2xlKTsKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZTogZnVuY3Rpb24oZSkgewogICAgICB2YXIgaWQ7CiAgICAgIGlmIChlLnNoaWZ0S2V5IHx8IGUuYWx0S2V5IHx8IGUuY3RybEtleSB8fCBlLm1ldGFLZXkgfHwgZS5idXR0b24gIT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZCA9IHRoaXMuZGF0YXNldC5pZCB8fCB0aGlzLmhhc2guc2xpY2UoMik7CiAgICAgIGlmICgvXGJpbmxpbmVkXGIvLnRlc3QodGhpcy5jbGFzc05hbWUpKSB7CiAgICAgICAgUXVvdGVJbmxpbmUucm0odGhpcywgaWQpOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICgkLngoImFuY2VzdG9yOjpkaXZbY29udGFpbnMoQGlkLCdwIiArIGlkICsgIicpXSIsIHRoaXMpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIFF1b3RlSW5saW5lLmFkZCh0aGlzLCBpZCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuY2xhc3NMaXN0LnRvZ2dsZSgnaW5saW5lZCcpOwogICAgfSwKICAgIGFkZDogZnVuY3Rpb24ocSwgaWQpIHsKICAgICAgdmFyIGJvYXJkLCBlbCwgaSwgaW5saW5lLCBpc0JhY2tsaW5rLCBwYXRoLCBwb3N0SUQsIHJvb3QsIHRocmVhZElEOwogICAgICBpZiAocS5ob3N0ID09PSAnYm9hcmRzLjRjaGFuLm9yZycgfHwgcS5ob3N0ID09PSAnYm9hcmRzLjRjaGFubmVsLm9yZycpIHsKICAgICAgICBwYXRoID0gcS5wYXRobmFtZS5zcGxpdCgnLycpOwogICAgICAgIGJvYXJkID0gcGF0aFsxXTsKICAgICAgICB0aHJlYWRJRCA9IHBhdGhbM107CiAgICAgICAgcG9zdElEID0gaWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYm9hcmQgPSBxLmRhdGFzZXQuYm9hcmQ7CiAgICAgICAgdGhyZWFkSUQgPSAwOwogICAgICAgIHBvc3RJRCA9IHEuZGF0YXNldC5pZDsKICAgICAgfQogICAgICBlbCA9IGJvYXJkID09PSBnLkJPQVJEID8gJC5pZCgicCIgKyBwb3N0SUQpIDogZmFsc2U7CiAgICAgIGlubGluZSA9ICQuZWwoJ2RpdicsIHsKICAgICAgICBpZDogImkiICsgcG9zdElELAogICAgICAgIGNsYXNzTmFtZTogZWwgPyAnaW5saW5lJyA6ICdpbmxpbmUgY3Jvc3Nwb3N0JwogICAgICB9KTsKICAgICAgcm9vdCA9IChpc0JhY2tsaW5rID0gL1xiYmFja2xpbmtcYi8udGVzdChxLmNsYXNzTmFtZSkpID8gcS5wYXJlbnROb2RlIDogJC54KCdhbmNlc3Rvci1vci1zZWxmOjoqW3BhcmVudDo6YmxvY2txdW90ZV1bMV0nLCBxKTsKICAgICAgJC5hZnRlcihyb290LCBpbmxpbmUpOwogICAgICBHZXQucG9zdChib2FyZCwgdGhyZWFkSUQsIHBvc3RJRCwgaW5saW5lKTsKICAgICAgaWYgKCFlbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoaXNCYWNrbGluayAmJiBDb25mWydGb3J3YXJkIEhpZGluZyddKSB7CiAgICAgICAgJC5hZGRDbGFzcyhlbC5wYXJlbnROb2RlLCAnZm9yd2FyZGVkJyk7CiAgICAgICAgKytlbC5kYXRhc2V0LmZvcndhcmRlZCB8fCAoZWwuZGF0YXNldC5mb3J3YXJkZWQgPSAxKTsKICAgICAgfQogICAgICBpZiAoKGkgPSBVbnJlYWQucmVwbGllcy5pbmRleE9mKGVsKSkgIT09IC0xKSB7CiAgICAgICAgVW5yZWFkLnJlcGxpZXMuc3BsaWNlKGksIDEpOwogICAgICAgIHJldHVybiBVbnJlYWQudXBkYXRlKHRydWUpOwogICAgICB9CiAgICB9LAogICAgcm06IGZ1bmN0aW9uKHEsIGlkKSB7CiAgICAgIHZhciBkaXYsIGlubGluZWQsIF9pLCBfbGVuLCBfcmVmOwogICAgICBkaXYgPSAkLngoImZvbGxvd2luZzo6ZGl2W0BpZD0naSIgKyBpZCArICInXSIsIHEpOwogICAgICAkLnJtKGRpdik7CiAgICAgIGlmICghQ29uZlsnRm9yd2FyZCBIaWRpbmcnXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBfcmVmID0gJCQoJy5iYWNrbGluay5pbmxpbmVkJywgZGl2KTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgaW5saW5lZCA9IF9yZWZbX2ldOwogICAgICAgIGRpdiA9ICQuaWQoaW5saW5lZC5oYXNoLnNsaWNlKDEpKTsKICAgICAgICBpZiAoIS0tZGl2LmRhdGFzZXQuZm9yd2FyZGVkKSB7CiAgICAgICAgICAkLnJtQ2xhc3MoZGl2LnBhcmVudE5vZGUsICdmb3J3YXJkZWQnKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKC9cYmJhY2tsaW5rXGIvLnRlc3QocS5jbGFzc05hbWUpKSB7CiAgICAgICAgZGl2ID0gJC5pZCgicCIgKyBpZCk7CiAgICAgICAgaWYgKCEtLWRpdi5kYXRhc2V0LmZvcndhcmRlZCkgewogICAgICAgICAgcmV0dXJuICQucm1DbGFzcyhkaXYucGFyZW50Tm9kZSwgJ2ZvcndhcmRlZCcpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIFF1b3RlUHJldmlldyA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIHF1b3RlLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMTsKICAgICAgX3JlZiA9IHBvc3QucXVvdGVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBxdW90ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICghKHF1b3RlLmhhc2ggJiYgKHF1b3RlLmhvc3RuYW1lID09PSAnYm9hcmRzLjRjaGFuLm9yZycgfHwgcXVvdGUuaG9zdG5hbWUgPT09ICdib2FyZHMuNGNoYW5uZWwub3JnJykgJiYgIS9jYXRhbG9nJC8udGVzdChxdW90ZS5wYXRobmFtZSkgfHwgL1xiZGVhZGxpbmtcYi8udGVzdChxdW90ZS5jbGFzc05hbWUpKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgICQub24ocXVvdGUsICdtb3VzZW92ZXInLCBRdW90ZVByZXZpZXcubW91c2VvdmVyKTsKICAgICAgfQogICAgICBfcmVmMSA9IHBvc3QuYmFja2xpbmtzOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBxdW90ZSA9IF9yZWYxW19qXTsKICAgICAgICAkLm9uKHF1b3RlLCAnbW91c2VvdmVyJywgUXVvdGVQcmV2aWV3Lm1vdXNlb3Zlcik7CiAgICAgIH0KICAgIH0sCiAgICBtb3VzZW92ZXI6IGZ1bmN0aW9uKGUpIHsKICAgICAgdmFyIGJvYXJkLCBlbCwgcGF0aCwgcG9zdElELCBxcCwgcXVvdGUsIHF1b3RlcklELCB0aHJlYWRJRCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGlmICgvXGJpbmxpbmVkXGIvLnRlc3QodGhpcy5jbGFzc05hbWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChxcCA9ICQuaWQoJ3FwJykpIHsKICAgICAgICBpZiAocXAgPT09IFVJLmVsKSB7CiAgICAgICAgICBkZWxldGUgVUkuZWw7CiAgICAgICAgfQogICAgICAgICQucm0ocXApOwogICAgICB9CiAgICAgIGlmIChVSS5lbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5ob3N0ID09PSAnYm9hcmRzLjRjaGFuLm9yZycgfHwgdGhpcy5ob3N0ID09PSAnYm9hcmRzLjRjaGFubmVsLm9yZycpIHsKICAgICAgICBwYXRoID0gdGhpcy5wYXRobmFtZS5zcGxpdCgnLycpOwogICAgICAgIGJvYXJkID0gcGF0aFsxXTsKICAgICAgICB0aHJlYWRJRCA9IHBhdGhbM107CiAgICAgICAgcG9zdElEID0gdGhpcy5oYXNoLnNsaWNlKDIpOwogICAgICB9IGVsc2UgewogICAgICAgIGJvYXJkID0gdGhpcy5kYXRhc2V0LmJvYXJkOwogICAgICAgIHRocmVhZElEID0gMDsKICAgICAgICBwb3N0SUQgPSB0aGlzLmRhdGFzZXQuaWQ7CiAgICAgIH0KICAgICAgcXAgPSBVSS5lbCA9ICQuZWwoJ2RpdicsIHsKICAgICAgICBpZDogJ3FwJywKICAgICAgICBjbGFzc05hbWU6ICdyZXBseSBkaWFsb2cnCiAgICAgIH0pOwogICAgICBVSS5ob3ZlcihlKTsKICAgICAgJC5hZGQoZC5ib2R5LCBxcCk7CiAgICAgIGlmIChib2FyZCA9PT0gZy5CT0FSRCkgewogICAgICAgIGVsID0gJC5pZCgicCIgKyBwb3N0SUQpOwogICAgICB9CiAgICAgIEdldC5wb3N0V2l0aG91dFZpZGVvKGJvYXJkLCB0aHJlYWRJRCwgcG9zdElELCBxcCwgZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGJxLCBpbWcsIHBvc3Q7CiAgICAgICAgYnEgPSAkKCdibG9ja3F1b3RlJywgcXApOwogICAgICAgIE1haW4ucHJldHRpZnkoYnEpOwogICAgICAgIHBvc3QgPSB7CiAgICAgICAgICBlbDogcXAsCiAgICAgICAgICBibG9ja3F1b3RlOiBicSwKICAgICAgICAgIGlzQXJjaGl2ZWQ6IC9cYmFyY2hpdmVkUG9zdFxiLy50ZXN0KHFwLmNsYXNzTmFtZSkKICAgICAgICB9OwogICAgICAgIGlmIChpbWcgPSAkKCdpbWdbZGF0YS1tZDVdJywgcXApKSB7CiAgICAgICAgICBwb3N0LmZpbGVJbmZvID0gaW1nLnBhcmVudE5vZGUucHJldmlvdXNFbGVtZW50U2libGluZzsKICAgICAgICAgIHBvc3QuaW1nID0gaW1nOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnQWx3YXlzIENETiddKSB7CiAgICAgICAgICBBbHdheXNDZG4ubm9kZShwb3N0KTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbmZbJ1JldmVhbCBTcG9pbGVycyddKSB7CiAgICAgICAgICBSZXZlYWxTcG9pbGVycy5ub2RlKHBvc3QpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnSW1hZ2UgQXV0by1HaWYnXSkgewogICAgICAgICAgQXV0b0dpZi5ub2RlKHBvc3QpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnUmVwbGFjZSBQTkcnXSkgewogICAgICAgICAgUmVwbGFjZVBuZy5ub2RlKHBvc3QpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnUmVwbGFjZSBKUEcnXSkgewogICAgICAgICAgUmVwbGFjZUpwZy5ub2RlKHBvc3QpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnVGltZSBGb3JtYXR0aW5nJ10pIHsKICAgICAgICAgIFRpbWUubm9kZShwb3N0KTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbmZbJ0ZpbGUgSW5mbyBGb3JtYXR0aW5nJ10pIHsKICAgICAgICAgIEZpbGVJbmZvLm5vZGUocG9zdCk7CiAgICAgICAgfQogICAgICAgIGlmIChDb25mWydSZXN1cnJlY3QgUXVvdGVzJ10pIHsKICAgICAgICAgIFF1b3RpZnkubm9kZShwb3N0KTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbmZbJ0Fub255bWl6ZSddKSB7CiAgICAgICAgICByZXR1cm4gQW5vbnltaXplLm5vZGUocG9zdCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgJC5vbih0aGlzLCAnbW91c2Vtb3ZlJywgVUkuaG92ZXIpOwogICAgICAkLm9uKHRoaXMsICdtb3VzZW91dCBjbGljaycsIFF1b3RlUHJldmlldy5tb3VzZW91dCk7CiAgICAgIGlmICghZWwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1F1b3RlIEhpZ2hsaWdodGluZyddKSB7CiAgICAgICAgaWYgKC9cYm9wXGIvLnRlc3QoZWwuY2xhc3NOYW1lKSkgewogICAgICAgICAgJC5hZGRDbGFzcyhlbC5wYXJlbnROb2RlLCAncXBobCcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkLmFkZENsYXNzKGVsLCAncXBobCcpOwogICAgICAgIH0KICAgICAgfQogICAgICBxdW90ZXJJRCA9ICQueCgnYW5jZXN0b3I6OipbQGlkXVsxXScsIHRoaXMpLmlkLm1hdGNoKC9cZCskLylbMF07CiAgICAgIF9yZWYgPSAkJCgnLnF1b3RlbGluaywgLmJhY2tsaW5rJywgcXApOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBxdW90ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmIChxdW90ZS5oYXNoLnNsaWNlKDIpID09PSBxdW90ZXJJRCkgewogICAgICAgICAgJC5hZGRDbGFzcyhxdW90ZSwgJ2ZvcndhcmRsaW5rJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgbW91c2VvdXQ6IGZ1bmN0aW9uKGUpIHsKICAgICAgdmFyIGVsOwogICAgICBVSS5ob3ZlcmVuZCgpOwogICAgICBpZiAoZWwgPSAkLmlkKHRoaXMuaGFzaC5zbGljZSgxKSkpIHsKICAgICAgICAkLnJtQ2xhc3MoZWwsICdxcGhsJyk7CiAgICAgICAgJC5ybUNsYXNzKGVsLnBhcmVudE5vZGUsICdxcGhsJyk7CiAgICAgIH0KICAgICAgJC5vZmYodGhpcywgJ21vdXNlbW92ZScsIFVJLmhvdmVyKTsKICAgICAgcmV0dXJuICQub2ZmKHRoaXMsICdtb3VzZW91dCBjbGljaycsIFF1b3RlUHJldmlldy5tb3VzZW91dCk7CiAgICB9CiAgfTsKICAKICAvKiBBZGQgKFlvdSkgdG8gcG9zdHMgZnVuY3Rpb24gKi8KICBRdW90ZVlvdSA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIHF1b3RlLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaWYgKHBvc3QuaXNJbmxpbmVkICYmICFwb3N0LmlzQ3Jvc3Nwb3N0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIF9yZWYgPSBwb3N0LnF1b3RlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgcXVvdGUgPSBfcmVmW19pXTsKICAgICAgICB5b3VyUG9zdHNGcm9tU3RvcmFnZSA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgneW91clBvc3RzJykpOwogICAgICAgIGlmICh5b3VyUG9zdHNGcm9tU3RvcmFnZSkgewoJCQl2YXIgeW91clBvc3RzRnJvbVN0b3JhZ2VMZW5ndGggPSB5b3VyUG9zdHNGcm9tU3RvcmFnZS5sZW5ndGg7CgkJCWZvciAodmFyIHRlbXBJID0gMDsgdGVtcEkgPCB5b3VyUG9zdHNGcm9tU3RvcmFnZUxlbmd0aDsgdGVtcEkrKykgewoJCQkJaWYgKHF1b3RlLmhhc2guc2xpY2UoMikgPT09IHlvdXJQb3N0c0Zyb21TdG9yYWdlW3RlbXBJXSkgewoJCQkJCSQuYWRkKHF1b3RlLCAkLnRuKCdcdTAwQTAoWW91KScpKTsKCQkJCX0KCQkJfQoJCX0KCSAgfQogICAgfQogIH07CgogIFF1b3RlT1AgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBxdW90ZSwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGlmIChwb3N0LmlzSW5saW5lZCAmJiAhcG9zdC5pc0Nyb3NzcG9zdCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBfcmVmID0gcG9zdC5xdW90ZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHF1b3RlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHF1b3RlLmhhc2guc2xpY2UoMikgPT09IHBvc3QudGhyZWFkSUQpIHsKICAgICAgICAgICQuYWRkKHF1b3RlLCAkLnRuKCdcdTAwQTAoT1ApJykpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIFF1b3RlQ1QgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBwYXRoLCBxdW90ZSwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGlmIChwb3N0LmlzSW5saW5lZCAmJiAhcG9zdC5pc0Nyb3NzcG9zdCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBfcmVmID0gcG9zdC5xdW90ZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHF1b3RlID0gX3JlZltfaV07CiAgICAgICAgaWYgKCEocXVvdGUuaGFzaCAmJiAocXVvdGUuaG9zdG5hbWUgPT09ICdib2FyZHMuNGNoYW4ub3JnJyB8fCBxdW90ZS5ob3N0bmFtZSA9PT0gJ2JvYXJkcy40Y2hhbm5lbC5vcmcnKSAmJiAhL2NhdGFsb2ckLy50ZXN0KHF1b3RlLnBhdGhuYW1lKSkpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBwYXRoID0gcXVvdGUucGF0aG5hbWUuc3BsaXQoJy8nKTsKICAgICAgICBpZiAocGF0aFsxXSA9PT0gZy5CT0FSRCAmJiBwYXRoWzNdICE9PSBwb3N0LnRocmVhZElEKSB7CiAgICAgICAgICAkLmFkZChxdW90ZSwgJC50bignXHUwMEEwKENyb3NzLXRocmVhZCknKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKCiAgUXVvdGlmeSA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGEsIGJvYXJkLCBkZWFkbGluaywgaWQsIG0sIHBvc3RCb2FyZCwgcXVvdGUsIF9pLCBfbGVuLCBfcmVmLCBfcmVmMTsKICAgICAgaWYgKHBvc3QuaXNJbmxpbmVkICYmICFwb3N0LmlzQ3Jvc3Nwb3N0KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIF9yZWYgPSAkJCgnLmRlYWRsaW5rJywgcG9zdC5ibG9ja3F1b3RlKTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZGVhZGxpbmsgPSBfcmVmW19pXTsKICAgICAgICBpZiAoZGVhZGxpbmsucGFyZW50Tm9kZS5jbGFzc05hbWUgPT09ICdwcmV0dHlwcmludCcpIHsKICAgICAgICAgICQucmVwbGFjZShkZWFkbGluaywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZGVhZGxpbmsuY2hpbGROb2RlcykpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIHF1b3RlID0gZGVhZGxpbmsudGV4dENvbnRlbnQ7CiAgICAgICAgYSA9ICQuZWwoJ2EnLCB7CiAgICAgICAgICB0ZXh0Q29udGVudDogIiIgKyBxdW90ZSArICJcdTAwQTAoRGVhZCkiCiAgICAgICAgfSk7CiAgICAgICAgaWYgKCEoaWQgPSAoX3JlZjEgPSBxdW90ZS5tYXRjaCgvXGQrJC8pKSAhPSBudWxsID8gX3JlZjFbMF0gOiB2b2lkIDApKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgaWYgKG0gPSBxdW90ZS5tYXRjaCgvXj4+PlwvKFthLXpcZF0rKS8pKSB7CiAgICAgICAgICBib2FyZCA9IG1bMV07CiAgICAgICAgfSBlbHNlIGlmIChwb3N0Qm9hcmQpIHsKICAgICAgICAgIGJvYXJkID0gcG9zdEJvYXJkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBib2FyZCA9IHBvc3RCb2FyZCA9ICQoJ2FbdGl0bGU9IkxpbmsgdG8gdGhpcyBwb3N0Il0nLCBwb3N0LmVsKS5wYXRobmFtZS5zcGxpdCgnLycpWzFdOwogICAgICAgIH0KICAgICAgICBpZiAoYm9hcmQgPT09IGcuQk9BUkQgJiYgJC5pZCgicCIgKyBpZCkpIHsKICAgICAgICAgIGEuaHJlZiA9ICIjcCIgKyBpZDsKICAgICAgICAgIGEuY2xhc3NOYW1lID0gJ3F1b3RlbGluayc7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGEuaHJlZiA9IFJlZGlyZWN0LnRvKHsKICAgICAgICAgICAgYm9hcmQ6IGJvYXJkLAogICAgICAgICAgICB0aHJlYWRJRDogMCwKICAgICAgICAgICAgcG9zdElEOiBpZAogICAgICAgICAgfSk7CiAgICAgICAgICBhLmNsYXNzTmFtZSA9ICdkZWFkbGluayc7CiAgICAgICAgICBhLnRhcmdldCA9ICdfYmxhbmsnOwogICAgICAgICAgaWYgKFJlZGlyZWN0LnBvc3QoYm9hcmQsIGlkKSkgewogICAgICAgICAgICAkLmFkZENsYXNzKGEsICdxdW90ZWxpbmsnKTsKICAgICAgICAgICAgYS5zZXRBdHRyaWJ1dGUoJ2RhdGEtYm9hcmQnLCBib2FyZCk7CiAgICAgICAgICAgIGEuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgaWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkLnJlcGxhY2UoZGVhZGxpbmssIGEpOwogICAgICB9CiAgICB9CiAgfTsKCiAgRGVsZXRlTGluayA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYUltYWdlLCBhUG9zdCwgY2hpbGRyZW4sIGRpdjsKICAgICAgZGl2ID0gJC5lbCgnZGl2JywgewogICAgICAgIGNsYXNzTmFtZTogJ2RlbGV0ZV9saW5rJywKICAgICAgICB0ZXh0Q29udGVudDogJ0RlbGV0ZScKICAgICAgfSk7CiAgICAgIGFQb3N0ID0gJC5lbCgnYScsIHsKICAgICAgICBjbGFzc05hbWU6ICdkZWxldGVfcG9zdCcsCiAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycKICAgICAgfSk7CiAgICAgIGFJbWFnZSA9ICQuZWwoJ2EnLCB7CiAgICAgICAgY2xhc3NOYW1lOiAnZGVsZXRlX2ltYWdlJywKICAgICAgICBocmVmOiAnamF2YXNjcmlwdDo7JwogICAgICB9KTsKICAgICAgY2hpbGRyZW4gPSBbXTsKICAgICAgY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgZWw6IGFQb3N0LAogICAgICAgIG9wZW46IGZ1bmN0aW9uKCkgewogICAgICAgICAgYVBvc3QudGV4dENvbnRlbnQgPSAnUG9zdCc7CiAgICAgICAgICAkLm9uKGFQb3N0LCAnY2xpY2snLCBEZWxldGVMaW5rWyJkZWxldGUiXSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBjaGlsZHJlbi5wdXNoKHsKICAgICAgICBlbDogYUltYWdlLAogICAgICAgIG9wZW46IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgICAgIGlmICghcG9zdC5pbWcpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgYUltYWdlLnRleHRDb250ZW50ID0gJ0ltYWdlJzsKICAgICAgICAgICQub24oYUltYWdlLCAnY2xpY2snLCBEZWxldGVMaW5rWyJkZWxldGUiXSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBNZW51LmFkZEVudHJ5KHsKICAgICAgICBlbDogZGl2LAogICAgICAgIG9wZW46IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgICAgIHZhciBub2RlLCBzZWNvbmRzOwogICAgICAgICAgaWYgKHBvc3QuaXNBcmNoaXZlZCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBub2RlID0gZGl2LmZpcnN0Q2hpbGQ7CiAgICAgICAgICBpZiAoc2Vjb25kcyA9IERlbGV0ZUxpbmsuY29vbGRvd25bcG9zdC5JRF0pIHsKICAgICAgICAgICAgbm9kZS50ZXh0Q29udGVudCA9ICJEZWxldGUgKCIgKyBzZWNvbmRzICsgIikiOwogICAgICAgICAgICBEZWxldGVMaW5rLmNvb2xkb3duLmVsID0gbm9kZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5vZGUudGV4dENvbnRlbnQgPSAnRGVsZXRlJzsKICAgICAgICAgICAgZGVsZXRlIERlbGV0ZUxpbmsuY29vbGRvd24uZWw7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGNoaWxkcmVuOiBjaGlsZHJlbgogICAgICB9KTsKICAgICAgcmV0dXJuICQub24oZCwgJ1FSUG9zdFN1Y2Nlc3NmdWwnLCB0aGlzLmNvb2xkb3duLnN0YXJ0KTsKICAgIH0sCiAgICAiZGVsZXRlIjogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBib2FyZCwgZm9ybSwgaWQsIG0sIG1lbnUsIHB3ZCwgc2VsZjsKICAgICAgbWVudSA9ICQuaWQoJ21lbnUnKTsKICAgICAgaWQgPSBtZW51LmRhdGFzZXQuaWQ7CiAgICAgIGlmIChEZWxldGVMaW5rLmNvb2xkb3duW2lkXSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICAkLm9mZih0aGlzLCAnY2xpY2snLCBEZWxldGVMaW5rWyJkZWxldGUiXSk7CiAgICAgIHRoaXMudGV4dENvbnRlbnQgPSAnRGVsZXRpbmcuLi4nOwogICAgICBwd2QgPSAobSA9IGQuY29va2llLm1hdGNoKC80Y2hhbl9wYXNzPShbXjtdKykvKSkgPyBkZWNvZGVVUklDb21wb25lbnQobVsxXSkgOiAkLmlkKCdkZWxQYXNzd29yZCcpLnZhbHVlOwogICAgICBib2FyZCA9ICQoJ2FbdGl0bGU9IkxpbmsgdG8gdGhpcyBwb3N0Il0nLCAkLmlkKG1lbnUuZGF0YXNldC5yb290aWQpKS5wYXRobmFtZS5zcGxpdCgnLycpWzFdOwogICAgICBzZWxmID0gdGhpczsKICAgICAgZm9ybSA9IHsKICAgICAgICBtb2RlOiAndXNyZGVsJywKICAgICAgICBvbmx5aW1nZGVsOiAvXGJkZWxldGVfaW1hZ2VcYi8udGVzdCh0aGlzLmNsYXNzTmFtZSksCiAgICAgICAgcHdkOiBwd2QKICAgICAgfTsKICAgICAgZm9ybVtpZF0gPSAnZGVsZXRlJzsKICAgICAgcmV0dXJuICQuYWpheCgkLmlkKCdkZWxmb3JtJykuYWN0aW9uLnJlcGxhY2UoIi8iICsgZy5CT0FSRCArICIvIiwgIi8iICsgYm9hcmQgKyAiLyIpLCB7CiAgICAgICAgb25sb2FkOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBEZWxldGVMaW5rLmxvYWQoc2VsZiwgdGhpcy5yZXNwb25zZSk7CiAgICAgICAgfSwKICAgICAgICBvbmVycm9yOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBEZWxldGVMaW5rLmVycm9yKHNlbGYpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGZvcm06ICQuZm9ybURhdGEoZm9ybSkKICAgICAgfSk7CiAgICB9LAogICAgbG9hZDogZnVuY3Rpb24oc2VsZiwgaHRtbCkgewogICAgICB2YXIgZG9jLCBtc2csIHM7CiAgICAgIGRvYyA9IGQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCcnKTsKICAgICAgZG9jLmRvY3VtZW50RWxlbWVudC5pbm5lckhUTUwgPSBodG1sOwogICAgICBpZiAoZG9jLnRpdGxlID09PSAnNGNoYW4gLSBCYW5uZWQnKSB7CiAgICAgICAgcyA9ICdCYW5uZWQhJzsKICAgICAgfSBlbHNlIGlmIChtc2cgPSBkb2MuZ2V0RWxlbWVudEJ5SWQoJ2Vycm1zZycpKSB7CiAgICAgICAgcyA9IG1zZy50ZXh0Q29udGVudDsKICAgICAgICAkLm9uKHNlbGYsICdjbGljaycsIERlbGV0ZUxpbmtbImRlbGV0ZSJdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzID0gJ0RlbGV0ZWQnOwogICAgICB9CiAgICAgIHJldHVybiBzZWxmLnRleHRDb250ZW50ID0gczsKICAgIH0sCiAgICBlcnJvcjogZnVuY3Rpb24oc2VsZikgewogICAgICBzZWxmLnRleHRDb250ZW50ID0gJ0Nvbm5lY3Rpb24gZXJyb3IsIHBsZWFzZSByZXRyeS4nOwogICAgICByZXR1cm4gJC5vbihzZWxmLCAnY2xpY2snLCBEZWxldGVMaW5rWyJkZWxldGUiXSk7CiAgICB9LAogICAgY29vbGRvd246IHsKICAgICAgc3RhcnQ6IGZ1bmN0aW9uKGUpIHsKICAgICAgICB2YXIgc2Vjb25kczsKICAgICAgICBzZWNvbmRzID0gNjA7CiAgICAgICAgcmV0dXJuIERlbGV0ZUxpbmsuY29vbGRvd24uY291bnQoZS5kZXRhaWwucG9zdElELCBzZWNvbmRzLCBzZWNvbmRzKTsKICAgICAgfSwKICAgICAgY291bnQ6IGZ1bmN0aW9uKHBvc3RJRCwgc2Vjb25kcywgbGVuZ3RoKSB7CiAgICAgICAgdmFyIGVsOwogICAgICAgIGlmICghKCgwIDw9IHNlY29uZHMgJiYgc2Vjb25kcyA8PSBsZW5ndGgpKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzZXRUaW1lb3V0KERlbGV0ZUxpbmsuY29vbGRvd24uY291bnQsIDEwMDAsIHBvc3RJRCwgc2Vjb25kcyAtIDEsIGxlbmd0aCk7CiAgICAgICAgZWwgPSBEZWxldGVMaW5rLmNvb2xkb3duLmVsOwogICAgICAgIGlmIChzZWNvbmRzID09PSAwKSB7CiAgICAgICAgICBpZiAoZWwgIT0gbnVsbCkgewogICAgICAgICAgICBlbC50ZXh0Q29udGVudCA9ICdEZWxldGUnOwogICAgICAgICAgfQogICAgICAgICAgZGVsZXRlIERlbGV0ZUxpbmsuY29vbGRvd25bcG9zdElEXTsKICAgICAgICAgIGRlbGV0ZSBEZWxldGVMaW5rLmNvb2xkb3duLmVsOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoZWwgIT0gbnVsbCkgewogICAgICAgICAgZWwudGV4dENvbnRlbnQgPSAiRGVsZXRlICgiICsgc2Vjb25kcyArICIpIjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIERlbGV0ZUxpbmsuY29vbGRvd25bcG9zdElEXSA9IHNlY29uZHM7CiAgICAgIH0KICAgIH0KICB9OwoKICBSZXBvcnRMaW5rID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhOwogICAgICBhID0gJC5lbCgnYScsIHsKICAgICAgICBjbGFzc05hbWU6ICdyZXBvcnRfbGluaycsCiAgICAgICAgaHJlZjogJ2phdmFzY3JpcHQ6OycsCiAgICAgICAgdGV4dENvbnRlbnQ6ICdSZXBvcnQgdGhpcyBwb3N0JwogICAgICB9KTsKICAgICAgJC5vbihhLCAnY2xpY2snLCB0aGlzLnJlcG9ydCk7CiAgICAgIHJldHVybiBNZW51LmFkZEVudHJ5KHsKICAgICAgICBlbDogYSwKICAgICAgICBvcGVuOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgICAgICByZXR1cm4gcG9zdC5pc0FyY2hpdmVkID09PSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHJlcG9ydDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhLCBpZCwgc2V0LCB1cmw7CiAgICAgIGEgPSAkKCdhW3RpdGxlPSJMaW5rIHRvIHRoaXMgcG9zdCJdJywgJC5pZCh0aGlzLnBhcmVudE5vZGUuZGF0YXNldC5yb290aWQpKTsKICAgICAgdXJsID0gIi8vc3lzLjRjaGFuLm9yZy8iICsgKGEucGF0aG5hbWUuc3BsaXQoJy8nKVsxXSkgKyAiL2ltZ2JvYXJkLnBocD9tb2RlPXJlcG9ydCZubz0iICsgdGhpcy5wYXJlbnROb2RlLmRhdGFzZXQuaWQ7CiAgICAgIGlkID0gRGF0ZS5ub3coKTsKICAgICAgc2V0ID0gInRvb2xiYXI9MCxzY3JvbGxiYXJzPTEsbG9jYXRpb249MCxzdGF0dXM9MSxtZW51YmFyPTAscmVzaXphYmxlPTEsIjsKICAgICAgaWYgKENvbmZbJ0FsdGVybmF0aXZlIGNhcHRjaGEnXSkgewogICAgICAgICAgdXJsICs9ICImYWx0Yz0xIjsKICAgICAgICAgIHNldCArPSAnd2lkdGg9MzUwLGhlaWdodD0yNzUnOwogICAgICB9IGVsc2UgewogICAgICAgICAgc2V0ICs9ICd3aWR0aD00MDAsaGVpZ2h0PTU1MCc7CiAgICAgIH0KICAgICAgcmV0dXJuIHdpbmRvdy5vcGVuKHVybCwgaWQsIHNldCk7CiAgICB9CiAgfTsKCiAgRG93bmxvYWRMaW5rID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhOwogICAgICBpZiAoJC5lbCgnYScpLmRvd25sb2FkID09PSB2b2lkIDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYSA9ICQuZWwoJ2EnLCB7CiAgICAgICAgY2xhc3NOYW1lOiAnZG93bmxvYWRfbGluaycsCiAgICAgICAgdGV4dENvbnRlbnQ6ICdEb3dubG9hZCBmaWxlJwogICAgICB9KTsKICAgICAgaWYoJC5lbmdpbmUgPT09ICJnZWNrbyIgfHwgJC5lbmdpbmUgPT09ICJ3ZWJraXQiKSB7CiAgICAgICAgJC5vbihhLCAnY2xpY2snLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICBpZiAodGhpcy5wcm90b2NvbCA9PT0gJ2Jsb2I6JykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIHJldHVybiBEb3dubG9hZExpbmsuZmlyZWZveERMKHRoaXMuaHJlZiwgKGZ1bmN0aW9uKF90aGlzKSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihibG9iKSB7CiAgICAgICAgICAgICAgaWYgKGJsb2IpIHsKICAgICAgICAgICAgICAgIF90aGlzLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNsaWNrKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgfSkodGhpcykpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBNZW51LmFkZEVudHJ5KHsKICAgICAgICBlbDogYSwKICAgICAgICBvcGVuOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgICAgICBpZiAoIXBvc3QuaW1nKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICAgIGEuaHJlZiA9IHBvc3QuaW1nLnBhcmVudE5vZGUuaHJlZjsKICAgICAgICAgIGEuZG93bmxvYWQgPSAocG9zdC5maWxlSW5mbyAmJiBwb3N0LmZpbGVJbmZvLmdldEF0dHJpYnV0ZSgnZGF0YS1maWxlbmFtZScpKTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZmlyZWZveERMOiAoZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIG1ha2VCbG9iOwogICAgICAgIG1ha2VCbG9iID0gZnVuY3Rpb24odXJsQmxvYiwgY29udGVudFR5cGUsIGNvbnRlbnREaXNwb3NpdGlvbiwgdXJsKSB7CiAgICAgICAgICB2YXIgYmxvYiwgbWF0Y2gsIG1pbWUsIG5hbWUsIF9yZWYsIF9yZWYxLCBfcmVmMjsKICAgICAgICAgIG5hbWUgPSAoX3JlZiA9IHVybC5tYXRjaCgvKFteXC9dKylcLyokLykpICE9IG51bGwgPyBfcmVmWzFdIDogdm9pZCAwOwogICAgICAgICAgbWltZSA9IChjb250ZW50VHlwZSAhPSBudWxsID8gY29udGVudFR5cGUubWF0Y2goL1teO10qLylbMF0gOiB2b2lkIDApIHx8ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nOwogICAgICAgICAgbWF0Y2ggPSAoY29udGVudERpc3Bvc2l0aW9uICE9IG51bGwgPyAoX3JlZjEgPSBjb250ZW50RGlzcG9zaXRpb24ubWF0Y2goL1xiZmlsZW5hbWVccyo9XHMqIigoXFwifFteIl0pKykiL2kpKSAhPSBudWxsID8gX3JlZjFbMV0gOiB2b2lkIDAgOiB2b2lkIDApIHx8IChjb250ZW50VHlwZSAhPSBudWxsID8gKF9yZWYyID0gY29udGVudFR5cGUubWF0Y2goL1xibmFtZVxzKj1ccyoiKChcXCJ8W14iXSkrKSIvaSkpICE9IG51bGwgPyBfcmVmMlsxXSA6IHZvaWQgMCA6IHZvaWQgMCk7CiAgICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgbmFtZSA9IG1hdGNoLnJlcGxhY2UoL1xcIi9nLCAnIicpOwogICAgICAgICAgfQogICAgICAgICAgYmxvYiA9IG5ldyBCbG9iKFt1cmxCbG9iXSwgewogICAgICAgICAgICB0eXBlOiBtaW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIGJsb2IubmFtZSA9IG5hbWU7CiAgICAgICAgICByZXR1cm4gYmxvYjsKICAgICAgICB9OwogICAgICAgIHJldHVybiBmdW5jdGlvbih1cmwsIGNiKSB7CiAgICAgICAgICByZXR1cm4gR01feG1saHR0cFJlcXVlc3QoewogICAgICAgICAgICBtZXRob2Q6ICJHRVQiLAogICAgICAgICAgICB1cmw6IHVybCwKICAgICAgICAgICAgb3ZlcnJpZGVNaW1lVHlwZTogInRleHQvcGxhaW47IGNoYXJzZXQ9eC11c2VyLWRlZmluZWQiLAogICAgICAgICAgICBvbmxvYWQ6IGZ1bmN0aW9uKHhocikgewogICAgICAgICAgICAgIHZhciBjb250ZW50RGlzcG9zaXRpb24sIGNvbnRlbnRUeXBlLCBkYXRhLCBpLCByLCBfcmVmLCBfcmVmMTsKICAgICAgICAgICAgICByID0geGhyLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoci5sZW5ndGgpOwogICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgIHdoaWxlIChpIDwgci5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGRhdGFbaV0gPSByLmNoYXJDb2RlQXQoaSk7CiAgICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNvbnRlbnRUeXBlID0gKF9yZWYgPSB4aHIucmVzcG9uc2VIZWFkZXJzLm1hdGNoKC9Db250ZW50LVR5cGU6XHMqKC4qKS9pKSkgIT0gbnVsbCA/IF9yZWZbMV0gOiB2b2lkIDA7CiAgICAgICAgICAgICAgY29udGVudERpc3Bvc2l0aW9uID0gKF9yZWYxID0geGhyLnJlc3BvbnNlSGVhZGVycy5tYXRjaCgvQ29udGVudC1EaXNwb3NpdGlvbjpccyooLiopL2kpKSAhPSBudWxsID8gX3JlZjFbMV0gOiB2b2lkIDA7CiAgICAgICAgICAgICAgcmV0dXJuIGNiKG1ha2VCbG9iKGRhdGEsIGNvbnRlbnRUeXBlLCBjb250ZW50RGlzcG9zaXRpb24sIHVybCkpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbmVycm9yOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICByZXR1cm4gY2IobnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH07CiAgICAgIH0pKCkKICB9OwoKICBBcmNoaXZlTGluayA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZGl2LCBlbnRyeSwgdHlwZSwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIGRpdiA9ICQuZWwoJ2RpdicsIHsKICAgICAgICB0ZXh0Q29udGVudDogJ0FyY2hpdmUnCiAgICAgIH0pOwogICAgICBlbnRyeSA9IHsKICAgICAgICBlbDogZGl2LAogICAgICAgIG9wZW46IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgICAgIHZhciBwYXRoOwogICAgICAgICAgcGF0aCA9ICQoJ2FbdGl0bGU9IkxpbmsgdG8gdGhpcyBwb3N0Il0nLCBwb3N0LmVsKS5wYXRobmFtZS5zcGxpdCgnLycpOwogICAgICAgICAgaWYgKChSZWRpcmVjdC50byh7CiAgICAgICAgICAgIGJvYXJkOiBwYXRoWzFdLAogICAgICAgICAgICB0aHJlYWRJRDogcGF0aFszXSwKICAgICAgICAgICAgcG9zdElEOiBwb3N0LklECiAgICAgICAgICB9KSkgPT09ICgiLy9ib2FyZHMuNGNoYW4ub3JnLyIgKyBwYXRoWzFdICsgIi8iKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBwb3N0LmluZm8gPSBbcGF0aFsxXSwgcGF0aFszXV07CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAogICAgICAgIGNoaWxkcmVuOiBbXQogICAgICB9OwogICAgICBfcmVmID0gW1snUG9zdCcsICdhcG9zdCddLCBbJ05hbWUnLCAnbmFtZSddLCBbJ1RyaXBjb2RlJywgJ3RyaXBjb2RlJ10sIFsnU3ViamVjdCcsICdzdWJqZWN0J10sIFsnRmlsZW5hbWUnLCAnZmlsZW5hbWUnXSwgWydJbWFnZSBNRDUnLCAnbWQ1J11dOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICB0eXBlID0gX3JlZltfaV07CiAgICAgICAgZW50cnkuY2hpbGRyZW4ucHVzaCh0aGlzLmNyZWF0ZVN1YkVudHJ5KHR5cGVbMF0sIHR5cGVbMV0pKTsKICAgICAgfQogICAgICByZXR1cm4gTWVudS5hZGRFbnRyeShlbnRyeSk7CiAgICB9LAogICAgY3JlYXRlU3ViRW50cnk6IGZ1bmN0aW9uKHRleHQsIHR5cGUpIHsKICAgICAgdmFyIGVsLCBvcGVuOwogICAgICBlbCA9ICQuZWwoJ2EnLCB7CiAgICAgICAgdGV4dENvbnRlbnQ6IHRleHQsCiAgICAgICAgdGFyZ2V0OiAnX2JsYW5rJwogICAgICB9KTsKICAgICAgb3BlbiA9IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgICB2YXIgdmFsdWU7CiAgICAgICAgaWYgKHR5cGUgPT09ICdhcG9zdCcpIHsKICAgICAgICAgIGVsLmhyZWYgPSBSZWRpcmVjdC50byh7CiAgICAgICAgICAgIGJvYXJkOiBwb3N0LmluZm9bMF0sCiAgICAgICAgICAgIHRocmVhZElEOiBwb3N0LmluZm9bMV0sCiAgICAgICAgICAgIHBvc3RJRDogcG9zdC5JRAogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgdmFsdWUgPSBGaWx0ZXJbdHlwZV0ocG9zdCk7CiAgICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZWwuaHJlZiA9IFJlZGlyZWN0LnRvKHsKICAgICAgICAgIGJvYXJkOiBwb3N0LmluZm9bMF0sCiAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgICAgaXNTZWFyY2g6IHRydWUKICAgICAgICB9KTsKICAgICAgfTsKICAgICAgcmV0dXJuIHsKICAgICAgICBlbDogZWwsCiAgICAgICAgb3Blbjogb3BlbgogICAgICB9OwogICAgfQogIH07CgogIFRocmVhZFN0YXRzID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkaWFsb2c7CiAgICAgIGRpYWxvZyA9IFVJLmRpYWxvZygnc3RhdHMnLCAnYm90dG9tOiAwOyBsZWZ0OiAwOycsICc8ZGl2IGNsYXNzPW1vdmU+PHNwYW4gaWQ9cG9zdGNvdW50PjA8L3NwYW4+IC8gPHNwYW4gaWQ9aW1hZ2Vjb3VudD4wPC9zcGFuPjxzcGFuIGlkPXBvc3RlcmNvdW50Pjwvc3Bhbj48c3BhbiBpZD1jdXJyZW50cGFnZT48L3NwYW4+PC9kaXY+Jyk7CiAgICAgIGRpYWxvZy5jbGFzc05hbWUgPSAnZGlhbG9nJzsKICAgICAgJC5hZGQoZC5ib2R5LCBkaWFsb2cpOwogICAgICB0aGlzLnBvc3RzID0gdGhpcy5pbWFnZXMgPSAwOwogICAgICB0aGlzLmltZ0xpbWl0ID0gKGZ1bmN0aW9uKCkgewogICAgICAgIHN3aXRjaCAoZy5CT0FSRCkgewogICAgICAgICAgY2FzZSAnYSc6CiAgICAgICAgICBjYXNlICdiJzoKICAgICAgICAgIGNhc2UgJ3YnOgogICAgICAgICAgY2FzZSAnY28nOgogICAgICAgICAgY2FzZSAnbWxwJzoKICAgICAgICAgICAgcmV0dXJuIDI1MTsKICAgICAgICAgIGNhc2UgJ2pwJzoKICAgICAgICAgICAgcmV0dXJuIDMwMTsKICAgICAgICAgIGNhc2UgJ3ZnJzoKICAgICAgICAgICAgcmV0dXJuIDM3NjsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIHJldHVybiAxNTE7CiAgICAgICAgfQogICAgICB9KSgpOwogICAgICB0aGlzLnBhZ2VHcmFkaWVudHMgPSB7CiAgICAgICAgMTAgOiAnRkYwMDAwJywKICAgICAgICA5IDogJ0U1MDAxOScsCiAgICAgICAgOCA6ICdDQzAwMzMnLAogICAgICAgIDcgOiAnQjIwMDRDJywKICAgICAgICA2IDogJzk5MDA2NicsCiAgICAgICAgNSA6ICc3RjAwN0YnLAogICAgICAgIDQgOiAnNjUwMDk5JywKICAgICAgICAzIDogJzRDMDBCMicsCiAgICAgICAgMiA6ICczMzAwQ0MnLAogICAgICAgIDEgOiAnMTkwMEU1JwogICAgICB9OwogICAgICB0aGlzLnBhZ2Vwb3NHcmFkaWVudHMgPSB7CiAgICAgICAgMTUgOiAnRkYwMDExJywKICAgICAgICAxNCA6ICdFRTAwMjInLAogICAgICAgIDEzIDogJ0REMDAzMycsCiAgICAgICAgMTIgOiAnQ0MwMDQ0JywKICAgICAgICAxMSA6ICdCQjAwNTUnLAogICAgICAgIDEwIDogJ0FBMDA2NicsCiAgICAgICAgOSA6ICc5OTAwNzcnLAogICAgICAgIDggOiAnODgwMDg4JywKICAgICAgICA3IDogJzc3MDA5OScsCiAgICAgICAgNiA6ICc2NjAwQUEnLAogICAgICAgIDUgOiAnNTUwMEJCJywKICAgICAgICA0IDogJzQ0MDBDQycsCiAgICAgICAgMyA6ICczMzAwREQnLAogICAgICAgIDIgOiAnMjIwMEVFJywKICAgICAgICAxIDogJzExMDBGRicKICAgICAgfTsKICAgICAgaWYgKENvbmZbJ0N1cnJlbnQgUGFnZSddKSB7CiAgICAgICAgdGhpcy5wYWdlSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChUaHJlYWRTdGF0cy5mZXRjaFBhZ2VzLCAyICogJC5NSU5VVEUpOwogICAgICAgIHNldFRpbWVvdXQoVGhyZWFkU3RhdHMuZmV0Y2hQYWdlcywgMiAqICQuU0VDT05EKTsgLyogSW50ZXJ2YWwgc3RhcnRzIHdpdGggdGhlIHRpbWVvdXQsIHNvIGV4ZWN1dGUgaXQgdGhpcyB3YXkgdGhlIGZpcnN0IHRpbWUgKi8KICAgICAgfQogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIG5vZGU6IGZ1bmN0aW9uKHBvc3QpIHsKICAgICAgdmFyIGltZ2NvdW50OwogICAgICBpZiAocG9zdC5pc0lubGluZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgJC5pZCgncG9zdGNvdW50JykudGV4dENvbnRlbnQgPSArK1RocmVhZFN0YXRzLnBvc3RzOwogICAgICBpZiAoIXBvc3QuaW1nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGltZ2NvdW50ID0gJC5pZCgnaW1hZ2Vjb3VudCcpOwogICAgICBpbWdjb3VudC50ZXh0Q29udGVudCA9ICsrVGhyZWFkU3RhdHMuaW1hZ2VzOwogICAgICBpZiAoVGhyZWFkU3RhdHMuaW1hZ2VzID4gVGhyZWFkU3RhdHMuaW1nTGltaXQpIHsKICAgICAgICByZXR1cm4gJC5hZGRDbGFzcyhpbWdjb3VudCwgJ3dhcm5pbmcnKTsKICAgICAgfQogICAgfSwKICAgIHBvc3RlckNvdW50OiBmdW5jdGlvbihwb3N0ZXJfY291bnQpIHsKICAgICAgJC5pZCgncG9zdGVyY291bnQnKS50ZXh0Q29udGVudCA9ICcgLyAnICsgcG9zdGVyX2NvdW50OwogICAgfSwKICAgIGZldGNoUGFnZXM6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcmVxdWVzdCwgdXJsOwogICAgICByZXF1ZXN0ID0gVGhyZWFkU3RhdHMucmVxdWVzdDsKICAgICAgaWYgKHJlcXVlc3QpIHsKICAgICAgICByZXF1ZXN0Lm9ubG9hZGVuZCA9IG51bGw7CiAgICAgICAgcmVxdWVzdC5hYm9ydCgpOwogICAgICB9CiAgICAgIHVybCA9ICIvL2EuNGNkbi5vcmcvIiArIGcuQk9BUkQgKyAiL3RocmVhZHMuanNvbiI7CiAgICAgIHJldHVybiBUaHJlYWRTdGF0cy5yZXF1ZXN0ID0gJC5hamF4KHVybCwgewogICAgICAgIG9ubG9hZGVuZDogVGhyZWFkU3RhdHMudXBkYXRlUGFnZQogICAgICB9KTsKICAgIH0sCiAgICB1cGRhdGVQYWdlOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKCEoQ29uZlsnQ3VycmVudCBQYWdlJ10gJiYgdGhpcy5zdGF0dXMgPT09IDIwMCkpIHsKICAgICAgICByZXR1cm4gZGVsZXRlIFRocmVhZFN0YXRzLnJlcXVlc3Q7CiAgICAgIH0KICAgICAgdmFyIG5ld2NvbnRlbnQsIHBhZ2UsIHBhZ2VfY29sb3IsIHBhZ2Vwb3MsIHBhZ2Vwb3NfY29sb3IsIHRocmVhZCwgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZjE7CiAgICAgIHZhciBwYXJzZWRfdGhyZWFkcyA9IEpTT04ucGFyc2UodGhpcy5yZXNwb25zZSk7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gcGFyc2VkX3RocmVhZHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwYWdlID0gcGFyc2VkX3RocmVhZHNbX2ldOwogICAgICAgIF9yZWYxID0gcGFnZS50aHJlYWRzOwogICAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgdGhyZWFkID0gX3JlZjFbX2pdOwogICAgICAgICAgaWYgKCEodGhyZWFkLm5vID09IGcuVEhSRUFEX0lEKSkgewogICAgICAgICAgICBjb250aW51ZTsgLyogPT0gYmVjYXVzZSBnLlRIUkVBRF9JRCBpcyBhIHN0cmluZyAqLwogICAgICAgICAgfQogICAgICAgICAgcGFnZV9jb2xvciA9IHBhZ2UucGFnZSBpbiBUaHJlYWRTdGF0cy5wYWdlR3JhZGllbnRzID8gVGhyZWFkU3RhdHMucGFnZUdyYWRpZW50c1twYWdlLnBhZ2VdIDogJzAwMDAwMCc7CiAgICAgICAgICBuZXdjb250ZW50ID0gJyAvICcgKyAnPHNwYW4gc3R5bGU9ImNvbG9yOiMnICsgcGFnZV9jb2xvciArICc7Ij4nICsgcGFyc2VJbnQocGFnZS5wYWdlKSArICc8L3NwYW4+JzsgLyogcGFyc2VJbnQganVzdCB0byBlc2NhcGUgKi8KICAgICAgICAgIGlmIChDb25mWydDdXJyZW50IFBhZ2UgUG9zaXRpb24nXSkgewogICAgICAgICAgICBwYWdlcG9zID0gX2ogKyAxOwogICAgICAgICAgICBwYWdlcG9zX2NvbG9yID0gcGFnZXBvcyBpbiBUaHJlYWRTdGF0cy5wYWdlcG9zR3JhZGllbnRzID8gVGhyZWFkU3RhdHMucGFnZXBvc0dyYWRpZW50c1twYWdlcG9zXSA6ICcwMDAwMDAnOwogICAgICAgICAgICBuZXdjb250ZW50ICs9ICcgKCcgKyAnPHNwYW4gc3R5bGU9ImNvbG9yOiMnICsgcGFnZXBvc19jb2xvciArICc7Ij4nICsgcGFnZXBvcyArICc8L3NwYW4+JyArICfiiJUnICsgX3JlZjEubGVuZ3RoICsgJyknOwogICAgICAgICAgfQogICAgICAgICAgJC5pZCgnY3VycmVudHBhZ2UnKS5pbm5lckhUTUwgPSBuZXdjb250ZW50OwogICAgICAgICAgcmV0dXJuIGRlbGV0ZSBUaHJlYWRTdGF0cy5yZXF1ZXN0OwogICAgICAgIH0KICAgICAgfQogICAgICAvKiBJZiB3ZSBnZXQgaGVyZSB0aGUgdGhyZWFkIHdhcyBub3QgZm91bmQgaW4gdGhlIGNhdGFsb2csIHN0b3AgdXBkYXRpbmcgKi8KICAgICAgY2xlYXJJbnRlcnZhbChUaHJlYWRTdGF0cy5wYWdlSW50ZXJ2YWwpOwogICAgICAkLmlkKCdjdXJyZW50cGFnZScpLnRleHRDb250ZW50ID0gJyAvIFgnOwogICAgICBkZWxldGUgVGhyZWFkU3RhdHMucmVxdWVzdDsKICAgIH0KICB9OwoKICBVbnJlYWQgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50aXRsZSA9IGQudGl0bGU7CiAgICAgICQub24oZCwgJ1FSUG9zdFN1Y2Nlc3NmdWwnLCB0aGlzLnBvc3QpOwogICAgICB0aGlzLnVwZGF0ZSgpOwogICAgICAkLm9uKHdpbmRvdywgJ3Njcm9sbCcsIFVucmVhZC5zY3JvbGwpOwogICAgICByZXR1cm4gTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgfSwKICAgIHJlcGxpZXM6IFtdLAogICAgZm9yZXNlZTogW10sCiAgICBwb3N0OiBmdW5jdGlvbihlKSB7CiAgICAgIHJldHVybiBVbnJlYWQuZm9yZXNlZS5wdXNoKGUuZGV0YWlsLnBvc3RJRCk7CiAgICB9LAogICAgbm9kZTogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgY291bnQsIGVsLCBpbmRleDsKICAgICAgaWYgKChpbmRleCA9IFVucmVhZC5mb3Jlc2VlLmluZGV4T2YocG9zdC5JRCkpICE9PSAtMSkgewogICAgICAgIFVucmVhZC5mb3Jlc2VlLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGVsID0gcG9zdC5lbDsKICAgICAgaWYgKGVsLmhpZGRlbiB8fCAvXGJvcFxiLy50ZXN0KHBvc3RbImNsYXNzIl0pIHx8IHBvc3QuaXNJbmxpbmVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvdW50ID0gVW5yZWFkLnJlcGxpZXMucHVzaChlbCk7CiAgICAgIHJldHVybiBVbnJlYWQudXBkYXRlKGNvdW50ID09PSAxKTsKICAgIH0sCiAgICBzY3JvbGw6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYm90dG9tLCBoZWlnaHQsIGksIHJlcGx5LCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaGVpZ2h0ID0gZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OwogICAgICBfcmVmID0gVW5yZWFkLnJlcGxpZXM7CiAgICAgIGZvciAoaSA9IF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IGkgPSArK19pKSB7CiAgICAgICAgcmVwbHkgPSBfcmVmW2ldOwogICAgICAgIGJvdHRvbSA9IHJlcGx5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbTsKICAgICAgICBpZiAoYm90dG9tID4gaGVpZ2h0KSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgVW5yZWFkLnJlcGxpZXMgPSBVbnJlYWQucmVwbGllcy5zbGljZShpKTsKICAgICAgcmV0dXJuIFVucmVhZC51cGRhdGUoVW5yZWFkLnJlcGxpZXMubGVuZ3RoID09PSAwKTsKICAgIH0sCiAgICBzZXRUaXRsZTogZnVuY3Rpb24oY291bnQpIHsKICAgICAgaWYgKHRoaXMuc2NoZWR1bGVkKSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2NoZWR1bGVkKTsKICAgICAgICBkZWxldGUgVW5yZWFkLnNjaGVkdWxlZDsKICAgICAgICB0aGlzLnNldFRpdGxlKGNvdW50KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVkID0gc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIGQudGl0bGUgPSAiKCIgKyBjb3VudCArICIpICIgKyBVbnJlYWQudGl0bGU7CiAgICAgIH0pLCA1KTsKICAgIH0sCiAgICB1cGRhdGU6IGZ1bmN0aW9uKHVwZGF0ZUZhdmljb24pIHsKICAgICAgdmFyIGNvdW50OwogICAgICBpZiAoIWcuUkVQTFkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY291bnQgPSB0aGlzLnJlcGxpZXMubGVuZ3RoOwogICAgICBpZiAoQ29uZlsnVW5yZWFkIENvdW50J10pIHsKICAgICAgICB0aGlzLnNldFRpdGxlKGNvdW50KTsKICAgICAgfQogICAgICBpZiAoIShDb25mWydVbnJlYWQgRmF2aWNvbiddICYmIHVwZGF0ZUZhdmljb24pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICgkLmVuZ2luZSA9PT0gJ3ByZXN0bycpIHsKICAgICAgICAkLnJtKEZhdmljb24uZWwpOwogICAgICB9CiAgICAgIEZhdmljb24uZWwuaHJlZiA9IGcuZGVhZCA/IGNvdW50ID8gRmF2aWNvbi51bnJlYWREZWFkIDogRmF2aWNvbi5kZWFkIDogY291bnQgPyBGYXZpY29uLnVucmVhZCA6IEZhdmljb25bImRlZmF1bHQiXTsKICAgICAgaWYgKGcuZGVhZCkgewogICAgICAgICQuYWRkQ2xhc3MoRmF2aWNvbi5lbCwgJ2RlYWQnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkLnJtQ2xhc3MoRmF2aWNvbi5lbCwgJ2RlYWQnKTsKICAgICAgfQogICAgICBpZiAoY291bnQpIHsKICAgICAgICAkLmFkZENsYXNzKEZhdmljb24uZWwsICd1bnJlYWQnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAkLnJtQ2xhc3MoRmF2aWNvbi5lbCwgJ3VucmVhZCcpOwogICAgICB9CiAgICAgIGlmICgkLmVuZ2luZSAhPT0gJ3dlYmtpdCcpIHsKICAgICAgICByZXR1cm4gJC5hZGQoZC5oZWFkLCBGYXZpY29uLmVsKTsKICAgICAgfQogICAgfQogIH07CgogIEZhdmljb24gPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGhyZWY7CiAgICAgIGlmICh0aGlzLmVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuZWwgPSAkKCdsaW5rW3JlbD0ic2hvcnRjdXQgaWNvbiJdJywgZC5oZWFkKTsKICAgICAgdGhpcy5lbC50eXBlID0gJ2ltYWdlL3gtaWNvbic7CiAgICAgIGhyZWYgPSB0aGlzLmVsLmhyZWY7CiAgICAgIHRoaXMuU0ZXID0gL3dzLmljbyQvLnRlc3QoaHJlZik7CiAgICAgIHRoaXNbImRlZmF1bHQiXSA9IGhyZWY7CiAgICAgIHJldHVybiB0aGlzWyJzd2l0Y2giXSgpOwogICAgfSwKICAgICJzd2l0Y2giOiBmdW5jdGlvbigpIHsKICAgICAgc3dpdGNoIChDb25mWydmYXZpY29uJ10pIHsKICAgICAgICBjYXNlICdmZXJvbmdyJzoKICAgICAgICAgIHRoaXMudW5yZWFkRGVhZCA9ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhFQUFRQU9NSEFPZ0xBbk1GQUw4QUFPZ0xBdWtNQS8rQWdQK3JxLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8veUg1QkFFS0FBY0FMQUFBQUFBUUFCQUFBQVJaOE1oSjZ4d0RXSUJ2K0FNMWZFRUlCSVZSbE5LWXJ0cElFQ3VHenV3cENMZzk3NEVZaVhVWWtVSXRqR2JDNlZRNG9tWEZpS1JPQTZxU3kwQThuQW85R1MzWUNzd0lXbk92TEFpMGJlMjNaMVF0ZFNVYXFYY3ZpUUFBT3c9PSc7CiAgICAgICAgICB0aGlzLnVucmVhZFNGVyA9ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhFQUFRQU9NSEFBRFg4UUJ3ZmdDMnpBRFg4UURZOG5ubDhxTHA4di8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8veUg1QkFFS0FBY0FMQUFBQUFBUUFCQUFBQVJaOE1oSjZ4d0RXSUJ2K0FNMWZFRUlCSVZSbE5LWXJ0cElFQ3VHenV3cENMZzk3NEVZaVhVWWtVSXRqR2JDNlZRNG9tWEZpS1JPQTZxU3kwQThuQW85R1MzWUNzd0lXbk92TEFpMGJlMjNaMVF0ZFNVYXFYY3ZpUUFBT3c9PSc7CiAgICAgICAgICB0aGlzLnVucmVhZE5TRlcgPSAnZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoRUFBUUFPTUhBRlQrQUNoNUFFbmNBRlQrQUZYL0Fjei9zdTcvNXYvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL3lINUJBRUtBQWNBTEFBQUFBQVFBQkFBQUFSWjhNaEo2eHdEV0lCditBTTFmRUVJQklWUmxOS1lydHBJRUN1R3p1d3BDTGc5NzRFWWlYVVlrVUl0akdiQzZWUTRvbVhGaUtST0E2cVN5MEE4bkFvOUdTM1lDc3dJV25PdkxBaTBiZTIzWjFRdGRTVWFxWGN2aVFBQU93PT0nOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAneGF0LSc6CiAgICAgICAgICB0aGlzLnVucmVhZERlYWQgPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQTJFbEVRVlE0eTYxVFFRckNNQkRNUThXRElFVjZMYlQyQTRvZzJIcTB2ZW83ZklBSDA0ZFk5TjR4bXlZbHBHbUkyTUNRVFdZeTNXeTJEQUQ3QjJ3V0F6V2djVGdWZVpLbFpSeEhOWUZpMmpNMThvQmgwSWNLdEM2aXhmMjJXVDRJRkxzMG93eHN3WHU5ZWdtMExzNmJ3ZkNGZk5zSllKS2Zxb0VrZDN2Z1VnRlZMV09idHpOZ1ZLeXJ1QytsalN6cjVPRW5Cemp2amNRZWNhUWhiWmdCYjRDbUdRdytQb01rVFV0ZGJkOFZTRVBha2NHeFBPY3NvSWdVS3kwTGVjWTI5Qm1kQnJxUmZqSXdaOTNLTHM1bG9IdkJuTDNjTEgvakYrQy8rejVkZ1V5c0FBQUFBRWxGVGtTdVFtQ0MnOwogICAgICAgICAgdGhpcy51bnJlYWRTRlcgPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQTMwbEVRVlE0eTJQNC8vOC9BeVdZZ1NvR1FNRi9HSjdZMTFWVlVWb3lLVE05ZXk0SWc5Z2dNV1ExWUExSUJ2elhtMzRZamtIOG1QeUpCK05xbHA4RllSQWJteG9NRjZBclNOcnc2VDBRZjhBbWg5Y0ZNRVdWUi83L0ErTC91T1J4aGdFSXQ1LysvMy8ybGYvLzV3QXhpSTB1ais0Q0JsQmd4VlV2T3d0eWRnWFFacERtaTIvKy83LzBHbUlRU0F3a0IxSURVa3VVQVplQUJseCtnMnpBWjl3R2xBT2pDaGJhK0x3QVVnTlNpMkhBNUFtOVZjaUJoU3NRUVd5b1dnWmlvdkVEc2RHSTFRQllRaUxKQUdRYWxwU3h5V0V6QUpZV2tHbThjbFRKalFDWjFoa29WRzBDeWdBQUFBQkpSVTVFcmtKZ2dnPT0nOwogICAgICAgICAgdGhpcy51bnJlYWROU0ZXID0gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUE0RWxFUVZRNHkyUDQvLzgvQXlXWWdTb0dRTUYvR0o3WU5iR3FyS1JpVW5wMjFsd1FCckZCWXNocXdCcVFEUGlmZHNZWWprSDhtSW54QitPV3g1OEZZUkFibXhvTUY2QXJLUG1VOUI2SVAyQ1R3K3NDbUtLZS81WC9nUGcvTG5tY1lRRENzLzYzLzEvOWZ6WVF6d0d6MGVYUlhjQUFDcXk0WmZGblFjN3UrVi94RDZUNTV2K0xRSHdKYkJCSURDUUhVZ05TUzVRQnQ0Q2FiLzIvakREZ014NER5a3JLSjhGQ0c1OFhRR3BBYWpFTW1Odzd1UW81c0hBRklvZ05WY3RBVERSK0lEWWFzUm9BUzBna0dZQk13NUl5Tmpsc0JzRFNBaktOVjQ0cXVSRUF4NThNcjl2dDV3UUFBQUFBU1VWT1JLNUNZSUk9JzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ01heWhlbSc6CiAgICAgICAgICB0aGlzLnVucmVhZERlYWQgPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQklVbEVRVlE0aloyU2NXdURNQkRGZ3c0cElrVTBXc29Ra1dBWUlrWFpINE45LysvVjNkbWZYU3JLWUlGSHd0MTdqOHZkR1dOTUlrZ0Z1YURnemdRbndSczRFUXM1S2RvbFVRdGFnUk4wZ2l2RURCVEVPamd0R3MwWnE4RjdjS3FxdXNWeHJNUUxhRFVXY2pCU3JYa244Z3M1MXRwSlNXTGs5YjNIVWEwYU5JTDVnUEJSMS9WNGtKdlI3bFR3bDhHbUFtMUdmOStjM1MrODlxQkhhODUwMkFzbVNydEJhRUJQYkliajBhaDJtYWRsTkFQRWNjZGdKRGZBdFdpZkJqcVdLU2hSQlQ2S29pSDhRbEVVbi9xdDBDQ2puTmRtUFV3bUZXemo5T2U2THBLdVpYY3dxcTg4ejc4UGNoM2FaVTNkUHd3YzJzV2xmWktDVzV0V2x1VjhrR3ZYQ2xMbTZkWU40L2FVcWZDYm5FT3pOREdoR1piTmFyZ3Z4Q3p2TUdmUkpEOFVhRFZ2Z2t6bzZRQUFBQUJKUlU1RXJrSmdnZz09JzsKICAgICAgICAgIHRoaXMudW5yZWFkU0ZXID0gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUJDRWxFUVZRNGpaMlM0Y3JDTUF4RiswT0dESkVQS1lySUdLT3NpSlN4L2ZKUmZTQWZUSk55S3FYZml1RGcwQzI1TjJSSmpUR21FVnJoVHpodzdvU3RzSUV0c1Z6VDRvMkpvOUFMVGhpRU04SWRISWdOYUhvOG1qTldnNi9za2U4Ym9oUG8rNjNRT0x6bW9vSHA4ZnlBSUNCU1FrVnowUUtkc0ZRRVY2V1NXL0QrNytCYmdiSURIY2I0S3A2MVh5anlJMTZ6WjhKZW1HbHRRdERCU0d4QjQvR29OKzdUcGtrakRDc0ZBcm0wSVl2M1UwQmJuWXRmOEJDeStKeXRzRTBYNlZ5dUtoUFBLL0dBSjE0a3ZaWkRaVlYzcFpJYjhNWnI2bjRvNFBER0tuMFM1U2REbXlxNVBuWFFzaytYYmhpbnAwM0ZGem1ISnc2eFlSaVdtOVZ4bm9oWjN2T2N4ZE84QVJtWFJ2YldkdHpRQUFBQUFFbEZUa1N1UW1DQyc7CiAgICAgICAgICB0aGlzLnVucmVhZE5TRlcgPSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCQUFBQUFRQ0FZQUFBQWY4LzloQUFBQkNrbEVRVlE0aloyUzBXckRNQXhGL1RCQ0NLV01ZaFpLQ1NHWW1GSk1TTmpEL21oZjIzOXFKWE5jakJkVFdPRGdSTHBYS0pLTk1hWVJPdUZUT0hFZWhGYjRnSlpZcnVud3hzU1hNQXBPbUlRendnT2NpRTFvUmp5YU0xYURqK3lSN3h1aUh2VDlWbWdjWG5QUndPLzkrd1dDZ0VnSkZjMUZDd3pDVmhGY2xVcHV3L3UzZzNjRnlnNTBHUE9qZVBaK29jalBlTTJSQ1h0aHBiVUZ3UUF6c1EyTng2UGV1RStiSm8wdzdCUUk1TktHTE41WEFXMTFMWDdCUThqaWE3YkNMbDJrYzdtcVRMenV4QU9lZUpIMFdrNlZWZjBvbGR5RU4xNVQ5NDhDRG0rc01pWlJmakswcFpJYlV3Y2QrM1RwaG5GNjJsUjhrWE40NGhBYmhtRzVXUU5uVDh6eW51Y3NudVlKaEZwQmZrTXpxRDRBQUFBQVNVVk9SSzVDWUlJPSc7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdPcmlnaW5hbCc6CiAgICAgICAgICB0aGlzLnVucmVhZERlYWQgPSAnZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoRUFBUUFLRUNBQUFBQVA4QUFQLy8vLy8vL3lINUJBRUtBQU1BTEFBQUFBQVFBQkFBQUFJL25JOTV3c3F5Z0lSeERnR0NCaFRyd0YzWnhvd2c1SDFjU29wUzZGckdRODJQVTE5NTFja1JtWUtKVkNYaXpMUkM5a0FuVDBhSWlSNmxDRlQxY2lnQUFEcz0nOwogICAgICAgICAgdGhpcy51bnJlYWRTRlcgPSAnZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoRUFBUUFLRUNBQUFBQUM2WHcvLy8vLy8vL3lINUJBRUtBQU1BTEFBQUFBQVFBQkFBQUFJL25JOTV3c3F5Z0lSeERnR0NCaFRyd0YzWnhvd2c1SDFjU29wUzZGckdRODJQVTE5NTFja1JtWUtKVkNYaXpMUkM5a0FuVDBhSWlSNmxDRlQxY2lnQUFEcz0nOwogICAgICAgICAgdGhpcy51bnJlYWROU0ZXID0gJ2RhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEVBQVFBS0VDQUFBQUFHYk1NLy8vLy8vLy95SDVCQUVLQUFNQUxBQUFBQUFRQUJBQUFBSS9uSTk1d3NxeWdJUnhEZ0dDQmhUcndGM1p4b3dnNUgxY1NvcFM2RnJHUTgyUFUxOTUxY2tSbVlLSlZDWGl6TFJDOWtBblQwYUlpUjZsQ0ZUMWNpZ0FBRHM9JzsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy51bnJlYWQgPSB0aGlzLlNGVyA/IHRoaXMudW5yZWFkU0ZXIDogdGhpcy51bnJlYWROU0ZXOwogICAgfSwKICAgIGVtcHR5OiAnZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoRUFBUUFKRUFBQUFBQVAvLy85dmIyLy8vL3lINUJBRUFBQU1BTEFBQUFBQVFBQkFBQUFJdm5JK3BxK0Q5REJBVW9Ga1BGbmJzN2xGWktJSk9KSjNNeXJhb0IxNGpGcE9jVk1wenJuRjNPS2xaWXNNV293QUFPdz09JywKICAgIGRlYWQ6ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhFQUFRQUtFQ0FBQUFBUDhBQVAvLy8vLy8veUg1QkFFS0FBSUFMQUFBQUFBUUFCQUFBQUl2bEkrcHErRDlEQWdVb0ZrUERsYnM3bEZaS0lKT0pKM015cmFvQjE0akZwT2NWTXB6cm5GM09LbFpZc01Xb3dBQU93PT0nCiAgfTsKCiAgUmVkaXJlY3QgPSB7CiAgICBpbWFnZTogZnVuY3Rpb24oYm9hcmQsIGZpbGVuYW1lKSB7CiAgICAgIHN3aXRjaCAoYm9hcmQpIHsKICAgICAgICBjYXNlICdhZHYnOgogICAgICAgIGNhc2UgJ2YnOgogICAgICAgIGNhc2UgJ2hyJzoKICAgICAgICBjYXNlICdtbHBvbCc6CiAgICAgICAgY2FzZSAnbW8nOgogICAgICAgIGNhc2UgJ28nOgogICAgICAgIGNhc2UgJ3BvbCc6CiAgICAgICAgY2FzZSAnczRzJzoKICAgICAgICBjYXNlICdzcCc6CiAgICAgICAgY2FzZSAndHJ2JzoKICAgICAgICBjYXNlICd0dic6CiAgICAgICAgY2FzZSAneCc6CiAgICAgICAgICByZXR1cm4gIi8vYXJjaGl2ZS40cGxlYnMub3JnLyIgKyBib2FyZCArICIvZnVsbF9pbWFnZS8iICsgZmlsZW5hbWU7CiAgICAgICAgY2FzZSAnYmFudCc6CiAgICAgICAgY2FzZSAnYyc6CiAgICAgICAgY2FzZSAnY29uJzoKICAgICAgICBjYXNlICdlJzoKICAgICAgICBjYXNlICduJzoKICAgICAgICBjYXNlICduZXdzJzoKICAgICAgICBjYXNlICdvdXQnOgogICAgICAgIGNhc2UgJ3AnOgogICAgICAgIGNhc2UgJ3RveSc6CiAgICAgICAgY2FzZSAndm1nJzoKICAgICAgICBjYXNlICd2cCc6CiAgICAgICAgY2FzZSAndnN0JzoKICAgICAgICBjYXNlICd3JzoKICAgICAgICBjYXNlICd3Zyc6CiAgICAgICAgY2FzZSAnd3NyJzoKICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly9hcmNoaXZlLm55YWZ1dS5vcmcvIiArIGJvYXJkICsgIi9mdWxsX2ltYWdlLyIgKyBmaWxlbmFtZTsKICAgICAgICBjYXNlICdjZ2wnOgogICAgICAgIGNhc2UgJ2cnOgogICAgICAgIGNhc2UgJ211JzoKICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly9hcmNoaXZlLnJlYmVjY2FibGFja3RlY2guY29tLyIgKyBib2FyZCArICIvZnVsbF9pbWFnZS8iICsgZmlsZW5hbWU7CiAgICAgICAgY2FzZSAnMyc6CiAgICAgICAgY2FzZSAnYml6JzoKICAgICAgICBjYXNlICdjayc6CiAgICAgICAgY2FzZSAnZGl5JzoKICAgICAgICBjYXNlICdmYSc6CiAgICAgICAgY2FzZSAnaWMnOgogICAgICAgIGNhc2UgJ2pwJzoKICAgICAgICBjYXNlICdsaXQnOgogICAgICAgIGNhc2UgJ3NjaSc6CiAgICAgICAgY2FzZSAndGcnOgogICAgICAgIGNhc2UgJ3ZyJzoKICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly93YXJvc3Uub3JnLyIgKyBib2FyZCArICIvZnVsbF9pbWFnZS8iICsgZmlsZW5hbWU7CiAgICAgICAgY2FzZSAnYSc6CiAgICAgICAgY2FzZSAnYWNvJzoKICAgICAgICBjYXNlICdhbic6CiAgICAgICAgY2FzZSAnY28nOgogICAgICAgIGNhc2UgJ2QnOgogICAgICAgIGNhc2UgJ2ZpdCc6CiAgICAgICAgY2FzZSAnZ2lmJzoKICAgICAgICBjYXNlICdoaXMnOgogICAgICAgIGNhc2UgJ2ludCc6CiAgICAgICAgY2FzZSAnayc6CiAgICAgICAgY2FzZSAnbSc6CiAgICAgICAgY2FzZSAnbWxwJzoKICAgICAgICBjYXNlICdxJzoKICAgICAgICBjYXNlICdxYSc6CiAgICAgICAgY2FzZSAncjlrJzoKICAgICAgICBjYXNlICd0cmFzaCc6CiAgICAgICAgY2FzZSAnd3NnJzoKICAgICAgICAgIHJldHVybiAiLy9kZXN1YXJjaGl2ZS5vcmcvIiArIGJvYXJkICsgIi9mdWxsX2ltYWdlLyIgKyBmaWxlbmFtZTsKICAgICAgICBjYXNlICdjbSc6CiAgICAgICAgY2FzZSAndmlwJzoKICAgICAgICBjYXNlICd5JzoKICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly9ib2FyZHMuZmlyZWRlbi5uZXQvIiArIGJvYXJkICsgIi9mdWxsX2ltYWdlLyIgKyBmaWxlbmFtZTsKICAgICAgICBjYXNlICdjYW4nOgogICAgICAgIGNhc2UgJ2NvY2snOgogICAgICAgIGNhc2UgJ2ZhcCc6CiAgICAgICAgY2FzZSAnZml0bGl0JzoKICAgICAgICBjYXNlICdnZCc6CiAgICAgICAgY2FzZSAnbXR2JzoKICAgICAgICBjYXNlICdvdXRzb2MnOgogICAgICAgIGNhc2UgJ3BvJzoKICAgICAgICBjYXNlICdxc3QnOgogICAgICAgIGNhc2UgJ3NwYSc6CiAgICAgICAgY2FzZSAndmludCc6CiAgICAgICAgICByZXR1cm4gIi8vYXJjaGl2ZWQubW9lLyIgKyBib2FyZCArICIvZnVsbF9pbWFnZS8iICsgZmlsZW5hbWU7CiAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICByZXR1cm4gIi8vdGhlYmFyY2hpdmUuY29tLyIgKyBib2FyZCArICIvZnVsbF9pbWFnZS8iICsgZmlsZW5hbWU7CiAgICAgICAgY2FzZSAnaCc6CiAgICAgICAgY2FzZSAnaGMnOgogICAgICAgIGNhc2UgJ2htJzoKICAgICAgICBjYXNlICdpJzoKICAgICAgICBjYXNlICdsZ2J0JzoKICAgICAgICBjYXNlICdyJzoKICAgICAgICBjYXNlICdzJzoKICAgICAgICBjYXNlICdzb2MnOgogICAgICAgIGNhc2UgJ3QnOgogICAgICAgIGNhc2UgJ3UnOgogICAgICAgICAgcmV0dXJuICIvL2FyY2hpdmVvZnNpbnMuY29tLyIgKyBib2FyZCArICIvZnVsbF9pbWFnZS8iICsgZmlsZW5hbWU7CiAgICAgICAgY2FzZSAndnJwZyc6CiAgICAgICAgICByZXR1cm4gImh0dHBzOi8vd3d3LnRva3lvY2hyb25vcy5uZXQvIiArIGJvYXJkICsgIi9mdWxsX2ltYWdlLyIgKyBmaWxlbmFtZTsKICAgICAgfQogICAgfSwKICAgIHBvc3Q6IGZ1bmN0aW9uKGJvYXJkLCBwb3N0SUQpIHsKICAgICAgc3dpdGNoIChib2FyZCkgewogICAgICAgIGNhc2UgJ2Fkdic6CiAgICAgICAgY2FzZSAnZic6CiAgICAgICAgY2FzZSAnaHInOgogICAgICAgIGNhc2UgJ21scG9sJzoKICAgICAgICBjYXNlICdtbyc6CiAgICAgICAgY2FzZSAnbyc6CiAgICAgICAgY2FzZSAncG9sJzoKICAgICAgICBjYXNlICdzNHMnOgogICAgICAgIGNhc2UgJ3NwJzoKICAgICAgICBjYXNlICd0cnYnOgogICAgICAgIGNhc2UgJ3R2JzoKICAgICAgICBjYXNlICd4JzoKICAgICAgICAgIHJldHVybiAiLy9hcmNoaXZlLjRwbGVicy5vcmcvXy9hcGkvY2hhbi9wb3N0Lz9ib2FyZD0iICsgYm9hcmQgKyAiJm51bT0iICsgcG9zdElEOwogICAgICAgIGNhc2UgJ2JhbnQnOgogICAgICAgIGNhc2UgJ2MnOgogICAgICAgIGNhc2UgJ2Nvbic6CiAgICAgICAgY2FzZSAnZSc6CiAgICAgICAgY2FzZSAnbic6CiAgICAgICAgY2FzZSAnbmV3cyc6CiAgICAgICAgY2FzZSAnb3V0JzoKICAgICAgICBjYXNlICdwJzoKICAgICAgICBjYXNlICd0b3knOgogICAgICAgIGNhc2UgJ3ZtZyc6CiAgICAgICAgY2FzZSAndnAnOgogICAgICAgIGNhc2UgJ3ZzdCc6CiAgICAgICAgY2FzZSAndyc6CiAgICAgICAgY2FzZSAnd2cnOgogICAgICAgIGNhc2UgJ3dzcic6CiAgICAgICAgICByZXR1cm4gImh0dHBzOi8vYXJjaGl2ZS5ueWFmdXUub3JnL18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgICBjYXNlICdjZ2wnOgogICAgICAgIGNhc2UgJ2cnOgogICAgICAgIGNhc2UgJ211JzoKICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly9hcmNoaXZlLnJlYmVjY2FibGFja3RlY2guY29tL18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgICBjYXNlICdhJzoKICAgICAgICBjYXNlICdhY28nOgogICAgICAgIGNhc2UgJ2FuJzoKICAgICAgICBjYXNlICdjbyc6CiAgICAgICAgY2FzZSAnZCc6CiAgICAgICAgY2FzZSAnZml0JzoKICAgICAgICBjYXNlICdnaWYnOgogICAgICAgIGNhc2UgJ2hpcyc6CiAgICAgICAgY2FzZSAnaW50JzoKICAgICAgICBjYXNlICdrJzoKICAgICAgICBjYXNlICdtJzoKICAgICAgICBjYXNlICdtbHAnOgogICAgICAgIGNhc2UgJ3EnOgogICAgICAgIGNhc2UgJ3FhJzoKICAgICAgICBjYXNlICdyOWsnOgogICAgICAgIGNhc2UgJ3RyYXNoJzoKICAgICAgICBjYXNlICd3c2cnOgogICAgICAgICAgcmV0dXJuICIvL2Rlc3VhcmNoaXZlLm9yZy9fL2FwaS9jaGFuL3Bvc3QvP2JvYXJkPSIgKyBib2FyZCArICImbnVtPSIgKyBwb3N0SUQ7CiAgICAgICAgY2FzZSAnY20nOgogICAgICAgIGNhc2UgJ3ZpcCc6CiAgICAgICAgY2FzZSAneSc6CiAgICAgICAgICByZXR1cm4gImh0dHBzOi8vYm9hcmRzLmZpcmVkZW4ubmV0L18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgICBjYXNlICd2JzoKICAgICAgICBjYXNlICd2Zyc6CiAgICAgICAgY2FzZSAndm0nOgogICAgICAgIGNhc2UgJ3ZycGcnOgogICAgICAgICAgcmV0dXJuICIvL2FyY2guYjRrLmNvL18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgICBjYXNlICdobSc6CiAgICAgICAgY2FzZSAncXN0JzoKICAgICAgICAgIHJldHVybiAiaHR0cHM6Ly9hcmNoaXZlLmItc3RhdHMub3JnL18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgICBjYXNlICdhc3AnOgogICAgICAgIGNhc2UgJ2Nhbic6CiAgICAgICAgY2FzZSAnY29jayc6CiAgICAgICAgY2FzZSAnZmFwJzoKICAgICAgICBjYXNlICdmaXRsaXQnOgogICAgICAgIGNhc2UgJ2dkJzoKICAgICAgICBjYXNlICdtdHYnOgogICAgICAgIGNhc2UgJ291dHNvYyc6CiAgICAgICAgY2FzZSAncG8nOgogICAgICAgIGNhc2UgJ3NwYSc6CiAgICAgICAgY2FzZSAndmludCc6CiAgICAgICAgICByZXR1cm4gIi8vYXJjaGl2ZWQubW9lL18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgICBjYXNlICdiJzoKICAgICAgICAgIHJldHVybiAiLy90aGViYXJjaGl2ZS5jb20vXy9hcGkvY2hhbi9wb3N0Lz9ib2FyZD0iICsgYm9hcmQgKyAiJm51bT0iICsgcG9zdElEOwogICAgICAgIGNhc2UgJ2gnOgogICAgICAgIGNhc2UgJ2hjJzoKICAgICAgICBjYXNlICdpJzoKICAgICAgICBjYXNlICdsZ2J0JzoKICAgICAgICBjYXNlICdyJzoKICAgICAgICBjYXNlICdzJzoKICAgICAgICBjYXNlICdzb2MnOgogICAgICAgIGNhc2UgJ3QnOgogICAgICAgIGNhc2UgJ3UnOgogICAgICAgICAgcmV0dXJuICIvL2FyY2hpdmVvZnNpbnMuY29tL18vYXBpL2NoYW4vcG9zdC8/Ym9hcmQ9IiArIGJvYXJkICsgIiZudW09IiArIHBvc3RJRDsKICAgICAgfQogICAgfSwKICAgIHRvOiBmdW5jdGlvbihkYXRhKSB7CiAgICAgIHZhciBib2FyZCwgdGhyZWFkSUQsIHVybDsKICAgICAgaWYgKCFkYXRhLmlzU2VhcmNoKSB7CiAgICAgICAgdGhyZWFkSUQgPSBkYXRhLnRocmVhZElEOwogICAgICB9CiAgICAgIGJvYXJkID0gZGF0YS5ib2FyZDsKICAgICAgc3dpdGNoIChib2FyZCkgewogICAgICAgIGNhc2UgJ2Fkdic6CiAgICAgICAgY2FzZSAnZic6CiAgICAgICAgY2FzZSAnaHInOgogICAgICAgIGNhc2UgJ21scG9sJzoKICAgICAgICBjYXNlICdtbyc6CiAgICAgICAgY2FzZSAnbyc6CiAgICAgICAgY2FzZSAncG9sJzoKICAgICAgICBjYXNlICdzNHMnOgogICAgICAgIGNhc2UgJ3NwJzoKICAgICAgICBjYXNlICd0cnYnOgogICAgICAgIGNhc2UgJ3R2JzoKICAgICAgICBjYXNlICd4JzoKICAgICAgICAgIHVybCA9IFJlZGlyZWN0LnBhdGgoJy8vYXJjaGl2ZS40cGxlYnMub3JnJywgJ2Zvb2xmdXVrYScsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnYmFudCc6CiAgICAgICAgY2FzZSAnYyc6CiAgICAgICAgY2FzZSAnY29uJzoKICAgICAgICBjYXNlICdlJzoKICAgICAgICBjYXNlICduJzoKICAgICAgICBjYXNlICduZXdzJzoKICAgICAgICBjYXNlICdvdXQnOgogICAgICAgIGNhc2UgJ3AnOgogICAgICAgIGNhc2UgJ3RveSc6CiAgICAgICAgY2FzZSAndm1nJzoKICAgICAgICBjYXNlICd2cCc6CiAgICAgICAgY2FzZSAndnN0JzoKICAgICAgICBjYXNlICd3JzoKICAgICAgICBjYXNlICd3Zyc6CiAgICAgICAgY2FzZSAnd3NyJzoKICAgICAgICAgIHVybCA9IFJlZGlyZWN0LnBhdGgoJ2h0dHBzOi8vYXJjaGl2ZS5ueWFmdXUub3JnJywgJ2Zvb2xmdXVrYScsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnY2dsJzoKICAgICAgICBjYXNlICdnJzoKICAgICAgICBjYXNlICdtdSc6CiAgICAgICAgICB1cmwgPSBSZWRpcmVjdC5wYXRoKCdodHRwczovL2FyY2hpdmUucmViZWNjYWJsYWNrdGVjaC5jb20nLCAnZm9vbGZ1dWthJywgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICczJzoKICAgICAgICBjYXNlICdiaXonOgogICAgICAgIGNhc2UgJ2NrJzoKICAgICAgICBjYXNlICdkaXknOgogICAgICAgIGNhc2UgJ2ZhJzoKICAgICAgICBjYXNlICdpYyc6CiAgICAgICAgY2FzZSAnanAnOgogICAgICAgIGNhc2UgJ2xpdCc6CiAgICAgICAgY2FzZSAnc2NpJzoKICAgICAgICBjYXNlICd0Zyc6CiAgICAgICAgY2FzZSAndnInOgogICAgICAgICAgdXJsID0gUmVkaXJlY3QucGF0aCgnaHR0cHM6Ly93YXJvc3Uub3JnJywgJ2Z1dWthJywgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdhJzoKICAgICAgICBjYXNlICdhY28nOgogICAgICAgIGNhc2UgJ2FuJzoKICAgICAgICBjYXNlICdjbyc6CiAgICAgICAgY2FzZSAnZCc6CiAgICAgICAgY2FzZSAnZml0JzoKICAgICAgICBjYXNlICdnaWYnOgogICAgICAgIGNhc2UgJ2hpcyc6CiAgICAgICAgY2FzZSAnaW50JzoKICAgICAgICBjYXNlICdrJzoKICAgICAgICBjYXNlICdtJzoKICAgICAgICBjYXNlICdtbHAnOgogICAgICAgIGNhc2UgJ3EnOgogICAgICAgIGNhc2UgJ3FhJzoKICAgICAgICBjYXNlICdyOWsnOgogICAgICAgIGNhc2UgJ3RyYXNoJzoKICAgICAgICBjYXNlICd3c2cnOgogICAgICAgICAgdXJsID0gUmVkaXJlY3QucGF0aCgnLy9kZXN1YXJjaGl2ZS5vcmcnLCAnZm9vbGZ1dWthJywgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdjbSc6CiAgICAgICAgY2FzZSAndmlwJzoKICAgICAgICBjYXNlICd5JzoKICAgICAgICAgIHVybCA9IFJlZGlyZWN0LnBhdGgoJ2h0dHBzOi8vYm9hcmRzLmZpcmVkZW4ubmV0JywgJ2Zvb2xmdXVrYScsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAndic6CiAgICAgICAgY2FzZSAndmcnOgogICAgICAgIGNhc2UgJ3ZtJzoKICAgICAgICBjYXNlICd2cnBnJzoKICAgICAgICAgIHVybCA9IFJlZGlyZWN0LnBhdGgoJy8vYXJjaC5iNGsuY28nLCAnZm9vbGZ1dWthJywgZGF0YSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdobSc6CiAgICAgICAgY2FzZSAncXN0JzoKICAgICAgICAgIHVybCA9IFJlZGlyZWN0LnBhdGgoJ2h0dHBzOi8vYXJjaGl2ZS5iLXN0YXRzLm9yZycsICdmb29sZnV1a2EnLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2FzcCc6CiAgICAgICAgY2FzZSAnY2FuJzoKICAgICAgICBjYXNlICdjb2NrJzoKICAgICAgICBjYXNlICdmYXAnOgogICAgICAgIGNhc2UgJ2ZpdGxpdCc6CiAgICAgICAgY2FzZSAnZ2QnOgogICAgICAgIGNhc2UgJ210dic6CiAgICAgICAgY2FzZSAnb3V0c29jJzoKICAgICAgICBjYXNlICdwbyc6CiAgICAgICAgY2FzZSAnc3BhJzoKICAgICAgICBjYXNlICd2aW50JzoKICAgICAgICAgIHVybCA9IFJlZGlyZWN0LnBhdGgoJy8vYXJjaGl2ZWQubW9lJywgJ2Zvb2xmdXVrYScsIGRhdGEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnYic6CiAgICAgICAgICB1cmwgPSBSZWRpcmVjdC5wYXRoKCcvL3RoZWJhcmNoaXZlLmNvbScsICdmb29sZnV1a2EnLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2gnOgogICAgICAgIGNhc2UgJ2hjJzoKICAgICAgICBjYXNlICdpJzoKICAgICAgICBjYXNlICdsZ2J0JzoKICAgICAgICBjYXNlICdyJzoKICAgICAgICBjYXNlICdzJzoKICAgICAgICBjYXNlICdzb2MnOgogICAgICAgIGNhc2UgJ3QnOgogICAgICAgIGNhc2UgJ3UnOgogICAgICAgICAgdXJsID0gUmVkaXJlY3QucGF0aCgnLy9hcmNoaXZlb2ZzaW5zLmNvbScsICdmb29sZnV1a2EnLCBkYXRhKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBpZiAodGhyZWFkSUQpIHsKICAgICAgICAgICAgdXJsID0gIi8vYm9hcmRzLjRjaGFuLm9yZy8iICsgYm9hcmQgKyAiLyI7CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHVybCB8fCBudWxsOwogICAgfSwKICAgIHBhdGg6IGZ1bmN0aW9uKGJhc2UsIGFyY2hpdmVyLCBkYXRhKSB7CiAgICAgIHZhciBib2FyZCwgcGF0aCwgcG9zdElELCB0aHJlYWRJRCwgdHlwZSwgdmFsdWU7CiAgICAgIGlmIChkYXRhLmlzU2VhcmNoKSB7CiAgICAgICAgYm9hcmQgPSBkYXRhLmJvYXJkLCB0eXBlID0gZGF0YS50eXBlLCB2YWx1ZSA9IGRhdGEudmFsdWU7CiAgICAgICAgdHlwZSA9IHR5cGUgPT09ICduYW1lJyA/ICd1c2VybmFtZScgOiB0eXBlID09PSAnbWQ1JyA/ICdpbWFnZScgOiB0eXBlOwogICAgICAgIHZhbHVlID0gZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKTsKICAgICAgICBpZiAoYXJjaGl2ZXIgPT09ICdmb29sZnV1a2EnKSB7CiAgICAgICAgICByZXR1cm4gIiIgKyBiYXNlICsgIi8iICsgYm9hcmQgKyAiL3NlYXJjaC8iICsgdHlwZSArICIvIiArIHZhbHVlOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2ltYWdlJykgewogICAgICAgICAgcmV0dXJuICIiICsgYmFzZSArICIvIiArIGJvYXJkICsgIi8/dGFzaz1zZWFyY2gyJnNlYXJjaF9tZWRpYV9oYXNoPSIgKyB2YWx1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuICIiICsgYmFzZSArICIvIiArIGJvYXJkICsgIi8/dGFzaz1zZWFyY2gyJnNlYXJjaF8iICsgdHlwZSArICI9IiArIHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgICBib2FyZCA9IGRhdGEuYm9hcmQsIHRocmVhZElEID0gZGF0YS50aHJlYWRJRCwgcG9zdElEID0gZGF0YS5wb3N0SUQ7CiAgICAgIGlmIChwb3N0SUQpIHsKICAgICAgICBwb3N0SUQgPSBwb3N0SUQubWF0Y2goL1xkKy8pWzBdOwogICAgICB9CiAgICAgIHBhdGggPSB0aHJlYWRJRCA/ICIiICsgYm9hcmQgKyAiL3RocmVhZC8iICsgdGhyZWFkSUQgOiAiIiArIGJvYXJkICsgIi9wb3N0LyIgKyBwb3N0SUQ7CiAgICAgIGlmIChhcmNoaXZlciA9PT0gJ2Zvb2xmdXVrYScpIHsKICAgICAgICBwYXRoICs9ICcvJzsKICAgICAgfQogICAgICBpZiAodGhyZWFkSUQgJiYgcG9zdElEKSB7CiAgICAgICAgcGF0aCArPSBhcmNoaXZlciA9PT0gJ2Zvb2xmdXVrYScgPyAiIyIgKyBwb3N0SUQgOiAiI3AiICsgcG9zdElEOwogICAgICB9CiAgICAgIHJldHVybiAiIiArIGJhc2UgKyAiLyIgKyBwYXRoOwogICAgfQogIH07CgogIEltYWdlSG92ZXIgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIGlmICghcG9zdC5pbWcgfHwgcG9zdC5oYXNQZGYpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmV0dXJuICQub24ocG9zdC5pbWcsICdtb3VzZW92ZXInLCBJbWFnZUhvdmVyLm1vdXNlb3Zlcik7CiAgICB9LAogICAgbW91c2VvdmVyOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGVsOwogICAgICBpZiAoZWwgPSAkLmlkKCdpaG92ZXInKSkgewogICAgICAgIGlmIChlbCA9PT0gVUkuZWwpIHsKICAgICAgICAgIGRlbGV0ZSBVSS5lbDsKICAgICAgICB9CiAgICAgICAgJC5ybShlbCk7CiAgICAgIH0KICAgICAgaWYgKFVJLmVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICgvXC53ZWJtJC8udGVzdCh0aGlzLnBhcmVudE5vZGUuaHJlZikpIHsKICAgICAgICBlbCA9IFVJLmVsID0gJC5lbCgndmlkZW8nLCB7CiAgICAgICAgICBpZDogJ2lob3ZlcicsCiAgICAgICAgICBzcmM6IHRoaXMucGFyZW50Tm9kZS5ocmVmLAogICAgICAgICAgdHlwZTogJ3ZpZGVvL3dlYm0nLAogICAgICAgICAgYXV0b3BsYXk6IHRydWUsCiAgICAgICAgICBsb29wOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZWwgPSBVSS5lbCA9ICQuZWwoJ2ltZycsIHsKICAgICAgICAgIGlkOiAnaWhvdmVyJywKICAgICAgICAgIHNyYzogdGhpcy5wYXJlbnROb2RlLmhyZWYKICAgICAgICB9KTsKICAgICAgfQogICAgICAkLmFkZChkLmJvZHksIGVsKTsKICAgICAgJC5vbihlbCwgJ2xvYWQnLCBJbWFnZUhvdmVyLmxvYWQpOwogICAgICAkLm9uKGVsLCAnZXJyb3InLCBJbWFnZUhvdmVyLmVycm9yKTsKICAgICAgJC5vbih0aGlzLCAnbW91c2Vtb3ZlJywgVUkuaG92ZXIpOwogICAgICByZXR1cm4gJC5vbih0aGlzLCAnbW91c2VvdXQnLCBJbWFnZUhvdmVyLm1vdXNlb3V0KTsKICAgIH0sCiAgICBsb2FkOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIHN0eWxlOwogICAgICBpZiAoIXRoaXMucGFyZW50Tm9kZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzdHlsZSA9IHRoaXMuc3R5bGU7CiAgICAgIHJldHVybiBVSS5ob3Zlcih7CiAgICAgICAgY2xpZW50WDogLTQ1ICsgcGFyc2VJbnQoc3R5bGUubGVmdCksCiAgICAgICAgY2xpZW50WTogMTIwICsgcGFyc2VJbnQoc3R5bGUudG9wKQogICAgICB9KTsKICAgIH0sCiAgICBlcnJvcjogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzcmMsIHRpbWVvdXRJRCwgdXJsLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgc3JjID0gdGhpcy5zcmMuc3BsaXQoJy8nKTsKICAgICAgaWYgKCEoc3JjWzJdID09PSAnaS40Y2RuLm9yZycgJiYgKHVybCA9IFJlZGlyZWN0LmltYWdlKHNyY1szXSwgc3JjWzRdKSkpKSB7CiAgICAgICAgaWYgKGcuZGVhZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB1cmwgPSAiLy9pLjRjZG4ub3JnLyIgKyBzcmNbM10gKyAiLyIgKyBzcmNbNF07CiAgICAgIH0KICAgICAgaWYgKCQuZW5naW5lICE9PSAnd2Via2l0JyAmJiB1cmwuc3BsaXQoJy8nKVsyXSA9PT0gJ2kuNGNkbi5vcmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRpbWVvdXRJRCA9IHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5zcmMgPSB1cmw7CiAgICAgIH0pLCAzMDAwKTsKICAgICAgaWYgKCQuZW5naW5lICE9PSAnd2Via2l0JyB8fCB1cmwuc3BsaXQoJy8nKVsyXSAhPT0gJ2kuNGNkbi5vcmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJldHVybiAkLmFqYXgodXJsLCB7CiAgICAgICAgb25yZWFkeXN0YXRlY2hhbmdlOiAoZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IDQwNCkgewogICAgICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KHRpbWVvdXRJRCk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSwgewogICAgICAgIHR5cGU6ICdoZWFkJwogICAgICB9KTsKICAgIH0sCiAgICBtb3VzZW91dDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciB2aWRlb2VsOwogICAgICBpZiAodmlkZW9lbCA9ICQoJ3ZpZGVvI2lob3ZlcicpKSB7CiAgICAgICAgdmlkZW9lbC5wYXVzZSgpOwogICAgICB9CiAgICAgIFVJLmhvdmVyZW5kKCk7CiAgICAgICQub2ZmKHRoaXMsICdtb3VzZW1vdmUnLCBVSS5ob3Zlcik7CiAgICAgIHJldHVybiAkLm9mZih0aGlzLCAnbW91c2VvdXQnLCBJbWFnZUhvdmVyLm1vdXNlb3V0KTsKICAgIH0KICB9OwoKICBBdXRvR2lmID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBfcmVmOwogICAgICBpZiAoKF9yZWYgPSBnLkJPQVJEKSA9PT0gJ2dpZicgfHwgX3JlZiA9PT0gJ3dzZycpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBnaWYsIGltZywgc3JjOwogICAgICBpbWcgPSBwb3N0LmltZzsKICAgICAgaWYgKHBvc3QuZWwuaGlkZGVuIHx8ICFpbWcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc3JjID0gaW1nLnBhcmVudE5vZGUuaHJlZjsKICAgICAgaWYgKC9naWYkLy50ZXN0KHNyYykgJiYgIS9zcG9pbGVyLy50ZXN0KGltZy5zcmMpKSB7CiAgICAgICAgZ2lmID0gJC5lbCgnaW1nJyk7CiAgICAgICAgJC5vbihnaWYsICdsb2FkJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gaW1nLnNyYyA9IHNyYzsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZ2lmLnNyYyA9IHNyYzsKICAgICAgfQogICAgfQogIH07CgogIFJlcGxhY2VQbmcgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBwbmcsIGltZywgc3JjOwogICAgICBpbWcgPSBwb3N0LmltZzsKICAgICAgaWYgKHBvc3QuZWwuaGlkZGVuIHx8ICFpbWcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc3JjID0gaW1nLnBhcmVudE5vZGUuaHJlZjsKICAgICAgaWYgKC9wbmckLy50ZXN0KHNyYykgJiYgIS9zcG9pbGVyLy50ZXN0KGltZy5zcmMpKSB7CiAgICAgICAgcG5nID0gJC5lbCgnaW1nJyk7CiAgICAgICAgJC5vbihwbmcsICdsb2FkJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gaW1nLnNyYyA9IHNyYzsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gcG5nLnNyYyA9IHNyYzsKICAgICAgfQogICAgfQogIH07CgogIFJlcGxhY2VKcGcgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1haW4uY2FsbGJhY2tzLnB1c2godGhpcy5ub2RlKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBqcGcsIGltZywgc3JjOwogICAgICBpbWcgPSBwb3N0LmltZzsKICAgICAgaWYgKHBvc3QuZWwuaGlkZGVuIHx8ICFpbWcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc3JjID0gaW1nLnBhcmVudE5vZGUuaHJlZjsKICAgICAgaWYgKC9qcGckLy50ZXN0KHNyYykgJiYgIS9zcG9pbGVyLy50ZXN0KGltZy5zcmMpKSB7CiAgICAgICAganBnID0gJC5lbCgnaW1nJyk7CiAgICAgICAgJC5vbihqcGcsICdsb2FkJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gaW1nLnNyYyA9IHNyYzsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4ganBnLnNyYyA9IHNyYzsKICAgICAgfQogICAgfQogIH07CiAgCiAgQWx3YXlzQ2RuID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBNYWluLmNhbGxiYWNrcy5wdXNoKHRoaXMubm9kZSk7CiAgICB9LAogICAgbm9kZTogZnVuY3Rpb24ocG9zdCkgewogICAgICB2YXIgaW1nLCBzcmMsIGZJbmZvOwogICAgICBpbWcgPSBwb3N0LmltZzsKICAgICAgaWYgKHBvc3QuZWwuaGlkZGVuIHx8ICFpbWcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHBvc3QuZmlsZUluZm8gJiYgKGZJbmZvID0gJCgnYScsIHBvc3QuZmlsZUluZm8pKSkKICAgICAgCiAgICAgIHNyYyA9IGltZy5wYXJlbnROb2RlLmhyZWY7CiAgICAgIGlmICghLzRjZG4kLy50ZXN0KHNyYykpIHsKICAgICAgICBpZiAocG9zdC5maWxlSW5mbyAmJiAoZkluZm8gPSAkKCdhJywgcG9zdC5maWxlSW5mbykpKSB7CiAgICAgICAgICBmSW5mby5ocmVmID0gZkluZm8uaHJlZi5yZXBsYWNlKC9pcy4/XC40Y2hhbi5vcmcvLCAiaS40Y2RuLm9yZyIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gaW1nLnBhcmVudE5vZGUuaHJlZiA9IHNyYy5yZXBsYWNlKC9pcy4/XC40Y2hhbi5vcmcvLCAiaS40Y2RuLm9yZyIpOwogICAgICB9CiAgICB9CiAgfTsKCiAgSW1hZ2VFeHBhbmQgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgTWFpbi5jYWxsYmFja3MucHVzaCh0aGlzLm5vZGUpOwogICAgICByZXR1cm4gdGhpcy5kaWFsb2coKTsKICAgIH0sCiAgICBub2RlOiBmdW5jdGlvbihwb3N0KSB7CiAgICAgIHZhciBhOwogICAgICBpZiAoIXBvc3QuaW1nIHx8IHBvc3QuaGFzUGRmKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGEgPSBwb3N0LmltZy5wYXJlbnROb2RlOwogICAgICAkLm9uKGEsICdjbGljaycsIEltYWdlRXhwYW5kLmNiLnRvZ2dsZSk7CiAgICAgIGlmIChJbWFnZUV4cGFuZC5vbiAmJiAhcG9zdC5lbC5oaWRkZW4pIHsKICAgICAgICByZXR1cm4gSW1hZ2VFeHBhbmQuZXhwYW5kKHBvc3QuaW1nKTsKICAgICAgfQogICAgfSwKICAgIGNiOiB7CiAgICAgIHRvZ2dsZTogZnVuY3Rpb24oZSkgewogICAgICAgIGlmIChlLnNoaWZ0S2V5IHx8IGUuYWx0S2V5IHx8IGUuY3RybEtleSB8fCBlLm1ldGFLZXkgfHwgZS5idXR0b24gIT09IDApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHJldHVybiBJbWFnZUV4cGFuZC50b2dnbGUodGhpcyk7CiAgICAgIH0sCiAgICAgIGFsbDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGksIHRodW1iLCB0aHVtYnMsIF9pLCBfaiwgX2ssIF9sZW4sIF9sZW4xLCBfbGVuMiwgX3JlZjsKICAgICAgICBJbWFnZUV4cGFuZC5vbiA9IHRoaXMuY2hlY2tlZDsKICAgICAgICBpZiAoSW1hZ2VFeHBhbmQub24pIHsKICAgICAgICAgIHRodW1icyA9ICQkKCdpbWdbZGF0YS1tZDVdJyk7CiAgICAgICAgICBpZiAoQ29uZlsnRXhwYW5kIEZyb20gQ3VycmVudCddKSB7CiAgICAgICAgICAgIGZvciAoaSA9IF9pID0gMCwgX2xlbiA9IHRodW1icy5sZW5ndGg7IF9pIDwgX2xlbjsgaSA9ICsrX2kpIHsKICAgICAgICAgICAgICB0aHVtYiA9IHRodW1ic1tpXTsKICAgICAgICAgICAgICBpZiAodGh1bWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wID4gMCkgewogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRodW1icyA9IHRodW1icy5zbGljZShpKTsKICAgICAgICAgIH0KICAgICAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IHRodW1icy5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICAgICAgdGh1bWIgPSB0aHVtYnNbX2pdOwogICAgICAgICAgICBpZiAoIUNvbmZbJ0V4cGFuZCBBbGwgV2ViTSddICYmIC9cLndlYm0kLy50ZXN0KHRodW1iLnBhcmVudE5vZGUuaHJlZikpCiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIEltYWdlRXhwYW5kLmV4cGFuZCh0aHVtYik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9yZWYgPSAkJCgnaW1nW2RhdGEtbWQ1XVtoaWRkZW5dJyk7CiAgICAgICAgICBmb3IgKF9rID0gMCwgX2xlbjIgPSBfcmVmLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgICAgICB0aHVtYiA9IF9yZWZbX2tdOwogICAgICAgICAgICBJbWFnZUV4cGFuZC5jb250cmFjdCh0aHVtYik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB0eXBlQ2hhbmdlOiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIga2xhc3M7CiAgICAgICAgc3dpdGNoICh0aGlzLnZhbHVlKSB7CiAgICAgICAgICBjYXNlICdmdWxsJzoKICAgICAgICAgICAga2xhc3MgPSAnJzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICdmaXQgd2lkdGgnOgogICAgICAgICAgICBrbGFzcyA9ICdmaXR3aWR0aCc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnZml0IGhlaWdodCc6CiAgICAgICAgICAgIGtsYXNzID0gJ2ZpdGhlaWdodCc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnZml0IHNjcmVlbic6CiAgICAgICAgICAgIGtsYXNzID0gJ2ZpdHdpZHRoIGZpdGhlaWdodCc7CiAgICAgICAgfQogICAgICAgICQuaWQoJ2RlbGZvcm0nKS5jbGFzc05hbWUgPSBrbGFzczsKICAgICAgICBpZiAoL1xiZml0aGVpZ2h0XGIvLnRlc3Qoa2xhc3MpKSB7CiAgICAgICAgICAkLm9uKHdpbmRvdywgJ3Jlc2l6ZScsIEltYWdlRXhwYW5kLnJlc2l6ZSk7CiAgICAgICAgICBpZiAoIUltYWdlRXhwYW5kLnN0eWxlKSB7CiAgICAgICAgICAgIEltYWdlRXhwYW5kLnN0eWxlID0gJC5hZGRTdHlsZSgnJyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gSW1hZ2VFeHBhbmQucmVzaXplKCk7CiAgICAgICAgfSBlbHNlIGlmIChJbWFnZUV4cGFuZC5zdHlsZSkgewogICAgICAgICAgcmV0dXJuICQub2ZmKHdpbmRvdywgJ3Jlc2l6ZScsIEltYWdlRXhwYW5kLnJlc2l6ZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgdG9nZ2xlOiBmdW5jdGlvbihhKSB7CiAgICAgIHZhciByZWN0LCB0aHVtYjsKICAgICAgdGh1bWIgPSBhLmZpcnN0Q2hpbGQ7CiAgICAgIGlmICh0aHVtYi5oaWRkZW4pIHsKICAgICAgICByZWN0ID0gYS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgICBpZiAocmVjdC5ib3R0b20gPiAwKSB7CiAgICAgICAgICBpZiAoJC5lbmdpbmUgPT09ICd3ZWJraXQnKSB7CiAgICAgICAgICAgIGlmIChyZWN0LnRvcCA8IDApIHsKICAgICAgICAgICAgICBkLmJvZHkuc2Nyb2xsVG9wICs9IHJlY3QudG9wIC0gNDI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJlY3QubGVmdCA8IDApIHsKICAgICAgICAgICAgICBkLmJvZHkuc2Nyb2xsTGVmdCArPSByZWN0LmxlZnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChyZWN0LnRvcCA8IDApIHsKICAgICAgICAgICAgICBkLmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgKz0gcmVjdC50b3AgLSA0MjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVjdC5sZWZ0IDwgMCkgewogICAgICAgICAgICAgIGQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgKz0gcmVjdC5sZWZ0OwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBJbWFnZUV4cGFuZC5jb250cmFjdCh0aHVtYik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIEltYWdlRXhwYW5kLmV4cGFuZCh0aHVtYik7CiAgICAgIH0KICAgIH0sCiAgICBjb250cmFjdDogZnVuY3Rpb24odGh1bWIpIHsKICAgICAgdGh1bWIuaGlkZGVuID0gZmFsc2U7CiAgICAgIHRodW1iLm5leHRTaWJsaW5nLmhpZGRlbiA9IHRydWU7CiAgICAgIGlmICh0aHVtYi5uZXh0U2libGluZy5ub2RlTmFtZSA9PT0gJ1ZJREVPJykgewogICAgICAgIHRodW1iLm5leHRTaWJsaW5nLnBhdXNlKCk7CiAgICAgICAgdGh1bWIubmV4dFNpYmxpbmcucmVtb3ZlKCk7CiAgICAgIH0KICAgICAgcmV0dXJuICQucm1DbGFzcyh0aHVtYi5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZSwgJ2ltYWdlX2V4cGFuZGVkJyk7CiAgICB9LAogICAgZXhwYW5kOiBmdW5jdGlvbih0aHVtYiwgc3JjKSB7CiAgICAgIHZhciBhLCBpbWc7CiAgICAgIGlmICgkLngoJ2FuY2VzdG9yLW9yLXNlbGY6OipbQGhpZGRlbl0nLCB0aHVtYikpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYSA9IHRodW1iLnBhcmVudE5vZGU7CiAgICAgIHNyYyB8fCAoc3JjID0gYS5ocmVmKTsKICAgICAgaWYgKC9cLnBkZiQvLnRlc3Qoc3JjKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aHVtYi5oaWRkZW4gPSB0cnVlOwogICAgICAkLmFkZENsYXNzKHRodW1iLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLCAnaW1hZ2VfZXhwYW5kZWQnKTsKICAgICAgaWYgKChpbWcgPSB0aHVtYi5uZXh0U2libGluZykgJiYgaW1nLm5vZGVOYW1lID09PSAnSU1HJykgewogICAgICAgIGltZy5oaWRkZW4gPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgCiAgICAgIC8qIGEgdmlkZW8gaW4geW91ciBpbWc/IGl0J3MgbW9yZSBsaWtlbHkgdGhhbiB5b3UgdGhpbmsgKi8KICAgICAgaWYgKC9cLndlYm0kLy50ZXN0KHNyYykpIHsKICAgICAgICBpbWcgPSAkLmVsKCd2aWRlbycsIHsKICAgICAgICAgIHNyYzogc3JjLAogICAgICAgICAgdHlwZTogJ3ZpZGVvL3dlYm0nLAogICAgICAgICAgYXV0b3BsYXk6IHRydWUsCiAgICAgICAgICBsb29wOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW1nID0gJC5lbCgnaW1nJywgewogICAgICAgICAgc3JjOiBzcmMKICAgICAgICB9KTsKICAgICAgfQogICAgICAkLm9uKGltZywgJ2Vycm9yJywgSW1hZ2VFeHBhbmQuZXJyb3IpOwogICAgICByZXR1cm4gJC5hZnRlcih0aHVtYiwgaW1nKTsKICAgIH0sCiAgICBlcnJvcjogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzcmMsIHRodW1iLCB0aW1lb3V0SUQsIHVybDsKICAgICAgdGh1bWIgPSB0aGlzLnByZXZpb3VzU2libGluZzsKICAgICAgSW1hZ2VFeHBhbmQuY29udHJhY3QodGh1bWIpOwogICAgICAkLnJtKHRoaXMpOwogICAgICBzcmMgPSB0aGlzLnNyYy5zcGxpdCgnLycpOwogICAgICBpZiAoIShzcmNbMl0gPT09ICdpLjRjZG4ub3JnJyAmJiAodXJsID0gUmVkaXJlY3QuaW1hZ2Uoc3JjWzNdLCBzcmNbNF0pKSkpIHsKICAgICAgICBpZiAoZy5kZWFkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHVybCA9ICIvL2kuNGNkbi5vcmcvIiArIHNyY1szXSArICIvIiArIHNyY1s0XTsKICAgICAgfQogICAgICBpZiAoJC5lbmdpbmUgIT09ICd3ZWJraXQnICYmIHVybC5zcGxpdCgnLycpWzJdID09PSAnaS40Y2RuLm9yZycpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGltZW91dElEID0gc2V0VGltZW91dChJbWFnZUV4cGFuZC5leHBhbmQsIDEwMDAwLCB0aHVtYiwgdXJsKTsKICAgICAgaWYgKCQuZW5naW5lICE9PSAnd2Via2l0JyB8fCB1cmwuc3BsaXQoJy8nKVsyXSAhPT0gJ2kuNGNkbi5vcmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHJldHVybiAkLmFqYXgodXJsLCB7CiAgICAgICAgb25yZWFkeXN0YXRlY2hhbmdlOiAoZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IDQwNCkgewogICAgICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KHRpbWVvdXRJRCk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSwgewogICAgICAgIHR5cGU6ICdoZWFkJwogICAgICB9KTsKICAgIH0sCiAgICBkaWFsb2c6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY29udHJvbHMsIGltYWdlVHlwZSwgc2VsZWN0OwogICAgICBjb250cm9scyA9ICQuZWwoJ2RpdicsIHsKICAgICAgICBpZDogJ2ltZ0NvbnRyb2xzJywKICAgICAgICBpbm5lckhUTUw6ICI8c2VsZWN0IGlkPWltYWdlVHlwZSBuYW1lPWltYWdlVHlwZT48b3B0aW9uIHZhbHVlPWZ1bGw+RnVsbDwvb3B0aW9uPjxvcHRpb24gdmFsdWU9J2ZpdCB3aWR0aCc+Rml0IFdpZHRoPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT0nZml0IGhlaWdodCc+Rml0IEhlaWdodDwvb3B0aW9uIHZhbHVlPSdmaXQgc2NyZWVuJz48b3B0aW9uIHZhbHVlPSdmaXQgc2NyZWVuJz5GaXQgU2NyZWVuPC9vcHRpb24+PC9zZWxlY3Q+PGxhYmVsPkV4cGFuZCBJbWFnZXM8aW5wdXQgdHlwZT1jaGVja2JveCBpZD1pbWFnZUV4cGFuZD48L2xhYmVsPiIKICAgICAgfSk7CiAgICAgIGltYWdlVHlwZSA9ICQuZ2V0KCdpbWFnZVR5cGUnLCAnZnVsbCcpOwogICAgICBzZWxlY3QgPSAkKCdzZWxlY3QnLCBjb250cm9scyk7CiAgICAgIHNlbGVjdC52YWx1ZSA9IGltYWdlVHlwZTsKICAgICAgSW1hZ2VFeHBhbmQuY2IudHlwZUNoYW5nZS5jYWxsKHNlbGVjdCk7CiAgICAgICQub24oc2VsZWN0LCAnY2hhbmdlJywgJC5jYi52YWx1ZSk7CiAgICAgICQub24oc2VsZWN0LCAnY2hhbmdlJywgSW1hZ2VFeHBhbmQuY2IudHlwZUNoYW5nZSk7CiAgICAgICQub24oJCgnaW5wdXQnLCBjb250cm9scyksICdjbGljaycsIEltYWdlRXhwYW5kLmNiLmFsbCk7CiAgICAgIHJldHVybiAkLnByZXBlbmQoJC5pZCgnZGVsZm9ybScpLCBjb250cm9scyk7CiAgICB9LAogICAgcmVzaXplOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIEltYWdlRXhwYW5kLnN0eWxlLnRleHRDb250ZW50ID0gIi5maXRoZWlnaHQgaW1nW2RhdGEtbWQ1XSArIGltZyB7bWF4LWhlaWdodDoiICsgZC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgInB4O30gLmZpdGhlaWdodCBpbWdbZGF0YS1tZDVdICsgdmlkZW8ge21heC1oZWlnaHQ6IiArIGQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCArICJweDt9IjsKICAgIH0KICB9OwoKICBSZW1vdmVTbHVnID0gewogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjYXRhbG9nZGl2OwogICAgICB2YXIgdGhyZWFkcyA9IFtdOwogICAgICBpZiAoZy5DQVRBTE9HKSB7CiAgICAgICAgY2F0YWxvZ2RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RocmVhZCcpOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2F0YWxvZ2Rpdi5sZW5ndGg7IGkrKykgewogICAgICAgICAgdGhyZWFkcy5wdXNoKGNhdGFsb2dkaXZbaV0uZmlyc3RFbGVtZW50Q2hpbGQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJlYWRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncmVwbHlsaW5rJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIFJlbW92ZVNsdWcuZGVzbHVnKHRocmVhZHMpOwogICAgfSwKICAgIGRlc2x1ZzogZnVuY3Rpb24oZWxzKSB7CiAgICAgIHZhciBlbDsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlbCA9IGVsc1tpXTsKICAgICAgICBwYXRoID0gZWwucGF0aG5hbWU7CiAgICAgICAgaWYgKHBhdGguc2xpY2UoMSkuc3BsaXQoJy8nKS5sZW5ndGggPiAzKSB7CiAgICAgICAgICBlbC5wYXRobmFtZSA9IHBhdGguc3Vic3RyaW5nKDAsIHBhdGgubGFzdEluZGV4T2YoJy8nKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICB9OwoKICBBbHdheXNIVFRQUyA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2F0YWxvZ2RpdjsKICAgICAgdmFyIHRocmVhZHMgPSBbXTsKICAgICAgaWYgKGcuQ0FUQUxPRykgewogICAgICAgIGNhdGFsb2dkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0aHJlYWQnKTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhdGFsb2dkaXYubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHRocmVhZHMucHVzaChjYXRhbG9nZGl2W2ldLmZpcnN0RWxlbWVudENoaWxkKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyZWFkcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3JlcGx5bGluaycpOwogICAgICB9CiAgICAgIHJldHVybiBBbHdheXNIVFRQUy51cGdyYWRlKHRocmVhZHMpOwogICAgfSwKICAgIHVwZ3JhZGU6IGZ1bmN0aW9uKGVscykgewogICAgICB2YXIgZWw7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZWwgPSBlbHNbaV07CiAgICAgICAgaWYgKGVsLnByb3RvY29sID09ICdodHRwOicpIHsKICAgICAgICAgIGVsLnByb3RvY29sID0gJ2h0dHBzOic7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICB9OwoKICBDYXRhbG9nTGlua3MgPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNsb25lLCBlbCwgbmF2LCBfaSwgX2xlbiwgX3JlZjsKICAgICAgZWwgPSAkLmVsKCdzcGFuJywgewogICAgICAgIGNsYXNzTmFtZTogJ3RvZ2dsZUNhdGFsb2cnLAogICAgICAgIGlubmVySFRNTDogJ1s8YSBocmVmPWphdmFzY3JpcHQ6Oz48L2E+XScKICAgICAgfSk7CiAgICAgIF9yZWYgPSBbJ2JvYXJkTmF2RGVza3RvcCcsICdib2FyZE5hdkRlc2t0b3BGb290J107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIG5hdiA9IF9yZWZbX2ldOwogICAgICAgIGNsb25lID0gZWwuY2xvbmVOb2RlKHRydWUpOwogICAgICAgICQub24oY2xvbmUuZmlyc3RFbGVtZW50Q2hpbGQsICdjbGljaycsIENhdGFsb2dMaW5rcy50b2dnbGUpOwogICAgICAgICQuYWRkKCQuaWQobmF2KSwgY2xvbmUpOwogICAgICB9CiAgICAgIHJldHVybiBDYXRhbG9nTGlua3MudG9nZ2xlKHRydWUpOwogICAgfSwKICAgIHRvZ2dsZTogZnVuY3Rpb24ob25Mb2FkKSB7CiAgICAgIHZhciBhLCBib2FyZCwgbmF2LCByb290LCB1c2VDYXRhbG9nLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMTsKICAgICAgaWYgKG9uTG9hZCA9PT0gdHJ1ZSkgewogICAgICAgIHVzZUNhdGFsb2cgPSAkLmdldCgnQ2F0YWxvZ0lzVG9nZ2xlZCcsIGcuQ0FUQUxPRyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdXNlQ2F0YWxvZyA9IHRoaXMudGV4dENvbnRlbnQgPT09ICdDYXRhbG9nIE9mZic7CiAgICAgICAgJC5zZXQoJ0NhdGFsb2dJc1RvZ2dsZWQnLCB1c2VDYXRhbG9nKTsKICAgICAgfQogICAgICBfcmVmID0gWydib2FyZE5hdkRlc2t0b3AnLCAnYm9hcmROYXZEZXNrdG9wRm9vdCddOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBuYXYgPSBfcmVmW19pXTsKICAgICAgICByb290ID0gJC5pZChuYXYpOwogICAgICAgIF9yZWYxID0gJCQoJ2FbaHJlZl0nLCByb290LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JvYXJkTGlzdCcpWzBdKTsKICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICAgIGEgPSBfcmVmMVtfal07CiAgICAgICAgICBib2FyZCA9IGEucGF0aG5hbWUuc3BsaXQoJy8nKVsxXTsKICAgICAgICAgIGlmIChib2FyZCA9PT0gJ2YnKSB7CiAgICAgICAgICAgIGEucGF0aG5hbWUgPSAnL2YvJzsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBhLnBhdGhuYW1lID0gIi8iICsgYm9hcmQgKyAiLyIgKyAodXNlQ2F0YWxvZyA/ICdjYXRhbG9nJyA6ICcnKTsKICAgICAgICB9CiAgICAgICAgYSA9ICQoJy50b2dnbGVDYXRhbG9nJywgcm9vdCkuZmlyc3RFbGVtZW50Q2hpbGQ7CiAgICAgICAgYS50ZXh0Q29udGVudCA9ICJDYXRhbG9nICIgKyAodXNlQ2F0YWxvZyA/ICdPbicgOiAnT2ZmJyk7CiAgICAgICAgYS50aXRsZSA9ICJUdXJuIGNhdGFsb2cgbGlua3MgIiArICh1c2VDYXRhbG9nID8gJ29mZicgOiAnb24nKSArICIuIjsKICAgICAgfQogICAgfQogIH07CgogIE1haW4gPSB7CiAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFzYXAsIGtleSwgcGF0aCwgcGF0aG5hbWUsIHNldHRpbmdzLCB0ZW1wLCB2YWw7CiAgICAgIE1haW4uZmxhdHRlbihudWxsLCBDb25maWcpOwogICAgICBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgIHBhdGhuYW1lID0gcGF0aC5zbGljZSgxKS5zcGxpdCgnLycpOwogICAgICBnLkJPQVJEID0gcGF0aG5hbWVbMF0sIHRlbXAgPSBwYXRobmFtZVsxXTsKICAgICAgc3dpdGNoICh0ZW1wKSB7CiAgICAgICAgY2FzZSAndGhyZWFkJzoKICAgICAgICAgIGcuUkVQTFkgPSB0cnVlOwogICAgICAgICAgZy5USFJFQURfSUQgPSBwYXRobmFtZVsyXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2NhdGFsb2cnOgogICAgICAgICAgZy5DQVRBTE9HID0gdHJ1ZTsKICAgICAgfQogICAgICBmb3IgKGtleSBpbiBDb25mKSB7CiAgICAgICAgdmFsID0gQ29uZltrZXldOwogICAgICAgIENvbmZba2V5XSA9ICQuZ2V0KGtleSwgdmFsKTsKICAgICAgfQogICAgICBzd2l0Y2ggKGxvY2F0aW9uLmhvc3RuYW1lKSB7CiAgICAgICAgY2FzZSAnc3lzLjRjaGFuLm9yZyc6CiAgICAgICAgICBpZiAoL3JlcG9ydC8udGVzdChsb2NhdGlvbi5zZWFyY2gpICYmIENvbmZbJ0FsdGVybmF0aXZlIGNhcHRjaGEnXSkgewogICAgICAgICAgICBhc2FwID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgdmFyIGZpZWxkLCBmb3JtOwogICAgICAgICAgICAgIGlmICghKGZpZWxkID0gJC5pZCgncmVjYXB0Y2hhX3Jlc3BvbnNlX2ZpZWxkJykpKSB7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzYXAsIDIwMCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGZvcm0gPSAkKCdmb3JtJyk7CiAgICAgICAgICAgICAgJC5vbihmaWVsZCwgJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSA4ICYmICFlLnRhcmdldC52YWx1ZSkgewogICAgICAgICAgICAgICAgICAkLmdsb2JhbEV2YWwoJ1JlY2FwdGNoYS5yZWxvYWQoInQiKTsnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBmaWVsZC5mb2N1cygpOwogICAgICAgICAgICAgIHJldHVybiAkLm9uKGZvcm0sICdzdWJtaXQnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICByZXR1cm4gZm9ybS5zdWJtaXQoKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgYXNhcCgpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuOwogICAgICAgIGNhc2UgJ2lzLjRjaGFuLm9yZyc6CiAgICAgICAgY2FzZSAnaXMyLjRjaGFuLm9yZyc6CiAgICAgICAgY2FzZSAnaS40Y2RuLm9yZyc6CiAgICAgICAgICAkLnJlYWR5KGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgdXJsOwogICAgICAgICAgICBpZiAoL140Y2hhbiAtIDQwNC8udGVzdChkLnRpdGxlKSAmJiBDb25mWyc0MDQgUmVkaXJlY3QnXSkgewogICAgICAgICAgICAgIHBhdGggPSBsb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpOwogICAgICAgICAgICAgIHVybCA9IFJlZGlyZWN0LmltYWdlKHBhdGhbMV0sIHBhdGhbMl0pOwogICAgICAgICAgICAgIGlmICh1cmwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBsb2NhdGlvbi5ocmVmID0gdXJsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKGcuUkVQTFkgJiYgcGF0aG5hbWUubGVuZ3RoID4gMyAmJiBDb25mWydSZW1vdmUgU2x1ZyddKSB7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID0gcGF0aC5zdWJzdHJpbmcoMCwgcGF0aC5sYXN0SW5kZXhPZignLycpKSArIGxvY2F0aW9uLmhhc2g7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChsb2NhdGlvbi5wcm90b2NvbCA9PSAnaHR0cDonICYmIENvbmZbJ0Fsd2F5cyBIVFRQUyddKSB7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UobG9jYXRpb24uaHJlZi5yZXBsYWNlKC9eaHR0cDpcL1wvLywgJ2h0dHBzOi8vJykpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoQ29uZlsnRGlzYWJsZSA0Y2hhblwncyBleHRlbnNpb24nXSkgewogICAgICAgIHNldHRpbmdzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnNGNoYW4tc2V0dGluZ3MnKSkgfHwge307CiAgICAgICAgc2V0dGluZ3MuZGlzYWJsZUFsbCA9IHRydWU7CiAgICAgICAgc2V0dGluZ3MuZHJvcERvd25OYXYgPSBmYWxzZTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnNGNoYW4tc2V0dGluZ3MnLCBKU09OLnN0cmluZ2lmeShzZXR0aW5ncykpOwogICAgICAgICQucmVhZHkoZnVuY3Rpb24oKSB7ICQuZ2xvYmFsRXZhbCgnd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCBSZXBvcnQub25NZXNzYWdlLCBmYWxzZSk7JykgfSk7CiAgICAgIH0KICAgICAgTWFpbi5wb2x5ZmlsbCgpOwogICAgICBpZiAoZy5DQVRBTE9HKSB7CiAgICAgICAgcmV0dXJuICQucmVhZHkoTWFpbi5jYXRhbG9nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gTWFpbi5mZWF0dXJlcygpOwogICAgICB9CiAgICB9LAogICAgcG9seWZpbGw6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIHByZWZpeCwgcHJvcGVydHk7CiAgICAgIGlmICghKCd2aXNpYmlsaXR5U3RhdGUnIGluIGRvY3VtZW50KSkgewogICAgICAgIHByZWZpeCA9ICdtb3pWaXNpYmlsaXR5U3RhdGUnIGluIGRvY3VtZW50ID8gJ21veicgOiAnd2Via2l0VmlzaWJpbGl0eVN0YXRlJyBpbiBkb2N1bWVudCA/ICd3ZWJraXQnIDogJ28nOwogICAgICAgIHByb3BlcnR5ID0gcHJlZml4ICsgJ1Zpc2liaWxpdHlTdGF0ZSc7CiAgICAgICAgZXZlbnQgPSBwcmVmaXggKyAndmlzaWJpbGl0eWNoYW5nZSc7CiAgICAgICAgZC52aXNpYmlsaXR5U3RhdGUgPSBkW3Byb3BlcnR5XTsKICAgICAgICBkLmhpZGRlbiA9IGQudmlzaWJpbGl0eVN0YXRlID09PSAnaGlkZGVuJzsKICAgICAgICByZXR1cm4gJC5vbihkLCBldmVudCwgZnVuY3Rpb24oKSB7CiAgICAgICAgICBkLnZpc2liaWxpdHlTdGF0ZSA9IGRbcHJvcGVydHldOwogICAgICAgICAgZC5oaWRkZW4gPSBkLnZpc2liaWxpdHlTdGF0ZSA9PT0gJ2hpZGRlbic7CiAgICAgICAgICByZXR1cm4gJC5ldmVudCgndmlzaWJpbGl0eWNoYW5nZScsIG51bGwsIGQpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgY2F0YWxvZzogZnVuY3Rpb24oKSB7CiAgICAgIGlmIChDb25mWydSZW1vdmUgU2x1ZyddKSB7CiAgICAgICAgJC5yZWFkeShSZW1vdmVTbHVnLmluaXQpOwogICAgICB9CiAgICAgIGlmIChDb25mWydBbHdheXMgSFRUUFMnXSkgewogICAgICAgICQucmVhZHkoQWx3YXlzSFRUUFMuaW5pdCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ0NhdGFsb2cgTGlua3MnXSkgewogICAgICAgICQucmVhZHkoQ2F0YWxvZ0xpbmtzLmluaXQpOwogICAgICB9CiAgICAgIGlmIChDb25mWydUaHJlYWQgSGlkaW5nJ10pIHsKICAgICAgICByZXR1cm4gVGhyZWFkSGlkaW5nLmluaXQoKTsKICAgICAgfQogICAgfSwKICAgIGZlYXR1cmVzOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGN1dG9mZiwgaGlkZGVuVGhyZWFkcywgaWQsIG5vdywgdGltZXN0YW1wLCBfcmVmOwogICAgICBPcHRpb25zLmluaXQoKTsKICAgICAgaWYgKENvbmZbJ1F1aWNrIFJlcGx5J10gJiYgQ29uZlsnSGlkZSBPcmlnaW5hbCBQb3N0IEZvcm0nXSkgewogICAgICAgIE1haW4uY3NzICs9ICcjcG9zdEZvcm0geyBkaXNwbGF5OiBub25lOyB9JzsKICAgICAgfQogICAgICAkLmFkZFN0eWxlKE1haW4uY3NzKTsKICAgICAgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgaWYgKENvbmZbJ0NoZWNrIGZvciBVcGRhdGVzJ10gJiYgJC5nZXQoJ2xhc3RVcGRhdGUnLCAwKSA8IG5vdyAtIDYgKiAkLkhPVVIpIHsKICAgICAgICAkLnJlYWR5KGZ1bmN0aW9uKCkgewogICAgICAgICAgJC5vbih3aW5kb3csICdtZXNzYWdlJywgTWFpbi5tZXNzYWdlKTsKICAgICAgICAgICQuc2V0KCdsYXN0VXBkYXRlJywgbm93KTsKICAgICAgICAgIHJldHVybiAkLmFkZChkLmhlYWQsICQuZWwoJ3NjcmlwdCcsIHsKICAgICAgICAgICAgc3JjOiAnaHR0cHM6Ly9sb2FkbGV0dGVyLmdpdGh1Yi5pby80Y2hhbi14L2xhdGVzdC5qcycKICAgICAgICAgIH0pKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnQWx0ZXJuYXRpdmUgY2FwdGNoYSddICYmIChnLlJFUExZIHx8IENvbmZbJ0FsdCBpbmRleCBjYXB0Y2hhJ10pKSB7CiAgICAgICAgJC5yZWFkeShmdW5jdGlvbigpIHsKICAgICAgICAgICQuYWRkKGQuaGVhZCwgJC5lbCgnc2NyaXB0JywgewogICAgICAgICAgICBzcmM6ICcvL3d3dy5nb29nbGUuY29tL3JlY2FwdGNoYS9hcGkvanMvcmVjYXB0Y2hhX2FqYXguanMnCiAgICAgICAgICB9KSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgZy5oaWRkZW5SZXBsaWVzID0gJC5nZXQoImhpZGRlblJlcGxpZXMvIiArIGcuQk9BUkQgKyAiLyIsIHt9KTsKICAgICAgaWYgKCQuZ2V0KCdsYXN0Q2hlY2tlZCcsIDApIDwgbm93IC0gMSAqICQuREFZKSB7CiAgICAgICAgJC5zZXQoJ2xhc3RDaGVja2VkJywgbm93KTsKICAgICAgICBjdXRvZmYgPSBub3cgLSA3ICogJC5EQVk7CiAgICAgICAgaGlkZGVuVGhyZWFkcyA9ICQuZ2V0KCJoaWRkZW5UaHJlYWRzLyIgKyBnLkJPQVJEICsgIi8iLCB7fSk7CiAgICAgICAgZm9yIChpZCBpbiBoaWRkZW5UaHJlYWRzKSB7CiAgICAgICAgICB0aW1lc3RhbXAgPSBoaWRkZW5UaHJlYWRzW2lkXTsKICAgICAgICAgIGlmICh0aW1lc3RhbXAgPCBjdXRvZmYpIHsKICAgICAgICAgICAgZGVsZXRlIGhpZGRlblRocmVhZHNbaWRdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBfcmVmID0gZy5oaWRkZW5SZXBsaWVzOwogICAgICAgIGZvciAoaWQgaW4gX3JlZikgewogICAgICAgICAgdGltZXN0YW1wID0gX3JlZltpZF07CiAgICAgICAgICBpZiAodGltZXN0YW1wIDwgY3V0b2ZmKSB7CiAgICAgICAgICAgIGRlbGV0ZSBnLmhpZGRlblJlcGxpZXNbaWRdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkLnNldCgiaGlkZGVuVGhyZWFkcy8iICsgZy5CT0FSRCArICIvIiwgaGlkZGVuVGhyZWFkcyk7CiAgICAgICAgJC5zZXQoImhpZGRlblJlcGxpZXMvIiArIGcuQk9BUkQgKyAiLyIsIGcuaGlkZGVuUmVwbGllcyk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ0ZpbHRlciddKSB7CiAgICAgICAgRmlsdGVyLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnUmVwbHkgSGlkaW5nJ10pIHsKICAgICAgICBSZXBseUhpZGluZy5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ0ZpbHRlciddIHx8IENvbmZbJ1JlcGx5IEhpZGluZyddKSB7CiAgICAgICAgU3RyaWtldGhyb3VnaFF1b3Rlcy5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ0Fub255bWl6ZSddKSB7CiAgICAgICAgQW5vbnltaXplLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnVGltZSBGb3JtYXR0aW5nJ10pIHsKICAgICAgICBUaW1lLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnUmVsYXRpdmUgUG9zdCBEYXRlcyddKSB7CiAgICAgICAgUmVsYXRpdmVEYXRlcy5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ0ZpbGUgSW5mbyBGb3JtYXR0aW5nJ10pIHsKICAgICAgICBGaWxlSW5mby5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ0Fsd2F5cyBDRE4nXSkgewogICAgICAgIEFsd2F5c0Nkbi5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1NhdWNlJ10pIHsKICAgICAgICBTYXVjZS5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1JldmVhbCBTcG9pbGVycyddKSB7CiAgICAgICAgUmV2ZWFsU3BvaWxlcnMuaW5pdCgpOwogICAgICB9CiAgICAgIGlmIChDb25mWydJbWFnZSBBdXRvLUdpZiddKSB7CiAgICAgICAgQXV0b0dpZi5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1JlcGxhY2UgUE5HJ10pIHsKICAgICAgICBSZXBsYWNlUG5nLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnUmVwbGFjZSBKUEcnXSkgewogICAgICAgIFJlcGxhY2VKcGcuaW5pdCgpOwogICAgICB9CiAgICAgIGlmIChDb25mWydJbWFnZSBIb3ZlciddKSB7CiAgICAgICAgSW1hZ2VIb3Zlci5pbml0KCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ01lbnUnXSkgewogICAgICAgIE1lbnUuaW5pdCgpOwogICAgICAgIGlmIChDb25mWydSZXBvcnQgTGluayddKSB7CiAgICAgICAgICBSZXBvcnRMaW5rLmluaXQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKENvbmZbJ0RlbGV0ZSBMaW5rJ10pIHsKICAgICAgICAgIERlbGV0ZUxpbmsuaW5pdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnRmlsdGVyJ10pIHsKICAgICAgICAgIEZpbHRlci5tZW51SW5pdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnRG93bmxvYWQgTGluayddKSB7CiAgICAgICAgICBEb3dubG9hZExpbmsuaW5pdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnQXJjaGl2ZSBMaW5rJ10pIHsKICAgICAgICAgIEFyY2hpdmVMaW5rLmluaXQoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1Jlc3VycmVjdCBRdW90ZXMnXSkgewogICAgICAgIFF1b3RpZnkuaW5pdCgpOwogICAgICB9CiAgICAgIGlmIChDb25mWydRdW90ZSBJbmxpbmUnXSkgewogICAgICAgIFF1b3RlSW5saW5lLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnUXVvdGUgUHJldmlldyddKSB7CiAgICAgICAgUXVvdGVQcmV2aWV3LmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnUXVvdGUgQmFja2xpbmtzJ10pIHsKICAgICAgICBRdW90ZUJhY2tsaW5rLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnSW5kaWNhdGUgT1AgcXVvdGUnXSkgewogICAgICAgIFF1b3RlT1AuaW5pdCgpOwogICAgICB9CiAgICAgIGlmIChDb25mWydJbmRpY2F0ZSBZb3UgcXVvdGUnXSkgewogICAgICAgIFF1b3RlWW91LmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnSW5kaWNhdGUgQ3Jvc3MtdGhyZWFkIFF1b3RlcyddKSB7CiAgICAgICAgUXVvdGVDVC5pbml0KCk7CiAgICAgIH0KICAgICAgcmV0dXJuICQucmVhZHkoTWFpbi5mZWF0dXJlc1JlYWR5KTsKICAgIH0sCiAgICBmZWF0dXJlc1JlYWR5OiBmdW5jdGlvbigpIHsKICAgICAgdmFyIE11dGF0aW9uT2JzZXJ2ZXIsIGEsIGJvYXJkLCBub2RlLCBub2Rlcywgb2JzZXJ2ZXIsIF9qLCBfbGVuMSwgX3JlZjE7CiAgICAgIGlmICgvXjRjaGFuIC0gNDA0Ly50ZXN0KGQudGl0bGUpKSB7CiAgICAgICAgaWYgKENvbmZbJzQwNCBSZWRpcmVjdCddICYmIC9eXGQrJC8udGVzdChnLlRIUkVBRF9JRCkpIHsKICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBSZWRpcmVjdC50byh7CiAgICAgICAgICAgIGJvYXJkOiBnLkJPQVJELAogICAgICAgICAgICB0aHJlYWRJRDogZy5USFJFQURfSUQsCiAgICAgICAgICAgIHBvc3RJRDogbG9jYXRpb24uaGFzaAogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoISQuaWQoJ25hdnRvcHJpZ2h0JykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgJC5hZGRDbGFzcyhkLmJvZHksICQuZW5naW5lKTsKICAgICAgJC5hZGRDbGFzcyhkLmJvZHksICdmb3VyY2hhbl94Jyk7CiAgICAgIGlmIChhID0gJCgiYVtocmVmJD0nLyIgKyBnLkJPQVJEICsgIi8nXSIsICQuaWQoJ2JvYXJkTmF2RGVza3RvcCcpKSkgewogICAgICAgICQuYWRkQ2xhc3MoYSwgJ2N1cnJlbnQnKTsKICAgICAgfQogICAgICAkLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoYSA9ICQoImFbaHJlZiQ9Jy8iICsgZy5CT0FSRCArICIvJ10iLCAkLmlkKCdib2FyZE5hdkRlc2t0b3BGb290JykpKSB7CiAgICAgICAgICAkLmFkZENsYXNzKGEsICdjdXJyZW50Jyk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgRmF2aWNvbi5pbml0KCk7CiAgICAgIGlmIChDb25mWydRdWljayBSZXBseSddKSB7CiAgICAgICAgUVIuaW5pdCgpOwogICAgICB9CiAgICAgIGlmIChDb25mWydJbWFnZSBFeHBhbnNpb24nXSkgewogICAgICAgIEltYWdlRXhwYW5kLmluaXQoKTsKICAgICAgfQogICAgICBpZiAoQ29uZlsnQ2F0YWxvZyBMaW5rcyddKSB7CiAgICAgICAgJC5yZWFkeShDYXRhbG9nTGlua3MuaW5pdCk7CiAgICAgIH0KICAgICAgaWYgKENvbmZbJ1RocmVhZCBXYXRjaGVyJ10pIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIFdhdGNoZXIuaW5pdCgpOwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmIChDb25mWydLZXliaW5kcyddKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiBLZXliaW5kcy5pbml0KCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKGcuUkVQTFkpIHsKICAgICAgICBpZiAoQ29uZlsnVGhyZWFkIFVwZGF0ZXInXSkgewogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIFVwZGF0ZXIuaW5pdCgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChDb25mWydUaHJlYWQgU3RhdHMnXSkgewogICAgICAgICAgVGhyZWFkU3RhdHMuaW5pdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnUmVwbHkgTmF2aWdhdGlvbiddKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gTmF2LmluaXQoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBUaXRsZVBvc3QuaW5pdCgpOwogICAgICAgIGlmIChDb25mWydVbnJlYWQgQ291bnQnXSB8fCBDb25mWydVbnJlYWQgRmF2aWNvbiddKSB7CiAgICAgICAgICBVbnJlYWQuaW5pdCgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoQ29uZlsnUmVtb3ZlIFNsdWcnXSkgewogICAgICAgICAgUmVtb3ZlU2x1Zy5pbml0KCk7CiAgICAgICAgfQogICAgICAgIGlmIChDb25mWydBbHdheXMgSFRUUFMnXSkgewogICAgICAgICAgQWx3YXlzSFRUUFMuaW5pdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnVGhyZWFkIEhpZGluZyddKSB7CiAgICAgICAgICBUaHJlYWRIaWRpbmcuaW5pdCgpOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnVGhyZWFkIEV4cGFuc2lvbiddKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gRXhwYW5kVGhyZWFkLmluaXQoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBpZiAoQ29uZlsnQ29tbWVudCBFeHBhbnNpb24nXSkgewogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cGFuZENvbW1lbnQuaW5pdCgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChDb25mWydJbmRleCBOYXZpZ2F0aW9uJ10pIHsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBOYXYuaW5pdCgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGJvYXJkID0gJCgnLmJvYXJkJyk7CiAgICAgIG5vZGVzID0gW107CiAgICAgIF9yZWYxID0gJCQoJy5wb3N0Q29udGFpbmVyJywgYm9hcmQpOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBub2RlID0gX3JlZjFbX2pdOwogICAgICAgIG5vZGVzLnB1c2goTWFpbi5wcmVQYXJzZShub2RlKSk7CiAgICAgIH0KICAgICAgTWFpbi5ub2RlKG5vZGVzLCB0cnVlKTsKICAgICAgTWFpbi5oYXNDb2RlVGFncyA9ICEhJCgnc2NyaXB0W3NyY149Ii8vcy40Y2RuLm9yZy9qcy9wcmV0dGlmeS9wcmV0dGlmeSJdJyk7CiAgICAgIGlmIChNdXRhdGlvbk9ic2VydmVyID0gd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93LldlYktpdE11dGF0aW9uT2JzZXJ2ZXIgfHwgd2luZG93Lk9NdXRhdGlvbk9ic2VydmVyKSB7CiAgICAgICAgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihNYWluLm9ic2VydmVyKTsKICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGJvYXJkLCB7CiAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgICBzdWJ0cmVlOiB0cnVlCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJC5vbihib2FyZCwgJ0RPTU5vZGVJbnNlcnRlZCcsIE1haW4ubGlzdGVuZXIpOwogICAgICB9CiAgICB9LAogICAgZmxhdHRlbjogZnVuY3Rpb24ocGFyZW50LCBvYmopIHsKICAgICAgdmFyIGtleSwgdmFsOwogICAgICBpZiAob2JqIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgICBDb25mW3BhcmVudF0gPSBvYmpbMF07CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHsKICAgICAgICBmb3IgKGtleSBpbiBvYmopIHsKICAgICAgICAgIHZhbCA9IG9ialtrZXldOwogICAgICAgICAgTWFpbi5mbGF0dGVuKGtleSwgdmFsKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgQ29uZltwYXJlbnRdID0gb2JqOwogICAgICB9CiAgICB9LAogICAgbWVzc2FnZTogZnVuY3Rpb24oZSkgewogICAgICB2YXIgdmVyc2lvbjsKICAgICAgdmVyc2lvbiA9IGUuZGF0YS52ZXJzaW9uOwogICAgICBpZiAodmVyc2lvbiAmJiB2ZXJzaW9uICE9PSBNYWluLnZlcnNpb24gJiYgY29uZmlybSgnQW4gdXBkYXRlZCB2ZXJzaW9uIG9mIDRjaGFuIFggaXMgYXZhaWxhYmxlLCB3b3VsZCB5b3UgbGlrZSB0byBpbnN0YWxsIGl0IG5vdz8nKSkgewogICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24gPSAiaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9sb2FkbGV0dGVyLzRjaGFuLXgvIiArIHZlcnNpb24gKyAiLzRjaGFuX3gudXNlci5qcyI7CiAgICAgIH0KICAgIH0sCiAgICBwcmVQYXJzZTogZnVuY3Rpb24obm9kZSkgewogICAgICB2YXIgZWwsIGltZywgaW1nUGFyZW50LCBwYXJlbnRDbGFzcywgcG9zdDsKICAgICAgcGFyZW50Q2xhc3MgPSBub2RlLnBhcmVudE5vZGUuY2xhc3NOYW1lOwogICAgICBlbCA9ICQoJy5wb3N0Jywgbm9kZSk7CiAgICAgIHBvc3QgPSB7CiAgICAgICAgcm9vdDogbm9kZSwKICAgICAgICBlbDogZWwsCiAgICAgICAgImNsYXNzIjogZWwuY2xhc3NOYW1lLAogICAgICAgIElEOiBlbC5pZC5tYXRjaCgvXGQrJC8pWzBdLAogICAgICAgIHRocmVhZElEOiBnLlRIUkVBRF9JRCB8fCAkLngoJ2FuY2VzdG9yOjpkaXZbcGFyZW50OjpkaXZbQGNsYXNzPSJib2FyZCJdXScsIG5vZGUpLmlkLm1hdGNoKC9cZCskLylbMF0sCiAgICAgICAgaXNBcmNoaXZlZDogL1xiYXJjaGl2ZWRQb3N0XGIvLnRlc3QocGFyZW50Q2xhc3MpLAogICAgICAgIGlzSW5saW5lZDogL1xiaW5saW5lXGIvLnRlc3QocGFyZW50Q2xhc3MpLAogICAgICAgIGlzQ3Jvc3Nwb3N0OiAvXGJjcm9zc3Bvc3RcYi8udGVzdChwYXJlbnRDbGFzcyksCiAgICAgICAgYmxvY2txdW90ZTogZWwubGFzdEVsZW1lbnRDaGlsZCwKICAgICAgICBxdW90ZXM6IGVsLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3F1b3RlbGluaycpLAogICAgICAgIGJhY2tsaW5rczogZWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYmFja2xpbmsnKSwKICAgICAgICBmaWxlSW5mbzogZmFsc2UsCiAgICAgICAgaW1nOiBmYWxzZQogICAgICB9OwogICAgICBpZiAoaW1nID0gJCgnaW1nW2RhdGEtbWQ1XScsIGVsKSkgewogICAgICAgIGltZ1BhcmVudCA9IGltZy5wYXJlbnROb2RlOwogICAgICAgIHBvc3QuaW1nID0gaW1nOwogICAgICAgIHBvc3QuZmlsZUluZm8gPSBpbWdQYXJlbnQucHJldmlvdXNFbGVtZW50U2libGluZzsKICAgICAgICBwb3N0Lmhhc1BkZiA9IC9cLnBkZiQvLnRlc3QoaW1nUGFyZW50LmhyZWYpOwogICAgICB9CiAgICAgIE1haW4ucHJldHRpZnkocG9zdC5ibG9ja3F1b3RlKTsKICAgICAgcmV0dXJuIHBvc3Q7CiAgICB9LAogICAgbm9kZTogZnVuY3Rpb24obm9kZXMsIG5vdGlmeSkgewogICAgICB2YXIgY2FsbGJhY2ssIGVyciwgbm9kZSwgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZjsKICAgICAgX3JlZiA9IE1haW4uY2FsbGJhY2tzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBjYWxsYmFjayA9IF9yZWZbX2ldOwogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBub2Rlcy5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICAgICAgbm9kZSA9IG5vZGVzW19qXTsKICAgICAgICAgICAgY2FsbGJhY2sobm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoX2Vycm9yKSB7CiAgICAgICAgICBlcnIgPSBfZXJyb3I7CiAgICAgICAgICBpZiAobm90aWZ5KSB7CiAgICAgICAgICAgIGFsZXJ0KCI0Y2hhbiBYICgiICsgTWFpbi52ZXJzaW9uICsgIikgZXJyb3I6ICIgKyBlcnIubWVzc2FnZSArICJcblJlcG9ydCB0aGUgYnVnIGF0IGdpdGh1Yi5jb20vbG9hZGxldHRlci80Y2hhbi14L2lzc3Vlc1xuXG5VUkw6ICIgKyB3aW5kb3cubG9jYXRpb24gKyAiXG4iICsgZXJyLnN0YWNrKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBvYnNlcnZlcjogZnVuY3Rpb24obXV0YXRpb25zKSB7CiAgICAgIHZhciBhZGRlZE5vZGUsIG11dGF0aW9uLCBub2RlcywgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZjsKICAgICAgbm9kZXMgPSBbXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBtdXRhdGlvbnMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBtdXRhdGlvbiA9IG11dGF0aW9uc1tfaV07CiAgICAgICAgX3JlZiA9IG11dGF0aW9uLmFkZGVkTm9kZXM7CiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZi5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICAgIGFkZGVkTm9kZSA9IF9yZWZbX2pdOwogICAgICAgICAgaWYgKC9cYnBvc3RDb250YWluZXJcYi8udGVzdChhZGRlZE5vZGUuY2xhc3NOYW1lKSkgewogICAgICAgICAgICBub2Rlcy5wdXNoKE1haW4ucHJlUGFyc2UoYWRkZWROb2RlKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChub2Rlcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gTWFpbi5ub2RlKG5vZGVzKTsKICAgICAgfQogICAgfSwKICAgIGxpc3RlbmVyOiBmdW5jdGlvbihlKSB7CiAgICAgIHZhciB0YXJnZXQ7CiAgICAgIHRhcmdldCA9IGUudGFyZ2V0OwogICAgICBpZiAoL1xicG9zdENvbnRhaW5lclxiLy50ZXN0KHRhcmdldC5jbGFzc05hbWUpKSB7CiAgICAgICAgcmV0dXJuIE1haW4ubm9kZShbTWFpbi5wcmVQYXJzZSh0YXJnZXQpXSk7CiAgICAgIH0KICAgIH0sCiAgICBwcmV0dGlmeTogZnVuY3Rpb24oYnEpIHsKICAgICAgdmFyIGNvZGU7CiAgICAgIGlmICghTWFpbi5oYXNDb2RlVGFncykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb2RlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHByZSwgX2ksIF9sZW4sIF9yZWY7CiAgICAgICAgX3JlZiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdfaWRfJykuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncHJldHR5cHJpbnQnKTsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIHByZSA9IF9yZWZbX2ldOwogICAgICAgICAgcHJlLmlubmVySFRNTCA9IHByZXR0eVByaW50T25lKHByZS5pbm5lckhUTUwucmVwbGFjZSgvXHMvZywgJyZuYnNwOycpKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHJldHVybiAkLmdsb2JhbEV2YWwoKCIoIiArIGNvZGUgKyAiKSgpIikucmVwbGFjZSgnX2lkXycsIGJxLmlkKSk7CiAgICB9LAogICAgbmFtZXNwYWNlOiAnNGNoYW5feC4nLAogICAgdmVyc2lvbjogJzIuNDAuNzcnLAogICAgY2FsbGJhY2tzOiBbXSwKICAgIGNzczogJ1wKLyogZGlhbG9nIHN0eWxpbmcgKi9cCi5kaWFsb2cucmVwbHkge1wKICBkaXNwbGF5OiBibG9jaztcCiAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLDAsMCwuMjUpO1wKICBwYWRkaW5nOiAwO1wKfVwKLm1vdmUge1wKICBjdXJzb3I6IG1vdmU7XAp9XApsYWJlbCwgLmZhdmljb24ge1wKICBjdXJzb3I6IHBvaW50ZXI7XAp9XAphW2hyZWY9ImphdmFzY3JpcHQ6OyJdIHtcCiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1wKfVwKLndhcm5pbmcge1wKICBjb2xvcjogcmVkO1wKfVwKXAouaGlkZV90aHJlYWRfYnV0dG9uOm5vdCguaGlkZGVuX3RocmVhZCkge1wKICBmbG9hdDogbGVmdDtcCn1cClwKLnRocmVhZCA+IC5oaWRkZW5fdGhyZWFkIH4gKixcCltoaWRkZW5dLFwKI2NvbnRlbnQgPiBbbmFtZT10YWJdOm5vdCg6Y2hlY2tlZCkgKyBkaXYsXAojdXBkYXRlcjpub3QoOmhvdmVyKSA+IDpub3QoLm1vdmUpLFwKLmF1dG9oaWRlOm5vdCg6aG92ZXIpID4gZm9ybSxcCiNxcCBpbnB1dCwgLmZvcndhcmRlZCB7XAogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDtcCn1cClwKLm1lbnVfYnV0dG9uIHtcCiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1wKfVwKLm1lbnVfYnV0dG9uID4gc3BhbiB7XAogIGJvcmRlci10b3A6ICAgLjVlbSBzb2xpZDtcCiAgYm9yZGVyLXJpZ2h0OiAuM2VtIHNvbGlkIHRyYW5zcGFyZW50O1wKICBib3JkZXItbGVmdDogIC4zZW0gc29saWQgdHJhbnNwYXJlbnQ7XAogIGRpc3BsYXk6IGlubGluZS1ibG9jaztcCiAgbWFyZ2luOiAycHg7XAogIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XAp9XAojbWVudSB7XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgb3V0bGluZTogbm9uZTtcCn1cCi5lbnRyeSB7XAogIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIC4yNSk7XAogIGN1cnNvcjogcG9pbnRlcjtcCiAgZGlzcGxheTogYmxvY2s7XAogIG91dGxpbmU6IG5vbmU7XAogIHBhZGRpbmc6IDNweCA3cHg7XAogIHBvc2l0aW9uOiByZWxhdGl2ZTtcCiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1wKICB3aGl0ZS1zcGFjZTogbm93cmFwO1wKfVwKLmVudHJ5Omxhc3QtY2hpbGQge1wKICBib3JkZXI6IG5vbmU7XAp9XAouZm9jdXNlZC5lbnRyeSB7XAogIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgLjMzKTtcCn1cCi5lbnRyeS5oYXNTdWJNZW51IHtcCiAgcGFkZGluZy1yaWdodDogMS41ZW07XAp9XAouaGFzU3ViTWVudTo6YWZ0ZXIge1wKICBjb250ZW50OiAiIjtcCiAgYm9yZGVyLWxlZnQ6ICAgLjVlbSBzb2xpZDtcCiAgYm9yZGVyLXRvcDogICAgLjNlbSBzb2xpZCB0cmFuc3BhcmVudDtcCiAgYm9yZGVyLWJvdHRvbTogLjNlbSBzb2xpZCB0cmFuc3BhcmVudDtcCiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1wKICBtYXJnaW46IC4zZW07XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgcmlnaHQ6IDNweDtcCn1cCi5oYXNTdWJNZW51Om5vdCguZm9jdXNlZCkgPiAuc3ViTWVudSB7XAogIGRpc3BsYXk6IG5vbmU7XAp9XAouc3ViTWVudSB7XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgbGVmdDogMTAwJTtcCiAgdG9wOiAwO1wKICBtYXJnaW4tdG9wOiAtMXB4O1wKfVwKXApoMSB7XAogIHRleHQtYWxpZ246IGNlbnRlcjtcCn1cCiNxciA+IC5tb3ZlIHtcCiAgbWluLXdpZHRoOiAzMDBweDtcCiAgb3ZlcmZsb3c6IGhpZGRlbjtcCiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcCiAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94O1wKICBwYWRkaW5nOiAwIDJweDtcCn1cCiNxciA+IC5tb3ZlID4gc3BhbiB7XAogIGZsb2F0OiByaWdodDtcCn1cCiNhdXRvaGlkZSwgLmNsb3NlLCAjcXIgc2VsZWN0LCAjZHVtcCwgLnJlbW92ZSwgLmNhcHRjaGFpbWcsICNxciBkaXYud2FybmluZyB7XAogIGN1cnNvcjogcG9pbnRlcjtcCn1cCiNxciBzZWxlY3QsXAojcXIgPiBmb3JtIHtcCiAgbWFyZ2luOiAwO1wKfVwKI2R1bXAge1wKICBiYWNrZ3JvdW5kOiAtd2Via2l0LWxpbmVhci1ncmFkaWVudCgjRUVFLCAjQ0NDKTtcCiAgYmFja2dyb3VuZDogLW1vei1saW5lYXItZ3JhZGllbnQoI0VFRSwgI0NDQyk7XAogIGJhY2tncm91bmQ6IC1vLWxpbmVhci1ncmFkaWVudCgjRUVFLCAjQ0NDKTtcCiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KCNFRUUsICNDQ0MpO1wKICB3aWR0aDogMTAlO1wKfVwKLmdlY2tvICNkdW1wIHtcCiAgcGFkZGluZzogMXB4IDAgMnB4O1wKfVwKI2R1bXA6aG92ZXIsICNkdW1wOmZvY3VzIHtcCiAgYmFja2dyb3VuZDogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQoI0ZGRiwgI0RERCk7XAogIGJhY2tncm91bmQ6IC1tb3otbGluZWFyLWdyYWRpZW50KCNGRkYsICNEREQpO1wKICBiYWNrZ3JvdW5kOiAtby1saW5lYXItZ3JhZGllbnQoI0ZGRiwgI0RERCk7XAogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCgjRkZGLCAjREREKTtcCn1cCiNkdW1wOmFjdGl2ZSwgLmR1bXAgI2R1bXA6bm90KDpob3Zlcik6bm90KDpmb2N1cykge1wKICBiYWNrZ3JvdW5kOiAtd2Via2l0LWxpbmVhci1ncmFkaWVudCgjQ0NDLCAjREREKTtcCiAgYmFja2dyb3VuZDogLW1vei1saW5lYXItZ3JhZGllbnQoI0NDQywgI0RERCk7XAogIGJhY2tncm91bmQ6IC1vLWxpbmVhci1ncmFkaWVudCgjQ0NDLCAjREREKTtcCiAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KCNDQ0MsICNEREQpO1wKfVwKI3FyOm5vdCguZHVtcCkgI3JlcGxpZXMsIC5kdW1wID4gZm9ybSA+IGxhYmVsIHtcCiAgZGlzcGxheTogbm9uZTtcCn1cCiNyZXBsaWVzIHtcCiAgZGlzcGxheTogYmxvY2s7XAogIGhlaWdodDogMTAwcHg7XAogIHBvc2l0aW9uOiByZWxhdGl2ZTtcCiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTtcCiAgLW1vei11c2VyLXNlbGVjdDogbm9uZTtcCiAgLW8tdXNlci1zZWxlY3Q6IG5vbmU7XAogIHVzZXItc2VsZWN0OiBub25lO1wKfVwKI3JlcGxpZXMgPiBkaXYge1wKICBjb3VudGVyLXJlc2V0OiB0aHVtYm5haWxzO1wKICB0b3A6IDA7IHJpZ2h0OiAwOyBib3R0b206IDA7IGxlZnQ6IDA7XAogIG1hcmdpbjogMDsgcGFkZGluZzogMDtcCiAgb3ZlcmZsb3c6IGhpZGRlbjtcCiAgcG9zaXRpb246IGFic29sdXRlO1wKICB3aGl0ZS1zcGFjZTogcHJlO1wKfVwKI3JlcGxpZXMgPiBkaXY6aG92ZXIge1wKICBib3R0b206IC0xMHB4O1wKICBvdmVyZmxvdy14OiBhdXRvO1wKICB6LWluZGV4OiAxO1wKfVwKLnRodW1ibmFpbCB7XAogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwwLDAsLjIpICFpbXBvcnRhbnQ7XAogIGJhY2tncm91bmQtcG9zaXRpb246IDUwJSAyMCUgIWltcG9ydGFudDtcCiAgYmFja2dyb3VuZC1zaXplOiBjb3ZlciAhaW1wb3J0YW50O1wKICBib3JkZXI6IDFweCBzb2xpZCAjNjY2O1wKICBib3gtc2l6aW5nOiBib3JkZXItYm94O1wKICAtbW96LWJveC1zaXppbmc6IGJvcmRlci1ib3g7XAogIGN1cnNvcjogbW92ZTtcCiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1wKICBoZWlnaHQ6IDkwcHg7IHdpZHRoOiA5MHB4O1wKICBtYXJnaW46IDVweDsgcGFkZGluZzogMnB4O1wKICBvcGFjaXR5OiAuNTtcCiAgb3V0bGluZTogbm9uZTtcCiAgb3ZlcmZsb3c6IGhpZGRlbjtcCiAgcG9zaXRpb246IHJlbGF0aXZlO1wKICB0ZXh0LXNoYWRvdzogMCAxcHggMXB4ICMwMDA7XAogIC13ZWJraXQtdHJhbnNpdGlvbjogb3BhY2l0eSAuMjVzIGVhc2UtaW4tb3V0O1wKICAtbW96LXRyYW5zaXRpb246IG9wYWNpdHkgLjI1cyBlYXNlLWluLW91dDtcCiAgLW8tdHJhbnNpdGlvbjogb3BhY2l0eSAuMjVzIGVhc2UtaW4tb3V0O1wKICB0cmFuc2l0aW9uOiBvcGFjaXR5IC4yNXMgZWFzZS1pbi1vdXQ7XAogIHZlcnRpY2FsLWFsaWduOiB0b3A7XAp9XAoudGh1bWJuYWlsOmhvdmVyLCAudGh1bWJuYWlsOmZvY3VzIHtcCiAgb3BhY2l0eTogLjk7XAp9XAoudGh1bWJuYWlsI3NlbGVjdGVkIHtcCiAgb3BhY2l0eTogMTtcCn1cCi50aHVtYm5haWw6OmJlZm9yZSB7XAogIGNvdW50ZXItaW5jcmVtZW50OiB0aHVtYm5haWxzO1wKICBjb250ZW50OiBjb3VudGVyKHRodW1ibmFpbHMpO1wKICBjb2xvcjogI0ZGRjtcCiAgZm9udC13ZWlnaHQ6IDcwMDtcCiAgcGFkZGluZzogM3B4O1wKICBwb3NpdGlvbjogYWJzb2x1dGU7XAogIHRvcDogMDtcCiAgcmlnaHQ6IDA7XAogIHRleHQtc2hhZG93OiAwIDAgM3B4ICMwMDAsIDAgMCA4cHggIzAwMDtcCn1cCi50aHVtYm5haWwuZHJhZyB7XAogIGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwwLDAsLjUpO1wKfVwKLnRodW1ibmFpbC5vdmVyIHtcCiAgYm9yZGVyLWNvbG9yOiAjRkZGO1wKfVwKLnRodW1ibmFpbCA+IHNwYW4ge1wKICBjb2xvcjogI0ZGRjtcCn1cCi5yZW1vdmUge1wKICBiYWNrZ3JvdW5kOiBub25lO1wKICBjb2xvcjogI0UwMDtcCiAgZm9udC13ZWlnaHQ6IDcwMDtcCiAgcGFkZGluZzogM3B4O1wKfVwKLnJlbW92ZTpob3Zlcjo6YWZ0ZXIge1wKICBjb250ZW50OiAiIFJlbW92ZSI7XAp9XAoudGh1bWJuYWlsID4gbGFiZWwge1wKICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC41KTtcCiAgY29sb3I6ICNGRkY7XAogIHJpZ2h0OiAwOyBib3R0b206IDA7IGxlZnQ6IDA7XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgdGV4dC1hbGlnbjogY2VudGVyO1wKfVwKLnRodW1ibmFpbCA+IGxhYmVsID4gaW5wdXQge1wKICBtYXJnaW46IDA7XAp9XAojYWRkUmVwbHkge1wKICBjb2xvcjogIzMzMztcCiAgZm9udC1zaXplOiAzLjVlbTtcCiAgbGluZS1oZWlnaHQ6IDEwMHB4O1wKfVwKI2FkZFJlcGx5OmhvdmVyLCAjYWRkUmVwbHk6Zm9jdXMge1wKICBjb2xvcjogIzAwMDtcCn1cCi5maWVsZCB7XAogIGJvcmRlcjogMXB4IHNvbGlkICNDQ0M7XAogIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XAogIC1tb3otYm94LXNpemluZzogYm9yZGVyLWJveDtcCiAgY29sb3I6ICMzMzM7XAogIGZvbnQ6IDEzcHggc2Fucy1zZXJpZjtcCiAgbWFyZ2luOiAwO1wKICBwYWRkaW5nOiAycHggNHB4IDNweDtcCiAgLXdlYmtpdC10cmFuc2l0aW9uOiBjb2xvciAuMjVzLCBib3JkZXIgLjI1cztcCiAgLW1vei10cmFuc2l0aW9uOiBjb2xvciAuMjVzLCBib3JkZXIgLjI1cztcCiAgLW8tdHJhbnNpdGlvbjogY29sb3IgLjI1cywgYm9yZGVyIC4yNXM7XAogIHRyYW5zaXRpb246IGNvbG9yIC4yNXMsIGJvcmRlciAuMjVzO1wKfVwKLmZpZWxkOi1tb3otcGxhY2Vob2xkZXIsXAouZmllbGQ6aG92ZXI6LW1vei1wbGFjZWhvbGRlciB7XAogIGNvbG9yOiAjQUFBO1wKfVwKLmZpZWxkOmhvdmVyLCAuZmllbGQ6Zm9jdXMge1wKICBib3JkZXItY29sb3I6ICM5OTk7XAogIGNvbG9yOiAjMDAwO1wKICBvdXRsaW5lOiBub25lO1wKfVwKI3FyID4gZm9ybSA+IGRpdjpmaXJzdC1jaGlsZCA+IC5maWVsZDpub3QoI2R1bXApIHtcCiAgd2lkdGg6IDMwJTtcCn1cCiNxci5zamlzLXByZXZpZXcgdGV4dGFyZWEge1wKICBmb250LWZhbWlseTogIklQQU1vbmFQR290aGljIiwiTW9uYSIsIk1TIFBHb3RoaWMiLG1vbm9zcGFjZTtcCiAgZm9udC1zaXplOiAxNnB4O1wKICBsaW5lLWhlaWdodDogMTdweDtcCn1cCiNxciB0ZXh0YXJlYS5maWVsZCB7XAogIGRpc3BsYXk6IC13ZWJraXQtYm94O1wKICBtaW4taGVpZ2h0OiAxNjBweDtcCiAgbWluLXdpZHRoOiAxMDAlO1wKfVwKI3FyLmNhcHRjaGEgdGV4dGFyZWEuZmllbGQge1wKICBtaW4taGVpZ2h0OiAxMjBweDtcCn1cCi50ZXh0YXJlYSB7XAogIHBvc2l0aW9uOiByZWxhdGl2ZTtcCn1cCiNjaGFyQ291bnQge1wKICBjb2xvcjogIzAwMDtcCiAgYmFja2dyb3VuZDogaHNsYSgwLCAwJSwgMTAwJSwgLjUpO1wKICBmb250LXNpemU6IDhwdDtcCiAgbWFyZ2luOiAxcHg7XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgYm90dG9tOiAwO1wKICByaWdodDogMDtcCiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XAp9XAojY2hhckNvdW50Lndhcm5pbmcge1wKICBjb2xvcjogcmVkO1wKfVwKI3FyIFt0eXBlPWZpbGVdIHtcCiAgbWFyZ2luOiAxcHggMDtcCiAgd2lkdGg6IDcwJTtcCn1cCiNxciBbdHlwZT1zdWJtaXRdIHtcCiAgbWFyZ2luOiAxcHggMDtcCiAgcGFkZGluZzogMXB4OyAvKiBub3QgR2Vja28gKi9cCiAgd2lkdGg6IDMwJTtcCn1cCi5nZWNrbyAjcXIgW3R5cGU9c3VibWl0XSB7XAogIHBhZGRpbmc6IDAgMXB4OyAvKiBHZWNrbyBkb2VzIG5vdCByZXNwZWN0IGJveC1zaXppbmc6IGJvcmRlci1ib3ggKi9cCn1cClwKLmZpbGVUZXh0OmhvdmVyIC5mbnRydW5jLFwKLmZpbGVUZXh0Om5vdCg6aG92ZXIpIC5mbmZ1bGwge1wKICBkaXNwbGF5OiBub25lO1wKfVwKLnJlcGx5ID4gLmZpbGUgPiAuZmlsZVRleHQge1wKICBtYXJnaW46IDAgMjBweDtcCn1cClwKLmZpdHdpZHRoIGltZ1tkYXRhLW1kNV0gKyBpbWcge1wKICBtYXgtd2lkdGg6IDEwMCU7XAp9XAouZ2Vja28gIC5maXR3aWR0aCBpbWdbZGF0YS1tZDVdICsgaW1nLFwKLnByZXN0byAuZml0d2lkdGggaW1nW2RhdGEtbWQ1XSArIGltZyB7XAogIHdpZHRoOiAxMDAlO1wKfVwKXAouZml0d2lkdGggaW1nW2RhdGEtbWQ1XSArIHZpZGVvIHtcCiAgbWF4LXdpZHRoOiAxMDAlO1wKfVwKLmdlY2tvICAuZml0d2lkdGggaW1nW2RhdGEtbWQ1XSArIHZpZGVvLFwKLnByZXN0byAuZml0d2lkdGggaW1nW2RhdGEtbWQ1XSArIHZpZGVvIHtcCiAgd2lkdGg6IDEwMCU7XAp9XApcCiNxciwgI3FwLCAjdXBkYXRlciwgI3N0YXRzLCAjaWhvdmVyLCAjb3ZlcmxheSwgI25hdmxpbmtzIHtcCiAgcG9zaXRpb246IGZpeGVkO1wKfVwKXAojaWhvdmVyIHtcCiAgbWF4LWhlaWdodDogOTclO1wKICBtYXgtd2lkdGg6IDc1JTtcCiAgcGFkZGluZy1ib3R0b206IDE4cHg7XAp9XApcCiNuYXZsaW5rcyB7XAogIGZvbnQtc2l6ZTogMTZweDtcCiAgdG9wOiAyNXB4O1wKICByaWdodDogNXB4O1wKfVwKXApib2R5IHtcCiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcCiAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94O1wKfVwKYm9keS51bnNjcm9sbCB7XAogIG92ZXJmbG93OiBoaWRkZW47XAp9XAojb3ZlcmxheSB7XAogIHRvcDogMDtcCiAgbGVmdDogMDtcCiAgd2lkdGg6IDEwMCU7XAogIGhlaWdodDogMTAwJTtcCiAgdGV4dC1hbGlnbjogY2VudGVyO1wKICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC41KTtcCiAgei1pbmRleDogMTtcCn1cCiNvdmVybGF5OjphZnRlciB7XAogIGNvbnRlbnQ6ICIiO1wKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XAogIGhlaWdodDogMTAwJTtcCiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcCn1cCiNvcHRpb25zIHtcCiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcCiAgLW1vei1ib3gtc2l6aW5nOiBib3JkZXItYm94O1wKICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XAogIHBhZGRpbmc6IDVweDtcCiAgcG9zaXRpb246IHJlbGF0aXZlO1wKICB0ZXh0LWFsaWduOiBsZWZ0O1wKICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1wKICB3aWR0aDogNjAwcHg7XAogIG1heC13aWR0aDogMTAwJTtcCiAgaGVpZ2h0OiA1MDBweDtcCiAgbWF4LWhlaWdodDogMTAwJTtcCn1cCiNjcmVkaXRzIHtcCiAgZmxvYXQ6IHJpZ2h0O1wKfVwKI29wdGlvbnMgdWwge1wKICBwYWRkaW5nOiAwO1wKfVwKI29wdGlvbnMgYXJ0aWNsZSBsaSB7XAogIG1hcmdpbjogMTBweCAwIDEwcHggMmVtO1wKfVwKI29wdGlvbnMgY29kZSB7XAogIGJhY2tncm91bmQ6IGhzbGEoMCwgMCUsIDEwMCUsIC41KTtcCiAgY29sb3I6ICMwMDA7XAogIHBhZGRpbmc6IDAgMXB4O1wKfVwKI29wdGlvbnMgbGFiZWwge1wKICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcCn1cCiNjb250ZW50IHtcCiAgb3ZlcmZsb3c6IGF1dG87XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgdG9wOiAyLjVlbTtcCiAgcmlnaHQ6IDVweDtcCiAgYm90dG9tOiA1cHg7XAogIGxlZnQ6IDVweDtcCn1cCiNjb250ZW50IHRleHRhcmVhIHtcCiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcCiAgbWluLWhlaWdodDogMzUwcHg7XAogIHJlc2l6ZTogdmVydGljYWw7XAogIHdpZHRoOiAxMDAlO1wKfVwKXAojdXBkYXRlciB7XAogIHRleHQtYWxpZ246IHJpZ2h0O1wKfVwKI3VwZGF0ZXI6bm90KDpob3Zlcikge1wKICBib3JkZXI6IG5vbmU7XAogIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1wKfVwKI3VwZGF0ZXIgaW5wdXRbdHlwZT1udW1iZXJdIHtcCiAgd2lkdGg6IDRlbTtcCn1cCi5uZXcge1wKICBiYWNrZ3JvdW5kOiBsaW1lO1wKfVwKXAojd2F0Y2hlciB7XAogIHBhZGRpbmctYm90dG9tOiA1cHg7XAogIHBvc2l0aW9uOiBhYnNvbHV0ZTtcCiAgb3ZlcmZsb3c6IGhpZGRlbjtcCiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcCn1cCiN3YXRjaGVyOm5vdCg6aG92ZXIpIHtcCiAgbWF4LWhlaWdodDogMjIwcHg7XAp9XAojd2F0Y2hlciA+IGRpdiB7XAogIG1heC13aWR0aDogMjAwcHg7XAogIG92ZXJmbG93OiBoaWRkZW47XAogIHBhZGRpbmctbGVmdDogNXB4O1wKICBwYWRkaW5nLXJpZ2h0OiA1cHg7XAogIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzO1wKfVwKI3dhdGNoZXIgPiAubW92ZSB7XAogIHBhZGRpbmctdG9wOiA1cHg7XAogIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1wKfVwKXAojcXAge1wKICBwYWRkaW5nOiAycHggMnB4IDVweDtcCn1cCiNxcCAucG9zdCB7XAogIGJvcmRlcjogbm9uZTtcCiAgbWFyZ2luOiAwO1wKICBwYWRkaW5nOiAwO1wKfVwKI3FwIGltZyB7XAogIG1heC1oZWlnaHQ6IDMwMHB4O1wKICBtYXgtd2lkdGg6IDUwMHB4O1wKfVwKLnFwaGwge1wKICBib3gtc2hhZG93OiAwIDAgMCAycHggcmdiYSgyMTYsIDk0LCA0OSwgLjcpO1wKfVwKLnF1b3RlbGluay5kZWFkbGluayB7XAogIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lICFpbXBvcnRhbnQ7XAp9XAouZGVhZGxpbms6bm90KC5xdW90ZWxpbmspIHtcCiAgdGV4dC1kZWNvcmF0aW9uOiBub25lICFpbXBvcnRhbnQ7XAp9XAouaW5saW5lZCB7XAogIG9wYWNpdHk6IC41O1wKfVwKLmlubGluZSB7XAogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xNSk7XAogIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMTI4LCAxMjgsIDEyOCwgMC41KTtcCiAgZGlzcGxheTogdGFibGU7XAogIG1hcmdpbjogMnB4O1wKICBwYWRkaW5nOiAycHg7XAp9XAouaW5saW5lIC5wb3N0IHtcCiAgYmFja2dyb3VuZDogbm9uZTtcCiAgYm9yZGVyOiBub25lO1wKICBtYXJnaW46IDA7XAogIHBhZGRpbmc6IDA7XAp9XApkaXYub3BDb250YWluZXIge1wKICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50O1wKfVwKLm9wQ29udGFpbmVyLmZpbHRlcl9oaWdobGlnaHQge1wKICBib3gtc2hhZG93OiBpbnNldCA1cHggMCByZ2JhKDI1NSwgMCwgMCwgLjUpO1wKfVwKLm9wQ29udGFpbmVyLmZpbHRlcl9oaWdobGlnaHQucXBobCB7XAogIGJveC1zaGFkb3c6IGluc2V0IDVweCAwIHJnYmEoMjU1LCAwLCAwLCAuNSksXAogICAgICAgICAgICAgIDAgMCAwIDJweCByZ2JhKDIxNiwgOTQsIDQ5LCAuNyk7XAp9XAouZmlsdGVyX2hpZ2hsaWdodCA+IC5yZXBseSB7XAogIGJveC1zaGFkb3c6IC01cHggMCByZ2JhKDI1NSwgMCwgMCwgLjUpO1wKfVwKLmZpbHRlcl9oaWdobGlnaHQgPiAucmVwbHkucXBobCB7XAogIGJveC1zaGFkb3c6IC01cHggMCByZ2JhKDI1NSwgMCwgMCwgLjUpLFwKICAgICAgICAgICAgICAwIDAgMCAycHggcmdiYSgyMTYsIDk0LCA0OSwgLjcpXAp9XAouZmlsdGVyZWQge1wKICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZSBsaW5lLXRocm91Z2g7XAp9XAoucXVvdGVsaW5rLmZvcndhcmRsaW5rLFwKLmJhY2tsaW5rLmZvcndhcmRsaW5rIHtcCiAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1wKICBib3JkZXItYm90dG9tOiAxcHggZGFzaGVkO1wKfVwKJwogIH07CgogIE1haW4uaW5pdCgpOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"X-links","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["exhentai.org","e-hentai.org","ehgt.org","nhentai.net","hitomi.la","raw.githubusercontent.com","*"],"orig_excludes":[],"orig_includes":["http://boards.4chan.org/*","https://boards.4chan.org/*","http://boards.4channel.org/*","https://boards.4channel.org/*","http://8ch.net/*","https://8ch.net/*","https://archived.moe/*","https://boards.fireden.net/*","http://desuarchive.org/*","https://desuarchive.org/*","http://fgts.jp/*","https://fgts.jp/*","http://boards.38chan.net/*","http://forums.e-hentai.org/*","https://forums.e-hentai.org/*","https://meguca.org/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609796002997,"data":{}},"enabled":true,"position":4,"file_url":"https://raw.githubusercontent.com/dnsev-h/x-links/stable/builds/x-links.user.js","uuid":"e98de2c3-0f42-4072-804a-632f8b8fe859","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFgtbGlua3MKLy8gQG5hbWVzcGFjZSAgIGRuc2V2LWgKLy8gQGF1dGhvciAgICAgIGRuc2V2LWgKLy8gQHZlcnNpb24gICAgIDEuMi44LjI2Ci8vIEBkZXNjcmlwdGlvbiBNYWtpbmcgeW91ciBicm93c2luZyBleHBlcmllbmNlIG9uIDRjaGFuIGFuZCBmcmllbmRzIG1vcmUgcGxlYXN1cmFibGUKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly9ib2FyZHMuNGNoYW4ub3JnLyoKLy8gQGluY2x1ZGUgICAgIGh0dHBzOi8vYm9hcmRzLjRjaGFuLm9yZy8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vYm9hcmRzLjRjaGFubmVsLm9yZy8qCi8vIEBpbmNsdWRlICAgICBodHRwczovL2JvYXJkcy40Y2hhbm5lbC5vcmcvKgovLyBAaW5jbHVkZSAgICAgaHR0cDovLzhjaC5uZXQvKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly84Y2gubmV0LyoKLy8gQGluY2x1ZGUgICAgIGh0dHBzOi8vYXJjaGl2ZWQubW9lLyoKLy8gQGluY2x1ZGUgICAgIGh0dHBzOi8vYm9hcmRzLmZpcmVkZW4ubmV0LyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly9kZXN1YXJjaGl2ZS5vcmcvKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly9kZXN1YXJjaGl2ZS5vcmcvKgovLyBAaW5jbHVkZSAgICAgaHR0cDovL2ZndHMuanAvKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly9mZ3RzLmpwLyoKLy8gQGluY2x1ZGUgICAgIGh0dHA6Ly9ib2FyZHMuMzhjaGFuLm5ldC8qCi8vIEBpbmNsdWRlICAgICBodHRwOi8vZm9ydW1zLmUtaGVudGFpLm9yZy8qCi8vIEBpbmNsdWRlICAgICBodHRwczovL2ZvcnVtcy5lLWhlbnRhaS5vcmcvKgovLyBAaW5jbHVkZSAgICAgaHR0cHM6Ly9tZWd1Y2Eub3JnLyoKLy8gQGNvbm5lY3QgICAgIGV4aGVudGFpLm9yZwovLyBAY29ubmVjdCAgICAgZS1oZW50YWkub3JnCi8vIEBjb25uZWN0ICAgICBlaGd0Lm9yZwovLyBAY29ubmVjdCAgICAgbmhlbnRhaS5uZXQKLy8gQGNvbm5lY3QgICAgIGhpdG9taS5sYQovLyBAY29ubmVjdCAgICAgcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbQovLyBAY29ubmVjdCAgICAgKgovLyBAaG9tZXBhZ2UgICAgaHR0cHM6Ly9kbnNldi1oLmdpdGh1Yi5pby94LWxpbmtzLwovLyBAc3VwcG9ydFVSTCAgaHR0cHM6Ly9naXRodWIuY29tL2Ruc2V2LWgveC1saW5rcy9pc3N1ZXMKLy8gQHVwZGF0ZVVSTCAgIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kbnNldi1oL3gtbGlua3Mvc3RhYmxlL2J1aWxkcy94LWxpbmtzLm1ldGEuanMKLy8gQGRvd25sb2FkVVJMIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kbnNldi1oL3gtbGlua3Mvc3RhYmxlL2J1aWxkcy94LWxpbmtzLnVzZXIuanMKLy8gQGljb24gICAgICAgIGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBREFBQUFBd0NBWUFBQUJYQXZtSEFBQUE2a2xFUVZSNEFlMlpvUTdDUUJCRStWSU1Cb0hCWUJBWURLTG1EQUtGd1BCaGEvc0pJR2ViTU1sZDloSzJsOW5rbWFhNXZwZGNyNktiK0dnMG56YjZyemxNZ0FMc1BmOGtFbURUREc1QUFlTUh2RUFvd0VuYkZRd1pvQUF2YlUvSEEvajdXNlh0QWdZSlVBQ1A4ZEoyZHhRUWtLWXdINDhDc2did21ES0RDVVNrY1dUVGQyeTU1Z21RbUdRQkN1aC9SUEozckFBbWJRZVFOMEFCQVdrN0E3NWZRYXUwYlVIYUFBVUU5dnJ5d1VmQTl5NklTZjgvUUFIOWowZ3ZzWGZzQUltcGxsWkF6b0JtNllvMUlWMHJ4NjRySUgwQStiSUdBeURkdnI4VnNMWUEvV0pTZ0VhajBheHR2b1R2dGtCL1dKTkdBQUFBQUVsRlRrU3VRbUNDCi8vIEBpY29uNjQgICAgICBkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUVBQUFBQkFDQU1BQUFDZHQ0SHNBQUFBT1ZCTVZFVUJBQURtamUvbWt1L21xdS9taWUvbVh1L21kdS9tYk8vbWhPL21tKy9tZisvbVkrL21lKzhBQUFEbXBlL21hTy9tY2UvbWwrL21vZStpM1R5Z0FBQUFBWFJTVGxNQVFPYllaZ0FBQUo5SlJFRlVlRjd0bDBrS3hEQVF4Q2JKclB2eS84ZU9DcVlnbU1ZUHFGalhScnFVYzhnT05zK2pvWGRMRGl4L3FzQUVlOWhDNEFsVlFQSVowZ09TdjNBQlNhMThoZVNBSTVJL01FTWxHOGRGVXNBUnlSTlU4Z0plU2JjanlFa0s5QjZQVjVyQjhnbHlBclY4QjA4bFd2a0FPWUY2UHNsdjhGeWlrZ01DM2NjaitRVTNjR1F0SndWYWVYMlR2SllzcHdYODhWUUJ5ZTEwZVlIeHZ3Q0R3UStiR0ZmUnk3N0hnUUFBQUFCSlJVNUVya0pnZ2c9PQovLyBAZ3JhbnQgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgIEdNX3NldFZhbHVlCi8vIEBncmFudCAgICAgICBHTV9nZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgR01fZGVsZXRlVmFsdWUKLy8gQGdyYW50ICAgICAgIEdNLnhtbEh0dHBSZXF1ZXN0Ci8vIEBncmFudCAgICAgICBHTS5zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgR00uZ2V0VmFsdWUKLy8gQGdyYW50ICAgICAgIEdNLmRlbGV0ZVZhbHVlCi8vIEBydW4tYXQgICAgICBkb2N1bWVudC1zdGFydAovLyA9PS9Vc2VyU2NyaXB0PT0KKGZ1bmN0aW9uICh3aW5kb3cpIHsKCSJ1c2Ugc3RyaWN0IjsKCgkvLyBHcmVhc2Vtb25rZXkgNCBjb21wYXRpYmlsaXR5Cgl2YXIgdG9fcHJvbWlzZSA9IGZ1bmN0aW9uIChmbiwgc2VsZikgewoJCXJldHVybiBmdW5jdGlvbiAoKSB7CgkJCXZhciBhcmdzID0gYXJndW1lbnRzOwoJCQlyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewoJCQkJdHJ5IHsKCQkJCQlyZXNvbHZlKGZuLmFwcGx5KHNlbGYsIGFyZ3MpKTsKCQkJCX0KCQkJCWNhdGNoIChlKSB7CgkJCQkJcmVqZWN0KGUpOwoJCQkJfQoJCQl9KTsKCQl9OwoJfTsKCgl2YXIgR00gPSAoZnVuY3Rpb24gKCkgewoJCXZhciBHTSA9IHRoaXMuR007CgkJaWYgKEdNICE9PSBudWxsICYmIHR5cGVvZihHTSkgPT09ICJvYmplY3QiKSB7CgkJCXJldHVybiBHTTsKCQl9CgoJCXZhciBtYXBwaW5nID0gWwoJCQlbICJnZXRWYWx1ZSIsICJHTV9nZXRWYWx1ZSIgXSwKCQkJWyAic2V0VmFsdWUiLCAiR01fc2V0VmFsdWUiIF0sCgkJCVsgImRlbGV0ZVZhbHVlIiwgIkdNX2RlbGV0ZVZhbHVlIiBdLAoJCQlbICJ4bWxIdHRwUmVxdWVzdCIsICJHTV94bWxodHRwUmVxdWVzdCIgXQoJCV07CgoJCUdNID0ge307CgkJdmFyIG0sIGksIGlpOwoJCWZvciAoaSA9IDAsIGlpID0gbWFwcGluZy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCW0gPSBtYXBwaW5nW2ldOwoJCQlHTVttWzBdXSA9IHRvX3Byb21pc2UodGhpc1ttWzFdXSwgdGhpcyk7CgkJfQoKCQlyZXR1cm4gR007Cgl9KS5jYWxsKHRoaXMpOwoKCS8vIFRhbXBlcm1vbmtleSBidWcgZml4CglpZiAod2luZG93LmRvY3VtZW50ID09PSB1bmRlZmluZWQpIHsKCQl3aW5kb3cgPSB3aW5kb3cudW5zYWZlV2luZG93OwoJfQoKCXZhciB0aW1pbmcgPSAoZnVuY3Rpb24gKCkgewoJCXZhciBwZXJmID0gd2luZG93LnBlcmZvcm1hbmNlLAoJCQlub3csIGZuOwoKCQlpZiAoIXBlcmYgfHwgIShub3cgPSBwZXJmLm5vdyB8fCBwZXJmLm1vek5vdyB8fCBwZXJmLm1zTm93IHx8IHBlcmYub05vdyB8fCBwZXJmLndlYmtpdE5vdykpIHsKCQkJcGVyZiA9IERhdGU7CgkJCW5vdyA9IHBlcmYubm93OwoJCX0KCgkJZm4gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBub3cuY2FsbChwZXJmKTsgfTsKCQlmbi5zdGFydCA9IG5vdy5jYWxsKHBlcmYpOwoJCXJldHVybiBmbjsKCX0pKCk7CgoJdmFyIGRvY3VtZW50ID0gd2luZG93LmRvY3VtZW50LAoJCWRvY3VtZW50X2VsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CgoJLyoje2JlZ2luX2RlYnVnfSMqLwoKCXZhciBicm93c2VyID0gewoJCWlzX29wZXJhOiAvcHJlc3RvL2kudGVzdCgiIiArIHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KSwKCQlpc19maXJlZm94OiAvZmlyZWZveC9pLnRlc3QoIiIgKyB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCkKCX07Cgl2YXIgZG9tYWlucyA9IHsKCQlleGhlbnRhaTogImV4aGVudGFpLm9yZyIsCgkJZ2VoZW50YWk6ICJnLmUtaGVudGFpLm9yZyIsCgkJZWhlbnRhaTogImUtaGVudGFpLm9yZyIsCgkJbmhlbnRhaTogIm5oZW50YWkubmV0IiwKCQloaXRvbWk6ICJoaXRvbWkubGEiCgl9OwoJdmFyIG9wdGlvbnMgPSB7CgkJZ2VuZXJhbDogWwoJCQkvLyBbIG5hbWUsIGRlZmF1bHQsIGxhYmVsLCBkZXNjcmlwdGlvbiwgb2xkX25hbWUsIGluZm8/IF0KCQkJWyAiYXV0b21hdGljX3Byb2Nlc3NpbmciLCB0cnVlLAoJCQkJIkF1dG9tYXRpYyBsaW5rIHByb2Nlc3NpbmciLCAiR2V0IGRhdGEgYW5kIGZvcm1hdCBsaW5rcyBhdXRvbWF0aWNhbGx5IiwKCQkJCSJBdXRvbWF0aWMgUHJvY2Vzc2luZyIKCQkJXSwKCQkJWyAiaWNvbmlmeSIsIGZhbHNlLAoJCQkJIkljb24gc2l0ZSB0YWdzIiwgIlVzZSBzaXRlLXNwZWNpZmljIGljb25zIGluc3RlYWQgb2YgW1NpdGVdIHRhZ3MiLAoJCQkJbnVsbAoJCQldLAoJCQlbICJjaGFuZ2Vsb2dfb25fdXBkYXRlIiwgdHJ1ZSwKCQkJCSJTaG93IGNoYW5nZWxvZyBvbiB1cGRhdGUiLCAiU2hvdyB0aGUgY2hhbmdlbG9nIGFmdGVyIGFuIHVwZGF0ZSIsCgkJCQkiU2hvdyBDaGFuZ2Vsb2cgb24gVXBkYXRlIgoJCQldLAoJCQlbICJleHRlcm5hbF9yZXNvdXJjZXMiLCB0cnVlLAoJCQkJIkFsbG93IGV4dGVybmFsIHJlc291cmNlcyIsICJFbmFibGUgdGhlIHVzYWdlIG9mIHdlYi1mb250cyBwcm92aWRlZCBieSBHb29nbGUgc2VydmVycyIsCgkJCQkiVXNlIEV4dGVucmFsIFJlc291cmNlcyIgLy8gW3NpY10KCQkJXSwKCQkJWyAiaW1hZ2VfbGVlY2hpbmdfZGlzYWJsZWQiLCBmYWxzZSwKCQkJCSJIaWRlIHJlZmVycmVyIGZvciB0aHVtYm5haWxzIiwgIlRodW1ibmFpbHMgZmV0Y2hpbmcgc2hvdWxkIG5vdCBzZW5kIHJlZmVycmVyIGluZm9ybWF0aW9uIiwKCQkJCSJEaXNhYmxlIEltYWdlIExlZWNoaW5nIgoJCQldLAoJCQlbICJjb21wYXRpYmlsaXR5X2NoZWNrIiwgdHJ1ZSwKCQkJCSJDb21wYXRpYmlsaXR5IGNoZWNrIiwgIlJ1biBhIGNvbXBhdGliaWxpdHkgY2hlY2sgb24gc2NyaXB0IHN0YXJ0IiwKCQkJCW51bGwKCQkJXSwKCQkJWyAicmV3cml0ZV9saW5rcyIsICJub25lIiwKCQkJCSJSZXdyaXRlIGxpbmsgVVJMcyIsICJSZXdyaXRlIGFsbCBFKkhlbnRhaSBsaW5rcyB0byB1c2UgYSBzcGVjaWZpYyBzaXRlIiwKCQkJCSJSZXdyaXRlIExpbmtzIiwKCQkJCXsKCQkJCQl0eXBlOiAic2VsZWN0IiwKCQkJCQlvcHRpb25zOiBbIC8vIFsgdmFsdWUsIGxhYmVsX3RleHQsIGRlc2NyaXB0aW9uPyBdCgkJCQkJCVsgIm5vbmUiLCAiRGlzYWJsZWQiIF0sCgkJCQkJCVsgInNtYXJ0IiwgIlNtYXJ0IiwgIkFsbCBsaW5rcyBsZWFkIHRvICIgKyBkb21haW5zLmdlaGVudGFpICsgIiB1bmxlc3MgdGhleSBoYXZlIGZqb3JkaW5nIHRhZ3MiIF0sCgkJCQkJCVsgZG9tYWlucy5nZWhlbnRhaSwgZG9tYWlucy5nZWhlbnRhaSBdLAoJCQkJCQlbIGRvbWFpbnMuZXhoZW50YWksIGRvbWFpbnMuZXhoZW50YWkgXQoJCQkJCV0KCQkJCX0KCQkJXSwKCQldLAoJCXNpdGVzOiBbCgkJCVsgImVoZW50YWkiLCB0cnVlLAoJCQkJImUqaGVudGFpLm9yZyIsICJFbmFibGUgbGluayBwcm9jZXNzaW5nIGZvciBFLUhlbnRhaSBhbmQgRXhIZW50YWkiLAoJCQkJbnVsbAoJCQldLAoJCQlbICJlaGVudGFpX2V4dCIsIGZhbHNlLAoJCQkJImUqaGVudGFpLm9yZyBleHRlbmRlZCIsICJGZXRjaCBleHRlbmRlZCBnYWxsZXJ5IGluZm8gZm9yIEUqSGVudGFpLCBpbmNsdWRpbmcgZmF2b3JpdGVkIGFuZCB2aXNpYmxlIHN0YXR1cyIsCgkJCQkiRXh0ZW5kZWQgSW5mbyIKCQkJXSwKCQkJWyAibmhlbnRhaSIsIHRydWUsCgkJCQkibmhlbnRhaS5uZXQiLCAiRW5hYmxlIGxpbmsgcHJvY2Vzc2luZyBmb3IgbmhlbnRhaS5uZXQiLAoJCQkJbnVsbAoJCQldLAoJCQlbICJoaXRvbWkiLCB0cnVlLAoJCQkJImhpdG9taS5sYSIsICJFbmFibGUgbGluayBwcm9jZXNzaW5nIGZvciBoaXRvbWkubGEiLAoJCQkJbnVsbAoJCQldLAoJCV0sCgkJZGV0YWlsczogWwoJCQlbICJlbmFibGVkIiwgdHJ1ZSwKCQkJCSJFbmFibGVkIiwgIlNob3cgZGV0YWlscyBmb3IgZ2FsbGVyeSBsaW5rcyBvbiBob3ZlciIsCgkJCQkiR2FsbGVyeSBEZXRhaWxzIgoJCQldLAoJCQlbICJ0YWdfbmFtZXNwYWNlX25ld2xpbmUiLCBmYWxzZSwKCQkJCSJOYW1lc3BhY2UgTmV3IExpbmVzIiwgIkVhY2ggdGFnIG5hbWVzcGFjZSB3aWxsIGJlIGRpc3BsYXllZCBvbiBpdHMgb3duIGxpbmUiLAoJCQkJbnVsbAoJCQldLAoJCQlbICJob3Zlcl9wb3NpdGlvbiIsIC0wLjI1LAoJCQkJIkhvdmVyaW5nIHBvc2l0aW9uIiwgIkNoYW5nZSB0aGUgaG9yaXpvbnRhbCBvZmZzZXQgb2YgdGhlIGdhbGxlcnkgZGV0YWlscyBmcm9tIHRoZSBjdXJzb3IiLAoJCQkJIkRldGFpbHMgSG92ZXIgUG9zaXRpb24iLAoJCQkJewoJCQkJCXR5cGU6ICJzZWxlY3QiLAoJCQkJCW9wdGlvbnM6IFsgLy8gWyB2YWx1ZSwgbGFiZWxfdGV4dCwgZGVzY3JpcHRpb24/IF0KCQkJCQkJWyAtMC4yNSwgIkRlZmF1bHQiLCAiT2Zmc2V0IHNsaWdodGx5IGZyb20gdGhlIGN1cnNvciIgXSwKCQkJCQkJWyAwLjAsICJFeExpbmtzIiwgIlVzZSB0aGUgb3JpZ2luYWwgRXhMaW5rcyBzdHlsZSBwb3NpdGlvbmluZyIgXQoJCQkJCV0sCgkJCQkJc2V0OiBmdW5jdGlvbiAodikgeyByZXR1cm4gcGFyc2VGbG9hdCh2KSB8fCAwLjA7IH0KCQkJCX0KCQkJXSwKCQkJWyAib3BhY2l0eSIsIDEuMCwKCQkJCSJPcGFjaXR5IiwgIk9wYWNpdHkgb2YgdGhlIGRldGFpbHMgZGlzcGxheSAoYXMgYSBwZXJjZW50YWdlKSIsCgkJCQludWxsLAoJCQkJewoJCQkJCXR5cGU6ICJ0ZXh0Ym94IiwKCQkJCQlnZXQ6IGZ1bmN0aW9uICh2KSB7CgkJCQkJCXJldHVybiAiIiArICh2ICogMTAwKTsKCQkJCQl9LAoJCQkJCXNldDogZnVuY3Rpb24gKHYpIHsKCQkJCQkJdiA9IHBhcnNlRmxvYXQodik7CgkJCQkJCWlmIChpc05hTih2KSkgewoJCQkJCQkJdiA9IDEuMDsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCXYgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCB2IC8gMTAwLjApKTsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gdjsKCQkJCQl9CgkJCQl9CgkJCV0sCgkJCVsgIm9wYWNpdHlfYmciLCAwLjkzLAoJCQkJIkJhY2tncm91bmQgb3BhY2l0eSIsICJPcGFjaXR5IG9mIHRoZSBkZXRhaWxzIGRpc3BsYXkgYmFja2dyb3VuZCAoYXMgYSBwZXJjZW50YWdlKSIsCgkJCQludWxsLAoJCQkJewoJCQkJCXR5cGU6ICJ0ZXh0Ym94IiwKCQkJCQlnZXQ6IGZ1bmN0aW9uICh2KSB7CgkJCQkJCXJldHVybiAiIiArICh2ICogMTAwKTsKCQkJCQl9LAoJCQkJCXNldDogZnVuY3Rpb24gKHYpIHsKCQkJCQkJdiA9IHBhcnNlRmxvYXQodik7CgkJCQkJCWlmIChpc05hTih2KSkgewoJCQkJCQkJdiA9IDAuOTM7CgkJCQkJCX0KCQkJCQkJZWxzZSB7CgkJCQkJCQl2ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdiAvIDEwMC4wKSk7CgkJCQkJCX0KCQkJCQkJcmV0dXJuIHY7CgkJCQkJfQoJCQkJfQoJCQldLAoJCV0sCgkJYWN0aW9uczogWwoJCQlbICJlbmFibGVkIiwgdHJ1ZSwKCQkJCSJFbmFibGVkIiwgIkdlbmVyYXRlIGdhbGxlcnkgYWN0aW9ucyBmb3IgbGlua3MiLAoJCQkJIkdhbGxlcnkgQWN0aW9ucyIKCQkJXSwKCQkJWyAiY2xvc2Vfb25fY2xpY2siLCB0cnVlLAoJCQkJIkNsb3NlIG9uIGNsaWNrIiwgIkNsb3NlIGdhbGxlcnkgYWN0aW9ucyBhZnRlciBjbGlja2luZyBhbnl3aGVyZSIsCgkJCQludWxsCgkJCV0sCgkJXSwKCQlzYXVjZTogWwoJCQlbICJlbmFibGVkIiwgdHJ1ZSwKCQkJCSJFbmFibGVkIiwgIkFkZCBFeFNhdWNlIHJldmVyc2UgaW1hZ2Ugc2VhcmNoIHRvIHBvc3RzIGNvbnRhaW5pbmcgaW1hZ2VzIiwKCQkJCSJFeFNhdWNlIgoJCQldLAoJCQlbICJleHB1bmdlZCIsIGZhbHNlLAoJCQkJIlNlYXJjaCBleHB1bmdlZCIsICJTZWFyY2ggZXhwdW5nZWQgZ2FsbGVyaWVzIGZvciBzb3VyY2UiLAoJCQkJIlNlYXJjaCBFeHB1bmdlZCIKCQkJXSwKCQkJWyAibGFiZWwiLCAiIiwKCQkJCSJDdXN0b20gbGFiZWwiLCAiVXNlIGEgY3VzdG9tIGxhYmVsIGluc3RlYWQgb2YgdGhlIHNpdGUgbmFtZSAoZS1oZW50YWkvZXhoZW50YWkpIiwKCQkJCSJDdXN0b20gTGFiZWwgVGV4dCIsCgkJCQl7IHR5cGU6ICJ0ZXh0Ym94IiB9CgkJCV0sCgkJCVsgImxvb2t1cF9kb21haW4iLCBkb21haW5zLmV4aGVudGFpLAoJCQkJIkxvb2t1cCBkb21haW4iLCAiVGhlIHNpdGUgdG8gdXNlIGZvciB0aGUgcmV2ZXJzZSBpbWFnZSBzZWFyY2giLAoJCQkJIkxvb2t1cCBEb21haW4iLAoJCQkJewoJCQkJCXR5cGU6ICJzZWxlY3QiLAoJCQkJCW9wdGlvbnM6IFsgLy8gWyB2YWx1ZSwgbGFiZWxfdGV4dCwgZGVzY3JpcHRpb24/IF0KCQkJCQkJWyBkb21haW5zLmdlaGVudGFpLCBkb21haW5zLmdlaGVudGFpIF0sCgkJCQkJCVsgZG9tYWlucy5leGhlbnRhaSwgZG9tYWlucy5leGhlbnRhaSBdCgkJCQkJXQoJCQkJfQoJCQldLAoJCV0sCgkJZWFzeV9saXN0OiBbCgkJCVsgImVuYWJsZWQiLCB0cnVlLAoJCQkJIkVuYWJsZWQiLCAiQWRkIEVhc3kgTGlzdCBsaW5rcyB0byB0aGUgcGFnZSIsCgkJCQludWxsCgkJCV0sCgkJCVsgIm9ubHlfaGVhZGVyX2ljb24iLCBmYWxzZSwKCQkJCSJJY29uIG9ubHkiLCAiT25seSBzaG93IHRoZSBwYW5kYSBpY29uIGluIHRoZSBoZWFkZXIgKGRvbid0IGdlbmVyYXRlIFtFYXN5IExpc3RdIGxpbmtzKSIsCgkJCQludWxsCgkJCV0sCgkJXSwKCQlmaWx0ZXI6IFsKCQkJWyAiZW5hYmxlZCIsIHRydWUsCgkJCQkiRW5hYmxlZCIsICJFbmFibGUgZmlsdGVyaW5nIG9mIGdhbGxlcmllcyIsCgkJCQludWxsCgkJCV0sCgkJCVsgImZ1bGxfaGlnaGxpZ2h0aW5nIiwgZmFsc2UsCgkJCQkiRnVsbCBoaWdobGlnaHRpbmciLCAiSGlnaGxpZ2h0IG9mIGFsbCB0aGUgdGV4dCBpbnN0ZWFkIG9mIGp1c3QgdGhlIG1hdGNoaW5nIHBvcnRpb24iLAoJCQkJIkZ1bGwgSGlnaGxpZ2h0aW5nIgoJCQldLAoJCQlbICJnb29kX3RhZ19tYXJrZXIiLCAiISIsCgkJCQkiR29vZCB0YWcgbWFya2VyIiwgIlRleHQgdG8gbWFyayBhIFtTaXRlXSB0YWcgd2l0aCB3aGVuIGEgZ29vZCBmaWx0ZXIgaXMgbWF0Y2hlZCIsCgkJCQkiR29vZCBUYWcgTWFya2VyIiwKCQkJCXsgdHlwZTogInRleHRib3giIH0sCgkJCV0sCgkJCVsgImJhZF90YWdfbWFya2VyIiwgIiIsCgkJCQkiQmFkIHRhZyBtYXJrZXIiLCAiVGV4dCB0byBtYXJrIGEgW1NpdGVdIHRhZyB3aXRoIHdoZW4gYSBiYWQgZmlsdGVyIGlzIG1hdGNoZWQiLAoJCQkJIkJhZCBUYWcgTWFya2VyIiwKCQkJCXsgdHlwZTogInRleHRib3giIH0sCgkJCV0sCgkJCVsgImZpbHRlcnMiLAoJCQkJKCAvL3sKCQkJCQkiIyBIaWdobGlnaHQgYWxsIGRvdWppbnNoaSBhbmQgbWFuZ2EgZ2FsbGVyaWVzIHdpdGggKEM4OCkgaW4gdGhlIG5hbWU6XG4iICsKCQkJCQkiIyAvXFwoQzg4XFwpL2k7b25seTpkb3VqaW5zaGksbWFuZ2E7bGluay1jb2xvcjpyZWQ7Y29sb3I6I0ZGMDAwMDt0aXRsZVxuIiArCgkJCQkJIiMgSGlnaGxpZ2h0IFwiZW5nbGlzaFwiIGFuZCBcInRyYW5zbGF0ZWRcIiB0YWdzIGluIG5vbi13ZXN0ZXJuIG5vbi1ub24taCBnYWxsZXJpZXM6XG4iICsKCQkJCQkiIyAvZW5nbGlzaHx0cmFuc2xhdGVkL2k7bm90Ondlc3Rlcm4sbm9uLWg7Y29sb3JzOiM0MDgwRjA7dGFnXG4iICsKCQkJCQkiIyBIaWdobGlnaHQgZ2FsbGVyaWVzIHRhZ2dlZCB3aXRoIFwidG91aG91IHByb2plY3RcIjpcbiIgKwoJCQkJCSIjIC90b3Vob3UgcHJvamVjdC9pO3VuZGVybGluZXM6cmdiYSgyNTUsMTI4LDY0LDEpO3RhZzt0aXRsZVxuIiArCgkJCQkJIiMgSGlnaGxpZ2h0IHJlbGVhc2VzIHRyYW5zbGF0ZWQgYnkgezUgYS5tLn06XG4iICsKCQkJCQkiIyAvXFx7PzVcXHMqYVtcXC4sXT9tW1xcLixdP1xcfT8vaTt0aXRsZTtiZ3M6IzNCQzYyMDtjb2xvcnM6I0ZERkExODtcbiIgKwoJCQkJCSIjIERvbid0IGhpZ2hsaWdodCBhbnl0aGluZyB1cGxvYWRlZCBieSBcIkNHcmFzY2FsXCJcbiIgKwoJCQkJCSIjIC9DR3Jhc2NhbC9pO2JhZDp5ZXM7dXBsb2FkZXI7dGl0bGU7IgoJCQkJKSwgLy99CgkJCQkiRmlsdGVycyIsICIiLAoJCQkJIkZpbHRlcnMiLAoJCQkJeyB0eXBlOiAidGV4dGFyZWEiIH0sCgkJCV0sCgkJXSwKCQlkZWJ1ZzogWwoJCQlbICJlbmFibGVkIiwgZmFsc2UsCgkJCQkiRW5hYmxlZCIsICJFbmFibGUgbG9nZ2luZyB0byB0aGUgYnJvd3NlciBjb25zb2xlIiwKCQkJCSJEZWJ1ZyBNb2RlIgoJCQldLAoJCQlbICJjYWNoZV9tb2RlIiwgImxvY2FsIiwKCQkJCSJDYWNoaW5nIG1vZGUiLCAiQ2hhbmdlIGhvdyB5b3VyIGJyb3dzZXIgY2FjaGVzIGxpbmsgaW5mb3JtYXRpb24iLAoJCQkJZnVuY3Rpb24gKGNvbmZpZ19vbGQpIHsKCQkJCQlpZiAoY29uZmlnX29sZFsiRGlzYWJsZSBDYWNoaW5nIl0pIHJldHVybiAibm9uZSI7CgkJCQkJaWYgKGNvbmZpZ19vbGRbIkRpc2FibGUgTG9jYWwgU3RvcmFnZSBDYWNoZSJdKSByZXR1cm4gInNlc3Npb24iOwoJCQkJCXJldHVybiAibG9jYWwiOwoJCQkJfSwKCQkJCXsKCQkJCQl0eXBlOiAic2VsZWN0IiwKCQkJCQlvcHRpb25zOiBbIC8vIFsgdmFsdWUsIGxhYmVsX3RleHQsIGRlc2NyaXB0aW9uPyBdCgkJCQkJCVsgImxvY2FsIiwgIkxvY2FsIHN0b3JhZ2UiLCAiRGF0YSBpcyBjYWNoZWQgcGVyIHdlYnNpdGUiIF0sCgkJCQkJCVsgInNlc3Npb24iLCAiU2Vzc2lvbiBzdG9yYWdlIiwgIkRhdGEgaXMgY2FjaGVkIHBlciBicm93c2VyIHRhYiIgXSwKCQkJCQkJWyAibm9uZSIsICJEaXNhYmxlZCIsICJEYXRhIGlzIG5vdCBjYWNoZWQiIF0sCgkJCQkJXQoJCQkJfQoJCQldLAoJCV0sCgl9OwoJdmFyIGNvbmZpZyA9IHsgdmVyc2lvbjogbnVsbCwgc2V0dGluZ3NfdmVyc2lvbjogMSB9OwoKCXZhciBNdXRhdGlvbk9ic2VydmVyID0gKGZ1bmN0aW9uICgpIHsKCgkJdmFyIE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlciB8fCBudWxsOwoKCQlpZiAoTXV0YXRpb25PYnNlcnZlciA9PT0gbnVsbCkgewoJCQkvLyBQYXJ0aWFsIHBvbHlmaWxsCgkJCXZhciBvbl9ib2R5X25vZGVfYWRkID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCQl2YXIgbm9kZSA9IGV2ZW50LnRhcmdldDsKCQkJCXRoaXMuY2FsbGJhY2suY2FsbCh0aGlzLCBbewoJCQkJCXRhcmdldDogbm9kZS5wYXJlbnROb2RlLAoJCQkJCWFkZGVkTm9kZXM6IFsgbm9kZSBdLAoJCQkJCXJlbW92ZWROb2RlczogW10sCgkJCQkJbmV4dFNpYmxpbmc6IG5vZGUubmV4dFNpYmxpbmcsCgkJCQkJcHJldmlvdXNTaWJsaW5nOiBub2RlLnByZXZpb3VzU2libGluZwoJCQkJfV0pOwoJCQl9OwoJCQl2YXIgb25fYm9keV9ub2RlX3JlbW92ZSA9IGZ1bmN0aW9uIChldmVudCkgewoJCQkJdmFyIG5vZGUgPSBldmVudC50YXJnZXQ7CgkJCQl0aGlzLmNhbGxiYWNrLmNhbGwodGhpcywgW3sKCQkJCQl0YXJnZXQ6IG5vZGUucGFyZW50Tm9kZSwKCQkJCQlhZGRlZE5vZGVzOiBbXSwKCQkJCQlyZW1vdmVkTm9kZXM6IFsgbm9kZSBdLAoJCQkJCW5leHRTaWJsaW5nOiBub2RlLm5leHRTaWJsaW5nLAoJCQkJCXByZXZpb3VzU2libGluZzogbm9kZS5wcmV2aW91c1NpYmxpbmcKCQkJCX1dKTsKCQkJfTsKCgkJCU11dGF0aW9uT2JzZXJ2ZXIgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKCQkJCXRoaXMub25fYm9keV9ub2RlX2FkZCA9ICQuYmluZChvbl9ib2R5X25vZGVfYWRkLCB0aGlzKTsKCQkJCXRoaXMub25fYm9keV9ub2RlX3JlbW92ZSA9ICQuYmluZChvbl9ib2R5X25vZGVfcmVtb3ZlLCB0aGlzKTsKCQkJCXRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjazsKCQkJCXRoaXMubm9kZXMgPSBbXTsKCQkJfTsKCQkJTXV0YXRpb25PYnNlcnZlci5wcm90b3R5cGUub2JzZXJ2ZSA9IGZ1bmN0aW9uIChub2RlLCBkYXRhKSB7CgkJCQl0aGlzLm5vZGVzLnB1c2gobm9kZSk7CgkJCQlpZiAoZGF0YS5jaGlsZExpc3QpIHsKCQkJCQkkLm9uKG5vZGUsICJET01Ob2RlSW5zZXJ0ZWQiLCB0aGlzLm9uX2JvZHlfbm9kZV9hZGQpOwoJCQkJCSQub24obm9kZSwgIkRPTU5vZGVSZW1vdmVkIiwgdGhpcy5vbl9ib2R5X25vZGVfcmVtb3ZlKTsKCQkJCX0KCQkJfTsKCQkJTXV0YXRpb25PYnNlcnZlci5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHsKCQkJCXZhciBub2RlLCBpLCBpaTsKCQkJCWZvciAoaSA9IDAsIGlpID0gdGhpcy5ub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJbm9kZSA9IHRoaXMubm9kZXNbaV07CgkJCQkJJC5vZmYobm9kZSwgIkRPTU5vZGVJbnNlcnRlZCIsIHRoaXMub25fYm9keV9ub2RlX2FkZCk7CgkJCQkJJC5vZmYobm9kZSwgIkRPTU5vZGVSZW1vdmVkIiwgdGhpcy5vbl9ib2R5X25vZGVfcmVtb3ZlKTsKCQkJCX0KCQkJCXRoaXMubm9kZXMgPSBbXTsKCQkJfTsKCQl9CgoJCXJldHVybiBNdXRhdGlvbk9ic2VydmVyOwoKCX0pKCk7Cgl2YXIgJCQgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHJvb3QpIHsKCQlyZXR1cm4gKHJvb3QgfHwgZG9jdW1lbnQpLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpOwoJfTsKCXZhciAkID0gKGZ1bmN0aW9uICgpIHsKCgkJdmFyIGQgPSBkb2N1bWVudCwKCQkJcmVfZnVsbF9kb21haW4gPSAvXig/Oltcd1wtXSspOlwvKigoPzpbXHdcLV0rXC4pK1tcd1wtXSspL2ksCgkJCXJlX3Nob3J0X2RvbWFpbiA9IC9eKD86W1x3XC1dKyk6XC8qKD86W1x3XC1dK1wuKSooW1x3XC1dK1wuW1x3XC1dKykvaSwKCQkJcmVfY2hhbmdlX2RvbWFpbiA9IC9eKFtcd1wtXSs6XC8qKShbXHdcLV0rKD86XC5bXHdcLV0rKSopKFtcd1xXXSopJC9pOwoKCQl2YXIgTW9kdWxlID0gZnVuY3Rpb24gKHNlbGVjdG9yLCByb290KSB7CgkJCXJldHVybiAocm9vdCB8fCBkKS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsKCQl9OwoKCQlNb2R1bGUucmVhZHkgPSAoZnVuY3Rpb24gKCkgewoKCQkJdmFyIGNhbGxiYWNrcyA9IFtdLAoJCQkJY2hlY2tfaW50ZXJ2YWwgPSBudWxsLAoJCQkJY2hlY2tfaW50ZXJ2YWxfdGltZSA9IDI1MDsKCgkJCXZhciBjYWxsYmFja19jaGVjayA9IGZ1bmN0aW9uICgpIHsKCQkJCWlmICgKCQkJCQkoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gImludGVyYWN0aXZlIiB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiKSAmJgoJCQkJCWNhbGxiYWNrcyAhPT0gbnVsbAoJCQkJKSB7CgkJCQkJdmFyIGNicyA9IGNhbGxiYWNrcywKCQkJCQkJY2JfY291bnQgPSBjYnMubGVuZ3RoLAoJCQkJCQlpOwoKCQkJCQljYWxsYmFja3MgPSBudWxsOwoKCQkJCQlmb3IgKGkgPSAwOyBpIDwgY2JfY291bnQ7ICsraSkgewoJCQkJCQljYnNbaV0uY2FsbChudWxsKTsKCQkJCQl9CgoJCQkJCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIiwgY2FsbGJhY2tfY2hlY2ssIGZhbHNlKTsKCQkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGNhbGxiYWNrX2NoZWNrLCBmYWxzZSk7CgkJCQkJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVhZHlzdGF0ZWNoYW5nZSIsIGNhbGxiYWNrX2NoZWNrLCBmYWxzZSk7CgoJCQkJCWlmIChjaGVja19pbnRlcnZhbCAhPT0gbnVsbCkgewoJCQkJCQljbGVhckludGVydmFsKGNoZWNrX2ludGVydmFsKTsKCQkJCQkJY2hlY2tfaW50ZXJ2YWwgPSBudWxsOwoJCQkJCX0KCgkJCQkJcmV0dXJuIHRydWU7CgkJCQl9CgoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9OwoKCQkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBjYWxsYmFja19jaGVjaywgZmFsc2UpOwoJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIGNhbGxiYWNrX2NoZWNrLCBmYWxzZSk7CgkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoInJlYWR5c3RhdGVjaGFuZ2UiLCBjYWxsYmFja19jaGVjaywgZmFsc2UpOwoKCQkJcmV0dXJuIGZ1bmN0aW9uIChjYikgewoJCQkJaWYgKGNhbGxiYWNrcyA9PT0gbnVsbCkgewoJCQkJCWNiLmNhbGwobnVsbCk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQljYWxsYmFja3MucHVzaChjYik7CgkJCQkJaWYgKGNoZWNrX2ludGVydmFsID09PSBudWxsICYmIGNhbGxiYWNrX2NoZWNrKCkgIT09IHRydWUpIHsKCQkJCQkJY2hlY2tfaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChjYWxsYmFja19jaGVjaywgY2hlY2tfaW50ZXJ2YWxfdGltZSk7CgkJCQkJfQoJCQkJfQoJCQl9OwoKCQl9KSgpOwoKCQlNb2R1bGUuaHRtbF9mcmFnbWVudCA9IGZ1bmN0aW9uIChjb250ZW50KSB7CgkJCXZhciBmcmFnID0gZC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksCgkJCQlkaXYgPSBkLmNyZWF0ZUVsZW1lbnQoImRpdiIpLAoJCQkJbiwgbmV4dDsKCgkJCWRpdi5pbm5lckhUTUwgPSBjb250ZW50OwoJCQlmb3IgKG4gPSBkaXYuZmlyc3RDaGlsZDsgbiAhPT0gbnVsbDsgbiA9IG5leHQpIHsKCQkJCW5leHQgPSBuLm5leHRTaWJsaW5nOwoJCQkJZnJhZy5hcHBlbmRDaGlsZChuKTsKCQkJfQoJCQlyZXR1cm4gZnJhZzsKCQl9OwoJCU1vZHVsZS5wcmVwZW5kID0gZnVuY3Rpb24gKHBhcmVudCwgY2hpbGQpIHsKCQkJcmV0dXJuIHBhcmVudC5pbnNlcnRCZWZvcmUoY2hpbGQsIHBhcmVudC5maXJzdENoaWxkKTsKCQl9OwoJCU1vZHVsZS5hZGQgPSBmdW5jdGlvbiAocGFyZW50LCBjaGlsZCkgewoJCQlyZXR1cm4gcGFyZW50LmFwcGVuZENoaWxkKGNoaWxkKTsKCQl9OwoJCU1vZHVsZS5iZWZvcmUgPSBmdW5jdGlvbiAocm9vdCwgbmV4dCwgbm9kZSkgewoJCQlyZXR1cm4gcm9vdC5pbnNlcnRCZWZvcmUobm9kZSwgbmV4dCk7CgkJfTsKCQlNb2R1bGUuYWZ0ZXIgPSBmdW5jdGlvbiAocm9vdCwgcHJldiwgbm9kZSkgewoJCQlyZXR1cm4gcm9vdC5pbnNlcnRCZWZvcmUobm9kZSwgcHJldi5uZXh0U2libGluZyk7CgkJfTsKCQlNb2R1bGUucmVwbGFjZSA9IGZ1bmN0aW9uIChyb290LCBlbGVtKSB7CgkJCXJldHVybiByb290LnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGVsZW0sIHJvb3QpOwoJCX07CgkJTW9kdWxlLnJlbW92ZSA9IGZ1bmN0aW9uIChlbGVtKSB7CgkJCXJldHVybiBlbGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbSk7CgkJfTsKCQlNb2R1bGUudG5vZGUgPSBmdW5jdGlvbiAodGV4dCkgewoJCQlyZXR1cm4gZC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTsKCQl9OwoJCU1vZHVsZS5ub2RlID0gZnVuY3Rpb24gKHRhZywgY2xhc3NfbmFtZSwgdGV4dCkgewoJCQl2YXIgZWxlbSA9IGQuY3JlYXRlRWxlbWVudCh0YWcpOwoJCQllbGVtLmNsYXNzTmFtZSA9IGNsYXNzX25hbWU7CgkJCWlmICh0ZXh0ICE9PSB1bmRlZmluZWQpIHsKCQkJCWVsZW0udGV4dENvbnRlbnQgPSB0ZXh0OwoJCQl9CgkJCXJldHVybiBlbGVtOwoJCX07CgkJTW9kdWxlLm5vZGVfbnMgPSBmdW5jdGlvbiAobmFtZXNwYWNlLCB0YWcsIGNsYXNzX25hbWUpIHsKCQkJdmFyIGVsZW0gPSBkLmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2UsIHRhZyk7CgkJCWVsZW0uc2V0QXR0cmlidXRlKCJjbGFzcyIsIGNsYXNzX25hbWUpOwoJCQlyZXR1cm4gZWxlbTsKCQl9OwoJCU1vZHVsZS5ub2RlX3NpbXBsZSA9IGZ1bmN0aW9uICh0YWcpIHsKCQkJcmV0dXJuIGQuY3JlYXRlRWxlbWVudCh0YWcpOwoJCX07CgkJTW9kdWxlLmxpbmsgPSBmdW5jdGlvbiAoaHJlZiwgY2xhc3NfbmFtZSwgdGV4dCkgewoJCQl2YXIgZWxlbSA9IGQuY3JlYXRlRWxlbWVudCgiYSIpOwoJCQlpZiAoaHJlZiAhPT0gdW5kZWZpbmVkKSB7CgkJCQllbGVtLmhyZWYgPSBocmVmOwoJCQkJZWxlbS50YXJnZXQgPSAiX2JsYW5rIjsKCQkJCWVsZW0ucmVsID0gIm5vcmVmZXJyZXIiOwoJCQl9CgkJCWlmIChjbGFzc19uYW1lICE9PSB1bmRlZmluZWQpIHsKCQkJCWVsZW0uY2xhc3NOYW1lID0gY2xhc3NfbmFtZTsKCQkJfQoJCQlpZiAodGV4dCAhPT0gdW5kZWZpbmVkKSB7CgkJCQllbGVtLnRleHRDb250ZW50ID0gdGV4dDsKCQkJfQoJCQlyZXR1cm4gZWxlbTsKCQl9OwoJCU1vZHVsZS5vbiA9IGZ1bmN0aW9uIChlbGVtLCBldmVudGxpc3QsIGhhbmRsZXIpIHsKCQkJdmFyIGV2ZW50LCBpLCBpaTsKCQkJaWYgKGV2ZW50bGlzdCBpbnN0YW5jZW9mIEFycmF5KSB7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IGV2ZW50bGlzdC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJZXZlbnQgPSBldmVudGxpc3RbaV07CgkJCQkJZWxlbS5hZGRFdmVudExpc3RlbmVyKGV2ZW50WzBdLCBldmVudFsxXSwgZmFsc2UpOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJZWxlbS5hZGRFdmVudExpc3RlbmVyKGV2ZW50bGlzdCwgaGFuZGxlciwgZmFsc2UpOwoJCQl9CgkJfTsKCQlNb2R1bGUub2ZmID0gZnVuY3Rpb24gKGVsZW0sIGV2ZW50bGlzdCwgaGFuZGxlcikgewoJCQl2YXIgZXZlbnQsIGksIGlpOwoJCQlpZiAoZXZlbnRsaXN0IGluc3RhbmNlb2YgQXJyYXkpIHsKCQkJCWZvciAoaSA9IDAsIGlpID0gZXZlbnRsaXN0Lmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQlldmVudCA9IGV2ZW50bGlzdFtpXTsKCQkJCQllbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRbMF0sIGV2ZW50WzFdLCBmYWxzZSk7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQllbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRsaXN0LCBoYW5kbGVyLCBmYWxzZSk7CgkJCX0KCQl9OwoJCU1vZHVsZS50ZXN0ID0gZnVuY3Rpb24gKGVsZW0sIHNlbGVjdG9yKSB7CgkJCXRyeSB7CgkJCQlyZXR1cm4gZWxlbS5tYXRjaGVzID8gZWxlbS5tYXRjaGVzKHNlbGVjdG9yKSA6IGVsZW0ubWF0Y2hlc1NlbGVjdG9yKHNlbGVjdG9yKTsKCQkJfQoJCQljYXRjaCAoZSkge30KCQkJcmV0dXJuIGZhbHNlOwoJCX07CgkJTW9kdWxlLnVud3JhcCA9IGZ1bmN0aW9uIChub2RlKSB7CgkJCXZhciBwYXIgPSBub2RlLnBhcmVudE5vZGUsCgkJCQluZXh0LCBuOwoKCQkJaWYgKHBhciAhPT0gbnVsbCkgewoJCQkJbmV4dCA9IG5vZGUubmV4dFNpYmxpbmc7CgkJCQl3aGlsZSAoKG4gPSBub2RlLmZpcnN0Q2hpbGQpICE9PSBudWxsKSB7CgkJCQkJcGFyLmluc2VydEJlZm9yZShuLCBuZXh0KTsKCQkJCX0KCQkJCXBhci5yZW1vdmVDaGlsZChub2RlKTsKCQkJfQoJCX07CgoJCU1vZHVsZS5pbnNlcnRfc3R5bGVzID0gZnVuY3Rpb24gKHN0eWxlcykgewoJCQl2YXIgaGVhZCA9IGQuaGVhZCwKCQkJCW47CgkJCWlmIChoZWFkKSB7CgkJCQluID0gZC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwoJCQkJbi50ZXh0Q29udGVudCA9IHN0eWxlczsKCQkJCWhlYWQuYXBwZW5kQ2hpbGQobik7CgkJCX0KCQl9OwoJCU1vZHVsZS5zY3JvbGxfZm9jdXMgPSBmdW5jdGlvbiAoZWxlbWVudCkgewoJCQkvLyBGb2N1cwoJCQl2YXIgbiA9IGQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTsKCQkJZWxlbWVudC5pbnNlcnRCZWZvcmUobiwgZWxlbWVudC5maXJzdENoaWxkKTsKCQkJbi5mb2N1cygpOwoJCQluLmJsdXIoKTsKCQkJZWxlbWVudC5yZW1vdmVDaGlsZChuKTsKCgkJCS8vIFNjcm9sbCB0byB0b3AKCQkJZWxlbWVudC5zY3JvbGxUb3AgPSAwOwoJCQllbGVtZW50LnNjcm9sbExlZnQgPSAwOwoJCX07CgkJTW9kdWxlLmNsYW1wID0gZnVuY3Rpb24gKHZhbHVlLCBtaW4sIG1heCkgewoJCQlyZXR1cm4gTWF0aC5taW4obWF4LCBNYXRoLm1heChtaW4sIHZhbHVlKSk7CgkJfTsKCQlNb2R1bGUuaXNfbGVmdF9tb3VzZSA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlyZXR1cm4gKGV2ZW50LndoaWNoID09PSB1bmRlZmluZWQgfHwgZXZlbnQud2hpY2ggPT09IDEpOwoJCX07CgkJTW9kdWxlLnB1c2hfbWFueSA9IGZ1bmN0aW9uICh0YXJnZXQsIG5ld19lbnRyaWVzKSB7CgkJCXZhciBtYXhfcHVzaCA9IDEwMDA7CgkJCWlmIChuZXdfZW50cmllcy5sZW5ndGggPCBtYXhfcHVzaCkgewoJCQkJQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkodGFyZ2V0LCBuZXdfZW50cmllcyk7CgkJCX0KCQkJZWxzZSB7CgkJCQlmb3IgKHZhciBpID0gMCwgaWkgPSBuZXdfZW50cmllcy5sZW5ndGg7IGkgPCBpaTsgaSArPSBtYXhfcHVzaCkgewoJCQkJCUFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHRhcmdldCwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwobmV3X2VudHJpZXMsIGksIGkgKyBtYXhfcHVzaCkpOwoJCQkJfQoJCQl9CgkJfTsKCQlNb2R1bGUuYmluZCA9IGZ1bmN0aW9uIChmbiwgc2VsZikgewoJCQlpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHsKCQkJCXZhciBpID0gMCwKCQkJCQlpaSA9IGFyZ3VtZW50cy5sZW5ndGggLSAyLAoJCQkJCWFyZ3MgPSBuZXcgQXJyYXkoaWkpOwoKCQkJCWZvciAoOyBpIDwgaWk7ICsraSkgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMl07CgoJCQkJcmV0dXJuIGZ1bmN0aW9uICgpIHsKCQkJCQl2YXIgZnVsbF9hcmdzID0gYXJncy5zbGljZSgpLAoJCQkJCQlpLCBpaTsKCgkJCQkJZm9yIChpID0gMCwgaWkgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQlmdWxsX2FyZ3MucHVzaChhcmd1bWVudHNbaV0pOwoJCQkJCX0KCgkJCQkJcmV0dXJuIGZuLmFwcGx5KHNlbGYsIGZ1bGxfYXJncyk7CgkJCQl9OwoJCQl9CgkJCWVsc2UgewoJCQkJcmV0dXJuIGZ1bmN0aW9uICgpIHsKCQkJCQlyZXR1cm4gZm4uYXBwbHkoc2VsZiwgYXJndW1lbnRzKTsKCQkJCX07CgkJCX0KCQl9OwoKCQl2YXIgbW91c2VlbnRlcmxlYXZlX2V2ZW50X3ZhbGlkYXRlID0gZnVuY3Rpb24gKHNlbGYsIHBhcmVudCkgewoJCQl0cnkgewoJCQkJZm9yICg7IHBhcmVudDsgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGUpIHsKCQkJCQlpZiAocGFyZW50ID09PSBzZWxmKSByZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQlyZXR1cm4gdHJ1ZTsKCQkJfQoJCQljYXRjaCAoZSkge30KCQkJcmV0dXJuIGZhbHNlOwoJCX07CgkJTW9kdWxlLndyYXBfbW91c2VlbnRlcmxlYXZlX2V2ZW50ID0gZnVuY3Rpb24gKGZuKSB7CgkJCXJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJCXJldHVybiBtb3VzZWVudGVybGVhdmVfZXZlbnRfdmFsaWRhdGUodGhpcywgZXZlbnQucmVsYXRlZFRhcmdldCkgPyBmbi5jYWxsKHRoaXMsIGV2ZW50KSA6IHVuZGVmaW5lZDsKCQkJfTsKCQl9OwoKCQl2YXIgcGFyc2VfdXJsID0gZnVuY3Rpb24gKHVybCkgewoJCQl2YXIgcmV0ID0gewoJCQkJCXByb3RvY29sOiBudWxsLAoJCQkJCWhvc3Q6IG51bGwsCgkJCQkJcGF0aG5hbWU6IG51bGwsCgkJCQkJc2VhcmNoOiBudWxsLAoJCQkJCWhhc2g6IG51bGwKCQkJCX0sCgkJCQltID0gL15bXHdcLV0rOi8uZXhlYyh1cmwpOwoKCQkJaWYgKG0gIT09IG51bGwpIHsKCQkJCXJldC5wcm90b2NvbCA9IG1bMF07CgkJCQltID0gL15cL3swLDJ9KFteXC9cPyNdKikoXC9bXlw/I10qKT8oXD9bXiNdKik/KCNbXHdcV10qKT8vLmV4ZWModXJsLnN1YnN0cihtLmluZGV4ICsgbVswXS5sZW5ndGgpKTsKCQkJfQoJCQllbHNlIHsKCQkJCW0gPSAvXig/OlwvXC8oW15cL1w/I10qKSk/KFteXD8jXSspPyhcP1teI10qKT8oI1tcd1xXXSopPy8uZXhlYyh1cmwpOwoJCQl9CgoJCQlpZiAobSAhPT0gbnVsbCkgewoJCQkJaWYgKG1bMV0gIT09IHVuZGVmaW5lZCkgewoJCQkJCXJldC5ob3N0ID0gbVsxXTsKCQkJCQlyZXQucGF0aG5hbWUgPSBtWzJdIHx8ICIvIjsKCQkJCQlyZXQuc2VhcmNoID0gbVszXSB8fCAiIjsKCQkJCQlyZXQuaGFzaCA9IG1bNF0gfHwgIiI7CgkJCQl9CgkJCQllbHNlIGlmIChtWzJdICE9PSB1bmRlZmluZWQpIHsKCQkJCQlyZXQucGF0aG5hbWUgPSBtWzJdOwoJCQkJCXJldC5zZWFyY2ggPSBtWzNdIHx8ICIiOwoJCQkJCXJldC5oYXNoID0gbVs0XSB8fCAiIjsKCQkJCX0KCQkJCWVsc2UgaWYgKG1bM10gIT09IHVuZGVmaW5lZCkgewoJCQkJCXJldC5zZWFyY2ggPSBtWzNdOwoJCQkJCXJldC5oYXNoID0gbVs0XSB8fCAiIjsKCQkJCX0KCQkJCWVsc2UgaWYgKG1bNF0gIT09IHVuZGVmaW5lZCkgewoJCQkJCXJldC5oYXNoID0gbVs0XTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHJldDsKCQl9OwoJCU1vZHVsZS5yZXNvbHZlID0gZnVuY3Rpb24gKHVybCwgZnJvbSkgewoJCQl2YXIgdXJsX2xvYyA9IHBhcnNlX3VybCh1cmwgfHwgIiIpLAoJCQkJZnJvbV9sb2MgPSBwYXJzZV91cmwoZnJvbSAhPT0gdW5kZWZpbmVkID8gZnJvbSA6IHdpbmRvdy5sb2NhdGlvbi5ocmVmKSwKCQkJCXVybF9wYXRoID0gdXJsX2xvYy5wYXRobmFtZSwKCQkJCWZyb21fcGF0aCA9IGZyb21fbG9jLnBhdGhuYW1lOwoKCQkJaWYgKHVybF9sb2MucHJvdG9jb2wgPT09IG51bGwpIHVybF9sb2MucHJvdG9jb2wgPSBmcm9tX2xvYy5wcm90b2NvbDsKCQkJaWYgKHVybF9sb2MuaG9zdCA9PT0gbnVsbCkgdXJsX2xvYy5ob3N0ID0gZnJvbV9sb2MuaG9zdDsKCQkJaWYgKHVybF9sb2Muc2VhcmNoID09PSBudWxsKSB1cmxfbG9jLnNlYXJjaCA9IGZyb21fbG9jLnNlYXJjaDsKCQkJaWYgKHVybF9sb2MuaGFzaCA9PT0gbnVsbCkgdXJsX2xvYy5oYXNoID0gZnJvbV9sb2MuaGFzaDsKCgkJCWlmICh1cmxfcGF0aCA9PT0gbnVsbCkgewoJCQkJdXJsX3BhdGggPSBmcm9tX3BhdGg7CgkJCX0KCQkJZWxzZSBpZiAoZnJvbV9wYXRoICE9PSBudWxsKSB7CgkJCQlpZiAodXJsX3BhdGgubGVuZ3RoID09PSAwKSB7CgkJCQkJdXJsX3BhdGggPSBmcm9tX3BhdGg7CgkJCQl9CgkJCQllbHNlIGlmICh1cmxfcGF0aFswXSAhPT0gIi8iKSB7CgkJCQkJdXJsX3BhdGggPSBmcm9tX3BhdGgucmVwbGFjZSgvW15cL10qJC8sICIiKSArIHVybF9wYXRoOwoJCQkJfQoJCQl9CgoJCQl1cmwgPSAiIjsKCQkJaWYgKHVybF9sb2MucHJvdG9jb2wgIT09IG51bGwpIHVybCArPSB1cmxfbG9jLnByb3RvY29sOwoJCQlpZiAodXJsX2xvYy5ob3N0ICE9PSBudWxsKSB1cmwgKz0gIi8vIiArIHVybF9sb2MuaG9zdDsKCQkJaWYgKHVybF9wYXRoICE9PSBudWxsKSB1cmwgKz0gdXJsX3BhdGg7CgkJCWlmICh1cmxfbG9jLnNlYXJjaCAhPT0gbnVsbCkgdXJsICs9IHVybF9sb2Muc2VhcmNoOwoJCQlpZiAodXJsX2xvYy5oYXNoICE9PSBudWxsKSB1cmwgKz0gdXJsX2xvYy5oYXNoOwoKCQkJcmV0dXJuIHVybDsKCQl9OwoKCQlNb2R1bGUuY3JlYXRlX3JlZ2V4X3NhZmUgPSBmdW5jdGlvbiAodGV4dCwgZmxhZ3MpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiBuZXcgUmVnRXhwKHRleHQsIGZsYWdzKTsKCQkJfQoJCQljYXRjaCAoZSkge30KCQkJcmV0dXJuIG51bGw7CgkJfTsKCQlNb2R1bGUucmVnZXhfZXNjYXBlID0gZnVuY3Rpb24gKHRleHQpIHsKCQkJcmV0dXJuIHRleHQucmVwbGFjZSgvW1wkXChcKVwqXCtcLVwuXC9cP1xbXFxcXVxeXHtcfFx9XS9nLCAiXFwkJiIpOwoJCX07CgkJTW9kdWxlLmpzb25fcGFyc2Vfc2FmZSA9IGZ1bmN0aW9uICh0ZXh0LCBkZWYpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiBKU09OLnBhcnNlKHRleHQpOwoJCQl9CgkJCWNhdGNoIChlKSB7fQoJCQlyZXR1cm4gZGVmOwoJCX07CgkJTW9kdWxlLmh0bWxfcGFyc2Vfc2FmZSA9IGZ1bmN0aW9uICh0ZXh0LCBkZWYpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRleHQsICJ0ZXh0L2h0bWwiKTsKCQkJfQoJCQljYXRjaCAoZSkge30KCQkJcmV0dXJuIGRlZjsKCQl9OwoJCU1vZHVsZS54bWxfcGFyc2Vfc2FmZSA9IGZ1bmN0aW9uICh0ZXh0LCBkZWYpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHRleHQsICJ0ZXh0L3htbCIpOwoJCQl9CgkJCWNhdGNoIChlKSB7fQoJCQlyZXR1cm4gZGVmOwoJCX07CgkJTW9kdWxlLmdldF9kb21haW4gPSBmdW5jdGlvbiAodXJsKSB7CgkJCXZhciBtID0gcmVfc2hvcnRfZG9tYWluLmV4ZWModXJsKTsKCQkJcmV0dXJuIChtID09PSBudWxsKSA/ICIiIDogbVsxXS50b0xvd2VyQ2FzZSgpOwoJCX07CgkJTW9kdWxlLmdldF9mdWxsX2RvbWFpbiA9IGZ1bmN0aW9uICh1cmwpIHsKCQkJdmFyIG0gPSByZV9mdWxsX2RvbWFpbi5leGVjKHVybCk7CgkJCXJldHVybiAobSA9PT0gbnVsbCkgPyAiIiA6IG1bMV0udG9Mb3dlckNhc2UoKTsKCQl9OwoJCU1vZHVsZS5jaGFuZ2VfdXJsX2RvbWFpbiA9IGZ1bmN0aW9uICh1cmwsIG5ld19kb21haW4pIHsKCQkJdmFyIG0gPSByZV9jaGFuZ2VfZG9tYWluLmV4ZWModXJsKTsKCQkJcmV0dXJuIChtID09PSBudWxsKSA/IHVybCA6IG1bMV0gKyBuZXdfZG9tYWluICsgbVszXTsKCQl9OwoKCQlpZiAodHlwZW9mKHdpbmRvdy5idG9hKSA9PT0gImZ1bmN0aW9uIikgewoJCQlNb2R1bGUuYmFzZTY0X2VuY29kZSA9IGZ1bmN0aW9uIChkYXRhKSB7CgkJCQlyZXR1cm4gd2luZG93LmJ0b2EoZGF0YSk7CgkJCX07CgkJCU1vZHVsZS5iYXNlNjRfZGVjb2RlID0gZnVuY3Rpb24gKGRhdGEpIHsKCQkJCXJldHVybiB3aW5kb3cuYXRvYihkYXRhKTsKCQkJfTsKCQl9CgoJCXZhciB1aW50OF9hcnJheV90b19zdHJpbmcgPSBmdW5jdGlvbiAoZGF0YSkgewoJCQl2YXIgcyA9ICIiLAoJCQkJc3RlcCA9IDEwMDAsCgkJCQlpaSA9IGRhdGEubGVuZ3RoLAoJCQkJaTsKCgkJCWZvciAoaSA9IDA7IGkgPCBpaTsgaSArPSBzdGVwKSB7CgkJCQlzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkoU3RyaW5nLCBkYXRhLnN1YmFycmF5KGksIGkgKyBzdGVwKSk7CgkJCX0KCgkJCXJldHVybiBzOwoJCX07CgkJdmFyIGNyZWF0ZV9kYXRhX3VyaSA9IGZ1bmN0aW9uIChkYXRhLCBtZWRpYV90eXBlKSB7CgkJCXJldHVybiAiZGF0YToiICsgbWVkaWFfdHlwZSArICI7YmFzZTY0LCIgKyBNb2R1bGUuYmFzZTY0X2VuY29kZSh1aW50OF9hcnJheV90b19zdHJpbmcoZGF0YSkpOwoJCX07CgkJTW9kdWxlLmNyZWF0ZV91cmxfZnJvbV9kYXRhID0gZnVuY3Rpb24gKGRhdGEsIG1lZGlhX3R5cGUsIGFzX2RhdGFfdXJpKSB7CgkJCXRyeSB7CgkJCQlyZXR1cm4gYXNfZGF0YV91cmkgPwoJCQkJCWNyZWF0ZV9kYXRhX3VyaShkYXRhLCBtZWRpYV90eXBlKSA6CgkJCQkJKHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTCkuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFsgZGF0YSBdLCB7IHR5cGU6IG1lZGlhX3R5cGUgfSkpOwoJCQl9CgkJCWNhdGNoIChlKSB7fQoJCQlyZXR1cm4gbnVsbDsKCQl9OwoJCU1vZHVsZS5yZXZva2VfdXJsID0gZnVuY3Rpb24gKHVybCkgewoJCQl0cnkgewoJCQkJKHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTCkucmV2b2tlT2JqZWN0VVJMKHVybCk7CgkJCX0KCQkJY2F0Y2ggKGUpIHt9CgkJfTsKCgkJTW9kdWxlLmdldF9yZWdleF9mbGFncyA9IGZ1bmN0aW9uIChyZWdleCkgewoJCQl2YXIgcyA9ICIiOwoJCQlpZiAocmVnZXguZ2xvYmFsKSBzICs9ICJnIjsKCQkJaWYgKHJlZ2V4Lmlnbm9yZUNhc2UpIHMgKz0gImkiOwoJCQlpZiAocmVnZXgubXVsdGlsaW5lKSBzICs9ICJtIjsKCQkJcmV0dXJuIHM7CgkJfTsKCgkJTW9kdWxlLmNsb25lID0gZnVuY3Rpb24gKG9iamVjdCkgewoJCQl2YXIgdGFyZ2V0ID0ge30sCgkJCQlrOwoKCQkJZm9yIChrIGluIG9iamVjdCkgewoJCQkJaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGspKSB7CgkJCQkJdGFyZ2V0W2tdID0gb2JqZWN0W2tdOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdGFyZ2V0OwoJCX07CgoJCU1vZHVsZS54aHJfZXJyb3Jfc3RyaW5nID0gZnVuY3Rpb24gKHhocikgewoJCQl2YXIgcyA9ICJSZXNwb25zZSBlcnJvciAiOwoJCQlzICs9IHhoci5zdGF0dXM7CgkJCWlmICh4aHIuc3RhdHVzVGV4dCkgewoJCQkJcyArPSAiIC0gIjsKCQkJCXMgKz0geGhyLnN0YXR1c1RleHQ7CgkJCX0KCQkJcmV0dXJuIHM7CgkJfTsKCgkJcmV0dXJuIE1vZHVsZTsKCgl9KSgpOwoJdmFyIERlYnVnID0gKGZ1bmN0aW9uICgpIHsKCgkJdmFyIHN0YXJ0ZWQgPSBmYWxzZSwKCQkJdGltZXJfbmFtZXMgPSBudWxsOwoKCQl2YXIgZHVtbXlfZm4gPSBmdW5jdGlvbiAoKSB7fTsKCQl2YXIgbG9nID0gZHVtbXlfZm47CgkJdmFyIHRpbWVyX2xvZyA9IGZ1bmN0aW9uIChsYWJlbCwgdGltZXIpIHsKCQkJdmFyIHQgPSB0aW1pbmcoKSwKCQkJCXZhbHVlOwoKCQkJaWYgKHR5cGVvZih0aW1lcikgPT09ICJzdHJpbmciKSB0aW1lciA9IHRpbWVyX25hbWVzW3RpbWVyXTsKCgkJCXZhbHVlID0gKHRpbWVyID09PSB1bmRlZmluZWQpID8gIj8/P21zIiA6ICh0IC0gdGltZXIpLnRvRml4ZWQoMykgKyAibXMiOwoKCQkJaWYgKCFzdGFydGVkKSByZXR1cm4gWyBsYWJlbCwgdmFsdWUgXTsKCQkJbG9nKGxhYmVsLCB2YWx1ZSk7CgkJfTsKCgkJdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7CgkJCXN0YXJ0ZWQgPSB0cnVlOwoKCQkJaWYgKCFjb25maWcuZGVidWcuZW5hYmxlZCkgewoJCQkJdGltZXJfbG9nID0gZHVtbXlfZm47CgkJCQlNb2R1bGUudGltZXJfbG9nID0gdGltZXJfbG9nOwoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBEZWJ1ZyBmdW5jdGlvbnMKCQkJTW9kdWxlLmVuYWJsZWQgPSB0cnVlOwoKCQkJdGltZXJfbmFtZXMgPSB7fTsKCQkJbG9nID0gZnVuY3Rpb24gKCkgewoJCQkJdmFyIGFyZ3MgPSBbIE1haW4udGl0bGUgKyAiICIgKyBNYWluLnZlcnNpb24uam9pbigiLiIpICsgIjoiIF0sCgkJCQkJaSwgaWk7CgoJCQkJZm9yIChpID0gMCwgaWkgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCWFyZ3MucHVzaChhcmd1bWVudHNbaV0pOwoJCQkJfQoKCQkJCWNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpOwoJCQl9OwoJCQlNb2R1bGUubG9nID0gbG9nOwoJCQlNb2R1bGUudGltZXIgPSBmdW5jdGlvbiAobmFtZSwgZG9udF9mb3JtYXQpIHsKCQkJCXZhciB0MSA9IHRpbWluZygpLAoJCQkJCXQyOwoKCQkJCXQyID0gdGltZXJfbmFtZXNbbmFtZV07CgkJCQl0aW1lcl9uYW1lc1tuYW1lXSA9IHQxOwoKCQkJCWlmIChkb250X2Zvcm1hdCkgewoJCQkJCXJldHVybiAodDIgPT09IHVuZGVmaW5lZCkgPyAtMSA6ICh0MSAtIHQyKTsKCQkJCX0KCQkJCXJldHVybiAodDIgPT09IHVuZGVmaW5lZCkgPyAiPz8/bXMiIDogKHQxIC0gdDIpLnRvRml4ZWQoMykgKyAibXMiOwoJCQl9OwoJCX07CgoJCS8vIEV4cG9ydHMKCQl2YXIgTW9kdWxlID0gewoJCQllbmFibGVkOiBmYWxzZSwKCQkJbG9nOiBsb2csCgkJCXRpbWVyOiBkdW1teV9mbiwKCQkJdGltZXJfbG9nOiB0aW1lcl9sb2csCgkJCWluaXQ6IGluaXQKCQl9OwoKCQlyZXR1cm4gTW9kdWxlOwoKCX0pKCk7Cgl2YXIgUG9zdCA9IChmdW5jdGlvbiAoKSB7CgoKCQkvLyBQcml2YXRlCgkJdmFyIGZpbGVfZXh0ID0gZnVuY3Rpb24gKHVybCkgewoJCQl2YXIgbSA9IC9cLlteXC5dKiQvLmV4ZWModXJsKTsKCQkJcmV0dXJuIChtID09PSBudWxsKSA/ICIiIDogbVswXS50b0xvd2VyQ2FzZSgpOwoJCX07CgkJdmFyIGZpbGVfbmFtZSA9IGZ1bmN0aW9uICh1cmwpIHsKCQkJdXJsID0gdXJsLnNwbGl0KCIvIik7CgkJCXJldHVybiB1cmxbdXJsLmxlbmd0aCAtIDFdOwoJCX07CgoJCXZhciBnZXRfb3BfcG9zdF9maWxlc19jb250YWluZXJfdGlueWJvYXJkID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJd2hpbGUgKHRydWUpIHsKCQkJCWlmICgobm9kZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKSA9PT0gbnVsbCkgcmV0dXJuIG51bGw7CgkJCQlpZiAobm9kZS5jbGFzc0xpc3QgJiYgbm9kZS5jbGFzc0xpc3QuY29udGFpbnMoImZpbGVzIikpIHJldHVybiBub2RlOwoJCQl9CgkJfTsKCgkJdmFyIHBvc3Rfc2VsZWN0b3IgPSB7CgkJCSI0Y2hhbiI6ICIucG9zdENvbnRhaW5lciwucG9zdC5pbmxpbmVkLCNxdW90ZS1wcmV2aWV3IiwKCQkJImZvb2x6IjogImFydGljbGU6bm90KC5iYWNrbGlua19jb250YWluZXIpIiwKCQkJImZ1dWthIjogIi5jb250ZW50PmRpdltpZF0sLmNvbnRlbnQ+dGFibGUiLAoJCQkidGlueWJvYXJkIjogIi5wb3N0IiwKCQkJImlwYiI6ICIuYm9yZGVyd3JhcCIsCgkJCSJpcGJfbG9maSI6ICIucG9zdHdyYXBwZXIiLAoJCQkibWVndWNhIjogIiN0aHJlYWQtY29udGFpbmVyIGFydGljbGUiCgkJfTsKCQl2YXIgcG9zdF9ib2R5X3NlbGVjdG9yID0gewoJCQkiNGNoYW4iOiAiYmxvY2txdW90ZSIsCgkJCSJmb29seiI6ICIudGV4dCIsCgkJCSJmdXVrYSI6ICJibG9ja3F1b3RlPnAiLAoJCQkidGlueWJvYXJkIjogIi5ib2R5IiwKCQkJImlwYiI6ICIucG9zdGNvbG9yIiwKCQkJImlwYl9sb2ZpIjogIi5wb3N0Y29udGVudCIsCgkJCSJtZWd1Y2EiOiAiYmxvY2txdW90ZSIKCQl9OwoJCXZhciBib2R5X2xpbmtzX3NlbGVjdG9yID0gewoJCQkiNGNoYW4iOiAiYTpub3QoLnF1b3RlbGluaykiLAoJCQkiZm9vbHoiOiAiYTpub3QoLmJhY2tsaW5rKSIsCgkJCSJmdXVrYSI6ICJhOm5vdCguYmFja2xpbmspIiwKCQkJInRpbnlib2FyZCI6ICJhOm5vdChbb25jbGlja10pIiwKCQkJImlwYiI6ICJhW3RhcmdldD1fYmxhbmtdIiwKCQkJImlwYl9sb2ZpIjogImFbdGFyZ2V0PV9ibGFua10iLAoJCQkibWVndWNhIjogImE6bm90KC5oaXN0b3J5KTpub3QoLmVtYmVkKSIKCQl9OwoJCXZhciBwb3N0X3BhcmVudF9maW5kID0gewoJCQkiNGNoYW4iOiBmdW5jdGlvbiAobm9kZSkgewoJCQkJd2hpbGUgKChub2RlID0gbm9kZS5wYXJlbnROb2RlKSAhPT0gbnVsbCkgewoJCQkJCWlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygicG9zdENvbnRhaW5lciIpKSByZXR1cm4gbm9kZTsKCQkJCQkvLyA0Y2hhbi1pbmxpbmUKCQkJCQlpZiAobm9kZS5jbGFzc0xpc3QuY29udGFpbnMoInBvc3QiKSAmJiAobm9kZS5jbGFzc0xpc3QuY29udGFpbnMoImlubGluZWQiKSB8fCBub2RlLmlkID09PSAicXVvdGUtcHJldmlldyIpKSByZXR1cm4gbm9kZTsKCQkJCX0KCQkJCXJldHVybiBudWxsOwoJCQl9LAoJCQkiZm9vbHoiOiBmdW5jdGlvbiAobm9kZSkgewoJCQkJd2hpbGUgKChub2RlID0gbm9kZS5wYXJlbnROb2RlKSAhPT0gbnVsbCkgewoJCQkJCWlmIChub2RlLnRhZ05hbWUgPT09ICJBUlRJQ0xFIikgcmV0dXJuIG5vZGU7CgkJCQl9CgkJCQlyZXR1cm4gbnVsbDsKCQkJfSwKCQkJImZ1dWthIjogZnVuY3Rpb24gKG5vZGUpIHsKCQkJCXdoaWxlICgobm9kZSA9IG5vZGUucGFyZW50Tm9kZSkgIT09IG51bGwpIHsKCQkJCQlpZiAoCgkJCQkJCW5vZGUudGFnTmFtZSA9PT0gIlRBQkxFIiB8fCAvLyBSZXBseQoJCQkJCQkobm9kZS50YWdOYW1lID09PSAiRElWIiAmJiBub2RlLmlkICYmIG5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuY29udGFpbnMoImNvbnRlbnQiKSkgLy8gT1AKCQkJCQkpIHsKCQkJCQkJcmV0dXJuIG5vZGU7CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIG51bGw7CgkJCX0sCgkJCSJ0aW55Ym9hcmQiOiBmdW5jdGlvbiAobm9kZSkgewoJCQkJd2hpbGUgKChub2RlID0gbm9kZS5wYXJlbnROb2RlKSAhPT0gbnVsbCkgewoJCQkJCWlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygicG9zdCIpKSB7CgkJCQkJCXJldHVybiBub2RlOwoJCQkJCX0KCQkJCQllbHNlIGlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygidGhyZWFkIikpIHsKCQkJCQkJcmV0dXJuICQoIi5wb3N0Lm9wIiwgbm9kZSk7CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIG51bGw7CgkJCX0sCgkJCSJpcGIiOiBmdW5jdGlvbiAobm9kZSkgewoJCQkJd2hpbGUgKChub2RlID0gbm9kZS5wYXJlbnROb2RlKSAhPT0gbnVsbCkgewoJCQkJCWlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygiYm9yZGVyd3JhcCIpKSByZXR1cm4gbm9kZTsKCQkJCX0KCQkJCXJldHVybiBudWxsOwoJCQl9LAoJCQkiaXBiX2xvZmkiOiBmdW5jdGlvbiAobm9kZSkgewoJCQkJd2hpbGUgKChub2RlID0gbm9kZS5wYXJlbnROb2RlKSAhPT0gbnVsbCkgewoJCQkJCWlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygicG9zdHdyYXBwZXIiKSkgcmV0dXJuIG5vZGU7CgkJCQl9CgkJCQlyZXR1cm4gbnVsbDsKCQkJfSwKCQkJIm1lZ3VjYSI6IGZ1bmN0aW9uIChub2RlKSB7CgkJCQlyZXR1cm4gbm9kZS5jbG9zZXN0KCJhcnRpY2xlIik7CgkJCX0KCQl9OwoJCXZhciBnZXRfZmlsZV9pbmZvID0gewoJCQkiNGNoYW4iOiBmdW5jdGlvbiAocG9zdCkgewoJCQkJdmFyIG4sIGZ0LCBpbWcsIGExLCB1cmwsIGk7CgoJCQkJaWYgKAoJCQkJCShuID0gJCgiLmZpbGUiLCBwb3N0KSkgPT09IG51bGwgfHwKCQkJCQkhYmVsb25nc190b1tDb25maWcubW9kZV0uY2FsbChudWxsLCBuLCBwb3N0KSB8fAoJCQkJCShmdCA9ICQoIi5maWxlVGV4dCIsIG4pKSA9PT0gbnVsbCB8fAoJCQkJCShpbWcgPSAkKCJpbWciLCBuKSkgPT09IG51bGwgfHwKCQkJCQkoYTEgPSAkKCJhIiwgbikpID09PSBudWxsCgkJCQkpIHsKCQkJCQlyZXR1cm4gW107CgkJCQl9CgoJCQkJdXJsID0gYTEuaHJlZjsKCQkJCWlmICgoaSA9IHVybC5pbmRleE9mKCIjIikpID49IDApIHVybCA9IHVybC5zdWJzdHIoMCwgaSk7CgoJCQkJcmV0dXJuIFt7CgkJCQkJaW1hZ2U6IGltZywKCQkJCQlpbWFnZV9saW5rOiBpbWcucGFyZW50Tm9kZSwKCQkJCQl0ZXh0X2xpbms6IGExLAoJCQkJCW9wdGlvbnM6IGZ0LAoJCQkJCXVybDogdXJsLAoJCQkJCXR5cGU6IGZpbGVfZXh0KHVybCksCgkJCQkJbmFtZTogZmlsZV9uYW1lKHVybCksCgkJCQkJbWQ1OiBpbWcuZ2V0QXR0cmlidXRlKCJkYXRhLW1kNSIpIHx8IG51bGwKCQkJCX1dOwoJCQl9LAoJCQkiZm9vbHoiOiBmdW5jdGlvbiAocG9zdCkgewoJCQkJdmFyIG4sIGZ0LCBpbWcsIGExLCB1cmwsIGk7CgoJCQkJaWYgKAoJCQkJCShuID0gJCgiLnRocmVhZF9pbWFnZV9ib3giLCBwb3N0KSkgPT09IG51bGwgfHwKCQkJCQkhYmVsb25nc190b1tDb25maWcubW9kZV0uY2FsbChudWxsLCBuLCBwb3N0KSB8fAoJCQkJCShmdCA9ICQoIi5wb3N0X2ZpbGVfY29udHJvbHMiLCBwb3N0KSkgPT09IG51bGwgfHwKCQkJCQkoaW1nID0gJCgiaW1nIiwgbikpID09PSBudWxsIHx8CgkJCQkJKGExID0gJCgiLnBvc3RfZmlsZV9maWxlbmFtZSIsIHBvc3QpKSA9PT0gbnVsbAoJCQkJKSB7CgkJCQkJcmV0dXJuIFtdOwoJCQkJfQoKCQkJCXVybCA9IGExLmhyZWY7CgkJCQlpZiAoKGkgPSB1cmwuaW5kZXhPZigiIyIpKSA+PSAwKSB1cmwgPSB1cmwuc3Vic3RyKDAsIGkpOwoKCQkJCXJldHVybiBbewoJCQkJCWltYWdlOiBpbWcsCgkJCQkJaW1hZ2VfbGluazogaW1nLnBhcmVudE5vZGUsCgkJCQkJdGV4dF9saW5rOiBhMSwKCQkJCQlvcHRpb25zOiBmdCwKCQkJCQl1cmw6IHVybCwKCQkJCQl0eXBlOiBmaWxlX2V4dCh1cmwpLAoJCQkJCW5hbWU6IGZpbGVfbmFtZSh1cmwpLAoJCQkJCW1kNTogaW1nLmdldEF0dHJpYnV0ZSgiZGF0YS1tZDUiKSB8fCBudWxsCgkJCQl9XTsKCQkJfSwKCQkJImZ1dWthIjogZnVuY3Rpb24gKHBvc3QpIHsKCQkJCXZhciBuLCBpbWcsIGExLCB1cmwsIGk7CgoJCQkJaWYgKAoJCQkJCShpbWcgPSAkKCJhPmltZy50aHVtYiIsIHBvc3QpKSA9PT0gbnVsbCB8fAoJCQkJCSFiZWxvbmdzX3RvW0NvbmZpZy5tb2RlXS5jYWxsKG51bGwsIGltZywgcG9zdCkKCQkJCSkgewoJCQkJCXJldHVybiBbXTsKCQkJCX0KCgkJCQlhMSA9IGltZy5wYXJlbnROb2RlOwoJCQkJbiA9IGExLnBhcmVudE5vZGU7CgkJCQl1cmwgPSBhMS5ocmVmOwoJCQkJaWYgKChpID0gdXJsLmluZGV4T2YoIiMiKSkgPj0gMCkgdXJsID0gdXJsLnN1YnN0cigwLCBpKTsKCgkJCQlyZXR1cm4gW3sKCQkJCQlpbWFnZTogaW1nLAoJCQkJCWltYWdlX2xpbms6IGExLAoJCQkJCXRleHRfbGluazogbnVsbCwKCQkJCQlvcHRpb25zOiBuLAoJCQkJCXVybDogdXJsLAoJCQkJCXR5cGU6IGZpbGVfZXh0KHVybCksCgkJCQkJbmFtZTogZmlsZV9uYW1lKHVybCksCgkJCQkJbWQ1OiBpbWcuZ2V0QXR0cmlidXRlKCJkYXRhLW1kNSIpIHx8IG51bGwKCQkJCX1dOwoJCQl9LAoJCQkidGlueWJvYXJkIjogZnVuY3Rpb24gKHBvc3QpIHsKCQkJCXZhciByZXN1bHRzID0gW10sCgkJCQkJaW1ncywgaW5mb3MsIGltZywgYXJyYXksIGZ0LCBhMSwgbiwgdXJsLCBpLCBpaSwgajsKCgkJCQlpZiAocG9zdC5jbGFzc0xpc3QuY29udGFpbnMoIm9wIikpIHsKCQkJCQluID0gZ2V0X29wX3Bvc3RfZmlsZXNfY29udGFpbmVyX3Rpbnlib2FyZChwb3N0KTsKCQkJCQlpZiAobiA9PT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CgoJCQkJCWltZ3MgPSAkJCgiYT5pbWciLCBuKTsKCQkJCQlpbmZvcyA9ICQkKCIuZmlsZWluZm8iLCBuKTsKCQkJCQlpaSA9IE1hdGgubWluKGltZ3MubGVuZ3RoLCBpbmZvcy5sZW5ndGgpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJaW1ncyA9ICQkKCJhPmltZyIsIHBvc3QpOwoJCQkJCWFycmF5ID0gW107CgkJCQkJZm9yIChpID0gMCwgaWkgPSBpbWdzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJaW1nID0gaW1nc1tpXTsKCQkJCQkJaWYgKGJlbG9uZ3NfdG9bQ29uZmlnLm1vZGVdLmNhbGwobnVsbCwgaW1nLCBwb3N0KSkgewoJCQkJCQkJYXJyYXkucHVzaChpbWcpOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWltZ3MgPSBhcnJheTsKCgkJCQkJaW5mb3MgPSAkJCgiLmZpbGVpbmZvIiwgcG9zdCk7CgkJCQkJaWkgPSBNYXRoLm1pbihpbWdzLmxlbmd0aCwgaW5mb3MubGVuZ3RoKTsKCQkJCX0KCgkJCQlmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkgewoJCQkJCWltZyA9IGltZ3NbaV07CgkJCQkJbiA9IGluZm9zW2ldOwoKCQkJCQlpZiAoCgkJCQkJCShmdCA9ICQoIi51bmltcG9ydGFudCIsIG4pKSA9PT0gbnVsbCB8fAoJCQkJCQkoYTEgPSAkKCJhIiwgbikpID09PSBudWxsCgkJCQkJKSB7CgkJCQkJCWNvbnRpbnVlOwoJCQkJCX0KCgkJCQkJdXJsID0gaW1nLnBhcmVudE5vZGUuaHJlZiB8fCBhMS5ocmVmOwoJCQkJCWlmICgoaiA9IHVybC5pbmRleE9mKCIjIikpID49IDApIHVybCA9IHVybC5zdWJzdHIoMCwgaik7CgoJCQkJCXJlc3VsdHMucHVzaCh7CgkJCQkJCWltYWdlOiBpbWcsCgkJCQkJCWltYWdlX2xpbms6IGltZy5wYXJlbnROb2RlLAoJCQkJCQl0ZXh0X2xpbms6IGExLAoJCQkJCQlvcHRpb25zOiBmdCwKCQkJCQkJdXJsOiB1cmwsCgkJCQkJCXR5cGU6IGZpbGVfZXh0KHVybCksCgkJCQkJCW5hbWU6IGZpbGVfbmFtZSh1cmwpLAoJCQkJCQltZDU6IGltZy5nZXRBdHRyaWJ1dGUoImRhdGEtbWQ1IikgfHwgbnVsbAoJCQkJCX0pOwoJCQkJfQoKCQkJCXJldHVybiByZXN1bHRzOwoJCQl9LAoJCQkiaXBiIjogZnVuY3Rpb24gKCkgewoJCQkJcmV0dXJuIFtdOwoJCQl9LAoJCQkiaXBiX2xvZmkiOiBmdW5jdGlvbiAoKSB7CgkJCQlyZXR1cm4gW107CgkJCX0sCgkJCSJtZWd1Y2EiOiBmdW5jdGlvbiAoKSB7CgkJCQlyZXR1cm4gW107CgkJCX0KCQl9OwoJCXZhciBiZWxvbmdzX3RvX2RlZmF1bHQgPSBmdW5jdGlvbiAobm9kZSwgcG9zdCkgewoJCQlyZXR1cm4gKE1vZHVsZS5nZXRfcG9zdF9jb250YWluZXIobm9kZSkgPT09IHBvc3QpOwoJCX07CgkJdmFyIGJlbG9uZ3NfdG9fcmVfbm9uX2RpZ2l0ID0gL1xEKy9nOwoJCXZhciBiZWxvbmdzX3RvID0gewoJCQkiNGNoYW4iOiBmdW5jdGlvbiAobm9kZSwgcG9zdCkgewoJCQkJdmFyIGlkMSA9IG5vZGUuaWQucmVwbGFjZShiZWxvbmdzX3RvX3JlX25vbl9kaWdpdCwgIiIpLAoJCQkJCWlkMiA9IHBvc3QuaWQucmVwbGFjZShiZWxvbmdzX3RvX3JlX25vbl9kaWdpdCwgIiIpOwoKCQkJCXJldHVybiAoaWQxICYmIGlkMSA9PT0gaWQyKTsKCQkJfSwKCQkJImZvb2x6IjogYmVsb25nc190b19kZWZhdWx0LAoJCQkiZnV1a2EiOiBiZWxvbmdzX3RvX2RlZmF1bHQsCgkJCSJ0aW55Ym9hcmQiOiBiZWxvbmdzX3RvX2RlZmF1bHQsCgkJCSJpcGIiOiBiZWxvbmdzX3RvX2RlZmF1bHQsCgkJCSJpcGJfbG9maSI6IGJlbG9uZ3NfdG9fZGVmYXVsdCwKCQkJIm1lZ3VjYSI6IGJlbG9uZ3NfdG9fZGVmYXVsdAoJCX07CgkJdmFyIGNyZWF0ZV9pbWFnZV9tZXRhX2xpbmtfZGVmYXVsdCA9IGZ1bmN0aW9uIChmaWxlX2luZm8sIG5vZGUpIHsKCQkJdmFyIHBhciA9IGZpbGVfaW5mby5vcHRpb25zOwoJCQkkLmFkZChwYXIsICQudG5vZGUoIiAiKSk7CgkJCSQuYWRkKHBhciwgbm9kZSk7CgkJfTsKCQl2YXIgY3JlYXRlX2ltYWdlX21ldGFfbGluayA9IHsKCQkJIjRjaGFuIjogY3JlYXRlX2ltYWdlX21ldGFfbGlua19kZWZhdWx0LAoJCQkiZm9vbHoiOiBmdW5jdGlvbiAoZmlsZV9pbmZvLCBub2RlKSB7CgkJCQl2YXIgcGFyID0gZmlsZV9pbmZvLm9wdGlvbnMsCgkJCQkJbmV4dDsKCgkJCQlmb3IgKG5leHQgPSBwYXIubGFzdENoaWxkOyBuZXh0ICE9PSBudWxsOyBuZXh0ID0gbmV4dC5wcmV2aW91c1NpYmxpbmcpIHsKCQkJCQlpZiAobmV4dC50YWdOYW1lID09PSAiQSIgJiYgbmV4dC5oYXNBdHRyaWJ1dGUoImRvd25sb2FkIikpIGJyZWFrOwoJCQkJfQoKCQkJCW5vZGUuY2xhc3NMaXN0LmFkZCgiYnRuciIpOwoJCQkJbm9kZS5jbGFzc0xpc3QuYWRkKCJwYXJlbnQiKTsKCQkJCSQuYmVmb3JlKHBhciwgbmV4dCwgbm9kZSk7CgkJCX0sCgkJCSJmdXVrYSI6IGZ1bmN0aW9uIChmaWxlX2luZm8sIG5vZGUpIHsKCQkJCXZhciBwYXIgPSBmaWxlX2luZm8ub3B0aW9ucywKCQkJCQl0ID0gIiBbIiwKCQkJCQlpID0gMCwKCQkJCQlqID0gKHBhci50YWdOYW1lID09PSAiRElWIiA/IDEgOiAyKSwKCQkJCQluZXh0LCBuOwoKCQkJCWZvciAobmV4dCA9IHBhci5maXJzdENoaWxkOyBuZXh0ICE9PSBudWxsOyBuZXh0ID0gbmV4dC5uZXh0U2libGluZykgewoJCQkJCWlmIChuZXh0LnRhZ05hbWUgPT09ICJCUiIgJiYgKytpID09PSBqKSBicmVhazsKCQkJCX0KCgkJCQlpZiAoCgkJCQkJbmV4dCAhPT0gbnVsbCAmJgoJCQkJCShuID0gbmV4dC5wcmV2aW91c1NpYmxpbmcpICE9PSBudWxsICYmCgkJCQkJbi5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUKCQkJCSkgewoJCQkJCW4ubm9kZVZhbHVlID0gbi5ub2RlVmFsdWUucmVwbGFjZSgvXF1ccyokLywgIl0iKSArIHQ7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkkLmJlZm9yZShwYXIsIG5leHQsICQudG5vZGUodCkpOwoJCQkJfQoKCQkJCSQuYmVmb3JlKHBhciwgbmV4dCwgbm9kZSk7CgkJCQkkLmJlZm9yZShwYXIsIG5leHQsICQudG5vZGUoIl0iKSk7CgkJCX0sCgkJCSJ0aW55Ym9hcmQiOiBjcmVhdGVfaW1hZ2VfbWV0YV9saW5rX2RlZmF1bHQsCgkJCSJpcGIiOiBjcmVhdGVfaW1hZ2VfbWV0YV9saW5rX2RlZmF1bHQsCgkJCSJpcGJfbG9maSI6IGNyZWF0ZV9pbWFnZV9tZXRhX2xpbmtfZGVmYXVsdCwKCQkJIm1lZ3VjYSI6IGNyZWF0ZV9pbWFnZV9tZXRhX2xpbmtfZGVmYXVsdAoJCX07CgoJCS8vIEV4cG9ydHMKCQl2YXIgTW9kdWxlID0gewoJCQlnZXRfcG9zdF9jb250YWluZXI6IGZ1bmN0aW9uIChub2RlKSB7CgkJCQlyZXR1cm4gcG9zdF9wYXJlbnRfZmluZFtDb25maWcubW9kZV0uY2FsbChudWxsLCBub2RlKTsKCQkJfSwKCQkJZ2V0X3RleHRfYm9keTogZnVuY3Rpb24gKG5vZGUpIHsKCQkJCXJldHVybiAkKHBvc3RfYm9keV9zZWxlY3RvcltDb25maWcubW9kZV0sIG5vZGUpOwoJCQl9LAoJCQlpc19wb3N0OiBmdW5jdGlvbiAobm9kZSkgewoJCQkJcmV0dXJuICQudGVzdChub2RlLCBwb3N0X3NlbGVjdG9yW0NvbmZpZy5tb2RlXSk7CgkJCX0sCgkJCWdldF9hbGxfcG9zdHM6IGZ1bmN0aW9uIChwYXJlbnQpIHsKCQkJCXJldHVybiAkJChwb3N0X3NlbGVjdG9yW0NvbmZpZy5tb2RlXSwgcGFyZW50KTsKCQkJfSwKCQkJZ2V0X2ZpbGVfaW5mbzogZnVuY3Rpb24gKHBvc3QpIHsKCQkJCXJldHVybiBnZXRfZmlsZV9pbmZvW0NvbmZpZy5tb2RlXS5jYWxsKG51bGwsIHBvc3QpOwoJCQl9LAoJCQlnZXRfYm9keV9saW5rczogZnVuY3Rpb24gKHBvc3QpIHsKCQkJCXJldHVybiAkJChib2R5X2xpbmtzX3NlbGVjdG9yW0NvbmZpZy5tb2RlXSwgcG9zdCk7CgkJCX0sCgkJCWNyZWF0ZV9pbWFnZV9tZXRhX2xpbms6IGZ1bmN0aW9uIChmaWxlX2luZm8sIG5vZGUpIHsKCQkJCXJldHVybiBjcmVhdGVfaW1hZ2VfbWV0YV9saW5rW0NvbmZpZy5tb2RlXS5jYWxsKG51bGwsIGZpbGVfaW5mbywgbm9kZSk7CgkJCX0sCgkJCWdldF9vcF9wb3N0X2ZpbGVzX2NvbnRhaW5lcl90aW55Ym9hcmQ6IGdldF9vcF9wb3N0X2ZpbGVzX2NvbnRhaW5lcl90aW55Ym9hcmQKCQl9OwoKCQlyZXR1cm4gTW9kdWxlOwoKCX0pKCk7Cgl2YXIgQ3JlYXRlVVJMID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gUHJpdmF0ZQoJCXZhciB0b19nYWxsZXJ5ID0gewoJCQllaGVudGFpOiBmdW5jdGlvbiAoZGF0YSwgZG9tYWluKSB7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWluICsgIi9nLyIgKyBkYXRhLmdpZCArICIvIiArIGRhdGEudG9rZW4gKyAiLyI7CgkJCX0sCgkJCW5oZW50YWk6IGZ1bmN0aW9uIChkYXRhKSB7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWlucy5uaGVudGFpICsgIi9nLyIgKyBkYXRhLmdpZCArICIvIjsKCQkJfSwKCQkJaGl0b21pOiBmdW5jdGlvbiAoZGF0YSkgewoJCQkJcmV0dXJuICJodHRwczovLyIgKyBkb21haW5zLmhpdG9taSArICIvZ2FsbGVyaWVzLyIgKyBkYXRhLmdpZCArICIuaHRtbCI7CgkJCX0KCQl9OwoJCXZhciB0b191cGxvYWRlciA9IHsKCQkJZWhlbnRhaTogZnVuY3Rpb24gKGRhdGEsIGRvbWFpbikgewoJCQkJcmV0dXJuICJodHRwOi8vIiArIGRvbWFpbiArICIvdXBsb2FkZXIvIiArIChkYXRhLnVwbG9hZGVyIHx8ICJVbmtub3duIikucmVwbGFjZSgvXHMrL2csICIrIik7CgkJCX0sCgkJCW5oZW50YWk6IGZ1bmN0aW9uICgpIHsKCQkJCXJldHVybiAiaHR0cDovLyIgKyBkb21haW5zLm5oZW50YWkgKyAiLyI7CgkJCX0sCgkJCWhpdG9taTogZnVuY3Rpb24gKCkgewoJCQkJcmV0dXJuICJodHRwczovLyIgKyBkb21haW5zLmhpdG9taSArICIvIjsKCQkJfQoJCX07CgkJdmFyIHRvX2NhdGVnb3J5ID0gewoJCQllaGVudGFpOiBmdW5jdGlvbiAoZGF0YSwgZG9tYWluKSB7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWluICsgIi8iICsgQVBJLmdldF9jYXRlZ29yeShkYXRhLmNhdGVnb3J5KS5zaG9ydF9uYW1lOwoJCQl9LAoJCQluaGVudGFpOiBmdW5jdGlvbiAoZGF0YSkgewoJCQkJcmV0dXJuICJodHRwOi8vIiArIGRvbWFpbnMubmhlbnRhaSArICIvY2F0ZWdvcnkvIiArIGRhdGEuY2F0ZWdvcnkudG9Mb3dlckNhc2UoKSArICIvIjsKCQkJfSwKCQkJaGl0b21pOiBmdW5jdGlvbiAoZGF0YSkgewoJCQkJcmV0dXJuICJodHRwczovLyIgKyBkb21haW5zLmhpdG9taSArICIvdHlwZS8iICsgZGF0YS5jYXRlZ29yeS50b0xvd2VyQ2FzZSgpICsgIi1hbGwtMS5odG1sIjsKCQkJfQoJCX07CgkJdmFyIHRvX3RhZyA9IHsKCQkJZWhlbnRhaTogZnVuY3Rpb24gKHRhZywgZG9tYWluKSB7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWluICsgIi90YWcvIiArIHRhZy5yZXBsYWNlKC9ccysvZywgIisiKTsKCQkJfSwKCQkJbmhlbnRhaTogZnVuY3Rpb24gKHRhZywgZG9tYWluKSB7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWluICsgIi90YWcvIiArIHRhZy5yZXBsYWNlKC9ccysvZywgIi0iKSArICIvIjsKCQkJfSwKCQkJaGl0b21pOiBmdW5jdGlvbiAodGFnLCBkb21haW4pIHsKCQkJCXJldHVybiAiaHR0cHM6Ly8iICsgZG9tYWluICsgIi90YWcvIiArIHRhZyArICItYWxsLTEuaHRtbCI7CgkJCX0KCQl9OwoJCXZhciB0b190YWdfbnMgPSB7CgkJCWVoZW50YWk6IGZ1bmN0aW9uICh0YWcsIG5hbWVzcGFjZSwgZG9tYWluKSB7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWluICsgIi90YWcvIiArIG5hbWVzcGFjZSArICI6IiArIHRhZy5yZXBsYWNlKC9ccysvZywgIisiKTsKCQkJfSwKCQkJbmhlbnRhaTogZnVuY3Rpb24gKHRhZywgbmFtZXNwYWNlLCBkb21haW4pIHsKCQkJCWlmIChuYW1lc3BhY2UgPT09ICJ0YWdzIikgbmFtZXNwYWNlID0gInRhZyI7CgkJCQlyZXR1cm4gImh0dHA6Ly8iICsgZG9tYWluICsgIi8iICsgbmFtZXNwYWNlICsgIi8iICsgdGFnLnJlcGxhY2UoL1xzKy9nLCAiLSIpICsgIi8iOwoJCQl9LAoJCQloaXRvbWk6IGZ1bmN0aW9uICh0YWcsIG5hbWVzcGFjZSwgZG9tYWluKSB7CgkJCQlpZiAobmFtZXNwYWNlID09PSAibWFsZSIgfHwgbmFtZXNwYWNlID09PSAiZmVtYWxlIikgewoJCQkJCXJldHVybiAiaHR0cHM6Ly8iICsgZG9tYWluICsgIi90YWcvIiArIG5hbWVzcGFjZSArICI6IiArIHRhZyArICItYWxsLTEuaHRtbCI7CgkJCQl9CgkJCQllbHNlIGlmIChuYW1lc3BhY2UgPT09ICJhcnRpc3QiKSB7CgkJCQkJcmV0dXJuICJodHRwczovLyIgKyBkb21haW4gKyAiL2FydGlzdC8iICsgdGFnICsgIi1hbGwtMS5odG1sIjsKCQkJCX0KCQkJCWVsc2UgaWYgKG5hbWVzcGFjZSA9PT0gInBhcm9keSIpIHsKCQkJCQlyZXR1cm4gImh0dHBzOi8vIiArIGRvbWFpbiArICIvc2VyaWVzLyIgKyB0YWcgKyAiLWFsbC0xLmh0bWwiOwoJCQkJfQoJCQkJZWxzZSBpZiAobmFtZXNwYWNlID09PSAibGFuZ3VhZ2UiKSB7CgkJCQkJcmV0dXJuICJodHRwczovLyIgKyBkb21haW4gKyAiL2luZGV4LSIgKyB0YWcgKyAiLTEuaHRtbCI7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlyZXR1cm4gImh0dHBzOi8vIiArIGRvbWFpbiArICIvdGFnLyIgKyB0YWcgKyAiLWFsbC0xLmh0bWwiOwoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgdHlwZXMgPSB7CgkJCXRvX2dhbGxlcnk6IFsgdG9fZ2FsbGVyeSwgWyAiZGF0YSIsICJkb21haW4iIF0gXSwKCQkJdG9fdXBsb2FkZXI6IFsgdG9fdXBsb2FkZXIsIFsgImRhdGEiLCAiZG9tYWluIiBdIF0sCgkJCXRvX2NhdGVnb3J5OiBbIHRvX2NhdGVnb3J5LCBbICJkYXRhIiwgImRvbWFpbiIgXSBdLAoJCQl0b190YWc6IFsgdG9fdGFnLCBbICJ0YWciLCAiZG9tYWluIiBdIF0sCgkJCXRvX3RhZ19uczogWyB0b190YWdfbnMsIFsgInRhZyIsICJuYW1lc3BhY2UiLCAiZG9tYWluIiBdIF0KCQl9OwoKCQl2YXIgZXEgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSA9PT0gYjsgfSwKCQkJbmVxID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgIT09IGI7IH0sCgkJCW9wZXJhdG9ycyA9IHsKCQkJCSI9PSI6IGVxLAoJCQkJIj09PSI6IGVxLAoJCQkJIiE9IjogbmVxLAoJCQkJIiE9PSI6IG5lcSwKCQkJCSI+IjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgPiBiOyB9LAoJCQkJIj49IjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgPj0gYjsgfSwKCQkJCSI8IjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgPCBiOyB9LAoJCQkJIjw9IjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEgPD0gYjsgfQoJCQl9OwoKCQl2YXIgZ2V0X3ZhciA9IGZ1bmN0aW9uICh2YXJzLCBuYW1lKSB7CgkJCXZhciBpLCBpaSwgazsKCQkJbmFtZSA9IG5hbWUuc3BsaXQoIi4iKTsKCQkJZm9yIChpID0gMCwgaWkgPSBuYW1lLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWsgPSBuYW1lW2ldOwoJCQkJaWYgKHR5cGVvZih2YXJzKSA9PT0gIm9iamVjdCIgJiYgdmFycyAhPT0gbnVsbCAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodmFycywgaykpIHsKCQkJCQl2YXJzID0gdmFyc1trXTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXJldHVybiB1bmRlZmluZWQ7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIHZhcnM7CgkJfTsKCgkJdmFyIHJlX2Zvcm1hdCA9IC9ceyhbXlx9XSspXH0vZzsKCQl2YXIgZm9ybWF0ID0gZnVuY3Rpb24gKHN0ciwgdmFycykgewoJCQlyZXR1cm4gc3RyLnJlcGxhY2UocmVfZm9ybWF0LCBmdW5jdGlvbiAoaywgZzEpIHsKCQkJCXZvaWQoayk7IC8vIHRvIG1ha2UganNoaW50IGlnbm9yZSB0aGUgdW51c2VkIHZhcgoJCQkJcmV0dXJuIGdldF92YXIodmFycywgZzEpOwoJCQl9KTsKCQl9OwoKCQl2YXIgY2hlY2tfYXJncyA9IGZ1bmN0aW9uIChhcnJheSwgdmFycykgewoJCQl2YXIgaSwgaWksIG9wOwoJCQlmb3IgKGkgPSAxLCBpaSA9IGFycmF5Lmxlbmd0aDsgaSA8IGlpOyBpICs9IDMpIHsKCQkJCW9wID0gYXJyYXlbaSArIDFdOwoJCQkJaWYgKAoJCQkJCSFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3BlcmF0b3JzLCBvcCkgfHwKCQkJCQkhb3BlcmF0b3JzW29wXShnZXRfdmFyKHZhcnMsIGFycmF5W2ldKSwgYXJyYXlbaSArIDJdKQoJCQkJKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX07CgoJCXZhciBjcmVhdGVfZ2VuZXJpYyA9IGZ1bmN0aW9uIChkYXRhLCBhcmdfbmFtZXMpIHsKCQkJaWYgKHR5cGVvZihkYXRhKSA9PT0gInN0cmluZyIpIHsKCQkJCXJldHVybiBmdW5jdGlvbiAoKSB7CgkJCQkJdmFyIHZhcnMgPSB7fSwKCQkJCQkJaSwgaWk7CgkJCQkJZm9yIChpID0gMCwgaWkgPSBhcmdfbmFtZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQl2YXJzW2FyZ19uYW1lc1tpXV0gPSBhcmd1bWVudHNbaV07CgkJCQkJfQoJCQkJCXJldHVybiBmb3JtYXQoZGF0YSwgdmFycyk7CgkJCQl9OwoJCQl9CgkJCWlmIChBcnJheS5pc0FycmF5KGRhdGEpICYmIGRhdGEubGVuZ3RoID4gMCkgewoJCQkJLy8gTm9ybWFsaXplCgkJCQl2YXIgaSwgaWksIGQ7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IGRhdGEubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCWQgPSBkYXRhW2ldOwoJCQkJCWlmICh0eXBlb2YoZCkgIT09ICJzdHJpbmciICYmICEoQXJyYXkuaXNBcnJheShkKSAmJiBkLmxlbmd0aCA+IDAgJiYgdHlwZW9mKGRbMF0pID09PSAic3RyaW5nIikpIHsKCQkJCQkJZGF0YVtpXSA9ICIjIjsKCQkJCQl9CgkJCQl9CgoJCQkJcmV0dXJuIGZ1bmN0aW9uICgpIHsKCQkJCQl2YXIgdmFycyA9IHt9LAoJCQkJCQlpLCBpaSwgZDsKCQkJCQlmb3IgKGkgPSAwLCBpaSA9IGFyZ19uYW1lcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJCXZhcnNbYXJnX25hbWVzW2ldXSA9IGFyZ3VtZW50c1tpXTsKCQkJCQl9CgkJCQkJZm9yIChpID0gMCwgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJZCA9IGRhdGFbaV07CgkJCQkJCWlmICh0eXBlb2YoZCkgPT09ICJzdHJpbmciKSB7CgkJCQkJCQlyZXR1cm4gZm9ybWF0KGQsIHZhcnMpOwoJCQkJCQl9CgkJCQkJCWlmIChBcnJheS5pc0FycmF5KGQpICYmIGNoZWNrX2FyZ3MoZCwgdmFycykpIHsKCQkJCQkJCXJldHVybiBmb3JtYXQoZFswXSwgdmFycyk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcmV0dXJuICIjIjsKCQkJCX07CgkJCX0KCgkJCXJldHVybiBmdW5jdGlvbiAoKSB7CgkJCQlyZXR1cm4gIiMiOwoJCQl9OwoJCX07CgoJCXZhciByZWdpc3RlciA9IGZ1bmN0aW9uIChuYW1lc3BhY2UsIGRhdGEpIHsKCQkJaWYgKHR5cGVvZihkYXRhKSA9PT0gIm9iamVjdCIgJiYgZGF0YSAhPT0gbnVsbCkgewoJCQkJdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0eXBlcyksCgkJCQkJaSwgaWksIGssIGluZm87CgoJCQkJZm9yIChpID0gMCwgaWkgPSBrZXlzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQlrID0ga2V5c1tpXTsKCQkJCQlpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGEsIGspKSB7CgkJCQkJCWluZm8gPSB0eXBlc1trXTsKCQkJCQkJaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoaW5mb1swXSwgaykpIHsKCQkJCQkJCWluZm9bMF1bbmFtZXNwYWNlXSA9IGNyZWF0ZV9nZW5lcmljKGRhdGFba10sIGluZm9bMV0pOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCXRvX2dhbGxlcnk6IGZ1bmN0aW9uIChkYXRhLCBkb21haW4pIHsKCQkJCXZhciBmbiA9IHRvX2dhbGxlcnlbZGF0YS50eXBlXTsKCQkJCXJldHVybiAodHlwZW9mKGZuKSAhPT0gImZ1bmN0aW9uIikgPyAiIyIgOiBmbihkYXRhLCBkb21haW4pOwoJCQl9LAoJCQl0b191cGxvYWRlcjogZnVuY3Rpb24gKGRhdGEsIGRvbWFpbikgewoJCQkJdmFyIGZuID0gdG9fdXBsb2FkZXJbZGF0YS50eXBlXTsKCQkJCXJldHVybiAodHlwZW9mKGZuKSAhPT0gImZ1bmN0aW9uIikgPyAiIyIgOiBmbihkYXRhLCBkb21haW4pOwoJCQl9LAoJCQl0b19jYXRlZ29yeTogZnVuY3Rpb24gKGRhdGEsIGRvbWFpbikgewoJCQkJdmFyIGZuID0gdG9fY2F0ZWdvcnlbZGF0YS50eXBlXTsKCQkJCXJldHVybiAodHlwZW9mKGZuKSAhPT0gImZ1bmN0aW9uIikgPyAiIyIgOiBmbihkYXRhLCBkb21haW4pOwoJCQl9LAoJCQl0b190YWc6IGZ1bmN0aW9uICh0YWcsIGRvbWFpbl90eXBlLCBkb21haW4pIHsKCQkJCXZhciBmbiA9IHRvX3RhZ1tkb21haW5fdHlwZV07CgkJCQlyZXR1cm4gKHR5cGVvZihmbikgIT09ICJmdW5jdGlvbiIpID8gIiMiIDogZm4odGFnLCBkb21haW4pOwoJCQl9LAoJCQl0b190YWdfbnM6IGZ1bmN0aW9uICh0YWcsIG5hbWVzcGFjZSwgZG9tYWluX3R5cGUsIGRvbWFpbikgewoJCQkJdmFyIGZuID0gdG9fdGFnX25zW2RvbWFpbl90eXBlXTsKCQkJCXJldHVybiAodHlwZW9mKGZuKSAhPT0gImZ1bmN0aW9uIikgPyAiIyIgOiBmbih0YWcsIG5hbWVzcGFjZSwgZG9tYWluKTsKCQkJfSwKCQkJcmVnaXN0ZXI6IHJlZ2lzdGVyCgkJfTsKCgl9KSgpOwoJdmFyIEh0dHBSZXF1ZXN0ID0gKGZ1bmN0aW9uICgpIHsKCgkJdmFyIGRlYnVnX2ZuID0gZnVuY3Rpb24gKHR5cGUsIGRhdGEsIGNhbGxiYWNrLCBzdGFydF90aW1lKSB7CgkJCXJldHVybiBmdW5jdGlvbiAoeGhyKSB7CgkJCQl2YXIgdCA9IHRpbWluZygpLAoJCQkJCWFyZ3MgPSBbCgkJCQkJCSJIdHRwUmVxdWVzdDoiLAoJCQkJCQlkYXRhLm1ldGhvZCwKCQkJCQkJZGF0YS51cmwsCgkJCQkJCXR5cGUsCgkJCQkJCXsgZGF0YTogZGF0YSwgcmVzcG9uc2U6IHhociwgdGltZTogKHQgLSBzdGFydF90aW1lKS50b0ZpeGVkKDIpICsgIm1zIiB9CgkJCQkJXTsKCgkJCQlpZiAodHlwZSA9PT0gImxvYWQiKSBhcmdzLnNwbGljZSg0LCAwLCB4aHIuc3RhdHVzLCB4aHIuc3RhdHVzVGV4dCk7CgoJCQkJRGVidWcubG9nLmFwcGx5KERlYnVnLCBhcmdzKTsKCQkJCXJldHVybiBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJCQl9OwoJCX07CgoJCXZhciBkZWJ1Z19iZWdpbiA9IGZ1bmN0aW9uIChkYXRhKSB7CgkJCXZhciB1cGxvYWQgPSBkYXRhLnVwbG9hZCwKCQkJCXN0YXJ0ID0gdGltaW5nKCksCgkJCQlmbjsKCgkJCURlYnVnLmxvZygiSHR0cFJlcXVlc3Q6IiwgZGF0YS5tZXRob2QsIGRhdGEudXJsLCB7IGRhdGE6IGRhdGEgfSk7CgoJCQlpZiAodHlwZW9mKChmbiA9IGRhdGEub25sb2FkKSkgPT09ICJmdW5jdGlvbiIpIHsKCQkJCWRhdGEub25sb2FkID0gZGVidWdfZm4oImxvYWQiLCBkYXRhLCBmbiwgc3RhcnQpOwoJCQl9CgkJCWlmICh0eXBlb2YoKGZuID0gZGF0YS5vbmVycm9yKSkgPT09ICJmdW5jdGlvbiIpIHsKCQkJCWRhdGEub25lcnJvciA9IGRlYnVnX2ZuKCJlcnJvciIsIGRhdGEsIGZuLCBzdGFydCk7CgkJCX0KCQkJaWYgKHR5cGVvZigoZm4gPSBkYXRhLm9uYWJvcnQpKSA9PT0gImZ1bmN0aW9uIikgewoJCQkJZGF0YS5vbmFib3J0ID0gZGVidWdfZm4oImFib3J0IiwgZGF0YSwgZm4sIHN0YXJ0KTsKCQkJfQoKCQkJaWYgKHR5cGVvZih1cGxvYWQpID09PSAib2JqZWN0IiAmJiB1cGxvYWQgIT09IG51bGwpIHsKCQkJCWlmICh0eXBlb2YoKGZuID0gdXBsb2FkLm9uZXJyb3IpKSA9PT0gImZ1bmN0aW9uIikgewoJCQkJCXVwbG9hZC5vbmVycm9yID0gZGVidWdfZm4oInVwbG9hZC5lcnJvciIsIGRhdGEsIGZuLCBzdGFydCk7CgkJCQl9CgkJCQlpZiAodHlwZW9mKChmbiA9IHVwbG9hZC5vbmFib3J0KSkgPT09ICJmdW5jdGlvbiIpIHsKCQkJCQl1cGxvYWQub25hYm9ydCA9IGRlYnVnX2ZuKCJ1cGxvYWQuYWJvcnQiLCBkYXRhLCBmbiwgc3RhcnQpOwoJCQkJfQoJCQl9CgkJfTsKCgkJdmFyIHN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiAodHlwZW9mKEdNLnhtbEh0dHBSZXF1ZXN0KSA9PT0gImZ1bmN0aW9uIik7CgkJCX0KCQkJY2F0Y2ggKGUpIHt9CgkJCXJldHVybiBmYWxzZTsKCQl9OwoKCQl2YXIgcmVxdWVzdDsKCgkJaWYgKHN1cHBvcnRlZCgpKSB7CgkJCXJlcXVlc3QgPSBmdW5jdGlvbiAoZGF0YSkgewoJCQkJaWYgKERlYnVnLmVuYWJsZWQgfHwgdHJ1ZSkgewoJCQkJCWRlYnVnX2JlZ2luKGRhdGEpOwoJCQkJfQoKCQkJCUdNLnhtbEh0dHBSZXF1ZXN0KGRhdGEpOwoJCQl9OwoJCX0KCQllbHNlIHsKCQkJLy8gRmFsbGJhY2sKCQkJcmVxdWVzdCA9IGZ1bmN0aW9uIChkYXRhKSB7CgkJCQlEZWJ1Zy5sb2coIkh0dHBSZXF1ZXN0LmludmFsaWQ6IiwgZGF0YS5tZXRob2QsIGRhdGEudXJsLCB7IGRhdGE6IGRhdGEgfSk7CgkJCQl2YXIgb25lcnJvciA9IChkYXRhICYmIGRhdGEub25lcnJvciAmJiB0eXBlb2YoZGF0YS5vbmVycm9yKSA9PT0gImZ1bmN0aW9uIikgPyBkYXRhLm9uZXJyb3IgOiBudWxsOwoJCQkJaWYgKG9uZXJyb3IgIT09IG51bGwpIHsKCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCQkJCQkJb25lcnJvci5jYWxsKG51bGwsIHt9KTsKCQkJCQl9LCAxKTsKCQkJCX0KCQkJfTsKCQl9CgoJCS8vIERvbmUKCQlyZXR1cm4gcmVxdWVzdDsKCgl9KSgpOwoJdmFyIFVJID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gUHJpdmF0ZQoJCXZhciBkZXRhaWxzX25vZGVzID0ge30sCgkJCWRldGFpbHNfbm9kZXNfY3JlYXRpbmcgPSB7fSwKCQkJYWN0aW9uc19ub2RlcyA9IHt9LAoJCQlhY3Rpb25zX25vZGVzX2FjdGl2ZSA9IHt9LAoJCQlhY3Rpb25zX25vZGVzX2FjdGl2ZV9jb3VudCA9IDAsCgkJCWFjdGlvbnNfbm9kZXNfaW5kZXggPSAwLAoJCQlhY3Rpb25zX2Nsb3NlX3RpbWVvdXQgPSBudWxsOwoKCQl2YXIgZ2FsbGVyeV9saW5rX2V2ZW50c19kYXRhID0gewoJCQlsaW5rOiBudWxsLAoJCQltb3VzZV94OiAwLAoJCQltb3VzZV95OiAwCgkJfTsKCQl2YXIgZ2FsbGVyeV9saW5rX2V2ZW50cyA9IHsKCQkJbW91c2VvdmVyOiAkLndyYXBfbW91c2VlbnRlcmxlYXZlX2V2ZW50KGZ1bmN0aW9uIChldmVudCkgewoJCQkJdmFyIHNlbGYgPSB0aGlzLAoJCQkJCWluZm8gPSBBUEkuZ2V0X3VybF9pbmZvX3NhdmVkKHRoaXMuaHJlZik7CgoJCQkJaWYgKGluZm8gPT09IG51bGwpIHJldHVybjsKCgkJCQlnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubGluayA9IHRoaXM7CgkJCQlnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubW91c2VfeCA9IGV2ZW50LmNsaWVudFg7CgkJCQlnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubW91c2VfeSA9IGV2ZW50LmNsaWVudFk7CgoJCQkJQVBJLmdldF9kYXRhX2Zyb21fdXJsX2luZm8oaW5mbywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJCWlmIChlcnIgPT09IG51bGwgJiYgZ2FsbGVyeV9saW5rX2V2ZW50c19kYXRhLmxpbmsgPT09IHNlbGYpIHsKCQkJCQkJdmFyIGRldGFpbHMgPSBkZXRhaWxzX25vZGVzW2luZm8uaWRdOwoJCQkJCQlpZiAoZGV0YWlscyAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJCQlkZXRhaWxzX2hvdmVyX3N0YXJ0KGRhdGEsIGluZm8sIHNlbGYsIGRldGFpbHMpOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJY3JlYXRlX2RldGFpbHMoZGF0YSwgaW5mbywgZnVuY3Rpb24gKGVyciwgZGV0YWlscykgewoJCQkJCQkJCWlmIChlcnIgPT09IG51bGwgJiYgZ2FsbGVyeV9saW5rX2V2ZW50c19kYXRhLmxpbmsgPT09IHNlbGYpIHsKCQkJCQkJCQkJZGV0YWlsc19ob3Zlcl9zdGFydChkYXRhLCBpbmZvLCBzZWxmLCBkZXRhaWxzKTsKCQkJCQkJCQl9CgkJCQkJCQl9KTsKCQkJCQkJfQoJCQkJCQlkb2N1bWVudF9lbGVtZW50LmNsYXNzTGlzdC5hZGQoInhsLWRldGFpbHMtdmlzaWJsZSIpOwoJCQkJCX0KCQkJCX0pOwoJCQl9KSwKCQkJbW91c2VvdXQ6ICQud3JhcF9tb3VzZWVudGVybGVhdmVfZXZlbnQoZnVuY3Rpb24gKCkgewoJCQkJdmFyIGRldGFpbHMgPSBkZXRhaWxzX25vZGVzW2dldF9ub2RlX2lkX2Z1bGwodGhpcyldOwoKCQkJCWdhbGxlcnlfbGlua19ldmVudHNfZGF0YS5saW5rID0gbnVsbDsKCgkJCQlkb2N1bWVudF9lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoInhsLWRldGFpbHMtdmlzaWJsZSIpOwoKCQkJCWlmIChkZXRhaWxzID09PSB1bmRlZmluZWQpIHJldHVybjsKCgkJCQlkZXRhaWxzLmNsYXNzTGlzdC5hZGQoInhsLWRldGFpbHMtaGlkZGVuIik7CgkJCX0pLAoJCQltb3VzZW1vdmU6IGZ1bmN0aW9uIChldmVudCkgewoJCQkJdmFyIGRldGFpbHMgPSBkZXRhaWxzX25vZGVzW2dldF9ub2RlX2lkX2Z1bGwodGhpcyldOwoKCQkJCWlmIChkZXRhaWxzID09PSB1bmRlZmluZWQpIHJldHVybjsKCgkJCQlnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubW91c2VfeCA9IGV2ZW50LmNsaWVudFg7CgkJCQlnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubW91c2VfeSA9IGV2ZW50LmNsaWVudFk7CgoJCQkJdXBkYXRlX2RldGFpbHNfcG9zaXRpb24oZGV0YWlscywgdGhpcywgZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSk7CgkJCX0KCQl9OwoJCXZhciBnYWxsZXJ5X3RhZ19ldmVudHMgPSB7CgkJCWNsaWNrOiBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJCWlmICgkLmlzX2xlZnRfbW91c2UoZXZlbnQpICYmIGNvbmZpZy5hY3Rpb25zLmVuYWJsZWQpIHsKCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCQl2YXIgaWQgPSB0aGlzLmdldEF0dHJpYnV0ZSgieGwtYWN0aW9ucy1pZCIpOwoJCQkJCWlmICghaWQpIHsKCQkJCQkJaWQgPSAiIiArIGFjdGlvbnNfbm9kZXNfaW5kZXg7CgkJCQkJCSsrYWN0aW9uc19ub2Rlc19pbmRleDsKCQkJCQkJdGhpcy5zZXRBdHRyaWJ1dGUoInhsLWFjdGlvbnMtaWQiLCBpZCk7CgkJCQkJfQoKCQkJCQllbmFibGVfYWN0aW9uc19tZW51X29uX25vZGUodGhpcywgdW5kZWZpbmVkLCBpZCwgZnVuY3Rpb24gKGluZm8sIGlkLCBjYWxsYmFjaykgewoJCQkJCQlBUEkuZ2V0X2RhdGFfZnJvbV91cmxfaW5mbyhpbmZvLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCQkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJCQkJY3JlYXRlX2FjdGlvbnMoZGF0YSwgaW5mbywgaWQsIGNhbGxiYWNrKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfSk7CgkJCQl9CgkJCX0sCgkJCW1vdXNlZG93bjogZnVuY3Rpb24gKCkgewoJCQkJdmFyIG5vZGUgPSB0aGlzOwoJCQkJbm9kZS5ocmVmID0gbm9kZS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtaHJlZiIpIHx8ICIiOwoKCQkJCXZhciBvbl91cCA9IGZ1bmN0aW9uICgpIHsKCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJCQlub2RlLnJlbW92ZUF0dHJpYnV0ZSgiaHJlZiIpOwoJCQkJCX0sIDEpOwoJCQkJCSQub2ZmKGRvY3VtZW50X2VsZW1lbnQsICJtb3VzZXVwIiwgb25fdXApOwoJCQkJfTsKCQkJCSQub24oZG9jdW1lbnRfZWxlbWVudCwgIm1vdXNldXAiLCBvbl91cCk7CgkJCX0KCQl9OwoJCXZhciBnYWxsZXJ5X2ZldGNoX2V2ZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCWlmICgkLmlzX2xlZnRfbW91c2UoZXZlbnQpKSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCXZhciBsaW5rLCBpbmZvOwoKCQkJCUxpbmtpZmllci5jaGFuZ2VfbGlua19ldmVudHModGhpcywgbnVsbCk7CgoJCQkJaWYgKAoJCQkJCShsaW5rID0gZ2V0X2xpbmtfZnJvbV9zaXRlX3RhZyh0aGlzKSkgIT09IG51bGwgJiYKCQkJCQkoaW5mbyA9IEFQSS5nZXRfdXJsX2luZm9fc2F2ZWQobGluay5ocmVmKSkgIT09IG51bGwKCQkJCSkgewoJCQkJCWxvYWRfbGluayhsaW5rLCBpbmZvKTsKCQkJCX0KCQkJfQoJCX07CgkJdmFyIGdhbGxlcnlfZXJyb3JfZXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkgJiYgY29uZmlnLmFjdGlvbnMuZW5hYmxlZCkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCQl2YXIgaWQgPSB0aGlzLmdldEF0dHJpYnV0ZSgieGwtYWN0aW9ucy1pZCIpOwoJCQkJaWYgKCFpZCkgewoJCQkJCWlkID0gIiIgKyBhY3Rpb25zX25vZGVzX2luZGV4OwoJCQkJCSsrYWN0aW9uc19ub2Rlc19pbmRleDsKCQkJCQl0aGlzLnNldEF0dHJpYnV0ZSgieGwtYWN0aW9ucy1pZCIsIGlkKTsKCQkJCX0KCgkJCQllbmFibGVfYWN0aW9uc19tZW51X29uX25vZGUodGhpcywgdW5kZWZpbmVkLCBpZCwgZnVuY3Rpb24gKGluZm8sIGlkLCBjYWxsYmFjaykgewoJCQkJCXZvaWQoaW5mbyk7IC8vIHRvIG1ha2UganNoaW50IGlnbm9yZSB0aGUgdW51c2VkIHZhcgoJCQkJCXZhciBhY3Rpb25zID0gY3JlYXRlX2FjdGlvbnNfbWVudShpZCwgWwoJCQkJCQl7CgkJCQkJCQlsYWJlbDogIkFuIGVycm9yIG9jY3VycmVkIiwKCQkJCQkJCW1vZGlmeTogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCQkJCXZhciBuID0gJCgiLnhsLWFjdGlvbnMtdGFibGUtaGVhZGVyIiwgY29udGFpbmVyKTsKCQkJCQkJCQlpZiAobiAhPT0gbnVsbCkgewoJCQkJCQkJCQluLnN0eWxlLnBhZGRpbmdSaWdodCA9ICI2ZW0iOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfSwKCQkJCQkJewoJCQkJCQkJdGV4dDogIiIsCgkJCQkJCQltb2RpZnk6IGZ1bmN0aW9uIChjb250YWluZXIpIHsKCQkJCQkJCQl2YXIgbiA9ICQoIi54bC1hY3Rpb25zLW9wdGlvbi10ZXh0IiwgY29udGFpbmVyKTsKCQkJCQkJCQlpZiAobiAhPT0gbnVsbCkgewoJCQkJCQkJCQluLnRleHRDb250ZW50ID0gIklmIHRoaXMgZXJyb3IgcGVyc2lzdHMgYW5kIHlvdSBiZWxpZXZlIGl0IHNob3VsZG4ndCwgY2xlYXJpbmcgdGhlIGNhY2hlIG1heSBoZWxwIjsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0sCgkJCQkJCW51bGwsCgkJCQkJCXsKCQkJCQkJCXRleHQ6ICJDbGVhciBjYWNoZSIsCgkJCQkJCQl1cmw6ICIjIiwKCQkJCQkJCW1vZGlmeTogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCQkJCXZhciBuID0gJCgiLnhsLWFjdGlvbnMtb3B0aW9uIiwgY29udGFpbmVyKTsKCQkJCQkJCQlpZiAobiAhPT0gbnVsbCkgewoJCQkJCQkJCQkkLm9uKG4sICJjbGljayIsIGZ1bmN0aW9uIChldmVudCkgewoJCQkJCQkJCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCQkJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCQkJCQkJCQkvLyBDbGVhciBjYWNoZQoJCQkJCQkJCQkJCXZhciBjbGVhcnMgPSBBUEkuY2FjaGVfY2xlYXIoKTsKCQkJCQkJCQkJCQlEZWJ1Zy5sb2coIkNsZWFyZWQgY2FjaGU7IGVudHJpZXNfcmVtb3ZlZD0iICsgY2xlYXJzKTsKCQkJCQkJCQkJCX0KCQkJCQkJCQkJfSwgZmFsc2UpOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfSwKCQkJCQkJbnVsbCwKCQkJCQkJewoJCQkJCQkJdGV4dDogIlN1cHBvcnQiLAoJCQkJCQkJdXJsOiBNYWluLnN1cHBvcnRfdXJsCgkJCQkJCX0KCQkJCQldKTsKCQkJCQljYWxsYmFjayhudWxsLCBhY3Rpb25zKTsKCQkJCX0pOwoKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgoJCXZhciBkZXRhaWxzX2hvdmVyX3N0YXJ0ID0gZnVuY3Rpb24gKGRhdGEsIGluZm8sIG5vZGUsIGRldGFpbHMpIHsKCQkJaWYgKERlYnVnLmVuYWJsZWQpIHsKCQkJCXZhciBpID0gMSwKCQkJCQluID0gZGV0YWlsczsKCQkJCXdoaWxlIChuLnBhcmVudE5vZGUgIT09IGRvY3VtZW50KSB7CgkJCQkJaWYgKCFuLnBhcmVudE5vZGUpIHsKCQkJCQkJRGVidWcubG9nKAoJCQkJCQkJIkludmFsaWQgZGV0YWlsczogcGFyZW50WyIgKyBpICsgIl0gZmFpbGVkOyIsCgkJCQkJCQl7CgkJCQkJCQkJbGluazogbm9kZSwKCQkJCQkJCQlub2RlOiBuLAoJCQkJCQkJCXBhcmVudDogbi5wYXJlbnROb2RlLAoJCQkJCQkJCWRldGFpbHM6IGRldGFpbHMsCgkJCQkJCQkJZGF0YTogZGF0YSwKCQkJCQkJCQlpbmZvOiBpbmZvCgkJCQkJCQl9CgkJCQkJCSk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQluID0gbi5wYXJlbnROb2RlOwoJCQkJCSsraTsKCQkJCX0KCQkJfQoKCQkJZGV0YWlscy5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1kZXRhaWxzLWhpZGRlbiIpOwoJCQlkZXRhaWxzLmNsYXNzTGlzdC5yZW1vdmUoInhsLWRldGFpbHMtaGFzLXRodW1ibmFpbCIpOwoJCQlkZXRhaWxzLmNsYXNzTGlzdC5yZW1vdmUoInhsLWRldGFpbHMtaGFzLXRodW1ibmFpbC12aXNpYmxlIik7CgoJCQl1cGRhdGVfZGV0YWlsc19wb3NpdGlvbihkZXRhaWxzLCBub2RlLCBnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubW91c2VfeCwgZ2FsbGVyeV9saW5rX2V2ZW50c19kYXRhLm1vdXNlX3kpOwoKCQkJaWYgKGRhdGEuc3VidHlwZSA9PT0gImdhbGxlcnkiICYmIGluZm8ucGFnZSAhPT0gdW5kZWZpbmVkICYmIGluZm8ucGFnZSA+IDEpIHsKCQkJCXVwZGF0ZV9kZXRhaWxzX3BhZ2VfdGh1bWJuYWlsKGluZm8ucGFnZSwgZGF0YSwgaW5mbywgZGV0YWlscywgbm9kZSk7CgkJCX0KCQl9OwoKCQl2YXIgc2V0X25vZGVfaWQgPSBmdW5jdGlvbiAobm9kZSwgaW5mbykgewoJCQlub2RlLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1pZCIsIGluZm8uaWQpOwoJCX07CgkJdmFyIGdldF9ub2RlX2lkX2Z1bGwgPSBmdW5jdGlvbiAobm9kZSkgewoJCQlyZXR1cm4gbm9kZS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtaWQiKSB8fCAiIjsKCQl9OwoKCQl2YXIgZ2V0X3NpdGVfdGFnX2Zyb21fbGluayA9IGZ1bmN0aW9uIChub2RlKSB7CgkJCS8vIEFzc3VtZSB0aGUgYnV0dG9uIGlzIHRoZSBwcmV2aW91cyAob3IgcHJldmlvdXMtcHJldmlvdXMpIHNpYmxpbmcKCQkJaWYgKAoJCQkJKG5vZGUgPSBub2RlLnByZXZpb3VzU2libGluZykgIT09IG51bGwgJiYKCQkJCShub2RlLmNsYXNzTGlzdCB8fCAoKG5vZGUgPSBub2RlLnByZXZpb3VzU2libGluZykgIT09IG51bGwgJiYgbm9kZS5jbGFzc0xpc3QpKSAmJgoJCQkJbm9kZS5jbGFzc0xpc3QuY29udGFpbnMoInhsLXNpdGUtdGFnIikKCQkJKSB7CgkJCQlyZXR1cm4gbm9kZTsKCQkJfQoJCQlyZXR1cm4gbnVsbDsKCQl9OwoJCXZhciBnZXRfbGlua19mcm9tX3NpdGVfdGFnID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJLy8gQXNzdW1lIHRoZSBsaW5rIGlzIHRoZSBuZXh0IChvciBuZXh0LW5leHQpIHNpYmxpbmcKCQkJaWYgKAoJCQkJKG5vZGUgPSBub2RlLm5leHRTaWJsaW5nKSAhPT0gbnVsbCAmJgoJCQkJKG5vZGUuY2xhc3NMaXN0IHx8ICgobm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpICE9PSBudWxsICYmIG5vZGUuY2xhc3NMaXN0KSkgJiYKCQkJCW5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1saW5rIikKCQkJKSB7CgkJCQlyZXR1cm4gbm9kZTsKCQkJfQoJCQlyZXR1cm4gbnVsbDsKCQl9OwoKCQl2YXIgcGFkID0gZnVuY3Rpb24gKG4sIHNlcCkgewoJCQlyZXR1cm4gKG4gPCAxMCA/ICIwIiA6ICIiKSArIG4gKyBzZXA7CgkJfTsKCgkJdmFyIGN1c3RvbV9kZXRhaWxzX2Z1bmN0aW9ucyA9IHt9OyAvLyBmdW5jdGlvbiAoZGF0YSwgaW5mbywgY2FsbGJhY2soZXJyLCBjb3B5X2Zyb21fbm9kZSkpCgkJdmFyIGN1c3RvbV9hY3Rpb25zX2Z1bmN0aW9ucyA9IHt9OyAvLyBmdW5jdGlvbiAoZGF0YSwgaW5mbywgY2FsbGJhY2soZXJyLCBnZW5faW5mbykpCgkJdmFyIHJlZ2lzdGVyX2RldGFpbHNfY3JlYXRpb24gPSBmdW5jdGlvbiAoY3VzdG9tX2lkLCBjYWxsYmFjaykgewoJCQljdXN0b21fZGV0YWlsc19mdW5jdGlvbnNbY3VzdG9tX2lkXSA9IGNhbGxiYWNrOwoJCX07CgkJdmFyIHJlZ2lzdGVyX2FjdGlvbnNfY3JlYXRpb24gPSBmdW5jdGlvbiAoY3VzdG9tX2lkLCBjYWxsYmFjaykgewoJCQljdXN0b21fYWN0aW9uc19mdW5jdGlvbnNbY3VzdG9tX2lkXSA9IGNhbGxiYWNrOwoJCX07CgoJCXZhciBoaWdobGlnaHRfbm9kZXMgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBkYXRhKSB7CgkJCXZhciBucyA9ICQkKCIueGwtaGlnaGxpZ2h0IiwgY29udGFpbmVyKSwKCQkJCWksIGlpLCBuLCB0eXBlOwoKCQkJZm9yIChpID0gMCwgaWkgPSBucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQluID0gbnNbaV07CgkJCQl0eXBlID0gbi5nZXRBdHRyaWJ1dGUoImRhdGEteGwtaGlnaGxpZ2h0Iik7CgkJCQlpZiAodHlwZSA9PT0gInRpdGxlIiB8fCB0eXBlID09PSAidXBsb2FkZXIiIHx8IHR5cGUgPT09ICJ0YWdzIikgewoJCQkJCUZpbHRlci5oaWdobGlnaHQodHlwZSwgbiwgZGF0YSwgRmlsdGVyLk5vbmUpOwoJCQkJfQoJCQl9CgkJfTsKCgkJdmFyIGNyZWF0ZV9kZXRhaWxzID0gZnVuY3Rpb24gKGRhdGEsIGluZm8sIGNhbGxiYWNrKSB7CgkJCXZhciBjYXRlZ29yeSA9IEFQSS5nZXRfY2F0ZWdvcnkoZGF0YS5jYXRlZ29yeSksCgkJCQl0aGVtZSA9IFRoZW1lLmNsYXNzZXMsCgkJCQlmaWxlX3NpemUgPSAoZGF0YS50b3RhbF9zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMiksCgkJCQljb250ZW50LCBuMSwgbjIsIG4zLCBmbjsKCgkJCS8vIENyZWF0aW5nIGNoZWNrCgkJCWlmIChkZXRhaWxzX25vZGVzX2NyZWF0aW5nW2luZm8uaWRdID09PSB0cnVlKSB7CgkJCQljYWxsYmFjaygiSW4gcHJvZ3Jlc3MiLCBudWxsKTsKCQkJCXJldHVybjsKCQkJfQoJCQlkZXRhaWxzX25vZGVzX2NyZWF0aW5nW2luZm8uaWRdID0gdHJ1ZTsKCgkJCS8vIEZvbnRzCgkJCS8vTWFpbi5pbnNlcnRfY3VzdG9tX2ZvbnRzKCk7CgoJCQkvLyBDdXN0b20KCQkJaWYgKGRhdGEuc3VidHlwZSAhPT0gImdhbGxlcnkiKSB7CgkJCQlmbiA9IGN1c3RvbV9kZXRhaWxzX2Z1bmN0aW9uc1tpbmZvLl9jdXN0b21faWRdOwoJCQkJaWYgKGZuICE9PSB1bmRlZmluZWQpIHsKCQkJCQkvLyBBZGQgdG8gY29udGFpbmVyCgkJCQkJZm4oZGF0YSwgaW5mbywgZnVuY3Rpb24gKGVyciwgY29udGVudCkgewoJCQkJCQlkZWxldGUgZGV0YWlsc19ub2Rlc19jcmVhdGluZ1tpbmZvLmlkXTsKCgkJCQkJCWlmIChlcnIgPT09IG51bGwpIHsKCQkJCQkJCWNvbnRlbnQuY2xhc3NOYW1lID0gKGNvbnRlbnQuY2xhc3NOYW1lICsgIiB4bC1kZXRhaWxzIHhsLWRldGFpbHMtaGlkZGVuIHhsLWhvdmVyLXNoYWRvdyIgKyB0aGVtZSkudHJpbSgpOwoJCQkJCQkJY29udGVudC5zdHlsZS5vcGFjaXR5ID0gY29uZmlnLmRldGFpbHMub3BhY2l0eTsKCQkJCQkJCVRoZW1lLmJnKGNvbnRlbnQsIGNvbmZpZy5kZXRhaWxzLm9wYWNpdHlfYmcpOwoJCQkJCQkJVGhlbWUuYXBwbHkoY29udGVudCk7CgkJCQkJCQloaWdobGlnaHRfbm9kZXMoY29udGVudCwgZGF0YSk7CgoJCQkJCQkJUG9wdXAuaG92ZXJpbmcoY29udGVudCk7CgkJCQkJCQlkZXRhaWxzX25vZGVzW2luZm8uaWRdID0gY29udGVudDsKCgkJCQkJCQljYWxsYmFjayhudWxsLCBjb250ZW50KTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCWNhbGxiYWNrKGVyciwgbnVsbCk7CgkJCQkJCX0KCQkJCQl9KTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWRlbGV0ZSBkZXRhaWxzX25vZGVzX2NyZWF0aW5nW2luZm8uaWRdOwoJCQkJCWNhbGxiYWNrKCJDb3VsZCBub3QgY3JlYXRlIGRldGFpbHMiLCBudWxsKTsKCQkJCX0KCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gQm9keQoJCQljb250ZW50ID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscyB4bC1kZXRhaWxzLWhpZGRlbiB4bC1ob3Zlci1zaGFkb3ciICsgdGhlbWUpOwoJCQljb250ZW50LnN0eWxlLm9wYWNpdHkgPSBjb25maWcuZGV0YWlscy5vcGFjaXR5OwoJCQlUaGVtZS5iZyhjb250ZW50LCBjb25maWcuZGV0YWlscy5vcGFjaXR5X2JnKTsKCgkJCS8vIEltYWdlCgkJCSQuYWRkKGNvbnRlbnQsIG4xID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy10aHVtYm5haWwiICsgdGhlbWUpKTsKCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1wYWdlLXRodW1ibmFpbCB4bC1ob3Zlci1zaGFkb3ciICsgdGhlbWUpKTsKCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1wYWdlLXRodW1ibmFpbC1zaXplIiArIHRoZW1lKSk7CgkJCSQuYWRkKG4zLCAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXBhZ2UtdGh1bWJuYWlsLWltYWdlIiArIHRoZW1lKSk7CgkJCUFQSS5nZXRfdGh1bWJuYWlsKGRhdGEudGh1bWJuYWlsLCBkYXRhLmZsYWdzLCAkLmJpbmQoZnVuY3Rpb24gKGVyciwgdXJsKSB7CgkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJdGhpcy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSAidXJsKCciICsgdXJsICsgIicpIjsKCQkJCX0KCQkJfSwgbjEpKTsKCgoJCQkvLyBTaWRlYmFyCgkJCSQuYWRkKGNvbnRlbnQsIG4xID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1zaWRlLXBhbmVsIikpOwoKCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtYnV0dG9uIHhsLWJ1dHRvbi1laCB4bC1idXR0b24iICsgY2F0ZWdvcnkuY29sb3JfaWQgKyB0aGVtZSkpOwoJCQkkLmFkZChuMiwgJC5ub2RlKCJkaXYiLCAieGwtbm9pc2UiLCBjYXRlZ29yeS5uYW1lKSk7CgoJCQlpZiAoZGF0YS5yYXRpbmcgPj0gMCkgewoJCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1zaWRlLWJveCB4bC1kZXRhaWxzLXNpZGUtYm94LXJhdGluZyIgKyB0aGVtZSkpOwoJCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1yYXRpbmcgeGwtc3RhcnMtY29udGFpbmVyIikpOwoJCQkJJC5hZGQobjMsIGNyZWF0ZV9yYXRpbmdfc3RhcnMoZGF0YS5yYXRpbmcpKTsKCQkJCSQuYWRkKG4yLCAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXJhdGluZy10ZXh0IiwgIihBdmcuICIgKyBkYXRhLnJhdGluZy50b0ZpeGVkKDIpICsgIikiKSk7CgkJCX0KCgkJCWlmIChkYXRhLmZpbGVfY291bnQgPj0gMCkgewoJCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1zaWRlLWJveCB4bC1kZXRhaWxzLXNpZGUtYm94LXJhdGluZyIgKyB0aGVtZSkpOwoJCQkJJC5hZGQobjIsICQubm9kZSgiZGl2IiwgInhsLWRldGFpbHMtZmlsZS1jb3VudCIsIGRhdGEuZmlsZV9jb3VudCArICIgaW1hZ2UiICsgKGRhdGEuZmlsZV9jb3VudCA9PT0gMSA/ICIiIDogInMiKSkpOwoJCQkJaWYgKGRhdGEudG90YWxfc2l6ZSA+PSAwKSB7CgkJCQkJJC5hZGQobjIsICQubm9kZSgiZGl2IiwgInhsLWRldGFpbHMtZmlsZS1zaXplIiwgIigiICsgZmlsZV9zaXplICsgIiBNQikiKSk7CgkJCQl9CgkJCX0KCgkJCWlmIChkYXRhLnRvcnJlbnRfY291bnQgPj0gMCkgewoJCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1zaWRlLWJveCB4bC1kZXRhaWxzLXNpZGUtYm94LXRvcnJlbnRzIiArIHRoZW1lKSk7CgkJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXNpZGUtYm94LWlubmVyIikpOwoJCQkJJC5hZGQobjMsICQubm9kZSgic3Ryb25nIiwgIiIsICJUb3JyZW50czoiKSk7CgkJCQkkLmFkZChuMywgJC5ub2RlKCJzcGFuIiwgIiIsICIgIiArIGRhdGEudG9ycmVudF9jb3VudCkpOwoJCQl9CgoJCQlpZiAoZGF0YS5yZW1vdmVkID09PSB0cnVlKSB7CgkJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXNpZGUtYm94IHhsLWRldGFpbHMtc2lkZS1ib3gtdmlzaWJsZSIgKyB0aGVtZSkpOwoJCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy1zaWRlLWJveC1pbm5lciIpKTsKCQkJCSQuYWRkKG4zLCAkLm5vZGUoInN0cm9uZyIsICJ4bC1kZXRhaWxzLXNpZGUtYm94LWVycm9yIiArIHRoZW1lLCAiUmVtb3ZlZCIpKTsKCQkJfQoJCQllbHNlIGlmIChkYXRhLnZpc2libGUgIT09IG51bGwpIHsKCQkJCSQuYWRkKG4xLCBuMiA9ICQubm9kZSgiZGl2IiwgInhsLWRldGFpbHMtc2lkZS1ib3ggeGwtZGV0YWlscy1zaWRlLWJveC12aXNpYmxlIiArIHRoZW1lKSk7CgkJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXNpZGUtYm94LWlubmVyIikpOwoJCQkJJC5hZGQobjMsICQubm9kZSgic3Ryb25nIiwgIiIsICJWaXNpYmxlOiIpKTsKCQkJCSQuYWRkKG4zLCAkLm5vZGUoInNwYW4iLCAiIiwgZGF0YS52aXNpYmxlID8gIiBZZXMiIDogIiBObyIpKTsKCQkJfQoKCQkJLy8gVGl0bGUKCQkJJC5hZGQoY29udGVudCwgbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXRpdGxlLWNvbnRhaW5lciIgKyB0aGVtZSkpOwoJCQkkLmFkZChuMSwgbjIgPSAkLmxpbmsoQ3JlYXRlVVJMLnRvX2dhbGxlcnkoZGF0YSwgaW5mby5kb21haW4pLCAieGwtZGV0YWlscy10aXRsZSIgKyB0aGVtZSwgZGF0YS50aXRsZSkpOwoJCQlGaWx0ZXIuaGlnaGxpZ2h0KCJ0aXRsZSIsIG4yLCBkYXRhLCBGaWx0ZXIuTm9uZSk7CgkJCWlmIChkYXRhLnRpdGxlX2pwbiAhPT0gbnVsbCkgewoJCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy10aXRsZS1qcCIgKyB0aGVtZSwgZGF0YS50aXRsZV9qcG4pKTsKCQkJCUZpbHRlci5oaWdobGlnaHQoInRpdGxlIiwgbjIsIGRhdGEsIEZpbHRlci5Ob25lKTsKCQkJfQoKCQkJLy8gVXBsb2FkIGluZm8KCQkJJC5hZGQoY29udGVudCwgbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXVwbG9hZC1pbmZvIiArIHRoZW1lKSk7CgkJCSQuYWRkKG4xLCBuMiA9ICQubm9kZSgiZGl2IiwgInhsLWRldGFpbHMtZmF2b3JpdGUtaW5mbyB4bC1kZXRhaWxzLWZhdm9yaXRlLWluZm8taGlkZGVuIiArIHRoZW1lKSk7CgkJCWlmIChkYXRhLmZhdm9yaXRlX2NhdGVnb3J5ICE9PSBudWxsKSB7CgkJCQl1cGRhdGVfZGV0YWlsc19mYXZvcml0ZV9pbmZvKG4yLCBkYXRhKTsKCQkJfQoKCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZGV0YWlscy11cGxvYWQtaW5mby1pbm5lciIpKTsKCQkJJC5hZGQobjIsICQudG5vZGUoIlVwbG9hZGVkIGJ5IikpOwoJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoInN0cm9uZyIsICJ4bC1kZXRhaWxzLXVwbG9hZGVyIiwgZGF0YS51cGxvYWRlcikpOwoJCQlGaWx0ZXIuaGlnaGxpZ2h0KCJ1cGxvYWRlciIsIG4zLCBkYXRhLCBGaWx0ZXIuTm9uZSk7CgkJCSQuYWRkKG4yLCAkLnRub2RlKCJvbiIpKTsKCQkJJC5hZGQobjIsICQubm9kZSgic3Ryb25nIiwgInhsLWRldGFpbHMtdXBsb2FkLWRhdGUiLCBmb3JtYXRfZGF0ZShkYXRhLmRhdGVfY3JlYXRlZCkpKTsKCgkJCS8vIFRhZ3MKCQkJJC5hZGQoY29udGVudCwgbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLXRhZy1ibG9jayIgKyAoY29uZmlnLmRldGFpbHMudGFnX25hbWVzcGFjZV9uZXdsaW5lID8gIiB4bC1kZXRhaWxzLXRhZy1ibG9jay1tdWx0aWxpbmUiIDogIiIpICsgdGhlbWUpKTsKCQkJJC5hZGQobjEsICQubm9kZSgic3Ryb25nIiwgInhsLWRldGFpbHMtdGFnLWJsb2NrLWxhYmVsIiwgIlRhZ3M6IikpOwoJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoInNwYW4iLCAieGwtZGV0YWlscy10YWdzIikpOwoJCQkkLmFkZChuMiwgY3JlYXRlX3RhZ3MoZGF0YSwgaW5mby5kb21haW4pKTsKCgkJCS8vIEVuZAoJCQkkLmFkZChjb250ZW50LCAkLm5vZGUoImRpdiIsICJ4bC1kZXRhaWxzLWNsZWFyIikpOwoKCQkJLy8gRnVsbCBpbmZvCgkJCWlmIChkYXRhLnR5cGUgPT09ICJlaGVudGFpIiAmJiBjb25maWcuc2l0ZXMuZWhlbnRhaV9leHQgJiYgIWRhdGEuZnVsbCkgewoJCQkJQVBJLmdldF9laGVudGFpX2dhbGxlcnlfZnVsbChpbmZvLCBkYXRhLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCQkJaWYgKGVyciA9PT0gbnVsbCkgewoJCQkJCQl1cGRhdGVfZnVsbChkYXRhLCBpbmZvKTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCURlYnVnLmxvZygiRXJyb3IgcmVxdWVzdGluZyBmdWxsIGluZm9ybWF0aW9uOiAiICsgZXJyKTsKCQkJCQl9CgkJCQl9KTsKCQkJfQoKCQkJLy8gQWRkIHRvIGNvbnRhaW5lcgoJCQlQb3B1cC5ob3ZlcmluZyhjb250ZW50KTsKCQkJZGV0YWlsc19ub2Rlc1tpbmZvLmlkXSA9IGNvbnRlbnQ7CgkJCWRlbGV0ZSBkZXRhaWxzX25vZGVzX2NyZWF0aW5nW2luZm8uaWRdOwoKCQkJLy8gRG9uZQoJCQljYWxsYmFjayhudWxsLCBjb250ZW50KTsKCQl9OwoJCXZhciBjcmVhdGVfdGFncyA9IGZ1bmN0aW9uIChkYXRhLCBkb21haW4pIHsKCQkJdmFyIHRhZ2ZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksCgkJCQlzaXRlID0gZGF0YS50eXBlLAoJCQkJdGFnc19ucyA9IGRhdGEudGFnc19ucywKCQkJCXRoZW1lID0gVGhlbWUuY2xhc3NlcywKCQkJCXRhZyA9IG51bGwsCgkJCQlsYXN0ID0gbnVsbCwKCQkJCW5zX2NvbnRhaW5lciA9IG51bGwsCgkJCQluYW1lc3BhY2UsIG5hbWVzcGFjZV9zdHlsZSwgdGFncywgbGluaywgbnNfYywgaSwgaWk7CgoJCQlpZiAodGFnc19ucyA9PT0gbnVsbCkgewoJCQkJLy8gTm9uLW5hbWVzcGFjZWQgdGFncwoJCQkJdGFncyA9IGRhdGEudGFnczsKCQkJCW5zX2NvbnRhaW5lciA9ICQubm9kZSgic3BhbiIsICJ4bC10YWctbm9uLW5hbWVzcGFjZSIgKyB0aGVtZSk7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IHRhZ3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCXRhZyA9ICQubm9kZSgic3BhbiIsICJ4bC10YWctYmxvY2siICsgdGhlbWUpOwoJCQkJCWxpbmsgPSAkLmxpbmsoQ3JlYXRlVVJMLnRvX3RhZyh0YWdzW2ldLCBzaXRlLCBkb21haW4pLCAieGwtdGFnIiwgdGFnc1tpXSk7CgoJCQkJCUZpbHRlci5oaWdobGlnaHQoInRhZ3MiLCBsaW5rLCBkYXRhLCBGaWx0ZXIuTm9uZSk7CgoJCQkJCSQuYWRkKHRhZywgbGluayk7CgkJCQkJJC5hZGQodGFnLCAobGFzdCA9ICQudG5vZGUoIiwiKSkpOwoJCQkJCSQuYWRkKG5zX2NvbnRhaW5lciwgdGFnKTsKCQkJCX0KCQkJCWlmIChsYXN0ICE9PSBudWxsKSAkLnJlbW92ZShsYXN0KTsKCQkJCSQuYWRkKHRhZ2ZyYWcsIG5zX2NvbnRhaW5lcik7CgkJCX0KCQkJZWxzZSB7CgkJCQkvLyBOYW1lc3BhY2VkIHRhZ3MKCQkJCWZvciAobmFtZXNwYWNlIGluIHRhZ3NfbnMpIHsKCQkJCQl0YWdzID0gdGFnc19uc1tuYW1lc3BhY2VdOwoJCQkJCWlpID0gdGFncy5sZW5ndGg7CgkJCQkJaWYgKGlpID09PSAwKSBjb250aW51ZTsKCQkJCQluYW1lc3BhY2Vfc3R5bGUgPSAiIHhsLXRhZy1uYW1lc3BhY2UtIiArIG5hbWVzcGFjZS5yZXBsYWNlKC9ccysvZywgIi0iKSArIHRoZW1lOwoKCQkJCQluc19jb250YWluZXIgPSAkLm5vZGUoInNwYW4iLCAieGwtdGFnLW5hbWVzcGFjZSIgKyBuYW1lc3BhY2Vfc3R5bGUpOwoJCQkJCXRhZyA9ICQubm9kZSgic3BhbiIsICJ4bC10YWctbmFtZXNwYWNlLWJsb2NrIiArIG5hbWVzcGFjZV9zdHlsZSk7CgkJCQkJbGluayA9ICQubm9kZSgic3BhbiIsICJ4bC10YWctbmFtZXNwYWNlLWxhYmVsIiwgbmFtZXNwYWNlKTsKCQkJCQluc19jID0gJC5ub2RlKCJzcGFuIiwgInhsLXRhZy1uYW1lc3BhY2UtZmlyc3QtdGFnIik7CgkJCQkJJC5hZGQodGFnLCBsaW5rKTsKCQkJCQkkLmFkZCh0YWcsICQudG5vZGUoIjoiKSk7CgkJCQkJJC5hZGQobnNfYywgdGFnKTsKCQkJCQkkLmFkZChuc19jb250YWluZXIsIG5zX2MpOwoJCQkJCSQuYWRkKHRhZ2ZyYWcsIG5zX2NvbnRhaW5lcik7CgoJCQkJCWZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7CgkJCQkJCXRhZyA9ICQubm9kZSgic3BhbiIsICJ4bC10YWctYmxvY2siICsgdGhlbWUpOwoJCQkJCQlsaW5rID0gJC5saW5rKENyZWF0ZVVSTC50b190YWdfbnModGFnc1tpXSwgbmFtZXNwYWNlLCBzaXRlLCBkb21haW4pLCAieGwtdGFnIiwgdGFnc1tpXSk7CgoJCQkJCQlGaWx0ZXIuaGlnaGxpZ2h0KCJ0YWdzIiwgbGluaywgZGF0YSwgRmlsdGVyLk5vbmUpOwoKCQkJCQkJJC5hZGQodGFnLCBsaW5rKTsKCQkJCQkJaWYgKGkgPCBpaSAtIDEpIHsKCQkJCQkJCSQuYWRkKHRhZywgJC50bm9kZSgiLCIpKTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCXRhZy5jbGFzc0xpc3QuYWRkKCJ4bC10YWctYmxvY2stbGFzdC1vZi1uYW1lc3BhY2UiKTsKCQkJCQkJfQoJCQkJCQkkLmFkZChuc19jLCB0YWcpOwoJCQkJCQluc19jID0gbnNfY29udGFpbmVyOwoJCQkJCX0KCQkJCX0KCgkJCQlpZiAodGFnICE9PSBudWxsKSB7CgkJCQkJdGFnLmNsYXNzTGlzdC5hZGQoInhsLXRhZy1ibG9jay1sYXN0Iik7CgkJCQl9CgkJCX0KCgkJCXJldHVybiB0YWdmcmFnOwoJCX07CgkJdmFyIHVwZGF0ZV9kZXRhaWxzX3BhZ2VfdGh1bWJuYWlsID0gZnVuY3Rpb24gKHBhZ2UsIGRhdGEsIGluZm8sIGRldGFpbHMsIG5vZGUpIHsKCQkJdmFyIHRodW1iX3N0YXRlID0gMDsKCgkJCXZhciB0aHVtYl9jYiA9IGZ1bmN0aW9uIChlcnIsIHRodW1iX2RhdGEpIHsKCQkJCWlmIChlcnIgPT09IG51bGwpIHsKCQkJCQlBUEkuZ2V0X3RodW1ibmFpbCh0aHVtYl9kYXRhLnVybCwgdGh1bWJfZGF0YS5mbGFncywgZnVuY3Rpb24gKGVyciwgdGh1bWJfdXJsKSB7CgkJCQkJCWlmIChlcnIgPT09IG51bGwgJiYgbm9kZSA9PT0gZ2FsbGVyeV9saW5rX2V2ZW50c19kYXRhLmxpbmspIHsKCQkJCQkJCXZhciBuMCwgbjEsIG4yOwoJCQkJCQkJaWYgKAoJCQkJCQkJCShuMCA9ICQoIi54bC1kZXRhaWxzLXBhZ2UtdGh1bWJuYWlsIiwgZGV0YWlscykpICE9PSBudWxsICYmCgkJCQkJCQkJKG4xID0gJCgiLnhsLWRldGFpbHMtcGFnZS10aHVtYm5haWwtc2l6ZSIsIG4wKSkgIT09IG51bGwgJiYKCQkJCQkJCQkobjIgPSAkKCIueGwtZGV0YWlscy1wYWdlLXRodW1ibmFpbC1pbWFnZSIsIG4xKSkgIT09IG51bGwKCQkJCQkJCSkgewoJCQkJCQkJCW4yLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICJ1cmwoJyIgKyB0aHVtYl91cmwgKyAiJykiOwoKCQkJCQkJCQlpZiAodGh1bWJfZGF0YS53aWR0aCA+IDAgJiYgdGh1bWJfZGF0YS5oZWlnaHQgPiAwKSB7CgkJCQkJCQkJCS8vIFNtYWxsIHRodW1ibmFpbAoJCQkJCQkJCQl2YXIgbWF4X3dpZHRoID0gMTQwLAoJCQkJCQkJCQkJbWF4X2hlaWdodCA9IDIwMCwKCQkJCQkJCQkJCW1heF9yYXRpbyA9IG1heF9oZWlnaHQgLyBtYXhfd2lkdGgsCgkJCQkJCQkJCQlzY2FsZSA9ICh0aHVtYl9kYXRhLmhlaWdodCAvIHRodW1iX2RhdGEud2lkdGggPiBtYXhfcmF0aW8pID8gbWF4X2hlaWdodCAvIHRodW1iX2RhdGEuaGVpZ2h0IDogbWF4X3dpZHRoIC8gdGh1bWJfZGF0YS53aWR0aDsKCgkJCQkJCQkJCW4xLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGUoLTUwJSwtNTAlKSBzY2FsZSgiICsgc2NhbGUgKyAiKSI7CgkJCQkJCQkJCW4xLnN0eWxlLmxlZnQgPSAiNTAlIjsKCQkJCQkJCQkJbjEuc3R5bGUudG9wID0gIjUwJSI7CgkJCQkJCQkJCW4xLnN0eWxlLndpZHRoID0gdGh1bWJfZGF0YS53aWR0aCArICJweCI7CgkJCQkJCQkJCW4xLnN0eWxlLmhlaWdodCA9IHRodW1iX2RhdGEuaGVpZ2h0ICsgInB4IjsKCQkJCQkJCQkJbjIuc3R5bGUuYmFja2dyb3VuZFNpemUgPSAiYXV0byI7CgkJCQkJCQkJCW4yLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbiA9ICgtdGh1bWJfZGF0YS5sZWZ0KSArICJweCAiICsgKC10aHVtYl9kYXRhLnRvcCkgKyAicHgiOwoJCQkJCQkJCX0KCQkJCQkJCQllbHNlIHsKCQkJCQkJCQkJLy8gTGFyZ2UgdGh1bWJuYWlsCgkJCQkJCQkJCW4xLnN0eWxlLnRyYW5zZm9ybSA9ICIiOwoJCQkJCQkJCQluMS5zdHlsZS5sZWZ0ID0gIiI7CgkJCQkJCQkJCW4xLnN0eWxlLnRvcCA9ICIiOwoJCQkJCQkJCQluMS5zdHlsZS53aWR0aCA9ICIiOwoJCQkJCQkJCQluMS5zdHlsZS5oZWlnaHQgPSAiIjsKCQkJCQkJCQkJbjIuc3R5bGUuYmFja2dyb3VuZFNpemUgPSAiIjsKCQkJCQkJCQkJbjIuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gIiI7CgkJCQkJCQkJfQoKCQkJCQkJCQkvLyBBbmltYXRlCgkJCQkJCQkJaWYgKHRodW1iX3N0YXRlID09PSAxKSB7CgkJCQkJCQkJCVRoZW1lLmdldF9jb21wdXRlZF9zdHlsZShuMCkuZ2V0UHJvcGVydHlWYWx1ZSgidHJhbnNmb3JtIik7CgkJCQkJCQkJfQoJCQkJCQkJCWRldGFpbHMuY2xhc3NMaXN0LmFkZCgieGwtZGV0YWlscy1oYXMtdGh1bWJuYWlsLXZpc2libGUiKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0pOwoJCQkJfQoJCQl9OwoKCQkJZGV0YWlscy5jbGFzc0xpc3QuYWRkKCJ4bC1kZXRhaWxzLWhhcy10aHVtYm5haWwiKTsKCQkJaWYgKGluZm8uc2l0ZSA9PT0gImVoZW50YWkiKSB7CgkJCQlBUEkuZ2V0X2VoZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iKGluZm8uZG9tYWluLCBkYXRhLmdpZCwgZGF0YS50b2tlbiwgaW5mby5wYWdlX3Rva2VuLCBwYWdlLCB0aHVtYl9jYik7CgkJCX0KCQkJZWxzZSBpZiAoaW5mby5zaXRlID09PSAibmhlbnRhaSIpIHsKCQkJCUFQSS5nZXRfbmhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIoZGF0YS5naWQsIHBhZ2UsIHRodW1iX2NiKTsKCQkJfQoJCQllbHNlIGlmIChpbmZvLnNpdGUgPT09ICJoaXRvbWkiKSB7CgkJCQlBUEkuZ2V0X2hpdG9taV9nYWxsZXJ5X3BhZ2VfdGh1bWIoZGF0YS5naWQsIHBhZ2UsIHRodW1iX2NiKTsKCQkJfQoJCQllbHNlIHsKCQkJCXRodW1iX2NiKCJJbnZhbGlkIiwgbnVsbCk7CgkJCX0KCQkJaWYgKHRodW1iX3N0YXRlID09PSAwKSArK3RodW1iX3N0YXRlOwoJCX07CgkJdmFyIHVwZGF0ZV9mdWxsID0gZnVuY3Rpb24gKGRhdGEsIGluZm8pIHsKCQkJdmFyIGRvbWFpbiA9IGRvbWFpbnMuZXhoZW50YWksCgkJCQlmdWxsX2lkID0gaW5mby5pZCwKCQkJCWRldGFpbHMgPSBkZXRhaWxzX25vZGVzW2Z1bGxfaWRdLAoJCQkJdGFnZnJhZywgbiwgbjI7CgoJCQlpZiAoZGV0YWlscyA9PT0gdW5kZWZpbmVkKSByZXR1cm47CgoJCQkvLyBSZW1vdmVkIHN0YXR1cwoJCQlpZiAoZGF0YS5yZW1vdmVkID09PSB0cnVlKSB7CgkJCQlpZiAoKG4yID0gJCgiLnhsLWRldGFpbHMtc2lkZS1ib3gtdmlzaWJsZT4ueGwtZGV0YWlscy1zaWRlLWJveC1pbm5lciIsIGRldGFpbHMpKSAhPT0gbnVsbCkgewoJCQkJCW4gPSAkLm5vZGUoInN0cm9uZyIsICJ4bC1kZXRhaWxzLXNpZGUtYm94LWVycm9yIiArIFRoZW1lLmNsYXNzZXMsICJSZW1vdmVkIik7CgkJCQkJbjIuaW5uZXJIVE1MID0gIiI7CgkJCQkJbjIuYXBwZW5kQ2hpbGQobik7CgkJCQl9CgkJCX0KCgkJCS8vIFVwZGF0ZSBkb21haW4KCQkJaWYgKChuID0gJCgiLnhsLWRldGFpbHMtdGl0bGVbaHJlZl0iLCBkZXRhaWxzKSkgIT09IG51bGwpIHsKCQkJCWRvbWFpbiA9ICQuZ2V0X2Z1bGxfZG9tYWluKG4uaHJlZik7CgkJCX0KCgkJCS8vIFVwZGF0ZSB0YWdzCgkJCWlmICgKCQkJCWRhdGEudGFnc19ucyAhPT0gbnVsbCAmJgoJCQkJKG4gPSAkKCIueGwtZGV0YWlscy10YWdzIiwgZGV0YWlscykpICE9PSBudWxsCgkJCSkgewoJCQkJdGFnZnJhZyA9IGNyZWF0ZV90YWdzKGRhdGEsIGRvbWFpbik7CgkJCQluLmlubmVySFRNTCA9ICIiOwoJCQkJJC5hZGQobiwgdGFnZnJhZyk7CgkJCX0KCgkJCS8vIFVwZGF0ZSBmYXZvcml0ZXMKCQkJaWYgKAoJCQkJZGF0YS5mYXZvcml0ZV9jYXRlZ29yeSAhPT0gbnVsbCAmJgoJCQkJKG4gPSAkKCIueGwtZGV0YWlscy1mYXZvcml0ZS1pbmZvLnhsLWRldGFpbHMtZmF2b3JpdGUtaW5mby1oaWRkZW4iLCBkZXRhaWxzKSkgIT09IG51bGwKCQkJKSB7CgkJCQl1cGRhdGVfZGV0YWlsc19mYXZvcml0ZV9pbmZvKG4sIGRhdGEpOwoJCQl9CgoJCQkvLyBSZXBvc2l0aW9uIGFueSBvcGVuIGRldGFpbHMKCQkJaWYgKAoJCQkJKG4gPSBnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubGluaykgIT09IG51bGwgJiYKCQkJCWdldF9ub2RlX2lkX2Z1bGwobikgPT09IGZ1bGxfaWQKCQkJKSB7CgkJCQl1cGRhdGVfZGV0YWlsc19wb3NpdGlvbihkZXRhaWxzLCBuLCBnYWxsZXJ5X2xpbmtfZXZlbnRzX2RhdGEubW91c2VfeCwgZ2FsbGVyeV9saW5rX2V2ZW50c19kYXRhLm1vdXNlX3kpOwoJCQl9CgkJfTsKCQl2YXIgdXBkYXRlX2RldGFpbHNfcG9zaXRpb24gPSBmdW5jdGlvbiAoZGV0YWlscywgbGluaywgbW91c2VfeCwgbW91c2VfeSkgewoJCQl2YXIgd2luX3dpZHRoID0gKGRvY3VtZW50X2VsZW1lbnQuY2xpZW50V2lkdGggfHwgd2luZG93LmlubmVyV2lkdGggfHwgMCksCgkJCQl3aW5faGVpZ2h0ID0gKGRvY3VtZW50X2VsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IHdpbmRvdy5pbm5lckhlaWdodCB8fCAwKSwKCQkJCXJlY3QgPSBkZXRhaWxzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLAoJCQkJbGlua19yZWN0ID0gbGluay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwKCQkJCWlzX2xvdyA9IChsaW5rX3JlY3QudG9wICsgbGlua19yZWN0LmhlaWdodCAvIDIgPj0gd2luX2hlaWdodCAvIDIpLCAvLyAobW91c2VfeSA+PSB3aW5faGVpZ2h0IC8gMikKCQkJCW9mZnNldCA9IDIwOwoKCQkJbW91c2VfeCArPSByZWN0LndpZHRoICogKGNvbmZpZy5kZXRhaWxzLmhvdmVyX3Bvc2l0aW9uIHx8IDApOwoJCQltb3VzZV94ID0gTWF0aC5tYXgoMSwgTWF0aC5taW4od2luX3dpZHRoIC0gcmVjdC53aWR0aCAtIDEsIG1vdXNlX3gpKTsKCQkJbW91c2VfeSArPSBpc19sb3cgPyAtKHJlY3QuaGVpZ2h0ICsgb2Zmc2V0KSA6IG9mZnNldDsKCgkJCWRldGFpbHMuc3R5bGUubGVmdCA9IG1vdXNlX3ggKyAicHgiOwoJCQlkZXRhaWxzLnN0eWxlLnRvcCA9IG1vdXNlX3kgKyAicHgiOwoJCX07CgkJdmFyIHVwZGF0ZV9kZXRhaWxzX2Zhdm9yaXRlX2luZm8gPSBmdW5jdGlvbiAobm9kZSwgZGF0YSkgewoJCQl2YXIgY2F0ID0gZGF0YS5mYXZvcml0ZV9jYXRlZ29yeSwKCQkJCW47CgoJCQlub2RlLmNsYXNzTGlzdC5yZW1vdmUoInhsLWRldGFpbHMtZmF2b3JpdGUtaW5mby1oaWRkZW4iKTsKCQkJbm9kZS50ZXh0Q29udGVudCA9ICIiOwoKCQkJbiA9ICQubm9kZSgiZGl2IiwgInhsLWRldGFpbHMtZmF2b3JpdGUtY2F0ZWdvcnkgeGwtYnV0dG9uIHhsLWJ1dHRvbi1laCB4bC1idXR0b24iICsgY2F0WzBdICsgVGhlbWUuY2xhc3Nlcyk7CgkJCSQuYWRkKG4sICQubm9kZSgic3BhbiIsICJ4bC1kZXRhaWxzLWZhdm9yaXRlLWxhYmVsIiwgIkZhdm9yaXRlZDoiKSk7CgkJCSQuYWRkKG4sICQubm9kZSgic3BhbiIsICJ4bC1kZXRhaWxzLWZhdm9yaXRlLW5hbWUiLCBjYXRbMV0pKTsKCQkJbi50aXRsZSA9IGNhdFsxXTsKCgkJCSQuYWRkKG5vZGUsIG4pOwoJCX07CgoJCXZhciBvbl93aW5kb3dfcmVzaXplID0gZnVuY3Rpb24gKCkgewoJCQl1cGRhdGVfYWN0aXZlX2FjdGlvbnNfcG9zaXRpb24oKTsKCQl9OwoJCXZhciBvbl9kb2N1bWVudF9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoYWN0aW9uc19jbG9zZV90aW1lb3V0ID09PSBudWxsKSB7CgkJCQlpZiAoY29uZmlnLmFjdGlvbnMuY2xvc2Vfb25fY2xpY2spIHsKCQkJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJCQljbG9zZV9hbGxfYWN0aW9uc19tZW51cygpOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIFJlLXBvc2l0aW9uCgkJCQkJc2V0VGltZW91dCh1cGRhdGVfYWN0aXZlX2FjdGlvbnNfcG9zaXRpb24sIDEpOwoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgY3JlYXRlX3RhZ19iZyA9IGZ1bmN0aW9uIChwYXJlbnQpIHsKCQkJdmFyIHRhZ19iZyA9ICQubm9kZSgiZGl2IiwgInhsLXNpdGUtdGFnLWJnIiArIFRoZW1lLmNsYXNzZXMpLAoJCQkJb3V0bGluZSA9ICQubm9kZSgiZGl2IiwgInhsLXNpdGUtdGFnLWJnLXNoYWRvdyB4bC1ob3Zlci1zaGFkb3ciICsgVGhlbWUuY2xhc3NlcyksCgkJCQlpbm5lciA9ICQubm9kZSgiZGl2IiwgInhsLXNpdGUtdGFnLWJnLWlubmVyIiArIFRoZW1lLmNsYXNzZXMpOwoKCQkJVGhlbWUuYmcoaW5uZXIpOwoKCQkJJC5hZGQodGFnX2JnLCBpbm5lcik7CgoJCQkkLmJlZm9yZShwYXJlbnQsIHBhcmVudC5maXJzdENoaWxkLCB0YWdfYmcpOwoJCQkkLmJlZm9yZShwYXJlbnQsIHBhcmVudC5maXJzdENoaWxkLCBvdXRsaW5lKTsKCgkJCXJldHVybiB0YWdfYmc7CgkJfTsKCgkJdmFyIG1hcmtfc2l0ZV90YWcgPSBmdW5jdGlvbiAoYnV0dG9uLCB0ZXh0KSB7CgkJCWlmICgoYnV0dG9uID0gZ2V0X3NpdGVfdGFnX3RleHRfbm9kZShidXR0b24pKSAhPT0gbnVsbCkgewoJCQkJYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uLnRleHRDb250ZW50LnJlcGxhY2UoL1xdXHMqJC8sIHRleHQgKyAiXSIpOwoJCQl9CgkJfTsKCQl2YXIgdXBkYXRlX3NpdGVfdGFnID0gZnVuY3Rpb24gKGJ1dHRvbiwgaW5mbykgewoJCQl2YXIgbjsKCQkJaWYgKChuID0gZ2V0X3NpdGVfdGFnX3RleHRfbm9kZShidXR0b24pKSAhPT0gbnVsbCkgewoJCQkJbi50ZXh0Q29udGVudCA9IGNyZWF0ZV9zaXRlX3RhZ190ZXh0KGluZm8pOwoJCQl9CgkJCWlmIChpbmZvLmljb24gIT09IHVuZGVmaW5lZCAmJiAobiA9ICQoIi54bC1zaXRlLXRhZy1pY29uIiwgYnV0dG9uKSkgIT09IG51bGwpIHsKCQkJCW4uc2V0QXR0cmlidXRlKCJkYXRhLXhsLXNpdGUtdGFnLWljb24iLCBpbmZvLmljb24pOwoJCQl9CgkJfTsKCgkJLy8gQWN0aW9ucyBtZW51cwoJCXZhciBjcmVhdGVfYWN0aW9ucyA9IGZ1bmN0aW9uIChkYXRhLCBpbmZvLCBpbmRleCwgY2FsbGJhY2spIHsKCQkJdmFyIGVudHJpZXMgPSBudWxsLAoJCQkJZ2lkID0gZGF0YS5naWQsCgkJCQl0b2tlbiA9IGRhdGEudG9rZW4sCgkJCQl0eXBlID0gZGF0YS50eXBlLAoJCQkJZG9tYWluID0gaW5mby5kb21haW4sCgkJCQlhY3Rpb25zLCBmbjsKCgkJCWlmIChkYXRhLnN1YnR5cGUgPT09ICJnYWxsZXJ5IikgewoJCQkJaWYgKHR5cGUgPT09ICJlaGVudGFpIikgewoJCQkJCWVudHJpZXMgPSBbCgkJCQkJCXsKCQkJCQkJCWxhYmVsOiAiVmlldyBvbjoiLAoJCQkJCQkJdGV4dDogIkUtSGVudGFpIiwKCQkJCQkJCXVybDogQ3JlYXRlVVJMLnRvX2dhbGxlcnkoZGF0YSwgZG9tYWlucy5nZWhlbnRhaSkKCQkJCQkJfSwKCQkJCQkJewoJCQkJCQkJbGFiZWw6IG51bGwsCgkJCQkJCQl0ZXh0OiAiRXhIZW50YWkiLAoJCQkJCQkJdXJsOiBDcmVhdGVVUkwudG9fZ2FsbGVyeShkYXRhLCBkb21haW5zLmV4aGVudGFpKQoJCQkJCQl9LAoJCQkJCQludWxsLAoJCQkJCQl7CgkJCQkJCQlsYWJlbDogIlVwbG9hZGVyOiIsCgkJCQkJCQl0ZXh0OiBkYXRhLnVwbG9hZGVyLAoJCQkJCQkJdXJsOiBDcmVhdGVVUkwudG9fdXBsb2FkZXIoZGF0YSwgZG9tYWluKSwKCQkJCQkJCW1vZGlmeTogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCQkJCXZhciBuID0gJCgiLnhsLWFjdGlvbnMtb3B0aW9uIiwgY29udGFpbmVyKTsKCQkJCQkJCQlpZiAobiAhPT0gbnVsbCkgewoJCQkJCQkJCQluLmNsYXNzTGlzdC5hZGQoInhsLWFjdGlvbnMtdXBsb2FkZXIiKTsKCQkJCQkJCQkJRmlsdGVyLmhpZ2hsaWdodCgidXBsb2FkZXIiLCBuLCBkYXRhLCBGaWx0ZXIuTm9uZSk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9LAoJCQkJCQludWxsLAoJCQkJCQl7CgkJCQkJCQlsYWJlbDogIkRvd25sb2FkOiIsCgkJCQkJCQl0ZXh0OiAiVG9ycmVudCAoIiArIGRhdGEudG9ycmVudF9jb3VudCArICIpIiwKCQkJCQkJCXVybDogImh0dHA6Ly8iICsgZG9tYWluICsgIi9nYWxsZXJ5dG9ycmVudHMucGhwP2dpZD0iICsgZ2lkICsgIiZ0PSIgKyB0b2tlbiwKCQkJCQkJfSwKCQkJCQkJewoJCQkJCQkJbGFiZWw6IG51bGwsCgkJCQkJCQl0ZXh0OiAiQXJjaGl2ZXIiLAoJCQkJCQkJdXJsOiAiaHR0cDovLyIgKyBkb21haW5zLmdlaGVudGFpICsgIi9hcmNoaXZlci5waHA/Z2lkPSIgKyBnaWQgKyAiJnRva2VuPSIgKyB0b2tlbiArICImb3I9IiArIGRhdGEuYXJjaGl2ZXJfa2V5LAoJCQkJCQkJbW9kaWZ5OiBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQkJCQkJdmFyIG4gPSAkKCIueGwtYWN0aW9ucy1vcHRpb24iLCBjb250YWluZXIpOwoJCQkJCQkJCWlmIChuICE9PSBudWxsKSB7CgkJCQkJCQkJCW4ucmVtb3ZlQXR0cmlidXRlKCJ0YXJnZXQiKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCX0sCgkJCQkJCW51bGwsCgkJCQkJCXsKCQkJCQkJCWxhYmVsOiAiT3RoZXI6IiwKCQkJCQkJCXRleHQ6ICJGYXZvcml0ZSIsCgkJCQkJCQl1cmw6ICJodHRwOi8vIiArIGRvbWFpbiArICIvZ2FsbGVyeXBvcHVwcy5waHA/Z2lkPSIgKyBnaWQgKyAiJnQ9IiArIHRva2VuICsgIiZhY3Q9YWRkZmF2IgoJCQkJCQl9LAoJCQkJCQl7CgkJCQkJCQlsYWJlbDogbnVsbCwKCQkJCQkJCXRleHQ6ICJTdGF0cyIsCgkJCQkJCQl1cmw6ICJodHRwOi8vIiArIGRvbWFpbnMuZ2VoZW50YWkgKyAiL3N0YXRzLnBocD9naWQ9IiArIGdpZCArICImdD0iICsgdG9rZW4KCQkJCQkJfQoJCQkJCV07CgkJCQl9CgkJCQllbHNlIGlmICh0eXBlID09PSAibmhlbnRhaSIpIHsKCQkJCQllbnRyaWVzID0gWwoJCQkJCQl7CgkJCQkJCQlsYWJlbDogIlZpZXcgb246IiwKCQkJCQkJCXRleHQ6ICJuaGVudGFpLm5ldCIsCgkJCQkJCQl1cmw6IENyZWF0ZVVSTC50b19nYWxsZXJ5KGRhdGEsIGRvbWFpbikKCQkJCQkJfQoJCQkJCV07CgkJCQl9CgkJCQllbHNlIGlmICh0eXBlID09PSAiaGl0b21pIikgewoJCQkJCWVudHJpZXMgPSBbCgkJCQkJCXsKCQkJCQkJCWxhYmVsOiAiVmlldyBvbjoiLAoJCQkJCQkJdGV4dDogImhpdG9taS5sYSIsCgkJCQkJCQl1cmw6IENyZWF0ZVVSTC50b19nYWxsZXJ5KGRhdGEsIGRvbWFpbikKCQkJCQkJfQoJCQkJCV07CgkJCQl9CgkJCX0KCgkJCS8vIEVtcHR5CgkJCWlmIChlbnRyaWVzID09PSBudWxsKSB7CgkJCQlmbiA9IGN1c3RvbV9hY3Rpb25zX2Z1bmN0aW9uc1tpbmZvLl9jdXN0b21faWRdOwoJCQkJaWYgKGZuICE9PSB1bmRlZmluZWQpIHsKCQkJCQlmbihkYXRhLCBpbmZvLCBmdW5jdGlvbiAoZXJyLCBnZW5faW5mbykgewoJCQkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJCQl2YXIgaWkgPSBnZW5faW5mby5sZW5ndGgsCgkJCQkJCQkJZW50cmllcyA9IFtdLAoJCQkJCQkJCWFjdGlvbnMsIGksIGc7CgoJCQkJCQkJaWYgKGlpID09PSAwKSB7CgkJCQkJCQkJZW50cmllcy5wdXNoKHsgbGFiZWw6ICJObyBhY3Rpb25zIGF2YWlsYWJsZSIgfSk7CgkJCQkJCQl9CgkJCQkJCQllbHNlIHsKCQkJCQkJCQlmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkgewoJCQkJCQkJCQlnID0gZ2VuX2luZm9baV07CgkJCQkJCQkJCWVudHJpZXMucHVzaCgoZyA9PT0gbnVsbCkgPyBudWxsIDogewoJCQkJCQkJCQkJbGFiZWw6IGdbMF0sCgkJCQkJCQkJCQl0ZXh0OiBnWzJdLAoJCQkJCQkJCQkJdXJsOiBnWzFdCgkJCQkJCQkJCX0pOwoJCQkJCQkJCX0KCQkJCQkJCX0KCgkJCQkJCQlhY3Rpb25zID0gY3JlYXRlX2FjdGlvbnNfbWVudShpbmRleCwgZW50cmllcyk7CgkJCQkJCQljYWxsYmFjayhudWxsLCBhY3Rpb25zKTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCWNhbGxiYWNrKGVyciwgbnVsbCk7CgkJCQkJCX0KCQkJCQl9KTsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJZW50cmllcyA9IFt7IGxhYmVsOiAiTm8gYWN0aW9ucyBhdmFpbGFibGUiIH1dOwoJCQl9CgoJCQkvLyBEb25lCgkJCWFjdGlvbnMgPSBjcmVhdGVfYWN0aW9uc19tZW51KGluZGV4LCBlbnRyaWVzKTsKCQkJY2FsbGJhY2sobnVsbCwgYWN0aW9ucyk7CgkJfTsKCQl2YXIgdXBkYXRlX2FjdGlvbnNfcG9zaXRpb24gPSBmdW5jdGlvbiAoYWN0aW9ucywgdGFnLCB0YWdfYmcsIGRlX3JlY3QsIHhwb3MsIHlwb3MpIHsKCQkJLy8gUG9zaXRpb24KCQkJdmFyIHJlY3QgPSB0YWdfYmcuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksCgkJCQliZWxvdywgcmlnaHQsIHgsIHk7CgoJCQkvLyBQb3NpdGlvbmluZwoJCQlpZiAoeHBvcyA9PT0gInJpZ2h0IikgewoJCQkJcmlnaHQgPSB0cnVlOwoJCQl9CgkJCWVsc2UgaWYgKHhwb3MgPT09ICJsZWZ0IikgewoJCQkJcmlnaHQgPSBmYWxzZTsKCQkJfQoJCQllbHNlIHsKCQkJCXJpZ2h0ID0gKHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyIDw9IChkb2N1bWVudF9lbGVtZW50LmNsaWVudFdpZHRoIHx8IHdpbmRvdy5pbm5lcldpZHRoIHx8IDApIC8gMik7CgkJCQl4cG9zID0gcmlnaHQgPyAicmlnaHQiIDogImxlZnQiOwoJCQl9CgoJCQlpZiAoeXBvcyA9PT0gImJlbG93IikgewoJCQkJYmVsb3cgPSB0cnVlOwoJCQl9CgkJCWVsc2UgaWYgKHlwb3MgPT09ICJhYm92ZSIpIHsKCQkJCWJlbG93ID0gZmFsc2U7CgkJCX0KCQkJZWxzZSB7CgkJCQliZWxvdyA9IChyZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMiA8PSAoZG9jdW1lbnRfZWxlbWVudC5jbGllbnRIZWlnaHQgfHwgd2luZG93LmlubmVySGVpZ2h0IHx8IDApIC8gMik7CgkJCQl5cG9zID0gYmVsb3cgPyAiYmVsb3ciIDogImFib3ZlIjsKCQkJfQoKCQkJLy8gQ29vcmRpbmF0ZXMKCQkJYWN0aW9ucy5zdHlsZS5tYXhXaWR0aCA9ICIiOwoJCQlpZiAocmlnaHQpIHsKCQkJCXggPSByZWN0LmxlZnQgLSBkZV9yZWN0LmxlZnQ7CgkJCX0KCQkJZWxzZSB7CgkJCQlhY3Rpb25zLnN0eWxlLmxlZnQgPSAiMCI7CgkJCQlhY3Rpb25zLnN0eWxlLm1heFdpZHRoID0gcmVjdC5yaWdodCArICJweCI7CgkJCQl4ID0gcmVjdC5yaWdodCAtIGFjdGlvbnMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggLSBkZV9yZWN0LmxlZnQ7CgkJCX0KCgkJCWFjdGlvbnMuc3R5bGUubGVmdCA9IHggKyAicHgiOwoJCQl0YWcuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWFjdGlvbnMtaHBvcyIsIHhwb3MpOwoJCQlhY3Rpb25zLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1hY3Rpb25zLWhwb3MiLCB4cG9zKTsKCgkJCWlmIChiZWxvdykgewoJCQkJeSA9IHJlY3QuYm90dG9tIC0gZGVfcmVjdC50b3AgLSAwLjA2MjU7CgkJCX0KCQkJZWxzZSB7CgkJCQl5ID0gcmVjdC50b3AgLSBhY3Rpb25zLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAtIGRlX3JlY3QudG9wICsgMC4wNjI1OwoJCQl9CgoJCQlhY3Rpb25zLnN0eWxlLnRvcCA9IHkgKyAicHgiOwoJCQl0YWcuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWFjdGlvbnMtdnBvcyIsIHlwb3MpOwoJCQlhY3Rpb25zLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1hY3Rpb25zLXZwb3MiLCB5cG9zKTsKCQl9OwoJCXZhciB1cGRhdGVfYWN0aXZlX2FjdGlvbnNfcG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBkZV9yZWN0ID0gZG9jdW1lbnRfZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwKCQkJCWluZGV4LCBhY3Rpb25zLCB0YWcsIHRhZ19iZywgeHBvcywgeXBvczsKCgkJCWZvciAoaW5kZXggaW4gYWN0aW9uc19ub2Rlc19hY3RpdmUpIHsKCQkJCWFjdGlvbnMgPSBhY3Rpb25zX25vZGVzX2FjdGl2ZVtpbmRleF07CgkJCQlpZiAoCgkJCQkJKHRhZyA9ICQoIi54bC1zaXRlLXRhZy54bC1zaXRlLXRhZy1hY3RpdmVbeGwtYWN0aW9ucy1pZD0nIiArIGluZGV4ICsgIiddIikpICE9PSBudWxsICYmCgkJCQkJKHRhZ19iZyA9ICQoIi54bC1zaXRlLXRhZy1iZyIsIHRhZykpICE9PSBudWxsCgkJCQkpIHsKCQkJCQl4cG9zID0gYWN0aW9ucy5nZXRBdHRyaWJ1dGUoImRhdGEteGwtYWN0aW9ucy1ocG9zIik7CgkJCQkJeXBvcyA9IGFjdGlvbnMuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLWFjdGlvbnMtdnBvcyIpOwoJCQkJCXVwZGF0ZV9hY3Rpb25zX3Bvc2l0aW9uKGFjdGlvbnMsIHRhZywgdGFnX2JnLCBkZV9yZWN0LCB4cG9zLCB5cG9zKTsKCQkJCX0KCQkJfQoJCX07CgoJCXZhciBvbl9hY3Rpb25zX21lbnVfY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCWV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwoJCQl9CgkJfTsKCQl2YXIgb25fYWN0aW9uc19tZW51X2VudHJ5X2NsaWNrID0gZnVuY3Rpb24gKGFjdGlvbnMsIGlkLCBldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgoJCQkJaWYgKGNvbmZpZy5hY3Rpb25zLmNsb3NlX29uX2NsaWNrKSB7CgkJCQkJY2xvc2VfYWN0aW9uc19tZW51KGFjdGlvbnMsIGlkKTsKCQkJCX0KCQkJfQoJCX07CgkJdmFyIGNsb3NlX2FjdGlvbnNfbWVudSA9IGZ1bmN0aW9uIChhY3Rpb25zLCBpZCkgewoJCQl2YXIgbnMgPSAkJCgiLnhsLXNpdGUtdGFnLnhsLXNpdGUtdGFnLWFjdGl2ZVt4bC1hY3Rpb25zLWlkPSciICsgaWQgKyAiJ10iKSwKCQkJCWksIGlpOwoKCQkJZm9yIChpID0gMCwgaWkgPSBucy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQluc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1zaXRlLXRhZy1hY3RpdmUiKTsKCQkJfQoKCQkJYWN0aW9ucy5jbGFzc0xpc3QuYWRkKCJ4bC1hY3Rpb25zLWhpZGRlbiIpOwoJCQlkZWFjdGl2YXRlX2FjdGlvbnNfbWVudShpZCk7CgkJfTsKCQl2YXIgY2xvc2VfYWxsX2FjdGlvbnNfbWVudXMgPSBmdW5jdGlvbiAoKSB7CgkJCWZvciAodmFyIGlkIGluIGFjdGlvbnNfbm9kZXNfYWN0aXZlKSB7CgkJCQljbG9zZV9hY3Rpb25zX21lbnUoYWN0aW9uc19ub2Rlc19hY3RpdmVbaWRdLCBpZCk7CgkJCX0KCQl9OwoJCXZhciBhY3RpdmF0ZV9hY3Rpb25zX21lbnUgPSBmdW5jdGlvbiAobm9kZSwgaWQpIHsKCQkJaWYgKGNvbmZpZy5hY3Rpb25zLmNsb3NlX29uX2NsaWNrICYmIGFjdGlvbnNfbm9kZXNfYWN0aXZlX2NvdW50ICE9PSAwKSB7CgkJCQljbG9zZV9hbGxfYWN0aW9uc19tZW51cygpOwoJCQl9CgoJCQlhY3Rpb25zX25vZGVzX2FjdGl2ZVtpZF0gPSBub2RlOwoKCQkJaWYgKGFjdGlvbnNfY2xvc2VfdGltZW91dCAhPT0gbnVsbCkgY2xlYXJUaW1lb3V0KGFjdGlvbnNfY2xvc2VfdGltZW91dCk7CgkJCWFjdGlvbnNfY2xvc2VfdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBhY3Rpb25zX2Nsb3NlX3RpbWVvdXQgPSBudWxsOyB9LCAxKTsKCgkJCWlmICgrK2FjdGlvbnNfbm9kZXNfYWN0aXZlX2NvdW50ID09PSAxKSB7CgkJCQkkLm9uKHdpbmRvdywgInJlc2l6ZSIsIG9uX3dpbmRvd19yZXNpemUpOwoJCQkJJC5vbihkb2N1bWVudF9lbGVtZW50LCAiY2xpY2siLCBvbl9kb2N1bWVudF9jbGljayk7CgkJCX0KCQl9OwoJCXZhciBkZWFjdGl2YXRlX2FjdGlvbnNfbWVudSA9IGZ1bmN0aW9uIChpZCkgewoJCQlpZiAoYWN0aW9uc19ub2Rlc19hY3RpdmVbaWRdID09PSB1bmRlZmluZWQpIHJldHVybjsKCgkJCWRlbGV0ZSBhY3Rpb25zX25vZGVzX2FjdGl2ZVtpZF07CgkJCWlmICgtLWFjdGlvbnNfbm9kZXNfYWN0aXZlX2NvdW50ID09PSAwKSB7CgkJCQkkLm9mZih3aW5kb3csICJyZXNpemUiLCBvbl93aW5kb3dfcmVzaXplKTsKCQkJCSQub2ZmKGRvY3VtZW50X2VsZW1lbnQsICJjbGljayIsIG9uX2RvY3VtZW50X2NsaWNrKTsKCQkJCWlmIChhY3Rpb25zX2Nsb3NlX3RpbWVvdXQgIT09IG51bGwpIHsKCQkJCQljbGVhclRpbWVvdXQoYWN0aW9uc19jbG9zZV90aW1lb3V0KTsKCQkJCQlhY3Rpb25zX2Nsb3NlX3RpbWVvdXQgPSBudWxsOwoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgY3JlYXRlX2FjdGlvbnNfbWVudSA9IGZ1bmN0aW9uIChpZCwgZW50cmllcykgewoJCQl2YXIgdGhlbWUgPSBUaGVtZS5jbGFzc2VzLAoJCQkJYWN0aW9ucyA9ICQubm9kZSgiZGl2IiwgInhsLWFjdGlvbnMgeGwtaG92ZXItc2hhZG93IiArIHRoZW1lKSwKCQkJCWNvdW50LCBsYWJlbCwgdGV4dCwgdXJsLCBmbiwgbjEsIG4yLCBuMywgbjQsIG41LCBpLCBpaSwgZTsKCgkJCSQub24oYWN0aW9ucywgImNsaWNrIiwgb25fYWN0aW9uc19tZW51X2NsaWNrKTsKCQkJVGhlbWUuYmcoYWN0aW9ucyk7CgoJCQkkLmFkZChhY3Rpb25zLCBuMSA9ICQubm9kZSgiZGl2IiwgInhsLWFjdGlvbnMtaW5uZXIiICsgdGhlbWUpKTsKCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtYWN0aW9ucy10YWJsZSIgKyB0aGVtZSkpOwoKCQkJZm9yIChpID0gMCwgaWkgPSBlbnRyaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWUgPSBlbnRyaWVzW2ldOwoJCQkJaWYgKGUgPT09IG51bGwpIHsKCQkJCQkvLyBTZXBhcmF0b3IKCQkJCQluMyA9ICQubm9kZSgiZGl2IiwgInhsLWFjdGlvbnMtdGFibGUtcm93IiArIHRoZW1lKTsKCQkJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1hY3Rpb25zLXRhYmxlLWNlbGwiICsgdGhlbWUpKTsKCQkJCQkkLmFkZChuNCwgJC5ub2RlKCJkaXYiLCAieGwtYWN0aW9ucy10YWJsZS1zZXAiKSk7CgkJCQkJJC5hZGQobjIsIG4zKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIEVudHJ5CgkJCQkJbGFiZWwgPSBlLmxhYmVsOwoJCQkJCXRleHQgPSBlLnRleHQ7CgkJCQkJdXJsID0gZS51cmw7CgkJCQkJZm4gPSBlLm1vZGlmeTsKCQkJCQljb3VudCA9IDA7CgoJCQkJCW4zID0gJC5ub2RlKCJkaXYiLCAieGwtYWN0aW9ucy10YWJsZS1yb3ciICsgdGhlbWUpOwoJCQkJCWlmIChsYWJlbCAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWFjdGlvbnMtdGFibGUtY2VsbCB4bC1hY3Rpb25zLXRhYmxlLWNlbGwtbGFiZWwiICsgdGhlbWUpKTsKCQkJCQkJaWYgKHR5cGVvZihsYWJlbCkgPT09ICJzdHJpbmciKSB7CgkJCQkJCQkkLmFkZChuNCwgJC5ub2RlKCJkaXYiLCAieGwtYWN0aW9ucy10YWJsZS1oZWFkZXIiLCBsYWJlbCkpOwoJCQkJCQl9CgkJCQkJCSsrY291bnQ7CgkJCQkJfQoJCQkJCWlmICh0eXBlb2YodGV4dCkgPT09ICJzdHJpbmciKSB7CgkJCQkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWFjdGlvbnMtdGFibGUtY2VsbCIgKyB0aGVtZSkpOwoJCQkJCQlpZiAodHlwZW9mKHVybCkgPT09ICJzdHJpbmciKSB7CgkJCQkJCQkkLmFkZChuNCwgbjUgPSAkLmxpbmsodXJsLCAieGwtYWN0aW9ucy1vcHRpb24iICsgdGhlbWUsIHRleHQpKTsKCQkJCQkJCSQub24objUsICJjbGljayIsICQuYmluZChvbl9hY3Rpb25zX21lbnVfZW50cnlfY2xpY2ssIG41LCBhY3Rpb25zLCBpZCkpOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJzcGFuIiwgInhsLWFjdGlvbnMtb3B0aW9uLXRleHQiICsgdGhlbWUsIHRleHQpKTsKCQkJCQkJfQoJCQkJCQkrK2NvdW50OwoJCQkJCX0KCQkJCQlpZiAoY291bnQgPT09IDEpIHsKCQkJCQkJbjQuY2xhc3NMaXN0LmFkZCgieGwtYWN0aW9ucy10YWJsZS1jZWxsLWZ1bGwiKTsKCQkJCQl9CgoJCQkJCWlmICh0eXBlb2YoZm4pID09PSAiZnVuY3Rpb24iKSB7CgkJCQkJCWZuKG4zKTsKCQkJCQl9CgoJCQkJCSQuYWRkKG4yLCBuMyk7CgkJCQl9CgkJCX0KCgkJCS8vIFByZXBhcmUKCQkJUG9wdXAuaG92ZXJpbmcoYWN0aW9ucyk7CgkJCXJldHVybiBhY3Rpb25zOwoJCX07CgkJdmFyIGVuYWJsZV9hY3Rpb25zX21lbnVfb25fbm9kZSA9IGZ1bmN0aW9uIChub2RlLCBlbmFibGVkLCBpZCwgc2V0dXBfZm4pIHsKCQkJdmFyIGNscyA9ICJ4bC1zaXRlLXRhZy1hY3RpdmUiLAoJCQkJYWN0aW9ucywgdGFnX2JnLCBpbmZvLCBsaW5rOwoKCQkJaWYgKGVuYWJsZWQgIT09IHVuZGVmaW5lZCkgewoJCQkJaWYgKG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKGNscykgPT09IGVuYWJsZWQpIHJldHVybjsKCQkJfQoJCQllbmFibGVkID0gbm9kZS5jbGFzc0xpc3QudG9nZ2xlKGNscyk7CgoJCQlpZiAoZW5hYmxlZCkgewoJCQkJLy8gQ3JlYXRlIGJnCgkJCQl0YWdfYmcgPSAkKCIueGwtc2l0ZS10YWctYmciLCBub2RlKTsKCQkJCWlmICh0YWdfYmcgPT09IG51bGwpIHRhZ19iZyA9IGNyZWF0ZV90YWdfYmcobm9kZSk7CgoJCQkJLy8gU2hvdwoJCQkJYWN0aW9ucyA9IGFjdGlvbnNfbm9kZXNbaWRdOwoJCQkJaWYgKGFjdGlvbnMgIT09IHVuZGVmaW5lZCkgewoJCQkJCWFjdGlvbnMuY2xhc3NMaXN0LnJlbW92ZSgieGwtYWN0aW9ucy1oaWRkZW4iKTsKCQkJCQlQb3B1cC5ob3ZlcmluZyhhY3Rpb25zKTsKCQkJCQlhY3RpdmF0ZV9hY3Rpb25zX21lbnUoYWN0aW9ucywgaWQpOwoKCQkJCQkvLyBQb3NpdGlvbgoJCQkJCXVwZGF0ZV9hY3Rpb25zX3Bvc2l0aW9uKGFjdGlvbnMsIG5vZGUsIHRhZ19iZywgZG9jdW1lbnRfZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkvLyBDcmVhdGUKCQkJCQlpZiAoCgkJCQkJCShsaW5rID0gZ2V0X2xpbmtfZnJvbV9zaXRlX3RhZyhub2RlKSkgIT09IG51bGwgJiYKCQkJCQkJKGluZm8gPSBBUEkuZ2V0X3VybF9pbmZvX3NhdmVkKGxpbmsuaHJlZikpICE9PSBudWxsCgkJCQkJKSB7CgkJCQkJCXNldHVwX2ZuKGluZm8sIGlkLCBmdW5jdGlvbiAoZXJyLCBhY3Rpb25zKSB7CgkJCQkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJCQkJYWN0aW9uc19ub2Rlc1tpZF0gPSBhY3Rpb25zOwoJCQkJCQkJCWFjdGl2YXRlX2FjdGlvbnNfbWVudShhY3Rpb25zLCBpZCk7CgkJCQkJCQkJdXBkYXRlX2FjdGlvbnNfcG9zaXRpb24oYWN0aW9ucywgbm9kZSwgdGFnX2JnLCBkb2N1bWVudF9lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgoJCQkJCQkvLyBBUEkuZ2V0X2RhdGFfZnJvbV91cmxfaW5mbyhpbmZvLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCQkJCQkvLyBpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJCQkJLy8gY3JlYXRlX2FjdGlvbnMoZGF0YSwgaW5mbywgaWQsIGZ1bmN0aW9uIChlcnIsIGFjdGlvbnMpIHsKCQkJCQkJCQkJLy8gaWYgKGVyciA9PT0gbnVsbCkgewoJCQkJCQkJCQkJLy8gYWN0aW9uc19ub2Rlc1tpZF0gPSBhY3Rpb25zOwoJCQkJCQkJCQkJLy8gYWN0aXZhdGVfYWN0aW9uc19tZW51KGFjdGlvbnMsIGlkKTsKCQkJCQkJCQkJCS8vIHVwZGF0ZV9hY3Rpb25zX3Bvc2l0aW9uKGFjdGlvbnMsIG5vZGUsIHRhZ19iZywgZG9jdW1lbnRfZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSk7CgkJCQkJCQkJCS8vIH0KCQkJCQkJCQkvLyB9KTsKCQkJCQkJCS8vIH0KCQkJCQkJLy8gfSk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJLy8gSGlkZQoJCQkJYWN0aW9ucyA9IGFjdGlvbnNfbm9kZXNbaWRdOwoJCQkJaWYgKGFjdGlvbnMgIT09IHVuZGVmaW5lZCkgewoJCQkJCWNsb3NlX2FjdGlvbnNfbWVudShhY3Rpb25zLCBpZCk7CgkJCQl9CgkJCX0KCQl9OwoKCQkvLyBFdmVudHMKCQl2YXIgZXZlbnRfbGlzdGVuZXJzID0gewoJCQlmb3JtYXQ6IFtdCgkJfTsKCQl2YXIgb24gPSBmdW5jdGlvbiAoZXZlbnRfbmFtZSwgY2FsbGJhY2spIHsKCQkJdmFyIGxpc3RlbmVycyA9IGV2ZW50X2xpc3RlbmVyc1tldmVudF9uYW1lXTsKCQkJaWYgKGxpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7CgkJCWxpc3RlbmVycy5wdXNoKGNhbGxiYWNrKTsKCQkJcmV0dXJuIHRydWU7CgkJfTsKCQl2YXIgb2ZmID0gZnVuY3Rpb24gKGV2ZW50X25hbWUsIGNhbGxiYWNrKSB7CgkJCXZhciBsaXN0ZW5lcnMgPSBldmVudF9saXN0ZW5lcnNbZXZlbnRfbmFtZV0sCgkJCQlpLCBpaTsKCQkJaWYgKGxpc3RlbmVycyAhPT0gdW5kZWZpbmVkKSB7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJaWYgKGxpc3RlbmVyc1tpXSA9PT0gY2FsbGJhY2spIHsKCQkJCQkJbGlzdGVuZXJzLnNwbGljZShpLCAxKTsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCXJldHVybiBmYWxzZTsKCQl9OwoJCXZhciB0cmlnZ2VyID0gZnVuY3Rpb24gKGxpc3RlbmVycywgZGF0YSkgewoJCQl2YXIgaSwgaWk7CgkJCWZvciAoaSA9IDAsIGlpID0gbGlzdGVuZXJzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWxpc3RlbmVyc1tpXS5jYWxsKG51bGwsIGRhdGEpOwoJCQl9CgkJfTsKCgkJLy8gUHVibGljCgkJdmFyIGNyZWF0ZV9yYXRpbmdfc3RhcnMgPSBmdW5jdGlvbiAocmF0aW5nKSB7CgkJCXZhciBmcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLAoJCQkJc3RhciwgdG1wLCBpOwoKCQkJcmF0aW5nID0gTWF0aC5yb3VuZChyYXRpbmcgKiAyKTsKCgkJCWZvciAoaSA9IDA7IGkgPCA1OyApIHsKCQkJCXRtcCA9ICQuY2xhbXAocmF0aW5nIC0gKGkgKiAyKSwgMCwgMik7CgkJCQlzdGFyID0gKHRtcCA9PT0gMiA/ICJmdWxsIiA6ICh0bXAgPT09IDEgPyAiaGFsZiIgOiAibm9uZSIpKTsKCQkJCSsraTsKCQkJCSQuYWRkKGZyYWcsICQubm9kZSgiZGl2IiwgInhsLXN0YXIgeGwtc3Rhci0iICsgaSArICIgeGwtc3Rhci0iICsgc3RhcikpOwoJCQl9CgoJCQlyZXR1cm4gZnJhZzsKCQl9OwoJCXZhciBnZXRfc2l0ZV90YWdfdGV4dF9ub2RlID0gZnVuY3Rpb24gKGJ1dHRvbikgewoJCQlyZXR1cm4gKChidXR0b24gPSBidXR0b24ubGFzdENoaWxkKSAhPT0gbnVsbCAmJiBidXR0b24udGFnTmFtZSA9PT0gIlNQQU4iKSA/IGJ1dHRvbiA6IG51bGw7CgkJfTsKCQl2YXIgY3JlYXRlX3NpdGVfdGFnX3RleHQgPSBmdW5jdGlvbiAoaW5mbykgewoJCQlyZXR1cm4gIlsiICsgKGluZm8udGFnIHx8ICI/IikgKyAiXSI7CgkJfTsKCQl2YXIgZm9ybWF0X2RhdGUgPSBmdW5jdGlvbiAodGltZXN0YW1wKSB7CgkJCXZhciBkID0gbmV3IERhdGUodGltZXN0YW1wKTsKCQkJcmV0dXJuIGQuZ2V0VVRDRnVsbFllYXIoKSArICItIiArCgkJCQlwYWQoZC5nZXRVVENNb250aCgpICsgMSwgIi0iKSArCgkJCQlwYWQoZC5nZXRVVENEYXRlKCksICIgIikgKwoJCQkJcGFkKGQuZ2V0VVRDSG91cnMoKSwgIjoiKSArCgkJCQlwYWQoZC5nZXRVVENNaW51dGVzKCksICIiKTsKCQl9OwoKCQl2YXIgcmVzZXR1cF9saW5rID0gZnVuY3Rpb24gKGxpbmspIHsKCQkJQVBJLmdldF91cmxfaW5mbyhsaW5rLmhyZWYgfHwgIiIsIGZ1bmN0aW9uIChlcnIsIGluZm8pIHsKCQkJCWlmIChlcnIgPT09IG51bGwgJiYgaW5mbyAhPT0gbnVsbCkgewoJCQkJCWxvYWRfbGluayhsaW5rLCBpbmZvKTsKCQkJCX0KCQkJfSk7CgkJfTsKCQl2YXIgc2V0dXBfbGluayA9IGZ1bmN0aW9uIChsaW5rLCB1cmwsIGluZm8sIGF1dG9fbG9hZCwgYWRkX3RhZykgewoJCQl2YXIgYnV0dG9uLCB0ZXh0LCBuOwoKCQkJaWYgKGFkZF90YWcpIHsKCQkJCWJ1dHRvbiA9ICQubGluayh1cmwsICJ4bC1zaXRlLXRhZyIgKyBUaGVtZS5jbGFzc2VzKTsKCQkJCXRleHQgPSAkLm5vZGUoInNwYW4iLCAieGwtc2l0ZS10YWctdGV4dCIsIGNyZWF0ZV9zaXRlX3RhZ190ZXh0KGluZm8pKTsKCgkJCQlidXR0b24uc2V0QXR0cmlidXRlKCJkYXRhLXhsLXNpdGUiLCBpbmZvLnNpdGUpOwoJCQkJYnV0dG9uLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1ocmVmIiwgYnV0dG9uLmhyZWYpOwoJCQkJYnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgiaHJlZiIpOwoKCQkJCWlmIChpbmZvLmljb24gIT09IHVuZGVmaW5lZCkgewoJCQkJCSQuYWRkKGJ1dHRvbiwgbiA9ICQubm9kZSgic3BhbiIsICJ4bC1zaXRlLXRhZy1pY29uIiArIFRoZW1lLmNsYXNzZXMpKTsKCQkJCQluLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1zaXRlLXRhZy1pY29uIiwgaW5mby5pY29uKTsKCQkJCX0KCgkJCQkkLmFkZChidXR0b24sIHRleHQpOwoKCQkJCUxpbmtpZmllci5jaGFuZ2VfbGlua19ldmVudHMoYnV0dG9uLCAiZ2FsbGVyeV9mZXRjaCIpOwoKCQkJCSQuYmVmb3JlKGxpbmsucGFyZW50Tm9kZSwgbGluaywgYnV0dG9uKTsKCQkJfQoJCQllbHNlIHsKCQkJCWxpbmsuc2V0QXR0cmlidXRlKCJkYXRhLXhsLW5vLWNvbnRlbnQtdXBkYXRlIiwgInRydWUiKTsKCQkJfQoKCQkJc2V0X25vZGVfaWQobGluaywgaW5mbyk7CgkJCUxpbmtpZmllci5jaGFuZ2VfbGlua19ldmVudHMobGluaywgImdhbGxlcnlfbGluayIpOwoKCQkJaWYgKGF1dG9fbG9hZCkgbG9hZF9saW5rKGxpbmssIGluZm8pOwoJCX07CgkJdmFyIGxvYWRfbGluayA9IGZ1bmN0aW9uIChsaW5rLCBpbmZvKSB7CgkJCUFQSS5nZXRfZGF0YV9mcm9tX3VybF9pbmZvKGluZm8sIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCQkJCWlmIChsaW5rLnBhcmVudE5vZGUgIT09IG51bGwpIHsKCQkJCQlmb3JtYXRfbGlua19nZW5lcmljKGxpbmssIGVyciwgZGF0YSwgaW5mbyk7CgkJCQl9CgkJCX0pOwoJCX07CgkJdmFyIGZvcm1hdF9saW5rX2dlbmVyaWMgPSBmdW5jdGlvbiAobGluaywgZXJyLCBkYXRhLCBpbmZvKSB7CgkJCXZhciBtb25pdG9yID0gKGluZm8ubW9uaXRvciA9PT0gdHJ1ZSkgJiYgQ29uZmlnLmlzXzRjaGFuX3gzLAoJCQkJYXR0cjsKCgkJCS8vIE9ic2VydmVyIGRpc2Nvbm5lY3QgdHJpZ2dlciBvbiByZS1mb3JtYXQKCQkJaWYgKG1vbml0b3IpIHsKCQkJCWF0dHIgPSAiZGF0YS14bC1yZW1vdmUtbW9uaXRvciI7CgkJCQlpZiAobGluay5oYXNBdHRyaWJ1dGUoYXR0cikpIHsKCQkJCQlsaW5rLnNldEF0dHJpYnV0ZShhdHRyLCAiIik7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlsaW5rLnJlbW92ZUF0dHJpYnV0ZShhdHRyKTsKCQkJCX0KCQkJfQoKCQkJLy8gRm9ybWF0CgkJCWlmIChlcnIgPT09IG51bGwpIHsKCQkJCWZvcm1hdF9saW5rKGxpbmssIGRhdGEsIGluZm8pOwoJCQkJaWYgKGV2ZW50X2xpc3RlbmVycy5mb3JtYXQubGVuZ3RoID4gMCkgewoJCQkJCXRyaWdnZXIoZXZlbnRfbGlzdGVuZXJzLmZvcm1hdCwgeyBsaW5rOiBsaW5rIH0pOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJZm9ybWF0X2xpbmtfZXJyb3IobGluaywgZXJyLCBpbmZvKTsKCQkJfQoKCQkJLy8gTW9uaXRvciBjaGFuZ2VzIGZyb20gZXh0ZXJuYWwgc291cmNlcwoJCQlpZiAobW9uaXRvcikgewoJCQkJbGluay5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7CgkJCQluZXcgTXV0YXRpb25PYnNlcnZlcigkLmJpbmQob25fZm9ybWF0dGVyX2xpbmtfY2hhbmdlLCBsaW5rKSkub2JzZXJ2ZShsaW5rLCB7IGNoaWxkTGlzdDogdHJ1ZSwgYXR0cmlidXRlczogdHJ1ZSB9KTsKCQkJfQoJCX07CgkJdmFyIGZvcm1hdF9saW5rID0gZnVuY3Rpb24gKGxpbmssIGRhdGEsIGluZm8pIHsKCQkJdmFyIGJ1dHRvbiA9IGdldF9zaXRlX3RhZ19mcm9tX2xpbmsobGluayksCgkJCQluID0gbnVsbCwKCQkJCXVybCwgaGwsIGMsIG4yOwoKCQkJLy8gU21hcnQgbGlua3MKCQkJaWYgKCh1cmwgPSBBUEkucmV3cml0ZV9saW5rX3NtYXJ0KGxpbmssIGluZm8sIGRhdGEpKSAhPT0gbnVsbCkgewoJCQkJbGluay5ocmVmID0gdXJsOwoJCQkJaWYgKGJ1dHRvbiAhPT0gbnVsbCkgewoJCQkJCWJ1dHRvbi5ocmVmID0gbGluay5ocmVmOwoJCQkJCXVwZGF0ZV9zaXRlX3RhZyhidXR0b24sIGluZm8pOwoJCQkJfQoJCQl9CgoJCQkvLyBDbGFzcyBjaGFuZ2VzCgkJCWhsID0gaW5mby5jbGFzc2VzX3JlbW92ZTsKCQkJaWYgKGhsICE9PSB1bmRlZmluZWQgJiYgQXJyYXkuaXNBcnJheShobCkpIHsKCQkJCWxpbmsuY2xhc3NMaXN0LnJlbW92ZS5hcHBseShsaW5rLmNsYXNzTGlzdCwgaGwpOwoJCQl9CgkJCWhsID0gaW5mby5jbGFzc2VzX2FkZDsKCQkJaWYgKGhsICE9PSB1bmRlZmluZWQgJiYgQXJyYXkuaXNBcnJheShobCkpIHsKCQkJCWxpbmsuY2xhc3NMaXN0LmFkZC5hcHBseShsaW5rLmNsYXNzTGlzdCwgaGwpOwoJCQl9CgoJCQkvLyBMaW5rIHRpdGxlCgkJCWlmIChsaW5rLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1uby1jb250ZW50LXVwZGF0ZSIpICE9PSAidHJ1ZSIpIHsKCQkJCW4gPSAkLm5vZGUoInNwYW4iLCAieGwtbGluay1pbm5lciIsIGRhdGEudGl0bGUpOwoJCQkJbGluay50ZXh0Q29udGVudCA9ICIiOwoJCQkJJC5hZGQobGluaywgbik7CgkJCQlsaW5rLmNsYXNzTGlzdC5hZGQoInhsLWxpbmstZm9ybWF0dGVkIik7CgkJCX0KCgkJCS8vIEJ1dHRvbgoJCQlpZiAoYnV0dG9uICE9PSBudWxsICYmIG4gIT09IG51bGwpIHsKCQkJCWhsID0gRmlsdGVyLmNoZWNrKG4sIGRhdGEpOwoJCQkJaWYgKGhsWzBdICE9PSBGaWx0ZXIuTm9uZSkgewoJCQkJCWMgPSAoaGxbMF0gPT09IEZpbHRlci5Hb29kKSA/IGNvbmZpZy5maWx0ZXIuZ29vZF90YWdfbWFya2VyIDogY29uZmlnLmZpbHRlci5iYWRfdGFnX21hcmtlcjsKCQkJCQltYXJrX3NpdGVfdGFnKGJ1dHRvbiwgYyk7CgkJCQkJRmlsdGVyLmhpZ2hsaWdodF90YWcoYnV0dG9uLCBsaW5rLCBobCk7CgkJCQl9CgkJCQlMaW5raWZpZXIuY2hhbmdlX2xpbmtfZXZlbnRzKGJ1dHRvbiwgImdhbGxlcnlfdGFnIik7CgkJCX0KCgkJCS8vIFVSTCBub2RlCgkJCWlmIChDb25maWcuaXNfNGNoYW4gJiYgIUNvbmZpZy5pc180Y2hhbl94MykgewoJCQkJLy8gVGhpcyBpcyBmb3IgY2VydGFpbiA0Y2hhbi1pbmxpbmUgZnVuY3Rpb25hbGl0eSAoeW91dHViZSAiRW1iZWQiIGxpbmsgaG92ZXIgaW1hZ2UgcHJldmlldykKCQkJCW4yID0gJC5ub2RlKCJzcGFuIiwgInhsLWxpbmstdXJsLXRleHQiLCAiICIgKyBsaW5rLmhyZWYgKyAiICIpOwoJCQkJJC5iZWZvcmUobGluaywgbGluay5maXJzdENoaWxkLCBuMik7CgkJCX0KCgkJCS8vIFBhZ2UKCQkJaWYgKG4gIT09IG51bGwpIHsKCQkJCWlmIChpbmZvLnBhZ2UgIT09IHVuZGVmaW5lZCkgewoJCQkJCW4yID0gJC5ub2RlKCJzcGFuIiwgInhsLWxpbmstcGFnZSIsICIgKHBhZ2UgIiArIGluZm8ucGFnZSArICIpIik7CgkJCQkJJC5hZGQobiwgbjIpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaW5mby50aXRsZV9leHRyYSAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJbjIgPSAkLm5vZGUoInNwYW4iLCAieGwtbGluay1leHRyYSIsICIgIiArIGluZm8udGl0bGVfZXh0cmEpOwoJCQkJCSQuYWRkKG4sIG4yKTsKCQkJCX0KCQkJfQoJCX07CgkJdmFyIGZvcm1hdF9saW5rX2Vycm9yID0gZnVuY3Rpb24gKGxpbmssIGVycm9yKSB7CgkJCXZhciBidXR0b24gPSBnZXRfc2l0ZV90YWdfZnJvbV9saW5rKGxpbmspLAoJCQkJdGV4dCwgbiwgbjI7CgoJCQlpZiAoYnV0dG9uICE9PSBudWxsKSB7CgkJCQlMaW5raWZpZXIuY2hhbmdlX2xpbmtfZXZlbnRzKGJ1dHRvbiwgImdhbGxlcnlfZXJyb3IiKTsKCQkJCWJ1dHRvbi5jbGFzc0xpc3QuYWRkKCJ4bC1saW5rLWVycm9yIik7CgkJCX0KCgkJCWxpbmsuY2xhc3NMaXN0LmFkZCgieGwtbGluay1mb3JtYXR0ZWQiLCAieGwtbGluay1lcnJvciIpOwoKCQkJaWYgKGxpbmsuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLW5vLWNvbnRlbnQtdXBkYXRlIikgIT09ICJ0cnVlIikgewoJCQkJdGV4dCA9ICIgKCIgKyBlcnJvci50cmltKCkucmVwbGFjZSgvXC4kLywgIiIpICsgIikiOwoKCQkJCW4gPSAkLm5vZGUoInNwYW4iLCAieGwtbGluay1pbm5lciIpOwoJCQkJd2hpbGUgKGxpbmsuZmlyc3RDaGlsZCAhPT0gbnVsbCkgewoJCQkJCSQuYWRkKG4sIGxpbmsuZmlyc3RDaGlsZCk7CgkJCQl9CgkJCQkkLmFkZChsaW5rLCBuKTsKCgkJCQluMiA9ICQoIi54bC1saW5rLWVycm9yLW1lc3NhZ2UiLCBsaW5rKTsKCQkJCWlmIChuMiA9PT0gbnVsbCkgewoJCQkJCSQuYWRkKG4sIG4yID0gJC5ub2RlKCJzcGFuIiwgInhsLWxpbmstZXJyb3ItbWVzc2FnZSIsIHRleHQpKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCW4yLnRleHRDb250ZW50ID0gdGV4dDsKCQkJCX0KCQkJCW4yLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1lcnJvci1tZXNzYWdlIiwgdGV4dCk7CgkJCX0KCQl9OwoJCXZhciBnZXRfbGlua3NfZm9ybWF0dGVkID0gZnVuY3Rpb24gKHBhcmVudCkgewoJCQlyZXR1cm4gJCQoImEueGwtbGluay54bC1saW5rLWZvcm1hdHRlZCIsIHBhcmVudCk7CgkJfTsKCQl2YXIgb25fZm9ybWF0dGVyX2xpbmtfY2hhbmdlID0gZnVuY3Rpb24gKHJlY29yZHMsIG1vKSB7CgkJCXZhciBjaGFuZ2UgPSBmYWxzZSwKCQkJCWluZm8sIHIsIGksIGlpOwoKCQkJZm9yIChpID0gMCwgaWkgPSByZWNvcmRzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCXIgPSByZWNvcmRzW2ldOwoJCQkJaWYgKHIudHlwZSA9PT0gImF0dHJpYnV0ZXMiKSB7CgkJCQkJaWYgKHIuYXR0cmlidXRlTmFtZSA9PT0gImRhdGEteGwtcmVtb3ZlLW1vbml0b3IiKSB7CgkJCQkJCW1vLmRpc2Nvbm5lY3QoKTsKCQkJCQkJcmV0dXJuOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UgewoJCQkJCWNoYW5nZSA9IHRydWU7CgkJCQl9CgkJCX0KCgkJCWlmICgKCQkJCWNoYW5nZSAmJgoJCQkJKGluZm8gPSBBUEkuZ2V0X3VybF9pbmZvX3NhdmVkKHRoaXMuaHJlZikpICE9PSBudWxsCgkJCSkgewoJCQkJLy8gTGltaXQgbW9uaXRvcmluZyB0byBvbmx5IG9uY2UKCQkJCWluZm8ubW9uaXRvciA9IGZhbHNlOwoJCQkJbW8uZGlzY29ubmVjdCgpOwoJCQkJbG9hZF9saW5rKHRoaXMsIGluZm8pOwoJCQl9CgkJfTsKCgkJdmFyIGNsZWFudXBfcG9zdCA9IGZ1bmN0aW9uIChwb3N0KSB7CgkJCXZhciBub2RlcywgbiwgaSwgaWk7CgkJCW5vZGVzID0gJCQoIi54bC1leHNhdWNlLXJlc3VsdHM6bm90KC54bC1leHNhdWNlLXJlc3VsdHMtaGlkZGVuKSIsIHBvc3QpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCW5vZGVzW2ldLmNsYXNzTGlzdC5hZGQoInhsLWV4c2F1Y2UtcmVzdWx0cy1oaWRkZW4iKTsKCQkJfQoJCQlub2RlcyA9ICQkKCIueGwtYWN0aW9uczpub3QoLnhsLWFjdGlvbnMtaGlkZGVuKSIsIHBvc3QpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCW5vZGVzW2ldLmNsYXNzTGlzdC5hZGQoInhsLWFjdGlvbnMtaGlkZGVuIik7CgkJCX0KCQkJbm9kZXMgPSAkJCgiLnhsLXNpdGUtdGFnW3hsLWFjdGlvbnMtaWRdIiwgcG9zdCk7CgkJCWZvciAoaSA9IDAsIGlpID0gbm9kZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJbiA9IG5vZGVzW2ldOwoJCQkJbi5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1zaXRlLXRhZy1hY3RpdmUiKTsKCQkJCW4ucmVtb3ZlQXR0cmlidXRlKCJ4bC1hY3Rpb25zLWlkIik7CgkJCX0KCQkJbm9kZXMgPSAkJCgiLnhsLWxpbmtpZmllZDpub3QoLnhsLWxpbmstZm9ybWF0dGVkKSIsIHBvc3QpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCXJlc2V0dXBfbGluayhub2Rlc1tpXSk7CgkJCX0KCQl9OwoJCXZhciBjbGVhbnVwX3Bvc3RfcmVtb3ZlZCA9IGZ1bmN0aW9uIChwb3N0KSB7CgkJCXZhciBub2RlcywgaW5kZXgsIG4sIGksIGlpOwoJCQlub2RlcyA9ICQkKCIueGwtc2l0ZS10YWdbeGwtYWN0aW9ucy1pZF0iLCBwb3N0KTsKCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlpbmRleCA9IG5vZGVzW2ldLmdldEF0dHJpYnV0ZSgieGwtYWN0aW9ucy1pZCIpIHx8ICIiOwoJCQkJbiA9IGFjdGlvbnNfbm9kZXNbaW5kZXhdOwoJCQkJaWYgKG4gIT09IHVuZGVmaW5lZCkgewoJCQkJCWlmIChuLnBhcmVudE5vZGUgIT09IG51bGwpICQucmVtb3ZlKG4pOwoJCQkJCWRlbGV0ZSBhY3Rpb25zX25vZGVzW2luZGV4XTsKCQkJCQlkZWFjdGl2YXRlX2FjdGlvbnNfbWVudShpbmRleCk7CgkJCQl9CgkJCX0KCQl9OwoKCQl2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHsKCQkJTGlua2lmaWVyLnJlZ2lzdGVyX2xpbmtfZXZlbnRzKHsKCQkJCWdhbGxlcnlfbGluazogZ2FsbGVyeV9saW5rX2V2ZW50cywKCQkJCWdhbGxlcnlfdGFnOiBnYWxsZXJ5X3RhZ19ldmVudHMsCgkJCQlnYWxsZXJ5X2ZldGNoOiBnYWxsZXJ5X2ZldGNoX2V2ZW50LAoJCQkJZ2FsbGVyeV9lcnJvcjogZ2FsbGVyeV9lcnJvcl9ldmVudAoJCQl9KTsKCQl9OwoKCQl2YXIgc3RyaW5ncyA9IHsKCQkJdGh1bWJuYWlsX2ZhaWxlZDogIlRodW1ibmFpbCBmYWlsZWQgdG8gbG9hZFxuXG5UaGlzIG1heSBiZSBkdWUgdG8gYW4gZXh0ZW5zaW9uIGNvbmZsaWN0IC0gY2hlY2sgYW55IGFkYmxvY2tlciBvciBzaW1pbGFyIGV4dGVuc2lvbnMgdGhhdCBhcmUgaW5zdGFsbGVkIgoJCX07CgoJCS8vIEV4cG9ydHMKCQlyZXR1cm4gewoJCQlzZXR1cF9saW5rOiBzZXR1cF9saW5rLAoJCQlnZXRfbGlua3NfZm9ybWF0dGVkOiBnZXRfbGlua3NfZm9ybWF0dGVkLAoJCQljcmVhdGVfcmF0aW5nX3N0YXJzOiBjcmVhdGVfcmF0aW5nX3N0YXJzLAoJCQlnZXRfc2l0ZV90YWdfdGV4dF9ub2RlOiBnZXRfc2l0ZV90YWdfdGV4dF9ub2RlLAoJCQljcmVhdGVfc2l0ZV90YWdfdGV4dDogY3JlYXRlX3NpdGVfdGFnX3RleHQsCgkJCWZvcm1hdF9kYXRlOiBmb3JtYXRfZGF0ZSwKCQkJY2xlYW51cF9wb3N0OiBjbGVhbnVwX3Bvc3QsCgkJCWNsZWFudXBfcG9zdF9yZW1vdmVkOiBjbGVhbnVwX3Bvc3RfcmVtb3ZlZCwKCQkJcmVnaXN0ZXJfZGV0YWlsc19jcmVhdGlvbjogcmVnaXN0ZXJfZGV0YWlsc19jcmVhdGlvbiwKCQkJcmVnaXN0ZXJfYWN0aW9uc19jcmVhdGlvbjogcmVnaXN0ZXJfYWN0aW9uc19jcmVhdGlvbiwKCQkJaW5pdDogaW5pdCwKCQkJb246IG9uLAoJCQlvZmY6IG9mZiwKCQkJc3RyaW5nczogc3RyaW5ncwoJCX07CgoJfSkoKTsKCXZhciBBUEkgPSAoZnVuY3Rpb24gKCkgewoKCQkvLyBDYWNoaW5nCgkJdmFyIGNhY2hlX3ByZWZpeCA9ICJ4bGlua3MtY2FjaGUtIiwKCQkJY2FjaGVfc3RvcmFnZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UsCgkJCWNhY2hlX29iamVjdHMgPSB7CgkJCQltZDVfdG9faGFzaDoge30sCgkJCQl1cmxfdG9faGFzaDoge30sCgkJCQlsb29rdXA6IHt9LAoJCQkJZXJyb3JzOiB7fQoJCQl9LAoJCQl0dGxfMV9ob3VyID0gNjAgKiA2MCAqIDEwMDAsCgkJCXR0bF8xX2RheSA9IDI0ICogdHRsXzFfaG91ciwKCQkJdHRsXzFfeWVhciA9IDM2NSAqIHR0bF8xX2RheTsKCgkJdmFyIGNhY2hlX3NldCA9IGZ1bmN0aW9uIChrZXksIGRhdGEsIHR0bCkgewoJCQljYWNoZV9zdG9yYWdlLnNldEl0ZW0oY2FjaGVfcHJlZml4ICsga2V5LCBKU09OLnN0cmluZ2lmeSh7CgkJCQlleHBpcmVzOiBEYXRlLm5vdygpICsgdHRsLAoJCQkJZGF0YTogZGF0YQoJCQl9KSk7CgkJfTsKCQl2YXIgY2FjaGVfZ2V0ID0gZnVuY3Rpb24gKGtleSkgewoJCQl2YXIganNvbiA9ICQuanNvbl9wYXJzZV9zYWZlKGNhY2hlX3N0b3JhZ2UuZ2V0SXRlbShjYWNoZV9wcmVmaXggKyBrZXkpLCBudWxsKTsKCgkJCWlmICgKCQkJCWpzb24gIT09IG51bGwgJiYKCQkJCXR5cGVvZihqc29uKSA9PT0gIm9iamVjdCIgJiYKCQkJCURhdGUubm93KCkgPCBqc29uLmV4cGlyZXMgJiYKCQkJCXR5cGVvZihqc29uLmRhdGEpID09PSAib2JqZWN0IgoJCQkpIHsKCQkJCXJldHVybiBqc29uLmRhdGE7CgkJCX0KCgkJCWNhY2hlX3N0b3JhZ2UucmVtb3ZlSXRlbShrZXkpOwoJCQlyZXR1cm4gbnVsbDsKCQl9OwoJCXZhciBjYWNoZV9zZXRfb2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdF9uYW1lKSB7CgkJCWNhY2hlX3N0b3JhZ2Uuc2V0SXRlbShjYWNoZV9wcmVmaXggKyBvYmplY3RfbmFtZSwgSlNPTi5zdHJpbmdpZnkoewoJCQkJZXhwaXJlczogbnVsbCwKCQkJCWRhdGE6IGNhY2hlX29iamVjdHNbb2JqZWN0X25hbWVdCgkJCX0pKTsKCQl9OwoJCXZhciBjYWNoZV9nZXRfb2JqZWN0ID0gZnVuY3Rpb24gKG9iamVjdF9uYW1lKSB7CgkJCXZhciBqc29uID0gJC5qc29uX3BhcnNlX3NhZmUoY2FjaGVfc3RvcmFnZS5nZXRJdGVtKGNhY2hlX3ByZWZpeCArIG9iamVjdF9uYW1lKSwgbnVsbCksCgkJCQlvYmosIHRhcmdldDsKCgkJCWlmICgKCQkJCWpzb24gIT09IG51bGwgJiYKCQkJCXR5cGVvZihqc29uKSA9PT0gIm9iamVjdCIgJiYKCQkJCShvYmogPSBqc29uLmRhdGEpICE9PSBudWxsICYmCgkJCQl0eXBlb2Yob2JqKSA9PT0gIm9iamVjdCIKCQkJKSB7CgkJCQl0YXJnZXQgPSBjYWNoZV9vYmplY3RzW29iamVjdF9uYW1lXTsKCQkJCXJldHVybiBjYWNoZV9tZXJnZV9vYmplY3RzKHRhcmdldCwgb2JqKTsKCQkJfQoKCQkJY2FjaGVfc3RvcmFnZS5yZW1vdmVJdGVtKG9iamVjdF9uYW1lKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX07CgkJdmFyIGNhY2hlX21lcmdlX29iamVjdHMgPSBmdW5jdGlvbiAoZGVzdCwgb2JqKSB7CgkJCXZhciBub3cgPSBEYXRlLm5vdygpLAoJCQkJdXBkYXRlID0gZmFsc2UsCgkJCQllbnRyeSwgazsKCgkJCWZvciAoayBpbiBvYmopIHsKCQkJCWVudHJ5ID0gb2JqW2tdOwoJCQkJaWYgKG5vdyA8IGVudHJ5LmV4cGlyZXMpIHsKCQkJCQlkZXN0W2tdID0gZW50cnk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQl1cGRhdGUgPSB0cnVlOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gdXBkYXRlOwoJCX07CgkJdmFyIGNhY2hlX2NsZWFudXAgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBzdG9yYWdlID0gY2FjaGVfc3RvcmFnZSwKCQkJCXJlbW92ZXMgPSBbXSwKCQkJCXRpbWUgPSBEYXRlLm5vdygpLAoJCQkJa2V5LCBqc29uLCBpLCBpaTsKCgkJCWZvciAoaSA9IDAsIGlpID0gc3RvcmFnZS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlrZXkgPSBzdG9yYWdlLmtleShpKTsKCQkJCWlmIChrZXkubGVuZ3RoID49IGNhY2hlX3ByZWZpeC5sZW5ndGggJiYga2V5LnN1YnN0cigwLCBjYWNoZV9wcmVmaXgubGVuZ3RoKSA9PT0gY2FjaGVfcHJlZml4KSB7CgkJCQkJanNvbiA9ICQuanNvbl9wYXJzZV9zYWZlKHN0b3JhZ2UuZ2V0SXRlbShrZXkpLCBudWxsKTsKCQkJCQlpZiAoanNvbiA9PT0gbnVsbCB8fCB0eXBlb2YoanNvbikgIT09ICJvYmplY3QiKSB7CgkJCQkJCS8vIEludmFsaWQKCQkJCQkJcmVtb3Zlcy5wdXNoKGtleSk7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKGpzb24uZXhwaXJlcyAhPT0gbnVsbCAmJiAhKHRpbWUgPCBqc29uLmV4cGlyZXMpKSB7IC8vIGpzaGludCBpZ25vcmU6bGluZQoJCQkJCQkvLyBUaGlzIHNob3VsZCBhbHNvIGNvdmVyIHVuZGVmaW5lZCB2YWx1ZXMKCQkJCQkJcmVtb3Zlcy5wdXNoKGtleSk7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlmb3IgKGkgPSAwLCBpaSA9IHJlbW92ZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJc3RvcmFnZS5yZW1vdmVJdGVtKHJlbW92ZXNbaV0pOwoJCQl9CgoJCQlyZXR1cm4gaWk7CgkJfTsKCQl2YXIgY2FjaGVfY2xlYXIgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBzdG9yYWdlX3R5cGVzID0gWyB3aW5kb3cubG9jYWxTdG9yYWdlLCB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UgXSwKCQkJCXJlbW92ZXMgPSBbXSwKCQkJCWNvdW50ID0gMCwKCQkJCXN0b3JhZ2UsIGtleSwgaSwgaWksIGosIGpqOwoKCQkJZm9yIChpID0gMCwgaWkgPSBzdG9yYWdlX3R5cGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCXN0b3JhZ2UgPSBzdG9yYWdlX3R5cGVzW2ldOwoKCQkJCWZvciAoaiA9IDAsIGpqID0gc3RvcmFnZS5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJa2V5ID0gc3RvcmFnZS5rZXkoaik7CgkJCQkJaWYgKGtleS5sZW5ndGggPj0gY2FjaGVfcHJlZml4Lmxlbmd0aCAmJiBrZXkuc3Vic3RyKDAsIGNhY2hlX3ByZWZpeC5sZW5ndGgpID09PSBjYWNoZV9wcmVmaXgpIHsKCQkJCQkJcmVtb3Zlcy5wdXNoKGtleSk7CgkJCQkJfQoJCQkJfQoKCQkJCWZvciAoaiA9IDAsIGpqID0gcmVtb3Zlcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJc3RvcmFnZS5yZW1vdmVJdGVtKHJlbW92ZXNbal0pOwoJCQkJfQoJCQkJY291bnQgKz0gamo7CgkJCX0KCgkJCXJldHVybiBjb3VudDsKCQl9OwoJCXZhciBjYWNoZV9pbml0ID0gZnVuY3Rpb24gKCkgewoJCQkvLyBDYWNoZSBtb2RlCgkJCWlmIChjb25maWcuZGVidWcuY2FjaGVfbW9kZSA9PT0gIm5vbmUiKSB7CgkJCQljYWNoZV9zdG9yYWdlID0gY3JlYXRlX3RlbXBfc3RvcmFnZSgpOwoJCQl9CgkJCWVsc2UgaWYgKGNvbmZpZy5kZWJ1Zy5jYWNoZV9tb2RlID09PSAic2Vzc2lvbiIpIHsKCQkJCWNhY2hlX3N0b3JhZ2UgPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2U7CgkJCX0KCgkJCS8vIENsZWFuCgkJCWNhY2hlX2NsZWFudXAoKTsKCgkJCS8vIExvYWQKCQkJdmFyIGs7CgkJCWZvciAoayBpbiBjYWNoZV9vYmplY3RzKSB7CgkJCQlpZiAoY2FjaGVfZ2V0X29iamVjdChrKSkgewoJCQkJCWNhY2hlX3NldF9vYmplY3Qoayk7CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBjYWNoZV9nZXRfcHJlZml4ID0gZnVuY3Rpb24gKCkgewoJCQlyZXR1cm4gY2FjaGVfcHJlZml4OwoJCX07CgoJCXZhciBjcmVhdGVfdGVtcF9zdG9yYWdlID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgZGF0YSA9IHt9OwoKCQkJdmFyIGZuID0gewoJCQkJbGVuZ3RoOiAwLAoJCQkJa2V5OiBmdW5jdGlvbiAoaW5kZXgpIHsKCQkJCQlyZXR1cm4gT2JqZWN0LmtleXMoZGF0YSlbaW5kZXhdOwoJCQkJfSwKCQkJCWdldEl0ZW06IGZ1bmN0aW9uIChrZXkpIHsKCQkJCQlpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGEsIGtleSkpIHsKCQkJCQkJcmV0dXJuIGRhdGFba2V5XTsKCQkJCQl9CgkJCQkJcmV0dXJuIG51bGw7CgkJCQl9LAoJCQkJc2V0SXRlbTogZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKCQkJCQlpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7CgkJCQkJCSsrZm4ubGVuZ3RoOwoJCQkJCX0KCQkJCQlkYXRhW2tleV0gPSB2YWx1ZTsKCQkJCX0sCgkJCQlyZW1vdmVJdGVtOiBmdW5jdGlvbiAoa2V5KSB7CgkJCQkJaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhLCBrZXkpKSB7CgkJCQkJCWRlbGV0ZSBkYXRhW2tleV07CgkJCQkJCS0tZm4ubGVuZ3RoOwoJCQkJCX0KCQkJCX0sCgkJCQljbGVhcjogZnVuY3Rpb24gKCkgewoJCQkJCWRhdGEgPSB7fTsKCQkJCQlmbi5sZW5ndGggPSAwOwoJCQkJfQoJCQl9OwoKCQkJcmV0dXJuIGZuOwoJCX07CgoKCgkJLy8gRGF0YWJhc2luZwoJCXZhciBzYXZlZF9kYXRhID0ge307CgkJdmFyIHNhdmVkX3RodW1ibmFpbHMgPSB7fTsKCgkJdmFyIGdldF9zYXZlZF9kYXRhID0gZnVuY3Rpb24gKGlkKSB7CgkJCXZhciBkYXRhID0gc2F2ZWRfZGF0YVtpZF07CgoJCQlpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gZGF0YTsKCgkJCWRhdGEgPSBjYWNoZV9nZXQoImRhdGEtIiArIGlkKTsKCQkJaWYgKGRhdGEgIT09IG51bGwpIHsKCQkJCXNhdmVkX2RhdGFbaWRdID0gZGF0YTsKCQkJCXJldHVybiBkYXRhOwoJCQl9CgoJCQlyZXR1cm4gbnVsbDsKCQl9OwoJCXZhciBzZXRfc2F2ZWRfZGF0YSA9IGZ1bmN0aW9uIChpZCwgZGF0YSkgewoJCQlzYXZlZF9kYXRhW2lkXSA9IGRhdGE7CgkJCWNhY2hlX3NldCgiZGF0YS0iICsgaWQsIGRhdGEsIHR0bF8xX2hvdXIgKiAoZGF0YS5kYXRlX2NyZWF0ZWQgPj0gRGF0ZS5ub3coKSAtIHR0bF8xX2RheSA/IDEgOiAxMikpOwoJCX07CgkJdmFyIHNldF9zYXZlZF9lcnJvciA9IGZ1bmN0aW9uIChpZF9saXN0LCBlcnJvciwgY2FjaGUpIHsKCQkJdmFyIGlkID0gaWRfbGlzdC5qb2luKCItIik7CgkJCWNhY2hlX29iamVjdHMuZXJyb3JzW2lkXSA9IHsKCQkJCWV4cGlyZXM6IChjYWNoZSA/IERhdGUubm93KCkgKyB0dGxfMV9ob3VyICogMTIgOiAwKSwKCQkJCWRhdGE6IGVycm9yCgkJCX07CgoJCQlpZiAoY2FjaGUpIHsKCQkJCWNhY2hlX3NldF9vYmplY3QoImVycm9ycyIpOwoJCQl9CgkJfTsKCQl2YXIgZ2V0X3NhdmVkX2Vycm9yID0gZnVuY3Rpb24gKGlkX2xpc3QpIHsKCQkJdmFyIGlkID0gaWRfbGlzdC5qb2luKCItIiksCgkJCQl2YWx1ZSA9IGNhY2hlX29iamVjdHMuZXJyb3JzW2lkXTsKCgkJCXJldHVybiAodmFsdWUgIT09IHVuZGVmaW5lZCkgPyB2YWx1ZS5kYXRhIDogbnVsbDsKCQl9OwoJCXZhciBnZXRfc2F2ZWRfdGh1bWJuYWlsID0gZnVuY3Rpb24gKG5hbWVzcGFjZSwgZ2lkLCBwYWdlKSB7CgkJCXZhciBpZF9mdWxsID0gbmFtZXNwYWNlICsgIi0iICsgZ2lkICsgIi0iICsgcGFnZSwKCQkJCWRhdGEgPSBzYXZlZF90aHVtYm5haWxzW2lkX2Z1bGxdOwoKCQkJaWYgKGRhdGEgIT09IHVuZGVmaW5lZCkgcmV0dXJuIGRhdGE7CgoJCQlkYXRhID0gY2FjaGVfZ2V0KCJ0aHVtYi0iICsgaWRfZnVsbCk7CgkJCWlmIChkYXRhICE9PSBudWxsKSB7CgkJCQlzYXZlZF90aHVtYm5haWxzW2lkX2Z1bGxdID0gZGF0YTsKCQkJCXJldHVybiBkYXRhOwoJCQl9CgoJCQlyZXR1cm4gbnVsbDsKCQl9OwoJCXZhciBzZXRfc2F2ZWRfdGh1bWJuYWlsID0gZnVuY3Rpb24gKG5hbWVzcGFjZSwgZ2lkLCBwYWdlLCBkYXRhKSB7CgkJCXZhciBpZF9mdWxsID0gbmFtZXNwYWNlICsgIi0iICsgZ2lkICsgIi0iICsgcGFnZTsKCQkJc2F2ZWRfdGh1bWJuYWlsc1tpZF9mdWxsXSA9IGRhdGE7CgkJCWNhY2hlX3NldCgidGh1bWItIiArIGlkX2Z1bGwsIGRhdGEsIHR0bF8xX2hvdXIgKiA2KTsKCQl9OwoKCQl2YXIgaGFzaF9nZXRfc2hhMV9mcm9tX21kNSA9IGZ1bmN0aW9uIChtZDUpIHsKCQkJdmFyIHZhbHVlID0gY2FjaGVfb2JqZWN0cy5tZDVfdG9faGFzaFttZDVdOwoJCQlyZXR1cm4gKHZhbHVlICE9PSB1bmRlZmluZWQpID8gdmFsdWUuZGF0YSA6IG51bGw7CgkJfTsKCQl2YXIgaGFzaF9nZXRfc2hhMV9mcm9tX3VybCA9IGZ1bmN0aW9uICh1cmwpIHsKCQkJdmFyIHZhbHVlID0gY2FjaGVfb2JqZWN0cy51cmxfdG9faGFzaFt1cmxdOwoJCQlyZXR1cm4gKHZhbHVlICE9PSB1bmRlZmluZWQpID8gdmFsdWUuZGF0YSA6IG51bGw7CgkJfTsKCQl2YXIgaGFzaF9zZXRfbWQ1X3RvX3NoYTEgPSBmdW5jdGlvbiAobWQ1LCBzaGExKSB7CgkJCWNhY2hlX29iamVjdHMubWQ1X3RvX2hhc2hbbWQ1XSA9IHsKCQkJCWV4cGlyZXM6IERhdGUubm93KCkgKyB0dGxfMV95ZWFyLAoJCQkJZGF0YTogc2hhMQoJCQl9OwoKCQkJY2FjaGVfc2V0X29iamVjdCgibWQ1X3RvX2hhc2giKTsKCQl9OwoJCXZhciBoYXNoX3NldF91cmxfdG9fc2hhMSA9IGZ1bmN0aW9uICh1cmwsIHNoYTEpIHsKCQkJY2FjaGVfb2JqZWN0cy51cmxfdG9faGFzaFt1cmxdID0gewoJCQkJZXhwaXJlczogRGF0ZS5ub3coKSArIHR0bF8xX2RheSwKCQkJCWRhdGE6IHNoYTEKCQkJfTsKCgkJCWNhY2hlX3NldF9vYmplY3QoInVybF90b19oYXNoIik7CgkJfTsKCgkJdmFyIGxvb2t1cF9nZXRfcmVzdWx0cyA9IGZ1bmN0aW9uIChoYXNoKSB7CgkJCXZhciB2YWx1ZSA9IGNhY2hlX29iamVjdHMubG9va3VwW2hhc2hdOwoJCQlyZXR1cm4gKHZhbHVlICE9PSB1bmRlZmluZWQpID8gdmFsdWUuZGF0YSA6IG51bGw7CgkJfTsKCQl2YXIgbG9va3VwX3NldF9yZXN1bHRzID0gZnVuY3Rpb24gKGRhdGEpIHsKCQkJY2FjaGVfb2JqZWN0cy5sb29rdXBbZGF0YS5oYXNoXSA9IHsKCQkJCWV4cGlyZXM6IERhdGUubm93KCkgKyB0dGxfMV9kYXksCgkJCQlkYXRhOiBkYXRhCgkJCX07CgoJCQljYWNoZV9zZXRfb2JqZWN0KCJsb29rdXAiKTsKCQl9OwoKCgoJCS8vIENhdGVnb3JpZXMKCQl2YXIgY2F0ZWdvcmllcyA9IHsKCQkJYXJ0aXN0Y2c6ICB7IHNvcnQ6IDAsICBjb2xvcl9pZDogMywgc2hvcnRfbmFtZTogImFydGlzdGNnIiwgIG5hbWU6ICJBcnRpc3QgQ0ciIH0sCgkJCWFzaWFucG9ybjogeyBzb3J0OiAxLCAgY29sb3JfaWQ6IDksIHNob3J0X25hbWU6ICJhc2lhbnBvcm4iLCBuYW1lOiAiQXNpYW4gUG9ybiIgfSwKCQkJY29zcGxheTogICB7IHNvcnQ6IDIsICBjb2xvcl9pZDogOCwgc2hvcnRfbmFtZTogImNvc3BsYXkiLCAgIG5hbWU6ICJDb3NwbGF5IiB9LAoJCQlkb3VqaW5zaGk6IHsgc29ydDogMywgIGNvbG9yX2lkOiAxLCBzaG9ydF9uYW1lOiAiZG91amluc2hpIiwgbmFtZTogIkRvdWppbnNoaSIgfSwKCQkJZ2FtZWNnOiAgICB7IHNvcnQ6IDQsICBjb2xvcl9pZDogNCwgc2hvcnRfbmFtZTogImdhbWVjZyIsICAgIG5hbWU6ICJHYW1lIENHIiB9LAoJCQlpbWFnZXNldDogIHsgc29ydDogNSwgIGNvbG9yX2lkOiA3LCBzaG9ydF9uYW1lOiAiaW1hZ2VzZXQiLCAgbmFtZTogIkltYWdlIFNldCIgfSwKCQkJbWFuZ2E6ICAgICB7IHNvcnQ6IDYsICBjb2xvcl9pZDogMiwgc2hvcnRfbmFtZTogIm1hbmdhIiwgICAgIG5hbWU6ICJNYW5nYSIgfSwKCQkJbWlzYzogICAgICB7IHNvcnQ6IDcsICBjb2xvcl9pZDogMCwgc2hvcnRfbmFtZTogIm1pc2MiLCAgICAgIG5hbWU6ICJNaXNjIiB9LAoJCQlub25faDogICAgIHsgc29ydDogOCwgIGNvbG9yX2lkOiA2LCBzaG9ydF9uYW1lOiAibm9uLWgiLCAgICAgbmFtZTogIk5vbi1IIiB9LAoJCQkicHJpdmF0ZSI6IHsgc29ydDogOSwgIGNvbG9yX2lkOiAwLCBzaG9ydF9uYW1lOiAicHJpdmF0ZSIsICAgbmFtZTogIlByaXZhdGUiIH0sCgkJCXdlc3Rlcm46ICAgeyBzb3J0OiAxMCwgY29sb3JfaWQ6IDUsIHNob3J0X25hbWU6ICJ3ZXN0ZXJuIiwgICBuYW1lOiAiV2VzdGVybiIgfQoJCX07CgkJdmFyIGVoZW50YWlfY2F0ZWdvcnlfbWFwcGluZyA9IHsKCQkJImFydGlzdCBjZyBzZXRzIjogImFydGlzdGNnIiwKCQkJImFzaWFuIHBvcm4iOiAiYXNpYW5wb3JuIiwKCQkJImNvc3BsYXkiOiAiY29zcGxheSIsCgkJCSJkb3VqaW5zaGkiOiAiZG91amluc2hpIiwKCQkJImdhbWUgY2cgc2V0cyI6ICJnYW1lY2ciLAoJCQkiaW1hZ2Ugc2V0cyI6ICJpbWFnZXNldCIsCgkJCSJtYW5nYSI6ICJtYW5nYSIsCgkJCSJtaXNjIjogIm1pc2MiLAoJCQkibm9uLWgiOiAibm9uX2giLAoJCQkicHJpdmF0ZSI6ICJwcml2YXRlIiwKCQkJIndlc3Rlcm4iOiAid2VzdGVybiIKCQl9OwoJCXZhciBuaGVudGFpX2NhdGVnb3J5X21hcHBpbmcgPSB7CgkJCSJkb3VqaW5zaGkiOiAiZG91amluc2hpIiwKCQkJIm1hbmdhIjogIm1hbmdhIgoJCX07CgkJdmFyIGhpdG9taV9jYXRlZ29yeV9tYXBwaW5nID0gewoJCQkiZG91amluc2hpIjogImRvdWppbnNoaSIsCgkJCSJtYW5nYSI6ICJtYW5nYSIsCgkJCSJhcnRpc3QgY2ciOiAiYXJ0aXN0Y2ciLAoJCQkiZ2FtZSBjZyI6ICJnYW1lY2ciCgkJfTsKCgkJdmFyIG5vcm1hbGl6ZV9jYXRlZ29yeSA9IGZ1bmN0aW9uIChtYXBwaW5nLCBjYXRlZ29yeSkgewoJCQl2YXIgdCA9IG1hcHBpbmdbY2F0ZWdvcnkudG9Mb3dlckNhc2UoKV07CgkJCXJldHVybiAodCAhPT0gdW5kZWZpbmVkID8gdCA6ICJtaXNjIik7CgkJfTsKCgkJdmFyIGdldF9jYXRlZ29yeSA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJCXZhciBjID0gY2F0ZWdvcmllc1tuYW1lXTsKCQkJcmV0dXJuIChjICE9PSB1bmRlZmluZWQpID8gYyA6IGNhdGVnb3JpZXMubWlzYzsKCQl9OwoJCXZhciBnZXRfY2F0ZWdvcnlfc29ydF9yYW5rID0gZnVuY3Rpb24gKG5hbWUpIHsKCQkJdmFyIGMgPSBjYXRlZ29yaWVzW25hbWVdOwoJCQlyZXR1cm4gKGMgIT09IHVuZGVmaW5lZCkgPyBjLnNvcnQgOiBPYmplY3Qua2V5cyhjYXRlZ29yaWVzKS5sZW5ndGg7CgkJfTsKCgoJCS8vIFByaXZhdGUKCQl2YXIgdGVtcF9kaXYgPSAkLm5vZGVfc2ltcGxlKCJkaXYiKSwKCQkJbmhlbnRhaV90YWdfbmFtZXNwYWNlcyA9IHsKCQkJCXBhcm9kaWVzOiAicGFyb2R5IiwKCQkJCWNoYXJhY3RlcnM6ICJjaGFyYWN0ZXIiLAoJCQkJYXJ0aXN0czogImFydGlzdCIsCgkJCQlncm91cHM6ICJncm91cCIKCQkJfTsKCgkJdmFyIEltYWdlRmxhZ3MgPSB7CgkJCU5vbmU6IDB4MCwKCQkJVGh1bWJuYWlsTm9MZWVjaDogMHgxCgkJfTsKCgkJdmFyIGNyZWF0ZV9lbXB0eV9nYWxsZXJ5X2luZm8gPSBmdW5jdGlvbiAodHlwZSkgewoJCQlyZXR1cm4gewoJCQkJdHlwZTogdHlwZSwKCQkJCXN1YnR5cGU6ICJnYWxsZXJ5IiwKCQkJCWdpZDogMCwKCQkJCXRva2VuOiBudWxsLAoJCQkJdGl0bGU6ICIiLAoJCQkJdGl0bGVfanBuOiBudWxsLAoJCQkJdXBsb2FkZXI6ICIiLAoJCQkJY2F0ZWdvcnk6ICJtaXNjIiwKCQkJCXRodW1ibmFpbDogbnVsbCwKCgkJCQlmbGFnczogMCwKCQkJCWRhdGVfY3JlYXRlZDogMCwKCQkJCWZpbGVfY291bnQ6IDAsCgkJCQl0b3RhbF9zaXplOiAtMSwKCQkJCWZhdm9yaXRlczogLTEsCgkJCQlmYXZvcml0ZV9jYXRlZ29yeTogbnVsbCwKCQkJCXJhdGluZzogLTEsCgkJCQl0b3JyZW50X2NvdW50OiAtMSwKCgkJCQlmdWxsOiBmYWxzZSwKCQkJCXZpc2libGU6IG51bGwsCgkJCQlyZW1vdmVkOiBudWxsLAoJCQkJYXJjaGl2ZXJfa2V5OiBudWxsLAoKCQkJCXRhZ3M6IG51bGwsCgkJCQl0YWdzX25zOiBudWxsCgkJCX07CgkJfTsKCQl2YXIgaGVhZGVyX3N0cmluZ19wYXJzZSA9IGZ1bmN0aW9uIChoZWFkZXJfc3RyKSB7CgkJCXZhciBsaW5lcyA9IGhlYWRlcl9zdHIuc3BsaXQoIlxyXG4iKSwKCQkJCXJlX2xpbmUgPSAvXihbXjpdKik6XHMoLiopJC9pLAoJCQkJaGVhZGVycyA9IHt9LAoJCQkJaSwgbTsKCgkJCWZvciAoaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7ICsraSkgewoJCQkJaWYgKChtID0gcmVfbGluZS5leGVjKGxpbmVzW2ldKSkpIHsKCQkJCQloZWFkZXJzW21bMV0udG9Mb3dlckNhc2UoKV0gPSBtWzJdOwoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gaGVhZGVyczsKCQl9OwoKCQl2YXIgZWhlbnRhaV9zaW1wbGVfc3RyaW5nID0gZnVuY3Rpb24gKHZhbHVlLCBkZWZhdWx0X3ZhbHVlKSB7CgkJCXJldHVybiAodHlwZW9mKHZhbHVlKSAhPT0gInN0cmluZyIgfHwgdmFsdWUubGVuZ3RoID09PSAwKSA/IGRlZmF1bHRfdmFsdWUgOiB2YWx1ZTsKCQl9OwoJCXZhciBlaGVudGFpX25vcm1hbGl6ZV9zdHJpbmcgPSBmdW5jdGlvbiAodmFsdWUsIGRlZmF1bHRfdmFsdWUpIHsKCQkJaWYgKHR5cGVvZih2YWx1ZSkgIT09ICJzdHJpbmciIHx8IHZhbHVlLmxlbmd0aCA9PT0gMCkgewoJCQkJcmV0dXJuIGRlZmF1bHRfdmFsdWU7CgkJCX0KCQkJdGVtcF9kaXYuaW5uZXJIVE1MID0gdmFsdWU7CgkJCXZhbHVlID0gdGVtcF9kaXYudGV4dENvbnRlbnQ7CgkJCXRlbXBfZGl2LnRleHRDb250ZW50ID0gIiI7CgkJCXJldHVybiB2YWx1ZTsKCQl9OwoJCXZhciBlaGVudGFpX25vcm1hbGl6ZV9pbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCQkJaWYgKGluZm8uZXJyb3IgIT09IHVuZGVmaW5lZCkgewoJCQkJcmV0dXJuIHsgZXJyb3I6IGluZm8uZXJyb3IgfTsKCQkJfQoKCQkJdmFyIGRhdGEgPSBjcmVhdGVfZW1wdHlfZ2FsbGVyeV9pbmZvKCJlaGVudGFpIiksCgkJCQlyZV90YWdfbnMgPSAvXihbXjpdKik6KFtcd1xXXSopJC8sCgkJCQlpLCBpaSwgbSwgdGFnLCBucywgdGFncywgdGFnc19uczsKCgkJCWRhdGEuZ2lkID0gcGFyc2VJbnQoaW5mby5naWQsIDEwKSB8fCAwOwoJCQlkYXRhLnRva2VuID0gZWhlbnRhaV9zaW1wbGVfc3RyaW5nKGluZm8udG9rZW4sIG51bGwpOwoJCQlkYXRhLmFyY2hpdmVyX2tleSA9IGVoZW50YWlfc2ltcGxlX3N0cmluZyhpbmZvLmFyY2hpdmVyX2tleSwgbnVsbCk7CgkJCWRhdGEudGl0bGUgPSBlaGVudGFpX25vcm1hbGl6ZV9zdHJpbmcoaW5mby50aXRsZSwgIiIpOwoJCQlkYXRhLnRpdGxlX2pwbiA9IGVoZW50YWlfbm9ybWFsaXplX3N0cmluZyhpbmZvLnRpdGxlX2pwbiwgbnVsbCk7CgkJCWRhdGEudXBsb2FkZXIgPSBlaGVudGFpX25vcm1hbGl6ZV9zdHJpbmcoaW5mby51cGxvYWRlciwgbnVsbCk7CgkJCWRhdGEuY2F0ZWdvcnkgPSBub3JtYWxpemVfY2F0ZWdvcnkoZWhlbnRhaV9jYXRlZ29yeV9tYXBwaW5nLCBlaGVudGFpX3NpbXBsZV9zdHJpbmcoaW5mby5jYXRlZ29yeSwgIiIpKTsKCQkJZGF0YS50aHVtYm5haWwgPSBlaGVudGFpX3NpbXBsZV9zdHJpbmcoaW5mby50aHVtYiwgbnVsbCk7CgkJCWRhdGEuZGF0ZV9jcmVhdGVkID0gKHBhcnNlSW50KGluZm8ucG9zdGVkLCAxMCkgfHwgMCkgKiAxMDAwOwoJCQlkYXRhLmZpbGVfY291bnQgPSBwYXJzZUludChpbmZvLmZpbGVjb3VudCwgMTApIHx8IDA7CgkJCWRhdGEudG90YWxfc2l6ZSA9IHBhcnNlSW50KGluZm8uZmlsZXNpemUsIDEwKSB8fCAwOwoJCQlkYXRhLnJhdGluZyA9IHBhcnNlRmxvYXQoaW5mby5yYXRpbmcpIHx8IDAuMDsKCQkJZGF0YS50b3JyZW50X2NvdW50ID0gcGFyc2VJbnQoaW5mby50b3JyZW50Y291bnQsIDEwKSB8fCAwOwoJCQlkYXRhLnZpc2libGUgPSAhaW5mby5leHB1bmdlZDsKCgkJCXRhZ3MgPSBbXTsKCQkJdGFnc19ucyA9IHt9OwoJCQlpZiAoQXJyYXkuaXNBcnJheShpbmZvLnRhZ3MpKSB7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IGluZm8udGFncy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJbnMgPSAibWlzYyI7CgkJCQkJdGFnID0gaW5mby50YWdzW2ldOwoKCQkJCQlpZiAoKG0gPSByZV90YWdfbnMuZXhlYyh0YWcpKSAhPT0gbnVsbCkgewoJCQkJCQlucyA9IG1bMV07CgkJCQkJCXRhZyA9IG1bMl07CgkJCQkJfQoKCQkJCQlpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0YWdzX25zLCBucykpIHsKCQkJCQkJdGFnc19uc1tuc10gPSBbXTsKCQkJCQl9CgoJCQkJCXRhZ3MucHVzaCh0YWcpOwoJCQkJCXRhZ3NfbnNbbnNdLnB1c2godGFnKTsKCQkJCX0KCQkJfQoJCQlkYXRhLnRhZ3MgPSB0YWdzOwoJCQlkYXRhLnRhZ3NfbnMgPSB0YWdzX25zOwoKCQkJcmV0dXJuIGRhdGE7CgkJfTsKCgkJdmFyIGVoZW50YWlfZ2V0X2Zhdm9yaXRlX2luZm9fZnJvbV9pY29uID0gZnVuY3Rpb24gKG5vZGUsIGRhdGEpIHsKCQkJdmFyIG0gPSAvYmFja2dyb3VuZC1wb3NpdGlvblxzKjpccypcUytccyooW1wtXCtdP1tcZFwuXSspcHgvLmV4ZWMobm9kZS5nZXRBdHRyaWJ1dGUoInN0eWxlIikgfHwgIiIpOwoJCQlpZiAobSAhPT0gbnVsbCkgewoJCQkJZGF0YS5mYXZvcml0ZV9jYXRlZ29yeSA9IFsKCQkJCQlNYXRoLm1heCgwLCBNYXRoLm1pbig5LCBNYXRoLnJvdW5kKCgoLXBhcnNlRmxvYXQobVsxXSkgfHwgMCkgLSAyKSAvIDE5KSkpLAoJCQkJCW5vZGUuZ2V0QXR0cmlidXRlKCJ0aXRsZSIpIHx8ICIiCgkJCQldOwoJCQl9CgkJfTsKCgkJdmFyIGVoZW50YWlfaXNfbm90X2F2YWlsYWJsZSA9IGZ1bmN0aW9uIChodG1sKSB7CgkJCXZhciBuOwoJCQlyZXR1cm4gKAoJCQkJKG4gPSAkKCJ0aXRsZSIsIGh0bWwpKSAhPT0gbnVsbCAmJgoJCQkJKC9eXHMqR2FsbGVyeVxzK05vdFxzK0F2YWlsYWJsZS9pKS50ZXN0KG4udGV4dENvbnRlbnQpICYmCgkJCQkkKCIjY29udGludWUiLCBodG1sKSAhPT0gbnVsbAoJCQkpOwoJCX07CgkJdmFyIGVoZW50YWlfaXNfY29udGVudF93YXJuaW5nID0gZnVuY3Rpb24gKGh0bWwpIHsKCQkJdmFyIG47CgkJCXJldHVybiAoCgkJCQkobiA9ICQoImgxIiwgaHRtbCkpICE9PSBudWxsICYmCgkJCQkoL15ccypDb250ZW50XHMrV2FybmluZy9pKS50ZXN0KG4udGV4dENvbnRlbnQpCgkJCSk7CgkJfTsKCQl2YXIgZWhlbnRhaV9wYXJzZV9nYWxsZXJ5X2luZm8gPSBmdW5jdGlvbiAoaHRtbCwgZGF0YSkgewoJCQkvLyBUYWdzCgkJCXZhciB1cGRhdGVkX3RhZ19jb3VudCA9IDAsCgkJCQl0YWdzLCB0YWdzX2FycmF5LCBwYXR0ZXJuLCBwYXIsIHRkcywgbmFtZXNwYWNlLCBucywgaSwgaWksIGosIGpqLCBtLCBuLCB0OwoKCQkJdGFncyA9IHt9OwoJCQl0YWdzX2FycmF5ID0gW107CgkJCXBhdHRlcm4gPSAvKC4rKTovOwoKCQkJZGF0YS5yZW1vdmVkID0gZmFsc2U7CgoJCQlwYXIgPSAkJCgiI3RhZ2xpc3QgdHIiLCBodG1sKTsKCQkJZm9yIChpID0gMCwgaWkgPSBwYXIubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJLy8gQ2xhc3MKCQkJCXRkcyA9ICQkKCJ0ZCIsIHBhcltpXSk7CgkJCQlqaiA9IHRkcy5sZW5ndGg7CgkJCQlpZiAoamogPT09IDApIGNvbnRpbnVlOwoKCQkJCS8vIE5hbWVzcGFjZQoJCQkJbmFtZXNwYWNlID0gKChtID0gcGF0dGVybi5leGVjKHRkc1swXS50ZXh0Q29udGVudCkpID8gbVsxXS50cmltKCkgOiAiIik7CgkJCQlpZiAoIShuYW1lc3BhY2UgaW4gdGFncykpIHsKCQkJCQlucyA9IFtdOwoJCQkJCXRhZ3NbbmFtZXNwYWNlXSA9IG5zOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJbnMgPSB0YWdzW25hbWVzcGFjZV07CgkJCQl9CgoJCQkJLy8gVGFncwoJCQkJdGRzID0gJCQoImRpdiIsIHRkc1tqaiAtIDFdKTsKCQkJCWZvciAoaiA9IDAsIGpqID0gdGRzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKCQkJCQkvLyBDcmVhdGUgdGFnCgkJCQkJaWYgKChuID0gJCgiYSIsIHRkc1tqXSkpICE9PSBudWxsKSB7CgkJCQkJCS8vIEFkZCB0YWcKCQkJCQkJdCA9IG4udGV4dENvbnRlbnQudHJpbSgpOwoJCQkJCQlucy5wdXNoKHQpOwoJCQkJCQl0YWdzX2FycmF5LnB1c2godCk7CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFJlbW92ZSBpZiBlbXB0eQoJCQkJaWYgKG5zLmxlbmd0aCA9PT0gMCkgewoJCQkJCWRlbGV0ZSB0YWdzW25hbWVzcGFjZV07CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkrK3VwZGF0ZWRfdGFnX2NvdW50OwoJCQkJfQoJCQl9CgoJCQlpZiAodGFnc19hcnJheS5sZW5ndGggPiAwKSB7CgkJCQlkYXRhLnRhZ3MgPSB0YWdzX2FycmF5OwoJCQkJZGF0YS50YWdzX25zID0gdGFnczsKCQkJfQoKCQkJLy8gRmF2b3JpdGVzCgkJCWlmICgKCQkJCShuID0gJCgiI2ZhdmNvdW50IiwgaHRtbCkpICE9PSBudWxsICYmCgkJCQkobSA9IC9cZCsvLmV4ZWMobi50ZXh0Q29udGVudCkpICE9PSBudWxsCgkJCSkgewoJCQkJZGF0YS5mYXZvcml0ZV9jb3VudCA9IHBhcnNlSW50KG1bMF0sIDEwKTsKCQkJfQoKCQkJaWYgKChuID0gJCgiI2Zhdj4uaVtzdHlsZV0iLCBodG1sKSkgIT09IG51bGwpIHsKCQkJCWVoZW50YWlfZ2V0X2Zhdm9yaXRlX2luZm9fZnJvbV9pY29uKG4sIGRhdGEpOwoJCQl9CgoJCQkvLyBEb25lCgkJCWRhdGEuZnVsbCA9IHRydWU7CgkJCXJldHVybiBkYXRhOwoJCX07CgkJdmFyIGVoZW50YWlfbWFrZV9yZW1vdmVkID0gZnVuY3Rpb24gKGRhdGEpIHsKCQkJZGF0YS5yZW1vdmVkID0gdHJ1ZTsKCQkJZGF0YS5mdWxsID0gdHJ1ZTsKCQkJcmV0dXJuIGRhdGE7CgkJfTsKCgkJdmFyIGVoZW50YWlfcGFyc2VfbG9va3VwX3Jlc3VsdHMgPSBmdW5jdGlvbiAoeGhyLCBpc19zaW1pbGFyaXR5X3NjYW4sIGhhc2gsIHVybCwgbWQ1KSB7CgkJCXZhciBmaW5hbF91cmwgPSB4aHIuZmluYWxVcmwsCgkJCQl0ZXh0ID0geGhyLnJlc3BvbnNlVGV4dCwKCQkJCWVyciA9IG51bGwsCgkJCQlodG1sLCByZXN1bHRzLCBsaW5rcywgbGluaywgbSwgbiwgaSwgaWk7CgoJCQkvLyBTaW1pbGFyaXR5IHNjYW4gY2hlY2tpbmcKCQkJaWYgKGlzX3NpbWlsYXJpdHlfc2NhbikgewoJCQkJbSA9IC9mX3NoYXNoPSgoWzAtOWEtZl17NDB9fGNvcnJ1cHQpKD86Oyg/OlswLTlhLWZdezQwfXxtb25vdG9uZSkpKikvLmV4ZWMoZmluYWxfdXJsKTsKCQkJCWlmIChtICE9PSBudWxsICYmIG1bMl0gIT09ICJjb3JydXB0IikgewoJCQkJCWhhc2ggPSBtWzFdOwoJCQkJCWlmICgvbW9ub3RvbmUvLnRlc3QoaGFzaCkpIHsKCQkJCQkJZXJyID0gIlNpbWlsYXJpdHkgbG9va3VwIGRvZXMgbm90IHdvcmsgb24gbW9ub3RvbmUgaW1hZ2VzIjsKCQkJCQl9CgkJCQl9CgkJCQllbHNlIGlmICgobSA9IC9bPyZdcG9uaT0oW15cP1wmXCNdKikvLmV4ZWMoZmluYWxfdXJsKSkgIT09IG51bGwpIHsKCQkJCQkvLyBTdHJhbmdlIGVycm9yCgkJCQkJZXJyID0gInBvbmktY29kZSBlbmNvdW50ZXJlZDogeW91IGxpa2VseSBoYXZlIGVycm9uZW91cyBjb29raWVzLlxuIiArIG1bMV07CgkJCQkJRGVidWcubG9nKCJwb25pLWNvZGUgZW5jb3VudGVyZWQ6ICIgKyBmaW5hbF91cmwpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJaWYgKC9wbGVhc2Vccyt3YWl0XHMrYVxzK2JpdFxzK2xvbmdlclxzK2JldHdlZW5ccytlYWNoXHMrZmlsZVxzK3NlYXJjaC9pLnRlc3QodGV4dCkpIHsKCQkJCQkJZXJyID0gIldhaXQgbG9uZ2VyIGJldHdlZW4gbG9va3VwcyI7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlEZWJ1Zy5sb2coIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHJldmVyc2UgaW1hZ2Ugc2VhcmNoaW5nIiwgeGhyKTsKCQkJCQkJZXJyID0gIlVua25vd24gZXJyb3IiOwoJCQkJCQlodG1sID0gJC5odG1sX3BhcnNlX3NhZmUodGV4dCwgbnVsbCk7CgkJCQkJCWlmIChodG1sICE9PSBudWxsKSB7CgkJCQkJCQluID0gJCgiI2l3IiwgaHRtbCk7CgkJCQkJCQlpZiAobiAhPT0gbnVsbCkgZXJyID0gbi50ZXh0Q29udGVudC50cmltKCk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJaWYgKGVyciAhPT0gbnVsbCkgcmV0dXJuIHsgZXJyb3I6IGVyciwgZXJyb3JfbW9kZTogUmVxdWVzdEVycm9yTW9kZS5Ob25lIH07CgoJCQkJLy8gU2F2ZSBoYXNoCgkJCQlpZiAobWQ1ID09PSBudWxsKSB7CgkJCQkJaGFzaF9zZXRfdXJsX3RvX3NoYTEodXJsLCBoYXNoKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWhhc2hfc2V0X21kNV90b19zaGExKG1kNSwgaGFzaCk7CgkJCQl9CgkJCX0KCgkJCS8vIEdldCBodG1sCgkJCWh0bWwgPSAkLmh0bWxfcGFyc2Vfc2FmZSh0ZXh0LCBudWxsKTsKCgkJCS8vIFByb2Nlc3MKCQkJcmVzdWx0cyA9IFtdOwoJCQlsaW5rcyA9ICQkKCJkaXYuaXQ1IGEsZGl2LmlkMiBhIiwgaHRtbCk7CgkJCWZvciAoaSA9IDAsIGlpID0gbGlua3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJbGluayA9IGxpbmtzW2ldOwoJCQkJcmVzdWx0cy5wdXNoKHsKCQkJCQl1cmw6IGxpbmsuaHJlZiwKCQkJCQl0aXRsZTogbGluay50ZXh0Q29udGVudAoJCQkJfSk7CgkJCX0KCgkJCS8vIERvbmUKCQkJcmV0dXJuIHsKCQkJCXVybDogZmluYWxfdXJsLAoJCQkJaGFzaDogaGFzaCwKCQkJCXJlc3VsdHM6IHJlc3VsdHMKCQkJfTsKCQl9OwoJCXZhciBlaGVudGFpX2NyZWF0ZV9sb29rdXBfdXJsID0gZnVuY3Rpb24gKHNoYTEpIHsKCQkJdmFyIHVybCA9ICJodHRwOi8vIjsKCQkJdXJsICs9IGNvbmZpZy5zYXVjZS5sb29rdXBfZG9tYWluOwoJCQl1cmwgKz0gIi8/Zl9kb3VqaW5zaGk9MSZmX21hbmdhPTEmZl9hcnRpc3RjZz0xJmZfZ2FtZWNnPTEmZl93ZXN0ZXJuPTEmZl9ub24taD0xJmZfaW1hZ2VzZXQ9MSZmX2Nvc3BsYXk9MSZmX2FzaWFucG9ybj0xJmZfbWlzYz0xJmZfc2VhcmNoPVNlYXJjaCtLZXl3b3JkcyZmX2FwcGx5PUFwcGx5K0ZpbHRlciZmX3NoYXNoPSI7CgkJCXVybCArPSBzaGExOwoJCQl1cmwgKz0gIiZmc19zaW1pbGFyPTAiOwoJCQlpZiAoY29uZmlnLnNhdWNlLmV4cHVuZ2VkKSB1cmwgKz0gIiZmc19leHA9MSI7CgkJCXJldHVybiB1cmw7CgkJfTsKCgkJdmFyIG5oZW50YWlfbm9ybWFsaXplX3RhZ19uYW1lc3BhY2UgPSBmdW5jdGlvbiAobmFtZXNwYWNlKSB7CgkJCXJldHVybiBuaGVudGFpX3RhZ19uYW1lc3BhY2VzW25hbWVzcGFjZV0gfHwgbmFtZXNwYWNlOwoJCX07CgkJdmFyIG5oZW50YWlfcGFyc2VfaW5mbyA9IGZ1bmN0aW9uIChodG1sLCB1cmwpIHsKCQkJdmFyIGluZm8gPSAkKCIjaW5mbyIsIGh0bWwpLAoJCQkJZGF0YSwgbm9kZXMsIHRhZ3MsIHRhZ19ucywgdGFnX25zX2xpc3QsIHQsIG0sIG4sIGksIGlpLCBqLCBqajsKCgkJCWlmIChpbmZvID09PSBudWxsKSB7CgkJCQlyZXR1cm4geyBlcnJvcjogIkNvdWxkIG5vdCBmaW5kIGluZm8iIH07CgkJCX0KCgkJCS8vIENyZWF0ZSBkYXRhCgkJCWRhdGEgPSBjcmVhdGVfZW1wdHlfZ2FsbGVyeV9pbmZvKCJuaGVudGFpIik7CgkJCWRhdGEudXBsb2FkZXIgPSAibmhlbnRhaS5uZXQiOwoJCQlkYXRhLmZ1bGwgPSB0cnVlOwoJCQlkYXRhLnRhZ3MgPSBbXTsKCQkJZGF0YS50YWdzX25zID0ge307CgoJCQkvLyBJbWFnZS9naWQKCQkJaWYgKChuID0gJCgiI2NvdmVyPmEiLCBodG1sKSkgIT09IG51bGwpIHsKCQkJCW0gPSAvXC9nXC8oXGQrKS8uZXhlYyhuLmdldEF0dHJpYnV0ZSgiaHJlZiIpIHx8ICIiKTsKCQkJCWlmIChtICE9PSBudWxsKSB7CgkJCQkJZGF0YS5naWQgPSBwYXJzZUludChtWzFdLCAxMCk7CgkJCQl9CgoJCQkJaWYgKAoJCQkJCShuID0gJCgiaW1nIiwgbikpICE9PSBudWxsICYmCgkJCQkJKHQgPSBuLmdldEF0dHJpYnV0ZSgiZGF0YS1zcmMiKSkKCQkJCSkgewoJCQkJCWRhdGEudGh1bWJuYWlsID0gJC5yZXNvbHZlKHQsIHVybCk7CgkJCQl9CgkJCX0KCgkJCS8vIEltYWdlIGNvdW50CgkJCWRhdGEuZmlsZV9jb3VudCA9ICQkKCIjdGh1bWJuYWlsLWNvbnRhaW5lcj4udGh1bWItY29udGFpbmVyIiwgaHRtbCkubGVuZ3RoOwoKCQkJLy8gVGl0bGVzCgkJCWlmICgobiA9ICQoImgxIiwgaW5mbykpICE9PSBudWxsKSB7CgkJCQlkYXRhLnRpdGxlID0gbi50ZXh0Q29udGVudC50cmltKCk7CgkJCX0KCQkJaWYgKChuID0gJCgiaDIiLCBpbmZvKSkgIT09IG51bGwpIHsKCQkJCWRhdGEudGl0bGVfanBuID0gbi50ZXh0Q29udGVudC50cmltKCk7CgkJCX0KCgkJCS8vIFRhZ3MKCQkJaWYgKChub2RlcyA9ICQkKCIuZmllbGQtbmFtZSIsIGluZm8pKS5sZW5ndGggPiAwKSB7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQl0YWdfbnMgPSBuaGVudGFpX25vcm1hbGl6ZV90YWdfbmFtZXNwYWNlKCgKCQkJCQkJKG4gPSBub2Rlc1tpXS5maXJzdENoaWxkKSAhPT0gbnVsbCAmJgoJCQkJCQluLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERQoJCQkJCSkgPyBuLm5vZGVWYWx1ZS50cmltKCkucmVwbGFjZSgvOi8sICIiKS50b0xvd2VyQ2FzZSgpIDogIiIpOwoKCQkJCQl0YWdzID0gJCQoIi50YWciLCBub2Rlc1tpXSk7CgoJCQkJCWlmICh0YWdfbnMgPT09ICJjYXRlZ29yeSIpIHsKCQkJCQkJaWYgKAoJCQkJCQkJdGFncy5sZW5ndGggPiAwICYmCgkJCQkJCQkobiA9IHRhZ3NbMF0uZmlyc3RDaGlsZCkgIT09IG51bGwgJiYKCQkJCQkJCW4ubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFCgkJCQkJCSkgewoJCQkJCQkJZGF0YS5jYXRlZ29yeSA9IG5vcm1hbGl6ZV9jYXRlZ29yeShuaGVudGFpX2NhdGVnb3J5X21hcHBpbmcsIG4ubm9kZVZhbHVlLnRyaW0oKSk7CgkJCQkJCX0KCQkJCQkJdGFncyA9IFtdOwoJCQkJCX0KCgkJCQkJaWYgKHRhZ3MubGVuZ3RoID4gMCkgewoJCQkJCQlpZiAodGFnX25zIGluIGRhdGEudGFnc19ucykgewoJCQkJCQkJdGFnX25zX2xpc3QgPSBkYXRhLnRhZ3NfbnNbdGFnX25zXTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCXRhZ19uc19saXN0ID0gW107CgkJCQkJCQlkYXRhLnRhZ3NfbnNbdGFnX25zXSA9IHRhZ19uc19saXN0OwoJCQkJCQl9CgoJCQkJCQlmb3IgKGogPSAwLCBqaiA9IHRhZ3MubGVuZ3RoOyBqIDwgamo7ICsraikgewoJCQkJCQkJaWYgKAoJCQkJCQkJCShuID0gdGFnc1tqXS5maXJzdENoaWxkKSAhPT0gbnVsbCAmJgoJCQkJCQkJCW4ubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFCgkJCQkJCQkpIHsKCQkJCQkJCQkvLyBBZGQgdGFnCgkJCQkJCQkJdCA9IG4ubm9kZVZhbHVlLnRyaW0oKTsKCQkJCQkJCQl0YWdfbnNfbGlzdC5wdXNoKHQpOwoJCQkJCQkJCWRhdGEudGFncy5wdXNoKHQpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBEYXRlCgkJCWlmICgobiA9ICQoInRpbWVbZGF0ZXRpbWVdIiwgaW5mbykpICE9PSBudWxsKSB7CgkJCQltID0gL14oXGQrKS0oXGQrKS0oXGQrKVQoXGQrKTooXGQrKTooXGQrKVwuKFxkezZ9KS9pLmV4ZWMobi5nZXRBdHRyaWJ1dGUoImRhdGV0aW1lIikgfHwgIiIpOwoJCQkJaWYgKG0gIT09IG51bGwpIHsKCQkJCQlkYXRhLmRhdGVfY3JlYXRlZCA9IG5ldyBEYXRlKAoJCQkJCQlwYXJzZUludChtWzFdLCAxMCksCgkJCQkJCXBhcnNlSW50KG1bMl0sIDEwKSAtIDEsCgkJCQkJCXBhcnNlSW50KG1bM10sIDEwKSwKCQkJCQkJcGFyc2VJbnQobVs0XSwgMTApLAoJCQkJCQlwYXJzZUludChtWzVdLCAxMCksCgkJCQkJCXBhcnNlSW50KG1bNl0sIDEwKSwKCQkJCQkJTWF0aC5mbG9vcihwYXJzZUludChtWzddLCAxMCkgLyAxMDAwKQoJCQkJCSkuZ2V0VGltZSgpOwoJCQkJfQoJCQl9CgoJCQkvLyBGYXZvcml0ZSBjb3VudAoJCQlpZiAoKG4gPSAkKCIuYnV0dG9ucz4uYnRuLmJ0bi1wcmltYXJ5PnNwYW4+Lm5vYm9sZCIsIGluZm8pKSAhPT0gbnVsbCkgewoJCQkJbSA9IC9cZCsvLmV4ZWMobi50ZXh0Q29udGVudCk7CgkJCQlpZiAobSAhPT0gbnVsbCkgewoJCQkJCWRhdGEuZmF2b3JpdGVfY291bnQgPSBwYXJzZUludChtWzBdLCAxMCk7CgkJCQl9CgkJCX0KCgkJCXJldHVybiBkYXRhOwoJCX07CgoJCXZhciBoaXRvbWlfcGFyc2VfaW5mbyA9IGZ1bmN0aW9uIChodG1sLCB1cmwpIHsKCQkJdmFyIGluZm8gPSAkKCIuY29udGVudCIsIGh0bWwpLAoJCQkJY2VsbG1hcCA9IHt9LAoJCQkJcmVfZ2VuZGVyID0gL1xzKihcdTI2NDB8XHUyNjQyKSQvLCAvLyBcdTI2NDAgPSBmZW1hbGUsIFx1MjY0MiA9IG1hbGUKCQkJCXRhZ3NfZnVsbCwgdGFncywgdGFnX2xpc3QsIGluZm8yLCBkYXRhLCBub2RlcywgY2VsbHMsIHQsIG0sIG4sIGksIGlpLCBqOwoKCQkJaWYgKAoJCQkJaW5mbyA9PT0gbnVsbCB8fAoJCQkJKGluZm8yID0gJCgiLmdhbGxlcnkiLCBpbmZvKSkgPT09IG51bGwKCQkJKSB7CgkJCQlyZXR1cm4geyBlcnJvcjogIkNvdWxkIG5vdCBmaW5kIGluZm8iIH07CgkJCX0KCgkJCS8vIENyZWF0ZSBkYXRhCgkJCWRhdGEgPSBjcmVhdGVfZW1wdHlfZ2FsbGVyeV9pbmZvKCJoaXRvbWkiKTsKCQkJZGF0YS5mbGFncyB8PSBJbWFnZUZsYWdzLlRodW1ibmFpbE5vTGVlY2g7IC8vIG5vIGNyb3NzIG9yaWdpbiB0aHVtYm5haWxzCgkJCWRhdGEudXBsb2FkZXIgPSAiaGl0b21pLmxhIjsKCQkJZGF0YS5mdWxsID0gdHJ1ZTsKCQkJZGF0YS50YWdzID0gdGFncyA9IFtdOwoJCQlkYXRhLnRhZ3NfbnMgPSB0YWdzX2Z1bGwgPSB7fTsKCgkJCS8vIEltYWdlL2dpZAoJCQlpZiAoKG4gPSAkKCIuY292ZXI+YSIsIGh0bWwpKSAhPT0gbnVsbCkgewoJCQkJbSA9IC9cL3JlYWRlclwvKFxkKykvLmV4ZWMobi5nZXRBdHRyaWJ1dGUoImhyZWYiKSB8fCAiIik7CgkJCQlpZiAobSAhPT0gbnVsbCkgewoJCQkJCWRhdGEuZ2lkID0gcGFyc2VJbnQobVsxXSwgMTApOwoJCQkJfQoKCQkJCWlmICgKCQkJCQkobiA9ICQoImltZyIsIG4pKSAhPT0gbnVsbCAmJgoJCQkJCSh0ID0gbi5nZXRBdHRyaWJ1dGUoInNyYyIpKQoJCQkJKSB7CgkJCQkJZGF0YS50aHVtYm5haWwgPSAkLnJlc29sdmUodCwgdXJsKTsKCQkJCX0KCQkJfQoKCQkJLy8gSW1hZ2UgY291bnQKCQkJZGF0YS5maWxlX2NvdW50ID0gJCQoIi50aHVtYm5haWwtbGlzdD5saSIsIGh0bWwpLmxlbmd0aDsKCgkJCS8vIFRpdGxlCgkJCWlmICgobiA9ICQoImgxIiwgaW5mbzIpKSAhPT0gbnVsbCkgewoJCQkJZGF0YS50aXRsZSA9IG4udGV4dENvbnRlbnQudHJpbSgpOwoJCQl9CgoJCQkvLyBDZWxsIGluZm8KCQkJY2VsbHMgPSAkJCgiLmdhbGxlcnktaW5mbz50YWJsZSB0ZCIsIGluZm8yKTsKCQkJZm9yIChpID0gMDsgaSA8IGNlbGxzLmxlbmd0aDsgaSArPSAyKSB7CgkJCQljZWxsbWFwW2NlbGxzW2ldLnRleHRDb250ZW50LnRyaW0oKS50b0xvd2VyQ2FzZSgpXSA9IGNlbGxzW2kgKyAxXTsKCQkJfQoKCQkJLy8gTGFuZ3VhZ2UKCQkJaWYgKChuID0gY2VsbG1hcC5sYW5ndWFnZSkgIT09IHVuZGVmaW5lZCkgewoJCQkJdCA9IG4udGV4dENvbnRlbnQudHJpbSgpOwoJCQkJaWYgKHQubGVuZ3RoID4gMCAmJiB0ICE9PSAiTi9BIikgewoJCQkJCXRhZ3NfZnVsbC5sYW5ndWFnZSA9IFsgdCBdOwoJCQkJCXRhZ3MucHVzaCh0KTsKCQkJCX0KCQkJfQoKCQkJLy8gUGFyb2R5CgkJCWlmICgobiA9IGNlbGxtYXAuc2VyaWVzKSAhPT0gdW5kZWZpbmVkKSB7CgkJCQl0ID0gbi50ZXh0Q29udGVudC50cmltKCk7CgkJCQlpZiAodC5sZW5ndGggPiAwICYmIHQgIT09ICJOL0EiKSB7CgkJCQkJdGFnc19mdWxsLnBhcm9keSA9IFsgdCBdOwoJCQkJCXRhZ3MucHVzaCh0KTsKCQkJCX0KCQkJfQoKCQkJLy8gQ2hhcmFjdGVyCgkJCWlmICgobiA9IGNlbGxtYXAuY2hhcmFjdGVycykgIT09IHVuZGVmaW5lZCkgewoJCQkJaWYgKChub2RlcyA9ICQkKCJsaT5hIiwgbikpLmxlbmd0aCA+IDApIHsKCQkJCQl0YWdfbGlzdCA9IFtdOwoKCQkJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJdCA9IG5vZGVzW2ldLnRleHRDb250ZW50LnRyaW0oKTsKCQkJCQkJaWYgKHQubGVuZ3RoID4gMCkgewoJCQkJCQkJdGFnX2xpc3QucHVzaCh0KTsKCQkJCQkJCXRhZ3MucHVzaCh0KTsKCQkJCQkJfQoJCQkJCX0KCgkJCQkJaWYgKHRhZ19saXN0Lmxlbmd0aCA+IDApIHsKCQkJCQkJdGFnc19mdWxsLmNoYXJhY3RlciA9IHRhZ19saXN0OwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gR3JvdXAKCQkJaWYgKChuID0gY2VsbG1hcC5ncm91cCkgIT09IHVuZGVmaW5lZCkgewoJCQkJdCA9IG4udGV4dENvbnRlbnQudHJpbSgpOwoJCQkJaWYgKHQubGVuZ3RoID4gMCAmJiB0ICE9PSAiTi9BIikgewoJCQkJCXRhZ3NfZnVsbC5ncm91cCA9IFsgdCBdOwoJCQkJCXRhZ3MucHVzaCh0KTsKCQkJCX0KCQkJfQoKCQkJLy8gQXJ0aXN0cwoJCQlpZiAoKG5vZGVzID0gJCQoImgyPnVsPmxpPmEiLCBpbmZvMikpLmxlbmd0aCA+IDApIHsKCQkJCXRhZ19saXN0ID0gW107CgoJCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJdCA9IG5vZGVzW2ldLnRleHRDb250ZW50LnRyaW0oKTsKCQkJCQlpZiAodC5sZW5ndGggPiAwKSB7CgkJCQkJCXRhZ19saXN0LnB1c2godCk7CgkJCQkJCXRhZ3MucHVzaCh0KTsKCQkJCQl9CgkJCQl9CgoJCQkJaWYgKHRhZ19saXN0Lmxlbmd0aCA+IDApIHsKCQkJCQl0YWdzX2Z1bGwuYXJ0aXN0ID0gdGFnX2xpc3Q7CgkJCQl9CgkJCX0KCgkJCS8vIFR5cGUKCQkJaWYgKChuID0gY2VsbG1hcC50eXBlKSAhPT0gdW5kZWZpbmVkKSB7CgkJCQl0ID0gbi50ZXh0Q29udGVudC50cmltKCk7CgkJCQlpZiAodC5sZW5ndGggPiAwICYmIHQgIT09ICJOL0EiKSB7CgkJCQkJZGF0YS5jYXRlZ29yeSA9IG5vcm1hbGl6ZV9jYXRlZ29yeShoaXRvbWlfY2F0ZWdvcnlfbWFwcGluZywgdCk7CgkJCQl9CgkJCX0KCgkJCS8vIFRhZ3MKCQkJaWYgKChuID0gY2VsbG1hcC50YWdzKSAhPT0gdW5kZWZpbmVkKSB7CgkJCQlpZiAoKG5vZGVzID0gJCQoImxpPmEiLCBuKSkubGVuZ3RoID4gMCkgewoJCQkJCXRhZ19saXN0ID0gWyBbXSwgW10sIFtdIF07IC8vIG1hbGUsIGZlbWFsZSwgdGFncwoKCQkJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJdCA9IG5vZGVzW2ldLnRleHRDb250ZW50LnRyaW0oKTsKCQkJCQkJaWYgKHQubGVuZ3RoID4gMCkgewoJCQkJCQkJaWYgKChtID0gcmVfZ2VuZGVyLmV4ZWModCkpID09PSBudWxsKSB7CgkJCQkJCQkJaiA9IDI7CgkJCQkJCQl9CgkJCQkJCQllbHNlIGlmIChtWzFdID09PSAiXHUyNjQwIikgeyAvLyBmZW1hbGUKCQkJCQkJCQl0ID0gdC5zdWJzdHIoMCwgbS5pbmRleCk7CgkJCQkJCQkJaiA9IDE7CgkJCQkJCQl9CgkJCQkJCQllbHNlIHsgLy8gbWFsZQoJCQkJCQkJCXQgPSB0LnN1YnN0cigwLCBtLmluZGV4KTsKCQkJCQkJCQlqID0gMDsKCQkJCQkJCX0KCQkJCQkJCXRhZ19saXN0W2pdLnB1c2godCk7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCWlmICh0YWdfbGlzdFswXS5sZW5ndGggPiAwKSB7CgkJCQkJCUFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHRhZ3MsIHRhZ19saXN0WzBdKTsKCQkJCQkJdGFnc19mdWxsLm1hbGUgPSB0YWdfbGlzdFswXTsKCQkJCQl9CgkJCQkJaWYgKHRhZ19saXN0WzFdLmxlbmd0aCA+IDApIHsKCQkJCQkJQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkodGFncywgdGFnX2xpc3RbMV0pOwoJCQkJCQl0YWdzX2Z1bGwuZmVtYWxlID0gdGFnX2xpc3RbMV07CgkJCQkJfQoJCQkJCWlmICh0YWdfbGlzdFsyXS5sZW5ndGggPiAwKSB7CgkJCQkJCUFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KHRhZ3MsIHRhZ19saXN0WzJdKTsKCQkJCQkJdGFnc19mdWxsLnRhZ3MgPSB0YWdfbGlzdFsyXTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIERhdGUKCQkJaWYgKChuID0gJCgiLmRhdGUiLCBpbmZvKSkgIT09IG51bGwpIHsKCQkJCW0gPSAvXihcZCspLShcZCspLShcZCspXHMrKFxkKyk6KFxkKyk6KFxkKykvaS5leGVjKG4udGV4dENvbnRlbnQudHJpbSgpKTsKCQkJCWlmIChtICE9PSBudWxsKSB7CgkJCQkJZGF0YS5kYXRlX2NyZWF0ZWQgPSBuZXcgRGF0ZSgKCQkJCQkJcGFyc2VJbnQobVsxXSwgMTApLAoJCQkJCQlwYXJzZUludChtWzJdLCAxMCkgLSAxLAoJCQkJCQlwYXJzZUludChtWzNdLCAxMCksCgkJCQkJCXBhcnNlSW50KG1bNF0sIDEwKSwKCQkJCQkJcGFyc2VJbnQobVs1XSwgMTApLAoJCQkJCQlwYXJzZUludChtWzZdLCAxMCksCgkJCQkJCTAKCQkJCQkpLmdldFRpbWUoKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGRhdGE7CgkJfTsKCgoJCXZhciBnZXRfaW1hZ2UgPSBmdW5jdGlvbiAodXJsLCBjYWxsYmFjaywgcHJvZ3Jlc3NfY2FsbGJhY2spIHsKCQkJLy8gTm90ZSB0aGF0IHRoZSBVaW50OEFycmF5J3MgbGVuZ3RoIGlzIGxvbmdlciB0aGFuIGltYWdlX2xlbmd0aAoJCQkvLyBjYWxsYmFjayhlcnIsIGltYWdlX2RhdGEsIGltYWdlX2xlbmd0aCk7CgkJCXZhciB4aHJfZGF0YSA9IHsKCQkJCW1ldGhvZDogIkdFVCIsCgkJCQl1cmw6IHVybCwKCQkJCW92ZXJyaWRlTWltZVR5cGU6ICJ0ZXh0L3BsYWluOyBjaGFyc2V0PXgtdXNlci1kZWZpbmVkIiwKCQkJCW9ubG9hZDogZnVuY3Rpb24gKHhocikgewoJCQkJCWlmICh4aHIuc3RhdHVzID09PSAyMDApIHsKCQkJCQkJdmFyIHRleHQgPSB4aHIucmVzcG9uc2VUZXh0LAoJCQkJCQkJdGEgPSBuZXcgVWludDhBcnJheSh0ZXh0Lmxlbmd0aCArIDEpLAoJCQkJCQkJY29udGVudF90eXBlID0gaGVhZGVyX3N0cmluZ19wYXJzZSh4aHIucmVzcG9uc2VIZWFkZXJzKVsiY29udGVudC10eXBlIl0gfHwgInRleHQvcGxhaW4iLAoJCQkJCQkJaSwgaWk7CgoJCQkJCQlmb3IgKGkgPSAwLCBpaSA9IHRleHQubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQkJdGFbaV0gPSB0ZXh0LmNoYXJDb2RlQXQoaSk7CgkJCQkJCX0KCgkJCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgbnVsbCwgdGEsIGlpLCBjb250ZW50X3R5cGUsIHhoci5maW5hbFVybCk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQljYWxsYmFjay5jYWxsKG51bGwsICQueGhyX2Vycm9yX3N0cmluZyh4aHIpLCBudWxsLCAwLCBudWxsLCBudWxsKTsKCQkJCQl9CgkJCQl9LAoJCQkJb25lcnJvcjogZnVuY3Rpb24gKCkgewoJCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgIkNvbm5lY3Rpb24gZXJyb3IiLCBudWxsLCAwLCBudWxsLCBudWxsKTsKCQkJCX0sCgkJCQlvbmFib3J0OiBmdW5jdGlvbiAoKSB7CgkJCQkJY2FsbGJhY2suY2FsbChudWxsLCAiQ29ubmVjdGlvbiBhYm9ydGVkIiwgbnVsbCwgMCwgbnVsbCwgbnVsbCk7CgkJCQl9CgkJCX07CgoJCQlpZiAocHJvZ3Jlc3NfY2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJCQkJeGhyX2RhdGEub25wcm9ncmVzcyA9IGZ1bmN0aW9uICh4aHIpIHsKCQkJCQlwcm9ncmVzc19jYWxsYmFjay5jYWxsKG51bGwsICJwcm9ncmVzcyIsIHhoci5sZW5ndGhDb21wdXRhYmxlLCB4aHIubG9hZGVkLCB4aHIudG90YWwpOwoJCQkJfTsKCQkJfQoKCQkJSHR0cFJlcXVlc3QoeGhyX2RhdGEpOwoJCX07CgkJdmFyIGdldF9zaGExX2hhc2ggPSBmdW5jdGlvbiAodXJsLCBtZDUsIGNhbGxiYWNrKSB7CgkJCXZhciBzaGExID0gbnVsbDsKCgkJCWlmIChtZDUgIT09IG51bGwpIHsKCQkJCXNoYTEgPSBoYXNoX2dldF9zaGExX2Zyb21fbWQ1KG1kNSk7CgkJCQlpZiAoc2hhMSA9PT0gbnVsbCkgewoJCQkJCXNoYTEgPSBoYXNoX2dldF9zaGExX2Zyb21fdXJsKHVybCk7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQlzaGExID0gaGFzaF9nZXRfc2hhMV9mcm9tX3VybCh1cmwpOwoJCQl9CgoJCQlpZiAoY2FsbGJhY2sgPT09IHVuZGVmaW5lZCkgewoJCQkJcmV0dXJuIHNoYTE7CgkJCX0KCgkJCWlmIChzaGExICE9PSBudWxsKSB7CgkJCQljYWxsYmFjay5jYWxsKG51bGwsIG51bGwsIHNoYTEpOwoJCQl9CgkJCWVsc2UgewoJCQkJZ2V0X2ltYWdlKHVybCwgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJCWlmIChlcnIgPT09IG51bGwpIHsKCQkJCQkJdmFyIHNoYTEgPSBTSEExLmhhc2goZGF0YSwgZGF0YS5sZW5ndGggLSAxKTsKCgkJCQkJCWlmIChtZDUgPT09IG51bGwpIHsKCQkJCQkJCWhhc2hfc2V0X3VybF90b19zaGExKHVybCwgc2hhMSk7CgkJCQkJCX0KCQkJCQkJZWxzZSB7CgkJCQkJCQloYXNoX3NldF9tZDVfdG9fc2hhMShtZDUsIHNoYTEpOwoJCQkJCQl9CgoJCQkJCQljYWxsYmFjay5jYWxsKG51bGwsIG51bGwsIHNoYTEpOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBlcnIsIG51bGwpOwoJCQkJCX0KCQkJCX0pOwoJCQl9CgoJCQlyZXR1cm4gbnVsbDsKCQl9OwoKCgoJCS8vIEFQSSByZXF1ZXN0IGJhc2UgY29kZQoJCXZhciByZXF1ZXN0X2dyb3VwcyA9IHt9OwoJCXZhciBSZXF1ZXN0R3JvdXAgPSBmdW5jdGlvbiAoKSB7CgkJCXRoaXMuYWN0aXZlID0gMDsKCQkJdGhpcy50aW1lb3V0ID0gbnVsbDsKCQkJdGhpcy50eXBlcyA9IFtdOwoJCX07CgkJdmFyIFJlcXVlc3RUeXBlID0gZnVuY3Rpb24gKGNvdW50LCBjb25jdXJyZW50LCBkZWxheV9va2F5LCBkZWxheV9lcnJvciwgZ3JvdXBfbmFtZSwgbmFtZXNwYWNlLCB0eXBlKSB7CgkJCXRoaXMuY291bnQgPSBjb3VudDsKCQkJdGhpcy5jb25jdXJyZW50ID0gY29uY3VycmVudDsKCQkJdGhpcy5kZWxheV9va2F5ID0gZGVsYXlfb2theTsKCQkJdGhpcy5kZWxheV9lcnJvciA9IGRlbGF5X2Vycm9yOwoJCQl0aGlzLnF1ZXVlID0gW107CgkJCXRoaXMudW5pcXVlID0ge307CgoJCQl0aGlzLmdyb3VwID0gcmVxdWVzdF9ncm91cHNbZ3JvdXBfbmFtZV07CgkJCWlmICh0aGlzLmdyb3VwID09PSB1bmRlZmluZWQpIHsKCQkJCXJlcXVlc3RfZ3JvdXBzW2dyb3VwX25hbWVdID0gdGhpcy5ncm91cCA9IG5ldyBSZXF1ZXN0R3JvdXAoKTsKCQkJfQoJCQl0aGlzLmdyb3VwLnR5cGVzLnB1c2godGhpcyk7CgoJCQl0aGlzLm5hbWVzcGFjZSA9IG5hbWVzcGFjZTsKCQkJdGhpcy50eXBlID0gdHlwZTsKCgkJCXRoaXMucmVxdWVzdF9pbml0ID0gbnVsbDsKCQkJdGhpcy5yZXF1ZXN0X2NvbXBsZXRlID0gbnVsbDsKCgkJCXRoaXMuZ2V0X2RhdGEgPSBudWxsOwoJCQl0aGlzLnNldF9kYXRhID0gbnVsbDsKCQkJdGhpcy5zZXR1cF94aHIgPSBudWxsOwoJCQl0aGlzLnBhcnNlX3Jlc3BvbnNlID0gbnVsbDsKCQl9OwoJCXZhciBSZXF1ZXN0RGF0YSA9IGZ1bmN0aW9uIChpZCwgaW5mbywgY2FsbGJhY2ssIHByb2dyZXNzX2NhbGxiYWNrKSB7CgkJCXRoaXMuaWQgPSBpZDsKCQkJdGhpcy5pbmZvID0gaW5mbzsKCQkJdGhpcy5jYWxsYmFja3MgPSBbIGNhbGxiYWNrIF07CgkJCXRoaXMucHJvZ3Jlc3NfY2FsbGJhY2tzID0gW107CgkJCWlmIChwcm9ncmVzc19jYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB0aGlzLnByb2dyZXNzX2NhbGxiYWNrcy5wdXNoKHByb2dyZXNzX2NhbGxiYWNrKTsKCQl9OwoJCXZhciBSZXF1ZXN0ID0gZnVuY3Rpb24gKHR5cGUsIGVudHJpZXMpIHsKCQkJdmFyIGNicywgaSwgaWk7CgoJCQl0aGlzLmRhdGEgPSBudWxsOwoJCQl0aGlzLnR5cGUgPSB0eXBlOwoJCQl0aGlzLnJldHJ5X2NvdW50ID0gMDsKCQkJdGhpcy5lbnRyaWVzID0gZW50cmllczsKCQkJdGhpcy5pbmZvcyA9IFtdOwoJCQl0aGlzLnByb2dyZXNzX2NhbGxiYWNrcyA9IG51bGw7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IGVudHJpZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJdGhpcy5pbmZvcy5wdXNoKGVudHJpZXNbaV0uaW5mbyk7CgoJCQkJY2JzID0gZW50cmllc1tpXS5wcm9ncmVzc19jYWxsYmFja3M7CgkJCQlpZiAoY2JzLmxlbmd0aCA+IDApIHsKCQkJCQlpZiAodGhpcy5wcm9ncmVzc19jYWxsYmFja3MgPT09IG51bGwpIHsKCQkJCQkJdGhpcy5wcm9ncmVzc19jYWxsYmFja3MgPSBjYnMuc2xpY2UoMCk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQkkLnB1c2hfbWFueSh0aGlzLnByb2dyZXNzX2NhbGxiYWNrcywgY2JzKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBSZXF1ZXN0RXJyb3JNb2RlID0gewoJCQlOb25lOiAwLAoJCQlOb0NhY2hlOiAxLAoJCQlTYXZlOiAyCgkJfTsKCgkJUmVxdWVzdEdyb3VwLnByb3RvdHlwZS5ydW5fZGVsYXkgPSBmdW5jdGlvbiAodHlwZSkgewoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCQkJCXR5cGUucnVuKCk7CgkJCX0sIDEpOwoJCX07CgkJUmVxdWVzdEdyb3VwLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAodXNlX2RlbGF5KSB7CgkJCXZhciB0eXBlLCBpLCBpaTsKCQkJZm9yIChpID0gMCwgaWkgPSB0aGlzLnR5cGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCXR5cGUgPSB0aGlzLnR5cGVzW2ldOwoJCQkJd2hpbGUgKHRydWUpIHsKCQkJCQlpZiAodGhpcy5hY3RpdmUgPj0gdHlwZS5jb25jdXJyZW50KSByZXR1cm47CgkJCQkJaWYgKHR5cGUucXVldWUubGVuZ3RoID09PSAwKSBicmVhazsKCQkJCQkrK3RoaXMuYWN0aXZlOwoKCQkJCQlpZiAodXNlX2RlbGF5ICYmIHR5cGUuY291bnQgPiAxKSB7CgkJCQkJCXRoaXMucnVuX2RlbGF5KHR5cGUpOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJdHlwZS5ydW4oKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9OwoJCVJlcXVlc3RHcm91cC5wcm90b3R5cGUuY29tcGxldGUgPSBmdW5jdGlvbiAoZGVsYXkpIHsKCQkJaWYgKGRlbGF5ID4gMCkgewoJCQkJdmFyIHNlbGYgPSB0aGlzOwoJCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCQkJLS1zZWxmLmFjdGl2ZTsKCQkJCQlzZWxmLnJ1bihmYWxzZSk7CgkJCQl9LCBkZWxheSk7CgkJCX0KCQkJZWxzZSB7CgkJCQktLXRoaXMuYWN0aXZlOwoJCQkJdGhpcy5ydW4oZmFsc2UpOwoJCQl9CgkJfTsKCgkJUmVxdWVzdFR5cGUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh1bmlxdWVfaWQsIGluZm8sIHF1aWNrLCBjYWxsYmFjaywgcHJvZ3Jlc3NfY2FsbGJhY2spIHsKCQkJdmFyIHNlbGYgPSB0aGlzOwoKCQkJdmFyIGdldF9kYXRhX2NhbGxiYWNrID0gZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJdmFyIHU7CgoJCQkJaWYgKGRhdGEgIT09IG51bGwpIHsKCQkJCQlpZiAocHJvZ3Jlc3NfY2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgcHJvZ3Jlc3NfY2FsbGJhY2suY2FsbChudWxsLCAic3RhcnQiKTsKCQkJCQljYWxsYmFjay5jYWxsKG51bGwsIG51bGwsIGRhdGEpOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAocXVpY2spIGVyciA9ICJOb3QgZm91bmQiOwoKCQkJCWlmICgKCQkJCQllcnIgIT09IG51bGwgfHwKCQkJCQkoZXJyID0gZ2V0X3NhdmVkX2Vycm9yKFsgc2VsZi5uYW1lc3BhY2UsIHNlbGYudHlwZSwgdW5pcXVlX2lkIF0pKSAhPT0gbnVsbAoJCQkJKSB7CgkJCQkJaWYgKHByb2dyZXNzX2NhbGxiYWNrICE9PSB1bmRlZmluZWQpIHByb2dyZXNzX2NhbGxiYWNrLmNhbGwobnVsbCwgInN0YXJ0Iik7CgkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBlcnIsIG51bGwpOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQkvLyBBZGQKCQkJCXUgPSBzZWxmLnVuaXF1ZVt1bmlxdWVfaWRdOwoJCQkJaWYgKHUgPT09IHVuZGVmaW5lZCkgewoJCQkJCXUgPSBuZXcgUmVxdWVzdERhdGEodW5pcXVlX2lkLCBpbmZvLCBjYWxsYmFjaywgcHJvZ3Jlc3NfY2FsbGJhY2spOwoJCQkJCXNlbGYudW5pcXVlW3VuaXF1ZV9pZF0gPSB1OwoJCQkJCXNlbGYucXVldWUucHVzaCh1KTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXUuY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spOwoJCQkJCWlmIChwcm9ncmVzc19jYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB1LnByb2dyZXNzX2NhbGxiYWNrcy5wdXNoKHByb2dyZXNzX2NhbGxiYWNrKTsKCQkJCX0KCgkJCQkvLyBSdW4gKGlmIG5vdCBhbHJlYWR5IHJ1bm5pbmcpCgkJCQlzZWxmLmdyb3VwLnJ1bih0cnVlKTsKCQkJfTsKCgkJCWlmICh0aGlzLmdldF9kYXRhID09PSBudWxsKSB7CgkJCQlnZXRfZGF0YV9jYWxsYmFjayhudWxsLCBudWxsKTsKCQkJfQoJCQllbHNlIHsKCQkJCXRoaXMuZ2V0X2RhdGEuY2FsbChudWxsLCBpbmZvLCBnZXRfZGF0YV9jYWxsYmFjayk7CgkJCX0KCQl9OwoJCVJlcXVlc3RUeXBlLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7CgkJCXZhciByZXEgPSBuZXcgUmVxdWVzdCh0aGlzLCB0aGlzLnF1ZXVlLnNwbGljZSgwLCB0aGlzLmNvdW50KSk7CgkJCWlmICh0aGlzLnJlcXVlc3RfaW5pdCAhPT0gbnVsbCkgewoJCQkJdGhpcy5yZXF1ZXN0X2luaXQuY2FsbCh0aGlzLCByZXEpOwoJCQl9CgkJCXJlcS5ydW4oKTsKCQl9OwoKCQlSZXF1ZXN0LnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBpLCBpaSwgZXY7CgoJCQlpZiAodGhpcy5wcm9ncmVzc19jYWxsYmFja3MgIT09IG51bGwpIHsKCQkJCWV2ID0gKHRoaXMucmV0cnlfY291bnQgPT09IDApID8gInN0YXJ0IiA6ICJyZXRyeSI7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IHRoaXMucHJvZ3Jlc3NfY2FsbGJhY2tzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQl0aGlzLnByb2dyZXNzX2NhbGxiYWNrc1tpXS5jYWxsKHRoaXMsIGV2KTsKCQkJCX0KCQkJfQoKCQkJdGhpcy50eXBlLnNldHVwX3hoci5jYWxsKHRoaXMsICQuYmluZCh0aGlzLm9uX3hocl9zZXR1cCwgdGhpcykpOwoJCX07CgkJUmVxdWVzdC5wcm90b3R5cGUucHJvY2Vzc19yZXNwb25zZSA9IGZ1bmN0aW9uIChlcnIsIHJlc3BvbnNlLCBkZWxheSkgewoJCQl2YXIgdG90YWwgPSB0aGlzLmluZm9zLmxlbmd0aCwKCQkJCXJlc3BvbnNlcyA9IE1hdGgubWluKHJlc3BvbnNlLmxlbmd0aCwgdG90YWwpLAoJCQkJc2V0X2RhdGEgPSB0aGlzLnR5cGUuc2V0X2RhdGEsCgkJCQljb21wbGV0ZSA9IDAsCgkJCQlkYXRhLCBlbnRyeSwgZXJyX21vZGUsIGk7CgoJCQkvLyBTYXZlCgkJCXZhciBzYXZlX2NhbGxiYWNrID0gZnVuY3Rpb24gKGVudHJ5LCBlcnIsIGRhdGEpIHsKCQkJCWZvciAodmFyIGkgPSAwLCBpaSA9IGVudHJ5LmNhbGxiYWNrcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJZW50cnkuY2FsbGJhY2tzW2ldLmNhbGwodGhpcywgZXJyLCBkYXRhKTsKCQkJCX0KCgkJCQlpZiAoKytjb21wbGV0ZSA+PSB0b3RhbCkgdGhpcy5jb21wbGV0ZShkZWxheSk7CgkJCX07CgoJCQkvLyBTYXZlIGVycm9ycwoJCQlmb3IgKGkgPSByZXNwb25zZXM7IGkgPCB0b3RhbDsgKytpKSB7CgkJCQllbnRyeSA9IHRoaXMuZW50cmllc1tpXTsKCQkJCXNldF9zYXZlZF9lcnJvcihbIHRoaXMudHlwZS5uYW1lc3BhY2UsIHRoaXMudHlwZS50eXBlLCBlbnRyeS5pZCBdLCBlcnIsIGZhbHNlKTsKCQkJCXNhdmVfY2FsbGJhY2suY2FsbCh0aGlzLCBlbnRyeSwgZXJyLCBudWxsKTsKCQkJfQoKCQkJLy8gU2F2ZSBkYXRhcwoJCQlmb3IgKGkgPSAwOyBpIDwgcmVzcG9uc2VzOyArK2kpIHsKCQkJCWRhdGEgPSByZXNwb25zZVtpXTsKCQkJCWVudHJ5ID0gdGhpcy5lbnRyaWVzW2ldOwoJCQkJaWYgKHR5cGVvZigoZXJyID0gZGF0YS5lcnJvcikpID09PSAic3RyaW5nIikgewoJCQkJCWlmICh0eXBlb2YoKGVycl9tb2RlID0gZGF0YS5lcnJvcl9tb2RlKSkgIT09ICJudW1iZXIiKSBlcnJfbW9kZSA9IFJlcXVlc3RFcnJvck1vZGUuU2F2ZTsKCQkJCQlzZXRfc2F2ZWRfZXJyb3IoWyB0aGlzLnR5cGUubmFtZXNwYWNlLCB0aGlzLnR5cGUudHlwZSwgZW50cnkuaWQgXSwgZXJyLCAoZXJyX21vZGUgPT09IFJlcXVlc3RFcnJvck1vZGUuU2F2ZSkpOwoJCQkJCXNhdmVfY2FsbGJhY2suY2FsbCh0aGlzLCBlbnRyeSwgZXJyLCBkYXRhKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWVyciA9IG51bGw7CgkJCQkJaWYgKHNldF9kYXRhICE9PSBudWxsKSB7CgkJCQkJCXNldF9kYXRhLmNhbGwodGhpcywgZGF0YSwgZW50cnkuaW5mbywgJC5iaW5kKHNhdmVfY2FsbGJhY2ssIHRoaXMsIGVudHJ5LCBudWxsLCBkYXRhKSk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlzYXZlX2NhbGxiYWNrLmNhbGwodGhpcywgZW50cnksIG51bGwsIGRhdGEpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX07CgkJUmVxdWVzdC5wcm90b3R5cGUuY29tcGxldGVfZW50cmllcyA9IGZ1bmN0aW9uICgpIHsKCQkJdmFyIHVuaXF1ZSA9IHRoaXMudHlwZS51bmlxdWU7CgkJCWZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuZW50cmllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlkZWxldGUgdW5pcXVlW3RoaXMuZW50cmllc1tpXS5pZF07CgkJCX0KCQl9OwoJCVJlcXVlc3QucHJvdG90eXBlLmNvbXBsZXRlID0gZnVuY3Rpb24gKGRlbGF5KSB7CgkJCWlmICh0aGlzLnR5cGUucmVxdWVzdF9jb21wbGV0ZSAhPT0gbnVsbCkgewoJCQkJdGhpcy50eXBlLnJlcXVlc3RfY29tcGxldGUuY2FsbCh0aGlzLnR5cGUsIHRoaXMpOwoJCQl9CgkJCXRoaXMudHlwZS5ncm91cC5jb21wbGV0ZShkZWxheSk7CgkJfTsKCQlSZXF1ZXN0LnByb3RvdHlwZS54aHJfZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7CgkJCXZhciBzZWxmID0gdGhpczsKCQkJcmV0dXJuIGZ1bmN0aW9uICgpIHsKCQkJCXNlbGYuY29tcGxldGVfZW50cmllcygpOwoJCQkJc2VsZi5wcm9jZXNzX3Jlc3BvbnNlKGVyciwgW10sIHNlbGYudHlwZS5kZWxheV9lcnJvcik7CgkJCX07CgkJfTsKCQlSZXF1ZXN0LnByb3RvdHlwZS5vbl94aHJfc2V0dXAgPSBmdW5jdGlvbiAoZXJyLCB4aHJfZGF0YSkgewoJCQl2YXIgc2VsZiA9IHRoaXMsCgkJCQlhbnlfc3RhdHVzID0gKHhocl9kYXRhLmFueV9zdGF0dXMgPT09IHRydWUpLAoJCQkJaSwgaWksIGV2OwoKCQkJLy8gRXJyb3IKCQkJaWYgKGVyciAhPT0gbnVsbCkgewoJCQkJdGhpcy54aHJfZXJyb3IoZXJyKSgpOwoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBMb2FkIGhhbmRsZXIKCQkJeGhyX2RhdGEub25sb2FkID0gZnVuY3Rpb24gKHhocikgewoJCQkJaWYgKHhoci5zdGF0dXMgPT09IDIwMCB8fCBhbnlfc3RhdHVzKSB7CgkJCQkJc2VsZi50eXBlLnBhcnNlX3Jlc3BvbnNlLmNhbGwoc2VsZiwgeGhyLCBmdW5jdGlvbiAoZXJyLCByZXNwb25zZSkgewoJCQkJCQlzZWxmLm9uX3Jlc3BvbnNlX3BhcnNlKGVyciwgcmVzcG9uc2UpOwoJCQkJCX0pOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJc2VsZi54aHJfZXJyb3IoJC54aHJfZXJyb3Jfc3RyaW5nKHhocikpKCk7CgkJCQl9CgkJCX07CgoJCQkvLyBFcnJvciBoYW5kbGVycwoJCQl4aHJfZGF0YS5vbmVycm9yID0gdGhpcy54aHJfZXJyb3IoIkNvbm5lY3Rpb24gZXJyb3IiKTsKCQkJeGhyX2RhdGEub25hYm9ydCA9IHRoaXMueGhyX2Vycm9yKCJDb25uZWN0aW9uIGFib3J0ZWQiKTsKCgkJCWlmICh4aHJfZGF0YS5kYXRhICE9PSB1bmRlZmluZWQpIHsKCQkJCXhocl9kYXRhLnVwbG9hZCA9IHsKCQkJCQlvbmVycm9yOiB0aGlzLnhocl9lcnJvcigiVXBsb2FkIGNvbm5lY3Rpb24gZXJyb3IiKSwKCQkJCQlvbmFib3J0OiB0aGlzLnhocl9lcnJvcigiVXBsb2FkIGNvbm5lY3Rpb24gYWJvcnRlZCIpCgkJCQl9OwoJCQl9CgoJCQkvLyBQcm9ncmVzcyBoYW5kbGVycwoJCQlpZiAodGhpcy5wcm9ncmVzc19jYWxsYmFja3MgIT09IG51bGwpIHsKCQkJCXhocl9kYXRhLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbiAoeGhyKSB7CgkJCQkJZm9yICh2YXIgaSA9IDAsIGlpID0gc2VsZi5wcm9ncmVzc19jYWxsYmFja3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQlzZWxmLnByb2dyZXNzX2NhbGxiYWNrc1tpXS5jYWxsKHNlbGYsICJwcm9ncmVzcyIsIHhoci5sZW5ndGhDb21wdXRhYmxlLCB4aHIubG9hZGVkLCB4aHIudG90YWwpOwoJCQkJCX0KCQkJCX07CgoJCQkJaWYgKHhocl9kYXRhLmRhdGEgIT09IHVuZGVmaW5lZCkgewoJCQkJCWV2ID0gInVwbG9hZCI7CgkJCQkJeGhyX2RhdGEudXBsb2FkLm9ucHJvZ3Jlc3MgPSB4aHJfZGF0YS5vbnByb2dyZXNzOwoJCQkJCXhocl9kYXRhLnVwbG9hZC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CgkJCQkJCWZvciAodmFyIGkgPSAwLCBpaSA9IHNlbGYucHJvZ3Jlc3NfY2FsbGJhY2tzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJCXNlbGYucHJvZ3Jlc3NfY2FsbGJhY2tzW2ldLmNhbGwoc2VsZiwgImRvd25sb2FkIik7CgkJCQkJCX0KCQkJCQl9OwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJZXYgPSAiZG93bmxvYWQiOwoJCQkJfQoKCQkJCWZvciAoaSA9IDAsIGlpID0gdGhpcy5wcm9ncmVzc19jYWxsYmFja3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCXRoaXMucHJvZ3Jlc3NfY2FsbGJhY2tzW2ldLmNhbGwodGhpcywgZXYpOwoJCQkJfQoJCQkJZXYgPSBudWxsOwoJCQl9CgoJCQkvLyBTdGFydAoJCQlIdHRwUmVxdWVzdCh4aHJfZGF0YSk7CgkJCXhocl9kYXRhID0gbnVsbDsKCQl9OwoJCVJlcXVlc3QucHJvdG90eXBlLm9uX3Jlc3BvbnNlX3BhcnNlID0gZnVuY3Rpb24gKGVyciwgcmVzcG9uc2UsIGRlbGF5KSB7CgkJCWlmIChlcnIgIT09IG51bGwpIHsKCQkJCS8vIEVycm9yCgkJCQlpZiAodHlwZW9mKGRlbGF5KSAhPT0gIm51bWJlciIpIGRlbGF5ID0gdGhpcy50eXBlLmRlbGF5X2Vycm9yOwoJCQkJdGhpcy5jb21wbGV0ZV9lbnRyaWVzKCk7CgkJCQl0aGlzLnByb2Nlc3NfcmVzcG9uc2UoZXJyLCBbXSwgZGVsYXkpOwoJCQl9CgkJCWVsc2UgaWYgKHJlc3BvbnNlID09PSBudWxsKSB7CgkJCQkvLyBSZXRyeQoJCQkJKyt0aGlzLnJldHJ5X2NvdW50OwoJCQkJaWYgKHR5cGVvZihkZWxheSkgIT09ICJudW1iZXIiKSBkZWxheSA9IDA7CgkJCQlpZiAoZGVsYXkgPiAwKSB7CgkJCQkJdmFyIHNlbGYgPSB0aGlzOwoJCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBzZWxmLnJ1bigpOyB9LCBkZWxheSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQl0aGlzLnJ1bigpOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJLy8gUHJvY2VzcwoJCQkJaWYgKHR5cGVvZihkZWxheSkgIT09ICJudW1iZXIiKSBkZWxheSA9IHRoaXMudHlwZS5kZWxheV9va2F5OwoJCQkJdGhpcy5jb21wbGV0ZV9lbnRyaWVzKCk7CgkJCQl0aGlzLnByb2Nlc3NfcmVzcG9uc2UoIkRhdGEgbm90IGZvdW5kIiwgcmVzcG9uc2UsIGRlbGF5KTsKCQkJfQoJCX07CgoKCgkJLy8gQVBJIHJlcXVlc3Qgc3BlY2lhbGl6YXRpb25zCgkJdmFyIHJ0X2VoZW50YWlfZ2FsbGVyeV9wYWdlID0gbmV3IFJlcXVlc3RUeXBlKDI1LCAxLCAyMDAsIDUwMDAsICJlaGVudGFpX2FwaSIsICJlaGVudGFpIiwgInBhZ2UiKSwKCQkJcnRfZWhlbnRhaV9nYWxsZXJ5ID0gbmV3IFJlcXVlc3RUeXBlKDI1LCAxLCAyMDAsIDUwMDAsICJlaGVudGFpX2FwaSIsICJlaGVudGFpIiwgImdhbGxlcnkiKSwKCQkJcnRfZWhlbnRhaV9nYWxsZXJ5X2Z1bGwgPSBuZXcgUmVxdWVzdFR5cGUoMSwgMSwgMjAwLCA1MDAwLCAiZWhlbnRhaV9mdWxsIiwgImVoZW50YWkiLCAiZnVsbCIpLAoJCQlydF9laGVudGFpX2dhbGxlcnlfcGFnZV90aHVtYiA9IG5ldyBSZXF1ZXN0VHlwZSgxLCAxLCAyMDAsIDUwMDAsICJlaGVudGFpX2Z1bGwiLCAiZWhlbnRhaSIsICJwYWdlX3RodW1iIiksCgkJCXJ0X2VoZW50YWlfbG9va3VwID0gbmV3IFJlcXVlc3RUeXBlKDEsIDEsIDMwMDAsIDUwMDAsICJlaGVudGFpX2xvb2t1cCIsICJlaGVudGFpIiwgImxvb2t1cCIpLAoJCQlydF9uaGVudGFpX2dhbGxlcnkgPSBuZXcgUmVxdWVzdFR5cGUoMSwgMSwgMjAwLCA1MDAwLCAibmhlbnRhaSIsICJuaGVudGFpIiwgImdhbGxlcnkiKSwKCQkJcnRfbmhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIgPSBuZXcgUmVxdWVzdFR5cGUoMSwgMSwgMjAwLCA1MDAwLCAibmhlbnRhaSIsICJuaGVudGFpIiwgInBhZ2VfdGh1bWIiKSwKCQkJcnRfaGl0b21pX2dhbGxlcnkgPSBuZXcgUmVxdWVzdFR5cGUoMSwgMSwgMjAwLCA1MDAwLCAiaGl0b21pIiwgImhpdG9taSIsICJnYWxsZXJ5IiksCgkJCXJ0X2hpdG9taV9nYWxsZXJ5X3BhZ2VfdGh1bWIgPSBuZXcgUmVxdWVzdFR5cGUoMSwgMSwgMjAwLCA1MDAwLCAiaGl0b21pIiwgImhpdG9taSIsICJwYWdlX3RodW1iIik7CgoJCXJ0X2VoZW50YWlfZ2FsbGVyeS5nZXRfZGF0YSA9IGZ1bmN0aW9uIChpbmZvLCBjYWxsYmFjaykgewoJCQl2YXIgZGF0YSA9IGdldF9zYXZlZF9kYXRhKGluZm8uaWQpOwoJCQljYWxsYmFjayhudWxsLCAoZGF0YSAhPT0gbnVsbCAmJiBkYXRhLnRva2VuID09PSBpbmZvLnRva2VuKSA/IGRhdGEgOiBudWxsKTsKCQl9OwoJCXJ0X2VoZW50YWlfZ2FsbGVyeS5zZXRfZGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBpbmZvLCBjYWxsYmFjaykgewoJCQlzZXRfc2F2ZWRfZGF0YShpbmZvLmlkLCBkYXRhKTsKCQkJY2FsbGJhY2sobnVsbCk7CgkJfTsKCQlydF9laGVudGFpX2dhbGxlcnkuc2V0dXBfeGhyID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkJCXZhciBnaWRsaXN0ID0gW10sCgkJCQlpbmZvLCBpLCBpaTsKCgkJCWZvciAoaSA9IDAsIGlpID0gdGhpcy5pbmZvcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlpbmZvID0gdGhpcy5pbmZvc1tpXTsKCQkJCWdpZGxpc3QucHVzaChbIGluZm8uZ2lkLCBpbmZvLnRva2VuIF0pOwoJCQl9CgoJCQljYWxsYmFjayhudWxsLCB7CgkJCQltZXRob2Q6ICJQT1NUIiwKCQkJCXVybDogImh0dHBzOi8vIiArIGRvbWFpbnMuZWhlbnRhaSArICIvYXBpLnBocCIsCgkJCQloZWFkZXJzOiB7ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKCQkJCWRhdGE6IEpTT04uc3RyaW5naWZ5KHsKCQkJCQltZXRob2Q6ICJnZGF0YSIsCgkJCQkJZ2lkbGlzdDogZ2lkbGlzdCwKCQkJCQluYW1lc3BhY2U6IDEKCQkJCX0pCgkJCX0pOwoJCX07CgkJcnRfZWhlbnRhaV9nYWxsZXJ5LnBhcnNlX3Jlc3BvbnNlID0gZnVuY3Rpb24gKHhociwgY2FsbGJhY2spIHsKCQkJdmFyIHJlc3BvbnNlID0gJC5qc29uX3BhcnNlX3NhZmUoeGhyLnJlc3BvbnNlVGV4dCwgbnVsbCksCgkJCQlkYXRhcywgaSwgaWk7CgoJCQlpZiAocmVzcG9uc2UgIT09IG51bGwpIHsKCQkJCWlmICh0eXBlb2YocmVzcG9uc2UpID09PSAib2JqZWN0IikgewoJCQkJCWlmICh0eXBlb2YocmVzcG9uc2UuZXJyb3IpID09PSAic3RyaW5nIikgewoJCQkJCQljYWxsYmFjayhyZXNwb25zZS5lcnJvcik7CgkJCQkJCXJldHVybjsKCQkJCQl9CgkJCQkJZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZXNwb25zZS5nbWV0YWRhdGEpKSB7CgkJCQkJCXJlc3BvbnNlID0gcmVzcG9uc2UuZ21ldGFkYXRhOwoJCQkJCQlkYXRhcyA9IFtdOwoJCQkJCQlmb3IgKGkgPSAwLCBpaSA9IHJlc3BvbnNlLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJCWRhdGFzLnB1c2goZWhlbnRhaV9ub3JtYWxpemVfaW5mbyhyZXNwb25zZVtpXSkpOwoJCQkJCQl9CgkJCQkJCWNhbGxiYWNrKG51bGwsIGRhdGFzKTsKCQkJCQkJcmV0dXJuOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UgaWYgKHR5cGVvZihyZXNwb25zZSkgPT09ICJzdHJpbmciKSB7CgkJCQkJY2FsbGJhY2socmVzcG9uc2UpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gIkludmFsaWQgcmVzcG9uc2UiOwoJCX07CgoJCXJ0X2VoZW50YWlfZ2FsbGVyeV9wYWdlLmdldF9kYXRhID0gZnVuY3Rpb24gKGluZm8sIGNhbGxiYWNrKSB7CgkJCXZhciBkYXRhID0gZ2V0X3NhdmVkX2RhdGEoaW5mby5pZCk7CgkJCWlmIChkYXRhICE9PSBudWxsKSB7CgkJCQljYWxsYmFjayhudWxsLCB7CgkJCQkJZ2lkOiBkYXRhLmdpZCwKCQkJCQl0b2tlbjogZGF0YS50b2tlbgoJCQkJfSk7CgkJCX0KCQkJZWxzZSB7CgkJCQljYWxsYmFjayhudWxsLCBudWxsKTsKCQkJfQoJCX07CgkJcnRfZWhlbnRhaV9nYWxsZXJ5X3BhZ2Uuc2V0dXBfeGhyID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkJCXZhciBwYWdlbGlzdCA9IFtdLAoJCQkJaW5mbywgaSwgaWk7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IHRoaXMuaW5mb3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJaW5mbyA9IHRoaXMuaW5mb3NbaV07CgkJCQlwYWdlbGlzdC5wdXNoKFsgaW5mby5naWQsIGluZm8ucGFnZV90b2tlbiwgaW5mby5wYWdlIF0pOwoJCQl9CgoJCQljYWxsYmFjayhudWxsLCB7CgkJCQltZXRob2Q6ICJQT1NUIiwKCQkJCXVybDogImh0dHBzOi8vIiArIGRvbWFpbnMuZWhlbnRhaSArICIvYXBpLnBocCIsCgkJCQloZWFkZXJzOiB7ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIgfSwKCQkJCWRhdGE6IEpTT04uc3RyaW5naWZ5KHsKCQkJCQltZXRob2Q6ICJndG9rZW4iLAoJCQkJCXBhZ2VsaXN0OiBwYWdlbGlzdAoJCQkJfSkKCQkJfSk7CgkJfTsKCQlydF9laGVudGFpX2dhbGxlcnlfcGFnZS5wYXJzZV9yZXNwb25zZSA9IGZ1bmN0aW9uICh4aHIsIGNhbGxiYWNrKSB7CgkJCXZhciByZXNwb25zZSA9ICQuanNvbl9wYXJzZV9zYWZlKHhoci5yZXNwb25zZVRleHQsIG51bGwpOwoKCQkJaWYgKHJlc3BvbnNlICE9PSBudWxsKSB7CgkJCQlpZiAodHlwZW9mKHJlc3BvbnNlKSA9PT0gIm9iamVjdCIpIHsKCQkJCQlpZiAodHlwZW9mKHJlc3BvbnNlLmVycm9yKSA9PT0gInN0cmluZyIpIHsKCQkJCQkJY2FsbGJhY2socmVzcG9uc2UuZXJyb3IpOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJCWVsc2UgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UudG9rZW5saXN0KSkgewoJCQkJCQljYWxsYmFjayhudWxsLCByZXNwb25zZS50b2tlbmxpc3QpOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoJCQkJfQoJCQkJZWxzZSBpZiAodHlwZW9mKHJlc3BvbnNlKSA9PT0gInN0cmluZyIpIHsKCQkJCQljYWxsYmFjayhyZXNwb25zZSk7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgoJCQljYWxsYmFjaygiSW52YWxpZCByZXNwb25zZSIpOwoJCX07CgoJCXJ0X2VoZW50YWlfZ2FsbGVyeV9mdWxsLmdldF9kYXRhID0gZnVuY3Rpb24gKGluZm8sIGNhbGxiYWNrKSB7CgkJCWNhbGxiYWNrKG51bGwsIGluZm8uZGF0YS5mdWxsID8gaW5mby5kYXRhIDogbnVsbCk7CgkJfTsKCQlydF9laGVudGFpX2dhbGxlcnlfZnVsbC5zZXRfZGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBpbmZvLCBjYWxsYmFjaykgewoJCQlzZXRfc2F2ZWRfZGF0YShpbmZvLmluZm8uaWQsIGRhdGEpOwoJCQljYWxsYmFjayhudWxsKTsKCQl9OwoJCXJ0X2VoZW50YWlfZ2FsbGVyeV9mdWxsLnNldHVwX3hociA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewoJCQl2YXIgaW5mbyA9IHRoaXMuaW5mb3NbMF07CgkJCWNhbGxiYWNrKG51bGwsIHsKCQkJCW1ldGhvZDogIkdFVCIsCgkJCQl1cmw6ICJodHRwOi8vIiArIGluZm8uZG9tYWluICsgIi9nLyIgKyBpbmZvLmdpZCArICIvIiArIGluZm8udG9rZW4gKyAiLyIgKyBpbmZvLnNlYXJjaCwKCQkJCWFueV9zdGF0dXM6IHRydWUKCQkJfSk7CgkJfTsKCQlydF9laGVudGFpX2dhbGxlcnlfZnVsbC5wYXJzZV9yZXNwb25zZSA9IGZ1bmN0aW9uICh4aHIsIGNhbGxiYWNrKSB7CgkJCXZhciBpbmZvID0gdGhpcy5pbmZvc1swXTsKCQkJaWYgKHhoci5zdGF0dXMgPT09IDIwMCB8fCB4aHIuc3RhdHVzID09PSA0MDQpIHsKCQkJCWVoZW50YWlfcmVzcG9uc2VfcHJvY2Vzc19nZW5lcmljLmNhbGwodGhpcywgeGhyLCBpbmZvLCB0aGlzLnR5cGUuZGVsYXlfb2theSwgY2FsbGJhY2ssIGZ1bmN0aW9uIChlcnIsIGh0bWwpIHsKCQkJCQljYWxsYmFjayhudWxsLCBbIGVyciA9PT0gbnVsbCA/IGVoZW50YWlfcGFyc2VfZ2FsbGVyeV9pbmZvKGh0bWwsIGluZm8uZGF0YSkgOiBlaGVudGFpX21ha2VfcmVtb3ZlZChpbmZvLmRhdGEpIF0pOwoJCQkJfSk7CgkJCX0KCQkJZWxzZSB7CgkJCQljYWxsYmFjayhudWxsLCBbIGVoZW50YWlfbWFrZV9yZW1vdmVkKGluZm8uZGF0YSkgXSk7CgkJCX0KCQl9OwoJCXZhciBlaGVudGFpX3Jlc3BvbnNlX3Byb2Nlc3NfZ2VuZXJpYyA9IGZ1bmN0aW9uICh4aHIsIGluZm8sIHJldHJ5X2RlbGF5LCBjYWxsYmFjaywgcHJvY2Vzc19jYWxsYmFjaykgewoJCQl2YXIgY29udGVudF90eXBlID0gaGVhZGVyX3N0cmluZ19wYXJzZSh4aHIucmVzcG9uc2VIZWFkZXJzKVsiY29udGVudC10eXBlIl0sCgkJCQlodG1sOwoKCQkJaWYgKCEoL150ZXh0XC9odG1sL2kpLnRlc3QoY29udGVudF90eXBlIHx8ICIiKSkgewoJCQkJLy8gUGFuZGEKCQkJCWlmICh0aGlzLnJldHJ5X2NvdW50ID09PSAwICYmIGluZm8uZG9tYWluID09PSBkb21haW5zLmV4aGVudGFpKSB7CgkJCQkJLy8gUmV0cnkKCQkJCQlpbmZvLmRvbWFpbiA9IGRvbWFpbnMuZ2VoZW50YWk7CgkJCQkJY2FsbGJhY2sobnVsbCwgbnVsbCwgcmV0cnlfZGVsYXkpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJY2FsbGJhY2soIkludmFsaWQgcmVzcG9uc2UgdHlwZSAiICsgY29udGVudF90eXBlKTsKCQkJCX0KCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gUGFyc2UKCQkJaHRtbCA9ICQuaHRtbF9wYXJzZV9zYWZlKHhoci5yZXNwb25zZVRleHQsIG51bGwpOwoJCQlpZiAoaHRtbCA9PT0gbnVsbCkgewoJCQkJY2FsbGJhY2soIkludmFsaWQgcmVzcG9uc2UiKTsKCQkJfQoJCQllbHNlIGlmIChlaGVudGFpX2lzX25vdF9hdmFpbGFibGUoaHRtbCkpIHsKCQkJCWlmICh0aGlzLnJldHJ5X2NvdW50ID09PSAwICYmIGluZm8uZG9tYWluID09PSBkb21haW5zLmdlaGVudGFpKSB7CgkJCQkJLy8gUmV0cnkKCQkJCQlpbmZvLmRvbWFpbiA9IGRvbWFpbnMuZXhoZW50YWk7CgkJCQkJY2FsbGJhY2sobnVsbCwgbnVsbCwgcmV0cnlfZGVsYXkpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdGhpcy5yZXRyeV9jb3VudCA9IDA7CgkJCQkJcHJvY2Vzc19jYWxsYmFjay5jYWxsKHRoaXMsICJOb3QgYXZhaWxhYmxlIiwgbnVsbCk7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAoZWhlbnRhaV9pc19jb250ZW50X3dhcm5pbmcoaHRtbCkpIHsKCQkJCWlmICh0aGlzLnJldHJ5X2NvdW50IDw9IDEpIHsKCQkJCQkvLyBSZXRyeQoJCQkJCWluZm8uc2VhcmNoID0gIj9udz1zZXNzaW9uIjsgLy8gYnlwYXNzIHRoZSAiQ29udGVudCBXYXJuaW5nIgoJCQkJCWNhbGxiYWNrKG51bGwsIG51bGwsIHJldHJ5X2RlbGF5KTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXRoaXMucmV0cnlfY291bnQgPSAwOwoJCQkJCXByb2Nlc3NfY2FsbGJhY2suY2FsbCh0aGlzLCAiQ29udGVudCB3YXJuaW5nIiwgbnVsbCk7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLnJldHJ5X2NvdW50ID0gMDsKCQkJCXByb2Nlc3NfY2FsbGJhY2suY2FsbCh0aGlzLCBudWxsLCBodG1sKTsKCQkJfQoJCX07CgoJCXJ0X2VoZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iLmdldF9kYXRhID0gZnVuY3Rpb24gKGluZm8sIGNhbGxiYWNrKSB7CgkJCWNhbGxiYWNrKG51bGwsIGdldF9zYXZlZF90aHVtYm5haWwoImVoZW50YWkiLCBpbmZvLmdpZCwgaW5mby5wYWdlKSk7CgkJfTsKCQlydF9laGVudGFpX2dhbGxlcnlfcGFnZV90aHVtYi5zZXRfZGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBpbmZvLCBjYWxsYmFjaykgewoJCQlzZXRfc2F2ZWRfdGh1bWJuYWlsKCJlaGVudGFpIiwgaW5mby5naWQsIGluZm8ucGFnZSwgZGF0YSk7CgkJCWNhbGxiYWNrKG51bGwpOwoJCX07CgkJcnRfZWhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIuc2V0dXBfeGhyID0gcnRfZWhlbnRhaV9nYWxsZXJ5X2Z1bGwuc2V0dXBfeGhyOwoJCXJ0X2VoZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iLnBhcnNlX3Jlc3BvbnNlID0gZnVuY3Rpb24gKHhociwgY2FsbGJhY2spIHsKCQkJdmFyIGluZm8gPSB0aGlzLmluZm9zWzBdLAoJCQkJcmV0cnlfZGVsYXkgPSAwOyAvLyB0aGlzLnR5cGUuZGVsYXlfb2theQoKCQkJZWhlbnRhaV9yZXNwb25zZV9wcm9jZXNzX2dlbmVyaWMuY2FsbCh0aGlzLCB4aHIsIGluZm8sIHJldHJ5X2RlbGF5LCBjYWxsYmFjaywgZnVuY3Rpb24gKGVyciwgaHRtbCkgewoJCQkJaWYgKGVyciAhPT0gbnVsbCkgewoJCQkJCWNhbGxiYWNrKGVycik7CgkJCQkJcmV0dXJuOwoJCQkJfQoKCQkJCXZhciBuMSA9ICQoIi5ndGI+LmdwYyIsIGh0bWwpLAoJCQkJCXNtYWxsID0gZmFsc2UsCgkJCQkJcmVfY29tbWEgPSAvLC9nLAoJCQkJCXN0YXJ0LCBlbmQsIHRvdGFsLCBtLCBuMiwgdXJsLCB0OwoKCQkJCWlmIChuMSAhPT0gbnVsbCkgewoJCQkJCW0gPSAvKFtcZCxdKylccyotXHMqKFtcZCxdKylccypvZlxzKihbXGQsXSspL2kuZXhlYyhuMS50ZXh0Q29udGVudCk7CgkJCQkJaWYgKG0gIT09IG51bGwpIHsKCQkJCQkJc3RhcnQgPSBwYXJzZUludChtWzFdLnJlcGxhY2UocmVfY29tbWEsICIiKSwgMTApOwoJCQkJCQllbmQgPSBwYXJzZUludChtWzJdLnJlcGxhY2UocmVfY29tbWEsICIiKSwgMTApOwoJCQkJCQl0b3RhbCA9IHBhcnNlSW50KG1bM10ucmVwbGFjZShyZV9jb21tYSwgIiIpLCAxMCk7CgoJCQkJCQlpZiAoaW5mby5wYWdlID49IHN0YXJ0ICYmIGluZm8ucGFnZSA8PSBlbmQpIHsKCQkJCQkJCW4xID0gJCgiI2dkdCIsIGh0bWwpOwoJCQkJCQkJaWYgKG4xICE9PSBudWxsKSB7CgkJCQkJCQkJbjIgPSAkJCgiLmdkdGwiLCBuMSk7CgkJCQkJCQkJaWYgKG4yLmxlbmd0aCA9PT0gMCkgewoJCQkJCQkJCQluMiA9ICQkKCIuZ2R0bSIsIG4xKTsKCQkJCQkJCQkJc21hbGwgPSB0cnVlOwoJCQkJCQkJCX0KCgkJCQkJCQkJbjEgPSBuMltpbmZvLnBhZ2UgLSBzdGFydF07CgkJCQkJCQkJaWYgKG4xICE9PSB1bmRlZmluZWQpIHsKCQkJCQkJCQkJLy8gQ2hlY2sgZm9yIGltYWdlCgkJCQkJCQkJCWlmIChzbWFsbCkgewoJCQkJCQkJCQkJaWYgKAoJCQkJCQkJCQkJCShuMiA9ICQoImRpdiIsIG4xKSkgIT09IG51bGwgJiYKCQkJCQkJCQkJCQkodCA9IG4yLmdldEF0dHJpYnV0ZSgic3R5bGUiKSkKCQkJCQkJCQkJCSkgewoJCQkJCQkJCQkJCS8vIFNtYWxsIGltYWdlCgkJCQkJCQkJCQkJbSA9IFsKCQkJCQkJCQkJCQkJL3VybFwoWyciXT8oW14nIlwpXSopWyciXT9cKVxzKi0oXGQrKXB4Ly5leGVjKHQpLAoJCQkJCQkJCQkJCQkvd2lkdGhccyo6XHMqKFxkKylweC8uZXhlYyh0KSwKCQkJCQkJCQkJCQkJL2hlaWdodFxzKjpccyooXGQrKXB4Ly5leGVjKHQpCgkJCQkJCQkJCQkJXTsKCQkJCQkJCQkJCQlpZiAobVswXSAhPT0gbnVsbCAmJiBtWzFdICE9PSBudWxsICYmIG1bMl0gIT09IG51bGwpIHsKCQkJCQkJCQkJCQkJdXJsID0gbVswXVsxXTsKCQkJCQkJCQkJCQkJY2FsbGJhY2sobnVsbCwgW3sKCQkJCQkJCQkJCQkJCXVybDogJC5yZXNvbHZlKHVybCwgeGhyLmZpbmFsVXJsKSwKCQkJCQkJCQkJCQkJCWxlZnQ6IHBhcnNlSW50KG1bMF1bMl0sIDEwKSwKCQkJCQkJCQkJCQkJCXRvcDogMCwKCQkJCQkJCQkJCQkJCXdpZHRoOiBwYXJzZUludChtWzFdWzFdLCAxMCksCgkJCQkJCQkJCQkJCQloZWlnaHQ6IHBhcnNlSW50KG1bMl1bMV0sIDEwKSwKCQkJCQkJCQkJCQkJCWZsYWdzOiBJbWFnZUZsYWdzLk5vbmUKCQkJCQkJCQkJCQkJfV0pOwoJCQkJCQkJCQkJCQlyZXR1cm47CgkJCQkJCQkJCQkJfQoJCQkJCQkJCQkJfQoJCQkJCQkJCQl9CgkJCQkJCQkJCWVsc2UgewoJCQkJCQkJCQkJaWYgKAoJCQkJCQkJCQkJCShuMiA9ICQoImltZyIsIG4xKSkgIT09IG51bGwgJiYKCQkJCQkJCQkJCQkodXJsID0gbjIuZ2V0QXR0cmlidXRlKCJzcmMiKSkKCQkJCQkJCQkJCSkgewoJCQkJCQkJCQkJCS8vIEZ1bGwgaW1hZ2UKCQkJCQkJCQkJCQljYWxsYmFjayhudWxsLCBbewoJCQkJCQkJCQkJCQl1cmw6ICQucmVzb2x2ZSh1cmwsIHhoci5maW5hbFVybCksCgkJCQkJCQkJCQkJCWxlZnQ6IDAsCgkJCQkJCQkJCQkJCXRvcDogMCwKCQkJCQkJCQkJCQkJd2lkdGg6IC0xLAoJCQkJCQkJCQkJCQloZWlnaHQ6IC0xLAoJCQkJCQkJCQkJCQlmbGFnczogSW1hZ2VGbGFncy5Ob25lCgkJCQkJCQkJCQkJfV0pOwoJCQkJCQkJCQkJCXJldHVybjsKCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQllbHNlIGlmIChpbmZvLnBhZ2UgPj0gMSAmJiBpbmZvLnBhZ2UgPD0gdG90YWwpIHsKCQkJCQkJCS8vIFdyb25nIHBhZ2UKCQkJCQkJCWlmICh0aGlzLnJldHJ5X2NvdW50ID09PSAwKSB7CgkJCQkJCQkJLy8gTmV4dAoJCQkJCQkJCWluZm8uc2VhcmNoID0gIj9wPSIgKyBNYXRoLmZsb29yKChpbmZvLnBhZ2UgLSAxKSAvIChlbmQgLSAoc3RhcnQgLSAxKSkpOwoJCQkJCQkJCWNhbGxiYWNrKG51bGwsIG51bGwsIHJldHJ5X2RlbGF5KTsKCQkJCQkJCQlyZXR1cm47CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJY2FsbGJhY2soIlRodW1ibmFpbCBub3QgZm91bmQiKTsKCQkJfSk7CgkJfTsKCgkJcnRfZWhlbnRhaV9sb29rdXAuZ2V0X2RhdGEgPSBmdW5jdGlvbiAoaW5mbywgY2FsbGJhY2spIHsKCQkJY2FsbGJhY2sobnVsbCwgaW5mby5zaGExID09PSBudWxsID8gbnVsbCA6IGxvb2t1cF9nZXRfcmVzdWx0cyhpbmZvLnNoYTEpKTsKCQl9OwoJCXJ0X2VoZW50YWlfbG9va3VwLnNldF9kYXRhID0gZnVuY3Rpb24gKGRhdGEsIGluZm8sIGNhbGxiYWNrKSB7CgkJCXZvaWQoaW5mbyk7IC8vIHRvIG1ha2UganNoaW50IGlnbm9yZSB0aGUgdW51c2VkIHZhcgoJCQlsb29rdXBfc2V0X3Jlc3VsdHMoZGF0YSk7CgkJCWNhbGxiYWNrKG51bGwpOwoJCX07CgkJcnRfZWhlbnRhaV9sb29rdXAuc2V0dXBfeGhyID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkJCXZhciBpbmZvID0gdGhpcy5pbmZvc1swXTsKCQkJaWYgKGluZm8uc2ltaWxhcikgewoJCQkJdmFyIGJsb2IgPSBpbmZvLmJsb2IsCgkJCQkJZm9ybV9kYXRhID0gbmV3IEZvcm1EYXRhKCksCgkJCQkJZXh0ID0gKGJsb2IudHlwZSB8fCAiIikuc3BsaXQoIi8iKTsKCgkJCQlpbmZvLmJsb2IgPSBudWxsOwoKCQkJCWV4dCA9ICIuIiArIGV4dFtleHQubGVuZ3RoIC0gMV07CgoJCQkJZm9ybV9kYXRhLmFwcGVuZCgic2ZpbGUiLCBibG9iLCAiaW1hZ2UiICsgZXh0KTsKCQkJCWZvcm1fZGF0YS5hcHBlbmQoImZzX3NpbWlsYXIiLCAib24iKTsKCQkJCWlmIChjb25maWcuc2F1Y2UuZXhwdW5nZWQpIHsKCQkJCQlmb3JtX2RhdGEuYXBwZW5kKCJmc19leHAiLCAib24iKTsKCQkJCX0KCgkJCQljYWxsYmFjayhudWxsLCB7CgkJCQkJbWV0aG9kOiAiUE9TVCIsCgkJCQkJdXJsOiAoY29uZmlnLnNhdWNlLmxvb2t1cF9kb21haW4gPT09IGRvbWFpbnMuZXhoZW50YWkgPyAiaHR0cHM6Ly8iICsgZG9tYWlucy5leGhlbnRhaSArICIvdXBsb2FkL2ltYWdlX2xvb2t1cC5waHAiIDogImh0dHBzOi8vdXBsb2FkLiIgKyBkb21haW5zLmVoZW50YWkgKyAiL2ltYWdlX2xvb2t1cC5waHAiKSwKCQkJCQlkYXRhOiBmb3JtX2RhdGEKCQkJCX0pOwoJCQl9CgkJCWVsc2UgewoJCQkJY2FsbGJhY2sobnVsbCwgewoJCQkJCW1ldGhvZDogIkdFVCIsCgkJCQkJdXJsOiBlaGVudGFpX2NyZWF0ZV9sb29rdXBfdXJsKGluZm8uc2hhMSkKCQkJCX0pOwoJCQl9CgkJfTsKCQlydF9laGVudGFpX2xvb2t1cC5wYXJzZV9yZXNwb25zZSA9IGZ1bmN0aW9uICh4aHIsIGNhbGxiYWNrKSB7CgkJCXZhciBpbmZvID0gdGhpcy5pbmZvc1swXTsKCQkJY2FsbGJhY2sobnVsbCwgWyBlaGVudGFpX3BhcnNlX2xvb2t1cF9yZXN1bHRzKHhociwgaW5mby5zaW1pbGFyLCBpbmZvLnNoYTEsIGluZm8udXJsLCBpbmZvLm1kNSkgXSwgaW5mby5zaW1pbGFyID8gdGhpcy50eXBlLmRlbGF5X29rYXkgOiAwKTsKCQl9OwoKCQlydF9uaGVudGFpX2dhbGxlcnkuZ2V0X2RhdGEgPSBmdW5jdGlvbiAoaW5mbywgY2FsbGJhY2spIHsKCQkJY2FsbGJhY2sobnVsbCwgZ2V0X3NhdmVkX2RhdGEoaW5mby5pZCkpOwoJCX07CgkJcnRfbmhlbnRhaV9nYWxsZXJ5LnNldF9kYXRhID0gZnVuY3Rpb24gKGRhdGEsIGluZm8sIGNhbGxiYWNrKSB7CgkJCXNldF9zYXZlZF9kYXRhKGluZm8uaWQsIGRhdGEpOwoJCQljYWxsYmFjayhudWxsKTsKCQl9OwoJCXJ0X25oZW50YWlfZ2FsbGVyeS5zZXR1cF94aHIgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKCQkJY2FsbGJhY2sobnVsbCwgewoJCQkJbWV0aG9kOiAiR0VUIiwKCQkJCXVybDogImh0dHA6Ly8iICsgZG9tYWlucy5uaGVudGFpICsgIi9nLyIgKyB0aGlzLmluZm9zWzBdLmdpZCArICIvIiwKCQkJfSk7CgkJfTsKCQlydF9uaGVudGFpX2dhbGxlcnkucGFyc2VfcmVzcG9uc2UgPSBmdW5jdGlvbiAoeGhyLCBjYWxsYmFjaykgewoJCQl2YXIgaHRtbCA9ICQuaHRtbF9wYXJzZV9zYWZlKHhoci5yZXNwb25zZVRleHQsIG51bGwpOwoJCQlpZiAoaHRtbCA9PT0gbnVsbCkgewoJCQkJY2FsbGJhY2soIkludmFsaWQgcmVzcG9uc2UiKTsKCQkJfQoJCQllbHNlIHsKCQkJCWNhbGxiYWNrKG51bGwsIFsgbmhlbnRhaV9wYXJzZV9pbmZvKGh0bWwsIHhoci5maW5hbFVybCkgXSk7CgkJCX0KCQl9OwoKCQlydF9uaGVudGFpX2dhbGxlcnlfcGFnZV90aHVtYi5nZXRfZGF0YSA9IGZ1bmN0aW9uIChpbmZvLCBjYWxsYmFjaykgewoJCQljYWxsYmFjayhudWxsLCBnZXRfc2F2ZWRfdGh1bWJuYWlsKCJuaGVudGFpIiwgaW5mby5naWQsIGluZm8ucGFnZSkpOwoJCX07CgkJcnRfbmhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIuc2V0X2RhdGEgPSBmdW5jdGlvbiAoZGF0YSwgaW5mbywgY2FsbGJhY2spIHsKCQkJc2V0X3NhdmVkX3RodW1ibmFpbCgibmhlbnRhaSIsIGluZm8uZ2lkLCBpbmZvLnBhZ2UsIGRhdGEpOwoJCQljYWxsYmFjayhudWxsKTsKCQl9OwoJCXJ0X25oZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iLnNldHVwX3hociA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewoJCQl2YXIgaW5mbyA9IHRoaXMuaW5mb3NbMF07CgkJCWNhbGxiYWNrKG51bGwsIHsKCQkJCW1ldGhvZDogIkdFVCIsCgkJCQl1cmw6ICJodHRwOi8vIiArIGRvbWFpbnMubmhlbnRhaSArICIvZy8iICsgaW5mby5naWQgKyAiLyIgKyBpbmZvLnBhZ2UgKyAiLyIKCQkJfSk7CgkJfTsKCQlydF9uaGVudGFpX2dhbGxlcnlfcGFnZV90aHVtYi5wYXJzZV9yZXNwb25zZSA9IGZ1bmN0aW9uICh4aHIsIGNhbGxiYWNrKSB7CgkJCXZhciBodG1sID0gJC5odG1sX3BhcnNlX3NhZmUoeGhyLnJlc3BvbnNlVGV4dCwgbnVsbCksCgkJCQluMSwgdXJsOwoKCQkJaWYgKGh0bWwgPT09IG51bGwpIHsKCQkJCWNhbGxiYWNrKCJJbnZhbGlkIHJlc3BvbnNlIik7CgkJCQlyZXR1cm47CgkJCX0KCgkJCW4xID0gJCgiI2ltYWdlLWNvbnRhaW5lciBpbWdbc3JjXSIsIGh0bWwpOwoJCQlpZiAobjEgIT09IG51bGwpIHsKCQkJCXVybCA9IG4xLmdldEF0dHJpYnV0ZSgic3JjIikgfHwgIiI7CgkJCQl1cmwgPSB1cmwucmVwbGFjZSgvXC9cL2lcLi9pLCAiLy90LiIpOwoJCQkJdXJsID0gdXJsLnJlcGxhY2UoL1wuXHcrJC8sICJ0JCYiKTsKCQkJCXVybCA9ICQucmVzb2x2ZSh1cmwsIHhoci5maW5hbFVybCk7CgkJCQljYWxsYmFjayhudWxsLCBbewoJCQkJCXVybDogdXJsLAoJCQkJCWxlZnQ6IDAsCgkJCQkJdG9wOiAwLAoJCQkJCXdpZHRoOiAtMSwKCQkJCQloZWlnaHQ6IC0xLAoJCQkJCWZsYWdzOiBJbWFnZUZsYWdzLk5vbmUKCQkJCX1dKTsKCQkJfQoJCQllbHNlIHsKCQkJCWNhbGxiYWNrKCJUaHVtYm5haWwgbm90IGZvdW5kIik7CgkJCX0KCQl9OwoKCQlydF9oaXRvbWlfZ2FsbGVyeS5nZXRfZGF0YSA9IGZ1bmN0aW9uIChpbmZvLCBjYWxsYmFjaykgewoJCQljYWxsYmFjayhudWxsLCBnZXRfc2F2ZWRfZGF0YShpbmZvLmlkKSk7CgkJfTsKCQlydF9oaXRvbWlfZ2FsbGVyeS5zZXRfZGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBpbmZvLCBjYWxsYmFjaykgewoJCQlzZXRfc2F2ZWRfZGF0YShpbmZvLmlkLCBkYXRhKTsKCQkJY2FsbGJhY2sobnVsbCk7CgkJfTsKCQlydF9oaXRvbWlfZ2FsbGVyeS5zZXR1cF94aHIgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKCQkJY2FsbGJhY2sobnVsbCwgewoJCQkJbWV0aG9kOiAiR0VUIiwKCQkJCXVybDogImh0dHBzOi8vIiArIGRvbWFpbnMuaGl0b21pICsgIi9nYWxsZXJpZXMvIiArIHRoaXMuaW5mb3NbMF0uZ2lkICsgIi5odG1sIiwKCQkJfSk7CgkJfTsKCQlydF9oaXRvbWlfZ2FsbGVyeS5wYXJzZV9yZXNwb25zZSA9IGZ1bmN0aW9uICh4aHIsIGNhbGxiYWNrKSB7CgkJCXZhciBodG1sID0gJC5odG1sX3BhcnNlX3NhZmUoeGhyLnJlc3BvbnNlVGV4dCwgbnVsbCk7CgkJCWlmIChodG1sID09PSBudWxsKSB7CgkJCQljYWxsYmFjaygiSW52YWxpZCByZXNwb25zZSIpOwoJCQl9CgkJCWVsc2UgewoJCQkJY2FsbGJhY2sobnVsbCwgWyBoaXRvbWlfcGFyc2VfaW5mbyhodG1sLCB4aHIuZmluYWxVcmwpIF0pOwoJCQl9CgkJfTsKCgkJcnRfaGl0b21pX2dhbGxlcnlfcGFnZV90aHVtYi5nZXRfZGF0YSA9IGZ1bmN0aW9uIChpbmZvLCBjYWxsYmFjaykgewoJCQljYWxsYmFjayhudWxsLCBnZXRfc2F2ZWRfdGh1bWJuYWlsKCJoaXRvbWkiLCBpbmZvLmdpZCwgaW5mby5wYWdlKSk7CgkJfTsKCQlydF9oaXRvbWlfZ2FsbGVyeV9wYWdlX3RodW1iLnNldF9kYXRhID0gZnVuY3Rpb24gKGRhdGEsIGluZm8sIGNhbGxiYWNrKSB7CgkJCXNldF9zYXZlZF90aHVtYm5haWwoImhpdG9taSIsIGluZm8uZ2lkLCBpbmZvLnBhZ2UsIGRhdGEpOwoJCQljYWxsYmFjayhudWxsKTsKCQl9OwoJCXJ0X2hpdG9taV9nYWxsZXJ5X3BhZ2VfdGh1bWIuc2V0dXBfeGhyID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkJCWNhbGxiYWNrKG51bGwsIHsKCQkJCW1ldGhvZDogIkdFVCIsCgkJCQl1cmw6ICJodHRwczovLyIgKyBkb21haW5zLmhpdG9taSArICIvcmVhZGVyLyIgKyB0aGlzLmluZm9zWzBdLmdpZCArICIuaHRtbCIKCQkJfSk7CgkJfTsKCQlydF9oaXRvbWlfZ2FsbGVyeV9wYWdlX3RodW1iLnBhcnNlX3Jlc3BvbnNlID0gZnVuY3Rpb24gKHhociwgY2FsbGJhY2spIHsKCQkJdmFyIGh0bWwgPSAkLmh0bWxfcGFyc2Vfc2FmZSh4aHIucmVzcG9uc2VUZXh0LCBudWxsKSwKCQkJCW4xLCB1cmw7CgoJCQlpZiAoaHRtbCA9PT0gbnVsbCkgewoJCQkJY2FsbGJhY2soIkludmFsaWQgcmVzcG9uc2UiKTsKCQkJCXJldHVybjsKCQkJfQoKCQkJbjEgPSAkJCgiLmltZy11cmwiLCBodG1sKTsKCQkJbjEgPSBuMVt0aGlzLmluZm9zWzBdLnBhZ2UgLSAxXTsKCQkJaWYgKG4xICE9PSB1bmRlZmluZWQpIHsKCQkJCXVybCA9IG4xLnRleHRDb250ZW50OwoJCQkJdXJsID0gdXJsLnJlcGxhY2UoL1wvXC9nXC4vaSwgIi8vdG4uIik7CgkJCQl1cmwgPSB1cmwucmVwbGFjZSgvZ2FsbGVyaWVzL2ksICJzbWFsbHRuIik7CgkJCQl1cmwgKz0gIi5qcGciOwoJCQkJdXJsID0gJC5yZXNvbHZlKHVybCwgeGhyLmZpbmFsVXJsKTsKCQkJCWNhbGxiYWNrKG51bGwsIFt7CgkJCQkJdXJsOiB1cmwsCgkJCQkJbGVmdDogMCwKCQkJCQl0b3A6IDAsCgkJCQkJd2lkdGg6IC0xLAoJCQkJCWhlaWdodDogLTEsCgkJCQkJZmxhZ3M6IEltYWdlRmxhZ3MuVGh1bWJuYWlsTm9MZWVjaAoJCQkJfV0pOwoJCQl9CgkJCWVsc2UgewoJCQkJY2FsbGJhY2soIlRodW1ibmFpbCBub3QgZm91bmQiKTsKCQkJfQoJCX07CgoKCgkJLy8gRmpvcmQgdGVzdAoJCXZhciByZV9mam9yZCA9IC9hYm9ydGlvbnxiZXN0aWFsaXR5fGluY2VzdHxsb2xpY29ufHNob3RhY29ufHRvZGRsZXJjb24vOwoJCXZhciBpc19mam9yZGluZyA9IGZ1bmN0aW9uIChkYXRhKSB7CgkJCXJldHVybiByZV9mam9yZC50ZXN0KGRhdGEudGFncy5qb2luKCIsIikpOwoJCX07CgoJCXZhciByZXdyaXRlX2xpbmsgPSBmdW5jdGlvbiAodXJsLCBpbmZvKSB7CgkJCXZhciByZXdyaXRlLCBpc19leDsKCgkJCWlmICgKCQkJCWluZm8uc2l0ZSA9PT0gImVoZW50YWkiICYmCgkJCQkoKGlzX2V4ID0gKChyZXdyaXRlID0gY29uZmlnLmdlbmVyYWwucmV3cml0ZV9saW5rcykgPT09IGRvbWFpbnMuZXhoZW50YWkpKSB8fCByZXdyaXRlID09PSBkb21haW5zLmdlaGVudGFpIHx8IHJld3JpdGUgPT09IGRvbWFpbnMuZWhlbnRhaSkgJiYKCQkJCWluZm8uZG9tYWluICE9PSByZXdyaXRlCgkJCSkgewoJCQkJaW5mby5kb21haW4gPSByZXdyaXRlOwoJCQkJaW5mby50YWcgPSBnZXRfdGFnX2Zyb21fZG9tYWluKGlzX2V4ID8gZG9tYWlucy5leGhlbnRhaSA6IGRvbWFpbnMuZWhlbnRhaSk7CgkJCQlpZiAoaW5mby5pY29uICE9PSB1bmRlZmluZWQpIHsKCQkJCQlpbmZvLmljb24gPSAoaXNfZXggPyAiZXhoZW50YWkiIDogImVoZW50YWkiKTsKCQkJCX0KCQkJCXVybCA9ICQuY2hhbmdlX3VybF9kb21haW4odXJsLCByZXdyaXRlKTsKCQkJCXVybF9pbmZvX3NhdmVkW3VybC5yZXBsYWNlKHJlX3JlbW92ZV9wcm90b2NvbCwgIiIpXSA9IGluZm87CgkJCX0KCgkJCXJldHVybiB1cmw7CgkJfTsKCQl2YXIgcmV3cml0ZV9saW5rX3NtYXJ0ID0gZnVuY3Rpb24gKG5vZGUsIGluZm8sIGRhdGEpIHsKCQkJaWYgKGNvbmZpZy5nZW5lcmFsLnJld3JpdGVfbGlua3MgPT09ICJzbWFydCIgJiYgZGF0YS50eXBlID09PSAiZWhlbnRhaSIpIHsKCQkJCXZhciB1cmwgPSBub2RlLmhyZWYsCgkJCQkJaXNfZXggPSAoJC5nZXRfZG9tYWluKHVybCkgPT09IGRvbWFpbnMuZXhoZW50YWkpLAoJCQkJCWZqb3JkID0gaXNfZmpvcmRpbmcoZGF0YSk7CgoJCQkJaWYgKGZqb3JkICE9PSBpc19leCkgewoJCQkJCWluZm8uZG9tYWluID0gZmpvcmQgPyBkb21haW5zLmV4aGVudGFpIDogZG9tYWlucy5laGVudGFpOwoJCQkJCWluZm8udGFnID0gZ2V0X3RhZ19mcm9tX2RvbWFpbihpbmZvLmRvbWFpbik7CgkJCQkJaWYgKGluZm8uaWNvbiAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJCWluZm8uaWNvbiA9IChmam9yZCA/ICJleGhlbnRhaSIgOiAiZWhlbnRhaSIpOwoJCQkJCX0KCQkJCQl1cmwgPSAkLmNoYW5nZV91cmxfZG9tYWluKHVybCwgaW5mby5kb21haW4pOwoJCQkJCXVybF9pbmZvX3NhdmVkW3VybC5yZXBsYWNlKHJlX3JlbW92ZV9wcm90b2NvbCwgIiIpXSA9IGluZm87CgkJCQkJcmV0dXJuIHVybDsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG51bGw7CgkJfTsKCgoKCQkvLyBQdWJsaWMKCQl2YXIgcmVfcmVtb3ZlX3Byb3RvY29sID0gL15odHRwcz86XC8qL2ksCgkJCXJlX3VybF9pbmZvID0gL14oW1x3XC1dKyg/OlwuW1x3XC1dKykqKSgoPzpbXC9cP1wjXVtcd1xXXSopPykvLAoJCQl1cmxfaW5mb19zYXZlZCA9IHt9LAoJCQl1cmxfaW5mb19yZWdpc3RyYXRpb25zID0gW10sCgkJCXVybF9pbmZvX3RvX2RhdGFfcmVnaXN0cmF0aW9ucyA9IFtdOwoKCQl2YXIgZ2V0X3VybF9pbmZvID0gZnVuY3Rpb24gKHVybCwgY2FsbGJhY2spIHsKCQkJdmFyIHNhdmVfa2V5ID0gdXJsLnJlcGxhY2UocmVfcmVtb3ZlX3Byb3RvY29sLCAiIiksCgkJCQlpY29uX3NpdGUsIG1hdGNoLCBkYXRhLCBkb21haW4sIHJlbWFpbmluZywgaXNfZXgsIG07CgoJCQlpZiAoKGRhdGEgPSB1cmxfaW5mb19zYXZlZFtzYXZlX2tleV0pICE9PSB1bmRlZmluZWQpIHsKCQkJCWNhbGxiYWNrKG51bGwsIGRhdGEpOwoJCQkJcmV0dXJuOwoJCQl9CgoJCQltYXRjaCA9IHJlX3VybF9pbmZvLmV4ZWMoc2F2ZV9rZXkpOwoKCQkJaWYgKG1hdGNoID09PSBudWxsKSB7CgkJCQljYWxsYmFjayhudWxsLCBudWxsKTsKCQkJCXJldHVybjsKCQkJfQoKCQkJZGF0YSA9IG51bGw7CgkJCWRvbWFpbiA9IChtYXRjaFsxXSkudG9Mb3dlckNhc2UoKTsKCQkJcmVtYWluaW5nID0gbWF0Y2hbMl07CgoJCQlpZiAoKGlzX2V4ID0gKGRvbWFpbiA9PT0gZG9tYWlucy5leGhlbnRhaSkpIHx8IGRvbWFpbiA9PT0gZG9tYWlucy5nZWhlbnRhaSB8fCBkb21haW4gPT09IGRvbWFpbnMuZWhlbnRhaSkgewoJCQkJbSA9IC9eXC8oPzpnfG1wdilcLyhcZCspXC8oWzAtOWEtZl0rKS8uZXhlYyhyZW1haW5pbmcpOwoJCQkJaWYgKG0gIT09IG51bGwpIHsKCQkJCQlkYXRhID0gewoJCQkJCQlpZDogImVoZW50YWlfIiArIG1bMV0sCgkJCQkJCXNpdGU6ICJlaGVudGFpIiwKCQkJCQkJdHlwZTogImdhbGxlcnkiLAoJCQkJCQlnaWQ6IHBhcnNlSW50KG1bMV0sIDEwKSwKCQkJCQkJdG9rZW46IG1bMl0sCgkJCQkJCWRvbWFpbjogZG9tYWluLAoJCQkJCQl0YWc6IGdldF90YWdfZnJvbV9kb21haW4oaXNfZXggPyBkb21haW5zLmV4aGVudGFpIDogZG9tYWlucy5laGVudGFpKQoJCQkJCX07CgkJCQkJbSA9IC8jcGFnZShcZCspLy5leGVjKHJlbWFpbmluZyk7CgkJCQkJaWYgKG0gIT09IG51bGwpIGRhdGEucGFnZSA9IHBhcnNlSW50KG1bMV0sIDEwKTsKCQkJCQlpY29uX3NpdGUgPSBpc19leCA/ICJleGhlbnRhaSIgOiAiZWhlbnRhaSI7CgkJCQl9CgkJCQllbHNlIGlmICgobSA9IC9eXC9zXC8oWzAtOWEtZl0rKVwvKFxkKyktKFxkKykvLmV4ZWMocmVtYWluaW5nKSkgIT09IG51bGwpIHsKCQkJCQlkYXRhID0gewoJCQkJCQlpZDogImVoZW50YWlfIiArIG1bMl0sCgkJCQkJCXNpdGU6ICJlaGVudGFpIiwKCQkJCQkJdHlwZTogInBhZ2UiLAoJCQkJCQlnaWQ6IHBhcnNlSW50KG1bMl0sIDEwKSwKCQkJCQkJcGFnZTogcGFyc2VJbnQobVszXSwgMTApLAoJCQkJCQlwYWdlX3Rva2VuOiBtWzFdLAoJCQkJCQlkb21haW46IGRvbWFpbiwKCQkJCQkJdGFnOiBnZXRfdGFnX2Zyb21fZG9tYWluKGlzX2V4ID8gZG9tYWlucy5leGhlbnRhaSA6IGRvbWFpbnMuZWhlbnRhaSkKCQkJCQl9OwoJCQkJCWljb25fc2l0ZSA9IGlzX2V4ID8gImV4aGVudGFpIiA6ICJlaGVudGFpIjsKCQkJCX0KCQkJfQoJCQllbHNlIGlmIChkb21haW4gPT09IGRvbWFpbnMubmhlbnRhaSkgewoJCQkJbSA9IC9eXC9nXC8oXGQrKSg/OlwvKFxkKykpPy8uZXhlYyhyZW1haW5pbmcpOwoJCQkJaWYgKG0gIT09IG51bGwpIHsKCQkJCQlkYXRhID0gewoJCQkJCQlpZDogIm5oZW50YWlfIiArIG1bMV0sCgkJCQkJCXNpdGU6ICJuaGVudGFpIiwKCQkJCQkJdHlwZTogImdhbGxlcnkiLAoJCQkJCQlnaWQ6IHBhcnNlSW50KG1bMV0sIDEwKSwKCQkJCQkJZG9tYWluOiBkb21haW4sCgkJCQkJCXRhZzogZ2V0X3RhZ19mcm9tX2RvbWFpbihkb21haW4pCgkJCQkJfTsKCQkJCQlpZiAobVsyXSAhPT0gdW5kZWZpbmVkKSBkYXRhLnBhZ2UgPSBwYXJzZUludChtWzJdLCAxMCk7CgkJCQkJaWNvbl9zaXRlID0gIm5oZW50YWkiOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKGRvbWFpbiA9PT0gZG9tYWlucy5oaXRvbWkpIHsKCQkJCW0gPSAvXlwvKGdhbGxlcmllc3xyZWFkZXJ8c21hbGx0bilcLyhcZCspKD86XC5odG1sIyhcZCspKT8vLmV4ZWMocmVtYWluaW5nKTsKCQkJCWlmIChtICE9PSBudWxsKSB7CgkJCQkJZGF0YSA9IHsKCQkJCQkJaWQ6ICJuaGVudGFpXyIgKyBtWzJdLAoJCQkJCQlzaXRlOiAiaGl0b21pIiwKCQkJCQkJdHlwZTogImdhbGxlcnkiLAoJCQkJCQlnaWQ6IHBhcnNlSW50KG1bMl0sIDEwKSwKCQkJCQkJZG9tYWluOiBkb21haW4sCgkJCQkJCXRhZzogZ2V0X3RhZ19mcm9tX2RvbWFpbihkb21haW4pCgkJCQkJfTsKCQkJCQlpZiAobVsxXSA9PT0gInJlYWRlciIgJiYgbVszXSAhPT0gdW5kZWZpbmVkKSBkYXRhLnBhZ2UgPSBwYXJzZUludChtWzNdLCAxMCk7CgkJCQkJaWNvbl9zaXRlID0gImhpdG9taSI7CgkJCQl9CgkJCX0KCgkJCWlmIChkYXRhICE9PSBudWxsKSB7CgkJCQl1cmxfaW5mb19zYXZlZFtzYXZlX2tleV0gPSBkYXRhOwoJCQkJaWYgKGNvbmZpZy5nZW5lcmFsLmljb25pZnkpIHsKCQkJCQlkYXRhLmljb24gPSBpY29uX3NpdGU7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAodXJsX2luZm9fcmVnaXN0cmF0aW9ucy5sZW5ndGggPiAwKSB7CgkJCQlnZXRfdXJsX2luZm9fY3VzdG9tKDAsIHVybCwgc2F2ZV9rZXksIGNhbGxiYWNrKTsKCQkJCXJldHVybjsKCQkJfQoKCQkJY2FsbGJhY2sobnVsbCwgZGF0YSk7CgkJfTsKCQl2YXIgZ2V0X3VybF9pbmZvX3NhdmVkID0gZnVuY3Rpb24gKHVybCkgewoJCQl1cmwgPSB1cmwucmVwbGFjZShyZV9yZW1vdmVfcHJvdG9jb2wsICIiKTsKCQkJdmFyIGRhdGEgPSB1cmxfaW5mb19zYXZlZFt1cmxdOwoJCQlyZXR1cm4gKGRhdGEgIT09IHVuZGVmaW5lZCkgPyBkYXRhIDogbnVsbDsKCQl9OwoJCXZhciBnZXRfdXJsX2luZm9fY3VzdG9tID0gZnVuY3Rpb24gKGksIHVybCwgc2F2ZV9rZXksIGNhbGxiYWNrKSB7CgkJCS8vIFRoaXMgc2hvdWxkIGF2b2lkIHN0YWNrIG92ZXJmbG93aW5nIHdoZW4gdXNpbmcgYSBjYWxsYmFjayBjaGFpbiB3aXRoIG1hbnkgc3luY2hyb25vdXMgZnVuY3Rpb25zCgkJCXZhciBpaSA9IHVybF9pbmZvX3JlZ2lzdHJhdGlvbnMubGVuZ3RoLAoJCQkJaW1tZWRpYXRlOwoKCQkJdmFyIGZuX2NiID0gZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJaWYgKGVyciA9PT0gbnVsbCAmJiBkYXRhICE9PSBudWxsKSB7CgkJCQkJdmFyIHYgPSB1cmxfaW5mb19zYXZlZFtzYXZlX2tleV07CgkJCQkJaWYgKHYgPT09IHVuZGVmaW5lZCkgewoJCQkJCQlkYXRhLl9jdXN0b21faWQgPSBpOwoJCQkJCQl1cmxfaW5mb19zYXZlZFtzYXZlX2tleV0gPSBkYXRhOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJZGF0YSA9IHY7CgkJCQkJfQoJCQkJCWNhbGxiYWNrKG51bGwsIGRhdGEpOwoJCQkJfQoJCQkJZWxzZSBpZiAoaW1tZWRpYXRlKSB7CgkJCQkJaW1tZWRpYXRlID0gZmFsc2U7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlnZXRfdXJsX2luZm9fY3VzdG9tKGkgKyAxLCB1cmwsIHNhdmVfa2V5LCBjYWxsYmFjayk7CgkJCQl9CgkJCX07CgoJCQlmb3IgKDsgaSA8IGlpOyArK2kpIHsKCQkJCWltbWVkaWF0ZSA9IHRydWU7CgoJCQkJdXJsX2luZm9fcmVnaXN0cmF0aW9uc1tpXSh1cmwsIGZuX2NiKTsKCgkJCQlpZiAoaW1tZWRpYXRlKSB7CgkJCQkJaW1tZWRpYXRlID0gZmFsc2U7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgoJCQljYWxsYmFjayhudWxsLCBudWxsKTsKCQl9OwoJCXZhciByZWdpc3Rlcl91cmxfaW5mb19mdW5jdGlvbiA9IGZ1bmN0aW9uIChjaGVja19mbiwgZ2V0X2RhdGFfZm4pIHsKCQkJdXJsX2luZm9fcmVnaXN0cmF0aW9ucy5wdXNoKGNoZWNrX2ZuKTsKCQkJdXJsX2luZm9fdG9fZGF0YV9yZWdpc3RyYXRpb25zLnB1c2goZ2V0X2RhdGFfZm4pOwoJCQlyZXR1cm4gdXJsX2luZm9fcmVnaXN0cmF0aW9ucy5sZW5ndGggLSAxOwoJCX07CgoJCXZhciBkb21haW5fdGFncyA9IHt9OwoJCWRvbWFpbl90YWdzW2RvbWFpbnMuZXhoZW50YWldID0gIkV4IjsKCQlkb21haW5fdGFnc1tkb21haW5zLmVoZW50YWldID0gIkVIIjsKCQlkb21haW5fdGFnc1tkb21haW5zLm5oZW50YWldID0gIm4iOwoJCWRvbWFpbl90YWdzW2RvbWFpbnMuaGl0b21pXSA9ICJIaSI7CgkJdmFyIGdldF90YWdfZnJvbV9kb21haW4gPSBmdW5jdGlvbiAoZG9tYWluKSB7CgkJCXZhciB0YWcgPSBkb21haW5fdGFnc1tkb21haW5dOwoJCQlyZXR1cm4gKHRhZyA9PT0gdW5kZWZpbmVkKSA/ICI/IiA6IHRhZzsKCQl9OwoKCQl2YXIgZ2V0X2VoZW50YWlfZ2FsbGVyeV9mdWxsID0gZnVuY3Rpb24gKGluZm8sIGRhdGEsIGNhbGxiYWNrKSB7CgkJCXJ0X2VoZW50YWlfZ2FsbGVyeV9mdWxsLmFkZCgiIiArIGRhdGEuZ2lkLCB7CgkJCQlkb21haW46IGluZm8uZG9tYWluLAoJCQkJc2VhcmNoOiAiIiwKCQkJCWdpZDogZGF0YS5naWQsCgkJCQl0b2tlbjogZGF0YS50b2tlbiwKCQkJCWluZm86IGluZm8sCgkJCQlkYXRhOiBkYXRhCgkJCX0sIGZhbHNlLCBjYWxsYmFjayk7CgkJfTsKCQl2YXIgZ2V0X2VoZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iID0gZnVuY3Rpb24gKGRvbWFpbiwgZ2lkLCB0b2tlbiwgcGFnZV90b2tlbiwgcGFnZSwgY2FsbGJhY2spIHsKCQkJcnRfZWhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIuYWRkKGdpZCArICItIiArIHBhZ2UsIHsKCQkJCWRvbWFpbjogZG9tYWluLAoJCQkJZ2lkOiBnaWQsCgkJCQl0b2tlbjogdG9rZW4sCgkJCQlwYWdlOiBwYWdlLAoJCQkJcGFnZV90b2tlbjogcGFnZV90b2tlbiwKCQkJCXNlYXJjaDogIiIKCQkJfSwgZmFsc2UsIGNhbGxiYWNrKTsKCQl9OwoJCXZhciBnZXRfbmhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIgPSBmdW5jdGlvbiAoZ2lkLCBwYWdlLCBjYWxsYmFjaykgewoJCQlydF9uaGVudGFpX2dhbGxlcnlfcGFnZV90aHVtYi5hZGQoZ2lkICsgIi0iICsgcGFnZSwgewoJCQkJZ2lkOiBnaWQsCgkJCQlwYWdlOiBwYWdlCgkJCX0sIGZhbHNlLCBjYWxsYmFjayk7CgkJfTsKCQl2YXIgZ2V0X2hpdG9taV9nYWxsZXJ5X3BhZ2VfdGh1bWIgPSBmdW5jdGlvbiAoZ2lkLCBwYWdlLCBjYWxsYmFjaykgewoJCQlydF9oaXRvbWlfZ2FsbGVyeV9wYWdlX3RodW1iLmFkZChnaWQgKyAiLSIgKyBwYWdlLCB7CgkJCQlnaWQ6IGdpZCwKCQkJCXBhZ2U6IHBhZ2UKCQkJfSwgZmFsc2UsIGNhbGxiYWNrKTsKCQl9OwoKCQl2YXIgZ2V0X2RhdGEgPSBmdW5jdGlvbiAodXJsX2luZm8pIHsKCQkJcmV0dXJuIGdldF9zYXZlZF9kYXRhKHVybF9pbmZvLmlkKTsKCQl9OwoJCXZhciBnZXRfZGF0YV9mcm9tX3VybF9pbmZvID0gZnVuY3Rpb24gKHVybF9pbmZvLCBjYWxsYmFjaykgewoJCQlpZiAodXJsX2luZm8uc2l0ZSA9PT0gImVoZW50YWkiKSB7CgkJCQlpZiAodXJsX2luZm8udHlwZSA9PT0gImdhbGxlcnkiKSB7CgkJCQkJcnRfZWhlbnRhaV9nYWxsZXJ5LmFkZCgiIiArIHVybF9pbmZvLmdpZCwgdXJsX2luZm8sIGZhbHNlLCBjYWxsYmFjayk7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQkJaWYgKHVybF9pbmZvLnR5cGUgPT09ICJwYWdlIikgewoJCQkJCXJ0X2VoZW50YWlfZ2FsbGVyeV9wYWdlLmFkZCgiIiArIHVybF9pbmZvLmdpZCwgdXJsX2luZm8sIGZhbHNlLCBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCQkJCWlmIChlcnIgPT09IG51bGwpIHsKCQkJCQkJCXVybF9pbmZvLnRva2VuID0gZGF0YS50b2tlbjsKCQkJCQkJCXJ0X2VoZW50YWlfZ2FsbGVyeS5hZGQoIiIgKyB1cmxfaW5mby5naWQsIHVybF9pbmZvLCBmYWxzZSwgY2FsbGJhY2spOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBlcnIsIG51bGwpOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKHVybF9pbmZvLnNpdGUgPT09ICJuaGVudGFpIikgewoJCQkJaWYgKHVybF9pbmZvLnR5cGUgPT09ICJnYWxsZXJ5IikgewoJCQkJCXJ0X25oZW50YWlfZ2FsbGVyeS5hZGQoIiIgKyB1cmxfaW5mby5naWQsIHVybF9pbmZvLCBmYWxzZSwgY2FsbGJhY2spOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJfQoJCQllbHNlIGlmICh1cmxfaW5mby5zaXRlID09PSAiaGl0b21pIikgewoJCQkJaWYgKHVybF9pbmZvLnR5cGUgPT09ICJnYWxsZXJ5IikgewoJCQkJCXJ0X2hpdG9taV9nYWxsZXJ5LmFkZCgiIiArIHVybF9pbmZvLmdpZCwgdXJsX2luZm8sIGZhbHNlLCBjYWxsYmFjayk7CgkJCQkJcmV0dXJuOwoJCQkJfQoJCQl9CgoJCQkvLyBDdXN0b20KCQkJdmFyIGkgPSB1cmxfaW5mby5fY3VzdG9tX2lkLAoJCQkJZm47CgoJCQlpZiAodHlwZW9mKGkpID09PSAibnVtYmVyIiAmJiAoZm4gPSB1cmxfaW5mb190b19kYXRhX3JlZ2lzdHJhdGlvbnNbaV0pICE9PSB1bmRlZmluZWQpIHsKCQkJCWZuKHVybF9pbmZvLCBjYWxsYmFjayk7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWNhbGxiYWNrLmNhbGwobnVsbCwgIk1hbGZvcm1lZCBkYXRhIiwgbnVsbCk7CgkJfTsKCgkJdmFyIGNhY2hlZF90aHVtYm5haWxfdXJscyA9IHt9OwoJCXZhciBnZXRfdGh1bWJuYWlsID0gZnVuY3Rpb24gKHRodW1ibmFpbF91cmwsIGZsYWdzLCBjYWxsYmFjaykgewoJCQl2YXIgdXJsOwoKCQkJaWYgKHRodW1ibmFpbF91cmwgPT09IG51bGwpIHsKCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgIk5vIHRodW1ibmFpbCIsIG51bGwpOwoJCQl9CgoJCQkvLyBVc2UgZGlyZWN0IFVSTAoJCQlpZiAoKGZsYWdzICYgSW1hZ2VGbGFncy5UaHVtYm5haWxOb0xlZWNoKSA9PT0gMCAmJiAhY29uZmlnLmdlbmVyYWwuaW1hZ2VfbGVlY2hpbmdfZGlzYWJsZWQgJiYgIUNvbmZpZy5pc184Y2gpICB7CgkJCQljYWxsYmFjay5jYWxsKG51bGwsIG51bGwsIHRodW1ibmFpbF91cmwpOwoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBDYWNoZWQKCQkJdXJsID0gY2FjaGVkX3RodW1ibmFpbF91cmxzW3RodW1ibmFpbF91cmxdOwoJCQlpZiAodXJsICE9PSB1bmRlZmluZWQpIHsKCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgbnVsbCwgdXJsKTsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gRmV0Y2gKCQkJZ2V0X2ltYWdlKHRodW1ibmFpbF91cmwsIGZ1bmN0aW9uIChlcnIsIGRhdGEsIGRhdGFfbGVuZ3RoLCBtZWRpYV90eXBlKSB7CgkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJdmFyIGltZ191cmwgPSAkLmNyZWF0ZV91cmxfZnJvbV9kYXRhKGRhdGEuc3ViYXJyYXkoMCwgZGF0YV9sZW5ndGgpLCBtZWRpYV90eXBlLCBDb25maWcuaXNfOGNoKTsKCgkJCQkJaWYgKGltZ191cmwgIT09IG51bGwpIHsKCQkJCQkJY2FjaGVkX3RodW1ibmFpbF91cmxzW3RodW1ibmFpbF91cmxdID0gaW1nX3VybDsKCQkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBudWxsLCBpbWdfdXJsKTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgIkZhaWxlZCB0byBsb2FkIGltYWdlIiwgbnVsbCk7CgkJCQkJfQoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBlcnIsIG51bGwpOwoJCQkJfQoJCQl9KTsKCQl9OwoKCQl2YXIgbG9va3VwX29uX2VoZW50YWkgPSBmdW5jdGlvbiAodXJsLCBtZDUsIHVzZV9zaW1pbGFyLCBjYWxsYmFjaywgcHJvZ3Jlc3NfY2FsbGJhY2spIHsKCQkJaWYgKHVzZV9zaW1pbGFyKSB7CgkJCQkvLyBGYXN0IG1vZGUKCQkJCXZhciBzaGExID0gZ2V0X3NoYTFfaGFzaCh1cmwsIG1kNSk7CgoJCQkJdmFyIGdldF9pbWFnZV9jYWxsYmFjayA9IGZ1bmN0aW9uIChlcnIsIGRhdGEsIGRhdGFfbGVuZ3RoLCBtaW1lX3R5cGUsIHVybCkgewoJCQkJCWlmIChwcm9ncmVzc19jYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJCXByb2dyZXNzX2NhbGxiYWNrLmNhbGwobnVsbCwgImltYWdlIik7CgkJCQkJfQoKCQkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJCXZhciBibG9iID0gbmV3IEJsb2IoWyBkYXRhLnN1YmFycmF5KDAsIGRhdGFfbGVuZ3RoKSBdLCB7IHR5cGU6IG1pbWVfdHlwZSB9KTsKCgkJCQkJCXJ0X2VoZW50YWlfbG9va3VwLmFkZCh1cmwsIHsKCQkJCQkJCXNpbWlsYXI6IHRydWUsCgkJCQkJCQlibG9iOiBibG9iLAoJCQkJCQkJdXJsOiB1cmwsCgkJCQkJCQltZDU6IG1kNSwKCQkJCQkJCXNoYTE6IHNoYTEKCQkJCQkJfSwgZmFsc2UsIGNhbGxiYWNrLCBwcm9ncmVzc19jYWxsYmFjayk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQljYWxsYmFjay5jYWxsKG51bGwsIGVyciwgbnVsbCk7CgkJCQkJfQoJCQkJfTsKCgkJCQlpZiAoc2hhMSAhPT0gbnVsbCkgewoJCQkJCXJ0X2VoZW50YWlfbG9va3VwLmFkZCh1cmwsIHsKCQkJCQkJc2ltaWxhcjogdHJ1ZSwKCQkJCQkJYmxvYjogbnVsbCwKCQkJCQkJdXJsOiB1cmwsCgkJCQkJCW1kNTogbWQ1LAoJCQkJCQlzaGExOiBzaGExCgkJCQkJfSwgdHJ1ZSwgZnVuY3Rpb24gKGVyciwgcmVzdWx0cykgewoJCQkJCQlpZiAoZXJyID09PSBudWxsKSB7CgkJCQkJCQkvLyBBbHJlYWR5IGV4aXN0cwoJCQkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBudWxsLCByZXN1bHRzKTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCS8vIExvYWQgaW1hZ2UKCQkJCQkJCWdldF9pbWFnZSh1cmwsIGdldF9pbWFnZV9jYWxsYmFjaywgcHJvZ3Jlc3NfY2FsbGJhY2spOwoJCQkJCQl9CgkJCQkJfSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkvLyBMb2FkIGltYWdlCgkJCQkJZ2V0X2ltYWdlKHVybCwgZ2V0X2ltYWdlX2NhbGxiYWNrLCBwcm9ncmVzc19jYWxsYmFjayk7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQlnZXRfc2hhMV9oYXNoKHVybCwgbWQ1LCBmdW5jdGlvbiAoZXJyLCBzaGExKSB7CgkJCQkJaWYgKHByb2dyZXNzX2NhbGxiYWNrICE9PSB1bmRlZmluZWQpIHsKCQkJCQkJcHJvZ3Jlc3NfY2FsbGJhY2suY2FsbChudWxsLCAiaW1hZ2UiKTsKCQkJCQl9CgoJCQkJCWlmIChlcnIgPT09IG51bGwpIHsKCQkJCQkJcnRfZWhlbnRhaV9sb29rdXAuYWRkKHVybCwgewoJCQkJCQkJc2ltaWxhcjogZmFsc2UsCgkJCQkJCQlibG9iOiBudWxsLAoJCQkJCQkJdXJsOiB1cmwsCgkJCQkJCQltZDU6IG1kNSwKCQkJCQkJCXNoYTE6IHNoYTEKCQkJCQkJfSwgZmFsc2UsIGNhbGxiYWNrLCBwcm9ncmVzc19jYWxsYmFjayk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQljYWxsYmFjay5jYWxsKG51bGwsIGVyciwgbnVsbCk7CgkJCQkJfQoJCQkJfSk7CgkJCX0KCQl9OwoKCQl2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHsKCQkJLy8gQ2xlYW4KCQkJY2FjaGVfaW5pdCgpOwoJCX07CgoKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCUltYWdlRmxhZ3M6IEltYWdlRmxhZ3MsCgkJCVJlcXVlc3RUeXBlOiBSZXF1ZXN0VHlwZSwKCQkJUmVxdWVzdEVycm9yTW9kZTogUmVxdWVzdEVycm9yTW9kZSwKCQkJY3JlYXRlX3RlbXBfc3RvcmFnZTogY3JlYXRlX3RlbXBfc3RvcmFnZSwKCQkJZ2V0X3VybF9pbmZvOiBnZXRfdXJsX2luZm8sCgkJCWdldF91cmxfaW5mb19zYXZlZDogZ2V0X3VybF9pbmZvX3NhdmVkLAoJCQlnZXRfZWhlbnRhaV9nYWxsZXJ5X2Z1bGw6IGdldF9laGVudGFpX2dhbGxlcnlfZnVsbCwKCQkJZ2V0X2VoZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iOiBnZXRfZWhlbnRhaV9nYWxsZXJ5X3BhZ2VfdGh1bWIsCgkJCWdldF9uaGVudGFpX2dhbGxlcnlfcGFnZV90aHVtYjogZ2V0X25oZW50YWlfZ2FsbGVyeV9wYWdlX3RodW1iLAoJCQlnZXRfaGl0b21pX2dhbGxlcnlfcGFnZV90aHVtYjogZ2V0X2hpdG9taV9nYWxsZXJ5X3BhZ2VfdGh1bWIsCgkJCWdldF9kYXRhOiBnZXRfZGF0YSwKCQkJZ2V0X2RhdGFfZnJvbV91cmxfaW5mbzogZ2V0X2RhdGFfZnJvbV91cmxfaW5mbywKCQkJZ2V0X3RodW1ibmFpbDogZ2V0X3RodW1ibmFpbCwKCQkJbG9va3VwX29uX2VoZW50YWk6IGxvb2t1cF9vbl9laGVudGFpLAoJCQljYWNoZV9jbGVhcjogY2FjaGVfY2xlYXIsCgkJCWNhY2hlX2dldF9wcmVmaXg6IGNhY2hlX2dldF9wcmVmaXgsCgkJCWdldF9jYXRlZ29yeTogZ2V0X2NhdGVnb3J5LAoJCQlnZXRfY2F0ZWdvcnlfc29ydF9yYW5rOiBnZXRfY2F0ZWdvcnlfc29ydF9yYW5rLAoJCQlyZXdyaXRlX2xpbms6IHJld3JpdGVfbGluaywKCQkJcmV3cml0ZV9saW5rX3NtYXJ0OiByZXdyaXRlX2xpbmtfc21hcnQsCgkJCXJlZ2lzdGVyX3VybF9pbmZvX2Z1bmN0aW9uOiByZWdpc3Rlcl91cmxfaW5mb19mdW5jdGlvbiwKCQkJaW5pdDogaW5pdAoJCX07CgoJfSkoKTsKCXZhciBTSEExID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gU0hBLTEgSlMgaW1wbGVtZW50YXRpb24gb3JpZ2luYWxseSBjcmVhdGVkIGJ5IENocmlzIFZlcm5lc3M7IGh0dHA6Ly9tb3ZhYmxlLXR5cGUuY28udWsvc2NyaXB0cy9zaGExLmh0bWwKCQkvLyBQcml2YXRlCgkJdmFyIGYgPSBmdW5jdGlvbiAocywgeCwgeSwgeikgewoJCQlzd2l0Y2ggKHMpIHsKCQkJCWNhc2UgMDogcmV0dXJuICh4ICYgeSkgXiAofnggJiB6KTsKCQkJCWNhc2UgMTogcmV0dXJuIHggXiB5IF4gejsKCQkJCWNhc2UgMjogcmV0dXJuICh4ICYgeSkgXiAoeCAmIHopIF4gKHkgJiB6KTsKCQkJCWNhc2UgMzogcmV0dXJuIHggXiB5IF4gejsKCQkJfQoJCX07CgkJdmFyIHJvdGwgPSBmdW5jdGlvbiAoeCwgbikgewoJCQlyZXR1cm4gKHggPDwgbikgfCAoeCA+Pj4gKDMyIC0gbikpOwoJCX07CgkJdmFyIGhleCA9IGZ1bmN0aW9uIChzdHIpIHsKCQkJdmFyIHMgPSAiIiwKCQkJCXYsIGk7CgkJCWZvciAoaSA9IDc7IGkgPj0gMDsgLS1pKSB7CgkJCQl2ID0gKHN0ciA+Pj4gKGkgKiA0KSkgJiAweGY7CgkJCQlzICs9IHYudG9TdHJpbmcoMTYpOwoJCQl9CgkJCXJldHVybiBzOwoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciBoYXNoID0gZnVuY3Rpb24gKGRhdGEsIGRhdGFfbGVuZ3RoKSB7CgkJCXZhciBIMCwgSDEsIEgyLCBIMywgSDQsIEssIE0sIE4sIFcsIFQsCgkJCQlhLCBiLCBjLCBkLCBlLCBpLCBqLCBsLCBzOwoKCQkJSyA9IG5ldyBVaW50MzJBcnJheShbIDB4NUE4Mjc5OTksIDB4NkVEOUVCQTEsIDB4OEYxQkJDREMsIDB4Q0E2MkMxRDYgXSk7CgkJCWRhdGFbZGF0YV9sZW5ndGhdID0gMHg4MDsgLy8gdGhpcyBpcyB2YWxpZCBiZWNhdXNlIHRoZSB0eXBlZCBhcnJheSBhbHdheXMgY29udGFpbnMgMSBleHRyYSBwYWRkaW5nIGJ5dGUKCgkJCWwgPSBkYXRhLmxlbmd0aCAvIDQgKyAyOwoJCQlOID0gTWF0aC5jZWlsKGwgLyAxNik7CgkJCU0gPSBbXTsKCgkJCWZvciAoaSA9IDA7IGkgPCBOOyArK2kpIHsKCQkJCU1baV0gPSBbXTsKCQkJCWZvciAoaiA9IDA7IGogPCAxNjsgKytqKSB7CgkJCQkJTVtpXVtqXSA9CgkJCQkJCShkYXRhW2kgKiA2NCArIGogKiA0XSA8PCAyNCkgfAoJCQkJCQkoZGF0YVtpICogNjQgKyBqICogNCArIDFdIDw8IDE2KSB8CgkJCQkJCShkYXRhW2kgKiA2NCArIGogKiA0ICsgMl0gPDwgOCkgfAoJCQkJCQkoZGF0YVtpICogNjQgKyBqICogNCArIDNdKTsKCQkJCX0KCQkJfQoKCQkJTVtOIC0gMV1bMTRdID0gTWF0aC5mbG9vcigoKGRhdGEubGVuZ3RoIC0gMSkgKiA4KSAvIE1hdGgucG93KDIsIDMyKSk7CgkJCU1bTiAtIDFdWzE1XSA9ICgoZGF0YS5sZW5ndGggLSAxKSAqIDgpICYgMHhmZmZmZmZmZjsKCgkJCUgwID0gMHg2NzQ1MjMwMTsKCQkJSDEgPSAweGVmY2RhYjg5OwoJCQlIMiA9IDB4OThiYWRjZmU7CgkJCUgzID0gMHgxMDMyNTQ3NjsKCQkJSDQgPSAweGMzZDJlMWYwOwoKCQkJVyA9IFtdOwoKCQkJZm9yIChpID0gMDsgaSA8IE47ICsraSkgewoJCQkJZm9yIChqID0gMDsgaiA8IDE2OyArK2opIHsKCQkJCQlXW2pdID0gTVtpXVtqXTsKCQkJCX0KCQkJCWZvciAoaiA9IDE2OyBqIDwgODA7ICsraikgewoJCQkJCVdbal0gPSByb3RsKFdbaiAtIDNdIF4gV1tqIC0gOF0gXiBXW2ogLSAxNF0gXiBXW2ogLSAxNl0sIDEpOwoJCQkJfQoKCQkJCWEgPSBIMDsKCQkJCWIgPSBIMTsKCQkJCWMgPSBIMjsKCQkJCWQgPSBIMzsKCQkJCWUgPSBINDsKCgkJCQlmb3IgKGogPSAwOyBqIDwgODA7ICsraikgewoJCQkJCXMgPSBNYXRoLmZsb29yKGogLyAyMCk7CgkJCQkJVCA9IChyb3RsKGEsIDUpICsgZihzLCBiLCBjLCBkKSArIGUgKyBLW3NdICsgV1tqXSkgJiAweGZmZmZmZmZmOwoJCQkJCWUgPSBkOwoJCQkJCWQgPSBjOwoJCQkJCWMgPSByb3RsKGIsIDMwKTsKCQkJCQliID0gYTsKCQkJCQlhID0gVDsKCQkJCX0KCgkJCQlIMCA9IChIMCArIGEpICYgMHhmZmZmZmZmZjsKCQkJCUgxID0gKEgxICsgYikgJiAweGZmZmZmZmZmOwoJCQkJSDIgPSAoSDIgKyBjKSAmIDB4ZmZmZmZmZmY7CgkJCQlIMyA9IChIMyArIGQpICYgMHhmZmZmZmZmZjsKCQkJCUg0ID0gKEg0ICsgZSkgJiAweGZmZmZmZmZmOwoJCQl9CgoJCQlyZXR1cm4gaGV4KEgwKSArIGhleChIMSkgKyBoZXgoSDIpICsgaGV4KEgzKSArIGhleChINCk7CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCWhhc2g6IGhhc2gKCQl9OwoKCX0pKCk7Cgl2YXIgU2F1Y2UgPSAoZnVuY3Rpb24gKCkgewoKCQkvLyBQcml2YXRlCgkJdmFyIGhvdmVyX25vZGVzID0ge30sCgkJCWhvdmVyX25vZGVzX2lkID0gMDsKCgkJdmFyIGdldF9leHJlc3VsdHNfZnJvbV9leHNhdWNlID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJdmFyIGNvbnRhaW5lciA9IFBvc3QuZ2V0X3Bvc3RfY29udGFpbmVyKG5vZGUpOwoKCQkJaWYgKAoJCQkJY29udGFpbmVyICE9PSBudWxsICYmCgkJCQkobm9kZSA9ICQoIi54bC1leHNhdWNlLXJlc3VsdHNbZGF0YS14bC1pbWFnZS1pbmRleD0nIiArIG5vZGUuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLWltYWdlLWluZGV4IikgKyAiJ10iLCBjb250YWluZXIpKSAhPT0gbnVsbCAmJgoJCQkJUG9zdC5nZXRfcG9zdF9jb250YWluZXIobm9kZSkgPT09IGNvbnRhaW5lcgoJCQkpIHsKCQkJCXJldHVybiBub2RlOwoJCQl9CgoJCQlyZXR1cm4gbnVsbDsKCQl9OwoKCQl2YXIgb25fc2F1Y2VfY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCXZhciByZXN1bHRzID0gZ2V0X2V4cmVzdWx0c19mcm9tX2V4c2F1Y2UodGhpcyksCgkJCQlob3ZlcjsKCgkJCWlmIChyZXN1bHRzICE9PSBudWxsKSB7CgkJCQlob3ZlciA9IGhvdmVyX25vZGVzW3RoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLXNhdWNlLWhvdmVyLWlkIikgfHwgIiJdOwoJCQkJaWYgKGhvdmVyID09PSB1bmRlZmluZWQpIHJldHVybjsKCgkJCQlpZiAocmVzdWx0cy5jbGFzc0xpc3QudG9nZ2xlKCJ4bC1leHNhdWNlLXJlc3VsdHMtaGlkZGVuIikpIHsKCQkJCQlob3Zlci5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1leHNhdWNlLWhvdmVyLWhpZGRlbiIpOwoJCQkJCW9uX3NhdWNlX21vdXNlbW92ZS5jYWxsKHRoaXMsIGV2ZW50KTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWhvdmVyLmNsYXNzTGlzdC5hZGQoInhsLWV4c2F1Y2UtaG92ZXItaGlkZGVuIik7CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBvbl9zYXVjZV9jbGlja19lcnJvciA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJdmFyIGxpbmsgPSB0aGlzLAoJCQkJZXZlbnRzID0gdGhpcy5nZXRBdHRyaWJ1dGUoImRhdGEteGwtZXhzYXVjZS1ldmVudHMiKSB8fCBudWxsOwoKCQkJaWYgKGV2ZW50cyA9PT0gbnVsbCkgcmV0dXJuOwoKCQkJTGlua2lmaWVyLmNoYW5nZV9saW5rX2V2ZW50cyhsaW5rLCBudWxsKTsKCgkJCXNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJCQkJTGlua2lmaWVyLmNoYW5nZV9saW5rX2V2ZW50cyhsaW5rLCBldmVudHMpOwoJCQkJbGluay5jbGljaygpOwoJCQl9LCAxKTsKCQl9OwoJCXZhciBvbl9zYXVjZV9tb3VzZW92ZXIgPSAkLndyYXBfbW91c2VlbnRlcmxlYXZlX2V2ZW50KGZ1bmN0aW9uICgpIHsKCQkJdmFyIHJlc3VsdHMgPSBnZXRfZXhyZXN1bHRzX2Zyb21fZXhzYXVjZSh0aGlzKSwKCQkJCWhvdmVyLCBlcnI7CgoJCQlpZiAocmVzdWx0cyA9PT0gbnVsbCB8fCByZXN1bHRzLmNsYXNzTGlzdC5jb250YWlucygieGwtZXhzYXVjZS1yZXN1bHRzLWhpZGRlbiIpKSB7CgkJCQlob3ZlciA9IGhvdmVyX25vZGVzW3RoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLXNhdWNlLWhvdmVyLWlkIildOwoJCQkJaWYgKGhvdmVyID09PSB1bmRlZmluZWQpIHsKCQkJCQllcnIgPSB0aGlzLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1leHNhdWNlLWVycm9yIik7CgkJCQkJaWYgKCFlcnIpIHJldHVybjsKCQkJCQl0aGlzLnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS14bC1leHNhdWNlLWVycm9yIik7CgkJCQkJaG92ZXIgPSBjcmVhdGVfZXJyb3IodGhpcywgZXJyKTsKCQkJCX0KCgkJCQlob3Zlci5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1leHNhdWNlLWhvdmVyLWhpZGRlbiIpOwoJCQl9CgkJfSk7CgkJdmFyIG9uX3NhdWNlX21vdXNlb3V0ID0gJC53cmFwX21vdXNlZW50ZXJsZWF2ZV9ldmVudChmdW5jdGlvbiAoKSB7CgkJCXZhciBob3ZlciA9IGhvdmVyX25vZGVzW3RoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLXNhdWNlLWhvdmVyLWlkIikgfHwgIiJdOwoJCQlpZiAoaG92ZXIgIT09IHVuZGVmaW5lZCkgewoJCQkJaG92ZXIuY2xhc3NMaXN0LmFkZCgieGwtZXhzYXVjZS1ob3Zlci1oaWRkZW4iKTsKCQkJfQoJCX0pOwoJCXZhciBvbl9zYXVjZV9tb3VzZW1vdmUgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJdmFyIGhvdmVyID0gaG92ZXJfbm9kZXNbdGhpcy5nZXRBdHRyaWJ1dGUoImRhdGEteGwtc2F1Y2UtaG92ZXItaWQiKSB8fCAiIl07CgoJCQlpZiAoaG92ZXIgPT09IHVuZGVmaW5lZCB8fCBob3Zlci5jbGFzc0xpc3QuY29udGFpbnMoInhsLWV4c2F1Y2UtaG92ZXItaGlkZGVuIikpIHJldHVybjsKCgkJCWhvdmVyLnN0eWxlLmxlZnQgPSAiMCI7CgkJCWhvdmVyLnN0eWxlLnRvcCA9ICIwIjsKCgkJCXZhciB4ID0gZXZlbnQuY2xpZW50WCwKCQkJCXkgPSBldmVudC5jbGllbnRZLAoJCQkJd2luX3dpZHRoID0gKGRvY3VtZW50X2VsZW1lbnQuY2xpZW50V2lkdGggfHwgd2luZG93LmlubmVyV2lkdGggfHwgMCksCgkJCQl3aW5faGVpZ2h0ID0gKGRvY3VtZW50X2VsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IHdpbmRvdy5pbm5lckhlaWdodCB8fCAwKSwKCQkJCXJlY3QgPSBob3Zlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCgkJCXggLT0gcmVjdC53aWR0aCAvIDI7CgkJCXggPSBNYXRoLm1heCgxLCBNYXRoLm1pbih3aW5fd2lkdGggLSByZWN0LndpZHRoIC0gMSwgeCkpOwoJCQl5ICs9IDIwOwoJCQlpZiAoeSArIHJlY3QuaGVpZ2h0ID49IHdpbl9oZWlnaHQpIHsKCQkJCXkgPSBldmVudC5jbGllbnRZIC0gKHJlY3QuaGVpZ2h0ICsgMjApOwoJCQl9CgoJCQlob3Zlci5zdHlsZS5sZWZ0ID0geCArICJweCI7CgkJCWhvdmVyLnN0eWxlLnRvcCA9IHkgKyAicHgiOwoJCX07CgoJCXZhciBjcmVhdGVfaG92ZXIgPSBmdW5jdGlvbiAoaWQsIGRhdGEpIHsKCQkJdmFyIHJlc3VsdHMgPSBkYXRhLnJlc3VsdHMsCgkJCQlob3ZlciwgaSwgaWk7CgoJCQlob3ZlciA9ICQubm9kZSgiZGl2IiwgInhsLWV4c2F1Y2UtaG92ZXIgeGwtZXhzYXVjZS1ob3Zlci1oaWRkZW4geGwtaG92ZXItc2hhZG93IiArIFRoZW1lLmNsYXNzZXMpOwoJCQlUaGVtZS5iZyhob3Zlcik7CgkJCWhvdmVyLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1zYXVjZS1ob3Zlci1pZCIsIGlkKTsKCgkJCWZvciAoaSA9IDAsIGlpID0gcmVzdWx0cy5sZW5ndGg7IGkgPCBpaTsgKSB7CgkJCQkkLmFkZChob3ZlciwgJC5saW5rKHJlc3VsdHNbaV0udXJsLCAieGwtZXhzYXVjZS1ob3Zlci1saW5rIiwgcmVzdWx0c1tpXS50aXRsZSkpOwoJCQkJaWYgKCsraSA8IGlpKSAkLmFkZChob3ZlciwgJC5ub2RlX3NpbXBsZSgiYnIiKSk7CgkJCX0KCgkJCVBvcHVwLmhvdmVyaW5nKGhvdmVyKTsKCQkJaG92ZXJfbm9kZXNbaWRdID0gaG92ZXI7CgoJCQlyZXR1cm4gaG92ZXI7CgkJfTsKCQl2YXIgZm9ybWF0ID0gZnVuY3Rpb24gKGEsIGRhdGEpIHsKCQkJdmFyIGNvdW50ID0gZGF0YS5yZXN1bHRzLmxlbmd0aCwKCQkJCXRoZW1lID0gVGhlbWUuY2xhc3NlcywKCQkJCWluZGV4ID0gYS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtaW1hZ2UtaW5kZXgiKSB8fCAiIiwKCQkJCXJlc3VsdHMsIGxpbmssIHBhciwgdXJsLCBuMSwgbjIsIG4sIGksIGlpOwoKCQkJYS5jbGFzc0xpc3QuYWRkKCJ4bC1leHNhdWNlLWxpbmstdmFsaWQiKTsKCQkJYS50ZXh0Q29udGVudCA9ICJGb3VuZDogIiArIGNvdW50OwoJCQlhLmhyZWYgPSBkYXRhLnVybDsKCQkJYS50YXJnZXQgPSAiX2JsYW5rIjsKCQkJYS5yZWwgPSAibm9yZWZlcnJlciI7CgkJCWEucmVtb3ZlQXR0cmlidXRlKCJ0aXRsZSIpOwoKCQkJaWYgKGNvdW50ID4gMCkgewoJCQkJaWYgKAoJCQkJCShuID0gUG9zdC5nZXRfcG9zdF9jb250YWluZXIoYSkpICE9PSBudWxsICYmCgkJCQkJKG4gPSBQb3N0LmdldF90ZXh0X2JvZHkobikpICE9PSBudWxsICYmCgkJCQkJKHBhciA9IG4ucGFyZW50Tm9kZSkgIT09IG51bGwKCQkJCSkgewoJCQkJCXJlc3VsdHMgPSAkLm5vZGUoImRpdiIsICJ4bC1leHNhdWNlLXJlc3VsdHMiICsgdGhlbWUpOwoJCQkJCXJlc3VsdHMuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWltYWdlLWluZGV4IiwgaW5kZXgpOwoKCQkJCQkkLmFkZChyZXN1bHRzLCBuMSA9ICQubm9kZSgiZGl2IiwgInhsLWV4c2F1Y2UtcmVzdWx0cy1pbm5lciIgKyB0aGVtZSkpOwoKCQkJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImRpdiIsICJ4bC1leHNhdWNlLXJlc3VsdHMtZ3JvdXAiICsgdGhlbWUpKTsKCgkJCQkJJC5hZGQobjIsICQubm9kZSgic3Ryb25nIiwgInhsLWV4c2F1Y2UtcmVzdWx0cy10aXRsZSIsICJSZXZlcnNlIEltYWdlIFNlYXJjaCBSZXN1bHRzIikpOwoJCQkJCSQuYWRkKG4yLCAkLm5vZGUoInNwYW4iLCAieGwtZXhzYXVjZS1yZXN1bHRzLXNlcCIsICJ8IikpOwoJCQkJCSQuYWRkKG4yLCAkLm5vZGUoInNwYW4iLCAieGwtZXhzYXVjZS1yZXN1bHRzLWxhYmVsIiwgIlZpZXcgb246IikpOwoKCQkJCQlpZiAoY29uZmlnLnNhdWNlLmxvb2t1cF9kb21haW4gPT09IGRvbWFpbnMuZXhoZW50YWkpIHsKCQkJCQkJJC5hZGQobjIsICQubGluayhkYXRhLnVybCwgInhsLWV4c2F1Y2UtcmVzdWx0cy1saW5rIiwgIkV4SGVudGFpIikpOwoJCQkJCQkkLmFkZChuMiwgJC5saW5rKCQuY2hhbmdlX3VybF9kb21haW4oZGF0YS51cmwsIGRvbWFpbnMuZ2VoZW50YWkpLCAieGwtZXhzYXVjZS1yZXN1bHRzLWxpbmsiLCAiRS1IZW50YWkiKSk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQkkLmFkZChuMiwkLmxpbmsoZGF0YS51cmwsICJ4bC1leHNhdWNlLXJlc3VsdHMtbGluayIsICJFLUhlbnRhaSIpKTsKCQkJCQkJJC5hZGQobjIsICQubGluaygkLmNoYW5nZV91cmxfZG9tYWluKGRhdGEudXJsLCBkb21haW5zLmV4aGVudGFpKSwgInhsLWV4c2F1Y2UtcmVzdWx0cy1saW5rIiwgIkV4SGVudGFpIikpOwoJCQkJCX0KCgkJCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZXhzYXVjZS1yZXN1bHRzLWdyb3VwIikpOwoKCQkJCQlmb3IgKGkgPSAwLCBpaSA9IGRhdGEucmVzdWx0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJCXVybCA9IGRhdGEucmVzdWx0c1tpXS51cmw7CgkJCQkJCWxpbmsgPSBMaW5raWZpZXIuY3JlYXRlX2xpbmsobjIsIG51bGwsIHVybCwgdXJsLCB0cnVlKTsKCQkJCQkJaWYgKGkgPCBpaSAtIDEpICQuYWRkKG4yLCAkLm5vZGVfc2ltcGxlKCJiciIpKTsKCQkJCQl9CgoJCQkJCSQuYmVmb3JlKHBhciwgbiwgcmVzdWx0cyk7CgkJCQl9CgoJCQkJYS5zZXRBdHRyaWJ1dGUoImRhdGEteGwtc2F1Y2UtaG92ZXItaWQiLCBob3Zlcl9ub2Rlc19pZCk7CgkJCQljcmVhdGVfaG92ZXIoaG92ZXJfbm9kZXNfaWQsIGRhdGEpOwoJCQkJKytob3Zlcl9ub2Rlc19pZDsKCgkJCQlMaW5raWZpZXIuY2hhbmdlX2xpbmtfZXZlbnRzKGEsICJleHNhdWNlX3RvZ2dsZSIpOwoJCQl9CgkJfTsKCQl2YXIgbGFiZWwgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBsYWJlbCA9IGNvbmZpZy5zYXVjZS5sYWJlbDsKCgkJCWlmIChsYWJlbC5sZW5ndGggPT09IDApIHsKCQkJCWxhYmVsID0gKGNvbmZpZy5zYXVjZS5sb29rdXBfZG9tYWluID09PSBkb21haW5zLmV4aGVudGFpKSA/ICJFeEhlbnRhaSIgOiAiRS1IZW50YWkiOwoJCQl9CgoJCQlyZXR1cm4gbGFiZWw7CgkJfTsKCgkJdmFyIGNyZWF0ZV9lcnJvciA9IGZ1bmN0aW9uIChub2RlLCBlcnJvcikgewoJCQl2YXIgaWQgPSBob3Zlcl9ub2Rlc19pZCwKCQkJCWhvdmVyLCBuLCBpLCBpaTsKCgkJCS8vIFVwZGF0ZSBpZAoJCQkrK2hvdmVyX25vZGVzX2lkOwoKCQkJLy8gQ3JlYXRlIGhvdmVyCgkJCWhvdmVyID0gJC5ub2RlKCJkaXYiLCAieGwtZXhzYXVjZS1ob3ZlciB4bC1leHNhdWNlLWhvdmVyLWhpZGRlbiB4bC1ob3Zlci1zaGFkb3ciICsgVGhlbWUuY2xhc3Nlcyk7CgkJCVRoZW1lLmJnKGhvdmVyKTsKCQkJJC5hZGQoaG92ZXIsIG4gPSAkLm5vZGUoInNwYW4iLCAieGwtZXhzYXVjZS1ob3Zlci1saW5rIikpOwoJCQllcnJvciA9IGVycm9yLnRyaW0oKS5zcGxpdCgiXG4iKTsKCQkJZm9yIChpID0gMCwgaWkgPSBlcnJvci5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlpZiAoaSA+IDApICQuYWRkKG4sICQubm9kZV9zaW1wbGUoImJyIikpOwoJCQkJJC5hZGQobiwgJC50bm9kZShlcnJvcltpXSkpOwoJCQl9CgoJCQkvLyBJZHMKCQkJaG92ZXIuc2V0QXR0cmlidXRlKCJkYXRhLXhsLXNhdWNlLWhvdmVyLWlkIiwgaWQpOwoJCQlub2RlLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1zYXVjZS1ob3Zlci1pZCIsIGlkKTsKCgkJCVBvcHVwLmhvdmVyaW5nKGhvdmVyKTsKCQkJaG92ZXJfbm9kZXNbaWRdID0gaG92ZXI7CgoJCQkvLyBEb25lCgkJCXJldHVybiBob3ZlcjsKCQl9OwoJCXZhciBzZXRfZXJyb3IgPSBmdW5jdGlvbiAobm9kZSwgZXJyb3IpIHsKCQkJLy8gQ3JlYXRlIGhvdmVyCgkJCWNyZWF0ZV9lcnJvcihub2RlLCBlcnJvcik7CgoJCQkvLyBMaW5rCgkJCW5vZGUuY2xhc3NMaXN0LmFkZCgieGwtZXhzYXVjZS1saW5rLWVycm9yIik7CgkJCW5vZGUudGV4dENvbnRlbnQgPSAiRXJyb3IiOwoJCQlub2RlLnJlbW92ZUF0dHJpYnV0ZSgidGl0bGUiKTsKCgkJCS8vIEV2ZW50cwoJCQlMaW5raWZpZXIuY2hhbmdlX2xpbmtfZXZlbnRzKG5vZGUsICJleHNhdWNlX2Vycm9yIik7CgkJfTsKCQl2YXIgcmVtb3ZlX2Vycm9yID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJdmFyIGV2ZW50cyA9IExpbmtpZmllci5nZXRfbGlua19ldmVudHMobm9kZSksCgkJCQlpZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLXNhdWNlLWhvdmVyLWlkIiksCgkJCQlob3ZlciA9IGhvdmVyX25vZGVzW2lkXTsKCgkJCUxpbmtpZmllci5jaGFuZ2VfbGlua19ldmVudHMobm9kZSwgbnVsbCk7CgkJCW5vZGUuY2xhc3NMaXN0LnJlbW92ZSgieGwtZXhzYXVjZS1saW5rLWVycm9yIik7CgkJCW5vZGUuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWV4c2F1Y2UtZXZlbnRzIiwgZXZlbnRzKTsKCQkJbm9kZS5yZW1vdmVBdHRyaWJ1dGUoImRhdGEteGwtc2F1Y2UtaG92ZXItaWQiKTsKCgkJCWlmIChob3ZlciAhPT0gdW5kZWZpbmVkKSB7CgkJCQlpZiAoaG92ZXIucGFyZW50Tm9kZSAhPT0gbnVsbCkgJC5yZW1vdmUoaG92ZXIpOwoJCQkJZGVsZXRlIGhvdmVyX25vZGVzW2lkXTsKCQkJfQoJCX07CgoJCXZhciBmZXRjaF9nZW5lcmljID0gZnVuY3Rpb24gKGxpbmssIHVzZV9zaW1pbGFyKSB7CgkJCXZhciB1cmwgPSBsaW5rLmhyZWYsCgkJCQltZDUgPSBsaW5rLmdldEF0dHJpYnV0ZSgiZGF0YS1tZDUiKSB8fCBudWxsLAoJCQkJcHJvZ3Jlc3M7CgoJCQlpZiAodXNlX3NpbWlsYXIpIHsKCQkJCWxpbmsudGV4dENvbnRlbnQgPSAiRG93bmxvYWRpbmciOwoKCQkJCXByb2dyZXNzID0gZnVuY3Rpb24gKHN0YXRlKSB7CgkJCQkJaWYgKHN0YXRlID09PSAiaW1hZ2UiKSB7CgkJCQkJCWxpbmsudGV4dENvbnRlbnQgPSAiV2FpdGluZyI7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKHN0YXRlID09PSAidXBsb2FkIikgewoJCQkJCQlsaW5rLnRleHRDb250ZW50ID0gIlVwbG9hZGluZyI7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKHN0YXRlID09PSAiZG93bmxvYWQiKSB7CgkJCQkJCWxpbmsudGV4dENvbnRlbnQgPSAiQ2hlY2tpbmciOwoJCQkJCX0KCQkJCX07CgkJCX0KCQkJZWxzZSB7CgkJCQlsaW5rLnRleHRDb250ZW50ID0gIkRvd25sb2FkaW5nIjsKCgkJCQlwcm9ncmVzcyA9IGZ1bmN0aW9uIChzdGF0ZSkgewoJCQkJCWlmIChzdGF0ZSA9PT0gImltYWdlIikgewoJCQkJCQlsaW5rLnRleHRDb250ZW50ID0gIldhaXRpbmciOwoJCQkJCX0KCQkJCQllbHNlIGlmIChzdGF0ZSA9PT0gInVwbG9hZCIpIHsKCQkJCQkJbGluay50ZXh0Q29udGVudCA9ICJDaGVja2luZyI7CgkJCQkJfQoJCQkJfTsKCQkJfQoKCQkJcmVtb3ZlX2Vycm9yKGxpbmspOwoKCQkJQVBJLmxvb2t1cF9vbl9laGVudGFpKHVybCwgbWQ1LCB1c2Vfc2ltaWxhciwgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJaWYgKGVyciA9PT0gbnVsbCkgewoJCQkJCWZvcm1hdChsaW5rLCBkYXRhKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXNldF9lcnJvcihsaW5rLCBlcnIpOwoJCQkJfQoJCQl9LCBwcm9ncmVzcyk7CgkJfTsKCQl2YXIgZmV0Y2ggPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJZmV0Y2hfZ2VuZXJpYyh0aGlzLCBmYWxzZSk7CgkJfTsKCQl2YXIgZmV0Y2hfc2ltaWxhciA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQlmZXRjaF9nZW5lcmljKHRoaXMsIHRydWUpOwoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciBmaW5kX2xpbmsgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCXJldHVybiAkKCIueGwtZXhzYXVjZS1saW5rIiwgY29udGFpbmVyKTsKCQl9OwoJCXZhciBjcmVhdGVfbGluayA9IGZ1bmN0aW9uIChmaWxlX2luZm8sIGluZGV4KSB7CgkJCXZhciBldmVudCA9ICJleHNhdWNlX2ZldGNoIiwKCQkJCXNhdWNlLCBlcnI7CgoJCQlzYXVjZSA9ICQubGluayhmaWxlX2luZm8udXJsLCAieGwtZXhzYXVjZS1saW5rIiwgbGFiZWwoKSk7CgkJCXNhdWNlLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1maWxlbmFtZSIsIGZpbGVfaW5mby5uYW1lKTsKCQkJc2F1Y2Uuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWltYWdlLWluZGV4IiwgaW5kZXgpOwoJCQlpZiAoZmlsZV9pbmZvLm1kNSAhPT0gbnVsbCkgewoJCQkJc2F1Y2Uuc2V0QXR0cmlidXRlKCJkYXRhLW1kNSIsIGZpbGVfaW5mby5tZDUucmVwbGFjZSgvXD0rL2csICIiKSk7CgkJCX0KCQkJaWYgKC9eXC5qcGU/ZyQvaS50ZXN0KGZpbGVfaW5mby50eXBlKSAmJiAhQ29uZmlnLmlzX3Rpbnlib2FyZCkgewoJCQkJaWYgKGJyb3dzZXIuaXNfZmlyZWZveCkgewoJCQkJCWV2ZW50ID0gImV4c2F1Y2VfZmV0Y2hfc2ltaWxhcml0eSI7CgkJCQkJc2F1Y2UudGl0bGUgPSAiVGhpcyB3aWxsIG9ubHkgd29yayBvbiBjb2xvcmVkIGltYWdlcyI7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQllcnIgPSAiUmV2ZXJzZSBJbWFnZSBTZWFyY2ggZG9lc24ndCB3b3JrIGZvciAuanBnIGltYWdlcyBiZWNhdXNlIDRjaGFuIG1hbmlwdWxhdGVzIHRoZW0gb24gdXBsb2FkIjsKCQkJCQlldmVudCA9ICJleHNhdWNlX2Vycm9yIjsKCQkJCQlzYXVjZS5jbGFzc0xpc3QuYWRkKCJ4bC1leHNhdWNlLWxpbmstZGlzYWJsZWQiKTsKCQkJCQlzYXVjZS5zZXRBdHRyaWJ1dGUoImRhdGEteGwtZXhzYXVjZS1lcnJvciIsIGVycik7CgkJCQl9CgkJCX0KCgkJCUxpbmtpZmllci5jaGFuZ2VfbGlua19ldmVudHMoc2F1Y2UsIGV2ZW50KTsKCgkJCXJldHVybiBzYXVjZTsKCQl9OwoJCXZhciBpbml0ID0gZnVuY3Rpb24gKCkgewoJCQlMaW5raWZpZXIucmVnaXN0ZXJfbGlua19ldmVudHMoewoJCQkJZXhzYXVjZV9mZXRjaDogZmV0Y2gsCgkJCQlleHNhdWNlX2ZldGNoX3NpbWlsYXJpdHk6IGZldGNoX3NpbWlsYXIsCgkJCQlleHNhdWNlX3RvZ2dsZTogewoJCQkJCWNsaWNrOiBvbl9zYXVjZV9jbGljaywKCQkJCQltb3VzZW92ZXI6IG9uX3NhdWNlX21vdXNlb3ZlciwKCQkJCQltb3VzZW91dDogb25fc2F1Y2VfbW91c2VvdXQsCgkJCQkJbW91c2Vtb3ZlOiBvbl9zYXVjZV9tb3VzZW1vdmUKCQkJCX0sCgkJCQlleHNhdWNlX2Vycm9yOiB7CgkJCQkJY2xpY2s6IG9uX3NhdWNlX2NsaWNrX2Vycm9yLAoJCQkJCW1vdXNlb3Zlcjogb25fc2F1Y2VfbW91c2VvdmVyLAoJCQkJCW1vdXNlb3V0OiBvbl9zYXVjZV9tb3VzZW91dCwKCQkJCQltb3VzZW1vdmU6IG9uX3NhdWNlX21vdXNlbW92ZQoJCQkJfSwKCQkJfSk7CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCWZpbmRfbGluazogZmluZF9saW5rLAoJCQljcmVhdGVfbGluazogY3JlYXRlX2xpbmssCgkJCWluaXQ6IGluaXQKCQl9OwoKCX0pKCk7Cgl2YXIgTGlua2lmaWVyID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gUHJpdmF0ZQoJCXZhciByZV91cmwgPSAvKGh0dHBzPzpcLyopPyg/Oig/OmZvcnVtc3xsb2ZpfGd1fGd8dSk/XC4/ZVt4XC1daGVudGFpXC5vcmd8bmhlbnRhaVwubmV0fGhpdG9taVwubGEpKD86XC9bXjw+KClcc1wnXCJdKik/L2lnLAoJCQlyZV91cmxfY2xhc3NfaWdub3JlID0gLyg/OlxiaW5saW5lZD9cYnxcYnhsLSkvLAoJCQlyZV80Y2hhbl9kZWZlcnJlciA9IC9eKD86aHR0cHM/Oik/XC9cL3N5c1wuNGNoYW4oPzpuZWwpP1wub3JnXC9kZXJlZmVyXD91cmw9KFtcd1xXXSopJC9pOwoKCQkvLyBMaW5raWZpY2F0aW9uCgkJdmFyIGRlZXBfZG9tX3dyYXAgPSAoZnVuY3Rpb24gKCkgewoKCQkJLy8gQ29uc3RhbnRzCgkJCXZhciBOT0RFX1BBUlNFID0gMCwKCQkJCU5PREVfTk9fUEFSU0UgPSAxLAoJCQkJTk9ERV9MSU5FX0JSRUFLID0gMiwKCQkJCVRFWFRfTk9ERSA9IE5vZGUuVEVYVF9OT0RFLAoJCQkJRUxFTUVOVF9OT0RFID0gTm9kZS5FTEVNRU5UX05PREU7CgoKCgkJCS8vIE1haW4gZnVuY3Rpb24KCQkJdmFyIGRlZXBfZG9tX3dyYXAgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBtYXRjaF9mbiwgZWxlbWVudF9mbiwgc2V0dXBfZm4sIHF1aWNrKSB7CgkJCQl2YXIgb2Zmc2V0cyA9IFtdLAoJCQkJCXRleHQgPSB0ZXh0aWZ5X25vZGUoY29udGFpbmVyLCBvZmZzZXRzLCBlbGVtZW50X2ZuKSwKCQkJCQljb3VudCA9IDAsCgkJCQkJbWF0Y2hfcG9zID0gMCwKCQkJCQltYXRjaDsKCgkJCQlpZiAodGV4dC5sZW5ndGggPiAwKSB7CgkJCQkJaWYgKHF1aWNrKSB7CgkJCQkJCS8vIFF1aWNrIG1vZGU6IGp1c3QgZmluZCBhbGwgdGhlIG1hdGNoZXMKCQkJCQkJd2hpbGUgKChtYXRjaCA9IG1hdGNoX2ZuKHRleHQsIG1hdGNoX3BvcykpICE9PSBudWxsKSB7CgkJCQkJCQkrK2NvdW50OwoJCQkJCQkJbWF0Y2hfcG9zID0gbWF0Y2hbMV07CgkJCQkJCX0KCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCS8vIExvb3AgdG8gZmluZCBhbGwgbWF0Y2hlcwoJCQkJCQl3aGlsZSAoKG1hdGNoID0gbWF0Y2hfZm4odGV4dCwgbWF0Y2hfcG9zKSkgIT09IG51bGwpIHsKCQkJCQkJCSsrY291bnQ7CgkJCQkJCQltYXRjaF9wb3MgPSBtYXRjaFsxXTsKCQkJCQkJCXJlcGxhY2VfbWF0Y2gobWF0Y2gsIHRleHQsIG9mZnNldHMsIHNldHVwX2ZuKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBEb25lCgkJCQlyZXR1cm4gY291bnQ7CgkJCX07CgoJCQl2YXIgdGV4dGlmeV9ub2RlID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgb2Zmc2V0cywgZWxlbWVudF9mbikgewoJCQkJLy8gQ3JlYXRlIGEgc3RyaW5nIG9mIHRoZSBjb250YWluZXIncyBjb250ZW50cyAoc2ltaWxhciB0byBidXQgbm90IGV4YWN0bHkgdGhlIHNhbWUgYXMgbm9kZS50ZXh0Q29udGVudCkKCQkJCS8vIEFsc28gbGlzdHMgYWxsIHRleHQgbm9kZXMgaW50byB0aGUgb2Zmc2V0cyBhcnJheQoJCQkJdmFyIHBhciA9IGNvbnRhaW5lciwKCQkJCQlub2RlID0gY29udGFpbmVyLmZpcnN0Q2hpbGQsCgkJCQkJdGV4dCA9ICIiLAoJCQkJCWNoZWNrOwoKCQkJCXdoaWxlICh0cnVlKSB7CgkJCQkJaWYgKG5vZGUgPT09IG51bGwpIHsKCQkJCQkJLy8gRG9uZT8KCQkJCQkJaWYgKHBhciA9PT0gY29udGFpbmVyKSBicmVhazsKCgkJCQkJCS8vIE1vdmUgdXAgdHJlZQoJCQkJCQlub2RlID0gcGFyOwoJCQkJCQlwYXIgPSBub2RlLnBhcmVudE5vZGU7CgkJCQkJCW5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwoJCQkJCX0KCQkJCQllbHNlIGlmIChub2RlLm5vZGVUeXBlID09PSBURVhUX05PREUpIHsKCQkJCQkJLy8gQWRkIHRvIGxpc3QgYW5kIHRleHQKCQkJCQkJb2Zmc2V0cy5wdXNoKHsKCQkJCQkJCW5vZGU6IG5vZGUsCgkJCQkJCQlzdGFydDogdGV4dC5sZW5ndGgsCgkJCQkJCQlsZW5ndGg6IG5vZGUubm9kZVZhbHVlLmxlbmd0aAoJCQkJCQl9KTsKCQkJCQkJdGV4dCArPSBub2RlLm5vZGVWYWx1ZTsKCQkJCQkJbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKG5vZGUubm9kZVR5cGUgPT09IEVMRU1FTlRfTk9ERSkgewoJCQkJCQkvLyBDaGVjayBlbGVtZW50CgkJCQkJCWNoZWNrID0gZWxlbWVudF9mbihub2RlKTsKCgkJCQkJCS8vIExpbmUgYnJlYWsKCQkJCQkJaWYgKChjaGVjayAmIE5PREVfTElORV9CUkVBSykgIT09IDApIHsKCQkJCQkJCXRleHQgKz0gIlxuIjsKCQkJCQkJfQoKCQkJCQkJLy8gUGFyc2UKCQkJCQkJaWYgKChjaGVjayAmIE5PREVfTk9fUEFSU0UpID09PSAwKSB7CgkJCQkJCQkvLyBDaGlsZAoJCQkJCQkJcGFyID0gbm9kZTsKCQkJCQkJCW5vZGUgPSBwYXIuZmlyc3RDaGlsZDsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCS8vIE5leHQKCQkJCQkJCW5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWVsc2UgeyAvLyBTb21lIG90aGVyIHR5cGUgb2Ygbm9kZQoJCQkJCQkvLyBOZXh0CgkJCQkJCW5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwoJCQkJCX0KCQkJCX0KCgkJCQlyZXR1cm4gdGV4dDsKCQkJfTsKCgkJCXZhciByZXBsYWNlX21hdGNoID0gZnVuY3Rpb24gKG1hdGNoLCB0ZXh0LCBvZmZzZXRzLCBzZXR1cF9mbikgewoJCQkJdmFyIGQgPSBkb2N1bWVudCwKCQkJCQlzdGFydCA9IG1hdGNoWzBdLAoJCQkJCWVuZCA9IG1hdGNoWzFdLAoJCQkJCXRhZyA9IG1hdGNoWzJdLAoJCQkJCW9mZnNldF9jb3VudCA9IG9mZnNldHMubGVuZ3RoLAoJCQkJCXByZWZpeCwgc3VmZml4LCBsZW4sCgkJCQkJbm9kZSwgcGFyLCBuZXh0LCBjbG9uZSwKCQkJCQl3cmFwcGVyLCB3cmFwcGVyX25vZGUsIHJlbGF0aXZlX25vZGUsIHJlbGF0aXZlX3BhciwKCQkJCQlvX3N0YXJ0LCBvX2VuZCwgb2Zmc2V0X3N0YXJ0LCBvZmZzZXRfZW5kLCBvZmZzZXRfY3VycmVudDsKCgkJCQkvLyBGaW5kIHRoZSBiZWdpbm5pbmcgYW5kIGVuZGluZyB0ZXh0IG5vZGVzCgkJCQlmb3IgKG9fc3RhcnQgPSAxOyBvX3N0YXJ0IDwgb2Zmc2V0X2NvdW50OyArK29fc3RhcnQpIHsKCQkJCQlpZiAob2Zmc2V0c1tvX3N0YXJ0XS5zdGFydCA+IHN0YXJ0KSBicmVhazsKCQkJCX0KCQkJCWZvciAob19lbmQgPSBvX3N0YXJ0OyBvX2VuZCA8IG9mZnNldF9jb3VudDsgKytvX2VuZCkgewoJCQkJCWlmIChvZmZzZXRzW29fZW5kXS5zdGFydCA+IGVuZCkgYnJlYWs7CgkJCQl9CgkJCQktLW9fc3RhcnQ7CgkJCQktLW9fZW5kOwoJCQkJb2Zmc2V0X3N0YXJ0ID0gb2Zmc2V0c1tvX3N0YXJ0XTsKCQkJCW9mZnNldF9lbmQgPSBvZmZzZXRzW29fZW5kXTsKCgoKCQkJCS8vIFZhcnMgdG8gY3JlYXRlIHRoZSBsaW5rCgkJCQlwcmVmaXggPSB0ZXh0LnNsaWNlKG9mZnNldF9zdGFydC5zdGFydCwgc3RhcnQpOwoJCQkJc3VmZml4ID0gdGV4dC5zbGljZShlbmQsIG9mZnNldF9lbmQuc3RhcnQgKyBvZmZzZXRfZW5kLmxlbmd0aCk7CgkJCQl3cmFwcGVyID0gZC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CgkJCQl3cmFwcGVyX25vZGUgPSB3cmFwcGVyOwoJCQkJcmVsYXRpdmVfbm9kZSA9IG51bGw7CgoJCQkJLy8gUHJlZml4IHVwZGF0ZQoJCQkJb2Zmc2V0X2N1cnJlbnQgPSBvZmZzZXRzW29fc3RhcnRdOwoJCQkJbm9kZSA9IG9mZnNldF9jdXJyZW50Lm5vZGU7CgkJCQlsZW4gPSBwcmVmaXgubGVuZ3RoOwoJCQkJaWYgKGxlbiA+IDApIHsKCQkJCQkvLyBJbnNlcnQgcHJlZml4CgkJCQkJbmV4dCA9IGQuY3JlYXRlVGV4dE5vZGUocHJlZml4KTsKCQkJCQlub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5leHQsIG5vZGUpOwoKCQkJCQkvLyBVcGRhdGUgdGV4dAoJCQkJCW5vZGUubm9kZVZhbHVlID0gbm9kZS5ub2RlVmFsdWUuc3Vic3RyKGxlbik7CgoJCQkJCS8vIFNldCBmaXJzdCByZWxhdGl2ZQoJCQkJCXJlbGF0aXZlX25vZGUgPSBuZXh0OwoJCQkJCXJlbGF0aXZlX3BhciA9IG5leHQucGFyZW50Tm9kZTsKCgkJCQkJLy8gVXBkYXRlIG9mZnNldCBmb3IgbmV4dCBzZWFyY2gKCQkJCQlvZmZzZXRfY3VycmVudC5zdGFydCArPSBsZW47CgkJCQkJb2Zmc2V0X2N1cnJlbnQubGVuZ3RoIC09IGxlbjsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIFNldCBmaXJzdCByZWxhdGl2ZQoJCQkJCXJlbGF0aXZlX25vZGUgPSBub2RlLnByZXZpb3VzU2libGluZzsKCQkJCQlyZWxhdGl2ZV9wYXIgPSBub2RlLnBhcmVudE5vZGU7CgkJCQl9CgoJCQkJLy8gTG9vcCBvdmVyIEVMRU1FTlRfTk9ERXM7IGFkZCBURVhUX05PREVzIHRvIHRoZSBsaW5rLCByZW1vdmUgZW1wdHkgbm9kZXMgd2hlcmUgbmVjZXNzYXJ5CgkJCQlmb3IgKDsgb19zdGFydCA8IG9fZW5kOyArK29fc3RhcnQpIHsKCQkJCQkvLyBOZXh0CgkJCQkJbm9kZSA9IG9mZnNldHNbb19zdGFydF0ubm9kZTsKCQkJCQluZXh0ID0gbm9kZS5uZXh0U2libGluZzsKCQkJCQlwYXIgPSBub2RlLnBhcmVudE5vZGU7CgoJCQkJCS8vIEFkZCB0ZXh0CgkJCQkJd3JhcHBlcl9ub2RlLmFwcGVuZENoaWxkKG5vZGUpOwoKCQkJCQkvLyBOb2RlIGxvb3AKCQkJCQl3aGlsZSAodHJ1ZSkgewoJCQkJCQlpZiAobmV4dCA9PT0gbnVsbCkgewoJCQkJCQkJLy8gTW92ZSB1cCB0cmVlCgkJCQkJCQlub2RlID0gcGFyOwoJCQkJCQkJbmV4dCA9IG5vZGUubmV4dFNpYmxpbmc7CgkJCQkJCQlwYXIgPSBub2RlLnBhcmVudE5vZGU7CgoJCQkJCQkJaWYgKG5vZGUuZmlyc3RDaGlsZCA9PT0gbnVsbCkgcGFyLnJlbW92ZUNoaWxkKG5vZGUpOwoKCQkJCQkJCS8vIFVwZGF0ZSBsaW5rIG5vZGUKCQkJCQkJCWlmICh3cmFwcGVyX25vZGUgIT09IHdyYXBwZXIpIHsKCQkJCQkJCQkvLyBTaW1wbHkgbW92ZSB1cCB0cmVlICh3cmFwcGVyX25vZGUgc3RpbGwgaGFzIGEgcGFyZW50KQoJCQkJCQkJCXdyYXBwZXJfbm9kZSA9IHdyYXBwZXJfbm9kZS5wYXJlbnROb2RlOwoJCQkJCQkJfQoJCQkJCQkJZWxzZSB7CgkJCQkJCQkJLy8gQ3JlYXRlIGEgbmV3IHdyYXBwZXIgbm9kZSAod3JhcHBlcl9ub2RlIGhhcyBubyBwYXJlbnQ7IGl0J3MgdGhlIHdyYXBwZXIpCgkJCQkJCQkJY2xvbmUgPSBub2RlLmNsb25lTm9kZShmYWxzZSk7CgkJCQkJCQkJY2xvbmUuYXBwZW5kQ2hpbGQod3JhcHBlcik7IC8vIHdyYXBwZXIgaXMgYSBEb2N1bWVudEZyYWdtZW50CgkJCQkJCQkJd3JhcHBlci5hcHBlbmRDaGlsZChjbG9uZSk7CgoJCQkJCQkJCS8vIFBsYWNlbWVudCByZWxhdGl2ZXMKCQkJCQkJCQlyZWxhdGl2ZV9ub2RlID0gKG5leHQgIT09IG51bGwpID8gbmV4dC5wcmV2aW91c1NpYmxpbmcgOiBudWxsOwoJCQkJCQkJCXJlbGF0aXZlX3BhciA9IHBhcjsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQllbHNlIGlmIChuZXh0Lm5vZGVUeXBlID09PSBURVhUX05PREUpIHsKCQkJCQkJCS8vIERvbmUKCQkJCQkJCWJyZWFrOwoJCQkJCQl9CgkJCQkJCWVsc2UgaWYgKG5leHQubm9kZVR5cGUgPT09IEVMRU1FTlRfTk9ERSkgewoJCQkJCQkJLy8gRGVlcGVyCgkJCQkJCQlub2RlID0gbmV4dDsKCQkJCQkJCW5leHQgPSBub2RlLmZpcnN0Q2hpbGQ7CgkJCQkJCQlwYXIgPSBub2RlOwoKCQkJCQkJCS8vIFVwZGF0ZSBsaW5rIG5vZGUKCQkJCQkJCWNsb25lID0gbm9kZS5jbG9uZU5vZGUoZmFsc2UpOwoJCQkJCQkJd3JhcHBlcl9ub2RlLmFwcGVuZENoaWxkKGNsb25lKTsKCQkJCQkJCXdyYXBwZXJfbm9kZSA9IGNsb25lOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJLy8gU29tZSBvdGhlciBub2RlIHR5cGU7IGNvbnRpbnVlIGFueXdheQoJCQkJCQkJbm9kZSA9IG5leHQ7CgkJCQkJCQluZXh0ID0gbm9kZS5uZXh0U2libGluZzsKCgkJCQkJCQkvLyBVcGRhdGUgbGluayBub2RlCgkJCQkJCQl3cmFwcGVyX25vZGUuYXBwZW5kQ2hpbGQobm9kZSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gU3VmZml4IHVwZGF0ZQoJCQkJb2Zmc2V0X2N1cnJlbnQgPSBvZmZzZXRzW29fc3RhcnRdOwoJCQkJbm9kZSA9IG9mZnNldF9jdXJyZW50Lm5vZGU7CgkJCQlwYXIgPSBub2RlLnBhcmVudE5vZGU7CgkJCQlsZW4gPSBzdWZmaXgubGVuZ3RoOwoJCQkJaWYgKGxlbiA+IDApIHsKCQkJCQkvLyBJbnNlcnQgc3VmZml4CgkJCQkJbmV4dCA9IGQuY3JlYXRlVGV4dE5vZGUoc3VmZml4KTsKCQkJCQlwYXIuaW5zZXJ0QmVmb3JlKG5leHQsIG5vZGUubmV4dFNpYmxpbmcpOwoKCQkJCQkvLyBVcGRhdGUgdGV4dAoJCQkJCWxlbiA9IG5vZGUubm9kZVZhbHVlLmxlbmd0aCAtIGxlbjsKCQkJCQlub2RlLm5vZGVWYWx1ZSA9IG5vZGUubm9kZVZhbHVlLnN1YnN0cigwLCBsZW4pOwoKCQkJCQkvLyBVcGRhdGUgb2Zmc2V0IGZvciBuZXh0IHNlYXJjaAoJCQkJCW9mZnNldF9jdXJyZW50LnRleHRfbGVuZ3RoICs9IGxlbjsKCQkJCQlvZmZzZXRfY3VycmVudC5sZW5ndGggLT0gbGVuOwoJCQkJCW9mZnNldF9jdXJyZW50Lm5vZGUgPSBuZXh0OwoJCQkJfQoKCQkJCS8vIEFkZCB0aGUgbGFzdCBzZWdtZW50CgkJCQl3cmFwcGVyX25vZGUuYXBwZW5kQ2hpbGQobm9kZSk7CgoKCgkJCQkvLyBTZXR1cCBmdW5jdGlvbgoJCQkJaWYgKHRhZyAhPT0gbnVsbCkgewoJCQkJCW5vZGUgPSB3cmFwcGVyOwoJCQkJCXdyYXBwZXIgPSBkLmNyZWF0ZUVsZW1lbnQodGFnKTsKCQkJCQl3cmFwcGVyLmFwcGVuZENoaWxkKG5vZGUpOwoJCQkJfQoJCQkJaWYgKHNldHVwX2ZuICE9PSBudWxsKSBzZXR1cF9mbih3cmFwcGVyLCBtYXRjaCk7CgoKCgkJCQkvLyBGaW5kIHRoZSBwcm9wZXIgcmVsYXRpdmUgbm9kZQoJCQkJcmVsYXRpdmVfbm9kZSA9IChyZWxhdGl2ZV9ub2RlICE9PSBudWxsKSA/IHJlbGF0aXZlX25vZGUubmV4dFNpYmxpbmcgOiByZWxhdGl2ZV9wYXIuZmlyc3RDaGlsZDsKCgkJCQkvLyBJbnNlcnQgbGluawoJCQkJcmVsYXRpdmVfcGFyLmluc2VydEJlZm9yZSh3cmFwcGVyLCByZWxhdGl2ZV9ub2RlKTsKCgkJCQkvLyBSZW1vdmUgZW1wdHkgc3VmZml4IHRhZ3MKCQkJCXdoaWxlIChwYXIuZmlyc3RDaGlsZCA9PT0gbnVsbCkgewoJCQkJCW5vZGUgPSBwYXI7CgkJCQkJcGFyID0gcGFyLnBhcmVudE5vZGU7CgkJCQkJcGFyLnJlbW92ZUNoaWxkKG5vZGUpOwoJCQkJfQoKCgoJCQkJLy8gVXBkYXRlIG1hdGNoIHBvc2l0aW9uCgkJCQlvZmZzZXRfZW5kLnN0YXJ0ID0gZW5kOwoJCQl9OwoKCgoJCQkvLyBFeHBvcnRzCgkJCWRlZXBfZG9tX3dyYXAuTk9ERV9QQVJTRSA9IE5PREVfUEFSU0U7CgkJCWRlZXBfZG9tX3dyYXAuTk9ERV9OT19QQVJTRSA9IE5PREVfTk9fUEFSU0U7CgkJCWRlZXBfZG9tX3dyYXAuTk9ERV9MSU5FX0JSRUFLID0gTk9ERV9MSU5FX0JSRUFLOwoKCQkJcmV0dXJuIGRlZXBfZG9tX3dyYXA7CgoJCX0pKCk7CgoJCXZhciBsaW5raWZ5X2dyb3VwcyA9IFt7CgkJCXJlZ2V4OiByZV91cmwsCgkJCXByZWZpeF9ncm91cDogMSwKCQkJcHJlZml4OiAiaHR0cDovLyIsCgkJCXByZWZpeF9yZXBsYWNlOiBbIC9eXC8rLywgIiIgXSwKCQkJdGFnOiAiYSIsCgkJCW1hdGNoOiBudWxsCgkJfV07CgkJdmFyIGxpbmtpZnkgPSBmdW5jdGlvbiAoY29udGFpbmVyLCByZXN1bHRfbm9kZXMsIHJlc3VsdF91cmxzKSB7CgkJCXZhciBtYXRjaF9mbiwgbm9kZV9zZXR1cDsKCgkJCWlmIChsaW5raWZ5X2dyb3Vwcy5sZW5ndGggPT09IDEpIHsKCQkJCS8vIE5vcm1hbAoJCQkJbWF0Y2hfZm4gPSBmdW5jdGlvbiAodGV4dCwgcG9zKSB7CgkJCQkJcmVfdXJsLmxhc3RJbmRleCA9IHBvczsKCQkJCQl2YXIgbSA9IHJlX3VybC5leGVjKHRleHQpOwoJCQkJCWlmIChtID09PSBudWxsKSByZXR1cm4gbnVsbDsKCQkJCQlyZXR1cm4gWyBtLmluZGV4ICwgbS5pbmRleCArIG1bMF0ubGVuZ3RoLCAiYSIsIG0gXTsKCQkJCX07CgkJCQlub2RlX3NldHVwID0gZnVuY3Rpb24gKG5vZGUsIG1hdGNoKSB7CgkJCQkJdmFyIHVybCA9IG1hdGNoWzNdWzBdOwoJCQkJCWlmIChtYXRjaFszXVsxXSA9PT0gdW5kZWZpbmVkKSB1cmwgPSAiaHR0cDovLyIgKyB1cmwucmVwbGFjZSgvXlwvKy8sICIiKTsKCQkJCQlyZXN1bHRfbm9kZXMucHVzaChub2RlKTsKCQkJCQlyZXN1bHRfdXJscy5wdXNoKHVybCk7CgkJCQl9OwoJCQl9CgkJCWVsc2UgewoJCQkJLy8gTXVsdGlwbGUKCQkJCW1hdGNoX2ZuID0gZnVuY3Rpb24gKHRleHQsIHBvcykgewoJCQkJCXZhciByZXMgPSBudWxsLAoJCQkJCQlncm91cCwgaSwgaWksIG07CgoJCQkJCWZvciAoaSA9IDAsIGlpID0gbGlua2lmeV9ncm91cHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQlncm91cCA9IGxpbmtpZnlfZ3JvdXBzW2ldOwoKCQkJCQkJaWYgKChtID0gZ3JvdXAubWF0Y2gpID09PSBudWxsIHx8IG0uaW5kZXggPCBwb3MpIHsKCQkJCQkJCWdyb3VwLnJlZ2V4Lmxhc3RJbmRleCA9IHBvczsKCQkJCQkJCWdyb3VwLm1hdGNoID0gbSA9IGdyb3VwLnJlZ2V4LmV4ZWModGV4dCk7CgkJCQkJCX0KCQkJCQkJaWYgKG0gIT09IG51bGwgJiYgKHJlcyA9PT0gbnVsbCB8fCByZXNbMF0gPiBtLmluZGV4KSkgewoJCQkJCQkJcmVzID0gWyBtLmluZGV4ICwgbS5pbmRleCArIG1bMF0ubGVuZ3RoLCBncm91cC50YWcsIG0sIGdyb3VwIF07CgkJCQkJCX0KCQkJCQl9CgoJCQkJCXJldHVybiByZXM7CgkJCQl9OwoJCQkJbm9kZV9zZXR1cCA9IGZ1bmN0aW9uIChub2RlLCBtYXRjaCkgewoJCQkJCXZhciB1cmwgPSBtYXRjaFszXVswXSwKCQkJCQkJZ3JvdXAgPSBtYXRjaFs0XSwKCQkJCQkJcmU7CgoJCQkJCWlmIChtYXRjaFszXVtncm91cC5wcmVmaXhfZ3JvdXBdID09PSB1bmRlZmluZWQpIHsKCQkJCQkJaWYgKChyZSA9IGdyb3VwLnByZWZpeF9yZXBsYWNlKSAhPT0gbnVsbCkgewoJCQkJCQkJdXJsID0gdXJsLnJlcGxhY2UocmVbMF0sIHJlWzFdKTsKCQkJCQkJfQoJCQkJCQl1cmwgPSBncm91cC5wcmVmaXggKyB1cmw7CgkJCQkJfQoKCQkJCQlyZXN1bHRfbm9kZXMucHVzaChub2RlKTsKCQkJCQlyZXN1bHRfdXJscy5wdXNoKHVybCk7CgkJCQl9OwoJCQl9CgoJCQlkZWVwX2RvbV93cmFwKGNvbnRhaW5lciwgbWF0Y2hfZm4sIGxpbmtpZnlfZWxlbWVudF9jaGVja2VyLCBub2RlX3NldHVwLCBmYWxzZSk7CgkJfTsKCQl2YXIgbGlua2lmeV9lbGVtZW50X2NoZWNrZXIgPSBmdW5jdGlvbiAobm9kZSkgewoJCQlpZiAobm9kZS50YWdOYW1lID09PSAiQlIiIHx8IG5vZGUudGFnTmFtZSA9PT0gIkEiKSB7CgkJCQlyZXR1cm4gZGVlcF9kb21fd3JhcC5OT0RFX05PX1BBUlNFIHwgZGVlcF9kb21fd3JhcC5OT0RFX0xJTkVfQlJFQUs7CgkJCX0KCQkJZWxzZSBpZiAobm9kZS50YWdOYW1lID09PSAiV0JSIikgewoJCQkJcmV0dXJuIGRlZXBfZG9tX3dyYXAuTk9ERV9OT19QQVJTRTsKCQkJfQoJCQllbHNlIGlmIChub2RlLnRhZ05hbWUgPT09ICJESVYiKSB7CgkJCQlpZiAocmVfdXJsX2NsYXNzX2lnbm9yZS50ZXN0KG5vZGUuY2xhc3NOYW1lKSkgewoJCQkJCXJldHVybiBkZWVwX2RvbV93cmFwLk5PREVfTk9fUEFSU0UgfCBkZWVwX2RvbV93cmFwLk5PREVfTElORV9CUkVBSzsKCQkJCX0KCQkJCXJldHVybiBkZWVwX2RvbV93cmFwLk5PREVfTElORV9CUkVBSzsKCQkJfQoJCQlyZXR1cm4gZGVlcF9kb21fd3JhcC5OT0RFX1BBUlNFOwoJCX07CgkJdmFyIGxpbmtpZnlfdGVzdCA9IGZ1bmN0aW9uICh0ZXh0KSB7CgkJCXZhciBncm91cCwgcmUsIGksIGlpLCBtOwoJCQlmb3IgKGkgPSAwLCBpaSA9IGxpbmtpZnlfZ3JvdXBzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWdyb3VwID0gbGlua2lmeV9ncm91cHNbaV07CgkJCQlyZSA9IGdyb3VwLnJlZ2V4OwoJCQkJcmUubGFzdEluZGV4ID0gMDsKCQkJCWlmICgobSA9IHJlLmV4ZWModGV4dCkpICE9PSBudWxsKSB7CgkJCQkJaWYgKG1bZ3JvdXAucHJlZml4X2dyb3VwXSA9PT0gdW5kZWZpbmVkKSB7CgkJCQkJCWlmICgocmUgPSBncm91cC5wcmVmaXhfcmVwbGFjZSkgIT09IG51bGwpIHsKCQkJCQkJCXRleHQgPSB0ZXh0LnJlcGxhY2UocmVbMF0sIHJlWzFdKTsKCQkJCQkJfQoJCQkJCQl0ZXh0ID0gZ3JvdXAucHJlZml4ICsgdGV4dDsKCQkJCQl9CgkJCQkJcmV0dXJuIHRleHQ7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIG51bGw7CgkJfTsKCQl2YXIgbGlua2lmeV9yZWdpc3RlciA9IGZ1bmN0aW9uIChyZWdleCwgcHJlZml4X2dyb3VwLCBwcmVmaXgsIHByZWZpeF9yZXBsYWNlX3JlZ2V4LCBwcmVmaXhfcmVwbGFjZV93aXRoKSB7CgkJCXZhciBwcmVmaXhfcmVwbGFjZSA9IG51bGw7CgoJCQlpZiAocHJlZml4X3JlcGxhY2VfcmVnZXggIT09IG51bGwgJiYgdHlwZW9mKHByZWZpeF9yZXBsYWNlX3dpdGgpID09PSAic3RyaW5nIikgewoJCQkJcHJlZml4X3JlcGxhY2UgPSBbIHByZWZpeF9yZXBsYWNlX3JlZ2V4LCBwcmVmaXhfcmVwbGFjZV93aXRoIF07CgkJCX0KCgkJCWxpbmtpZnlfZ3JvdXBzLnB1c2goewoJCQkJcmVnZXg6IHJlZ2V4LAoJCQkJcHJlZml4X2dyb3VwOiBwcmVmaXhfZ3JvdXAsCgkJCQlwcmVmaXg6IHByZWZpeCwKCQkJCXByZWZpeF9yZXBsYWNlOiBwcmVmaXhfcmVwbGFjZSwKCQkJCXRhZzogImEiLAoJCQkJbWF0Y2g6IG51bGwKCQkJfSk7CgkJfTsKCgkJdmFyIHBhcnNlX3RleHRfZm9yX3VybHMgPSBmdW5jdGlvbiAodGV4dCkgewoJCQl2YXIgdXJscyA9IFtdLAoJCQkJbTsKCgkJCXJlX3VybC5sYXN0SW5kZXggPSAwOwoKCQkJd2hpbGUgKChtID0gcmVfdXJsLmV4ZWModGV4dCkpICE9PSBudWxsKSB7CgkJCQl1cmxzLnB1c2gobVswXSk7CgkJCX0KCgkJCXJldHVybiB1cmxzOwoJCX07CgoJCS8vIExpbmsgY3JlYXRpb24gYW5kIHByb2Nlc3NpbmcKCQl2YXIgY3JlYXRlX2xpbmsgPSBmdW5jdGlvbiAocGFyZW50LCBuZXh0LCB1cmwsIHRleHQsIGF1dG9fcHJvY2VzcykgewoJCQl2YXIgbGluayA9ICQubGluayh1cmwsICJ4bC1saW5rLWNyZWF0ZWQiLCB0ZXh0KTsKCgkJCSQuYmVmb3JlKHBhcmVudCwgbmV4dCwgbGluayk7CgoJCQlwcmVwcm9jZXNzX2xpbmsobGluaywgdXJsLCBmYWxzZSwgYXV0b19wcm9jZXNzKTsKCgkJCXJldHVybiBsaW5rOwoJCX07CgkJdmFyIHByZXByb2Nlc3NfbGluayA9IGZ1bmN0aW9uIChub2RlLCB1cmwsIHVwZGF0ZV9vbl9mYWlsLCBhdXRvX2xvYWQpIHsKCQkJaWYgKCFmaXJzdF9saW5rX3ByZXByb2Nlc3NlZCkgewoJCQkJZmlyc3RfbGlua19wcmVwcm9jZXNzZWQgPSB0cnVlOwoJCQkJdHJpZ2dlcihldmVudF9saXN0ZW5lcnMuYmVmb3JlX2ZpcnN0X2xpbmtfcHJlcHJvY2VzcywgbnVsbCk7CgkJCX0KCgkJCUFQSS5nZXRfdXJsX2luZm8odXJsLCBmdW5jdGlvbiAoZXJyLCBpbmZvKSB7CgkJCQl2YXIgbW9kaWZ5X2xpbmsgPSB0cnVlOwoKCQkJCWlmIChub2RlLnBhcmVudE5vZGUgPT09IG51bGwgfHwgbm9kZS5jbGFzc0xpc3QuY29udGFpbnMoInhsLWxpbmtpZmllZCIpKSByZXR1cm47CgoJCQkJaWYgKGVyciAhPT0gbnVsbCB8fCBpbmZvID09PSBudWxsIHx8IChjb25maWcuc2l0ZXNbaW5mby5zaXRlXSA9PT0gZmFsc2UgfHwgQ29uZmlnLmdldF9jdXN0b20oInNpdGVzIiwgaW5mby5zaXRlKSA9PT0gZmFsc2UpKSB7CgkJCQkJaWYgKHVwZGF0ZV9vbl9mYWlsKSB7CgkJCQkJCW5vZGUuaHJlZiA9IHVybDsKCQkJCQkJbm9kZS50YXJnZXQgPSAiX2JsYW5rIjsKCQkJCQkJbm9kZS5yZWwgPSAibm9yZWZlcnJlciI7CgkJCQkJCW5vZGUuY2xhc3NMaXN0LmFkZCgieGwtbGlua2lmaWVkIik7CgkJCQkJfQoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlpZiAobW9kaWZ5X2xpbmspIHsKCQkJCQl1cmwgPSBBUEkucmV3cml0ZV9saW5rKHVybCwgaW5mbyk7CgoJCQkJCW5vZGUuaHJlZiA9IHVybDsKCQkJCQlub2RlLnRhcmdldCA9ICJfYmxhbmsiOwoJCQkJCW5vZGUucmVsID0gIm5vcmVmZXJyZXIiOwoJCQkJfQoKCQkJCW5vZGUuY2xhc3NMaXN0LmFkZCgieGwtbGluayIpOwoJCQkJbm9kZS5jbGFzc0xpc3QuYWRkKCJ4bC1saW5raWZpZWQiKTsKCgkJCQlVSS5zZXR1cF9saW5rKG5vZGUsIHVybCwgaW5mbywgYXV0b19sb2FkLCBtb2RpZnlfbGluayk7CgkJCX0pOwoJCX07CgoJCS8vIFBvc3QgcXVldWUKCQl2YXIgcG9zdF9xdWV1ZSA9IHsKCQkJcG9zdHM6IFtdLAoJCQl0aW1lcjogbnVsbCwKCQkJZ3JvdXBfc2l6ZTogMjUsCgkJCWRlbGF5OiA1MAoJCX07CgkJdmFyIHF1ZXVlX3Bvc3RzID0gZnVuY3Rpb24gKHBvc3RzLCBmbGFncykgewoJCQlpZiAoKGZsYWdzICYgcXVldWVfcG9zdHMuRmxhZ3MuRmx1c2gpICE9PSAwKSB7CgkJCQkvLyBGbHVzaAoJCQkJaWYgKChmbGFncyAmIHF1ZXVlX3Bvc3RzLkZsYWdzLkZsdXNoTm9QYXJzZSkgPT09IDApIHsKCQkJCQlwYXJzZV9wb3N0cyhwb3N0X3F1ZXVlLnBvc3RzKTsKCQkJCX0KCQkJCXBvc3RfcXVldWUucG9zdHMgPSBbXTsKCgkJCQkvLyBDbGVhciB0aW1lcgoJCQkJaWYgKHBvc3RfcXVldWUudGltZXIgIT09IG51bGwpIHsKCQkJCQljbGVhclRpbWVvdXQocG9zdF9xdWV1ZS50aW1lcik7CgkJCQkJcG9zdF9xdWV1ZS50aW1lciA9IG51bGw7CgkJCQl9CgkJCX0KCgkJCWlmICgoZmxhZ3MgJiBxdWV1ZV9wb3N0cy5GbGFncy5Vc2VEZWxheSkgPT09IDApIHsKCQkJCS8vIEltbWVkaWF0ZQoJCQkJcGFyc2VfcG9zdHMocG9zdHMpOwoJCQl9CgkJCWVsc2UgewoJCQkJLy8gUXVldWUKCQkJCSQucHVzaF9tYW55KHBvc3RfcXVldWUucG9zdHMsIHBvc3RzKTsKCgkJCQkvLyBSdW4gcXVldWUKCQkJCWlmIChwb3N0X3F1ZXVlLnRpbWVyID09PSBudWxsKSB7CgkJCQkJZGVxdWV1ZV9wb3N0cygpOwoJCQkJfQoJCQl9CgkJfTsKCQlxdWV1ZV9wb3N0cy5GbGFncyA9IHsKCQkJTm9uZTogMHgwLAoJCQlVc2VEZWxheTogMHgxLAoJCQlGbHVzaDogMHgyLAoJCQlGbHVzaE5vUGFyc2U6IDB4NAoJCX07CgkJdmFyIGRlcXVldWVfcG9zdHMgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBwb3N0cyA9IHBvc3RfcXVldWUucG9zdHMuc3BsaWNlKDAsIHBvc3RfcXVldWUuZ3JvdXBfc2l6ZSk7CgoJCQlpZiAocG9zdHMubGVuZ3RoID09PSAwKSB7CgkJCQkvLyBEb25lCgkJCQlwb3N0X3F1ZXVlLnRpbWVyID0gbnVsbDsKCQkJfQoJCQllbHNlIHsKCQkJCS8vIFJ1bgoJCQkJcGFyc2VfcG9zdHMocG9zdHMpOwoKCQkJCS8vIFRpbWVyIGZvciBuZXh0CgkJCQlwb3N0X3F1ZXVlLnRpbWVyID0gc2V0VGltZW91dChkZXF1ZXVlX3Bvc3RzLCBwb3N0X3F1ZXVlLmRlbGF5KTsKCQkJfQoJCX07CgoJCXZhciBzZXR1cF9wb3N0X2V4c2F1Y2UgPSBmdW5jdGlvbiAocG9zdCkgewoJCQl2YXIgaW5kZXggPSAwLAoJCQkJZmlsZV9pbmZvcywgZmlsZV9pbmZvLCBub2RlLCBpLCBpaTsKCgkJCS8vIEZpbGUgaW5mbwoJCQlmaWxlX2luZm9zID0gUG9zdC5nZXRfZmlsZV9pbmZvKHBvc3QpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IGZpbGVfaW5mb3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJZmlsZV9pbmZvID0gZmlsZV9pbmZvc1tpXTsKCgkJCQkvLyBDcmVhdGUgaWYgbm90IGZvdW5kCgkJCQlub2RlID0gU2F1Y2UuZmluZF9saW5rKGZpbGVfaW5mby5vcHRpb25zKTsKCQkJCWlmIChub2RlICE9PSBudWxsKSAkLnJlbW92ZShub2RlKTsKCgkJCQlpZiAoL15cLihwbmd8Z2lmfGpwZT9nKSQvaS50ZXN0KGZpbGVfaW5mby50eXBlKSkgewoJCQkJCW5vZGUgPSBTYXVjZS5jcmVhdGVfbGluayhmaWxlX2luZm8sIGluZGV4KTsKCQkJCQlQb3N0LmNyZWF0ZV9pbWFnZV9tZXRhX2xpbmsoZmlsZV9pbmZvLCBub2RlKTsKCQkJCQkrK2luZGV4OwoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgcGFyc2VfcG9zdCA9IGZ1bmN0aW9uIChwb3N0KSB7CgkJCXZhciBhdXRvX2xvYWRfbGlua3MgPSBjb25maWcuZ2VuZXJhbC5hdXRvbWF0aWNfcHJvY2Vzc2luZywKCQkJCXBvc3RfYm9keSwgcG9zdF9saW5rcywgbGlua19ub2RlcywgbGlua191cmxzLCBsaW5rLCB1cmwsIHZhbGlkLCBpLCBpaTsKCgkJCS8vIEV4c2F1Y2UKCQkJaWYgKGNvbmZpZy5zYXVjZS5lbmFibGVkICYmICFicm93c2VyLmlzX29wZXJhKSB7CgkJCQlzZXR1cF9wb3N0X2V4c2F1Y2UocG9zdCk7CgkJCX0KCgkJCS8vIExpbmtpZnkKCQkJaWYgKChwb3N0X2JvZHkgPSBQb3N0LmdldF90ZXh0X2JvZHkocG9zdCkpICE9PSBudWxsKSB7CgkJCQlsaW5rX25vZGVzID0gW107CgkJCQlsaW5rX3VybHMgPSBbXTsKCgkJCQkvLyBFeGlzdGluZyBsaW5rcwoJCQkJcG9zdF9saW5rcyA9IFBvc3QuZ2V0X2JvZHlfbGlua3MocG9zdF9ib2R5KTsKCQkJCWZvciAoaSA9IDAsIGlpID0gcG9zdF9saW5rcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJbGluayA9IHBvc3RfbGlua3NbaV07CgkJCQkJaWYgKGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1zaXRlLXRhZyIpKSB7CgkJCQkJCSQucmVtb3ZlKGxpbmspOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJaWYgKENvbmZpZy5pc180Y2hhbikgewoJCQkJCQkJdmFsaWQgPSAoIWxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCJlbWJlZGRlciIpICYmIGxpbmsuZ2V0QXR0cmlidXRlKCJkYXRhLWNtZCIpICE9PSAiZW1iZWQiKTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCXZhbGlkID0gdHJ1ZTsKCQkJCQkJfQoKCQkJCQkJaWYgKHZhbGlkKSB7CgkJCQkJCQl1cmwgPSBsaW5rLmhyZWY7CgkJCQkJCQlpZiAoQ29uZmlnLmlzXzRjaGFuICYmIGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCJsaW5raWZpZWQiKSAmJiByZV80Y2hhbl9kZWZlcnJlci50ZXN0KHVybCkpIHsKCQkJCQkJCQl1cmwgPSBsaW5rLnRleHRDb250ZW50LnRyaW0oKTsKCQkJCQkJCX0KCQkJCQkJCXVybCA9IGxpbmtpZnlfdGVzdCh1cmwpOwoJCQkJCQkJaWYgKHVybCAhPT0gbnVsbCkgewoJCQkJCQkJCWxpbmtfbm9kZXMucHVzaChsaW5rKTsKCQkJCQkJCQlsaW5rX3VybHMucHVzaCh1cmwpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIExpbmtpZnkgbGlua3MKCQkJCWlpID0gbGlua19ub2Rlcy5sZW5ndGg7CgkJCQlsaW5raWZ5KHBvc3RfYm9keSwgbGlua19ub2RlcywgbGlua191cmxzKTsKCgkJCQkvLyBQcm9jZXNzCgkJCQlmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkgewoJCQkJCXByZXByb2Nlc3NfbGluayhsaW5rX25vZGVzW2ldLCBsaW5rX3VybHNbaV0sIGZhbHNlLCBhdXRvX2xvYWRfbGlua3MpOwoJCQkJfQoJCQkJZm9yIChpaSA9IGxpbmtfbm9kZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCXByZXByb2Nlc3NfbGluayhsaW5rX25vZGVzW2ldLCBsaW5rX3VybHNbaV0sIHRydWUsIGF1dG9fbG9hZF9saW5rcyk7CgkJCQl9CgoJCQkJLy8gTWFyawoJCQkJcG9zdC5jbGFzc0xpc3QuYWRkKCJ4bC1wb3N0LWxpbmtpZmllZCIpOwoJCQl9CgkJfTsKCQl2YXIgcGFyc2VfcG9zdHMgPSBmdW5jdGlvbiAocG9zdHMpIHsKCQkJdmFyIHBvc3QsIGksIGlpOwoKCQkJRGVidWcudGltZXIoInByb2Nlc3MiKTsKCgkJCWZvciAoaSA9IDAsIGlpID0gcG9zdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJcG9zdCA9IHBvc3RzW2ldOwoJCQkJaWYgKHBvc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1wb3N0LWxpbmtpZmllZCIpKSB7CgkJCQkJVUkuY2xlYW51cF9wb3N0KHBvc3QpOwoJCQkJCWFwcGx5X2xpbmtfZXZlbnRzKHBvc3QsIHRydWUpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdW5saW5raWZ5X3Bvc3QocG9zdCk7CgkJCQkJcGFyc2VfcG9zdChwb3N0KTsKCQkJCX0KCQkJfQoKCQkJRGVidWcubG9nKCJUb3RhbCBwb3N0cz0iICsgcG9zdHMubGVuZ3RoICsgIjsgdGltZT0iICsgRGVidWcudGltZXIoInByb2Nlc3MiKSk7CgkJfTsKCgkJLy8gTGluayBldmVudHMKCQl2YXIgbGlua19ldmVudHMgPSB7fTsKCQl2YXIgcmVnaXN0ZXJfbGlua19ldmVudHMgPSBmdW5jdGlvbiAoZXZlbnRzKSB7CgkJCXZhciBjb3VudCA9IDAsCgkJCQlrOwoKCQkJZm9yIChrIGluIGV2ZW50cykgewoJCQkJaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobGlua19ldmVudHMsIGspKSB7CgkJCQkJbGlua19ldmVudHNba10gPSBldmVudHNba107CgkJCQkJKytjb3VudDsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGNvdW50OwoJCX07CgkJdmFyIGdldF9saW5rX2V2ZW50cyA9IGZ1bmN0aW9uIChub2RlKSB7CgkJCXJldHVybiBub2RlLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1saW5rLWV2ZW50cyIpIHx8IG51bGw7CgkJfTsKCQl2YXIgc2V0X2xpbmtfZXZlbnRzID0gZnVuY3Rpb24gKG5vZGUsIG5ld19ldmVudHMpIHsKCQkJdmFyIGV2ZW50cyA9IGxpbmtfZXZlbnRzW25ld19ldmVudHNdLAoJCQkJazsKCgkJCWlmIChldmVudHMpIHsKCQkJCWlmICh0eXBlb2YoZXZlbnRzKSA9PT0gImZ1bmN0aW9uIikgewoJCQkJCSQub24obm9kZSwgImNsaWNrIiwgZXZlbnRzKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIEFycmF5CgkJCQkJZm9yIChrIGluIGV2ZW50cykgewoJCQkJCQkkLm9uKG5vZGUsIGssIGV2ZW50c1trXSk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgYXBwbHlfbGlua19ldmVudHMgPSBmdW5jdGlvbiAobm9kZSwgY2hlY2tfY2hpbGRyZW4pIHsKCQkJdmFyIG5vZGVzID0gY2hlY2tfY2hpbGRyZW4gPyAkJCgiYS54bC1saW5rLWV2ZW50cyIsIG5vZGUpIDogWyBub2RlIF0sCgkJCQlldmVudHMsIGksIGlpOwoKCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlub2RlID0gbm9kZXNbaV07CgkJCQlldmVudHMgPSBub2RlLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1saW5rLWV2ZW50cyIpOwoJCQkJc2V0X2xpbmtfZXZlbnRzKG5vZGUsIGV2ZW50cyk7CgkJCX0KCQl9OwoJCXZhciBjaGFuZ2VfbGlua19ldmVudHMgPSBmdW5jdGlvbiAobm9kZSwgbmV3X2V2ZW50cykgewoJCQl2YXIgb2xkX2V2ZW50cyA9IG5vZGUuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLWxpbmstZXZlbnRzIiksCgkJCQlldmVudHMsIGs7CgoJCQlldmVudHMgPSBsaW5rX2V2ZW50c1tvbGRfZXZlbnRzXTsKCQkJaWYgKGV2ZW50cykgewoJCQkJaWYgKHR5cGVvZihldmVudHMpID09PSAiZnVuY3Rpb24iKSB7CgkJCQkJJC5vZmYobm9kZSwgImNsaWNrIiwgZXZlbnRzKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIEFycmF5CgkJCQkJZm9yIChrIGluIGV2ZW50cykgewoJCQkJCQkkLm9mZihub2RlLCBrLCBldmVudHNba10pOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKG5ld19ldmVudHMgPT09IG51bGwpIHsKCQkJCW5vZGUuY2xhc3NMaXN0LnJlbW92ZSgieGwtbGluay1ldmVudHMiKTsKCQkJCW5vZGUucmVtb3ZlQXR0cmlidXRlKCJkYXRhLXhsLWxpbmstZXZlbnRzIik7CgkJCX0KCQkJZWxzZSB7CgkJCQlub2RlLmNsYXNzTGlzdC5hZGQoInhsLWxpbmstZXZlbnRzIik7CgkJCQlub2RlLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1saW5rLWV2ZW50cyIsIG5ld19ldmVudHMpOwoJCQkJc2V0X2xpbmtfZXZlbnRzKG5vZGUsIG5ld19ldmVudHMpOwoJCQl9CgkJfTsKCgkJLy8gRml4aW5nCgkJdmFyIGZpeF9pbmxpbmVfbGlua2lmaWVkX2xpbmsgPSBmdW5jdGlvbiAobm9kZSkgewoJCQl2YXIgcmVtb3ZhbHMsIGksIGlpLCBuOwoKCQkJaWYgKAoJCQkJKG5vZGUgPSBub2RlLm5leHRTaWJsaW5nKSAhPT0gbnVsbCAmJgoJCQkJbm9kZS50YWdOYW1lID09PSAiQSIgJiYKCQkJCW5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJsaW5raWZpZWQiKQoJCQkpIHsKCQkJCXJlbW92YWxzID0gW107CgkJCQluID0gbm9kZTsKCQkJCXdoaWxlICgobiA9IG4ubmV4dFNpYmxpbmcpICE9PSBudWxsKSB7CgkJCQkJaWYgKG4ubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7CgkJCQkJCXJlbW92YWxzLnB1c2gobik7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlpZiAobi50YWdOYW1lID09PSAiU1BBTiIgJiYgbi5jbGFzc0xpc3QuY29udGFpbnMoInhsLWxpbmstaW5uZXIiKSkgewoJCQkJCQkJJC5yZW1vdmUobm9kZSk7CgkJCQkJCQlmb3IgKGkgPSAwLCBpaSA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGlpOyArK2kpICQucmVtb3ZlKHJlbW92YWxzW2ldKTsKCQkJCQkJCSQucmVtb3ZlKG4pOwoJCQkJCQl9CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX07CgkJdmFyIHVubGlua2lmeV9wb3N0ID0gZnVuY3Rpb24gKHBvc3QpIHsKCQkJdmFyIG5vZGVzLCBpLCBpaTsKCgkJCW5vZGVzID0gJCQoIi54bC1zaXRlLXRhZyIsIHBvc3QpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCSQucmVtb3ZlKG5vZGVzW2ldKTsKCQkJfQoKCQkJbm9kZXMgPSAkJCgiLnhsLWxpbmstZXZlbnRzIiwgcG9zdCk7CgkJCWZvciAoaSA9IDAsIGlpID0gbm9kZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJY2hhbmdlX2xpbmtfZXZlbnRzKG5vZGVzW2ldLCBudWxsKTsKCQkJfQoKCQkJbm9kZXMgPSAkJCgiLnhsLWxpbmtpZmllZCIsIHBvc3QpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCW5vZGVzW2ldLmNsYXNzTGlzdC5yZW1vdmUoInhsLWxpbmtpZmllZCIpOwoJCQkJZml4X2lubGluZV9saW5raWZpZWRfbGluayhub2Rlc1tpXSk7CgkJCX0KCQl9OwoJCXZhciByZWxpbmtpZnlfcG9zdHMgPSBmdW5jdGlvbiAocG9zdHMpIHsKCQkJdmFyIGNscyA9ICJ4bC1wb3N0LWxpbmtpZmllZCIsCgkJCQlwb3N0LCBpLCBpaTsKCgkJCWZvciAoaSA9IDAsIGlpID0gcG9zdHMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJcG9zdCA9IHBvc3RzW2ldOwoJCQkJaWYgKHBvc3QuY2xhc3NMaXN0LmNvbnRhaW5zKGNscykpIHsKCQkJCQlwb3N0LmNsYXNzTGlzdC5yZW1vdmUoY2xzKTsKCQkJCQl1bmxpbmtpZnlfcG9zdChwb3N0KTsKCQkJCX0KCQkJfQoKCQkJcXVldWVfcG9zdHMocG9zdHMsIHF1ZXVlX3Bvc3RzLkZsYWdzLkZsdXNoIHwgcXVldWVfcG9zdHMuRmxhZ3MuRmx1c2hOb1BhcnNlIHwgcXVldWVfcG9zdHMuRmxhZ3MuVXNlRGVsYXkpOwoJCX07CgkJdmFyIGZpeF9icm9rZW5fNGNoYW54X2xpbmtpZmljYXRpb24gPSBmdW5jdGlvbiAobm9kZSwgZXZlbnRfbGlua3MpIHsKCQkJLy8gU29tZWhvdyBvbmUgb2YgdGhlIGxpbmtzIGdldHMgY2xvbmVkLCBhbmQgdGhlbiB0aGV5IGFsbCBnZXQgd3JhcHBlZCBpbnNpZGUgYW5vdGhlciBsaW5rCgkJCXZhciBmaXggPSBbXSwKCQkJCW4gPSBub2RlLm5leHRTaWJsaW5nLAoJCQkJbGluaywgZXZlbnRzLCBpLCBpaTsKCgkJCWlmIChuICE9PSBudWxsICYmIG4udGFnTmFtZSA9PT0gIkEiICYmIG4uY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1saW5rIikpIHsKCQkJCSQucmVtb3ZlKG4pOwoJCQl9CgoJCQluID0gbm9kZS5wcmV2aW91c1NpYmxpbmc7CgkJCWlmIChuICE9PSBudWxsICYmIG4udGFnTmFtZSA9PT0gIkEiICYmIG4uY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1zaXRlLXRhZyIpKSB7CgkJCQkkLnJlbW92ZShuKTsKCQkJfQoKCQkJZm9yIChpID0gMCwgaWkgPSBldmVudF9saW5rcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlsaW5rID0gZXZlbnRfbGlua3NbaV07CgkJCQlldmVudHMgPSBnZXRfbGlua19ldmVudHMobGluayk7CgkJCQljaGFuZ2VfbGlua19ldmVudHMobGluaywgbnVsbCk7CgoJCQkJaWYgKGxpbmsuY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1zaXRlLXRhZyIpKSB7CgkJCQkJJC5yZW1vdmUobGluayk7CgkJCQl9CgkJCQllbHNlIGlmIChsaW5rLmNsYXNzTGlzdC5jb250YWlucygieGwtbGluayIpKSB7CgkJCQkJZml4LnB1c2gobGluaywgZXZlbnRzKTsKCQkJCX0KCQkJfQoKCQkJJC51bndyYXAobm9kZSk7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IGZpeC5sZW5ndGg7IGkgPCBpaTsgaSArPSAyKSB7CgkJCQlsaW5rID0gZml4W2ldOwoJCQkJbGluay5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1saW5raWZpZWQiKTsKCQkJCXByZXByb2Nlc3NfbGluayhsaW5rLCBsaW5rLmhyZWYgfHwgIiIsIGZhbHNlLCBjb25maWcuZ2VuZXJhbC5hdXRvbWF0aWNfcHJvY2Vzc2luZyk7CgkJCX0KCQl9OwoKCQkvLyBFdmVudHMKCQl2YXIgZmlyc3RfbGlua19wcmVwcm9jZXNzZWQgPSBmYWxzZTsKCQl2YXIgZXZlbnRfbGlzdGVuZXJzID0gewoJCQliZWZvcmVfZmlyc3RfbGlua19wcmVwcm9jZXNzOiBbXQoJCX07CgkJdmFyIG9uID0gZnVuY3Rpb24gKGV2ZW50X25hbWUsIGNhbGxiYWNrKSB7CgkJCXZhciBsaXN0ZW5lcnMgPSBldmVudF9saXN0ZW5lcnNbZXZlbnRfbmFtZV07CgkJCWlmIChsaXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlOwoJCQlsaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7CgkJCXJldHVybiB0cnVlOwoJCX07CgkJdmFyIG9mZiA9IGZ1bmN0aW9uIChldmVudF9uYW1lLCBjYWxsYmFjaykgewoJCQl2YXIgbGlzdGVuZXJzID0gZXZlbnRfbGlzdGVuZXJzW2V2ZW50X25hbWVdLAoJCQkJaSwgaWk7CgkJCWlmIChsaXN0ZW5lcnMgIT09IHVuZGVmaW5lZCkgewoJCQkJZm9yIChpID0gMCwgaWkgPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCWlmIChsaXN0ZW5lcnNbaV0gPT09IGNhbGxiYWNrKSB7CgkJCQkJCWxpc3RlbmVycy5zcGxpY2UoaSwgMSk7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gZmFsc2U7CgkJfTsKCQl2YXIgdHJpZ2dlciA9IGZ1bmN0aW9uIChsaXN0ZW5lcnMsIGRhdGEpIHsKCQkJdmFyIGksIGlpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlsaXN0ZW5lcnNbaV0uY2FsbChudWxsLCBkYXRhKTsKCQkJfQoJCX07CgoKCQkvLyBFeHBvcnRzCgkJcmV0dXJuIHsKCQkJcGFyc2VfdGV4dF9mb3JfdXJsczogcGFyc2VfdGV4dF9mb3JfdXJscywKCQkJY3JlYXRlX2xpbms6IGNyZWF0ZV9saW5rLAoJCQlxdWV1ZV9wb3N0czogcXVldWVfcG9zdHMsCgkJCWdldF9saW5rX2V2ZW50czogZ2V0X2xpbmtfZXZlbnRzLAoJCQljaGFuZ2VfbGlua19ldmVudHM6IGNoYW5nZV9saW5rX2V2ZW50cywKCQkJcmVnaXN0ZXJfbGlua19ldmVudHM6IHJlZ2lzdGVyX2xpbmtfZXZlbnRzLAoJCQlyZWxpbmtpZnlfcG9zdHM6IHJlbGlua2lmeV9wb3N0cywKCQkJZml4X2Jyb2tlbl80Y2hhbnhfbGlua2lmaWNhdGlvbjogZml4X2Jyb2tlbl80Y2hhbnhfbGlua2lmaWNhdGlvbiwKCQkJbGlua2lmeV9yZWdpc3RlcjogbGlua2lmeV9yZWdpc3RlciwKCQkJb246IG9uLAoJCQlvZmY6IG9mZgoJCX07CgoJfSkoKTsKCXZhciBTZXR0aW5ncyA9IChmdW5jdGlvbiAoKSB7CgoJCS8vIFByaXZhdGUKCQl2YXIgY29uZmlnX3RlbXAgPSBudWxsLAoJCQljb25maWdfY3VzdG9tX3RlbXAgPSBudWxsLAoJCQljb25maWdfZXh0c190ZW1wID0gbnVsbCwKCQkJZXhwb3J0X3VybCA9IG51bGwsCgkJCXBvcHVwID0gbnVsbDsKCgkJdmFyIGh0bWxfZmlsdGVyX2d1aWRlID0gZnVuY3Rpb24gKCkgewoJCQlyZXR1cm4gIu+7vzxkaXYgY2xhc3M9XCJ4bC1zZXR0aW5ncy1ncm91cCB4bC1zZXR0aW5ncy1maWx0ZXItZ3VpZGUgeGwtdGhlbWVcIj5MaW5lcyBzdGFydGluZyB3aXRoIDxjb2RlPi88L2NvZGU+IHdpbGwgYmUgdHJlYXRlZCBhcyA8YSBocmVmPVwiaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9HdWlkZS9SZWd1bGFyX0V4cHJlc3Npb25zXCIgdGFyZ2V0PVwiX2JsYW5rXCIgcmVsPVwibm9yZWZlcnJlciBub2ZvbGxvd1wiPnJlZ3VsYXIgZXhwcmVzc2lvbnM8L2E+LiA8c3BhbiBzdHlsZT1cIm9wYWNpdHk6IDAuNzU7XCI+KFRoaXMgaXMgdmVyeSBzaW1pbGFyIHRvIDRjaGFuLXggc3R5bGUgZmlsdGVyaW5nKTwvc3Bhbj48YnI+TGluZXMgc3RhcnRpbmcgd2l0aCA8Y29kZT4jPC9jb2RlPiBhcmUgY29tbWVudHMgYW5kIHdpbGwgYmUgaWdub3JlZC48YnI+TGluZXMgc3RhcnRpbmcgd2l0aCBuZWl0aGVyIDxjb2RlPiM8L2NvZGU+IG5vciA8Y29kZT4vPC9jb2RlPiB3aWxsIGJlIHRyZWF0ZWQgYXMgYSBjYXNlLWluc2Vuc2l0aXZlIHN0cmluZyB0byBtYXRjaCBhbnl3aGVyZS48YnI+Rm9yIGV4YW1wbGUsIDxjb2RlPi90b3Vob3UvaTwvY29kZT4gd2lsbCBoaWdobGlnaHQgZW50cmllcyBjb250YWluaW5nIHRoZSBzdHJpbmcgYDxjb2RlPnRvdWhvdTwvY29kZT5gLCBjYXNlLWluc2Vuc2l0aXZlLjxicj48YnI+VGhlIGxvd2VyIGEgZmlsdGVyIGFwcGVhcnMgaW4gdGhpcyBsaXN0LCB0aGUgZ3JlYXRlciBpdHMgcHJpb3JpdHkgd2lsbCBiZS48YnI+PGJyPllvdSBjYW4gdXNlIHRoZXNlIGFkZGl0aW9uYWwgc2V0dGluZ3Mgd2l0aCBlYWNoIHJlZ3VsYXIgZXhwcmVzc2lvbiwgc2VwYXJhdGluZyB0aGVtIHdpdGggc2VtaWNvbG9uczo8YnI+PHVsPjxsaT48c3Ryb25nPkFwcGx5IHRoZSBmaWx0ZXIgdG8gZGlmZmVyZW50IHNjb3Blczo8L3N0cm9uZz48YnI+PGNvZGU+dGFnczs8L2NvZGU+LCA8Y29kZT50aXRsZTs8L2NvZGU+IG9yIDxjb2RlPnVwbG9hZGVyOzwvY29kZT4uIEJ5IGRlZmF1bHQgdGhlIHNjb3BlIGlzIDxjb2RlPnRpdGxlO3RhZ3M7PC9jb2RlPjxicj48L2xpPjxsaT48c3Ryb25nPkZvcmNlIGEgZ2FsbGVyeSB0byBub3QgYmUgaGlnaGxpZ2h0ZWQ6PC9zdHJvbmc+IDxzcGFuIHN0eWxlPVwib3BhY2l0eTogMC43NTtcIj5JZiBvbWl0dGVkLCB0aGUgZ2FsbGVyeSB3aWxsIGJlIGhpZ2hsaWdodGVkIGFzIG5vcm1hbDwvc3Bhbj48YnI+PGNvZGU+YmFkOm5vOzwvY29kZT4sIDxjb2RlPmJhZDp5ZXM7PC9jb2RlPiwgb3IganVzdCA8Y29kZT5iYWQ7PC9jb2RlPjwvbGk+PGxpPjxzdHJvbmc+T25seSBhcHBseSB0aGUgZmlsdGVyIHRvIGNlcnRhaW4gY2F0ZWdvcmllczo8L3N0cm9uZz48YnI+PGNvZGU+b25seTpkb3VqaW5zaGksbWFuZ2E7PC9jb2RlPi48ZGl2IHN0eWxlPVwiZm9udC1zaXplOiAwLjllbTsgbWFyZ2luLXRvcDogMC4xZW07IG9wYWNpdHk6IDAuNzU7XCI+Q2F0ZWdvcmllczogPHNwYW4+YXJ0aXN0Y2csIGFzaWFucG9ybiwgY29zcGxheSwgZG91amluc2hpLCBnYW1lY2csIGltYWdlc2V0LCBtYW5nYSwgbWlzYywgPHNwYW4gc3R5bGU9XCJ3aGl0ZS1zcGFjZTogbm93cmFwO1wiPm5vbi1oPC9zcGFuPiwgcHJpdmF0ZSwgd2VzdGVybjwvc3Bhbj48L2Rpdj48L2xpPjxsaT48c3Ryb25nPk9ubHkgYXBwbHkgdGhlIGZpbHRlciBpZiBpdCA8ZW0+aXMgbm90PC9lbT4gYSBjZXJ0YWluIGNhdGVnb3J5Ojwvc3Ryb25nPjxicj48Y29kZT5ub3Q6d2VzdGVybixub24taDs8L2NvZGU+LjwvbGk+PGxpPjxzdHJvbmc+T25seSBhcHBseSB0aGUgZmlsdGVyIHRvIGNlcnRhaW4gc2l0ZXM6PC9zdHJvbmc+PGJyPjxjb2RlPnNpdGU6ZWhlbnRhaTs8L2NvZGU+LjxkaXYgc3R5bGU9XCJmb250LXNpemU6IDAuOWVtOyBtYXJnaW4tdG9wOiAwLjFlbTsgb3BhY2l0eTogMC43NTtcIj5TaXRlczogPHNwYW4+ZWhlbnRhaSwgbmhlbnRhaSwgaGl0b21pPC9zcGFuPjwvZGl2PjwvbGk+PGxpPjxzdHJvbmc+QXBwbHkgYSBjb2xvcmVkIGRlY29yYXRpb24gdG8gdGhlIG1hdGNoZWQgdGV4dDo8L3N0cm9uZz48YnI+PGNvZGU+Y29sb3I6cmVkOzwvY29kZT4sIDxjb2RlPnVuZGVybGluZTojMDA4MGYwOzwvY29kZT4sIG9yIDxjb2RlPmJhY2tncm91bmQ6cmdiYSgwLDI1NSwwLDAuNSk7PC9jb2RlPjwvbGk+PGxpPjxzdHJvbmc+QXBwbHkgYSBjb2xvcmVkIGRlY29yYXRpb24gdG8gdGhlIFtFeF0gb3IgW0VIXSB0YWc6PC9zdHJvbmc+PGJyPjxjb2RlPmxpbmstY29sb3I6Ymx1ZTs8L2NvZGU+LCA8Y29kZT5saW5rLXVuZGVybGluZTojYmY0OGI1OzwvY29kZT4sIG9yIDxjb2RlPmxpbmstYmFja2dyb3VuZDpyZ2JhKDIyMCwyMDAsMjAsMC41KTs8L2NvZGU+PC9saT48bGk+PHN0cm9uZz5BcHBseSBhIGNvbG9yZWQgZGVjb3JhdGlvbiB0byA8ZW0+Qk9USDwvZW0+IHRoZSBtYXRjaGVkIHRleHQgYW5kIHRhZzo8L3N0cm9uZz48YnI+PGNvZGU+Y29sb3JzOmJsdWU7PC9jb2RlPiwgPGNvZGU+dW5kZXJsaW5lczojYmY0OGI1OzwvY29kZT4sIG9yIDxjb2RlPmJhY2tncm91bmRzOnJnYmEoMjIwLDIwMCwyMCwwLjUpOzwvY29kZT48L2xpPjxsaT48c3Ryb25nPkRpc2FibGUgYW55IGNvbG9yaW5nLCBpbmNsdWRpbmcgdGhlIGRlZmF1bHQ6PC9zdHJvbmc+PGJyPjxjb2RlPm5vLWNvbG9yczs8L2NvZGU+IG9yIDxjb2RlPm5vY29sb3I7PC9jb2RlPjwvbGk+PC91bD5BZGRpdGlvbmFsbHksIHNvbWUgc2V0dGluZ3MgaGF2ZSBhbGlhc2VzLiBJZiBtdWx0aXBsZSBhcmUgdXNlZCwgb25seSB0aGUgbWFpbiBvbmUgd2lsbCBiZSB1c2VkLjxicj48dWw+PGxpPjxjb2RlPnRhZ3M6IHRhZzwvY29kZT48L2xpPjxsaT48Y29kZT5vbmx5OiBjYXRlZ29yeSwgY2F0PC9jb2RlPjwvbGk+PGxpIGNsYXNzPVwieGwtc2V0dGluZ3MtbGktbm8tc3BhY2VcIj48Y29kZT5ub3Q6IG5vPC9jb2RlPjwvbGk+PGxpIGNsYXNzPVwieGwtc2V0dGluZ3MtbGktbm8tc3BhY2VcIj48Y29kZT5zaXRlOiBzaXRlczwvY29kZT48L2xpPjxsaT48Y29kZT5jb2xvcnM6IGNzPC9jb2RlPjwvbGk+PGxpIGNsYXNzPVwieGwtc2V0dGluZ3MtbGktbm8tc3BhY2VcIj48Y29kZT51bmRlcmxpbmVzOiB1czwvY29kZT48L2xpPjxsaSBjbGFzcz1cInhsLXNldHRpbmdzLWxpLW5vLXNwYWNlXCI+PGNvZGU+YmFja2dyb3VuZHM6IGJnczwvY29kZT48L2xpPjxsaT48Y29kZT5jb2xvcjogYzwvY29kZT48L2xpPjxsaSBjbGFzcz1cInhsLXNldHRpbmdzLWxpLW5vLXNwYWNlXCI+PGNvZGU+dW5kZXJsaW5lOiB1PC9jb2RlPjwvbGk+PGxpIGNsYXNzPVwieGwtc2V0dGluZ3MtbGktbm8tc3BhY2VcIj48Y29kZT5iYWNrZ3JvdW5kOiBiZzwvY29kZT48L2xpPjxsaT48Y29kZT5saW5rLWNvbG9yOiBsaW5rLWMsIGxjPC9jb2RlPjwvbGk+PGxpIGNsYXNzPVwieGwtc2V0dGluZ3MtbGktbm8tc3BhY2VcIj48Y29kZT5saW5rLXVuZGVybGluZTogbGluay11LCBsdTwvY29kZT48L2xpPjxsaSBjbGFzcz1cInhsLXNldHRpbmdzLWxpLW5vLXNwYWNlXCI+PGNvZGU+bGluay1iYWNrZ3JvdW5kOiBsaW5rLWJnLCBsYmc8L2NvZGU+PC9saT48bGk+PGNvZGU+bm8tY29sb3JzOiBuby1jb2xvciwgbm9jb2xvcnMsIG5vY29sb3I8L2NvZGU+PC9saT48L3VsPkZvciBlYXN5IDxhIGhyZWY9XCJodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvY29sb3JfdmFsdWUjQ29sb3Jfa2V5d29yZHNcIiB0YXJnZXQ9XCJfYmxhbmtcIiByZWw9XCJub3JlZmVycmVyIG5vZm9sbG93XCI+SFRNTCBjb2xvcjwvYT4gc2VsZWN0aW9uLCB5b3UgY2FuIHVzZSB0aGUgZm9sbG93aW5nIGhlbHBlciB0byBzZWxlY3QgYSBjb2xvcjo8YnI+PGJyPjxkaXY+PGlucHV0IHR5cGU9XCJjb2xvclwiIHZhbHVlPVwiIzgwODA4MFwiIGNsYXNzPVwieGwtc2V0dGluZ3MtY29sb3ItaW5wdXRcIj48aW5wdXQgdHlwZT1cInRleHRcIiB2YWx1ZT1cIiM4MDgwODBcIiBjbGFzcz1cInhsLXNldHRpbmdzLWNvbG9yLWlucHV0XCIgcmVhZG9ubHk9XCJyZWFkb25seVwiPjxpbnB1dCB0eXBlPVwidGV4dFwiIHZhbHVlPVwicmdiYSgxMjgsMTI4LDEyOCwxKVwiIGNsYXNzPVwieGwtc2V0dGluZ3MtY29sb3ItaW5wdXRcIiByZWFkb25seT1cInJlYWRvbmx5XCI+PC9kaXY+PC9kaXY+IjsKCQl9OwoJCXZhciBjcmVhdGVfZXhwb3J0X2RhdGEgPSBmdW5jdGlvbiAoKSB7CgkJCXJldHVybiB7CgkJCQljb25maWc6IENvbmZpZy5nZXRfc2F2ZWRfc2V0dGluZ3MoKSwKCQkJCWVhc3lfbGlzdDogRWFzeUxpc3QuZ2V0X3NhdmVkX3NldHRpbmdzKCkKCQkJfTsKCQl9OwoJCXZhciBpbXBvcnRfc2V0dGluZ3MgPSBmdW5jdGlvbiAoZGF0YSkgewoJCQlpZiAoZGF0YSAhPT0gbnVsbCAmJiB0eXBlb2YoZGF0YSkgPT09ICJvYmplY3QiKSB7CgkJCQl2YXIgdiA9IGRhdGEuY29uZmlnOwoJCQkJaWYgKHR5cGVvZih2KSAhPT0gIm9iamVjdCIpIHYgPSBudWxsOwoJCQkJQ29uZmlnLnNldF9zYXZlZF9zZXR0aW5ncyh2KTsKCgkJCQl2ID0gZGF0YS5lYXN5X2xpc3Q7CgkJCQlpZiAodHlwZW9mKHYpICE9PSAib2JqZWN0IikgdiA9IG51bGw7CgkJCQlFYXN5TGlzdC5zZXRfc2F2ZWRfc2V0dGluZ3Modik7CgkJCX0KCQl9OwoKCQl2YXIgZ2VuZXJhdGVfc2VjdGlvbl9oZWFkZXIgPSBmdW5jdGlvbiAodGl0bGUsIG1lc3NhZ2UpIHsKCQkJdmFyIHRoZW1lID0gVGhlbWUuY2xhc3NlcywKCQkJCW4xLCBuMiwgbjM7CgoJCQluMSA9ICQubm9kZSgiZGl2IiwgInhsLXNldHRpbmdzLWhlYWRpbmciICsgdGhlbWUpOwoJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImRpdiIsICJ4bC1zZXR0aW5ncy1oZWFkaW5nLWlubmVyIiArIHRoZW1lKSk7CgkJCSQuYWRkKG4yLCAkLm5vZGUoImRpdiIsICJ4bC1zZXR0aW5ncy1oZWFkaW5nLWNlbGwgeGwtc2V0dGluZ3MtaGVhZGluZy10aXRsZSIgKyB0aGVtZSwgdGl0bGUpKTsKCQkJaWYgKG1lc3NhZ2UgIT09IHVuZGVmaW5lZCkgewoJCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtc2V0dGluZ3MtaGVhZGluZy1jZWxsIHhsLXNldHRpbmdzLWhlYWRpbmctc3VidGl0bGUiICsgdGhlbWUpKTsKCQkJCSQuYWRkKG4zLCBtZXNzYWdlKTsKCQkJfQoKCQkJcmV0dXJuIG4xOwoJCX07CgkJdmFyIGdlbmVyYXRlX3NlY3Rpb24gPSBmdW5jdGlvbiAoKSB7CgkJCXJldHVybiAkLm5vZGUoImRpdiIsICJ4bC1zZXR0aW5ncy1ncm91cCAiICsgVGhlbWUuY2xhc3Nlcyk7CgkJfTsKCQl2YXIgZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb25zID0gZnVuY3Rpb24gKHNlY3Rpb24sIG5hbWVzcGFjZSwgY29uZmlnX2Rlc2NyaXB0b3IsIGNvbmZpZ19zY29wZSkgewoJCQl2YXIgdHlwZSwgaW5mbywgZCwgaSwgaWk7CgkJCWZvciAoaSA9IDAsIGlpID0gY29uZmlnX2Rlc2NyaXB0b3IubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJZCA9IGNvbmZpZ19kZXNjcmlwdG9yW2ldOyAvLyBbIG5hbWUsIGRlZmF1bHQsIGxhYmVsLCBkZXNjcmlwdGlvbiwgb2xkX25hbWUsIGluZm8/IF0KCQkJCWluZm8gPSAoZC5sZW5ndGggPiA1ID8gZFs1XSA6IG51bGwpOwoJCQkJaWYgKGluZm8gPT09IG51bGwgfHwgKHR5cGUgPSBpbmZvLnR5cGUpID09PSB1bmRlZmluZWQpIHR5cGUgPSAiY2hlY2tib3giOwoJCQkJZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb24oCgkJCQkJc2VjdGlvbiwKCQkJCQljb25maWdfc2NvcGUsCgkJCQkJInhsLXNldHRpbmdzLSIgKyBuYW1lc3BhY2UgKyAiLSIgKyBpLCAvLyBpZAoJCQkJCWRbMF0sIC8vIG5hbWUKCQkJCQlkWzJdLCAvLyBsYWJlbAoJCQkJCWRbM10sIC8vIGRlc2NyaXB0aW9uCgkJCQkJdHlwZSwgLy8gdHlwZQoJCQkJCWNvbmZpZ19zY29wZSAhPT0gbnVsbCA/IGNvbmZpZ19zY29wZVtkWzBdXSA6IG51bGwsIC8vIHZhbHVlCgkJCQkJaW5mbyAvLyBpbmZvCgkJCQkpOwoJCQl9CgkJfTsKCQl2YXIgZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb25zX2N1c3RvbSA9IGZ1bmN0aW9uIChzZWN0aW9uLCBuYW1lc3BhY2UsIGN1c3RvbV9kZXNjcmlwdG9yLCBjdXN0b21fY29uZmlnKSB7CgkJCXZhciBjb25maWdfZGVzY3JpcHRvciA9IGN1c3RvbV9kZXNjcmlwdG9yW25hbWVzcGFjZV07CgkJCWlmIChjb25maWdfZGVzY3JpcHRvciA9PT0gdW5kZWZpbmVkKSByZXR1cm47CgoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnMoc2VjdGlvbiwgbmFtZXNwYWNlICsgIi1jdXN0b20iLCBjb25maWdfZGVzY3JpcHRvciwgY3VzdG9tX2NvbmZpZ1tuYW1lc3BhY2VdKTsKCQl9OwoJCXZhciBnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbiA9IGZ1bmN0aW9uIChzZWN0aW9uLCBjb25maWdfc2NvcGUsIGlkLCBuYW1lLCBsYWJlbF90ZXh0LCBkZXNjcmlwdGlvbiwgdHlwZSwgdmFsdWUsIGluZm8pIHsKCQkJdmFyIGV2ZW50ID0gImNoYW5nZSIsCgkJCQl0aGVtZSA9IFRoZW1lLmNsYXNzZXMsCgkJCQl2YWx1ZXMsIGVudHJ5LCB0YWJsZSwgcm93LCBjZWxsLCBsYWJlbCwgaW5wdXQsIGZuLCBuLCBpLCBpaSwgdjsKCgkJCS8vIENyZWF0ZSBsYWJlbC9kZXNjcmlwdGlvbgoJCQkkLmFkZChzZWN0aW9uLCBlbnRyeSA9ICQubm9kZSgiZGl2IiwgInhsLXNldHRpbmdzLWVudHJ5IiArIHRoZW1lKSk7CgkJCSQuYWRkKGVudHJ5LCB0YWJsZSA9ICQubm9kZSgiZGl2IiwgInhsLXNldHRpbmdzLWVudHJ5LXRhYmxlIikpOwoJCQkkLmFkZCh0YWJsZSwgcm93ID0gJC5ub2RlKCJkaXYiLCAieGwtc2V0dGluZ3MtZW50cnktcm93IikpOwoKCQkJJC5hZGQocm93LCBjZWxsID0gJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWVudHJ5LWNlbGwiKSk7CgkJCSQuYWRkKGNlbGwsIGxhYmVsID0gJC5ub2RlKCJsYWJlbCIsICJ4bC1zZXR0aW5ncy1lbnRyeS1sYWJlbCIpKTsKCQkJbGFiZWwuaHRtbEZvciA9IGlkOwoJCQkkLmFkZChsYWJlbCwgJC5ub2RlKCJzdHJvbmciLCAieGwtc2V0dGluZ3MtZW50cnktbGFiZWwtbmFtZSIsIGxhYmVsX3RleHQgKyAiOiIpKTsKCQkJaWYgKGRlc2NyaXB0aW9uKSB7CgkJCQkkLmFkZChsYWJlbCwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWVudHJ5LWxhYmVsLWRlc2NyaXB0aW9uIiwgIiAiICsgZGVzY3JpcHRpb24pKTsKCQkJfQoKCQkJLy8gVmFsdWUgZWRpdAoJCQlpZiAoaW5mbyAhPT0gbnVsbCAmJiAoZm4gPSBpbmZvLmdldCkgIT09IHVuZGVmaW5lZCkgewoJCQkJdmFsdWUgPSBmbi5jYWxsKG51bGwsIHZhbHVlKTsKCQkJfQoKCQkJaWYgKHR5cGUgPT09ICJjaGVja2JveCIpIHsKCQkJCSQuYWRkKHJvdywgY2VsbCA9ICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1lbnRyeS1jZWxsIikpOwoJCQkJJC5hZGQoY2VsbCwgaW5wdXQgPSAkLm5vZGUoImlucHV0IiwgInhsLXNldHRpbmdzLWVudHJ5LWlucHV0IiArIHRoZW1lKSk7CgkJCQlpbnB1dC50eXBlID0gImNoZWNrYm94IjsKCQkJCWlucHV0LmlkID0gaWQ7CgkJCQlpbnB1dC5jaGVja2VkID0gdmFsdWU7CgkJCX0KCQkJZWxzZSBpZiAodHlwZSA9PT0gInNlbGVjdCIpIHsKCQkJCSQuYWRkKHJvdywgY2VsbCA9ICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1lbnRyeS1jZWxsIikpOwoJCQkJJC5hZGQoY2VsbCwgaW5wdXQgPSAkLm5vZGUoInNlbGVjdCIsICJ4bC1zZXR0aW5ncy1lbnRyeS1pbnB1dCIgKyB0aGVtZSkpOwoKCQkJCXZhbHVlcyA9IChpbmZvICE9PSBudWxsID8gaW5mby5vcHRpb25zIDogW10pOwoJCQkJZm9yIChpID0gMCwgaWkgPSB2YWx1ZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCXYgPSB2YWx1ZXNbaV07CgkJCQkJJC5hZGQoaW5wdXQsIG4gPSAkLm5vZGUoIm9wdGlvbiIsICJ4bC1zZXR0aW5ncy1lbnRyeS1pbnB1dC1vcHRpb24iLCB2WzFdKSk7CgkJCQkJbi52YWx1ZSA9IHZbMF07CgkJCQkJbi5zZWxlY3RlZCA9ICh2WzBdID09PSB2YWx1ZSk7CgkJCQkJaWYgKHYubGVuZ3RoID4gMikgbi50aXRsZSA9IHZbMl07CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAodHlwZSA9PT0gInRleHRib3giKSB7CgkJCQkkLmFkZChyb3csIGNlbGwgPSAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtZW50cnktY2VsbCIpKTsKCQkJCSQuYWRkKGNlbGwsIGlucHV0ID0gJC5ub2RlKCJpbnB1dCIsICJ4bC1zZXR0aW5ncy1lbnRyeS1pbnB1dCIgKyB0aGVtZSkpOwoJCQkJaW5wdXQudHlwZSA9ICJ0ZXh0IjsKCQkJCWlucHV0LmlkID0gaWQ7CgkJCQlpbnB1dC52YWx1ZSA9IHZhbHVlOwoJCQl9CgkJCWVsc2UgaWYgKHR5cGUgPT09ICJ0ZXh0YXJlYSIpIHsKCQkJCSQuYWRkKHRhYmxlLCByb3cgPSAkLm5vZGUoImRpdiIsICJ4bC1zZXR0aW5ncy1lbnRyeS1yb3ciKSk7CgkJCQkkLmFkZChyb3csIGNlbGwgPSAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtZW50cnktY2VsbCIpKTsKCQkJCSQuYWRkKGNlbGwsIGlucHV0ID0gJC5ub2RlKCJ0ZXh0YXJlYSIsICJ4bC1zZXR0aW5ncy1lbnRyeS1pbnB1dCIgKyB0aGVtZSkpOwoJCQkJaW5wdXQud3JhcCA9ICJvZmYiOwoJCQkJaW5wdXQuc3BlbGxjaGVjayA9IGZhbHNlOwoJCQkJaW5wdXQuaWQgPSBpZDsKCQkJCWlucHV0LnZhbHVlID0gdmFsdWU7CgkJCX0KCQkJZWxzZSBpZiAodHlwZSA9PT0gImJ1dHRvbiIpIHsKCQkJCSQuYWRkKHJvdywgY2VsbCA9ICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1lbnRyeS1jZWxsIikpOwoJCQkJJC5hZGQoY2VsbCwgaW5wdXQgPSAkLm5vZGUoImJ1dHRvbiIsICJ4bC1zZXR0aW5ncy1lbnRyeS1pbnB1dCIgKyB0aGVtZSwgKGluZm8gIT09IG51bGwgPyBpbmZvLnRleHQgfHwgIiIgOiAiIikpKTsKCQkJCWV2ZW50ID0gImNsaWNrIjsKCQkJfQoJCQllbHNlIHsKCQkJCS8vIFNraXAgZXZlbnQKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gRXZlbnQKCQkJaWYgKGNvbmZpZ19zY29wZSA9PT0gbnVsbCkgbmFtZSA9IG51bGw7CgkJCSQub24oaW5wdXQsIGV2ZW50LCAkLmJpbmQob25fY2hhbmdlLCBpbnB1dCwgdHlwZSwgY29uZmlnX3Njb3BlLCBuYW1lLCBpbmZvKSk7CgkJfTsKCgkJdmFyIGdlbmVyYXRlX2V4dGVuc2lvbnMgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCXZhciBleHRzID0gRXh0ZW5zaW9uQVBJLmdldF9yZWdpc3RlcmVkX2V4dGVuc2lvbnMoKSwKCQkJCWRlc2NyaXB0b3IsIGRhdGEsIHNlY3Rpb24sIGxhYmVsLCBlLCBpLCBpaSwgdjsKCgkJCWlmIChleHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7CgoJCQkkLmFkZChjb250YWluZXIsIGdlbmVyYXRlX3NlY3Rpb25faGVhZGVyKCJFeHRlbnNpb25zIikpOwoJCQlzZWN0aW9uID0gZ2VuZXJhdGVfc2VjdGlvbigpOwoKCQkJZGVzY3JpcHRvciA9IFtdOwoJCQlkYXRhID0gW107CgkJCWZvciAoaSA9IDAsIGlpID0gZXh0cy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQllID0gZXh0c1tpXTsKCQkJCXYgPSBlWzBdOwoJCQkJZGF0YS5wdXNoKHYpOwoJCQkJbGFiZWwgPSBlWzFdOwoJCQkJaWYgKGVbNF0gIT09IG51bGwgJiYgZVs0XS5sZW5ndGggPiAwKSBsYWJlbCArPSAiICh2IiArIGVbNF0uam9pbigiLiIpICsgIikiOwoJCQkJaWYgKGVbMl0ubGVuZ3RoID4gMCkgbGFiZWwgKz0gIiBieSAiICsgZVsyXTsKCQkJCWRlc2NyaXB0b3IucHVzaChbCgkJCQkJaSwKCQkJCQl2LAoJCQkJCWxhYmVsLAoJCQkJCWVbM10sCgkJCQkJbnVsbAoJCQkJXSk7CgkJCX0KCgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9ucyhzZWN0aW9uLCAiZXh0ZW5zaW9ucyIsIGRlc2NyaXB0b3IsIGRhdGEpOwoJCQkkLmFkZChjb250YWluZXIsIHNlY3Rpb24pOwoKCQkJcmV0dXJuIGRhdGE7CgkJfTsKCgkJdmFyIHRpdGxpZnlfY3VzdG9tX25hbWVzcGFjZSA9IGZ1bmN0aW9uIChuYW1lc3BhY2UpIHsKCQkJcmV0dXJuIG5hbWVzcGFjZS5yZXBsYWNlKC9bX1xXXSsvZywgIiAiKS5yZXBsYWNlKC9cYlx3L2csIGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLnRvVXBwZXJDYXNlKCk7IH0pOwoJCX07CgoJCXZhciBvbl9jaGFuZ2UgPSBmdW5jdGlvbiAodHlwZSwgY29uZmlnX3Njb3BlLCBuYW1lLCBpbmZvLCBldmVudCkgewoJCQl2YXIgZm4sIHY7CgoJCQlpZiAobmFtZSAhPT0gbnVsbCkgewoJCQkJaWYgKHR5cGUgPT09ICJjaGVja2JveCIpIHsKCQkJCQl2ID0gdGhpcy5jaGVja2VkOwoJCQkJfQoJCQkJZWxzZSBpZiAodHlwZSA9PT0gInNlbGVjdCIgfHwgdHlwZSA9PT0gInRleHRib3giIHx8IHR5cGUgPT09ICJ0ZXh0YXJlYSIpIHsKCQkJCQl2ID0gdGhpcy52YWx1ZTsKCQkJCX0KCgkJCQlmbiA9IChpbmZvID09PSBudWxsID8gdW5kZWZpbmVkIDogaW5mby5zZXQpOwoJCQkJaWYgKGZuICE9PSB1bmRlZmluZWQpIHsKCQkJCQl2ID0gZm4uY2FsbChudWxsLCB2KTsKCQkJCQlmbiA9IGluZm8uZ2V0OwoJCQkJCWlmICh0eXBlID09PSAidGV4dGJveCIgfHwgdHlwZSA9PT0gInRleHRhcmVhIikgewoJCQkJCQl0aGlzLnZhbHVlID0gKGZuID09PSB1bmRlZmluZWQgPyB2IDogZm4uY2FsbChudWxsLCB2KSk7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKHR5cGUgPT09ICJjaGVja2JveCIpIHsKCQkJCQkJdGhpcy52YWx1ZSA9ICEhKGZuID09PSB1bmRlZmluZWQgPyB2IDogZm4uY2FsbChudWxsLCB2KSk7CgkJCQkJfQoJCQkJfQoKCQkJCWNvbmZpZ19zY29wZVtuYW1lXSA9IHY7CgkJCX0KCgkJCWlmIChpbmZvICE9PSBudWxsICYmIChmbiA9IGluZm8ub25fY2hhbmdlKSAhPT0gdW5kZWZpbmVkKSB7CgkJCQlmbi5jYWxsKHRoaXMsIGV2ZW50KTsKCQkJfQoJCX07CgkJdmFyIG9uX2NhY2hlX2NsZWFyX2NsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCWlmICgkLmlzX2xlZnRfbW91c2UoZXZlbnQpKSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCXZhciBjbGVhcnMgPSBBUEkuY2FjaGVfY2xlYXIoKTsKCQkJCURlYnVnLmxvZygiQ2xlYXJlZCBjYWNoZTsgZW50cmllc19yZW1vdmVkPSIgKyBjbGVhcnMpOwoJCQkJdGhpcy50ZXh0Q29udGVudCA9ICJDbGVhcmVkISI7CgkJCX0KCQl9OwoJCXZhciBvbl9jaGFuZ2Vsb2dfY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQljbG9zZShldmVudCk7CgkJCQlDaGFuZ2Vsb2cub3BlbihudWxsKTsKCQkJfQoJCX07CgkJdmFyIG9uX2V4cG9ydF9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCWNsb3NlKCk7CgkJCQlvcGVuX2V4cG9ydCgpOwoJCQl9CgkJfTsKCQl2YXIgb25fc2F2ZV9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCQljb25maWcgPSBjb25maWdfdGVtcDsKCQkJCUNvbmZpZy5sb2FkX2N1c3RvbV9mcm9tX2Nsb25lKGNvbmZpZ19jdXN0b21fdGVtcCk7CgkJCQlFeHRlbnNpb25BUEkuc2V0X2V4dGVuc2lvbnNfZW5hYmxlZChjb25maWdfZXh0c190ZW1wKTsKCgkJCQlDb25maWcuc2F2ZSgpOwoJCQkJY2xvc2UoKTsKCQkJfQoJCX07CgkJdmFyIG9uX2NhbmNlbF9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCQljbG9zZSgpOwoJCQl9CgkJfTsKCQl2YXIgb25fdG9nZ2xlX2ZpbHRlcl9ndWlkZSA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCgkJCQl0cnkgewoJCQkJCXZhciBuID0gdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5uZXh0U2libGluZzsKCQkJCQlpZiAobi5jbGFzc0xpc3QuY29udGFpbnMoInhsLXNldHRpbmdzLWZpbHRlci1ndWlkZSIpKSB7CgkJCQkJCW4uY2xhc3NMaXN0LnRvZ2dsZSgieGwtc2V0dGluZ3MtZmlsdGVyLWd1aWRlLXZpc2libGUiKTsKCQkJCQl9CgkJCQl9CgkJCQljYXRjaCAoZSkge30KCQkJfQoJCX07CgkJdmFyIG9uX2NvbG9yX2hlbHBlcl9jaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBuID0gdGhpcy5uZXh0U2libGluZywKCQkJCW07CgoJCQlpZiAobiAhPT0gbnVsbCkgewoJCQkJbi52YWx1ZSA9IHRoaXMudmFsdWUudG9VcHBlckNhc2UoKTsKCQkJCW4gPSBuLm5leHRTaWJsaW5nOwoJCQkJaWYgKG4gIT09IG51bGwpIHsKCQkJCQltID0gL14jKFswLTlhLWZdezJ9KShbMC05YS1mXXsyfSkoWzAtOWEtZl17Mn0pJC9pLmV4ZWModGhpcy52YWx1ZSk7CgkJCQkJaWYgKG0gIT09IG51bGwpIHsKCQkJCQkJbi52YWx1ZSA9ICJyZ2JhKCIgKyBwYXJzZUludChtWzFdLCAxNikgKyAiLCIgKyBwYXJzZUludChtWzJdLCAxNikgKyAiLCIgKyBwYXJzZUludChtWzNdLCAxNikgKyAiLDEpIjsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBvbl9zZXR0aW5nc19vcGVuX2NsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCWlmICgkLmlzX2xlZnRfbW91c2UoZXZlbnQpKSB7CgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoKCQkJCW9wZW4oKTsKCQkJfQoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciByZWFkeSA9IGZ1bmN0aW9uICgpIHsKCQkJTmF2aWdhdGlvbi5pbnNlcnRfbGluaygibWFpbiIsIE1haW4udGl0bGUsIE1haW4uaG9tZXBhZ2UsICIgeGwtbmF2LWxpbmstc2V0dGluZ3MiLCBvbl9zZXR0aW5nc19vcGVuX2NsaWNrKTsKCgkJCXZhciBuID0gJC5saW5rKE1haW4uaG9tZXBhZ2UsICJ4bC1uYXYtbGluayIsIE1haW4udGl0bGUgKyAiIFNldHRpbmdzIik7CgkJCSQub24obiwgImNsaWNrIiwgb25fc2V0dGluZ3Nfb3Blbl9jbGljayk7CgkJCUhlYWRlckJhci5pbnNlcnRfbWVudV9saW5rKG4pOwoJCX07CgkJdmFyIG9wZW4gPSBmdW5jdGlvbiAoKSB7CgkJCXZhciB0aGVtZSA9IFRoZW1lLmNsYXNzZXMsCgkJCQljdXN0b21fb3B0aW9ucyA9IENvbmZpZy5nZXRfY3VzdG9tX3NldHRpbmdzX2Rlc2NyaXB0b3IoKSwKCQkJCWNvbnRlbnRfY29udGFpbmVyLCBrLCBuOwoKCQkJLy8gQ29uZmlnCgkJCWNvbmZpZ190ZW1wID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25maWcpKTsKCQkJY29uZmlnX2N1c3RvbV90ZW1wID0gQ29uZmlnLmdldF9jdXN0b21fY2xvbmUoKTsKCgkJCS8vIFBvcHVwCgkJCXBvcHVwID0gUG9wdXAuY3JlYXRlKCJzZXR0aW5ncyIsIFtbewoJCQkJc21hbGw6IHRydWUsCgkJCQlzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCXZhciBuOwoJCQkJCSQuYWRkKGNvbnRhaW5lciwgJC5saW5rKE1haW4uaG9tZXBhZ2UsICJ4bC1zZXR0aW5ncy10aXRsZSIgKyB0aGVtZSwgTWFpbi50aXRsZSkpOwoJCQkJCSQuYWRkKGNvbnRhaW5lciwgbiA9ICQubGluayhDaGFuZ2Vsb2cudXJsLCAieGwtc2V0dGluZ3MtdmVyc2lvbiIgKyB0aGVtZSwgTWFpbi52ZXJzaW9uLmpvaW4oIi4iKSkpOwoJCQkJCSQub24obiwgImNsaWNrIiwgb25fY2hhbmdlbG9nX2NsaWNrKTsKCQkJCX0KCQkJfSwgewoJCQkJYWxpZ246ICJyaWdodCIsCgkJCQlzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCXZhciBuOwoJCQkJCSQuYWRkKGNvbnRhaW5lciwgbiA9ICQubGluayhNYWluLnN1cHBvcnRfdXJsLCAieGwtc2V0dGluZ3MtYnV0dG9uIiArIHRoZW1lKSk7CgkJCQkJJC5hZGQobiwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IiwgIklzc3VlcyIpKTsKCgkJCQkJJC5hZGQoY29udGFpbmVyLCBuID0gJC5saW5rKENoYW5nZWxvZy51cmwsICJ4bC1zZXR0aW5ncy1idXR0b24iICsgdGhlbWUpKTsKCQkJCQkkLmFkZChuLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtYnV0dG9uLXRleHQiLCAiQ2hhbmdlbG9nIikpOwoJCQkJCSQub24obiwgImNsaWNrIiwgb25fY2hhbmdlbG9nX2NsaWNrKTsKCgkJCQkJJC5hZGQoY29udGFpbmVyLCBuID0gJC5saW5rKCIjIiwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4sICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1idXR0b24tdGV4dCIsICJFeHBvcnQiKSk7CgkJCQkJJC5vbihuLCAiY2xpY2siLCBvbl9leHBvcnRfY2xpY2spOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4gPSAkLmxpbmsoIiMiLCAieGwtc2V0dGluZ3MtYnV0dG9uIiArIHRoZW1lKSk7CgkJCQkJJC5hZGQobiwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IiwgIlNhdmUgc2V0dGluZ3MiKSk7CgkJCQkJJC5vbihuLCAiY2xpY2siLCBvbl9zYXZlX2NsaWNrKTsKCgkJCQkJJC5hZGQoY29udGFpbmVyLCBuID0gJC5saW5rKCIjIiwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4sICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1idXR0b24tdGV4dCIsICJDYW5jZWwiKSk7CgkJCQkJJC5vbihuLCAiY2xpY2siLCBvbl9jYW5jZWxfY2xpY2spOwoJCQkJfQoJCQl9XSwgewoJCQkJYm9keTogdHJ1ZSwKCQkJCXNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQkJY29udGVudF9jb250YWluZXIgPSBjb250YWluZXI7CgkJCQl9CgkJCX1dKTsKCgkJCS8vIFNldHRpbmdzCgkJCW4gPSAkLnRub2RlKCJOb3RlOiB5b3UgbXVzdCByZWxvYWQgdGhlIHBhZ2UgYWZ0ZXIgc2F2aW5nIGZvciBzb21lIGNoYW5nZXMgdG8gdGFrZSBlZmZlY3QiKTsKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIGdlbmVyYXRlX3NlY3Rpb25faGVhZGVyKCJHZW5lcmFsIiwgbikpOwoJCQluID0gZ2VuZXJhdGVfc2VjdGlvbigpOwoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnMobiwgImdlbmVyYWwiLCBvcHRpb25zLmdlbmVyYWwsIGNvbmZpZ190ZW1wLmdlbmVyYWwpOwoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnNfY3VzdG9tKG4sICJnZW5lcmFsIiwgY3VzdG9tX29wdGlvbnMsIGNvbmZpZ19jdXN0b21fdGVtcCk7CgkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBuKTsKCgkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBnZW5lcmF0ZV9zZWN0aW9uX2hlYWRlcigiU2l0ZXMiKSk7CgkJCW4gPSBnZW5lcmF0ZV9zZWN0aW9uKCk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9ucyhuLCAic2l0ZXMiLCBvcHRpb25zLnNpdGVzLCBjb25maWdfdGVtcC5zaXRlcyk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9uc19jdXN0b20obiwgInNpdGVzIiwgY3VzdG9tX29wdGlvbnMsIGNvbmZpZ19jdXN0b21fdGVtcCk7CgkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBuKTsKCgkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBnZW5lcmF0ZV9zZWN0aW9uX2hlYWRlcigiRGV0YWlscyIpKTsKCQkJbiA9IGdlbmVyYXRlX3NlY3Rpb24oKTsKCQkJZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb25zKG4sICJkZXRhaWxzIiwgb3B0aW9ucy5kZXRhaWxzLCBjb25maWdfdGVtcC5kZXRhaWxzKTsKCQkJZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb25zX2N1c3RvbShuLCAiZGV0YWlscyIsIGN1c3RvbV9vcHRpb25zLCBjb25maWdfY3VzdG9tX3RlbXApOwoJCQkkLmFkZChjb250ZW50X2NvbnRhaW5lciwgbik7CgoJCQkkLmFkZChjb250ZW50X2NvbnRhaW5lciwgZ2VuZXJhdGVfc2VjdGlvbl9oZWFkZXIoIkFjdGlvbnMiKSk7CgkJCW4gPSBnZW5lcmF0ZV9zZWN0aW9uKCk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9ucyhuLCAiYWN0aW9ucyIsIG9wdGlvbnMuYWN0aW9ucywgY29uZmlnX3RlbXAuYWN0aW9ucyk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9uc19jdXN0b20obiwgImFjdGlvbnMiLCBjdXN0b21fb3B0aW9ucywgY29uZmlnX2N1c3RvbV90ZW1wKTsKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIG4pOwoKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIGdlbmVyYXRlX3NlY3Rpb25faGVhZGVyKCJFeFNhdWNlIikpOwoJCQluID0gZ2VuZXJhdGVfc2VjdGlvbigpOwoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnMobiwgInNhdWNlIiwgb3B0aW9ucy5zYXVjZSwgY29uZmlnX3RlbXAuc2F1Y2UpOwoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnNfY3VzdG9tKG4sICJzYXVjZSIsIGN1c3RvbV9vcHRpb25zLCBjb25maWdfY3VzdG9tX3RlbXApOwoJCQkkLmFkZChjb250ZW50X2NvbnRhaW5lciwgbik7CgoJCQkkLmFkZChjb250ZW50X2NvbnRhaW5lciwgZ2VuZXJhdGVfc2VjdGlvbl9oZWFkZXIoIkVhc3kgTGlzdCIpKTsKCQkJbiA9IGdlbmVyYXRlX3NlY3Rpb24oKTsKCQkJZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb25zKG4sICJlYXN5X2xpc3QiLCBvcHRpb25zLmVhc3lfbGlzdCwgY29uZmlnX3RlbXAuZWFzeV9saXN0KTsKCQkJZ2VuZXJhdGVfc2VjdGlvbl9vcHRpb25zX2N1c3RvbShuLCAiZWFzeV9saXN0IiwgY3VzdG9tX29wdGlvbnMsIGNvbmZpZ19jdXN0b21fdGVtcCk7CgkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBuKTsKCgkJCW4gPSAkLmxpbmsoIiMiLCAieGwtc2V0dGluZ3MtZmlsdGVyLWd1aWRlLXRvZ2dsZSIsICJDbGljayBoZXJlIHRvIHRvZ2dsZSB0aGUgZ3VpZGUiKTsKCQkJJC5vbihuLCAiY2xpY2siLCBvbl90b2dnbGVfZmlsdGVyX2d1aWRlKTsKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIGdlbmVyYXRlX3NlY3Rpb25faGVhZGVyKCJGaWx0ZXJpbmciLCBuKSk7CgkJCW4gPSAkLmh0bWxfZnJhZ21lbnQoaHRtbF9maWx0ZXJfZ3VpZGUoKSk7CgkJCVRoZW1lLmFwcGx5KG4pOwoJCQkkLm9uKCQoImlucHV0LnhsLXNldHRpbmdzLWNvbG9yLWlucHV0W3R5cGU9Y29sb3JdIiwgbiksICJjaGFuZ2UiLCBvbl9jb2xvcl9oZWxwZXJfY2hhbmdlKTsKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIG4pOwoJCQluID0gZ2VuZXJhdGVfc2VjdGlvbigpOwoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnMobiwgImZpbHRlciIsIG9wdGlvbnMuZmlsdGVyLCBjb25maWdfdGVtcC5maWx0ZXIpOwoJCQlnZW5lcmF0ZV9zZWN0aW9uX29wdGlvbnNfY3VzdG9tKG4sICJmaWx0ZXIiLCBjdXN0b21fb3B0aW9ucywgY29uZmlnX2N1c3RvbV90ZW1wKTsKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIG4pOwoKCQkJJC5hZGQoY29udGVudF9jb250YWluZXIsIGdlbmVyYXRlX3NlY3Rpb25faGVhZGVyKCJEZWJ1Z2dpbmciKSk7CgkJCW4gPSBnZW5lcmF0ZV9zZWN0aW9uKCk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9ucyhuLCAiZGVidWciLCBvcHRpb25zLmRlYnVnLCBjb25maWdfdGVtcC5kZWJ1Zyk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9ucyhuLCAiZGVidWctZXh0IiwgWwoJCQkJWyBudWxsLCBudWxsLAoJCQkJCSJDbGVhciBjYWNoZSBkYXRhIiwgIkNsZWFyIGFsbCBjYWNoZWQgZ2FsbGVyeSBkYXRhIiwKCQkJCQludWxsLAoJCQkJCXsgdHlwZTogImJ1dHRvbiIsIHRleHQ6ICJDbGVhciIsIG9uX2NoYW5nZTogb25fY2FjaGVfY2xlYXJfY2xpY2sgfSwKCQkJCV0KCQkJXSwgbnVsbCk7CgkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9uc19jdXN0b20obiwgImRlYnVnIiwgY3VzdG9tX29wdGlvbnMsIGNvbmZpZ19jdXN0b21fdGVtcCk7CgkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBuKTsKCgkJCS8vIEN1c3RvbQoJCQlmb3IgKGsgaW4gY3VzdG9tX29wdGlvbnMpIHsKCQkJCWlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGNvbmZpZ190ZW1wLCBrKSkgewoJCQkJCSQuYWRkKGNvbnRlbnRfY29udGFpbmVyLCBnZW5lcmF0ZV9zZWN0aW9uX2hlYWRlcih0aXRsaWZ5X2N1c3RvbV9uYW1lc3BhY2UoaykpKTsKCQkJCQluID0gZ2VuZXJhdGVfc2VjdGlvbigpOwoJCQkJCWdlbmVyYXRlX3NlY3Rpb25fb3B0aW9ucyhuLCBrICsgIi1jdXN0b20iLCBjdXN0b21fb3B0aW9uc1trXSwgY29uZmlnX2N1c3RvbV90ZW1wW2tdKTsKCQkJCQkkLmFkZChjb250ZW50X2NvbnRhaW5lciwgbik7CgkJCQl9CgkJCX0KCgkJCS8vIEV4dGVuc2lvbnMKCQkJY29uZmlnX2V4dHNfdGVtcCA9IGdlbmVyYXRlX2V4dGVuc2lvbnMoY29udGVudF9jb250YWluZXIpOwoKCQkJLy8gRXZlbnRzCgkJCSQub24ocG9wdXAsICJjbGljayIsIG9uX2NhbmNlbF9jbGljayk7CgoJCQkvLyBBZGQgdG8gYm9keQoJCQlQb3B1cC5vcGVuKHBvcHVwKTsKCgkJCS8vIEZvY3VzCgkJCW4gPSAkKCIueGwtcG9wdXAtY2VsbC1zaXplLXNjcm9sbCIsIHBvcHVwKTsKCQkJaWYgKG4gIT09IG51bGwpICQuc2Nyb2xsX2ZvY3VzKG4pOwoJCX07CgkJdmFyIG9wZW5fZXhwb3J0ID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgdGhlbWUgPSBUaGVtZS5jbGFzc2VzLAoJCQkJbm9kZXMgPSB7CgkJCQkJdGV4dGFyZWE6IG51bGwKCQkJCX0sCgkJCQlleHBvcnRfZGF0YV9zdHJpbmcsIG47CgoJCQkvLyBDb25maWcKCQkJZXhwb3J0X2RhdGFfc3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoY3JlYXRlX2V4cG9ydF9kYXRhKCksIG51bGwsIDIpOwoJCQlleHBvcnRfdXJsID0gJC5jcmVhdGVfdXJsX2Zyb21fZGF0YShleHBvcnRfZGF0YV9zdHJpbmcsICJhcHBsaWNhdGlvbi9qc29uIiwgZmFsc2UpOwoKCQkJLy8gUG9wdXAKCQkJcG9wdXAgPSBQb3B1cC5jcmVhdGUoInNldHRpbmdzIiwgW1t7CgkJCQlzbWFsbDogdHJ1ZSwKCQkJCXNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQkJJC5hZGQoY29udGFpbmVyLCAkLmxpbmsoTWFpbi5ob21lcGFnZSwgInhsLXNldHRpbmdzLXRpdGxlIiArIHRoZW1lLCBNYWluLnRpdGxlKSk7CgkJCQkJJC5hZGQoY29udGFpbmVyLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtdGl0bGUtaW5mbyIgKyB0aGVtZSwgIiAtIFNldHRpbmdzIGV4cG9ydCIpKTsKCQkJCX0KCQkJfSwgewoJCQkJYWxpZ246ICJyaWdodCIsCgkJCQlzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCXZhciBkID0gbmV3IERhdGUoKSwKCQkJCQkJcGFkLCBuLCBmbjsKCgkJCQkJcGFkID0gZnVuY3Rpb24gKHMsIGxlbikgewoJCQkJCQlzID0gIiIgKyBzOwoJCQkJCQl3aGlsZSAocy5sZW5ndGggPCBsZW4pIHMgPSAiMCIgKyBzOwoJCQkJCQlyZXR1cm4gczsKCQkJCQl9OwoKCQkJCQlmbiA9ICQubm9kZSgiaW5wdXQiLCAieGwtc2V0dGluZ3MtZmlsZS1pbnB1dCIpOwoJCQkJCWZuLnR5cGUgPSAiZmlsZSI7CgkJCQkJZm4uYWNjZXB0ID0gIi5qc29uIjsKCQkJCQkkLmFkZChjb250YWluZXIsIGZuKTsKCQkJCQkkLm9uKGZuLCAiY2hhbmdlIiwgZnVuY3Rpb24gKCkgewoJCQkJCQl2YXIgZmlsZXMgPSB0aGlzLmZpbGVzLAoJCQkJCQkJcmVhZGVyOwoJCQkJCQlpZiAoZmlsZXMubGVuZ3RoID4gMCAmJiAoL1wuanNvbiQvaSkudGVzdChmaWxlc1swXS5uYW1lKSkgewoJCQkJCQkJcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCQkJCQkJCXJlYWRlci5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgZnVuY3Rpb24gKCkgewoJCQkJCQkJCXZhciBkID0gJC5qc29uX3BhcnNlX3NhZmUodGhpcy5yZXN1bHQsIG51bGwpOwoJCQkJCQkJCWlmIChkICE9PSBudWxsKSB7CgkJCQkJCQkJCW5vZGVzLnRleHRhcmVhLnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoZCwgbnVsbCwgMik7CgkJCQkJCQkJCW5vZGVzLnRleHRhcmVhLmNsYXNzTGlzdC5hZGQoInhsLXNldHRpbmdzLWV4cG9ydC10ZXh0YXJlYS1jaGFuZ2VkIik7CgkJCQkJCQkJfQoJCQkJCQkJfSwgZmFsc2UpOwoJCQkJCQkJcmVhZGVyLnJlYWRBc1RleHQoZmlsZXNbMF0pOwoJCQkJCQl9CgkJCQkJCXRoaXMudmFsdWUgPSBudWxsOwoJCQkJCX0pOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4gPSAkLmxpbmsodW5kZWZpbmVkLCAieGwtc2V0dGluZ3MtYnV0dG9uIiArIHRoZW1lKSk7CgkJCQkJJC5hZGQobiwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IiwgIkltcG9ydCIpKTsKCQkJCQkkLm9uKG4sICJjbGljayIsIGZ1bmN0aW9uIChldmVudCkgewoJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQlmbi5jbGljaygpOwoJCQkJCX0pOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4gPSAkLmxpbmsoZXhwb3J0X3VybCwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCW4ucmVtb3ZlQXR0cmlidXRlKCJ0YXJnZXQiKTsKCQkJCQluLnNldEF0dHJpYnV0ZSgiZG93bmxvYWQiLAoJCQkJCQlNYWluLnRpdGxlLnRvTG93ZXJDYXNlKCkgKyAiLXNldHRpbmdzLSIgKwoJCQkJCQlNYWluLnZlcnNpb24uam9pbigiLiIpICsgIi0iICsKCQkJCQkJcGFkKGQuZ2V0RnVsbFllYXIoKSwgNCkgKyAiLiIgKwoJCQkJCQlwYWQoZC5nZXRNb250aCgpICsgMSwgMikgKyAiLiIgKwoJCQkJCQlwYWQoZC5nZXREYXRlKCksIDIpICsgIi0iICsKCQkJCQkJcGFkKGQuZ2V0SG91cnMoKSwgMikgKyAiLiIgKwoJCQkJCQlwYWQoZC5nZXRNaW51dGVzKCksIDIpICsgIi5qc29uIgoJCQkJCSk7CgkJCQkJJC5hZGQobiwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IiwgIkV4cG9ydCIpKTsKCgkJCQkJJC5hZGQoY29udGFpbmVyLCBuID0gJC5saW5rKCIjIiwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4sICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1idXR0b24tdGV4dCIsICJTYXZlIHNldHRpbmdzIikpOwoJCQkJCSQub24obiwgImNsaWNrIiwgZnVuY3Rpb24gKGV2ZW50KSB7CgkJCQkJCWlmICgkLmlzX2xlZnRfbW91c2UoZXZlbnQpKSB7CgkJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQkJdmFyIHYgPSAkLmpzb25fcGFyc2Vfc2FmZShub2Rlcy50ZXh0YXJlYS52YWx1ZSwgbnVsbCk7CgkJCQkJCQlpZiAodiAhPT0gbnVsbCkgewoJCQkJCQkJCW5vZGVzLnRleHRhcmVhLmNsYXNzTGlzdC5yZW1vdmUoInhsLXNldHRpbmdzLWV4cG9ydC10ZXh0YXJlYS1lcnJvciIpOwoJCQkJCQkJCWltcG9ydF9zZXR0aW5ncyh2KTsKCQkJCQkJCX0KCQkJCQkJCWVsc2UgewoJCQkJCQkJCW5vZGVzLnRleHRhcmVhLmNsYXNzTGlzdC5hZGQoInhsLXNldHRpbmdzLWV4cG9ydC10ZXh0YXJlYS1lcnJvciIpOwoJCQkJCQkJfQoJCQkJCQkJbm9kZXMudGV4dGFyZWEuY2xhc3NMaXN0LnJlbW92ZSgieGwtc2V0dGluZ3MtZXhwb3J0LXRleHRhcmVhLWNoYW5nZWQiKTsKCQkJCQkJfQoJCQkJCX0pOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4gPSAkLmxpbmsoIiMiLCAieGwtc2V0dGluZ3MtYnV0dG9uIiArIHRoZW1lKSk7CgkJCQkJJC5hZGQobiwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IiwgIkNhbmNlbCIpKTsKCQkJCQkkLm9uKG4sICJjbGljayIsIG9uX2NhbmNlbF9jbGljayk7CgkJCQl9CgkJCX1dLCB7CgkJCQlwYWRkaW5nOiBmYWxzZSwKCQkJCXNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQkJdmFyIG4xLCBuMiwgbjM7CgoJCQkJCSQuYWRkKGNvbnRhaW5lciwgbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1zZXR0aW5ncy1leHBvcnQtbWVzc2FnZSIsICJEaXNjbGFpbWVyOiBjaGFuZ2luZyB0aGVzZSBzZXR0aW5ncyBjYW4gZWFzaWx5IGJyZWFrIHRoaW5ncy4gRWRpdCBhdCB5b3VyIG93biByaXNrLiAoIikpOwoKCQkJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImxhYmVsIiwgInhsLXNldHRpbmdzLWV4cG9ydC1sYWJlbCIpKTsKCQkJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImlucHV0IiwgInhsLXNldHRpbmdzLWV4cG9ydC1jaGVja2JveCIpKTsKCQkJCQkkLmFkZChuMiwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWV4cG9ydC1sYWJlbC10ZXh0IiwgIkVuYWJsZSBlZGl0aW5nIikpOwoJCQkJCSQuYWRkKG4yLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtZXhwb3J0LWxhYmVsLXRleHQiLCAiRWRpdGluZyBlbmFibGVkIikpOwoJCQkJCW4zLnR5cGUgPSAiY2hlY2tib3giOwoJCQkJCW4zLmNoZWNrZWQgPSBmYWxzZTsKCQkJCQkkLm9uKG4zLCAiY2hhbmdlIiwgZnVuY3Rpb24gKCkgewoJCQkJCQlub2Rlcy50ZXh0YXJlYS5yZWFkT25seSA9ICF0aGlzLmNoZWNrZWQ7CgkJCQkJfSk7CgoJCQkJCSQuYWRkKG4xLCAkLnRub2RlKCIpIikpOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4xKTsKCQkJCX0KCQkJfSwgewoJCQkJYm9keTogdHJ1ZSwKCQkJCXBhZGRpbmc6IGZhbHNlLAoJCQkJc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXIpIHsKCQkJCQl2YXIgbjsKCgkJCQkJbiA9ICQubm9kZSgidGV4dGFyZWEiLCAieGwtc2V0dGluZ3MtZXhwb3J0LXRleHRhcmVhIiArIHRoZW1lKTsKCQkJCQluLnNwZWxsY2hlY2sgPSBmYWxzZTsKCQkJCQluLndyYXAgPSAib2ZmIjsKCQkJCQluLnZhbHVlID0gZXhwb3J0X2RhdGFfc3RyaW5nOwoJCQkJCW4ucmVhZE9ubHkgPSB0cnVlOwoJCQkJCSQub24obiwgImlucHV0IiwgZnVuY3Rpb24gKCkgewoJCQkJCQl0aGlzLmNsYXNzTGlzdC5hZGQoInhsLXNldHRpbmdzLWV4cG9ydC10ZXh0YXJlYS1jaGFuZ2VkIik7CgkJCQkJfSk7CgoJCQkJCW5vZGVzLnRleHRhcmVhID0gbjsKCgkJCQkJJC5hZGQoY29udGFpbmVyLCBuKTsKCQkJCX0KCQkJfV0pOwoJCQkkLm9uKHBvcHVwLCAiY2xpY2siLCBvbl9jYW5jZWxfY2xpY2spOwoKCQkJLy8gQWRkIHRvIGJvZHkKCQkJUG9wdXAub3Blbihwb3B1cCk7CgoJCQkvLyBGb2N1cwoJCQluID0gJCgiLnhsLXNldHRpbmdzLWV4cG9ydC10ZXh0YXJlYSIsIHBvcHVwKTsKCQkJaWYgKG4gIT09IG51bGwpIG4uZm9jdXMoKTsKCQl9OwoJCXZhciBjbG9zZSA9IGZ1bmN0aW9uICgpIHsKCQkJY29uZmlnX3RlbXAgPSBudWxsOwoJCQljb25maWdfY3VzdG9tX3RlbXAgPSBudWxsOwoJCQljb25maWdfZXh0c190ZW1wID0gbnVsbDsKCQkJaWYgKHBvcHVwICE9PSBudWxsKSB7CgkJCQlQb3B1cC5jbG9zZShwb3B1cCk7CgkJCQlwb3B1cCA9IG51bGw7CgkJCX0KCQkJaWYgKGV4cG9ydF91cmwgIT09IG51bGwpIHsKCQkJCSQucmV2b2tlX3VybChleHBvcnRfdXJsKTsKCQkJCWV4cG9ydF91cmwgPSBudWxsOwoJCQl9CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCXJlYWR5OiByZWFkeSwKCQkJb3Blbjogb3BlbiwKCQkJb3Blbl9leHBvcnQ6IG9wZW5fZXhwb3J0LAoJCQljbG9zZTogY2xvc2UKCQl9OwoKCX0pKCk7Cgl2YXIgQ29uZmlnID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gUHJpdmF0ZQoJCXZhciBzZXR0aW5nc19rZXkgPSAieGxpbmtzLXNldHRpbmdzIiwKCQkJY3VzdG9tID0ge30sCgkJCWN1c3RvbV9kZXNjcmlwdG9yID0gbnVsbDsKCgkJdmFyIGdtX3N1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiAoCgkJCQkJdHlwZW9mKEdNX3NldFZhbHVlKSA9PT0gImZ1bmN0aW9uIiAmJgoJCQkJCXR5cGVvZihHTV9nZXRWYWx1ZSkgPT09ICJmdW5jdGlvbiIgJiYKCQkJCQl0eXBlb2YoR01fZGVsZXRlVmFsdWUpID09PSAiZnVuY3Rpb24iCgkJCQkpOwoJCQl9CgkJCWNhdGNoIChlKSB7fQoJCQlyZXR1cm4gdHJ1ZTsKCQl9OwoKCQkvLyBQdWJsaWMKCQl2YXIgc3RvcmFnZV9uZXcgPSAoZnVuY3Rpb24gKCkgewoJCQlpZiAoIWdtX3N1cHBvcnRlZC5jYWxsKHRoaXMpKSB7CgkJCQl2YXIgcyA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7CgkJCQlyZXR1cm4gewoJCQkJCWdldEl0ZW06IHRvX3Byb21pc2Uocy5nZXRJdGVtLCBzKSwKCQkJCQlzZXRJdGVtOiB0b19wcm9taXNlKHMuc2V0SXRlbSwgcyksCgkJCQkJcmVtb3ZlSXRlbTogdG9fcHJvbWlzZShzLnJlbW92ZUl0ZW0sIHMpCgkJCQl9OwoJCQl9CgkJCWVsc2UgewoJCQkJcmV0dXJuIHsKCQkJCQlnZXRJdGVtOiAoaykgPT4gR00uZ2V0SXRlbShrKSwKCQkJCQlzZXRJdGVtOiAoayx2KSA9PiBHTS5zZXRJdGVtKGssIHYpLAoJCQkJCXJlbW92ZUl0ZW06IChrKSA9PiBHTS5yZW1vdmVJdGVtKGspCgkJCQl9OwoJCQl9CgkJfSkoKTsKCgkJdmFyIHN0b3JhZ2UgPSAoZnVuY3Rpb24gKCkgewoJCQlpZiAoIWdtX3N1cHBvcnRlZC5jYWxsKHRoaXMpKSB7CgkJCQlyZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZTsKCQkJfQoKCQkJdmFyIGxvZ19lcnJvciA9IGZ1bmN0aW9uICgvKmUqLykge307CgkJCXZhciBzdG9yYWdlID0gewoJCQkJZ2V0SXRlbTogZnVuY3Rpb24gKGtleSkgewoJCQkJCXRyeSB7CgkJCQkJCXJldHVybiBHTV9nZXRWYWx1ZShrZXksIG51bGwpOwoJCQkJCX0KCQkJCQljYXRjaCAoZSkgewoJCQkJCQlsb2dfZXJyb3IoZSk7CgkJCQkJfQoJCQkJCXJldHVybiBudWxsOwoJCQkJfSwKCQkJCXNldEl0ZW06IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CgkJCQkJdHJ5IHsKCQkJCQkJR01fc2V0VmFsdWUoa2V5LCB2YWx1ZSk7CgkJCQkJfQoJCQkJCWNhdGNoIChlKSB7CgkJCQkJCWxvZ19lcnJvcihlKTsKCQkJCQl9CgkJCQl9LAoJCQkJcmVtb3ZlSXRlbTogZnVuY3Rpb24gKGtleSkgewoJCQkJCXRyeSB7CgkJCQkJCUdNX2RlbGV0ZVZhbHVlKGtleSk7CgkJCQkJfQoJCQkJCWNhdGNoIChlKSB7CgkJCQkJCWxvZ19lcnJvcihlKTsKCQkJCQl9CgkJCQl9CgkJCX07CgoJCQlyZXR1cm4gc3RvcmFnZTsKCQl9KSgpOwoKCQl2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHsKCQkJdmFyIHVwZGF0ZSA9IGZhbHNlLAoJCQkJdGVtcCwgdGVtcF9zY29wZSwgaW5mbywgc2NvcGUsIGVudHJ5LCB2YWx1ZSwgaSwgaWksIGssIHQ7CgoJCQlpZiAoCgkJCQkodGVtcCA9IGdldF9zYXZlZF9zZXR0aW5ncygpKSA9PT0gbnVsbCB8fAoJCQkJdHlwZW9mKHRlbXApICE9PSAib2JqZWN0IgoJCQkpIHsKCQkJCXRlbXAgPSB7fTsKCQkJCU1haW4udmVyc2lvbl9jaGFuZ2UgPSAyOwoJCQl9CgoJCQlpZiAodHlwZW9mKHRlbXAuc2V0dGluZ3NfdmVyc2lvbikgPT09ICJudW1iZXIiKSB7CgkJCQkvLyBOZXcgc2V0dGluZ3MKCQkJCWZvciAoayBpbiBvcHRpb25zKSB7CgkJCQkJY29uZmlnW2tdID0gc2NvcGUgPSB7fTsKCQkJCQlpbmZvID0gb3B0aW9uc1trXTsKCQkJCQlpaSA9IGluZm8ubGVuZ3RoOwoKCQkJCQl0ZW1wX3Njb3BlID0gdGVtcFtrXTsKCQkJCQlpZiAodHlwZW9mKHRlbXBfc2NvcGUpICE9PSAib2JqZWN0IiB8fCB0ZW1wX3Njb3BlID09PSBudWxsKSB0ZW1wX3Njb3BlID0ge307CgoJCQkJCWZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7CgkJCQkJCWVudHJ5ID0gaW5mb1tpXTsKCQkJCQkJdCA9IGVudHJ5WzBdOyAvLyBuYW1lCgkJCQkJCXZhbHVlID0gdGVtcF9zY29wZVt0XTsKCQkJCQkJaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKCQkJCQkJCXZhbHVlID0gZW50cnlbMV07IC8vIGRlZmF1bHQKCQkJCQkJCXVwZGF0ZSA9IHRydWU7CgkJCQkJCX0KCQkJCQkJc2NvcGVbdF0gPSB2YWx1ZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQkvLyBMb2FkIGZyb20gb2xkIHZlcnNpb24KCQkJCXVwZGF0ZSA9IHRydWU7CgkJCQlmb3IgKGsgaW4gb3B0aW9ucykgewoJCQkJCWNvbmZpZ1trXSA9IHNjb3BlID0ge307CgkJCQkJaW5mbyA9IG9wdGlvbnNba107CgkJCQkJZm9yIChpID0gMCwgaWkgPSBpbmZvLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJZW50cnkgPSBpbmZvW2ldOwoJCQkJCQl0ID0gZW50cnlbNF07IC8vIG9sZF9uYW1lCgkJCQkJCWlmICgKCQkJCQkJCXQgPT09IG51bGwgfHwKCQkJCQkJCSh2YWx1ZSA9ICh0eXBlb2YodCkgPT09ICJzdHJpbmciID8gdGVtcFt0XSA6IHQuY2FsbChudWxsLCB0ZW1wKSkpID09PSB1bmRlZmluZWQKCQkJCQkJKSB7CgkJCQkJCQl2YWx1ZSA9IGVudHJ5WzFdOyAvLyBkZWZhdWx0CgkJCQkJCX0KCQkJCQkJc2NvcGVbZW50cnlbMF1dID0gdmFsdWU7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBWZXJzaW9uIGNoYW5nZQoJCQl2YWx1ZSA9IHRlbXAudmVyc2lvbjsKCQkJaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHZhbHVlID0gW107CgkJCWkgPSBNYWluLnZlcnNpb25fY29tcGFyZShNYWluLnZlcnNpb24sIHZhbHVlKTsKCQkJaWYgKGkgIT09IDApIHsKCQkJCXVwZGF0ZSA9IHRydWU7CgkJCQlpZiAoTWFpbi52ZXJzaW9uX2NoYW5nZSA9PT0gMCkgewoJCQkJCU1haW4udmVyc2lvbl9jaGFuZ2UgPSBpOwoJCQkJfQoJCQl9CgoJCQkvLyBTYXZlIGNoYW5nZXMKCQkJaWYgKHVwZGF0ZSkgc2F2ZSgpOwoJCX07CgkJdmFyIHJlYWR5ID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgZG9tYWluID0gJC5nZXRfZG9tYWluKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTsKCgkJCWlmIChkb21haW4gPT09ICI0Y2hhbi5vcmciIHx8IGRvbWFpbiA9PT0gIjRjaGFubmVsLm9yZyIpIHsKCQkJCU1vZHVsZS5tb2RlID0gIjRjaGFuIjsKCQkJCU1vZHVsZS5pc180Y2hhbiA9IHRydWU7CgkJCQlNb2R1bGUuaXNfNGNoYW5feDMgPSAoZG9jdW1lbnRfZWxlbWVudC5jbGFzc05hbWUubGVuZ3RoID4gMCkgfHwgKCQoImhlYWQ+c3R5bGUjbGF5b3V0IiwgZG9jdW1lbnRfZWxlbWVudCkgIT09IG51bGwpOyAvLyBhcHBjaGFuLXggZG9lc24ndCBpbnNlcnQgdGhlIGZvdXJjaGFuLXggY2xhc3MgZWFybHkgZW5vdWdoCgkJCX0KCQkJZWxzZSBpZiAoZG9tYWluID09PSAiZGVzdWFyY2hpdmUub3JnIiB8fCBkb21haW4gPT09ICJmZ3RzLmpwIiB8fCBkb21haW4gPT09ICJhcmNoaXZlZC5tb2UiIHx8IGRvbWFpbiA9PT0gImZpcmVkZW4ubmV0IikgewoJCQkJaWYgKGRvY3VtZW50LmRvY3R5cGUucHVibGljSWQpIHsKCQkJCQlNb2R1bGUubW9kZSA9ICJmdXVrYSI7CgkJCQkJTW9kdWxlLmlzX2Z1dWthID0gdHJ1ZTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCU1vZHVsZS5tb2RlID0gImZvb2x6IjsKCQkJCQlNb2R1bGUuaXNfZm9vbHogPSB0cnVlOwoJCQkJfQoJCQkJTW9kdWxlLmxpbmtpZnkgPSBmYWxzZTsKCQkJfQoJCQllbHNlIGlmIChkb21haW4gPT09ICJlLWhlbnRhaS5vcmciKSB7CgkJCQlpZiAoJCgiI2lwYndyYXBwZXIiKSA9PT0gbnVsbCkgewoJCQkJCU1vZHVsZS5tb2RlID0gImlwYiI7CgkJCQkJTW9kdWxlLmlzX2lwYiA9IHRydWU7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlNb2R1bGUubW9kZSA9ICJpcGJfbG9maSI7CgkJCQkJTW9kdWxlLmlzX2lwYl9sb2ZpID0gdHJ1ZTsKCQkJCX0KCQkJCU1vZHVsZS5saW5raWZ5ID0gZmFsc2U7CgkJCQlNb2R1bGUuZHluYW1pYyA9IGZhbHNlOwoJCQl9CgkJCWVsc2UgaWYgKGRvbWFpbiA9PT0gIm1lZ3VjYS5vcmciKSB7CgkJCQlNb2R1bGUubW9kZSA9ICJtZWd1Y2EiOwoJCQkJTW9kdWxlLmlzX21lZ3VjYSA9IHRydWU7CgkJCX0KCQkJZWxzZSB7IC8vIGFzc3VtZSB0aW55Ym9hcmQKCQkJCU1vZHVsZS5tb2RlID0gInRpbnlib2FyZCI7CgkJCQlNb2R1bGUuaXNfdGlueWJvYXJkID0gdHJ1ZTsKCQkJCU1vZHVsZS5saW5raWZ5ID0gZmFsc2U7CgkJCQlpZiAoZG9tYWluID09PSAiOGNoLm5ldCIpIE1vZHVsZS5pc184Y2ggPSB0cnVlOwoJCQkJaWYgKCQoImZvcm1bbmFtZT1wb3N0Y29udHJvbHNdIikgPT09IG51bGwpIHJldHVybiBmYWxzZTsKCQkJfQoKCQkJcmV0dXJuIHRydWU7CgkJfTsKCQl2YXIgc2F2ZSA9IGZ1bmN0aW9uICgpIHsKCQkJY29uZmlnLnZlcnNpb24gPSBNYWluLnZlcnNpb247CgkJCXN0b3JhZ2Uuc2V0SXRlbShzZXR0aW5nc19rZXksIEpTT04uc3RyaW5naWZ5KGNvbmZpZykpOwoJCQljb25maWcudmVyc2lvbiA9IG51bGw7CgkJfTsKCQl2YXIgZ2V0X3NhdmVkX3NldHRpbmdzID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgdiA9IHN0b3JhZ2UuZ2V0SXRlbShzZXR0aW5nc19rZXkpOwoJCQlyZXR1cm4gJC5qc29uX3BhcnNlX3NhZmUodiwgbnVsbCk7CgkJfTsKCQl2YXIgc2V0X3NhdmVkX3NldHRpbmdzID0gZnVuY3Rpb24gKGRhdGEpIHsKCQkJaWYgKGRhdGEgPT09IG51bGwpIHsKCQkJCXN0b3JhZ2UucmVtb3ZlSXRlbShzZXR0aW5nc19rZXkpOwoJCQl9CgkJCWVsc2UgewoJCQkJdmFyIHYgPSBKU09OLnN0cmluZ2lmeShkYXRhKTsKCQkJCXN0b3JhZ2Uuc2V0SXRlbShzZXR0aW5nc19rZXksIHYpOwoJCQl9CgkJfTsKCgkJdmFyIGxvYWRfY3VzdG9tID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgc2F2ZWQgPSAkLmpzb25fcGFyc2Vfc2FmZShzdG9yYWdlLmdldEl0ZW0oc2V0dGluZ3Nfa2V5ICsgIi1jdXN0b20iKSwgbnVsbCksCgkJCQlvYmosIGsxLCBrMiwgdjsKCgkJCWlmIChzYXZlZCA9PT0gbnVsbCB8fCB0eXBlb2Yoc2F2ZWQpICE9PSAib2JqZWN0IikgcmV0dXJuOwoKCQkJZm9yIChrMSBpbiBzYXZlZCkgewoJCQkJb2JqID0gc2F2ZWRbazFdOwoJCQkJaWYgKG9iaiAhPT0gbnVsbCAmJiB0eXBlb2Yob2JqKSA9PT0gIm9iamVjdCIpIHsKCQkJCQlmb3IgKGsyIGluIG9iaikgewoJCQkJCQlpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjdXN0b20sIGsxKSkgewoJCQkJCQkJdiA9IGN1c3RvbVtrMV0gPSB7fTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCXYgPSBjdXN0b21bazFdOwoJCQkJCQl9CgkJCQkJCXZbazJdID0gb2JqW2syXTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBzYXZlX2N1c3RvbSA9IGZ1bmN0aW9uICgpIHsKCQkJc3RvcmFnZS5zZXRJdGVtKHNldHRpbmdzX2tleSArICItY3VzdG9tIiwgSlNPTi5zdHJpbmdpZnkoY3VzdG9tKSk7CgkJfTsKCgkJdmFyIHJlZ2lzdGVyX2N1c3RvbV9zZXR0aW5nID0gZnVuY3Rpb24gKG5hbWVzcGFjZSwgbmFtZSwgZGVmYXVsdF92YWx1ZSwgdGl0bGUsIGRlc2NyaXB0aW9uLCBkZXNjcmlwdG9yKSB7CgkJCS8vIEFscmVhZHkgZXhpc3RzCgkJCWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoY29uZmlnLCBuYW1lc3BhY2UpICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjb25maWdbbmFtZXNwYWNlXSwgbmFtZSkpIHsKCQkJCXJldHVybiB1bmRlZmluZWQ7CgkJCX0KCgkJCS8vIExvYWQgY3VzdG9tCgkJCWlmIChjdXN0b21fZGVzY3JpcHRvciA9PT0gbnVsbCkgewoJCQkJY3VzdG9tX2Rlc2NyaXB0b3IgPSB7fTsKCQkJCWxvYWRfY3VzdG9tKCk7CgkJCX0KCgkJCS8vIEdldCB2YWx1ZQoJCQl2YXIgdXBkYXRlID0gaW5pdF9jdXN0b20obmFtZXNwYWNlLCBuYW1lLCBkZWZhdWx0X3ZhbHVlKSwKCQkJCWQsIHY7CgoJCQkvLyBEZXNjcmlwdG9yCgkJCWQgPSBbIG5hbWUsIGRlZmF1bHRfdmFsdWUsIHRpdGxlLCBkZXNjcmlwdGlvbiwgbnVsbCBdOwoJCQlpZiAoZGVzY3JpcHRvciAhPT0gbnVsbCkgZC5wdXNoKGRlc2NyaXB0b3IpOwoKCQkJdiA9IGN1c3RvbV9kZXNjcmlwdG9yW25hbWVzcGFjZV07CgkJCWlmICh2ID09PSB1bmRlZmluZWQpIGN1c3RvbV9kZXNjcmlwdG9yW25hbWVzcGFjZV0gPSB2ID0gW107CgkJCXYucHVzaChkKTsKCgkJCS8vIFNhdmUKCQkJaWYgKHVwZGF0ZVswXSkgc2F2ZV9jdXN0b20oKTsKCgkJCS8vIFJldHVybiB2YWx1ZQoJCQlyZXR1cm4gdXBkYXRlWzFdOwoJCX07CgkJdmFyIGluaXRfY3VzdG9tID0gZnVuY3Rpb24gKG5hbWVzcGFjZSwgbmFtZSwgZGVmYXVsdF92YWx1ZSkgewoJCQl2YXIgdiA9IGN1c3RvbVtuYW1lc3BhY2VdLAoJCQkJdmFsOwoKCQkJaWYgKHYgPT09IHVuZGVmaW5lZCkgewoJCQkJY3VzdG9tW25hbWVzcGFjZV0gPSB2ID0ge307CgkJCQl2W25hbWVdID0gZGVmYXVsdF92YWx1ZTsKCQkJCXJldHVybiBbIHRydWUsIGRlZmF1bHRfdmFsdWUgXTsKCQkJfQoKCQkJdmFsID0gdltuYW1lXTsKCQkJaWYgKHZhbCA9PT0gdW5kZWZpbmVkKSB7CgkJCQl2W25hbWVdID0gZGVmYXVsdF92YWx1ZTsKCQkJCXJldHVybiBbIHRydWUsIGRlZmF1bHRfdmFsdWUgXTsKCQkJfQoKCQkJcmV0dXJuIFsgZmFsc2UsIHZhbCBdOwoJCX07CgkJdmFyIGdldF9jdXN0b21fc2V0dGluZ3NfZGVzY3JpcHRvciA9IGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIGN1c3RvbV9kZXNjcmlwdG9yID09PSBudWxsID8ge30gOiBjdXN0b21fZGVzY3JpcHRvcjsKCQl9OwoJCXZhciBnZXRfY3VzdG9tID0gZnVuY3Rpb24gKG5hbWVzcGFjZSwgbmFtZSkgewoJCQl2YXIgdiA9IGN1c3RvbVtuYW1lc3BhY2VdOwoJCQlyZXR1cm4gKHYgIT09IHVuZGVmaW5lZCkgPyB2W25hbWVdIDogdW5kZWZpbmVkOwoJCX07CgkJdmFyIGdldF9jdXN0b21fY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkJCXJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGN1c3RvbSkpOwoJCX07CgkJdmFyIGxvYWRfY3VzdG9tX2Zyb21fY2xvbmUgPSBmdW5jdGlvbiAoY2xvbmUpIHsKCQkJY3VzdG9tID0gY2xvbmU7CgkJCXNhdmVfY3VzdG9tKCk7CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXZhciBNb2R1bGUgPSB7CgkJCW1vZGU6ICI0Y2hhbiIsIC8vIGZvb2x6LCBmdXVrYSwgdGlueWJvYXJkLCBpcGIsIGlwYl9sb2ZpCgkJCWlzXzRjaGFuOiBmYWxzZSwKCQkJaXNfNGNoYW5feDM6IGZhbHNlLAoJCQlpc184Y2g6IGZhbHNlLAoJCQlpc19mb29sejogZmFsc2UsCgkJCWlzX2Z1dWthOiBmYWxzZSwKCQkJaXNfdGlueWJvYXJkOiBmYWxzZSwKCQkJaXNfaXBiOiBmYWxzZSwKCQkJaXNfaXBiX2xvZmk6IGZhbHNlLAoJCQlsaW5raWZ5OiB0cnVlLAoJCQlkeW5hbWljOiB0cnVlLAoJCQlzdG9yYWdlOiBzdG9yYWdlLAoJCQlpbml0OiBpbml0LAoJCQlyZWFkeTogcmVhZHksCgkJCXNhdmU6IHNhdmUsCgkJCWdldF9zYXZlZF9zZXR0aW5nczogZ2V0X3NhdmVkX3NldHRpbmdzLAoJCQlzZXRfc2F2ZWRfc2V0dGluZ3M6IHNldF9zYXZlZF9zZXR0aW5ncywKCQkJcmVnaXN0ZXJfY3VzdG9tX3NldHRpbmc6IHJlZ2lzdGVyX2N1c3RvbV9zZXR0aW5nLAoJCQlnZXRfY3VzdG9tX3NldHRpbmdzX2Rlc2NyaXB0b3I6IGdldF9jdXN0b21fc2V0dGluZ3NfZGVzY3JpcHRvciwKCQkJZ2V0X2N1c3RvbTogZ2V0X2N1c3RvbSwKCQkJZ2V0X2N1c3RvbV9jbG9uZTogZ2V0X2N1c3RvbV9jbG9uZSwKCQkJbG9hZF9jdXN0b21fZnJvbV9jbG9uZTogbG9hZF9jdXN0b21fZnJvbV9jbG9uZQoJCX07CgoJCXJldHVybiBNb2R1bGU7CgoJfSkoKTsKCXZhciBGaWx0ZXIgPSAoZnVuY3Rpb24gKCkgewoKCQkvLyBQcml2YXRlCgkJdmFyIGFjdGl2ZV9maWx0ZXJzID0gbnVsbCwKCQkJZ29vZF92YWx1ZXMgPSBbICIiLCAidHJ1ZSIsICJ5ZXMiIF0sCgkJCVN0YXR1cyA9IHsgTm9uZTogMCwgQmFkOiAtMSwgR29vZDogMSB9LAoJCQljYWNoZSA9IHsgdGFnczoge30gfTsKCgkJdmFyIEZpbHRlciA9IGZ1bmN0aW9uIChyZWdleCwgZmxhZ3MsIHByaW9yaXR5KSB7CgkJCXRoaXMucmVnZXggPSByZWdleDsKCQkJdGhpcy5mbGFncyA9IGZsYWdzOwoJCQl0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7CgkJfTsKCQl2YXIgRmlsdGVyRmxhZ3MgPSBmdW5jdGlvbiAoKSB7CgkJCXRoaXMudGl0bGUgPSB0cnVlOwoJCQl0aGlzLnRhZ3MgPSB0cnVlOwoJCQl0aGlzLnVwbG9hZGVyID0gZmFsc2U7CgkJCXRoaXMuYmFkID0gZmFsc2U7CgoJCQl0aGlzLm9ubHkgPSBudWxsOwoJCQl0aGlzLm5vdCA9IG51bGw7CgkJCXRoaXMuc2l0ZSA9IG51bGw7CgoJCQl0aGlzLmNvbG9yID0gIiNFRTIyMDAiOwoJCQl0aGlzLnVuZGVybGluZSA9IG51bGw7CgkJCXRoaXMuYmFja2dyb3VuZCA9IG51bGw7CgkJCXRoaXMubGlua19jb2xvciA9IHRoaXMuY29sb3I7CgkJCXRoaXMubGlua191bmRlcmxpbmUgPSBudWxsOwoJCQl0aGlzLmxpbmtfYmFja2dyb3VuZCA9IG51bGw7CgkJfTsKCQlGaWx0ZXJGbGFncy5zY29wZV9mbiA9IGZ1bmN0aW9uIChuYW1lKSB7CgkJCXJldHVybiBmdW5jdGlvbiAodmFsdWUsIHN0YXRlKSB7CgkJCQlpZiAoIXN0YXRlLnNjb3BlKSB7CgkJCQkJc3RhdGUuc2NvcGUgPSB0cnVlOwoJCQkJCXRoaXMudGFncyA9IGZhbHNlOwoJCQkJCXRoaXMudGl0bGUgPSBmYWxzZTsKCQkJCQl0aGlzLnVwbG9hZGVyID0gZmFsc2U7CgkJCQl9CgoJCQkJdGhpc1tuYW1lXSA9IChnb29kX3ZhbHVlcy5pbmRleE9mKHZhbHVlLnRyaW0oKS50b0xvd2VyQ2FzZSgpKSA+PSAwKTsKCQkJfTsKCQl9OwoJCUZpbHRlckZsYWdzLmNvbG9yX2ZuID0gZnVuY3Rpb24gKGZuKSB7CgkJCXJldHVybiBmdW5jdGlvbiAodmFsdWUsIHN0YXRlKSB7CgkJCQlpZiAoIXN0YXRlLmNvbG9yKSB7CgkJCQkJc3RhdGUuY29sb3IgPSB0cnVlOwoJCQkJCXRoaXMuY29sb3IgPSBudWxsOwoJCQkJCXRoaXMudW5kZXJsaW5lID0gbnVsbDsKCQkJCQl0aGlzLmJhY2tncm91bmQgPSBudWxsOwoJCQkJCXRoaXMubGlua19jb2xvciA9IG51bGw7CgkJCQkJdGhpcy5saW5rX3VuZGVybGluZSA9IG51bGw7CgkJCQkJdGhpcy5saW5rX2JhY2tncm91bmQgPSBudWxsOwoJCQkJfQoKCQkJCWZuLmNhbGwodGhpcywgdmFsdWUudHJpbSgpKTsKCQkJfTsKCQl9OwoJCUZpbHRlckZsYWdzLm5hbWVzID0gewoJCQkidGFncyI6IEZpbHRlckZsYWdzLnNjb3BlX2ZuKCJ0YWdzIiksCgkJCSJ0aXRsZSI6IEZpbHRlckZsYWdzLnNjb3BlX2ZuKCJ0aXRsZSIpLAoJCQkidXBsb2FkZXIiOiBGaWx0ZXJGbGFncy5zY29wZV9mbigidXBsb2FkZXIiKSwKCgkJCSJiYWQiOiBGaWx0ZXJGbGFncy5jb2xvcl9mbihmdW5jdGlvbiAodmFsdWUpIHsKCQkJCXRoaXMuYmFkID0gKGdvb2RfdmFsdWVzLmluZGV4T2YodmFsdWUudG9Mb3dlckNhc2UoKSkgPj0gMCk7CgkJCX0pLAoKCQkJIm9ubHkiOiBmdW5jdGlvbiAodmFsdWUpIHsKCQkJCXRoaXMub25seSA9IHRoaXMuc3BsaXQodmFsdWUpOwoJCQl9LAoJCQkibm90IjogZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLm5vdCA9IHRoaXMuc3BsaXQodmFsdWUpOwoJCQl9LAoJCQkic2l0ZSI6IGZ1bmN0aW9uICh2YWx1ZSkgewoJCQkJdGhpcy5zaXRlID0gdGhpcy5zcGxpdCh2YWx1ZSk7CgkJCX0sCgoJCQkiY29sb3JzIjogRmlsdGVyRmxhZ3MuY29sb3JfZm4oZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLmNvbG9yID0gdmFsdWU7CgkJCQl0aGlzLmxpbmtfY29sb3IgPSB2YWx1ZTsKCQkJfSksCgkJCSJ1bmRlcmxpbmVzIjogRmlsdGVyRmxhZ3MuY29sb3JfZm4oZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLnVuZGVybGluZSA9IHZhbHVlOwoJCQkJdGhpcy5saW5rX3VuZGVybGluZSA9IHZhbHVlOwoJCQl9KSwKCQkJImJhY2tncm91bmRzIjogRmlsdGVyRmxhZ3MuY29sb3JfZm4oZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLmJhY2tncm91bmQgPSB2YWx1ZTsKCQkJCXRoaXMubGlua19iYWNrZ3JvdW5kID0gdmFsdWU7CgkJCX0pLAoKCQkJImNvbG9yIjogRmlsdGVyRmxhZ3MuY29sb3JfZm4oZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLmNvbG9yID0gdmFsdWU7CgkJCX0pLAoJCQkidW5kZXJsaW5lIjogRmlsdGVyRmxhZ3MuY29sb3JfZm4oZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLnVuZGVybGluZSA9IHZhbHVlOwoJCQl9KSwKCQkJImJhY2tncm91bmQiOiBGaWx0ZXJGbGFncy5jb2xvcl9mbihmdW5jdGlvbiAodmFsdWUpIHsKCQkJCXRoaXMuYmFja2dyb3VuZCA9IHZhbHVlOwoJCQl9KSwKCgkJCSJsaW5rLWNvbG9yIjogRmlsdGVyRmxhZ3MuY29sb3JfZm4oZnVuY3Rpb24gKHZhbHVlKSB7CgkJCQl0aGlzLmxpbmtfY29sb3IgPSB2YWx1ZTsKCQkJfSksCgkJCSJsaW5rLXVuZGVybGluZSI6IEZpbHRlckZsYWdzLmNvbG9yX2ZuKGZ1bmN0aW9uICh2YWx1ZSkgewoJCQkJdGhpcy5saW5rX3VuZGVybGluZSA9IHZhbHVlOwoJCQl9KSwKCQkJImxpbmstYmFja2dyb3VuZCI6IEZpbHRlckZsYWdzLmNvbG9yX2ZuKGZ1bmN0aW9uICh2YWx1ZSkgewoJCQkJdGhpcy5saW5rX2JhY2tncm91bmQgPSB2YWx1ZTsKCQkJfSksCgoJCQkibm8tY29sb3JzIjogZnVuY3Rpb24gKHZhbHVlLCBzdGF0ZSkgewoJCQkJc3RhdGUuY29sb3IgPSB0cnVlOwoKCQkJCXZhbHVlID0gbnVsbDsKCQkJCXRoaXMuY29sb3IgPSB2YWx1ZTsKCQkJCXRoaXMudW5kZXJsaW5lID0gdmFsdWU7CgkJCQl0aGlzLmJhY2tncm91bmQgPSB2YWx1ZTsKCQkJCXRoaXMubGlua19jb2xvciA9IHZhbHVlOwoJCQkJdGhpcy5saW5rX3VuZGVybGluZSA9IHZhbHVlOwoJCQkJdGhpcy5saW5rX2JhY2tncm91bmQgPSB2YWx1ZTsKCQkJfSwKCgkJCSJ0YWciOiAidGFncyIsCgoJCQkiY2F0ZWdvcnkiOiAib25seSIsCgkJCSJjYXQiOiAib25seSIsCgkJCSJubyI6ICJub3QiLAoJCQkic2l0ZXMiOiAic2l0ZSIsCgoJCQkiY3MiOiAiY29sb3JzIiwKCQkJInVzIjogInVuZGVybGluZXMiLAoJCQkiYmdzIjogImJhY2tncm91bmRzIiwKCgkJCSJjIjogImNvbG9yIiwKCQkJInUiOiAidW5kZXJsaW5lIiwKCQkJImJnIjogImJhY2tncm91bmQiLAoKCQkJImxpbmtfY29sb3IiOiAibGluay1jb2xvciIsCgkJCSJsaW5rLWMiOiAibGluay1jb2xvciIsCgkJCSJsaW5rX2MiOiAibGluay1jb2xvciIsCgkJCSJsYyI6ICJsaW5rLWNvbG9yIiwKCQkJImxpbmtfdW5kZXJsaW5lIjogImxpbmstdW5kZXJsaW5lIiwKCQkJImxpbmstdSI6ICJsaW5rLXVuZGVybGluZSIsCgkJCSJsaW5rX3UiOiAibGluay11bmRlcmxpbmUiLAoJCQkibHUiOiAibGluay11bmRlcmxpbmUiLAoJCQkibGlua19iYWNrZ3JvdW5kIjogImxpbmstYmFja2dyb3VuZCIsCgkJCSJsaW5rLWJnIjogImxpbmstYmFja2dyb3VuZCIsCgkJCSJsaW5rX2JnIjogImxpbmstYmFja2dyb3VuZCIsCgkJCSJsYmciOiAibGluay1iYWNrZ3JvdW5kIiwKCgkJCSJub19jb2xvcnMiOiAibm8tY29sb3JzIiwKCQkJIm5vLWNvbG9yIjogIm5vLWNvbG9ycyIsCgkJCSJub19jb2xvciI6ICJuby1jb2xvcnMiLAoJCQkibm9jb2xvcnMiOiAibm8tY29sb3JzIiwKCQkJIm5vY29sb3IiOiAibm8tY29sb3JzIiwKCQl9OwoJCUZpbHRlckZsYWdzLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uIChmbGFnc19vYmopIHsKCQkJdmFyIHN0YXRlID0gewoJCQkJc2NvcGU6IGZhbHNlLAoJCQkJY29sb3I6IGZhbHNlCgkJCX0sIGssIGZuOwoKCQkJZm9yIChrIGluIGZsYWdzX29iaikgewoJCQkJZm4gPSBGaWx0ZXJGbGFncy5uYW1lc1trXTsKCQkJCWlmIChmbiAhPT0gdW5kZWZpbmVkKSB7CgkJCQkJaWYgKHR5cGVvZihmbikgPT09ICJzdHJpbmciKSB7CgkJCQkJCWZuID0gRmlsdGVyRmxhZ3MubmFtZXNbZm5dOwoJCQkJCX0KCQkJCQlmbi5jYWxsKHRoaXMsIGZsYWdzX29ialtrXSwgc3RhdGUpOwoJCQkJfQoJCQl9CgkJfTsKCQlGaWx0ZXJGbGFncy5wcm90b3R5cGUuc3BsaXQgPSBmdW5jdGlvbiAodGV4dCkgewoJCQl2YXIgYXJyYXksIGksIGlpOwoKCQkJdGV4dCA9IHRleHQudHJpbSgpOwoJCQlpZiAodGV4dC5sZW5ndGggPT09IDApIHJldHVybiBudWxsOwoKCQkJYXJyYXkgPSB0ZXh0LnRvTG93ZXJDYXNlKCkuc3BsaXQoIiwiKTsKCQkJZm9yIChpID0gMCwgaWkgPSBhcnJheS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlhcnJheVtpXSA9IGFycmF5W2ldLnRyaW0oKTsKCQkJfQoKCQkJcmV0dXJuIGFycmF5OwoJCX07CgkJdmFyIE1hdGNoID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIGZpbHRlcikgewoJCQl0aGlzLnN0YXJ0ID0gc3RhcnQ7CgkJCXRoaXMuZW5kID0gZW5kOwoJCQl0aGlzLmZpbHRlciA9IGZpbHRlcjsKCQl9OwoJCXZhciBNYXRjaFNlZ21lbnQgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCwgZGF0YSkgewoJCQl0aGlzLnN0YXJ0ID0gc3RhcnQ7CgkJCXRoaXMuZW5kID0gZW5kOwoJCQl0aGlzLmRhdGEgPSBkYXRhOwoJCX07CgkJdmFyIE1hdGNoSW5mbyA9IGZ1bmN0aW9uICgpIHsKCQkJdGhpcy5tYXRjaGVzID0gW107CgkJCXRoaXMuYW55ID0gZmFsc2U7CgkJCXRoaXMuYmFkID0gZmFsc2U7CgkJfTsKCgkJdmFyIGNyZWF0ZV9yZWdleCA9IGZ1bmN0aW9uIChwYXR0ZXJuLCBmbGFncykgewoJCQlpZiAoZmxhZ3MuaW5kZXhPZigiZyIpIDwgMCkgZmxhZ3MgKz0gImciOwoJCQlyZXR1cm4gJC5jcmVhdGVfcmVnZXhfc2FmZShwYXR0ZXJuLCBmbGFncyk7CgkJfTsKCQl2YXIgY3JlYXRlX2ZsYWdzID0gZnVuY3Rpb24gKHRleHQpIHsKCQkJdmFyIGZsYWdsaXN0ID0gdGV4dC5zcGxpdCgiOyIpLAoJCQkJZmxhZ3MgPSB7fSwKCQkJCWtleSwgbSwgaSwgZjsKCgkJCWZvciAoaSA9IDA7IGkgPCBmbGFnbGlzdC5sZW5ndGg7ICsraSkgewoJCQkJaWYgKGZsYWdsaXN0W2ldLmxlbmd0aCA+IDApIHsKCQkJCQltID0gZmxhZ2xpc3RbaV0uc3BsaXQoIjoiKTsKCQkJCQlrZXkgPSBtWzBdLnRyaW0oKS50b0xvd2VyQ2FzZSgpOwoJCQkJCW0uc3BsaWNlKDAsIDEpOwoJCQkJCWZsYWdzW2tleV0gPSBtLmpvaW4oIiIpLnRyaW0oKTsKCQkJCX0KCQkJfQoKCQkJZiA9IG5ldyBGaWx0ZXJGbGFncygpOwoJCQlmLnNldHVwKGZsYWdzKTsKCQkJcmV0dXJuIGY7CgkJfTsKCQl2YXIgbWF0Y2hlc190b19zZWdtZW50cyA9IGZ1bmN0aW9uICh0ZXh0LCBtYXRjaGVzKSB7CgkJCXZhciBzZWdtZW50cyA9IFsgbmV3IE1hdGNoU2VnbWVudCgwLCB0ZXh0Lmxlbmd0aCwgW10pIF0sCgkJCQloaXQsIG0sIHMsIGksIGlpLCBqLCBqajsKCgkJCWlmIChjb25maWcuZmlsdGVyLmZ1bGxfaGlnaGxpZ2h0aW5nKSB7IC8vIGZhc3QgbW9kZQoJCQkJZm9yIChpID0gMCwgaWkgPSBtYXRjaGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQlzZWdtZW50c1swXS5kYXRhLnB1c2gobWF0Y2hlc1tpXS5maWx0ZXIpOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJZm9yIChpID0gMCwgaWkgPSBtYXRjaGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQltID0gbWF0Y2hlc1tpXTsKCQkJCQloaXQgPSBmYWxzZTsKCQkJCQlmb3IgKGogPSAwLCBqaiA9IHNlZ21lbnRzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKCQkJCQkJcyA9IHNlZ21lbnRzW2pdOwoJCQkJCQlpZiAobS5zdGFydCA8IHMuZW5kICYmIG0uZW5kID4gcy5zdGFydCkgewoJCQkJCQkJaGl0ID0gdHJ1ZTsKCQkJCQkJCWogPSB1cGRhdGVfc2VnbWVudHMoc2VnbWVudHMsIGosIG0sIHMpOwoJCQkJCQl9CgkJCQkJCWVsc2UgaWYgKGhpdCkgewoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiBzZWdtZW50czsKCQl9OwoJCXZhciB1cGRhdGVfc2VnbWVudHMgPSBmdW5jdGlvbiAoc2VnbWVudHMsIHBvcywgbWF0Y2gsIHNlZ21lbnQpIHsKCQkJdmFyIGRhdGEgPSBzZWdtZW50LmRhdGEuc2xpY2UoMCksCgkJCQlzMSwgczI7CgoJCQlzZWdtZW50LmRhdGEucHVzaChtYXRjaC5maWx0ZXIpOwoKCQkJaWYgKG1hdGNoLnN0YXJ0ID4gc2VnbWVudC5zdGFydCkgewoJCQkJaWYgKG1hdGNoLmVuZCA8IHNlZ21lbnQuZW5kKSB7CgkJCQkJLy8gY3V0IGF0IGJvdGgKCQkJCQlzMSA9IG5ldyBNYXRjaFNlZ21lbnQoc2VnbWVudC5zdGFydCwgbWF0Y2guc3RhcnQsIGRhdGEpOwoJCQkJCXMyID0gbmV3IE1hdGNoU2VnbWVudChtYXRjaC5lbmQsIHNlZ21lbnQuZW5kLCBkYXRhLnNsaWNlKDApKTsKCQkJCQlzZWdtZW50LnN0YXJ0ID0gbWF0Y2guc3RhcnQ7CgkJCQkJc2VnbWVudC5lbmQgPSBtYXRjaC5lbmQ7CgkJCQkJc2VnbWVudHMuc3BsaWNlKHBvcywgMCwgczEpOwoJCQkJCXBvcyArPSAyOwoJCQkJCXNlZ21lbnRzLnNwbGljZShwb3MsIDAsIHMyKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIGN1dCBhdCBzdGFydAoJCQkJCXMxID0gbmV3IE1hdGNoU2VnbWVudChzZWdtZW50LnN0YXJ0LCBtYXRjaC5zdGFydCwgZGF0YSk7CgkJCQkJc2VnbWVudC5zdGFydCA9IG1hdGNoLnN0YXJ0OwoJCQkJCXNlZ21lbnRzLnNwbGljZShwb3MsIDAsIHMxKTsKCQkJCQlwb3MgKz0gMTsKCQkJCX0KCQkJfQoJCQllbHNlIHsKCQkJCWlmIChtYXRjaC5lbmQgPCBzZWdtZW50LmVuZCkgewoJCQkJCS8vIGN1dCBhdCBlbmQKCQkJCQlzMiA9IG5ldyBNYXRjaFNlZ21lbnQobWF0Y2guZW5kLCBzZWdtZW50LmVuZCwgZGF0YSk7CgkJCQkJc2VnbWVudC5lbmQgPSBtYXRjaC5lbmQ7CgkJCQkJcG9zICs9IDE7CgkJCQkJc2VnbWVudHMuc3BsaWNlKHBvcywgMCwgczIpOwoJCQkJfQoJCQkJLy8gZWxzZSwgY3V0IGF0IG5laXRoZXIKCQkJfQoKCQkJcmV0dXJuIHBvczsKCQl9OwoJCXZhciBhcHBseV9zdHlsZXMgPSBmdW5jdGlvbiAobm9kZSwgc3R5bGVzKSB7CgkJCXZhciBjb2xvciA9IG51bGwsCgkJCQliYWNrZ3JvdW5kID0gbnVsbCwKCQkJCXVuZGVybGluZSA9IG51bGwsCgkJCQlwMSA9IC0xLAoJCQkJcDIgPSAtMSwKCQkJCXAzID0gLTEsCgkJCQlzdHlsZSwgaSwgaWksIHMsIHA7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IHN0eWxlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlwID0gc3R5bGVzW2ldLnByaW9yaXR5OwoJCQkJc3R5bGUgPSBzdHlsZXNbaV0uZmxhZ3M7CgkJCQlpZiAoKHMgPSBzdHlsZS5jb2xvcikgIT09IG51bGwgJiYgcCA+PSBwMSkgewoJCQkJCWNvbG9yID0gczsKCQkJCQlwMSA9IHA7CgkJCQl9CgkJCQlpZiAoKHMgPSBzdHlsZS5iYWNrZ3JvdW5kKSAhPT0gbnVsbCAmJiBwID49IHAyKSB7CgkJCQkJYmFja2dyb3VuZCA9IHM7CgkJCQkJcDIgPSBwOwoJCQkJfQoJCQkJaWYgKChzID0gc3R5bGUudW5kZXJsaW5lKSAhPT0gbnVsbCAmJiBwID49IHAzKSB7CgkJCQkJdW5kZXJsaW5lID0gczsKCQkJCQlwMyA9IHA7CgkJCQl9CgkJCX0KCgkJCWFwcGx5X3N0eWxpbmcobm9kZSwgY29sb3IsIGJhY2tncm91bmQsIHVuZGVybGluZSk7CgkJfTsKCQl2YXIgYXBwbHlfc3R5bGluZyA9IGZ1bmN0aW9uIChub2RlLCBjb2xvciwgYmFja2dyb3VuZCwgdW5kZXJsaW5lKSB7CgkJCWlmIChjb2xvciAhPT0gbnVsbCkgewoJCQkJbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eSgiY29sb3IiLCBjb2xvciwgImltcG9ydGFudCIpOwoJCQl9CgkJCWlmIChiYWNrZ3JvdW5kICE9PSBudWxsKSB7CgkJCQlub2RlLnN0eWxlLnNldFByb3BlcnR5KCJiYWNrZ3JvdW5kLWNvbG9yIiwgYmFja2dyb3VuZCwgImltcG9ydGFudCIpOwoJCQl9CgkJCWlmICh1bmRlcmxpbmUgIT09IG51bGwpIHsKCQkJCW5vZGUuc3R5bGUuc2V0UHJvcGVydHkoImJvcmRlci1ib3R0b20iLCAiMC4xMjVlbSBzb2xpZCAiICsgdW5kZXJsaW5lLCAiaW1wb3J0YW50Iik7CgkJCX0KCQl9OwoJCXZhciBhcHBlbmRfbWF0Y2hfZGF0YXMgPSBmdW5jdGlvbiAobWF0Y2hpbmZvLCB0YXJnZXQpIHsKCQkJZm9yICh2YXIgaSA9IDAsIGlpID0gbWF0Y2hpbmZvLm1hdGNoZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJdGFyZ2V0LnB1c2gobWF0Y2hpbmZvLm1hdGNoZXNbaV0uZmlsdGVyKTsKCQkJfQoJCX07CgkJdmFyIHJlbW92ZV9ub25fYmFkID0gZnVuY3Rpb24gKGxpc3QpIHsKCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKSB7CgkJCQlpZiAoIWxpc3RbaV0uYmFkKSB7CgkJCQkJbGlzdC5zcGxpY2UoaSwgMSk7CgkJCQkJY29udGludWU7CgkJCQl9CgkJCQkrK2k7CgkJCX0KCQl9OwoJCXZhciBjaGVja19tdWx0aXBsZSA9IGZ1bmN0aW9uICh0eXBlLCB0ZXh0LCBmaWx0ZXJzLCBjYXRlZ29yeSwgc2l0ZV90eXBlKSB7CgkJCXZhciBpbmZvID0gbmV3IE1hdGNoSW5mbygpLAoJCQkJZmlsdGVyLCBtYXRjaCwgaSwgaWk7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IGZpbHRlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJZmlsdGVyID0gZmlsdGVyc1tpXTsKCQkJCWlmIChmaWx0ZXIuZmxhZ3NbdHlwZV0gIT09IHRydWUpIGNvbnRpbnVlOwoJCQkJZmlsdGVyLnJlZ2V4Lmxhc3RJbmRleCA9IDA7CgkJCQl3aGlsZSAodHJ1ZSkgewoJCQkJCW1hdGNoID0gY2hlY2tfc2luZ2xlKHRleHQsIGZpbHRlciwgY2F0ZWdvcnksIHNpdGVfdHlwZSk7CgkJCQkJaWYgKG1hdGNoID09PSBudWxsKSBicmVhazsKCgkJCQkJaW5mby5hbnkgPSB0cnVlOwoJCQkJCWluZm8ubWF0Y2hlcy5wdXNoKG1hdGNoKTsKCQkJCQlpZiAobWF0Y2guZmlsdGVyLmZsYWdzLmJhZCkgewoJCQkJCQlpbmZvLmJhZCA9IHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gaW5mbzsKCQl9OwoJCXZhciBjaGVja19zaW5nbGUgPSBmdW5jdGlvbiAodGV4dCwgZmlsdGVyLCBjYXRlZ29yeSwgc2l0ZV90eXBlKSB7CgkJCS8vIHJldHVybiBudWxsIGlmIG5vIG1hdGNoCgkJCS8vIHJldHVybiBhIG5ldyBNYXRjaCBpZiBhIG1hdGNoIHdhcyBmb3VuZAoJCQl2YXIgbGlzdCwgaSwgaWksIG07CgoJCQkvLyBTaXRlIGZpbHRlcmluZwoJCQlpZiAoKGxpc3QgPSBmaWx0ZXIuZmxhZ3Muc2l0ZSkgIT09IG51bGwpIHsKCQkJCWZvciAoaSA9IDAsIGlpID0gbGlzdC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJaWYgKGxpc3RbaV0gPT09IHNpdGVfdHlwZSkgYnJlYWs7CgkJCQl9CgkJCQlpZiAoaSA+PSBpaSkgcmV0dXJuIG51bGw7CgkJCX0KCgkJCS8vIENhdGVnb3J5IGZpbHRlcmluZwoJCQlpZiAoKGxpc3QgPSBmaWx0ZXIuZmxhZ3Mub25seSkgIT09IG51bGwpIHsKCQkJCWZvciAoaSA9IDAsIGlpID0gbGlzdC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJaWYgKGxpc3RbaV0gPT09IGNhdGVnb3J5KSBicmVhazsKCQkJCX0KCQkJCWlmIChpID49IGlpKSByZXR1cm4gbnVsbDsKCQkJfQoJCQlpZiAoKGxpc3QgPSBmaWx0ZXIuZmxhZ3Mubm90KSAhPT0gbnVsbCkgewoJCQkJZm9yIChpID0gMCwgaWkgPSBsaXN0Lmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQlpZiAobGlzdFtpXSA9PT0gY2F0ZWdvcnkpIHJldHVybiBudWxsOwoJCQkJfQoJCQl9CgoJCQkvLyBUZXh0IGZpbHRlcgoJCQltID0gZmlsdGVyLnJlZ2V4LmV4ZWModGV4dCk7CgkJCXJldHVybiAobSA9PT0gbnVsbCkgPyBudWxsIDogbmV3IE1hdGNoKG0uaW5kZXgsIG0uaW5kZXggKyBtWzBdLmxlbmd0aCwgZmlsdGVyKTsKCQl9OwoJCXZhciBobF9yZXR1cm4gPSBmdW5jdGlvbiAoYmFkLCBub2RlKSB7CgkJCWlmIChiYWQpIHsKCQkJCW5vZGUuY2xhc3NMaXN0LmFkZCgieGwtZmlsdGVyLWJhZCIpOwoJCQkJcmV0dXJuIFN0YXR1cy5CYWQ7CgkJCX0KCQkJZWxzZSB7CgkJCQlub2RlLmNsYXNzTGlzdC5hZGQoInhsLWZpbHRlci1nb29kIik7CgkJCQlyZXR1cm4gU3RhdHVzLkdvb2Q7CgkJCX0KCQl9OwoJCXZhciBpbml0X2ZpbHRlcnMgPSBmdW5jdGlvbiAoKSB7CgkJCWFjdGl2ZV9maWx0ZXJzID0gY29uZmlnLmZpbHRlci5lbmFibGVkID8gcGFyc2UoY29uZmlnLmZpbHRlci5maWx0ZXJzLCAwKSA6IFtdOwoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciBwYXJzZSA9IGZ1bmN0aW9uIChpbnB1dCwgc3RhcnRfcHJpb3JpdHkpIHsKCQkJdmFyIGZpbHRlcnMgPSBbXSwKCQkJCWxpbmVzID0gKGlucHV0IHx8ICIiKS5zcGxpdCgiXG4iKSwKCQkJCWksIHBvcywgcG9zMiwgZmxhZ3MsIGxpbmUsIHJlZ2V4OwoKCQkJaWYgKHN0YXJ0X3ByaW9yaXR5ID09PSB1bmRlZmluZWQpIHN0YXJ0X3ByaW9yaXR5ID0gKGFjdGl2ZV9maWx0ZXJzID09PSBudWxsID8gMCA6IGFjdGl2ZV9maWx0ZXJzLmxlbmd0aCk7CgoJCQlmb3IgKGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyArK2kpIHsKCQkJCWxpbmUgPSBsaW5lc1tpXS50cmltKCk7CgkJCQlpZiAobGluZS5sZW5ndGggPT09IDApIGNvbnRpbnVlOwoJCQkJaWYgKGxpbmVbMF0gPT09ICIvIiAmJiAocG9zID0gbGluZS5sYXN0SW5kZXhPZigiLyIpKSA+IDApIHsKCQkJCQkrK3BvczsKCQkJCQlwb3MyID0gbGluZS5pbmRleE9mKCI7IiwgcG9zKTsKCgkJCQkJcmVnZXggPSBsaW5lLnN1YnN0cigxLCBwb3MgLSAyKTsKCQkJCQlpZiAocG9zMiA+PSAwKSB7CgkJCQkJCWZsYWdzID0gbGluZS5zdWJzdHIocG9zLCBwb3MyIC0gcG9zKTsKCQkJCQkJcG9zID0gcG9zMiArIDE7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlmbGFncyA9IGxpbmUuc3Vic3RyKHBvcyk7CgkJCQkJCXBvcyA9IGxpbmUubGVuZ3RoOwoJCQkJCX0KCQkJCQlyZWdleCA9IGNyZWF0ZV9yZWdleChyZWdleCwgZmxhZ3MpOwoKCQkJCQlpZiAocmVnZXggIT09IG51bGwpIHsKCQkJCQkJZmxhZ3MgPSBjcmVhdGVfZmxhZ3MobGluZS5zdWJzdHIocG9zKSk7CgkJCQkJCWZpbHRlcnMucHVzaChuZXcgRmlsdGVyKHJlZ2V4LCBmbGFncywgc3RhcnRfcHJpb3JpdHkpKTsKCQkJCQkJKytzdGFydF9wcmlvcml0eTsKCQkJCQl9CgkJCQl9CgkJCQllbHNlIGlmIChsaW5lWzBdICE9PSAiIyIpIHsKCQkJCQlpZiAoKHBvcyA9IGxpbmUuaW5kZXhPZigiOyIpKSA+IDApIHsKCQkJCQkJcmVnZXggPSBsaW5lLnN1YnN0cigwLCBwb3MpOwoJCQkJCQlmbGFncyA9IGNyZWF0ZV9mbGFncyhsaW5lLnN1YnN0cihwb3MpKTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXJlZ2V4ID0gbGluZTsKCQkJCQkJZmxhZ3MgPSBjcmVhdGVfZmxhZ3MoIiIpOwoJCQkJCX0KCQkJCQlyZWdleCA9IG5ldyBSZWdFeHAoJC5yZWdleF9lc2NhcGUocmVnZXgpLCAiaWciKTsKCgkJCQkJZmlsdGVycy5wdXNoKG5ldyBGaWx0ZXIocmVnZXgsIGZsYWdzLCBzdGFydF9wcmlvcml0eSkpOwoJCQkJCSsrc3RhcnRfcHJpb3JpdHk7CgkJCQl9CgkJCX0KCgkJCXJldHVybiBmaWx0ZXJzOwoJCX07CgkJdmFyIGhpZ2hsaWdodCA9IGZ1bmN0aW9uICh0eXBlLCBub2RlLCBkYXRhLCBpbnB1dF9zdGF0ZSwgcmVzdWx0cywgZXh0cmFzKSB7CgkJCWlmIChhY3RpdmVfZmlsdGVycyA9PT0gbnVsbCkgaW5pdF9maWx0ZXJzKCk7CgoJCQl2YXIgbm9fZXh0cmFzID0gdHJ1ZSwKCQkJCWZpbHRlcnMgPSBhY3RpdmVfZmlsdGVycywKCQkJCWNhdGVnb3J5ID0gQVBJLmdldF9jYXRlZ29yeShkYXRhLmNhdGVnb3J5KS5zaG9ydF9uYW1lLAoJCQkJc2l0ZV90eXBlID0gZGF0YS50eXBlLAoJCQkJY2FjaGVfa2V5ID0gc2l0ZV90eXBlICsgIl8iICsgY2F0ZWdvcnksCgkJCQlpbmZvLCBtYXRjaGVzLCB0ZXh0LCBmcmFnLCBzZWdtZW50LCBjYWNoZV90eXBlLCBiYWQsIGMsIGksIHQsIG4xLCBuMjsKCgkJCWlmIChleHRyYXMgJiYgZXh0cmFzLmxlbmd0aCA+IDApIHsKCQkJCWZpbHRlcnMgPSBmaWx0ZXJzLmNvbmNhdChleHRyYXMpOwoJCQkJbm9fZXh0cmFzID0gZmFsc2U7CgkJCX0KCQkJaWYgKGZpbHRlcnMubGVuZ3RoID09PSAwKSB7CgkJCQlyZXR1cm4gU3RhdHVzLk5vbmU7CgkJCX0KCgkJCS8vIENhY2hlIGZvciB0YWdzCgkJCXRleHQgPSBub2RlLnRleHRDb250ZW50OwoJCQlpZiAoCgkJCQlub19leHRyYXMgJiYKCQkJCWlucHV0X3N0YXRlICE9PSBTdGF0dXMuQmFkICYmCgkJCQkoY2FjaGVfdHlwZSA9IGNhY2hlW3R5cGVdKSAhPT0gdW5kZWZpbmVkICYmCgkJCQkoYyA9IGNhY2hlX3R5cGVbY2FjaGVfa2V5XSkgIT09IHVuZGVmaW5lZCAmJgoJCQkJKGMgPSBjW3RleHRdKSAhPT0gdW5kZWZpbmVkCgkJCSkgewoJCQkJaWYgKGMgPT09IG51bGwpIHsKCQkJCQlyZXR1cm4gU3RhdHVzLk5vbmU7CgkJCQl9CgoJCQkJLy8gUmVzdWx0cwoJCQkJaWYgKHJlc3VsdHMgIT09IHVuZGVmaW5lZCkgewoJCQkJCWFwcGVuZF9tYXRjaF9kYXRhcyhjWzBdLCByZXN1bHRzKTsKCQkJCX0KCgkJCQkvLyBDbG9uZQoJCQkJbjEgPSBjWzFdLmNsb25lTm9kZSh0cnVlKTsKCQkJCW5vZGUuaW5uZXJIVE1MID0gIiI7CgkJCQl3aGlsZSAoKG4yID0gbjEuZmlyc3RDaGlsZCkgIT09IG51bGwpIHsKCQkJCQkkLmFkZChub2RlLCBuMik7CgkJCQl9CgkJCQlyZXR1cm4gaGxfcmV0dXJuKG4xLmNsYXNzTGlzdC5jb250YWlucygieGwtZmlsdGVyLWJhZCIpLCBub2RlKTsKCQkJfQoKCQkJLy8gQ2hlY2sgZmlsdGVycwoJCQlpbmZvID0gY2hlY2tfbXVsdGlwbGUodHlwZSwgdGV4dCwgZmlsdGVycywgY2F0ZWdvcnksIHNpdGVfdHlwZSk7CgkJCWlmICghaW5mby5hbnkpIHsKCQkJCWlmIChjYWNoZV90eXBlICE9PSB1bmRlZmluZWQpIHsKCQkJCQlpZiAoKGMgPSBjYWNoZV90eXBlW2NhY2hlX2tleV0pID09PSB1bmRlZmluZWQpIHsKCQkJCQkJY2FjaGVfdHlwZVtjYWNoZV9rZXldID0gYyA9IHt9OwoJCQkJCX0KCQkJCQljW3RleHRdID0gbnVsbDsKCQkJCX0KCQkJCXJldHVybiBTdGF0dXMuTm9uZTsKCQkJfQoKCQkJLy8gSWYgYmFkLCByZW1vdmUgYWxsIG5vbi1iYWQgZmlsdGVycwoJCQliYWQgPSAoaW5mby5iYWQgfHwgaW5wdXRfc3RhdGUgPT09IFN0YXR1cy5CYWQpOwoJCQlpZiAoYmFkKSB7CgkJCQlmb3IgKGkgPSAwOyBpIDwgaW5mby5tYXRjaGVzLmxlbmd0aDsgKSB7CgkJCQkJaWYgKCFpbmZvLm1hdGNoZXNbaV0uZmlsdGVyLmZsYWdzLmJhZCkgewoJCQkJCQlpbmZvLm1hdGNoZXMuc3BsaWNlKGksIDEpOwoJCQkJCQljb250aW51ZTsKCQkJCQl9CgkJCQkJKytpOwoJCQkJfQoJCQl9CgoJCQkvLyBSZXN1bHRzCgkJCWlmIChyZXN1bHRzICE9PSB1bmRlZmluZWQpIHsKCQkJCWFwcGVuZF9tYXRjaF9kYXRhcyhpbmZvLCByZXN1bHRzKTsKCQkJfQoKCQkJLy8gTWVyZ2UKCQkJbWF0Y2hlcyA9IG1hdGNoZXNfdG9fc2VnbWVudHModGV4dCwgaW5mby5tYXRjaGVzKTsKCgkJCWZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CgkJCWZvciAoaSA9IDA7IGkgPCBtYXRjaGVzLmxlbmd0aDsgKytpKSB7CgkJCQlzZWdtZW50ID0gbWF0Y2hlc1tpXTsKCQkJCXQgPSB0ZXh0LnN1YnN0cmluZyhzZWdtZW50LnN0YXJ0LCBzZWdtZW50LmVuZCk7CgkJCQlpZiAoc2VnbWVudC5kYXRhLmxlbmd0aCA9PT0gMCkgewoJCQkJCSQuYWRkKGZyYWcsICQudG5vZGUodCkpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJbjEgPSAkLm5vZGUoInNwYW4iLCAieGwtZmlsdGVyLXRleHQiKTsKCQkJCQluMiA9ICQubm9kZSgic3BhbiIsICJ4bC1maWx0ZXItdGV4dC1pbm5lciIsIHQpOwoJCQkJCSQuYWRkKG4xLCBuMik7CgkJCQkJJC5hZGQoZnJhZywgbjEpOwoJCQkJCWFwcGx5X3N0eWxlcyhuMSwgc2VnbWVudC5kYXRhKTsKCQkJCX0KCQkJfQoKCQkJLy8gUmVwbGFjZQoJCQlub2RlLmlubmVySFRNTCA9ICIiOwoJCQkkLmFkZChub2RlLCBmcmFnKTsKCQkJaWYgKGNhY2hlX3R5cGUgIT09IHVuZGVmaW5lZCkgewoJCQkJaWYgKChjID0gY2FjaGVfdHlwZVtjYWNoZV9rZXldKSA9PT0gdW5kZWZpbmVkKSB7CgkJCQkJY2FjaGVfdHlwZVtjYWNoZV9rZXldID0gYyA9IHt9OwoJCQkJfQoJCQkJY1t0ZXh0XSA9IFsgaW5mbywgbm9kZSBdOwoJCQl9CgkJCXJldHVybiBobF9yZXR1cm4oYmFkLCBub2RlKTsKCQl9OwoJCXZhciBoaWdobGlnaHRfdGFnID0gZnVuY3Rpb24gKG5vZGUsIGxpbmssIGZpbHRlcl9kYXRhKSB7CgkJCWlmIChmaWx0ZXJfZGF0YVswXSA9PT0gU3RhdHVzLkJhZCkgewoJCQkJbm9kZS5jbGFzc0xpc3QuYWRkKCJ4bC1maWx0ZXItYmFkIik7CgkJCQlsaW5rLmNsYXNzTGlzdC5hZGQoInhsLWZpbHRlci1iYWQiKTsKCQkJCWxpbmsuY2xhc3NMaXN0LnJlbW92ZSgieGwtZmlsdGVyLWdvb2QiKTsKCQkJfQoJCQllbHNlIHsKCQkJCW5vZGUuY2xhc3NMaXN0LmFkZCgieGwtZmlsdGVyLWdvb2QiKTsKCQkJCWxpbmsuY2xhc3NMaXN0LmFkZCgieGwtZmlsdGVyLWdvb2QiKTsKCQkJfQoKCQkJLy8gR2V0IHN0eWxlcwoJCQl2YXIgY29sb3IgPSBudWxsLAoJCQkJYmFja2dyb3VuZCA9IG51bGwsCgkJCQl1bmRlcmxpbmUgPSBudWxsLAoJCQkJcDEgPSAtMSwKCQkJCXAyID0gLTEsCgkJCQlwMyA9IC0xLAoJCQkJbiwgbjEsIG4yOwoKCQkJdmFyIGdldF9zdHlsZSA9IGZ1bmN0aW9uIChzdHlsZXMpIHsKCQkJCXZhciBzdHlsZSwgaSwgaWksIHAsIHM7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IHN0eWxlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJcCA9IHN0eWxlc1tpXS5wcmlvcml0eTsKCQkJCQlzdHlsZSA9IHN0eWxlc1tpXS5mbGFnczsKCQkJCQlpZiAoKHMgPSBzdHlsZS5saW5rX2NvbG9yKSAhPT0gbnVsbCAmJiBwID49IHAxKSB7CgkJCQkJCWNvbG9yID0gczsKCQkJCQkJcDEgPSBwOwoJCQkJCX0KCQkJCQlpZiAoKHMgPSBzdHlsZS5saW5rX2JhY2tncm91bmQpICE9PSBudWxsICYmIHAgPj0gcDIpIHsKCQkJCQkJYmFja2dyb3VuZCA9IHM7CgkJCQkJCXAyID0gcDsKCQkJCQl9CgkJCQkJaWYgKChzID0gc3R5bGUubGlua191bmRlcmxpbmUpICE9PSBudWxsICYmIHAgPj0gcDMpIHsKCQkJCQkJdW5kZXJsaW5lID0gczsKCQkJCQkJcDMgPSBwOwoJCQkJCX0KCQkJCX0KCQkJfTsKCgkJCWdldF9zdHlsZShmaWx0ZXJfZGF0YVsxXS51cGxvYWRlcik7CgkJCWdldF9zdHlsZShmaWx0ZXJfZGF0YVsxXS50aXRsZSk7CgkJCWdldF9zdHlsZShmaWx0ZXJfZGF0YVsxXS50YWdzKTsKCgkJCS8vIEFwcGx5IHN0eWxlcwoJCQlpZiAoCgkJCQkoY29sb3IgIT09IG51bGwgfHwgYmFja2dyb3VuZCAhPT0gbnVsbCB8fCB1bmRlcmxpbmUgIT09IG51bGwpICYmCgkJCQkobm9kZSA9IFVJLmdldF9zaXRlX3RhZ190ZXh0X25vZGUobm9kZSkpICE9PSBudWxsCgkJCSkgewoJCQkJbjEgPSAkLm5vZGUoInNwYW4iLCAieGwtZmlsdGVyLXRleHQiKTsKCQkJCW4yID0gJC5ub2RlKCJzcGFuIiwgInhsLWZpbHRlci10ZXh0LWlubmVyIik7CgkJCQl3aGlsZSAoKG4gPSBub2RlLmZpcnN0Q2hpbGQpICE9PSBudWxsKSB7CgkJCQkJJC5hZGQobjIsIG4pOwoJCQkJfQoJCQkJJC5hZGQobjEsIG4yKTsKCQkJCSQuYWRkKG5vZGUsIG4xKTsKCQkJCWFwcGx5X3N0eWxpbmcobjEsIGNvbG9yLCBiYWNrZ3JvdW5kLCB1bmRlcmxpbmUpOwoJCQl9CgkJfTsKCQl2YXIgY2hlY2sgPSBmdW5jdGlvbiAodGl0bGVub2RlLCBkYXRhLCBleHRyYXMpIHsKCQkJaWYgKGFjdGl2ZV9maWx0ZXJzID09PSBudWxsKSBpbml0X2ZpbHRlcnMoKTsKCgkJCXZhciBmaWx0ZXJzID0gYWN0aXZlX2ZpbHRlcnMsCgkJCQlzdGF0dXMgPSBTdGF0dXMuTm9uZSwKCQkJCWNhdGVnb3J5ID0gQVBJLmdldF9jYXRlZ29yeShkYXRhLmNhdGVnb3J5KS5zaG9ydF9uYW1lLAoJCQkJc2l0ZV90eXBlID0gZGF0YS50eXBlLAoJCQkJc3RyLCB0YWdzLCByZXN1bHQsIGksIGluZm87CgoJCQlpZiAoZXh0cmFzICYmIGV4dHJhcy5sZW5ndGggPiAwKSB7CgkJCQlmaWx0ZXJzID0gZmlsdGVycy5jb25jYXQoZXh0cmFzKTsKCQkJfQoKCQkJcmVzdWx0ID0gewoJCQkJdGFnczogW10sCgkJCQl1cGxvYWRlcjogW10sCgkJCQl0aXRsZTogW10sCgkJCX07CgoJCQkvLyBUaXRsZQoJCQlpZiAoZmlsdGVycy5sZW5ndGggPiAwKSB7CgkJCQkvLyBVcGxvYWRlcgoJCQkJaWYgKChzdHIgPSBkYXRhLnVwbG9hZGVyKSkgewoJCQkJCWluZm8gPSBjaGVja19tdWx0aXBsZSgidXBsb2FkZXIiLCBzdHIsIGZpbHRlcnMsIGNhdGVnb3J5LCBzaXRlX3R5cGUpOwoJCQkJCWlmIChpbmZvLmFueSkgewoJCQkJCQlhcHBlbmRfbWF0Y2hfZGF0YXMoaW5mbywgcmVzdWx0LnVwbG9hZGVyKTsKCQkJCQkJaWYgKGluZm8uYmFkKSB7CgkJCQkJCQlzdGF0dXMgPSBTdGF0dXMuQmFkOwoJCQkJCQl9CgkJCQkJCWVsc2UgaWYgKHN0YXR1cyA9PT0gU3RhdHVzLk5vbmUpIHsKCQkJCQkJCXN0YXR1cyA9IFN0YXR1cy5Hb29kOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFRhZ3MKCQkJCWlmICgodGFncyA9IGRhdGEudGFncykgJiYgdGFncy5sZW5ndGggPiAwKSB7CgkJCQkJZm9yIChpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyArK2kpIHsKCQkJCQkJaW5mbyA9IGNoZWNrX211bHRpcGxlKCJ0YWdzIiwgdGFnc1tpXSwgZmlsdGVycywgY2F0ZWdvcnksIHNpdGVfdHlwZSk7CgkJCQkJCWlmIChpbmZvLmFueSkgewoJCQkJCQkJYXBwZW5kX21hdGNoX2RhdGFzKGluZm8sIHJlc3VsdC50YWdzKTsKCQkJCQkJCWlmIChpbmZvLmJhZCkgewoJCQkJCQkJCXN0YXR1cyA9IFN0YXR1cy5CYWQ7CgkJCQkJCQl9CgkJCQkJCQllbHNlIGlmIChzdGF0dXMgPT09IFN0YXR1cy5Ob25lKSB7CgkJCQkJCQkJc3RhdHVzID0gU3RhdHVzLkdvb2Q7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9CgkJCQkJLy8gUmVtb3ZlIGR1cHMKCQkJCQlyZXN1bHQudGFncyA9IHJlc3VsdC50YWdzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSwgcG9zLCBzZWxmKSB7CgkJCQkJCXJldHVybiAoc2VsZi5pbmRleE9mKGl0ZW0pID09PSBwb3MpOwoJCQkJCX0pOwoJCQkJfQoJCQl9CgoJCQlpID0gaGlnaGxpZ2h0KCJ0aXRsZSIsIHRpdGxlbm9kZSwgZGF0YSwgc3RhdHVzLCByZXN1bHQudGl0bGUsIGV4dHJhcyk7CgkJCWlmIChzdGF0dXMgPT09IFN0YXR1cy5Ob25lIHx8IGkgPT09IFN0YXR1cy5CYWQpIHsKCQkJCXN0YXR1cyA9IGk7CgkJCX0KCgkJCS8vIFJlbW92ZSBub24tYmFkIGZpbHRlcnMgb24gcmVzdWx0LnRhZ3MgYW5kIHJlc3VsdC51cGxvYWRlcgoJCQlpZiAoc3RhdHVzID09PSBTdGF0dXMuQmFkKSB7CgkJCQlyZW1vdmVfbm9uX2JhZChyZXN1bHQudXBsb2FkZXIpOwoJCQkJcmVtb3ZlX25vbl9iYWQocmVzdWx0LnRhZ3MpOwoJCQl9CgoJCQlyZXR1cm4gWyBzdGF0dXMgLCAoc3RhdHVzID09PSBTdGF0dXMuTm9uZSA/IG51bGwgOiByZXN1bHQpIF07CgkJfTsKCgkJLy8gRXhwb3J0CgkJcmV0dXJuIHsKCQkJTm9uZTogU3RhdHVzLk5vbmUsCgkJCUJhZDogU3RhdHVzLkJhZCwKCQkJR29vZDogU3RhdHVzLkdvb2QsCgkJCXBhcnNlOiBwYXJzZSwKCQkJY2hlY2s6IGNoZWNrLAoJCQloaWdobGlnaHQ6IGhpZ2hsaWdodCwKCQkJaGlnaGxpZ2h0X3RhZzogaGlnaGxpZ2h0X3RhZwoJCX07CgoJfSkoKTsKCXZhciBUaGVtZSA9IChmdW5jdGlvbiAoKSB7CgoJCS8vIFByaXZhdGUKCQl2YXIgY3VycmVudCA9ICJsaWdodCIsCgkJCXBvc3RfYmcgPSAiI2ZmZmZmZiIsCgkJCXBvc3RfYmdfb3BhYyA9ICJyZ2JhKDI1NSwyNTUsMjU1LCI7CgoJCXZhciB0b19oZXgyID0gZnVuY3Rpb24gKG4pIHsKCQkJbiA9IG4udG9TdHJpbmcoMTYpOwoJCQlpZiAobi5sZW5ndGggPCAyKSBuID0gIjAiICsgbjsKCQkJcmV0dXJuIG47CgkJfTsKCQl2YXIgZGV0ZWN0ID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgYm9keSA9IGRvY3VtZW50LmJvZHksCgkJCQluID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksCgkJCQljb2xvciwgY29sb3JzLCBpLCBqLCBhLCBhX2ludjsKCgkJCWlmICghYm9keSkgcmV0dXJuIG51bGw7CgoJCQlpZiAoQ29uZmlnLmlzX2lwYikgewoJCQkJbi5jbGFzc05hbWUgPSAicG9zdDIiOwoJCQl9CgkJCWVsc2UgaWYgKENvbmZpZy5pc19pcGJfbG9maSkgewoJCQkJbi5jbGFzc05hbWUgPSAicG9zdHRvcGJhciI7CgkJCX0KCQkJZWxzZSB7CgkJCQluLmNsYXNzTmFtZSA9ICJwb3N0IHJlcGx5IHBvc3Rfd3JhcHBlciI7CgkJCX0KCQkJJC5hZGQoYm9keSwgbik7CgoJCQljb2xvciA9IHBhcnNlX2Nzc19jb2xvcihnZXRfY29tcHV0ZWRfc3R5bGUoZG9jdW1lbnRfZWxlbWVudCkuYmFja2dyb3VuZENvbG9yKTsKCQkJY29sb3JzID0gWwoJCQkJcGFyc2VfY3NzX2NvbG9yKGdldF9jb21wdXRlZF9zdHlsZShib2R5KS5iYWNrZ3JvdW5kQ29sb3IpLAoJCQkJcGFyc2VfY3NzX2NvbG9yKGdldF9jb21wdXRlZF9zdHlsZShuKS5iYWNrZ3JvdW5kQ29sb3IpLAoJCQldOwoKCQkJZm9yIChpID0gMDsgaSA8IGNvbG9ycy5sZW5ndGg7ICsraSkgewoJCQkJYSA9IGNvbG9yc1tpXVszXTsKCQkJCWFfaW52ID0gKDEuMCAtIGEpICogY29sb3JbM107CgoJCQkJZm9yIChqID0gMDsgaiA8IDM7ICsraikgewoJCQkJCWNvbG9yW2pdID0gKGNvbG9yW2pdICogYV9pbnYgKyBjb2xvcnNbaV1bal0gKiBhKTsKCQkJCX0KCQkJCWNvbG9yWzNdID0gTWF0aC5tYXgoY29sb3JbM10sIGEpOwoJCQl9CgoJCQlib2R5LnJlbW92ZUNoaWxkKG4pOwoKCQkJaWYgKGNvbG9yWzNdID09PSAwKSByZXR1cm4gbnVsbDsKCgkJCXJldHVybiBbCgkJCQkoY29sb3JbMF0gKyBjb2xvclsxXSArIGNvbG9yWzJdIDwgMzg0KSA/ICJkYXJrIiA6ICJsaWdodCIsCgkJCQkiIyIgKyB0b19oZXgyKGNvbG9yc1sxXVswXSkgKyB0b19oZXgyKGNvbG9yc1sxXVsxXSkgKyB0b19oZXgyKGNvbG9yc1sxXVsyXSksCgkJCQkicmdiYSgiICsgY29sb3JzWzFdWzBdICsgIiwiICsgY29sb3JzWzFdWzFdICsgIiwiICsgY29sb3JzWzFdWzJdICsgIiwiCgkJCV07CgkJfTsKCQl2YXIgdXBkYXRlID0gZnVuY3Rpb24gKGNoYW5nZV9ub2RlcykgewoJCQl2YXIgbmV3X3RoZW1lID0gZGV0ZWN0KCk7CgkJCWlmIChuZXdfdGhlbWUgIT09IG51bGwpIHsKCQkJCWlmIChuZXdfdGhlbWVbMF0gIT09IGN1cnJlbnQpIHsKCQkJCQlpZiAoY2hhbmdlX25vZGVzKSB1cGRhdGVfbm9kZXMobmV3X3RoZW1lKTsKCQkJCQljdXJyZW50ID0gbmV3X3RoZW1lWzBdOwoJCQkJCVRoZW1lLmNsYXNzZXMgPSAoY3VycmVudCA9PT0gImxpZ2h0IiA/ICIgeGwtdGhlbWUiIDogIiB4bC10aGVtZSB4bC10aGVtZS1kYXJrIik7CgkJCQl9CgkJCQlpZiAobmV3X3RoZW1lWzFdICE9PSBwb3N0X2JnKSB7CgkJCQkJcG9zdF9iZyA9IG5ld190aGVtZVsxXTsKCQkJCQlwb3N0X2JnX29wYWMgPSBuZXdfdGhlbWVbMl07CgkJCQkJaWYgKGNoYW5nZV9ub2RlcykgdXBkYXRlX25vZGVzX2JnKCk7CgkJCQl9CgkJCQl0cmlnZ2VyKGV2ZW50X2xpc3RlbmVycy50aGVtZV9jaGFuZ2UsIG51bGwpOwoJCQkJcmV0dXJuIHRydWU7CgkJCX0KCQkJcmV0dXJuIGZhbHNlOwoJCX07CgkJdmFyIHVwZGF0ZV9ub2RlcyA9IGZ1bmN0aW9uIChuZXdfdGhlbWUpIHsKCQkJdmFyIG5vZGVzID0gJCQoIi54bC10aGVtZSIpLAoJCQkJaWkgPSBub2Rlcy5sZW5ndGgsCgkJCQljbHMsIGk7CgkJCWlmIChuZXdfdGhlbWUgPT09ICJsaWdodCIpIHsKCQkJCWNscyA9ICJ4bC10aGVtZS0iICsgY3VycmVudDsKCQkJCWZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7CgkJCQkJbm9kZXNbaV0uY2xhc3NMaXN0LnJlbW92ZShjbHMpOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJY2xzID0gInhsLXRoZW1lLSIgKyBuZXdfdGhlbWU7CgkJCQlmb3IgKGkgPSAwOyBpIDwgaWk7ICsraSkgewoJCQkJCW5vZGVzW2ldLmNsYXNzTGlzdC5hZGQoY2xzKTsKCQkJCX0KCQkJfQoJCX07CgkJdmFyIHVwZGF0ZV9ub2Rlc19iZyA9IGZ1bmN0aW9uICgpIHsKCQkJdmFyIG5vZGVzID0gJCQoIi54bC10aGVtZS1wb3N0LWJnIiksCgkJCQlvcGFjaXR5LCBub2RlLCBpLCBpaTsKCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlub2RlID0gbm9kZXNbaV07CgkJCQlvcGFjaXR5ID0gbm9kZS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtdGhlbWUtcG9zdC1iZy1vcGFjaXR5Iik7CgkJCQlub2RlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IChvcGFjaXR5ID8gcG9zdF9iZ19vcGFjICsgb3BhY2l0eSArICIpIiA6IHBvc3RfYmcpOwoJCQl9CgkJfTsKCgkJdmFyIG9uX2hlYWRfbXV0YXRlID0gZnVuY3Rpb24gKHJlY29yZHMpIHsKCQkJdmFyIG5vZGVzLCBub2RlLCB0YWcsIGksIGlpLCBqLCBqajsKCgkJCWZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlpZiAoKG5vZGVzID0gcmVjb3Jkc1tpXS5hZGRlZE5vZGVzKSkgewoJCQkJCWZvciAoaiA9IDAsIGpqID0gbm9kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewoJCQkJCQlub2RlID0gbm9kZXNbal07CgkJCQkJCXRhZyA9IG5vZGUudGFnTmFtZTsKCQkJCQkJaWYgKHRhZyA9PT0gIlNUWUxFIiB8fCAodGFnID09PSAiTElOSyIgJiYgKC9cYnN0eWxlc2hlZXRcYi8pLnRlc3Qobm9kZS5yZWwpKSkgewoJCQkJCQkJdXBkYXRlKHRydWUpOwoJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQkJaWYgKChub2RlcyA9IHJlY29yZHNbaV0ucmVtb3ZlZE5vZGVzKSkgewoJCQkJCWZvciAoaiA9IDAsIGpqID0gbm9kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewoJCQkJCQlub2RlID0gbm9kZXNbal07CgkJCQkJCXRhZyA9IG5vZGUudGFnTmFtZTsKCQkJCQkJaWYgKHRhZyA9PT0gIlNUWUxFIiB8fCAodGFnID09PSAiTElOSyIgJiYgKC9cYnN0eWxlc2hlZXRcYi8pLnRlc3Qobm9kZS5yZWwpKSkgewoJCQkJCQkJdXBkYXRlKHRydWUpOwoJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCgkJLy8gUHVibGljCgkJdmFyIHJlYWR5ID0gZnVuY3Rpb24gKCkgewoJCQlpZiAoQ29uZmlnLmlzX21lZ3VjYSkgewoJCQkJcmV0dXJuOwoJCQl9CgkJCXVwZGF0ZShmYWxzZSk7CgoJCQlpZiAoZG9jdW1lbnQuaGVhZCkgewoJCQkJbmV3IE11dGF0aW9uT2JzZXJ2ZXIob25faGVhZF9tdXRhdGUpLm9ic2VydmUoZG9jdW1lbnQuaGVhZCwgeyBjaGlsZExpc3Q6IHRydWUgfSk7CgkJCX0KCQl9OwoJCXZhciBiZyA9IGZ1bmN0aW9uIChub2RlLCBvcGFjaXR5KSB7CgkJCWlmIChDb25maWcuaXNfbWVndWNhKSB7CgkJCQlyZXR1cm4gbm9kZS5jbGFzc0xpc3QuYWRkKCJwb3B1cC1tZW51IiwgImdsYXNzIik7CgkJCX0KCQkJbm9kZS5jbGFzc0xpc3QuYWRkKCJ4bC10aGVtZS1wb3N0LWJnIik7CgkJCWlmIChvcGFjaXR5ID09PSB1bmRlZmluZWQgfHwgb3BhY2l0eSA9PT0gMSkgewoJCQkJbm9kZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBwb3N0X2JnOwoJCQkJbm9kZS5yZW1vdmVBdHRyaWJ1dGUoImRhdGEteGwtdGhlbWUtcG9zdC1iZy1vcGFjaXR5Iik7CgkJCX0KCQkJZWxzZSB7CgkJCQlub2RlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IHBvc3RfYmdfb3BhYyArIG9wYWNpdHkgKyAiKSI7CgkJCQlub2RlLnNldEF0dHJpYnV0ZSgiZGF0YS14bC10aGVtZS1wb3N0LWJnLW9wYWNpdHkiLCBvcGFjaXR5KTsKCQkJfQoJCX07CgkJdmFyIGFwcGx5ID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJaWYgKGN1cnJlbnQgIT09ICJsaWdodCIpIHsKCQkJCXZhciBub2RlcyA9ICQkKCIueGwtdGhlbWUiLCBub2RlKSwKCQkJCQlpLCBpaTsKCgkJCQlmb3IgKGkgPSAwLCBpaSA9IG5vZGVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQlub2Rlc1tpXS5jbGFzc0xpc3QuYWRkKCJ4bC10aGVtZS1kYXJrIik7CgkJCQl9CgoJCQkJaWYgKG5vZGUuY2xhc3NMaXN0ICYmIG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC10aGVtZSIpKSB7CgkJCQkJbm9kZS5jbGFzc0xpc3QuYWRkKCJ4bC10aGVtZS1kYXJrIik7CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBnZXRfY29tcHV0ZWRfc3R5bGUgPSBmdW5jdGlvbiAobm9kZSkgewoJCQl2YXIgczsKCQkJdHJ5IHsKCQkJCS8vIERvbid0IHVzZSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZTogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTUzODY1MAoJCQkJcyA9IGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUobm9kZSk7CgkJCX0KCQkJY2F0Y2ggKGUpIHt9CgkJCWlmICghcykgewoJCQkJcyA9IG5vZGUuc3R5bGUgfHwge307CgkJCX0KCQkJcmV0dXJuIHM7CgkJfTsKCQl2YXIgcGFyc2VfY3NzX2NvbG9yID0gZnVuY3Rpb24gKGNvbG9yKSB7CgkJCWlmIChjb2xvciAmJiBjb2xvciAhPT0gInRyYW5zcGFyZW50IikgewoJCQkJdmFyIG07CgkJCQlpZiAoKG0gPSAvXnJnYmE/XChccyooWzAtOV0rKVxzKixccyooWzAtOV0rKVxzKixccyooWzAtOV0rKVxzKig/OixccyooWzAtOVwuXSspXHMqKT9cKSQvLmV4ZWMoY29sb3IpKSkgewoJCQkJCXJldHVybiBbCgkJCQkJCXBhcnNlSW50KG1bMV0sIDEwKSwKCQkJCQkJcGFyc2VJbnQobVsyXSwgMTApLAoJCQkJCQlwYXJzZUludChtWzNdLCAxMCksCgkJCQkJCW1bNF0gPT09IHVuZGVmaW5lZCA/IDEgOiBwYXJzZUZsb2F0KG1bNF0pCgkJCQkJXTsKCQkJCX0KCQkJCWVsc2UgaWYgKChtID0gL14jKFswLTlhLWZBLUZdezMsfSkkLy5leGVjKGNvbG9yKSkpIHsKCQkJCQlpZiAoKG0gPSBtWzFdKS5sZW5ndGggPT09IDYpIHsKCQkJCQkJcmV0dXJuIFsKCQkJCQkJCXBhcnNlSW50KG0uc3Vic3RyKDAsIDIpLCAxNiksCgkJCQkJCQlwYXJzZUludChtLnN1YnN0cigyLCAyKSwgMTYpLAoJCQkJCQkJcGFyc2VJbnQobS5zdWJzdHIoNCwgMiksIDE2KSwKCQkJCQkJCTEKCQkJCQkJXTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXJldHVybiBbCgkJCQkJCQlwYXJzZUludChtWzBdLCAxNiksCgkJCQkJCQlwYXJzZUludChtWzFdLCAxNiksCgkJCQkJCQlwYXJzZUludChtWzJdLCAxNiksCgkJCQkJCQkxCgkJCQkJCV07CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlyZXR1cm4gWyAwICwgMCAsIDAgLCAwIF07CgkJfTsKCgkJLy8gRXZlbnRzCgkJdmFyIGV2ZW50X2xpc3RlbmVycyA9IHsKCQkJdGhlbWVfY2hhbmdlOiBbXQoJCX07CgkJdmFyIG9uID0gZnVuY3Rpb24gKGV2ZW50X25hbWUsIGNhbGxiYWNrKSB7CgkJCXZhciBsaXN0ZW5lcnMgPSBldmVudF9saXN0ZW5lcnNbZXZlbnRfbmFtZV07CgkJCWlmIChsaXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlOwoJCQlsaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7CgkJCXJldHVybiB0cnVlOwoJCX07CgkJdmFyIG9mZiA9IGZ1bmN0aW9uIChldmVudF9uYW1lLCBjYWxsYmFjaykgewoJCQl2YXIgbGlzdGVuZXJzID0gZXZlbnRfbGlzdGVuZXJzW2V2ZW50X25hbWVdLAoJCQkJaSwgaWk7CgkJCWlmIChsaXN0ZW5lcnMgIT09IHVuZGVmaW5lZCkgewoJCQkJZm9yIChpID0gMCwgaWkgPSBsaXN0ZW5lcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCWlmIChsaXN0ZW5lcnNbaV0gPT09IGNhbGxiYWNrKSB7CgkJCQkJCWxpc3RlbmVycy5zcGxpY2UoaSwgMSk7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gZmFsc2U7CgkJfTsKCQl2YXIgdHJpZ2dlciA9IGZ1bmN0aW9uIChsaXN0ZW5lcnMsIGRhdGEpIHsKCQkJdmFyIGksIGlpOwoJCQlmb3IgKGkgPSAwLCBpaSA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlsaXN0ZW5lcnNbaV0uY2FsbChudWxsLCBkYXRhKTsKCQkJfQoJCX07CgoJCS8vIEV4cG9ydHMKCQl2YXIgTW9kdWxlID0gIHsKCQkJY2xhc3NlczogIiB4bC10aGVtZSIsCgkJCXJlYWR5OiByZWFkeSwKCQkJYmc6IGJnLAoJCQlhcHBseTogYXBwbHksCgkJCWdldF9jb21wdXRlZF9zdHlsZTogZ2V0X2NvbXB1dGVkX3N0eWxlLAoJCQlwYXJzZV9jc3NfY29sb3I6IHBhcnNlX2Nzc19jb2xvciwKCQkJb246IG9uLAoJCQlvZmY6IG9mZgoJCX07CgoJCXJldHVybiBNb2R1bGU7CgoJfSkoKTsKCXZhciBFYXN5TGlzdCA9IChmdW5jdGlvbiAoKSB7CgoJCXZhciBFbnRyeSA9IGZ1bmN0aW9uIChpbmZvLCBkYXRhKSB7CgkJCXRoaXMuaW5mbyA9IGluZm87CgkJCXRoaXMuZGF0YSA9IGRhdGE7CgkJCXRoaXMubm9kZSA9IG51bGw7CgkJCXRoaXMudXJsID0gIiMiOwoJCX07CgoJCS8vIFByaXZhdGUKCQl2YXIgc2V0dGluZ3Nfa2V5ID0gInhsaW5rcy1lYXN5bGlzdC1zZXR0aW5ncyIsCgkJCXBvcHVwID0gbnVsbCwKCQkJb3B0aW9uc19jb250YWluZXIgPSBudWxsLAoJCQllbXB0eV9ub3RpZmljYXRpb24gPSBudWxsLAoJCQljb250ZW50X2NvbnRhaW5lciA9IG51bGwsCgkJCWNvbnRlbnRfY3VycmVudCA9IDAsCgkJCWNvbnRlbnRzID0gW3sKCQkJCWVudHJpZXM6IFtdLAoJCQkJY29udGFpbmVyOiBudWxsLAoJCQkJdmlzaWJsZTogMAoJCQl9LCB7CgkJCQllbnRyaWVzOiBbXSwKCQkJCWNvbnRhaW5lcjogbnVsbCwKCQkJCXZpc2libGU6IDAKCQkJfV0sCgkJCXF1ZXVlID0gW10sCgkJCWRhdGFfbWFwID0ge30sCgkJCXF1ZXVlX3RpbWVyID0gbnVsbCwKCQkJY3VzdG9tX2ZpbHRlcnMgPSBbXSwKCQkJY3VzdG9tX2xpbmtzID0gW10sCgkJCWN1c3RvbV9saW5rc19tYXAgPSB7fSwKCQkJY3VzdG9tX2xpbmtzX3RleHQgPSAiIiwKCQkJbm9kZV9zb3J0X29yZGVyX2tleXMgPSB7CgkJCQl0aHJlYWQ6IFsgImRhdGEteGwtaW5kZXgiLCAxIF0sCgkJCQl1cGxvYWQ6IFsgImRhdGEteGwtZGF0ZS1jcmVhdGVkIiwgLTEgXSwKCQkJCXJhdGluZzogWyAiZGF0YS14bC1yYXRpbmciLCAtMSBdCgkJCX0sCgkJCWRpc3BsYXlfbW9kZV9uYW1lcyA9IFsKCQkJCSJmdWxsIiwKCQkJCSJjb21wYWN0IiwKCQkJCSJtaW5pbWFsIgoJCQldLAoJCQlzZXR0aW5ncyA9IHsKCQkJCXNvcnRfYnk6ICJ0aHJlYWQiLAoJCQkJZ3JvdXBfYnlfY2F0ZWdvcnk6IGZhbHNlLAoJCQkJZ3JvdXBfYnlfZmlsdGVyczogZmFsc2UsCgkJCQljdXN0b21fZmlsdGVyczogIiMgQ3VzdG9tIGZpbHRlcnMgZm9sbG93IHRoZSBzYW1lIHJ1bGVzIGFzIHN0YW5kYXJkIGZpbHRlcnNcbiIsCgkJCQlkaXNwbGF5X21vZGU6IDAsIC8vIDAgPSBmdWxsLCAxID0gY29tcGFjdCwgMiA9IG1pbmltYWwKCQkJCWZpbHRlcl92aXNpYmlsaXR5OiAwIC8vIDAgPSBzaG93IGFsbCwgMSA9IGhpZGUgYmFkLCAyID0gb25seSBzaG93IG1hdGNoZXMKCQkJfTsKCgkJdmFyIHNldHRpbmdzX3NhdmUgPSBmdW5jdGlvbiAoKSB7CgkJCUNvbmZpZy5zdG9yYWdlLnNldEl0ZW0oc2V0dGluZ3Nfa2V5LCBKU09OLnN0cmluZ2lmeShzZXR0aW5ncykpOwoJCX07CgkJdmFyIHNldHRpbmdzX2xvYWQgPSBmdW5jdGlvbiAoKSB7CgkJCS8vIExvYWQKCQkJdmFyIHZhbHVlID0gZ2V0X3NhdmVkX3NldHRpbmdzKCksCgkJCQlrOwoKCQkJaWYgKHZhbHVlICE9PSBudWxsICYmIHR5cGVvZih2YWx1ZSkgPT09ICJvYmplY3QiKSB7CgkJCQlmb3IgKGsgaW4gc2V0dGluZ3MpIHsKCQkJCQlpZiAoCgkJCQkJCU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzZXR0aW5ncywgaykgJiYKCQkJCQkJT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBrKSAmJgoJCQkJCQl0eXBlb2Yoc2V0dGluZ3Nba10pID09PSB0eXBlb2YodmFsdWVba10pCgkJCQkJKSB7CgkJCQkJCXNldHRpbmdzW2tdID0gdmFsdWVba107CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBMb2FkIGZpbHRlcnMKCQkJbG9hZF9maWx0ZXJzKCk7CgkJfTsKCQl2YXIgY3JlYXRlID0gZnVuY3Rpb24gKCkgewoJCQlwb3B1cCA9IFBvcHVwLmNyZWF0ZSgiZWFzeWxpc3QiLCBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQl2YXIgdGhlbWUgPSBUaGVtZS5jbGFzc2VzLAoJCQkJCW4xLCBuMjsKCgkJCQkvLyBPdmVybGF5CgkJCQkkLmFkZChjb250YWluZXIsIG4xID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtdGl0bGUiKSk7CgoJCQkJJC5hZGQobjEsICQubm9kZSgic3BhbiIsICJ4bC1lYXN5bGlzdC10aXRsZS10ZXh0IiwgTWFpbi50aXRsZSArICIgRWFzeSBMaXN0IikpOwoJCQkJJC5hZGQobjEsICQubm9kZSgic3BhbiIsICJ4bC1lYXN5bGlzdC1zdWJ0aXRsZSIsICJNb3JlIHBvcm4sIGxlc3MgaGFzc2xlIikpOwoKCQkJCS8vIENsb3NlCgkJCQkkLmFkZChjb250YWluZXIsIG4xID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtY29udHJvbC1saW5rcyIpKTsKCgkJCQkkLmFkZChuMSwgbjIgPSAkLmxpbmsoIiMiLCAieGwtZWFzeWxpc3QtY29udHJvbC1saW5rIHhsLWVhc3lsaXN0LWNvbnRyb2wtbGluay1yYW5kb20iLCAicmFuZG9tIikpOwoJCQkJJC5vbihuMiwgIm1vdXNlb3ZlciIsIG9uX3JhbmRvbV9saW5rX2dlbmVyYXRlKTsKCQkJCSQub24objIsICJtb3VzZXVwIiwgb25fcmFuZG9tX2xpbmtfZ2VuZXJhdGVfZGVsYXllZCk7CgoJCQkJJC5hZGQobjEsIG4yID0gJC5saW5rKHVuZGVmaW5lZCwgInhsLWVhc3lsaXN0LWNvbnRyb2wtbGluayB4bC1lYXN5bGlzdC1jb250cm9sLWxpbmstb3B0aW9ucyIsICJvcHRpb25zIikpOwoJCQkJJC5vbihuMiwgImNsaWNrIiwgb25fb3B0aW9uc19jbGljayk7CgoJCQkJJC5hZGQobjEsIG4yID0gJC5saW5rKHVuZGVmaW5lZCwgInhsLWVhc3lsaXN0LWNvbnRyb2wtbGluayIsICJjbG9zZSIpKTsKCQkJCSQub24objIsICJjbGljayIsIG9uX2Nsb3NlX2NsaWNrKTsKCgkJCQkkLmFkZChjb250YWluZXIsICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LXRpdGxlLWxpbmUiKSk7CgoJCQkJLy8gU2V0dGluZ3MKCQkJCW9wdGlvbnNfY29udGFpbmVyID0gY3JlYXRlX29wdGlvbnModGhlbWUpOwoJCQkJJC5hZGQoY29udGFpbmVyLCBvcHRpb25zX2NvbnRhaW5lcik7CgoJCQkJLy8gRW1wdHkgbm90aWZpY2F0aW9uCgkJCQllbXB0eV9ub3RpZmljYXRpb24gPSAkLm5vZGUoImRpdiIsCgkJCQkJInhsLWVhc3lsaXN0LWVtcHR5LW5vdGlmaWNhdGlvbiB4bC1lYXN5bGlzdC1lbXB0eS1ub3RpZmljYXRpb24tdmlzaWJsZSIsCgkJCQkJIk5vIGdhbGxlcmllcyBmb3VuZCIKCQkJCSk7CgkJCQkkLmFkZChjb250YWluZXIsIGVtcHR5X25vdGlmaWNhdGlvbik7CgoJCQkJLy8gSXRlbXMgbGlzdAoJCQkJY29udGVudHNbMF0uY29udGFpbmVyID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbXMiICsgdGhlbWUpOwoJCQkJY29udGVudHNbMV0uY29udGFpbmVyID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbXMiICsgdGhlbWUpOwoJCQkJJC5hZGQoY29udGFpbmVyLCBjb250ZW50c1tjb250ZW50X2N1cnJlbnRdLmNvbnRhaW5lcik7CgoJCQkJY29udGVudF9jb250YWluZXIgPSBjb250YWluZXI7CgkJCX0pOwoKCQkJJC5vbihwb3B1cCwgImNsaWNrIiwgb25fb3ZlcmxheV9jbGljayk7CgoJCQkvLyBTZXR1cAoJCQl1cGRhdGVfZGlzcGxheV9tb2RlKHRydWUpOwoJCX07CgkJdmFyIGNyZWF0ZV9vcHRpb25zID0gZnVuY3Rpb24gKHRoZW1lKSB7CgkJCXZhciBmbiwgbjEsIG4yLCBuMywgbjQsIG41OwoKCQkJbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb25zIik7CgkJCSQuYWRkKG4xLCBuMiA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi10YWJsZSIpKTsKCgoJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tcm93IikpOwoJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tY2VsbCIpKTsKCQkJJC5hZGQobjQsICQubm9kZSgic3BhbiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tdGl0bGUiLCAiU29ydCBieToiKSk7CgoJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tY2VsbCIpKTsKCgkJCWZuID0gZnVuY3Rpb24gKHZhbHVlLCB0ZXh0KSB7CgkJCQl2YXIgbjEgPSAkLm5vZGUoImxhYmVsIiwgInhsLWVhc3lsaXN0LW9wdGlvbi1sYWJlbCIpLAoJCQkJCW4yID0gJC5ub2RlKCJpbnB1dCIsICJ4bC1lYXN5bGlzdC1vcHRpb24taW5wdXQiKTsKCgkJCQluMi5uYW1lID0gInhsLWVhc3lsaXN0LW9wdGlvbnMtc29ydC1ieSI7CgkJCQluMi50eXBlID0gInJhZGlvIjsKCQkJCW4yLmNoZWNrZWQgPSAoc2V0dGluZ3Muc29ydF9ieSA9PT0gdmFsdWUpOwoJCQkJbjIudmFsdWUgPSB2YWx1ZTsKCgkJCQkkLmFkZChuMSwgbjIpOwoJCQkJJC5hZGQobjEsICQubm9kZSgic3BhbiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tYnV0dG9uIiArIHRoZW1lLCB0ZXh0KSk7CgoJCQkJJC5vbihuMiwgImNoYW5nZSIsIG9uX29wdGlvbl9jaGFuZ2Uuc29ydF9ieSk7CgoJCQkJcmV0dXJuIG4xOwoJCQl9OwoJCQkkLmFkZChuNCwgZm4oInRocmVhZCIsICJBcHBlYXJhbmNlIGluIHRocmVhZCIpKTsKCQkJJC5hZGQobjQsIGZuKCJ1cGxvYWQiLCAiVXBsb2FkIGRhdGUiKSk7CgkJCSQuYWRkKG40LCBmbigicmF0aW5nIiwgIlJhdGluZyIpKTsKCgkJCSQuYWRkKG4yLCBuMyA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi1yb3ciKSk7CgkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi1jZWxsIikpOwoJCQkkLmFkZChuNCwgJC5ub2RlKCJzcGFuIiwgInhsLWVhc3lsaXN0LW9wdGlvbi10aXRsZSIsICJHcm91cCBieToiKSk7CgoJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tY2VsbCIpKTsKCgkJCWZuID0gZnVuY3Rpb24gKGNoZWNrZWQsIHRleHQsIGNoYW5nZV9mbikgewoJCQkJdmFyIG4xID0gJC5ub2RlKCJsYWJlbCIsICJ4bC1lYXN5bGlzdC1vcHRpb24tbGFiZWwiKSwKCQkJCQluMiA9ICQubm9kZSgiaW5wdXQiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLWlucHV0Iik7CgoJCQkJbjIudHlwZSA9ICJjaGVja2JveCI7CgkJCQluMi5jaGVja2VkID0gY2hlY2tlZDsKCgkJCQkkLmFkZChuMSwgbjIpOwoJCQkJJC5hZGQobjEsICQubm9kZSgic3BhbiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tYnV0dG9uIiArIHRoZW1lLCB0ZXh0KSk7CgoJCQkJJC5vbihuMiwgImNoYW5nZSIsIGNoYW5nZV9mbik7CgoJCQkJcmV0dXJuIG4xOwoJCQl9OwoJCQkkLmFkZChuNCwgZm4oc2V0dGluZ3MuZ3JvdXBfYnlfZmlsdGVycywgIkZpbHRlcnMiLCBvbl9vcHRpb25fY2hhbmdlLmdyb3VwX2J5X2ZpbHRlcnMpKTsKCQkJJC5hZGQobjQsIGZuKHNldHRpbmdzLmdyb3VwX2J5X2NhdGVnb3J5LCAiQ2F0ZWdvcnkiLCBvbl9vcHRpb25fY2hhbmdlLmdyb3VwX2J5X2NhdGVnb3J5KSk7CgoKCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXJvdyIpKTsKCQkJJC5hZGQobjMsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLWNlbGwiKSk7CgkJCSQuYWRkKG40LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXRpdGxlIiwgIkRpc3BsYXkgbW9kZToiKSk7CgoJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tY2VsbCIpKTsKCgkJCWZuID0gZnVuY3Rpb24gKHZhbHVlLCB0ZXh0KSB7CgkJCQl2YXIgbjEgPSAkLm5vZGUoImxhYmVsIiwgInhsLWVhc3lsaXN0LW9wdGlvbi1sYWJlbCIpLAoJCQkJCW4yID0gJC5ub2RlKCJpbnB1dCIsICJ4bC1lYXN5bGlzdC1vcHRpb24taW5wdXQiKTsKCgkJCQluMi5uYW1lID0gInhsLWVhc3lsaXN0LW9wdGlvbnMtZGlzcGxheSI7CgkJCQluMi50eXBlID0gInJhZGlvIjsKCQkJCW4yLmNoZWNrZWQgPSAoc2V0dGluZ3MuZGlzcGxheV9tb2RlID09PSB2YWx1ZSk7CgkJCQluMi52YWx1ZSA9ICIiICsgdmFsdWU7CgoJCQkJJC5hZGQobjEsIG4yKTsKCQkJCSQuYWRkKG4xLCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3Qtb3B0aW9uLWJ1dHRvbiIgKyB0aGVtZSwgdGV4dCkpOwoKCQkJCSQub24objIsICJjaGFuZ2UiLCBvbl9vcHRpb25fY2hhbmdlLmRpc3BsYXlfbW9kZSk7CgoJCQkJcmV0dXJuIG4xOwoJCQl9OwoJCQkkLmFkZChuNCwgZm4oMCwgIkZ1bGwiKSk7CgkJCSQuYWRkKG40LCBmbigxLCAiQ29tcGFjdCIpKTsKCQkJJC5hZGQobjQsIGZuKDIsICJNaW5pbWFsIikpOwoKCgkJCSQuYWRkKG4yLCBuMyA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi1yb3ciKSk7CgkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi1jZWxsIikpOwoJCQkkLmFkZChuNCwgJC5ub2RlKCJzcGFuIiwgInhsLWVhc3lsaXN0LW9wdGlvbi10aXRsZSIsICJGaWx0ZXIgdmlzaWJpbGl0eToiKSk7CgoJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1vcHRpb24tY2VsbCIpKTsKCgkJCWZuID0gZnVuY3Rpb24gKHZhbHVlLCB0ZXh0KSB7CgkJCQl2YXIgbjEgPSAkLm5vZGUoImxhYmVsIiwgInhsLWVhc3lsaXN0LW9wdGlvbi1sYWJlbCIpLAoJCQkJCW4yID0gJC5ub2RlKCJpbnB1dCIsICJ4bC1lYXN5bGlzdC1vcHRpb24taW5wdXQiKTsKCgkJCQluMi5uYW1lID0gInhsLWVhc3lsaXN0LW9wdGlvbnMtZmlsdGVyLXZpc2liaWxpdHkiOwoJCQkJbjIudHlwZSA9ICJyYWRpbyI7CgkJCQluMi5jaGVja2VkID0gKHNldHRpbmdzLmZpbHRlcl92aXNpYmlsaXR5ID09PSB2YWx1ZSk7CgkJCQluMi52YWx1ZSA9ICIiICsgdmFsdWU7CgoJCQkJJC5hZGQobjEsIG4yKTsKCQkJCSQuYWRkKG4xLCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3Qtb3B0aW9uLWJ1dHRvbiIgKyB0aGVtZSwgdGV4dCkpOwoKCQkJCSQub24objIsICJjaGFuZ2UiLCBvbl9vcHRpb25fY2hhbmdlLmZpbHRlcl92aXNpYmlsaXR5KTsKCgkJCQlyZXR1cm4gbjE7CgkJCX07CgkJCSQuYWRkKG40LCBmbigwLCAiU2hvdyBhbGwiKSk7CgkJCSQuYWRkKG40LCBmbigxLCAiSGlkZSBiYWQiKSk7CgkJCSQuYWRkKG40LCBmbigyLCAiT25seSBzaG93IG1hdGNoZXMiKSk7CgoKCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXJvdyIpKTsKCQkJJC5hZGQobjMsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLWNlbGwiKSk7CgkJCSQuYWRkKG40LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXRpdGxlIiwgIkN1c3RvbSBmaWx0ZXJzOiIpKTsKCgkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi1jZWxsIikpOwoKCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJ0ZXh0YXJlYSIsICJ4bC1lYXN5bGlzdC1vcHRpb24tdGV4dGFyZWEiICsgdGhlbWUpKTsKCQkJbjUudmFsdWUgPSBzZXR0aW5ncy5jdXN0b21fZmlsdGVyczsKCQkJbjUud3JhcCA9ICJvZmYiOwoJCQluNS5zcGVsbGNoZWNrID0gZmFsc2U7CgkJCSQub24objUsICJjaGFuZ2UiLCBvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9maWx0ZXJzKTsKCQkJJC5vbihuNSwgImlucHV0Iiwgb25fb3B0aW9uX2NoYW5nZS5jdXN0b21fZmlsdGVyc19pbnB1dCk7CgoKCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXJvdyIpKTsKCQkJJC5hZGQobjMsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLWNlbGwiKSk7CgkJCSQuYWRkKG40LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXRpdGxlIiwgIkN1c3RvbSBsaW5rczoiKSk7CgkJCSQuYWRkKG40LCAkLm5vZGVfc2ltcGxlKCJiciIpKTsKCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3Qtb3B0aW9uLXRpdGxlLXN1YiIpKTsKCQkJJC5hZGQobjUsICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi10aXRsZS1zdWItdGV4dCIsICJEaXNwbGF5IGEgbGlzdCBvZiBsaW5rcyBmcm9tIGFuIGV4dGVybmFsIHNvdXJjZSIpKTsKCgkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LW9wdGlvbi1jZWxsIikpOwoKCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJ0ZXh0YXJlYSIsICJ4bC1lYXN5bGlzdC1vcHRpb24tdGV4dGFyZWEiICsgdGhlbWUpKTsKCQkJbjUudmFsdWUgPSBjdXN0b21fbGlua3NfdGV4dDsKCQkJbjUud3JhcCA9ICJvZmYiOwoJCQluNS5zcGVsbGNoZWNrID0gZmFsc2U7CgkJCSQub24objUsICJjaGFuZ2UiLCBvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9saW5rcyk7CgkJCSQub24objUsICJpbnB1dCIsIG9uX29wdGlvbl9jaGFuZ2UuY3VzdG9tX2xpbmtzX2lucHV0KTsKCgkJCSQuYWRkKG4xLCAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC10aXRsZS1saW5lIikpOwoKCQkJcmV0dXJuIG4xOwoJCX07CgkJdmFyIGNyZWF0ZV9nYWxsZXJ5X25vZGVzID0gZnVuY3Rpb24gKGRhdGEsIGluZGV4LCBpbmZvKSB7CgkJCXZhciBjYXRlZ29yeSA9IEFQSS5nZXRfY2F0ZWdvcnkoZGF0YS5jYXRlZ29yeSksCgkJCQlkb21haW4gPSBpbmZvLmRvbWFpbiwKCQkJCXVybCA9IENyZWF0ZVVSTC50b19nYWxsZXJ5KGRhdGEsIGRvbWFpbiksCgkJCQl0aGVtZSA9IFRoZW1lLmNsYXNzZXMsCgkJCQluMSwgbjIsIG4zLCBuNCwgbjUsIG42LCBuNywgaSwgdDsKCgkJCW4xID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbSIgKyB0aGVtZSk7CgkJCW4xLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1pZCIsIGluZm8uaWQpOwoJCQluMS5zZXRBdHRyaWJ1dGUoImRhdGEteGwtaW5kZXgiLCBpbmRleCk7CgkJCW4xLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1yYXRpbmciLCBkYXRhLnJhdGluZyk7CgkJCW4xLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1kYXRlLWNyZWF0ZWQiLCBkYXRhLmRhdGVfY3JlYXRlZCk7CgkJCW4xLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1jYXRlZ29yeSIsIGRhdGEuY2F0ZWdvcnkpOwoKCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS10YWJsZS1jb250YWluZXIiICsgdGhlbWUpKTsKCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS10YWJsZSIgKyB0aGVtZSkpOwoJCQluMiA9IG4zOwoJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLXJvdyIgKyB0aGVtZSkpOwoJCQkkLmFkZChuMywgbjQgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLWNlbGwgeGwtZWFzeWxpc3QtaXRlbS1jZWxsLWltYWdlIiArIHRoZW1lKSk7CgoJCQkvLyBJbWFnZQoJCQkkLmFkZChuNCwgbjUgPSAkLmxpbmsodXJsLCAieGwtZWFzeWxpc3QtaXRlbS1pbWFnZS1jb250YWluZXIiICsgdGhlbWUpKTsKCgkJCSQuYWRkKG41LCBuNiA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LWl0ZW0taW1hZ2Utb3V0ZXIiICsgdGhlbWUpKTsKCgkJCWlmIChkYXRhLnRodW1ibmFpbCAhPT0gbnVsbCkgewoJCQkJJC5hZGQobjYsIG43ID0gJC5ub2RlKCJpbWciLCAieGwtZWFzeWxpc3QtaXRlbS1pbWFnZSIgKyB0aGVtZSkpOwoJCQkJJC5vbihuNywgImVycm9yIiwgb25fdGh1bWJuYWlsX2Vycm9yKTsKCQkJCW43LmFsdCA9ICIiOwoKCQkJCUFQSS5nZXRfdGh1bWJuYWlsKGRhdGEudGh1bWJuYWlsLCBkYXRhLmZsYWdzLCAkLmJpbmQoZnVuY3Rpb24gKGVyciwgdXJsKSB7CgkJCQkJaWYgKGVyciA9PT0gbnVsbCkgewoJCQkJCQl0aGlzLnNyYyA9IHVybDsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXZhciBwYXIgPSB0aGlzLnBhcmVudE5vZGU7CgkJCQkJCWlmIChwYXIgIT09IG51bGwpIHsKCQkJCQkJCXBhci5zdHlsZS53aWR0aCA9ICIxMDAlIjsKCQkJCQkJCXBhci5zdHlsZS5oZWlnaHQgPSAiMTAwJSI7CgkJCQkJCX0KCQkJCQl9CgkJCQl9LCBuNykpOwoJCQl9CgkJCWVsc2UgewoJCQkJbjYuc3R5bGUud2lkdGggPSAiMTAwJSI7CgkJCQluNi5zdHlsZS5oZWlnaHQgPSAiMTAwJSI7CgkJCX0KCgkJCSQuYWRkKG42LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS1pbWFnZS1pbmRleCIgKyB0aGVtZSwgIiMiICsgKGluZGV4ICsgMSkpKTsKCgoJCQkvLyBNYWluIGNvbnRlbnQKCQkJJC5hZGQobjMsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS1jZWxsIiArIHRoZW1lKSk7CgoJCQkkLmFkZChuNCwgbjUgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLXRpdGxlIiArIHRoZW1lKSk7CgoJCQl0ID0gVUkuY3JlYXRlX3NpdGVfdGFnX3RleHQoaW5mbyk7CgkJCSQuYWRkKG41LCBuNiA9ICQubGluayh1cmwsICJ4bC1lYXN5bGlzdC1pdGVtLXRpdGxlLXRhZy1saW5rIiArIHRoZW1lKSk7CgkJCSQuYWRkKG42LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS10aXRsZS10YWctbGluay10ZXh0IiwgdCkpOwoJCQluNi5zZXRBdHRyaWJ1dGUoImRhdGEteGwtb3JpZ2luYWwiLCB0KTsKCgkJCSQuYWRkKG41LCBuNiA9ICQubGluayh1cmwsICJ4bC1lYXN5bGlzdC1pdGVtLXRpdGxlLWxpbmsiICsgdGhlbWUsIGRhdGEudGl0bGUpKTsKCQkJbjYuc2V0QXR0cmlidXRlKCJkYXRhLXhsLW9yaWdpbmFsIiwgbjYudGV4dENvbnRlbnQpOwoKCQkJaWYgKGRhdGEudGl0bGVfanBuICE9PSBudWxsKSB7CgkJCQkkLmFkZChuNCwgbjUgPSAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS10aXRsZS1qcCIgKyB0aGVtZSwgZGF0YS50aXRsZV9qcG4pKTsKCQkJCW41LnNldEF0dHJpYnV0ZSgiZGF0YS14bC1vcmlnaW5hbCIsIG41LnRleHRDb250ZW50KTsKCQkJfQoKCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS11cGxvYWQtaW5mbyIgKyB0aGVtZSkpOwoJCQkkLmFkZChuNSwgJC50bm9kZSgiVXBsb2FkZWQgYnkgIikpOwoJCQkkLmFkZChuNSwgbjYgPSAkLmxpbmsoQ3JlYXRlVVJMLnRvX3VwbG9hZGVyKGRhdGEsIGRvbWFpbiksICJ4bC1lYXN5bGlzdC1pdGVtLXVwbG9hZGVyIiArIHRoZW1lLCBkYXRhLnVwbG9hZGVyKSk7CgkJCW42LnNldEF0dHJpYnV0ZSgiZGF0YS14bC1vcmlnaW5hbCIsIG42LnRleHRDb250ZW50KTsKCQkJJC5hZGQobjUsICQudG5vZGUoIiBvbiAiKSk7CgkJCSQuYWRkKG41LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS11cGxvYWQtZGF0ZSIgKyB0aGVtZSwgVUkuZm9ybWF0X2RhdGUoZGF0YS5kYXRlX2NyZWF0ZWQpKSk7CgoJCQkkLmFkZChuNCwgbjUgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLXRhZ3MiICsgdGhlbWUpKTsKCgkJCW42ID0gY3JlYXRlX2Z1bGxfdGFncyhkYXRhLCBpbmZvKTsKCQkJJC5hZGQobjUsIG42KTsKCQkJaWYgKCFkYXRhLmZ1bGwgJiYgZGF0YS50eXBlID09PSAiZWhlbnRhaSIpIHsKCQkJCSQub24objEsICJtb3VzZW92ZXIiLCBvbl9nYWxsZXJ5X21vdXNlb3Zlcik7CgkJCX0KCgoJCQkvLyBSaWdodCBzaWRlYmFyCgkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LWl0ZW0tY2VsbCB4bC1lYXN5bGlzdC1pdGVtLWNlbGwtc2lkZSIgKyB0aGVtZSkpOwoKCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS1pbmZvIiArIHRoZW1lKSk7CgoJCQkkLmFkZChuNSwgbjYgPSAkLmxpbmsoQ3JlYXRlVVJMLnRvX2NhdGVnb3J5KGRhdGEsIGRvbWFpbiksCgkJCQkieGwtZWFzeWxpc3QtaXRlbS1pbmZvLWJ1dHRvbiB4bC1idXR0b24geGwtYnV0dG9uLWVoIHhsLWJ1dHRvbiIgKyBjYXRlZ29yeS5jb2xvcl9pZCArIHRoZW1lCgkJCSkpOwoJCQkkLmFkZChuNiwgJC5ub2RlKCJkaXYiLCAieGwtbm9pc2UiLCBjYXRlZ29yeS5uYW1lKSk7CgoKCQkJJC5hZGQobjUsIG42ID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS1pbmZvLWl0ZW0geGwtZWFzeWxpc3QtaXRlbS1pbmZvLWl0ZW0tcmF0aW5nIiArIHRoZW1lKSk7CgkJCSQuYWRkKG42LCBuNyA9ICQubm9kZSgiZGl2IiwgInhsLXN0YXJzLWNvbnRhaW5lciIpKTsKCQkJJC5hZGQobjcsIFVJLmNyZWF0ZV9yYXRpbmdfc3RhcnMoZGF0YS5yYXRpbmcpKTsKCQkJaWYgKGRhdGEucmF0aW5nID49IDApIHsKCQkJCSQuYWRkKG42LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS1pbmZvLWxpZ2h0IiwgIihBdmc6ICIgKyBkYXRhLnJhdGluZy50b0ZpeGVkKDIpICsgIikiKSk7CgkJCX0KCQkJZWxzZSB7CgkJCQluNy5jbGFzc0xpc3QuYWRkKCJ4bC1zdGFycy1jb250YWluZXItbmEiKTsKCQkJCSQuYWRkKG42LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS1pbmZvLWxpZ2h0IiwgIihuL2EpIikpOwoJCQl9CgoJCQlpID0gZGF0YS5maWxlX2NvdW50OwoJCQlpZiAoaSA+PSAwKSB7CgkJCQkkLmFkZChuNSwgbjYgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLWluZm8taXRlbSB4bC1lYXN5bGlzdC1pdGVtLWluZm8taXRlbS1maWxlcyIgKyB0aGVtZSkpOwoJCQkJJC5hZGQobjYsICQubm9kZSgic3BhbiIsICIiLCBpICsgIiBpbWFnZSIgKyAoaSA9PT0gMSA/ICIiIDogInMiKSkpOwoJCQkJaWYgKGRhdGEudG90YWxfc2l6ZSA+PSAwKSB7CgkJCQkJJC5hZGQobjYsICQubm9kZV9zaW1wbGUoImJyIikpOwoJCQkJCWkgPSAoZGF0YS50b3RhbF9zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMikucmVwbGFjZSgvXC4/MCskLywgIiIpOwoJCQkJCSQuYWRkKG42LCAkLm5vZGUoInNwYW4iLCAieGwtZWFzeWxpc3QtaXRlbS1pbmZvLWxpZ2h0IiwgIigiICsgaSArICIgTUIpIikpOwoJCQkJfQoJCQl9CgoJCQkvLyBIaWdobGlnaHQKCQkJdXBkYXRlX2ZpbHRlcnMobjEsIGRhdGEsIHRydWUsIGZhbHNlKTsKCgkJCXJldHVybiBbIG4xLCB1cmwgXTsKCQl9OwoJCXZhciBjcmVhdGVfZnVsbF90YWdzID0gZnVuY3Rpb24gKGRhdGEsIGluZm8pIHsKCQkJdmFyIHRoZW1lID0gVGhlbWUuY2xhc3NlcywKCQkJCW4xID0gJC5ub2RlKCJkaXYiLCAieGwtZWFzeWxpc3QtaXRlbS10YWctdGFibGUiICsgdGhlbWUpLAoJCQkJZG9tYWluX3R5cGUgPSBkYXRhLnR5cGUsCgkJCQlkb21haW4gPSBpbmZvLmRvbWFpbiwKCQkJCW5hbWVzcGFjZV9zdHlsZSA9ICIiLAoJCQkJYWxsX3RhZ3MsIG5hbWVzcGFjZSwgdGFncywgbjIsIG4zLCBuNCwgaSwgaWksIGVtcHR5X25zOwoKCQkJaWYgKGRhdGEudGFnc19ucyAhPT0gbnVsbCkgewoJCQkJYWxsX3RhZ3MgPSBkYXRhLnRhZ3NfbnM7CgkJCX0KCQkJZWxzZSB7CgkJCQlhbGxfdGFncyA9IHsgIiI6IGRhdGEudGFncyB9OwoJCQl9CgoJCQlmb3IgKG5hbWVzcGFjZSBpbiBhbGxfdGFncykgewoJCQkJdGFncyA9IGFsbF90YWdzW25hbWVzcGFjZV07CgkJCQllbXB0eV9ucyA9IChuYW1lc3BhY2UubGVuZ3RoID09PSAwKTsKCgkJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLXRhZy1yb3ciICsgdGhlbWUpKTsKCgkJCQlpZiAoIWVtcHR5X25zKSB7CgkJCQkJbmFtZXNwYWNlX3N0eWxlID0gIiB4bC10YWctbmFtZXNwYWNlLSIgKyBuYW1lc3BhY2UucmVwbGFjZSgvXCAvZywgIi0iKSArIHRoZW1lOwoJCQkJCSQuYWRkKG4yLCBuMyA9ICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LWl0ZW0tdGFnLWNlbGwgeGwtZWFzeWxpc3QtaXRlbS10YWctY2VsbC1sYWJlbCIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgic3BhbiIsICJ4bC10YWctbmFtZXNwYWNlLWJsb2NrIHhsLXRhZy1uYW1lc3BhY2UtYmxvY2stbm8tb3V0bGluZSIgKyBuYW1lc3BhY2Vfc3R5bGUpKTsKCQkJCQkkLmFkZChuNCwgJC5ub2RlKCJzcGFuIiwgInhsLXRhZy1uYW1lc3BhY2UtbGFiZWwiLCBuYW1lc3BhY2UpKTsKCQkJCQkkLmFkZChuMywgJC50bm9kZSgiOiIpKTsKCQkJCX0KCgkJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLXRhZy1jZWxsIiArIHRoZW1lKSk7CgkJCQluMiA9IG4zOwoKCQkJCWZvciAoaSA9IDAsIGlpID0gdGFncy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJJC5hZGQobjIsIG4zID0gJC5ub2RlKCJzcGFuIiwgInhsLXRhZy1ibG9jayIgKyBuYW1lc3BhY2Vfc3R5bGUpKTsKCQkJCQkkLmFkZChuMywgbjQgPSAkLmxpbmsoCgkJCQkJCWVtcHR5X25zID8gQ3JlYXRlVVJMLnRvX3RhZyh0YWdzW2ldLCBkb21haW5fdHlwZSwgZG9tYWluKSA6IENyZWF0ZVVSTC50b190YWdfbnModGFnc1tpXSwgbmFtZXNwYWNlLCBkb21haW5fdHlwZSwgZG9tYWluKSwKCQkJCQkJInhsLXRhZyB4bC10YWctY29sb3ItaW5oZXJpdCB4bC1lYXN5bGlzdC1pdGVtLXRhZyIsCgkJCQkJCXRhZ3NbaV0KCQkJCQkpKTsKCQkJCQluNC5zZXRBdHRyaWJ1dGUoImRhdGEteGwtb3JpZ2luYWwiLCBuNC50ZXh0Q29udGVudCk7CgoJCQkJCWlmIChpIDwgaWkgLSAxKSAkLmFkZChuMywgJC50bm9kZSgiLCIpKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIG4xOwoJCX07CgkJdmFyIGFkZF9nYWxsZXJ5X3VwZGF0ZV90aW1lciA9IG51bGw7CgkJdmFyIGFkZF9nYWxsZXJ5ID0gZnVuY3Rpb24gKGNvbnRlbnRfaW5kZXgsIGVudHJ5LCBpbmRleCwgZm9yY2VfcmVvcmRlcikgewoJCQl2YXIgaW5mbyA9IGVudHJ5LmluZm8sCgkJCQlkYXRhID0gZW50cnkuZGF0YSwKCQkJCXVybCwgbjsKCgkJCWlmIChkYXRhLnN1YnR5cGUgPT09ICJnYWxsZXJ5IikgewoJCQkJbiA9IGNyZWF0ZV9nYWxsZXJ5X25vZGVzKGRhdGEsIGluZGV4LCBpbmZvKTsKCQkJCXVybCA9IG5bMV07CgkJCQluID0gblswXTsKCQkJCW4uc2V0QXR0cmlidXRlKCJkYXRhLXhsLWVhc3lsaXN0LWl0ZW0tcGFyaXR5IiwgKGNvbnRlbnRzW2NvbnRlbnRfaW5kZXhdLnZpc2libGUgJSAyKSA9PT0gMCA/ICJvZGQiIDogImV2ZW4iKTsKCgkJCQkvL01haW4uaW5zZXJ0X2N1c3RvbV9mb250cygpOwoKCQkJCSQuYWRkKGNvbnRlbnRzW2NvbnRlbnRfaW5kZXhdLmNvbnRhaW5lciwgbik7CgoJCQkJZW50cnkubm9kZSA9IG47CgkJCQllbnRyeS51cmwgPSB1cmw7CgkJCQljb250ZW50c1tjb250ZW50X2luZGV4XS5lbnRyaWVzLnB1c2goZW50cnkpOwoJCQkJKytjb250ZW50c1tjb250ZW50X2luZGV4XS52aXNpYmxlOwoKCQkJCWlmIChjb250ZW50X2luZGV4ID09PSBjb250ZW50X2N1cnJlbnQpIHsKCQkJCQlpZiAoCgkJCQkJCWZvcmNlX3Jlb3JkZXIgfHwKCQkJCQkJc2V0dGluZ3MuZ3JvdXBfYnlfY2F0ZWdvcnkgfHwKCQkJCQkJc2V0dGluZ3MuZ3JvdXBfYnlfZmlsdGVycyB8fAoJCQkJCQlzZXR0aW5ncy5zb3J0X2J5ICE9PSAidGhyZWFkIiB8fAoJCQkJCQlzZXR0aW5ncy5maWx0ZXJfdmlzaWJpbGl0eSAhPT0gMAoJCQkJCSkgewoJCQkJCQlpZiAoYWRkX2dhbGxlcnlfdXBkYXRlX3RpbWVyICE9PSBudWxsKSBjbGVhclRpbWVvdXQoYWRkX2dhbGxlcnlfdXBkYXRlX3RpbWVyKTsKCQkJCQkJYWRkX2dhbGxlcnlfdXBkYXRlX3RpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCQkJCQl1cGRhdGVfb3JkZXJpbmcoKTsKCQkJCQkJfSwgMSk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQlzZXRfZW1wdHkoY29udGVudHNbY29udGVudF9pbmRleF0udmlzaWJsZSA9PT0gMCk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgc2V0X2VtcHR5ID0gZnVuY3Rpb24gKGVtcHR5KSB7CgkJCWlmIChlbXB0eV9ub3RpZmljYXRpb24gIT09IG51bGwpIHsKCQkJCXZhciBjbHMgPSAieGwtZWFzeWxpc3QtZW1wdHktbm90aWZpY2F0aW9uLXZpc2libGUiOwoJCQkJaWYgKGVtcHR5ICE9PSBlbXB0eV9ub3RpZmljYXRpb24uY2xhc3NMaXN0LmNvbnRhaW5zKGNscykpIHsKCQkJCQllbXB0eV9ub3RpZmljYXRpb24uY2xhc3NMaXN0LnRvZ2dsZShjbHMpOwoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgZ2V0X29wdGlvbnNfdmlzaWJsZSA9IGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIG9wdGlvbnNfY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygieGwtZWFzeWxpc3Qtb3B0aW9ucy12aXNpYmxlIik7CgkJfTsKCQl2YXIgc2V0X29wdGlvbnNfdmlzaWJsZSA9IGZ1bmN0aW9uICh2aXNpYmxlKSB7CgkJCXZhciBuID0gJCgiLnhsLWVhc3lsaXN0LWNvbnRyb2wtbGluay1vcHRpb25zIiwgcG9wdXApLAoJCQkJY2wsIGNsczsKCgkJCWlmIChuICE9PSBudWxsKSB7CgkJCQljbCA9IG4uY2xhc3NMaXN0OwoJCQkJY2xzID0gInhsLWVhc3lsaXN0LWNvbnRyb2wtbGluay1mb2N1cyI7CgkJCQlpZiAoY2wuY29udGFpbnMoY2xzKSAhPT0gdmlzaWJsZSkgY2wudG9nZ2xlKGNscyk7CgkJCX0KCgkJCWNsID0gb3B0aW9uc19jb250YWluZXIuY2xhc3NMaXN0OwoJCQljbHMgPSAieGwtZWFzeWxpc3Qtb3B0aW9ucy12aXNpYmxlIjsKCQkJaWYgKGNsLmNvbnRhaW5zKGNscykgIT09IHZpc2libGUpIGNsLnRvZ2dsZShjbHMpOwoJCX07CgoJCXZhciBnZXRfbm9kZV9maWx0ZXJfZ3JvdXAgPSBmdW5jdGlvbiAobm9kZSkgewoJCQl2YXIgdiA9IGdldF9ub2RlX2ZpbHRlcnNfYmFkKG5vZGUpOwoJCQlyZXR1cm4gKHYgPiAwKSA/IC12IDogZ2V0X25vZGVfZmlsdGVyc19nb29kKG5vZGUpOwoJCX07CgkJdmFyIGdldF9ub2RlX2ZpbHRlcnNfZ29vZCA9IGZ1bmN0aW9uIChub2RlKSB7CgkJCXJldHVybiAocGFyc2VJbnQobm9kZS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtZmlsdGVyLW1hdGNoZXMtdGl0bGUiKSwgMTApIHx8IDApICsKCQkJCShwYXJzZUludChub2RlLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1maWx0ZXItbWF0Y2hlcy11cGxvYWRlciIpLCAxMCkgfHwgMCkgKwoJCQkJKHBhcnNlSW50KG5vZGUuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLWZpbHRlci1tYXRjaGVzLXRhZ3MiKSwgMTApIHx8IDApOwoJCX07CgkJdmFyIGdldF9ub2RlX2ZpbHRlcnNfYmFkID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJcmV0dXJuIChwYXJzZUludChub2RlLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1maWx0ZXItbWF0Y2hlcy10aXRsZS1iYWQiKSwgMTApIHx8IDApICsKCQkJCShwYXJzZUludChub2RlLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1maWx0ZXItbWF0Y2hlcy11cGxvYWRlci1iYWQiKSwgMTApIHx8IDApICsKCQkJCShwYXJzZUludChub2RlLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1maWx0ZXItbWF0Y2hlcy10YWdzLWJhZCIpLCAxMCkgfHwgMCk7CgkJfTsKCQl2YXIgZ2V0X25vZGVfY2F0ZWdvcnlfZ3JvdXAgPSBmdW5jdGlvbiAobm9kZSkgewoJCQlyZXR1cm4gQVBJLmdldF9jYXRlZ29yeV9zb3J0X3Jhbmsobm9kZS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtY2F0ZWdvcnkiKSk7CgkJfTsKCQl2YXIgdXBkYXRlX2Rpc3BsYXlfbW9kZSA9IGZ1bmN0aW9uIChmaXJzdCkgewoJCQl2YXIgbW9kZSA9IGRpc3BsYXlfbW9kZV9uYW1lc1tzZXR0aW5ncy5kaXNwbGF5X21vZGVdIHx8ICIiLAoJCQkJY2wgPSBjb250ZW50X2NvbnRhaW5lci5jbGFzc0xpc3QsCgkJCQlpLCBpaTsKCgkJCWlmICghZmlyc3QpIHsKCQkJCWZvciAoaSA9IDAsIGlpID0gZGlzcGxheV9tb2RlX25hbWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQljbC5yZW1vdmUoInhsLWVhc3lsaXN0LSIgKyBkaXNwbGF5X21vZGVfbmFtZXNbaV0pOwoJCQkJfQoJCQl9CgoJCQljbC5hZGQoInhsLWVhc3lsaXN0LSIgKyBtb2RlKTsKCQl9OwoJCXZhciB1cGRhdGVfb3JkZXJpbmcgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBpdGVtcyA9IFtdLAoJCQkJbW9kZSA9IHNldHRpbmdzLnNvcnRfYnksCgkJCQl2aXNpYmlsaXR5ID0gc2V0dGluZ3MuZmlsdGVyX3Zpc2liaWxpdHksCgkJCQlzaG93ID0gdHJ1ZSwKCQkJCWNvbnRlbnRfaW5kZXggPSBjb250ZW50X2N1cnJlbnQsCgkJCQllbnRyaWVzID0gY29udGVudHNbY29udGVudF9pbmRleF0uZW50cmllcywKCQkJCWl0ZW1zX2NvbnRhaW5lciA9IGNvbnRlbnRzW2NvbnRlbnRfaW5kZXhdLmNvbnRhaW5lciwKCQkJCWN1cnJlbnRfdmlzaWJsZV9jb3VudCA9IDAsCgkJCQlvcmRlcmluZywgYmFzZV9hcnJheSwgaXRlbSwgYXR0ciwgbiwgbjIsIGksIGlpOwoKCQkJLy8gR3JvdXBpbmcKCQkJaWYgKHNldHRpbmdzLmdyb3VwX2J5X2ZpbHRlcnMpIHsKCQkJCWlmIChzZXR0aW5ncy5ncm91cF9ieV9jYXRlZ29yeSkgewoJCQkJCWJhc2VfYXJyYXkgPSBmdW5jdGlvbiAobm9kZSkgewoJCQkJCQlyZXR1cm4gWyBnZXRfbm9kZV9jYXRlZ29yeV9ncm91cChub2RlKSwgZ2V0X25vZGVfZmlsdGVyX2dyb3VwKG5vZGUpIF07CgkJCQkJfTsKCQkJCQlvcmRlcmluZyA9IFsgMSwgLTEgXTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCWJhc2VfYXJyYXkgPSBmdW5jdGlvbiAobm9kZSkgewoJCQkJCQlyZXR1cm4gWyBnZXRfbm9kZV9maWx0ZXJfZ3JvdXAobm9kZSkgXTsKCQkJCQl9OwoJCQkJCW9yZGVyaW5nID0gWyAtMSBdOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKHNldHRpbmdzLmdyb3VwX2J5X2NhdGVnb3J5KSB7CgkJCQliYXNlX2FycmF5ID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJCQlyZXR1cm4gWyBnZXRfbm9kZV9jYXRlZ29yeV9ncm91cChub2RlKSBdOwoJCQkJfTsKCQkJCW9yZGVyaW5nID0gWyAxIF07CgkJCX0KCQkJZWxzZSB7CgkJCQliYXNlX2FycmF5ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gW107IH07CgkJCQlvcmRlcmluZyA9IFtdOwoJCQl9CgoJCQkvLyBJdGVyYXRlCgkJCWF0dHIgPSBub2RlX3NvcnRfb3JkZXJfa2V5c1ttb2RlIGluIG5vZGVfc29ydF9vcmRlcl9rZXlzID8gbW9kZSA6ICJ0aHJlYWQiXTsKCQkJb3JkZXJpbmcucHVzaChhdHRyWzFdLCAxKTsKCQkJYXR0ciA9IGF0dHJbMF07CgkJCWZvciAoaSA9IDAsIGlpID0gZW50cmllcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQluID0gZW50cmllc1tpXS5ub2RlOwoJCQkJaXRlbSA9IHsKCQkJCQlvcmRlcjogYmFzZV9hcnJheShuKSwKCQkJCQlub2RlOiBuCgkJCQl9OwoJCQkJaXRlbS5vcmRlci5wdXNoKAoJCQkJCXBhcnNlRmxvYXQobi5nZXRBdHRyaWJ1dGUoYXR0cikpIHx8IDAsCgkJCQkJcGFyc2VGbG9hdChuLmdldEF0dHJpYnV0ZSgiZGF0YS14bC1pbmRleCIpKSB8fCAwCgkJCQkpOwoJCQkJaXRlbXMucHVzaChpdGVtKTsKCQkJfQoKCQkJLy8gU29ydAoJCQlpdGVtcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CgkJCQl2YXIgeCwgeSwgaSwgaWk7CgkJCQlhID0gYS5vcmRlcjsKCQkJCWIgPSBiLm9yZGVyOwoJCQkJZm9yIChpID0gMCwgaWkgPSBhLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQl4ID0gYVtpXTsKCQkJCQl5ID0gYltpXTsKCQkJCQlpZiAoeCA8IHkpIHJldHVybiAtb3JkZXJpbmdbaV07CgkJCQkJaWYgKHggPiB5KSByZXR1cm4gb3JkZXJpbmdbaV07CgkJCQl9CgkJCQlyZXR1cm4gMDsKCQkJfSk7CgoJCQkvLyBSZS1pbnNlcnQKCQkJLy8gTWF5YmUgZXZlbnR1YWxseSBhZGQgbGFiZWxzCgkJCWZvciAoaSA9IDAsIGlpID0gaXRlbXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJbiA9IGl0ZW1zW2ldLm5vZGU7CgkJCQluMiA9ICQoIi54bC1lYXN5bGlzdC1pdGVtLWltYWdlLWluZGV4Iiwgbik7CgoJCQkJJC5hZGQoaXRlbXNfY29udGFpbmVyLCBuKTsKCgkJCQlpZiAodmlzaWJpbGl0eSA9PT0gMSkgewoJCQkJCXNob3cgPSAoZ2V0X25vZGVfZmlsdGVyc19iYWQobikgPT09IDApOwoJCQkJfQoJCQkJZWxzZSBpZiAodmlzaWJpbGl0eSA9PT0gMikgewoJCQkJCXNob3cgPSAoZ2V0X25vZGVfZmlsdGVyc19iYWQobikgPT09IDAgJiYgZ2V0X25vZGVfZmlsdGVyc19nb29kKG4pID4gMCk7CgkJCQl9CgoJCQkJaWYgKHNob3cpIHsKCQkJCQluLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1lYXN5bGlzdC1pdGVtLXBhcml0eSIsIChjdXJyZW50X3Zpc2libGVfY291bnQgJSAyKSA9PT0gMCA/ICJvZGQiIDogImV2ZW4iKTsKCQkJCQluLmNsYXNzTGlzdC5yZW1vdmUoInhsLWVhc3lsaXN0LWl0ZW0taGlkZGVuIik7CgkJCQkJKytjdXJyZW50X3Zpc2libGVfY291bnQ7CgoJCQkJCWlmIChuMiAhPT0gbnVsbCkgbjIudGV4dENvbnRlbnQgPSAiIyIgKyBjdXJyZW50X3Zpc2libGVfY291bnQ7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQluLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1lYXN5bGlzdC1pdGVtLXBhcml0eSIsICJoaWRkZW4iKTsKCQkJCQluLmNsYXNzTGlzdC5hZGQoInhsLWVhc3lsaXN0LWl0ZW0taGlkZGVuIik7CgoJCQkJCWlmIChuMiAhPT0gbnVsbCkgbjIudGV4dENvbnRlbnQgPSAiIyI7CgkJCQl9CgkJCX0KCgkJCWNvbnRlbnRzW2NvbnRlbnRfaW5kZXhdLnZpc2libGUgPSBjdXJyZW50X3Zpc2libGVfY291bnQ7CgkJCXNldF9lbXB0eShjdXJyZW50X3Zpc2libGVfY291bnQgPT09IDApOwoJCX07CgkJdmFyIHJlc2V0X2ZpbHRlcl9zdGF0ZSA9IGZ1bmN0aW9uIChub2RlLCBjb250ZW50X25vZGUpIHsKCQkJY29udGVudF9ub2RlLnRleHRDb250ZW50ID0gbm9kZS5nZXRBdHRyaWJ1dGUoImRhdGEteGwtb3JpZ2luYWwiKSB8fCAiIjsKCQkJbm9kZS5jbGFzc0xpc3QucmVtb3ZlKCJ4bC1maWx0ZXItZ29vZCIpOwoJCQlub2RlLmNsYXNzTGlzdC5yZW1vdmUoInhsLWZpbHRlci1iYWQiKTsKCQl9OwoJCXZhciB1cGRhdGVfZmlsdGVyc190YXJnZXRzID0gWwoJCQlbICIueGwtZWFzeWxpc3QtaXRlbS10aXRsZS1saW5rLC54bC1lYXN5bGlzdC1pdGVtLXRpdGxlLWpwIiwgInRpdGxlIiBdLAoJCQlbICIueGwtZWFzeWxpc3QtaXRlbS11cGxvYWRlciIsICJ1cGxvYWRlciIgXSwKCQkJWyAiLnhsLWVhc3lsaXN0LWl0ZW0tdGFnIiwgInRhZ3MiIF0sCgkJXTsKCQl2YXIgdXBkYXRlX2ZpbHRlcnMgPSBmdW5jdGlvbiAobm9kZSwgZGF0YSwgZmlyc3QsIHRhZ3Nfb25seSkgewoJCQl2YXIgdGFyZ2V0LCBub2RlcywgbW9kZSwgcmVzdWx0cywgbGluaywgYmFkLCBobCwgbiwgaSwgaWksIGosIGpqOwoKCQkJZm9yIChpID0gKHRhZ3Nfb25seSA/IDIgOiAwKSwgaWkgPSB1cGRhdGVfZmlsdGVyc190YXJnZXRzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCXRhcmdldCA9IHVwZGF0ZV9maWx0ZXJzX3RhcmdldHNbaV07CgkJCQlub2RlcyA9ICQkKHRhcmdldFswXSwgbm9kZSk7CgkJCQltb2RlID0gdGFyZ2V0WzFdOwoJCQkJcmVzdWx0cyA9IFtdOwoJCQkJZm9yIChqID0gMCwgamogPSBub2Rlcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJbiA9IG5vZGVzW2pdOwoJCQkJCWlmICghZmlyc3QpIHJlc2V0X2ZpbHRlcl9zdGF0ZShuLCBuKTsKCQkJCQlGaWx0ZXIuaGlnaGxpZ2h0KG1vZGUsIG4sIGRhdGEsIEZpbHRlci5Ob25lLCByZXN1bHRzLCBjdXN0b21fZmlsdGVycyk7CgkJCQl9CgoJCQkJYmFkID0gMDsKCQkJCWZvciAoaiA9IDAsIGpqID0gcmVzdWx0cy5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJaWYgKHJlc3VsdHNbal0uZmxhZ3MuYmFkKSArK2JhZDsKCQkJCX0KCgkJCQlub2RlLnNldEF0dHJpYnV0ZSgiZGF0YS14bC1maWx0ZXItbWF0Y2hlcy0iICsgbW9kZSwgcmVzdWx0cy5sZW5ndGggLSBiYWQpOwoJCQkJbm9kZS5zZXRBdHRyaWJ1dGUoImRhdGEteGwtZmlsdGVyLW1hdGNoZXMtIiArIG1vZGUgKyAiLWJhZCIsIGJhZCk7CgkJCX0KCgkJCWlmICghdGFnc19vbmx5KSB7CgkJCQlsaW5rID0gJCgiLnhsLWVhc3lsaXN0LWl0ZW0tdGl0bGUtbGluayIsIG5vZGUpOwoJCQkJbiA9ICQoIi54bC1lYXN5bGlzdC1pdGVtLXRpdGxlLXRhZy1saW5rPnNwYW4iLCBub2RlKTsKCgkJCQlpZiAobGluayAhPT0gbnVsbCAmJiBuICE9PSBudWxsKSB7CgkJCQkJaWYgKCFmaXJzdCkgcmVzZXRfZmlsdGVyX3N0YXRlKG4ucGFyZW50Tm9kZSwgbik7CgoJCQkJCWxpbmsgPSBsaW5rLmNsb25lTm9kZSh0cnVlKTsKCQkJCQlpZiAoKGhsID0gRmlsdGVyLmNoZWNrKGxpbmssIGRhdGEsIGN1c3RvbV9maWx0ZXJzKSlbMF0gIT09IEZpbHRlci5Ob25lKSB7CgkJCQkJCUZpbHRlci5oaWdobGlnaHRfdGFnKG4ucGFyZW50Tm9kZSwgbGluaywgaGwpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX07CgkJdmFyIHVwZGF0ZV9hbGxfZmlsdGVycyA9IGZ1bmN0aW9uICgpIHsKCQkJdmFyIGNvbnRlbnRfaW5kZXggPSBjb250ZW50X2N1cnJlbnQsCgkJCQllbnRyaWVzID0gY29udGVudHNbY29udGVudF9pbmRleF0uZW50cmllcywKCQkJCWluZm8sIGRhdGEsIGksIGlpOwoKCQkJZm9yIChpID0gMCwgaWkgPSBlbnRyaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWluZm8gPSBlbnRyaWVzW2ldLmluZm87CgkJCQlkYXRhID0gQVBJLmdldF9kYXRhKGluZm8pOwoJCQkJaWYgKGRhdGEgIT09IG51bGwpIHsKCQkJCQl1cGRhdGVfZmlsdGVycyhlbnRyaWVzW2ldLm5vZGUsIGRhdGEsIGZhbHNlLCBmYWxzZSk7CgkJCQl9CgkJCX0KCgkJCS8vIFVwZGF0ZSBvcmRlcgoJCQlpZiAoc2V0dGluZ3MuZ3JvdXBfYnlfZmlsdGVycyB8fCBzZXR0aW5ncy5maWx0ZXJfdmlzaWJpbGl0eSAhPT0gMCkgewoJCQkJdXBkYXRlX29yZGVyaW5nKCk7CgkJCX0KCQl9OwoJCXZhciBsb2FkX2ZpbHRlcnMgPSBmdW5jdGlvbiAoKSB7CgkJCWN1c3RvbV9maWx0ZXJzID0gRmlsdGVyLnBhcnNlKHNldHRpbmdzLmN1c3RvbV9maWx0ZXJzLCB1bmRlZmluZWQpOwoJCX07CgkJdmFyIGFkZF9saW5rcyA9IGZ1bmN0aW9uIChsaW5rcykgewoJCQl2YXIgaW1tZWRpYXRlID0gdHJ1ZSwKCQkJCWksIGlpOwoKCQkJdmFyIGNiID0gZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJYWRkX2VudHJ5KGltbWVkaWF0ZSwgZXJyLCBkYXRhKTsKCQkJfTsKCgkJCWZvciAoaSA9IDAsIGlpID0gbGlua3MubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJQVBJLmdldF91cmxfaW5mbyhsaW5rc1tpXS5ocmVmLCBjYik7CgkJCX0KCgkJCWltbWVkaWF0ZSA9IGZhbHNlOwoJCQlpZiAocXVldWUubGVuZ3RoID4gMCAmJiBxdWV1ZV90aW1lciA9PT0gbnVsbCkgewoJCQkJb25fdGltZXIoKTsKCQkJfQoJCX07CgkJdmFyIGFkZF9lbnRyeSA9IGZ1bmN0aW9uIChpbW1lZGlhdGUsIGVyciwgaW5mbykgewoJCQl2YXIga2V5OwoJCQlpZiAoZXJyICE9PSBudWxsIHx8IGRhdGFfbWFwWyhrZXkgPSBpbmZvLmlkKV0gIT09IHVuZGVmaW5lZCkgcmV0dXJuOwoKCQkJQVBJLmdldF9kYXRhX2Zyb21fdXJsX2luZm8oaW5mbywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJaWYgKGVyciA9PT0gbnVsbCkgewoJCQkJCWlmIChkYXRhX21hcFtrZXldID09PSB1bmRlZmluZWQpIHsKCQkJCQkJdmFyIGVudHJ5ID0gbmV3IEVudHJ5KGluZm8sIGRhdGEpOwoJCQkJCQlxdWV1ZS5wdXNoKGVudHJ5KTsKCQkJCQkJZGF0YV9tYXBba2V5XSA9IGVudHJ5OwoKCQkJCQkJaWYgKCFpbW1lZGlhdGUgJiYgcXVldWUubGVuZ3RoID4gMCAmJiBxdWV1ZV90aW1lciA9PT0gbnVsbCkgewoJCQkJCQkJb25fdGltZXIoKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfTsKCgkJdmFyIHNldF9jb250ZW50X2luZGV4ID0gZnVuY3Rpb24gKGNvbnRlbnRfaW5kZXgpIHsKCQkJaWYgKGNvbnRlbnRfaW5kZXggPT09IGNvbnRlbnRfY3VycmVudCkgcmV0dXJuOwoKCQkJdmFyIG5vZGUgPSBjb250ZW50c1tjb250ZW50X2N1cnJlbnRdLmNvbnRhaW5lciwKCQkJCXBhciA9IG5vZGUucGFyZW50Tm9kZSwKCQkJCW5leHQgPSBub2RlLm5leHRTaWJsaW5nOwoKCQkJaWYgKHBhciAhPT0gbnVsbCkgewoJCQkJY29udGVudF9jdXJyZW50ID0gY29udGVudF9pbmRleDsKCgkJCQkkLnJlbW92ZShub2RlKTsKCgkJCQlub2RlID0gY29udGVudHNbY29udGVudF9jdXJyZW50XS5jb250YWluZXI7CgkJCQkkLmJlZm9yZShwYXIsIG5leHQsIG5vZGUpOwoKCQkJCXVwZGF0ZV9hbGxfZmlsdGVycygpOwoJCQkJdXBkYXRlX29yZGVyaW5nKCk7CgkJCX0KCQl9OwoKCQl2YXIgZW5hYmxlX2N1c3RvbV9saW5rcyA9IGZ1bmN0aW9uICh0ZXh0KSB7CgkJCWN1c3RvbV9saW5rcyA9IFtdOwoJCQljdXN0b21fbGlua3NfbWFwID0ge307CgkJCWN1c3RvbV9saW5rc190ZXh0ID0gdGV4dDsKCQkJY29udGVudHNbMV0uZW50cmllcyA9IFtdOwoJCQljb250ZW50c1sxXS5jb250YWluZXIuaW5uZXJIVE1MID0gIiI7CgoJCQlpZiAodGV4dC5sZW5ndGggPT09IDApIHsKCQkJCXNldF9jb250ZW50X2luZGV4KDApOwoJCQl9CgkJCWVsc2UgewoJCQkJc2V0X2NvbnRlbnRfaW5kZXgoMSk7CgkJCQlwYXJzZV9jdXN0b21fdXJscyh0ZXh0KTsKCQkJfQoJCX07CgkJdmFyIHBhcnNlX2N1c3RvbV91cmxzID0gZnVuY3Rpb24gKHRleHQpIHsKCQkJdmFyIHVybHMgPSBMaW5raWZpZXIucGFyc2VfdGV4dF9mb3JfdXJscyh0ZXh0KSwKCQkJCWksIGlpOwoKCQkJZm9yIChpID0gMCwgaWkgPSB1cmxzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCUFQSS5nZXRfdXJsX2luZm8odXJsc1tpXSwgJC5iaW5kKHBhcnNlX2N1c3RvbV91cmxfaW5mbywgbnVsbCwgaSkpOwoJCQl9CgkJfTsKCQl2YXIgcGFyc2VfY3VzdG9tX3VybF9pbmZvID0gZnVuY3Rpb24gKGluZGV4LCBlcnIsIGluZm8pIHsKCQkJdmFyIGtleTsKCQkJaWYgKGVyciAhPT0gbnVsbCB8fCBjdXN0b21fbGlua3NfbWFwWyhrZXkgPSBpbmZvLmlkKV0gIT09IHVuZGVmaW5lZCkgcmV0dXJuOwoKCQkJQVBJLmdldF9kYXRhX2Zyb21fdXJsX2luZm8oaW5mbywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJaWYgKGVyciA9PT0gbnVsbCkgewoJCQkJCWlmIChjdXN0b21fbGlua3NfbWFwW2tleV0gPT09IHVuZGVmaW5lZCkgewoJCQkJCQl2YXIgZW50cnkgPSBuZXcgRW50cnkoaW5mbywgZGF0YSk7CgkJCQkJCWN1c3RvbV9saW5rc19tYXBba2V5XSA9IGVudHJ5OwoJCQkJCQlhZGRfZ2FsbGVyeSgxLCBlbnRyeSwgaW5kZXgsIHRydWUpOwoJCQkJCX0KCQkJCX0KCQkJfSk7CgkJfTsKCgkJdmFyIG9uX29wdGlvbl9jaGFuZ2UgPSB7CgkJCXNvcnRfYnk6IGZ1bmN0aW9uICgpIHsKCQkJCXNldHRpbmdzLnNvcnRfYnkgPSB0aGlzLnZhbHVlOwoJCQkJc2V0dGluZ3Nfc2F2ZSgpOwoJCQkJdXBkYXRlX29yZGVyaW5nKCk7CgkJCX0sCgkJCWdyb3VwX2J5X2NhdGVnb3J5OiBmdW5jdGlvbiAoKSB7CgkJCQlzZXR0aW5ncy5ncm91cF9ieV9jYXRlZ29yeSA9IHRoaXMuY2hlY2tlZDsKCQkJCXNldHRpbmdzX3NhdmUoKTsKCQkJCXVwZGF0ZV9vcmRlcmluZygpOwoJCQl9LAoJCQlncm91cF9ieV9maWx0ZXJzOiBmdW5jdGlvbiAoKSB7CgkJCQlzZXR0aW5ncy5ncm91cF9ieV9maWx0ZXJzID0gdGhpcy5jaGVja2VkOwoJCQkJc2V0dGluZ3Nfc2F2ZSgpOwoJCQkJdXBkYXRlX29yZGVyaW5nKCk7CgkJCX0sCgkJCWRpc3BsYXlfbW9kZTogZnVuY3Rpb24gKCkgewoJCQkJc2V0dGluZ3MuZGlzcGxheV9tb2RlID0gcGFyc2VJbnQodGhpcy52YWx1ZSwgMTApIHx8IDA7CgkJCQlzZXR0aW5nc19zYXZlKCk7CgkJCQl1cGRhdGVfZGlzcGxheV9tb2RlKGZhbHNlKTsKCQkJfSwKCQkJZmlsdGVyX3Zpc2liaWxpdHk6IGZ1bmN0aW9uICgpIHsKCQkJCXNldHRpbmdzLmZpbHRlcl92aXNpYmlsaXR5ID0gcGFyc2VJbnQodGhpcy52YWx1ZSwgMTApIHx8IDA7CgkJCQlzZXR0aW5nc19zYXZlKCk7CgkJCQl1cGRhdGVfb3JkZXJpbmcoKTsKCQkJfSwKCQkJY3VzdG9tX2ZpbHRlcnM6IGZ1bmN0aW9uICgpIHsKCQkJCWlmIChzZXR0aW5ncy5jdXN0b21fZmlsdGVycyAhPT0gdGhpcy52YWx1ZSkgewoJCQkJCXNldHRpbmdzLmN1c3RvbV9maWx0ZXJzID0gdGhpcy52YWx1ZTsKCQkJCQlzZXR0aW5nc19zYXZlKCk7CgkJCQkJbG9hZF9maWx0ZXJzKCk7CgkJCQkJdXBkYXRlX2FsbF9maWx0ZXJzKCk7CgkJCQl9CgkJCX0sCgkJCWN1c3RvbV9maWx0ZXJzX2lucHV0OiBmdW5jdGlvbiAoKSB7CgkJCQl2YXIgbm9kZSA9IHRoaXM7CgkJCQlpZiAob25fb3B0aW9uX2NoYW5nZS5jdXN0b21fZmlsdGVyc19pbnB1dF9kZWxheV90aW1lciAhPT0gbnVsbCkgewoJCQkJCWNsZWFyVGltZW91dChvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9maWx0ZXJzX2lucHV0X2RlbGF5X3RpbWVyKTsKCQkJCX0KCQkJCW9uX29wdGlvbl9jaGFuZ2UuY3VzdG9tX2ZpbHRlcnNfaW5wdXRfZGVsYXlfdGltZXIgPSBzZXRUaW1lb3V0KAoJCQkJCWZ1bmN0aW9uICgpIHsKCQkJCQkJb25fb3B0aW9uX2NoYW5nZS5jdXN0b21fZmlsdGVyc19pbnB1dF9kZWxheV90aW1lciA9IG51bGw7CgkJCQkJCW9uX29wdGlvbl9jaGFuZ2UuY3VzdG9tX2ZpbHRlcnMuY2FsbChub2RlKTsKCQkJCQl9LAoJCQkJCTEwMDAKCQkJCSk7CgkJCX0sCgkJCWN1c3RvbV9maWx0ZXJzX2lucHV0X2RlbGF5X3RpbWVyOiBudWxsLAoJCQljdXN0b21fbGlua3M6IGZ1bmN0aW9uICgpIHsKCQkJCXZhciB0ID0gdGhpcy52YWx1ZS50cmltKCk7CgkJCQlpZiAodCAhPT0gY3VzdG9tX2xpbmtzX3RleHQpIHsKCQkJCQllbmFibGVfY3VzdG9tX2xpbmtzKHQpOwoJCQkJfQoJCQl9LAoJCQljdXN0b21fbGlua3NfaW5wdXQ6IGZ1bmN0aW9uICgpIHsKCQkJCXZhciBub2RlID0gdGhpczsKCQkJCWlmIChvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9saW5rc19pbnB1dF9kZWxheV90aW1lciAhPT0gbnVsbCkgewoJCQkJCWNsZWFyVGltZW91dChvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9saW5rc19pbnB1dF9kZWxheV90aW1lcik7CgkJCQl9CgkJCQlvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9saW5rc19pbnB1dF9kZWxheV90aW1lciA9IHNldFRpbWVvdXQoCgkJCQkJZnVuY3Rpb24gKCkgewoJCQkJCQlvbl9vcHRpb25fY2hhbmdlLmN1c3RvbV9saW5rc19pbnB1dF9kZWxheV90aW1lciA9IG51bGw7CgkJCQkJCW9uX29wdGlvbl9jaGFuZ2UuY3VzdG9tX2xpbmtzLmNhbGwobm9kZSk7CgkJCQkJfSwKCQkJCQkxMDAwCgkJCQkpOwoJCQl9LAoJCQljdXN0b21fbGlua3NfaW5wdXRfZGVsYXlfdGltZXI6IG51bGwKCQl9OwoJCXZhciBvbl9nYWxsZXJ5X21vdXNlb3ZlciA9ICQud3JhcF9tb3VzZWVudGVybGVhdmVfZXZlbnQoZnVuY3Rpb24gKCkgewoJCQkkLm9mZih0aGlzLCAibW91c2VvdmVyIiwgb25fZ2FsbGVyeV9tb3VzZW92ZXIpOwoKCQkJdmFyIG5vZGUgPSB0aGlzLAoJCQkJaWQsIGVudHJ5LCBkYXRhOwoKCQkJaWYgKAoJCQkJKGlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoImRhdGEteGwtaWQiKSkgJiYKCQkJCSgoZW50cnkgPSBkYXRhX21hcFtpZF0pICE9PSB1bmRlZmluZWQgfHwgKGVudHJ5ID0gY3VzdG9tX2xpbmtzX21hcFtpZF0pICE9PSB1bmRlZmluZWQpICYmCgkJCQkoZGF0YSA9IEFQSS5nZXRfZGF0YShlbnRyeS5pbmZvKSkgIT09IG51bGwKCQkJKSB7CgkJCQlBUEkuZ2V0X2VoZW50YWlfZ2FsbGVyeV9mdWxsKGVudHJ5LmluZm8sIGRhdGEsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKCQkJCQl2YXIgdGFnc19jb250YWluZXIsIG47CgoJCQkJCWlmICgKCQkJCQkJZXJyID09PSBudWxsICYmCgkJCQkJCSh0YWdzX2NvbnRhaW5lciA9ICQoIi54bC1lYXN5bGlzdC1pdGVtLXRhZ3MiLCBub2RlKSkgIT09IG51bGwKCQkJCQkpIHsKCQkJCQkJbiA9IGNyZWF0ZV9mdWxsX3RhZ3MoZGF0YSwgZW50cnkuaW5mbyk7CgkJCQkJCXRhZ3NfY29udGFpbmVyLnRleHRDb250ZW50ID0gIiI7CgkJCQkJCSQuYWRkKHRhZ3NfY29udGFpbmVyLCBuKTsKCgkJCQkJCXVwZGF0ZV9maWx0ZXJzKG5vZGUsIGRhdGEsIGZhbHNlLCB0cnVlKTsKCQkJCQl9CgkJCQl9KTsKCQkJfQoJCX0pOwoJCXZhciBvbl90aHVtYm5haWxfZXJyb3IgPSBmdW5jdGlvbiAoKSB7CgkJCSQub2ZmKHRoaXMsICJlcnJvciIsIG9uX3RodW1ibmFpbF9lcnJvcik7CgoJCQl2YXIgcGFyID0gdGhpcy5wYXJlbnROb2RlOwoJCQlpZiAocGFyID09PSBudWxsKSByZXR1cm47CgkJCXBhci5zdHlsZS53aWR0aCA9ICIxMDAlIjsKCQkJcGFyLnN0eWxlLmhlaWdodCA9ICIxMDAlIjsKCQkJdGhpcy5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwoKCQkJdmFyIG4gPSAkLm5vZGUoImRpdiIsICJ4bC1lYXN5bGlzdC1pdGVtLWltYWdlLWVycm9yIiArIFRoZW1lLmNsYXNzZXMsIFVJLnN0cmluZ3MudGh1bWJuYWlsX2ZhaWxlZCk7CgkJCSQuYmVmb3JlKHBhciwgcGFyLmZpcnN0Q2hpbGQsIG4pOwoJCQkkLmJlZm9yZShwYXIsIG4sICQubm9kZSgiZGl2IiwgInhsLWVhc3lsaXN0LWl0ZW0taW1hZ2UtZXJyb3ItYWxpZ25lciIgKyBUaGVtZS5jbGFzc2VzKSk7CgkJfTsKCQl2YXIgb25fbGlua19mb3JtYXQgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJYWRkX2xpbmtzKFsgZXZlbnQubGluayBdKTsKCQl9OwoJCXZhciBvbl90aW1lciA9IGZ1bmN0aW9uICgpIHsKCQkJcXVldWVfdGltZXIgPSBudWxsOwoKCQkJdmFyIG5ld19lbnRyaWVzID0gcXVldWUuc3BsaWNlKDAsIDIwKSwKCQkJCWVudHJpZXMgPSBjb250ZW50c1swXS5lbnRyaWVzLAoJCQkJaSwgaWk7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IG5ld19lbnRyaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWFkZF9nYWxsZXJ5KDAsIG5ld19lbnRyaWVzW2ldLCBlbnRyaWVzLmxlbmd0aCwgdHJ1ZSk7CgkJCX0KCgkJCWlmIChxdWV1ZS5sZW5ndGggPiAwKSB7CgkJCQlxdWV1ZV90aW1lciA9IHNldFRpbWVvdXQob25fdGltZXIsIDUwKTsKCQkJfQoJCX07CgkJdmFyIG9uX29wZW5fY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCW9wZW4oKTsKCgkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJfTsKCQl2YXIgb25fY2xvc2VfY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCWNsb3NlKCk7CgoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgkJdmFyIG9uX3RvZ2dsZV9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJaWYgKGlzX29wZW4oKSkgewoJCQkJCWNsb3NlKCk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlvcGVuKCk7CgkJCQl9CgoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgkJdmFyIG9uX29wdGlvbnNfY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCXNldF9vcHRpb25zX3Zpc2libGUoIWdldF9vcHRpb25zX3Zpc2libGUoKSk7CgoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgkJdmFyIG9uX292ZXJsYXlfY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCWNsb3NlKCk7CgoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgkJdmFyIG9uX3JhbmRvbV9saW5rX2dlbmVyYXRlID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgZW50cmllcyA9IGNvbnRlbnRzW2NvbnRlbnRfY3VycmVudF0uZW50cmllcywKCQkJCWk7CgoJCQlpZiAoZW50cmllcy5sZW5ndGggPiAwKSB7CgkJCQlpID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZW50cmllcy5sZW5ndGgpOwoJCQkJdGhpcy5ocmVmID0gZW50cmllc1tpXS51cmw7CgkJCX0KCQl9OwoJCXZhciBvbl9yYW5kb21fbGlua19nZW5lcmF0ZV9kZWxheWVkID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCXZhciBzZWxmID0gdGhpczsKCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCQlvbl9yYW5kb21fbGlua19nZW5lcmF0ZS5jYWxsKHNlbGYsIGV2ZW50KTsKCQkJfSwgMSk7CgkJfTsKCgkJLy8gUHVibGljCgkJdmFyIGdldF9zYXZlZF9zZXR0aW5ncyA9IGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuICQuanNvbl9wYXJzZV9zYWZlKENvbmZpZy5zdG9yYWdlLmdldEl0ZW0oc2V0dGluZ3Nfa2V5KSwgbnVsbCk7CgkJfTsKCQl2YXIgc2V0X3NhdmVkX3NldHRpbmdzID0gZnVuY3Rpb24gKGRhdGEpIHsKCQkJaWYgKGRhdGEgPT09IG51bGwpIHsKCQkJCUNvbmZpZy5zdG9yYWdlLnJlbW92ZUl0ZW0oc2V0dGluZ3Nfa2V5KTsKCQkJfQoJCQllbHNlIHsKCQkJCUNvbmZpZy5zdG9yYWdlLnNldEl0ZW0oc2V0dGluZ3Nfa2V5LCBKU09OLnN0cmluZ2lmeShkYXRhKSk7CgkJCX0KCQl9OwoJCXZhciByZWFkeSA9IGZ1bmN0aW9uICgpIHsKCQkJaWYgKCFjb25maWcuZWFzeV9saXN0LmVuYWJsZWQpIHJldHVybjsKCgkJCWlmICghY29uZmlnLmVhc3lfbGlzdC5vbmx5X2hlYWRlcl9pY29uKSB7CgkJCQlOYXZpZ2F0aW9uLmluc2VydF9saW5rKCJub3JtYWwiLCAiRWFzeSBMaXN0IiwgTWFpbi5ob21lcGFnZSwgIiB4bC1uYXYtbGluay1lYXN5bGlzdCIsIG9uX29wZW5fY2xpY2spOwoJCQl9CgoJCQl2YXIgbGluayA9IEhlYWRlckJhci5pbnNlcnRfc2hvcnRjdXRfaWNvbigKCQkJCSJwYW5kYSIsCgkJCQlNYWluLnRpdGxlICsgIiBFYXN5IExpc3QiLAoJCQkJTWFpbi5ob21lcGFnZSwKCQkJCW9uX3RvZ2dsZV9jbGljaywKCQkJCWZ1bmN0aW9uIChzdmcsIHN2Z25zKSB7CgkJCQkJdmFyIHBhdGggPSAkLm5vZGVfbnMoc3ZnbnMsICJwYXRoIiwgInhsLWhlYWRlci1iYXItc3ZnLXBhbmRhLXBhdGgiKTsKCQkJCQlwYXRoLnNldEF0dHJpYnV0ZSgiZCIsCgkJCQkJCSJNIDE2LjYzMzE3OSw1MS4xNDYzMDggYyAzLjY0OTg3LDAuOTYyOTEgNC45NjQxNDMsNi4zNTMzNDMgNS44NDg1NTMsNi45NTEyMTQgMS44MDM1MzQsMS4yMTkyMDkgMTYuMTI5OTg0LDAuNTc5ODI2IDE2LjEyOTk4NCwwLjU3OTgyNiAxLjE5Nzg2NSwtMTEuNzI0NzMxIDEuMjEyODMzLC04LjY3MTMxOCAyLjk1NTQ4LC0xNi41OTYxMyAtMS45ODkwNzUsLTEuMzQ2MDcgLTUuMzMzNjkzLC0yLjIzNzEyIC01Ljc5NzI4OCwtNC44ODc5MSAtMC40NjM1OTUsLTIuNjUwNzggMC4yNTUwODgsLTIuMTQyNjgxIDAuMTg3NTQzLC02LjMxNDM3MSAtMS40Mzk2NDcsLTIuNzY4NzM2IC0yLjIwNDAxNiwtNi4wMzU1MSAtMi41MDA3ODksLTkuNDM0NzkgLTMuMDI0OTA3LC0xLjc1MTAzMyAtNi4wMjY1MTcsLTAuNDk0Njk0IC02LjQzMzk1NSwtNS4yOTcyMjkgLTAuMzUzNTEyLC00LjE2NjkxNiA2LjEzMjc1NiwtNS4xMzg4MTggOS43NDczMDksLTcuNTE5NDAwNyA3LjA3NzM3MywtOC4yODAxNTI5OCAxMi42ODQwNTYsLTcuODY2MTQ5MjcgMTguMjY3MzMsLTcuODY2MTQ5MjcgNS41ODMyNzUsMCAxMi4xOTA5NzYsMy43NjM2NjkxNyAxNy41ODU5ODgsMTEuMjIwMzQ0OTcgNi41MzIyMiw5LjAyODQ1OSAxMC42NzQzMTcsMTguNjI5MDg3IDE0LjQ2NjI4MSwzMC4wNDQ4NDcgMy43OTE5NTQsMTEuNDE1NzcgNC40NTM2MTcsMjEuNDU5MDU0IDEuNTM3ODU0LDMxLjc2OTE5OCAyLjM2ODIxLDAuNzc2NzEgNC45MjgzNzgsMS4wMDk0ODUgNS4yMjY3MzUsMy45NTAzODUgMC4yOTgzNjYsMi45NDA4OSAtMS4yNjczOTksNS4zNjM5OTYgLTMuNjA3NzI5LDUuOTYzOTU2IC0yLjM0MDMzLDAuNTk5OTUgLTQuNjAxODIsLTAuMTM5MjI0IC02LjY0NjUzOSwtMC42MTk2OTQgLTMuODYyMTcsMy43NzQxNiAtOS4wMTE0NzQsNy41MzgwNDMgLTE3LjQ3OTU1NSw5LjE3NzEyMyAtOC40NjgwNzgsMS42MzkwOCAtMjYuNDUzMzc3LDYuNTkzMjIyIC0zMi42MjM5MTYsNi4zMDg4MSBDIDI3LjMyNTkyNiw5OC4yOTE5MjYgMjYuNjM0NzEzLDk0LjQyMjY2IDI1LjY1ODgyNSw5MC4wMzQ0MSAyNC42ODI5MzcsODUuNjQ2MTYgMjUuNDAzMTQ4LDgyLjQ0MDk2OCAyNS40NjU5NTcsNzguNjk2MzA4IDE5LjkwOTU1Myw3OS4xMjM5MjggMTEuMDU1NTc2LDc5LjY1NDY0NiA5LjA3OTk1MjUsNzguNzc1OTEzIDUuOTk5NTI1Miw3Ny40MDU3NzYgNC4yMzQ2Nzg0LDY5LjExMDc1NCA1Ljc2NTg2NDMsNTkuOTc0MDI0IDYuOTMzODY1Miw1My4wMDQ0NTQgMTIuNjYwNjU4LDUwLjIyMzc3IDE2LjYzMzE3OSw1MS4xNDYzMDggeiAiICsKCQkJCQkJIk0gNDcuMzE2MTczLDQwLjI3ODcwMiBjIC0xLjk3NzQ0MSwxMC4yNDQzMzEgLTUuMzE4MjcyLDIxLjQ3NDU0MSAtNS42NjI4MDUsMjkuNzg0MDM2IC0wLjI0MjUwNyw1Ljg0ODgzNiAyLjQyMDcyNiw3LjU1ODYgNS4zNDgzODMsMi4wNzgyMjMgNS41ODYyMzcsLTEwLjQ1NzA2IDcuODk2Njg3LC0yMS4xMzkyNTEgMTAuODM5OTc5LC0zMi4wMTg2NDEgLTEuMzc2MzQyLDAuNzMyNTM1IC0yLjMzNTgxLDAuODA1NDgyIC0zLjU2Nzc1MiwxLjEwNDgxNiAyLjIwMDY1LC0xLjgyNjgwMSAxLjc5Nzk2MywtMS4yNTk4NDUgNC42ODMzOTcsLTQuMzU2MTQ3IDMuNzAyMDQyLC0zLjk3MjU4OCAxMS41MDU3MDEsLTcuODQyNjc1IDE1LjE4NzI5NiwtNC40OTA4NjkgNC41OTc3NzYsNC4xODU5MTcgMy40NTM3LDEzLjkyMDUwOSAtMC40MzE4MjksMTguNzM1Mzg3IC0xLjMwMTk4Nyw1LjIxOTE1NyAtMy4yNzgyMzIsMTAuOTkzOTgxIC00LjY5MTA1NSwxNC4yMTE1NDUgMS42NTAxMjksMC45NTE5OTcgNy4xNzc1LDIuNjQ3ODg2IDguNzIzMDIzLDYuODA4ODM4IDEuODE4NDczLDQuODk1ODA2IDAuNDQ3OTkzLDguMzM1MDgxIC0zLjIwNzc3NiwxMi45Mjk2MTggOC43ODEyNzksLTYuMjE0NDA5IDkuODc1MDA0LC0xMi4yNDg1MiAxMC41ODY2ODIsLTIwLjI1MTA2MiBDIDg1LjU5Njg4Nyw1OS4yNDQ5MTUgODUuNjE1OTE1LDU0LjQyODE5IDgzLjgyNDM3LDQ3LjE4MTg3MyA4Mi4wMzI4MjUsMzkuOTM1NTU2IDc3LjQ4NDE4NywzMC41MjcyNzUgNzMuODA2MTA1LDIzLjc4MDc0OCA3MC4xMjgwMjMsMTcuMDM0MjIxIDY4LjQ2NTA3NiwxMi4zNzY1MTUgNjAuNDY3NzM0LDcuNTc4MjQyOCA1NC41MzQ4OTIsNC4wMTg2MzY0IDQ0LjAwNjYwMSw1LjM2MzMwMDYgMzkuOTYwMTk5LDExLjcxNjU0NiBjIC00LjA0NjQwMiw2LjM1MzI0NSAtMi4wNTIyOTUsMTEuNDE3MTk5IDAuMzM5OTc5LDE3LjY3MzU0NiAtMC4wNjc5NSwxLjk2OTY0NiAtMS4xNDUwMTUsNC4yOTUyNTYgMC4xMDU1MDgsNS43NTEzODMgMS44NzUyNDMsLTAuOTE0OTc5IDIuNzcyMTA4LC0xLjk1NzY1NSA0LjQyMTk5NSwtMi42Mzk2MDYgLTAuMDE0NTEsMS41Mjk5MzEgMC4zMjA5MjEsNC4xOTIyMzYgLTEuMTc1MzUsNS43MjIxNjcgMS43NTgzMTYsMS4xMTYyNTIgMS44MDQ5NSwxLjQxNDMwNyAzLjY2Mzg0MiwyLjA1NDY2NiB6IgoJCQkJCSk7CgkJCQkJJC5hZGQoc3ZnLCBwYXRoKTsKCQkJCX0KCQkJKTsKCQkJbGluay5jbGFzc0xpc3QuYWRkKCJ4bC1oZWFkZXItYmFyLWxpbmstZGltIik7CgkJCUxpbmtpZmllci5vbigiYmVmb3JlX2ZpcnN0X2xpbmtfcHJlcHJvY2VzcyIsIGZ1bmN0aW9uICgpIHsKCQkJCWxpbmsuY2xhc3NMaXN0LnJlbW92ZSgieGwtaGVhZGVyLWJhci1saW5rLWRpbSIpOwoJCQl9KTsKCQl9OwoJCXZhciBvcGVuID0gZnVuY3Rpb24gKCkgewoJCQlpZiAocG9wdXAgPT09IG51bGwpIHsKCQkJCXNldHRpbmdzX2xvYWQoKTsKCQkJCWNyZWF0ZSgpOwoJCQl9CgoJCQlhZGRfbGlua3MoVUkuZ2V0X2xpbmtzX2Zvcm1hdHRlZCgpKTsKCQkJVUkub24oImZvcm1hdCIsIG9uX2xpbmtfZm9ybWF0KTsKCgkJCVBvcHVwLm9wZW4ocG9wdXApOwoJCQkkLnNjcm9sbF9mb2N1cyhwb3B1cCk7CgkJfTsKCQl2YXIgY2xvc2UgPSBmdW5jdGlvbiAoKSB7CgkJCVBvcHVwLmNsb3NlKHBvcHVwKTsKCgkJCXNldF9vcHRpb25zX3Zpc2libGUoZmFsc2UpOwoKCQkJVUkub2ZmKCJmb3JtYXQiLCBvbl9saW5rX2Zvcm1hdCk7CgkJfTsKCQl2YXIgaXNfb3BlbiA9IGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIChwb3B1cCAhPT0gbnVsbCAmJiBQb3B1cC5pc19vcGVuKHBvcHVwKSk7CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCWdldF9zYXZlZF9zZXR0aW5nczogZ2V0X3NhdmVkX3NldHRpbmdzLAoJCQlzZXRfc2F2ZWRfc2V0dGluZ3M6IHNldF9zYXZlZF9zZXR0aW5ncywKCQkJcmVhZHk6IHJlYWR5LAoJCQlvcGVuOiBvcGVuLAoJCQljbG9zZTogY2xvc2UsCgkJCWlzX29wZW46IGlzX29wZW4KCQl9OwoKCX0pKCk7Cgl2YXIgUG9wdXAgPSAoZnVuY3Rpb24gKCkgewoKCQkvLyBQcml2YXRlCgkJdmFyIGFjdGl2ZSA9IG51bGwsCgkJCWhvdmVyaW5nX2NvbnRhaW5lciA9IG51bGw7CgoJCXZhciBvbl9zdG9wX3Byb3BhZ2F0aW9uID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCWlmICgkLmlzX2xlZnRfbW91c2UoZXZlbnQpKSB7CgkJCQlldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKCQkJfQoJCX07CgkJdmFyIG9uX292ZXJsYXlfZXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJaWYgKCQuaXNfbGVmdF9tb3VzZShldmVudCkpIHsKCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQlldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciBjcmVhdGUgPSBmdW5jdGlvbiAoY2xhc3NfbnMsIHNldHVwKSB7CgkJCXZhciB0aGVtZSA9IFRoZW1lLmNsYXNzZXMsCgkJCQljb250YWluZXIsIGxpc3QsIG9iaiwgbjEsIG4yLCBuMywgbjQsIG41LCBuNiwgaSwgaWksIGosIGpqLCB2OwoKCQkJbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1wb3B1cC1vdmVybGF5IHhsLSIgKyBjbGFzc19ucyArICItcG9wdXAtb3ZlcmxheSIgKyB0aGVtZSk7CgkJCSQuYWRkKG4xLCBuMiA9ICQubm9kZSgiZGl2IiwgInhsLXBvcHVwLWFsaWduZXIgeGwtIiArIGNsYXNzX25zICsgIi1wb3B1cC1hbGlnbmVyIiArIHRoZW1lKSk7CgkJCSQuYWRkKG4yLCBuMyA9ICQubm9kZSgiZGl2IiwgInhsLXBvcHVwLWFsaWduIHhsLSIgKyBjbGFzc19ucyArICItcG9wdXAtYWxpZ24iICsgdGhlbWUpKTsKCQkJJC5hZGQobjMsIGNvbnRhaW5lciA9ICQubm9kZSgiZGl2IiwgInhsLXBvcHVwLWNvbnRlbnQgeGwtIiArIGNsYXNzX25zICsgIi1wb3B1cC1jb250ZW50IHhsLWhvdmVyLXNoYWRvdyIgKyB0aGVtZSkpOwoJCQlUaGVtZS5iZyhjb250YWluZXIpOwoKCQkJJC5vbihuMSwgIm1vdXNlZG93biIsIG9uX292ZXJsYXlfZXZlbnQpOwoJCQkkLm9uKGNvbnRhaW5lciwgImNsaWNrIiwgb25fc3RvcF9wcm9wYWdhdGlvbik7CgkJCSQub24oY29udGFpbmVyLCAibW91c2Vkb3duIiwgb25fc3RvcF9wcm9wYWdhdGlvbik7CgoJCQlpZiAodHlwZW9mKHNldHVwKSA9PT0gImZ1bmN0aW9uIikgewoJCQkJc2V0dXAuY2FsbChudWxsLCBjb250YWluZXIpOwoJCQl9CgkJCWVsc2UgewoJCQkJJC5hZGQoY29udGFpbmVyLCBuMiA9ICQubm9kZSgiZGl2IiwgInhsLXBvcHVwLXRhYmxlIiArIHRoZW1lKSk7CgoJCQkJZm9yIChpID0gMCwgaWkgPSBzZXR1cC5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJbGlzdCA9IHNldHVwW2ldOwoJCQkJCWlmICghQXJyYXkuaXNBcnJheShsaXN0KSkgbGlzdCA9IFsgbGlzdCBdOwoKCQkJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1wb3B1cC1yb3ciICsgdGhlbWUpKTsKCQkJCQlqaiA9IGxpc3QubGVuZ3RoOwoJCQkJCWlmIChqaiA+IDEpIHsKCQkJCQkJJC5hZGQobjMsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtcG9wdXAtY2VsbCIgKyB0aGVtZSkpOwoJCQkJCQkkLmFkZChuNCwgbjUgPSAkLm5vZGUoImRpdiIsICJ4bC1wb3B1cC10YWJsZSIgKyB0aGVtZSkpOwoJCQkJCQkkLmFkZChuNSwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1wb3B1cC1yb3ciICsgdGhlbWUpKTsKCQkJCQl9CgkJCQkJZm9yIChqID0gMDsgaiA8IGpqOyArK2opIHsKCQkJCQkJb2JqID0gbGlzdFtqXTsKCgkJCQkJCSQuYWRkKG4zLCBuNCA9ICQubm9kZSgiZGl2IiwgInhsLXBvcHVwLWNlbGwiICsgdGhlbWUpKTsKCgkJCQkJCWlmIChvYmouc21hbGwpIG40LmNsYXNzTGlzdC5hZGQoInhsLXBvcHVwLWNlbGwtc21hbGwiKTsKCQkJCQkJaWYgKCh2ID0gb2JqLmFsaWduKSAhPT0gdW5kZWZpbmVkICYmIHYgIT09ICJsZWZ0IikgbjQuY2xhc3NMaXN0LmFkZCgieGwtcG9wdXAtY2VsbC0iICsgdik7CgkJCQkJCWlmICgodiA9IG9iai52YWxpZ24pICE9PSB1bmRlZmluZWQgJiYgdiAhPT0gInRvcCIpIG40LmNsYXNzTGlzdC5hZGQoInhsLXBvcHVwLWNlbGwtIiArIHYpOwoJCQkJCQlpZiAob2JqLmJvZHkpIHsKCQkJCQkJCW4zLmNsYXNzTGlzdC5hZGQoInhsLXBvcHVwLXJvdy1ib2R5Iik7CgoJCQkJCQkJJC5hZGQobjQsIG41ID0gJC5ub2RlKCJkaXYiLCAieGwtcG9wdXAtY2VsbC1zaXplIiArIHRoZW1lKSk7CgkJCQkJCQkkLmFkZChuNSwgbjYgPSAkLm5vZGUoImRpdiIsICJ4bC1wb3B1cC1jZWxsLXNpemUtc2Nyb2xsIiArIHRoZW1lKSk7CgkJCQkJCQlpZiAob2JqLnBhZGRpbmcgIT09IGZhbHNlKSB7CgkJCQkJCQkJJC5hZGQobjYsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtcG9wdXAtY2VsbC1zaXplLXBhZGRpbmciICsgdGhlbWUpKTsKCQkJCQkJCX0KCQkJCQkJCWVsc2UgewoJCQkJCQkJCW40ID0gbjY7CgkJCQkJCQl9CgkJCQkJCX0KCgkJCQkJCW9iai5zZXR1cC5jYWxsKG51bGwsIG40KTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXJldHVybiBuMTsKCQl9OwoJCXZhciBvcGVuID0gZnVuY3Rpb24gKG92ZXJsYXkpIHsKCQkJaWYgKGFjdGl2ZSAhPT0gbnVsbCAmJiBhY3RpdmUucGFyZW50Tm9kZSAhPT0gbnVsbCkgewoJCQkJJC5yZW1vdmUoYWN0aXZlKTsKCQkJfQoJCQlkb2N1bWVudF9lbGVtZW50LmNsYXNzTGlzdC5hZGQoInhsLXBvcHVwLW92ZXJsYXlpbmciKTsKCQkJaG92ZXJpbmcob3ZlcmxheSk7CgkJCWFjdGl2ZSA9IG92ZXJsYXk7CgkJfTsKCQl2YXIgY2xvc2UgPSBmdW5jdGlvbiAob3ZlcmxheSkgewoJCQlkb2N1bWVudF9lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoInhsLXBvcHVwLW92ZXJsYXlpbmciKTsKCQkJaWYgKG92ZXJsYXkucGFyZW50Tm9kZSAhPT0gbnVsbCkgewoJCQkJJC5yZW1vdmUob3ZlcmxheSk7CgkJCX0KCQkJYWN0aXZlID0gbnVsbDsKCQl9OwoJCXZhciBpc19vcGVuID0gZnVuY3Rpb24gKG92ZXJsYXkpIHsKCQkJcmV0dXJuIChvdmVybGF5LnBhcmVudE5vZGUgIT09IG51bGwpOwoJCX07CgkJdmFyIGhvdmVyaW5nID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJaWYgKGhvdmVyaW5nX2NvbnRhaW5lciA9PT0gbnVsbCkgewoJCQkJaG92ZXJpbmdfY29udGFpbmVyID0gJC5ub2RlKCJkaXYiLCAieGwtaG92ZXJpbmctZWxlbWVudHMiKTsKCQkJCWlmIChDb25maWcuaXNfdGlueWJvYXJkKSB7CgkJCQkJLy8gRml4IHNvbWUgcG9vciBjaG9pY2VzIG9mIHNlbGVjdG9ycyAoZGl2LnBvc3Q6bGFzdCkgdGhhdCBpbmZpbml0eSB1c2VzCgkJCQkJJC5wcmVwZW5kKGRvY3VtZW50LmJvZHksIGhvdmVyaW5nX2NvbnRhaW5lcik7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQkkLmFkZChkb2N1bWVudC5ib2R5LCBob3ZlcmluZ19jb250YWluZXIpOwoJCQkJfQoJCQl9CgkJCSQuYWRkKGhvdmVyaW5nX2NvbnRhaW5lciwgbm9kZSk7CgkJfTsKCgkJLy8gRXhwb3J0cwoJCXJldHVybiB7CgkJCWNyZWF0ZTogY3JlYXRlLAoJCQlvcGVuOiBvcGVuLAoJCQljbG9zZTogY2xvc2UsCgkJCWlzX29wZW46IGlzX29wZW4sCgkJCWhvdmVyaW5nOiBob3ZlcmluZwoJCX07CgoJfSkoKTsKCXZhciBDaGFuZ2Vsb2cgPSAoZnVuY3Rpb24gKCkgewoKCQkvLyBQcml2YXRlCgkJdmFyIGNoYW5nZV9kYXRhID0gbnVsbCwKCQkJYWNxdWlyaW5nID0gZmFsc2UsCgkJCXBvcHVwID0gbnVsbDsKCgkJdmFyIHBhcnNlID0gZnVuY3Rpb24gKHRleHQpIHsKCQkJdmFyIG0gPSAvXihbXHdcV10qKVxuPSsoXHI/XG58JCkvLmV4ZWModGV4dCksCgkJCQlyZV92ZXJzaW9uID0gL14oXHcrKD86XC5cdyspKylccyokLywKCQkJCXJlX2NoYW5nZSA9IC9eKFxzKilbXC1cK11ccyooLispLywKCQkJCXZlcnNpb25zID0gW10sCgkJCQlhdXRob3JzID0gbnVsbCwKCQkJCWF1dGhvciwgYXV0aG9yX21hcCwgY2hhbmdlcywgbGluZXMsIGxpbmUsIGksIGlpOwoKCQkJaWYgKG0gIT09IG51bGwpIHRleHQgPSBtWzFdOwoKCQkJbGluZXMgPSB0ZXh0LnJlcGxhY2UoL1xyXG4/L2csICJcbiIpLnNwbGl0KCJcbiIpOwoJCQlmb3IgKGkgPSAxLCBpaSA9IGxpbmVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWxpbmUgPSBsaW5lc1tpXTsKCQkJCWlmICgobSA9IHJlX3ZlcnNpb24uZXhlYyhsaW5lKSkgIT09IG51bGwpIHsKCQkJCQlhdXRob3JzID0gW107CgkJCQkJdmVyc2lvbnMucHVzaCh7CgkJCQkJCXZlcnNpb246IG1bMV0sCgkJCQkJCWF1dGhvcnM6IGF1dGhvcnMKCQkJCQl9KTsKCQkJCQlhdXRob3IgPSAiIjsKCQkJCQlhdXRob3JfbWFwID0ge307CgkJCQl9CgkJCQllbHNlIGlmIChhdXRob3JzICE9PSBudWxsKSB7CgkJCQkJaWYgKChtID0gcmVfY2hhbmdlLmV4ZWMobGluZSkpICE9PSBudWxsKSB7CgkJCQkJCWlmIChtWzFdLmxlbmd0aCA9PT0gMCkgewoJCQkJCQkJYXV0aG9yID0gbVsyXTsKCQkJCQkJfQoJCQkJCQllbHNlIHsKCQkJCQkJCWNoYW5nZXMgPSBhdXRob3JfbWFwW2F1dGhvcl07CgkJCQkJCQlpZiAoY2hhbmdlcyA9PT0gdW5kZWZpbmVkKSB7CgkJCQkJCQkJY2hhbmdlcyA9IFtdOwoJCQkJCQkJCWF1dGhvcl9tYXBbYXV0aG9yXSA9IGNoYW5nZXM7CgkJCQkJCQkJYXV0aG9ycy5wdXNoKHsKCQkJCQkJCQkJYXV0aG9yOiBhdXRob3IsCgkJCQkJCQkJCWNoYW5nZXM6IGNoYW5nZXMKCQkJCQkJCQl9KTsKCQkJCQkJCX0KCQkJCQkJCWNoYW5nZXMucHVzaChtWzJdKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKHZlcnNpb25zLmxlbmd0aCA9PT0gMCkgewoJCQkJcmV0dXJuIHsgZXJyb3I6ICJObyBjaGFuZ2Vsb2cgZGF0YSBmb3VuZCIgfTsKCQkJfQoKCQkJcmV0dXJuIHsKCQkJCWVycm9yOiBudWxsLAoJCQkJbG9nX2RhdGE6IHZlcnNpb25zCgkJCX07CgkJfTsKCQl2YXIgZGlzcGxheSA9IGZ1bmN0aW9uIChjb250YWluZXIsIHRoZW1lKSB7CgkJCXZhciB2ZXJzaW9ucywgYXV0aG9ycywgY2hhbmdlcywKCQkJCWUsIG4xLCBuMiwgbjMsIG40LCBuNSwgaSwgaWksIGosIGpqLCBrLCBrazsKCgkJCWlmIChjaGFuZ2VfZGF0YSA9PT0gbnVsbCkgewoJCQkJbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1jaGFuZ2Vsb2ctbWVzc2FnZS1jb250YWluZXIiKTsKCQkJCSQuYWRkKG4xLCAkLm5vZGUoImRpdiIsICJ4bC1jaGFuZ2Vsb2ctbWVzc2FnZSIgKyB0aGVtZSwgIkxvYWRpbmcgY2hhbmdlbG9nLi4uIikpOwoJCQl9CgkJCWVsc2UgaWYgKChlID0gY2hhbmdlX2RhdGEuZXJyb3IpICE9PSBudWxsKSB7CgkJCQluMSA9ICQubm9kZSgiZGl2IiwgInhsLWNoYW5nZWxvZy1tZXNzYWdlLWNvbnRhaW5lciIpOwoJCQkJJC5hZGQobjEsIG4yID0gJC5ub2RlKCJkaXYiLCAieGwtY2hhbmdlbG9nLW1lc3NhZ2UgeGwtY2hhbmdlbG9nLW1lc3NhZ2UtZXJyb3IiICsgdGhlbWUpKTsKCQkJCSQuYWRkKG4yLCAkLm5vZGUoInN0cm9uZyIsICJ4bC1jaGFuZ2Vsb2ctbWVzc2FnZS1saW5lIiArIHRoZW1lLCAiRmFpbGVkIHRvIGxvYWQgY2hhbmdlbG9nOiIpKTsKCQkJCSQuYWRkKG4yLCAkLm5vZGVfc2ltcGxlKCJiciIpKTsKCQkJCSQuYWRkKG4yLCAkLm5vZGUoInNwYW4iLCAieGwtY2hhbmdlbG9nLW1lc3NhZ2UtbGluZSIgKyB0aGVtZSwgZSkpOwoJCQl9CgkJCWVsc2UgewoJCQkJbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1jaGFuZ2Vsb2ctZW50cmllcyIpOwoKCQkJCXZlcnNpb25zID0gY2hhbmdlX2RhdGEubG9nX2RhdGE7CgkJCQlmb3IgKGkgPSAwLCBpaSA9IHZlcnNpb25zLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImRpdiIsICJ4bC1jaGFuZ2Vsb2ctZW50cnkiICsgdGhlbWUpKTsKCQkJCQkkLmFkZChuMiwgJC5ub2RlKCJkaXYiLCAieGwtY2hhbmdlbG9nLWVudHJ5LXZlcnNpb24iICsgdGhlbWUsIHZlcnNpb25zW2ldLnZlcnNpb24pKTsKCQkJCQkkLmFkZChuMiwgbjMgPSAkLm5vZGUoImRpdiIsICJ4bC1jaGFuZ2Vsb2ctZW50cnktdXNlcnMiICsgdGhlbWUpKTsKCgkJCQkJYXV0aG9ycyA9IHZlcnNpb25zW2ldLmF1dGhvcnM7CgkJCQkJZm9yIChqID0gMCwgamogPSBhdXRob3JzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKCQkJCQkJJC5hZGQobjMsIG40ID0gJC5ub2RlKCJkaXYiLCAieGwtY2hhbmdlbG9nLWVudHJ5LXVzZXIiICsgdGhlbWUpKTsKCQkJCQkJJC5hZGQobjQsICQubm9kZSgiZGl2IiwgInhsLWNoYW5nZWxvZy1lbnRyeS11c2VyLW5hbWUiICsgdGhlbWUsIGF1dGhvcnNbal0uYXV0aG9yKSk7CgkJCQkJCSQuYWRkKG40LCBuNSA9ICQubm9kZSgidWwiLCAieGwtY2hhbmdlbG9nLWVudHJ5LWNoYW5nZXMiICsgdGhlbWUpKTsKCgkJCQkJCWNoYW5nZXMgPSBhdXRob3JzW2pdLmNoYW5nZXM7CgkJCQkJCWZvciAoayA9IDAsIGtrID0gY2hhbmdlcy5sZW5ndGg7IGsgPCBrazsgKytrKSB7CgkJCQkJCQkkLmFkZChuNSwgJC5ub2RlKCJsaSIsICJ4bC1jaGFuZ2Vsb2ctZW50cnktY2hhbmdlIiArIHRoZW1lLCBjaGFuZ2VzW2tdKSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCgkJCSQuYWRkKGNvbnRhaW5lciwgbjEpOwoJCX07CgkJdmFyIGFjcXVpcmUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKCQkJSHR0cFJlcXVlc3QoewoJCQkJbWV0aG9kOiAiR0VUIiwKCQkJCXVybDogTW9kdWxlLnVybCwKCQkJCW9ubG9hZDogZnVuY3Rpb24gKHhocikgewoJCQkJCWlmICh4aHIuc3RhdHVzID09PSAyMDApIHsKCQkJCQkJY2FsbGJhY2suY2FsbChudWxsLCBudWxsLCB4aHIucmVzcG9uc2VUZXh0KTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgJC54aHJfZXJyb3Jfc3RyaW5nKHhociksIG51bGwpOwoJCQkJCX0KCQkJCX0sCgkJCQlvbmVycm9yOiBmdW5jdGlvbiAoKSB7CgkJCQkJY2FsbGJhY2suY2FsbChudWxsLCAiQ29ubmVjdGlvbiBlcnJvciIsIG51bGwpOwoJCQkJfSwKCQkJCW9uYWJvcnQ6IGZ1bmN0aW9uICgpIHsKCQkJCQljYWxsYmFjay5jYWxsKG51bGwsICJDb25uZWN0aW9uIGFib3J0ZWQiLCBudWxsKTsKCQkJCX0KCQkJfSk7CgkJfTsKCgkJdmFyIG9uX2NoYW5nZWxvZ19nZXQgPSBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCWlmIChlcnIgIT09IG51bGwpIHsKCQkJCWNoYW5nZV9kYXRhID0geyBlcnJvcjogZXJyIH07CgkJCX0KCQkJZWxzZSB7CgkJCQljaGFuZ2VfZGF0YSA9IHBhcnNlKGRhdGEpOwoJCQl9CgoJCQlpZiAocG9wdXAgIT09IG51bGwpIHsKCQkJCXZhciBuID0gJCgiLnhsLWNoYW5nZWxvZy1jb250ZW50IiwgcG9wdXApOwoJCQkJaWYgKG4gIT09IG51bGwpIHsKCQkJCQluLmlubmVySFRNTCA9ICIiOwoJCQkJCWRpc3BsYXkobiwgVGhlbWUuY2xhc3Nlcyk7CgkJCQl9CgkJCX0KCQl9OwoJCXZhciBvbl9jbG9zZV9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCWNsb3NlKCk7CgkJCX0KCQl9OwoJCXZhciBvbl9jaGFuZ2Vfc2F2ZSA9IGZ1bmN0aW9uICgpIHsKCQkJY29uZmlnLmdlbmVyYWwuY2hhbmdlbG9nX29uX3VwZGF0ZSA9IHRoaXMuY2hlY2tlZDsKCQkJQ29uZmlnLnNhdmUoKTsKCQl9OwoKCQkvLyBQdWJsaWMKCQl2YXIgb3BlbiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7CgkJCWlmICghYWNxdWlyaW5nKSB7CgkJCQlhY3F1aXJpbmcgPSB0cnVlOwoJCQkJYWNxdWlyZShvbl9jaGFuZ2Vsb2dfZ2V0KTsKCQkJfQoKCQkJdmFyIHRoZW1lID0gVGhlbWUuY2xhc3NlczsKCgkJCXBvcHVwID0gUG9wdXAuY3JlYXRlKCJzZXR0aW5ncyIsIFtbewoJCQkJc21hbGw6IHRydWUsCgkJCQlzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcikgewoJCQkJCXZhciBjbHMgPSAiIjsKCQkJCQkkLmFkZChjb250YWluZXIsICQubGluayhNYWluLmhvbWVwYWdlLCAieGwtc2V0dGluZ3MtdGl0bGUiICsgdGhlbWUsIE1haW4udGl0bGUpKTsKCQkJCQlpZiAobWVzc2FnZSAhPT0gbnVsbCkgewoJCQkJCQkkLmFkZChjb250YWluZXIsICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy10aXRsZS1pbmZvIiArIHRoZW1lLCBtZXNzYWdlKSk7CgkJCQkJCWlmICgvXHMrJC8udGVzdChtZXNzYWdlKSkgewoJCQkJCQkJY2xzID0gIiB4bC1zZXR0aW5ncy12ZXJzaW9uLWxhcmdlIjsKCQkJCQkJfQoJCQkJCX0KCQkJCQkkLmFkZChjb250YWluZXIsICQubGluayhNb2R1bGUudXJsLCAieGwtc2V0dGluZ3MtdmVyc2lvbiIgKyBjbHMgKyB0aGVtZSwgTWFpbi52ZXJzaW9uLmpvaW4oIi4iKSkpOwoJCQkJfQoJCQl9LCB7CgkJCQlhbGlnbjogInJpZ2h0IiwKCQkJCXNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQkJdmFyIG4xLCBuMjsKCQkJCQkkLmFkZChjb250YWluZXIsIG4xID0gJC5ub2RlKCJsYWJlbCIsICJ4bC1zZXR0aW5ncy1idXR0b24iICsgdGhlbWUpKTsKCQkJCQkkLmFkZChuMSwgbjIgPSAkLm5vZGUoImlucHV0IiwgInhsLXNldHRpbmdzLWJ1dHRvbi1jaGVja2JveCIpKTsKCQkJCQkkLmFkZChuMSwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IHhsLXNldHRpbmdzLWJ1dHRvbi1jaGVja2JveC10ZXh0IiwgIiBTaG93IG9uIHVwZGF0ZSIpKTsKCQkJCQkkLmFkZChuMSwgJC5ub2RlKCJzcGFuIiwgInhsLXNldHRpbmdzLWJ1dHRvbi10ZXh0IHhsLXNldHRpbmdzLWJ1dHRvbi1jaGVja2JveC10ZXh0IiwgIiBEb24ndCBzaG93IG9uIHVwZGF0ZSIpKTsKCQkJCQluMi50eXBlID0gImNoZWNrYm94IjsKCQkJCQluMi5jaGVja2VkID0gY29uZmlnLmdlbmVyYWwuY2hhbmdlbG9nX29uX3VwZGF0ZTsKCQkJCQkkLm9uKG4yLCAiY2hhbmdlIiwgb25fY2hhbmdlX3NhdmUpOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4xID0gJC5saW5rKCIjIiwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4xLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtYnV0dG9uLXRleHQiLCAiQ2xvc2UiKSk7CgkJCQkJJC5vbihuMSwgImNsaWNrIiwgb25fY2xvc2VfY2xpY2spOwoJCQkJfQoJCQl9XSwgewoJCQkJYm9keTogdHJ1ZSwKCQkJCXBhZGRpbmc6IGZhbHNlLAoJCQkJc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXIpIHsKCQkJCQljb250YWluZXIuY2xhc3NMaXN0LmFkZCgieGwtY2hhbmdlbG9nLWNvbnRlbnQiKTsKCQkJCQlkaXNwbGF5KGNvbnRhaW5lciwgdGhlbWUpOwoJCQkJfQoJCQl9XSk7CgoJCQkkLm9uKHBvcHVwLCAiY2xpY2siLCBvbl9jbG9zZV9jbGljayk7CgkJCVBvcHVwLm9wZW4ocG9wdXApOwoJCX07CgkJdmFyIGNsb3NlID0gZnVuY3Rpb24gKCkgewoJCQlpZiAocG9wdXAgIT09IG51bGwpIHsKCQkJCVBvcHVwLmNsb3NlKHBvcHVwKTsKCQkJCXBvcHVwID0gbnVsbDsKCQkJfQoJCX07CgoJCS8vIEV4cG9ydHMKCQl2YXIgTW9kdWxlID0gewoJCQl1cmw6ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZG5zZXYtaC94LWxpbmtzL3N0YWJsZS9jaGFuZ2Vsb2ciLAoJCQlvcGVuOiBvcGVuLAoJCQljbG9zZTogY2xvc2UKCQl9OwoKCQlyZXR1cm4gTW9kdWxlOwoKCX0pKCk7Cgl2YXIgSGVhZGVyQmFyID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gUHJpdmF0ZQoJCXZhciBtZW51X25vZGVzID0gW10sCgkJCXNob3J0Y3V0X2ljb25zID0gW10sCgkJCWhlYWRlcl9iYXIgPSBudWxsLAoJCQltb2RlID0gbnVsbDsKCgkJdmFyIGFkZF9zdmdfaWNvbnMgPSBmdW5jdGlvbiAobm9kZXMpIHsKCQkJdmFyIHBhciA9IG51bGwsCgkJCQlpc19hcHBjaGFuID0gKG1vZGUgPT09ICJhcHBjaGFueCIpLAoJCQkJbmV4dCwgbjEsIG4yLCBpLCBpaTsKCgkJCWlmIChpc19hcHBjaGFuKSB7CgkJCQlpZiAoCgkJCQkJKG4xID0gJCgiI3Nob3J0Y3V0cyIsIGhlYWRlcl9iYXIucGFyZW50Tm9kZSkpICE9PSBudWxsICYmCgkJCQkJKG4yID0gJCgiYSNhcHBjaGFuLWdhbCIsIG4xKSB8fCAkKCJhLmEtaWNvbiIsIG4xKSkgIT09IG51bGwKCQkJCSkgewoJCQkJCXBhciA9IG4yLnBhcmVudE5vZGU7CgkJCQkJbmV4dCA9IG4yOwoJCQkJfQoJCQl9CgkJCWVsc2UgaWYgKG1vZGUgPT09ICI0Y2hhbngzIikgewoJCQkJaWYgKAoJCQkJCShuMSA9ICQoIiNzaG9ydGN1dHMiLCBoZWFkZXJfYmFyKSkgIT09IG51bGwgJiYKCQkJCQkobjIgPSAkKCJhLmZhLmZhLXBpY3R1cmUtbyIsIG4xKSB8fCAkKCJhLmZhIiwgbjEpKSAhPT0gbnVsbCAmJgoJCQkJCShuMiA9IG4yLnBhcmVudE5vZGUpICE9PSBudWxsCgkJCQkpIHsKCQkJCQlwYXIgPSBuMi5wYXJlbnROb2RlOwoJCQkJCW5leHQgPSBuMi5uZXh0U2libGluZzsKCQkJCX0KCQkJfQoKCQkJaWYgKHBhciA9PT0gbnVsbCkgcmV0dXJuOwoKCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQluMiA9IG5vZGVzW2ldOwoJCQkJaWYgKGlzX2FwcGNoYW4pIHsKCQkJCQluMi5jbGFzc0xpc3QuYWRkKCJ4bC1hcHBjaGFueCIpOwoJCQkJCW4yLmNsYXNzTGlzdC5hZGQoImEtaWNvbiIpOwoJCQkJCW4yLmNsYXNzTGlzdC5hZGQoInNob3J0Y3V0Iik7CgkJCQkJbjIuY2xhc3NMaXN0LmFkZCgiZmEiKTsKCQkJCQkkLmJlZm9yZShwYXIsIG5leHQsIG4yKTsKCQkJCQluMi5zdHlsZS5zZXRQcm9wZXJ0eSgiYmFja2dyb3VuZC1pbWFnZSIsICJub25lIiwgImltcG9ydGFudCIpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJbjEgPSAkLm5vZGUoInNwYW4iLCAic2hvcnRjdXQgYnJhY2tldHMtd3JhcCIpOwoJCQkJCSQuYWRkKG4xLCBuMik7CgkJCQkJJC5iZWZvcmUocGFyLCBuZXh0LCBuMSk7CgkJCQl9CgoJCQkJdXBkYXRlX3N2Z19jb2xvcihuMik7CgkJCX0KCgkJCWlmIChub2Rlcy5sZW5ndGggPiAwKSB7CgkJCQl1cGRhdGVfc3ZnX2NvbG9yX2NoYW5nZXMobm9kZXMpOwoJCQl9CgkJfTsKCgkJdmFyIHVwZGF0ZV9zdmdfY29sb3IgPSBmdW5jdGlvbiAobm9kZSkgewoJCQl2YXIgY29sb3IgPSBUaGVtZS5nZXRfY29tcHV0ZWRfc3R5bGUobm9kZSkuY29sb3IsCgkJCQluMTsKCgkJCWlmIChjb2xvciAmJiAobjEgPSAkKCJzdmciLCBub2RlKSkgIT09IG51bGwpIHsKCQkJCW4xLnNldEF0dHJpYnV0ZSgic3R5bGUiLCAiZmlsbDoiICsgY29sb3IgKyAiOyIpOwoJCQl9CgkJCW5vZGUuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWNvbG9yIiwgY29sb3IpOwoJCX07CgkJdmFyIHVwZGF0ZV9zdmdfY29sb3JfY2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlcykgewoJCQlUaGVtZS5vbigidGhlbWVfY2hhbmdlIiwgZnVuY3Rpb24gKCkgewoJCQkJdmFyIGksIGlpOwoJCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJdXBkYXRlX3N2Z19jb2xvcihub2Rlc1tpXSk7CgkJCQl9CgkJCX0pOwoJCX07CgoJCXZhciBvbl9oZWFkZXJfYmFyX2RldGVjdGVkID0gZnVuY3Rpb24gKG5vZGUpIHsKCQkJaGVhZGVyX2JhciA9IG5vZGU7CgoJCQlpZiAoJCgiI3Nob3J0Y3V0cyIsIG5vZGUpICE9PSBudWxsKSB7CgkJCQltb2RlID0gIjRjaGFueDMiOwoJCQl9CgkJCWVsc2UgaWYgKCQoIiNzaG9ydGN1dHMiLCBub2RlLnBhcmVudE5vZGUpICE9PSBudWxsKSB7CgkJCQltb2RlID0gImFwcGNoYW54IjsKCQkJCW5vZGUgPSAkKCIjaG92ZXJVSSIpOwoJCQl9CgoJCQkvLyBPYnNlcnZlcgoJCQlpZiAobm9kZSAhPT0gbnVsbCkgewoJCQkJbmV3IE11dGF0aW9uT2JzZXJ2ZXIob25faGVhZGVyX29ic2VydmUpLm9ic2VydmUobm9kZSwgewoJCQkJCWNoaWxkTGlzdDogdHJ1ZSwKCQkJCQlzdWJ0cmVlOiB0cnVlCgkJCQl9KTsKCQkJfQoKCQkJLy8gSWNvbnMKCQkJaWYgKHNob3J0Y3V0X2ljb25zLmxlbmd0aCA+IDApIHsKCQkJCWFkZF9zdmdfaWNvbnMoc2hvcnRjdXRfaWNvbnMpOwoJCQl9CgkJfTsKCQl2YXIgb25faWNvbl9tb3VzZW92ZXIgPSAkLndyYXBfbW91c2VlbnRlcmxlYXZlX2V2ZW50KGZ1bmN0aW9uICgpIHsKCQkJdmFyIG4gPSAkKCJzdmciLCB0aGlzKSwKCQkJCWM7CgoJCQlpZiAobiAhPT0gbnVsbCkgewoJCQkJYyA9IHRoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLWhvdmVyLWNvbG9yIik7CgkJCQlpZiAoIWMpIHsKCQkJCQljID0gVGhlbWUuZ2V0X2NvbXB1dGVkX3N0eWxlKHRoaXMpLmNvbG9yOwoJCQkJCXRoaXMuc2V0QXR0cmlidXRlKCJkYXRhLXhsLWhvdmVyLWNvbG9yIiwgYyk7CgkJCQl9CgkJCQluLnN0eWxlLmZpbGwgPSBjOwoJCQl9CgkJfSk7CgkJdmFyIG9uX2ljb25fbW91c2VvdXQgPSAkLndyYXBfbW91c2VlbnRlcmxlYXZlX2V2ZW50KGZ1bmN0aW9uICgpIHsKCQkJdmFyIG4gPSAkKCJzdmciLCB0aGlzKTsKCQkJaWYgKG4gIT09IG51bGwpIHsKCQkJCW4uc3R5bGUuZmlsbCA9IHRoaXMuZ2V0QXR0cmlidXRlKCJkYXRhLXhsLWNvbG9yIik7CgkJCX0KCQl9KTsKCQl2YXIgb25fbWVudV9pdGVtX21vdXNlb3ZlciA9ICQud3JhcF9tb3VzZWVudGVybGVhdmVfZXZlbnQoZnVuY3Rpb24gKCkgewoJCQl2YXIgZW50cmllcyA9ICQkKCIuZW50cnkiLCB0aGlzLnBhcmVudCksCgkJCQlpLCBpaTsKCQkJZm9yIChpID0gMCwgaWkgPSBlbnRyaWVzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWVudHJpZXNbaV0uY2xhc3NMaXN0LnJlbW92ZSgiZm9jdXNlZCIpOwoJCQl9CgkJCXRoaXMuY2xhc3NMaXN0LmFkZCgiZm9jdXNlZCIpOwoJCX0pOwoJCXZhciBvbl9tZW51X2l0ZW1fbW91c2VvdXQgPSAkLndyYXBfbW91c2VlbnRlcmxlYXZlX2V2ZW50KGZ1bmN0aW9uICgpIHsKCQkJdGhpcy5jbGFzc0xpc3QucmVtb3ZlKCJmb2N1c2VkIik7CgkJfSk7CgkJdmFyIG9uX21lbnVfaXRlbV9jbGljayA9IGZ1bmN0aW9uIChldmVudCkgewoJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQkJCWRvY3VtZW50X2VsZW1lbnQuY2xpY2soKTsKCQkJfQoJCX07CgkJdmFyIG9uX2JvZHlfb2JzZXJ2ZSA9IGZ1bmN0aW9uIChyZWNvcmRzKSB7CgkJCXZhciBub2Rlcywgbm9kZSwgaSwgaWksIGosIGpqOwoKCQkJZm9yIChpID0gMCwgaWkgPSByZWNvcmRzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWlmICgobm9kZXMgPSByZWNvcmRzW2ldLmFkZGVkTm9kZXMpKSB7CgkJCQkJZm9yIChqID0gMCwgamogPSBub2Rlcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJCW5vZGUgPSBub2Rlc1tqXTsKCQkJCQkJaWYgKG5vZGUuaWQgPT09ICJoZWFkZXItYmFyIikgewoJCQkJCQkJb25faGVhZGVyX2Jhcl9kZXRlY3RlZChub2RlKTsKCQkJCQkJCXRoaXMuZGlzY29ubmVjdCgpOwoJCQkJCQkJcmV0dXJuOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgb25faGVhZGVyX29ic2VydmUgPSBmdW5jdGlvbiAocmVjb3JkcykgewoJCQl2YXIgbm9kZXMsIG5vZGUsIGksIGlpLCBqLCBqajsKCgkJCWZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlpZiAoKG5vZGVzID0gcmVjb3Jkc1tpXS5hZGRlZE5vZGVzKSkgewoJCQkJCWZvciAoaiA9IDAsIGpqID0gbm9kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewoJCQkJCQlub2RlID0gbm9kZXNbal07CgkJCQkJCWlmIChub2RlLmlkID09PSAibWVudSIpIHsKCQkJCQkJCS8vIEFkZCBtZW51IGl0ZW1zIChpZiBpdCdzIHRoZSBtYWluIG1lbnUpCgkJCQkJCQlpZiAoJCgiLmVudHJ5LmRlbGV0ZS1saW5rIiwgbm9kZSkgPT09IG51bGwpIHsKCQkJCQkJCQlub2RlcyA9IG1lbnVfbm9kZXM7CgkJCQkJCQkJZm9yIChqID0gMCwgamogPSBub2Rlcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJCQkJCSQuYWRkKG5vZGUsIG5vZGVzW2pdKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQlyZXR1cm47CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9OwoKCQkvLyBQdWJsaWMKCQl2YXIgcmVhZHkgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBuID0gJCgiI2hlYWRlci1iYXIiKTsKCQkJaWYgKG4gIT09IG51bGwpIHsKCQkJCW9uX2hlYWRlcl9iYXJfZGV0ZWN0ZWQobik7CgkJCX0KCQkJZWxzZSB7CgkJCQluZXcgTXV0YXRpb25PYnNlcnZlcihvbl9ib2R5X29ic2VydmUpLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IGZhbHNlIH0pOwoJCQl9CgkJfTsKCQl2YXIgaW5zZXJ0X3Nob3J0Y3V0X2ljb24gPSBmdW5jdGlvbiAobmFtZXNwYWNlLCB0aXRsZSwgdXJsLCBvbl9jbGljaywgc3ZnX3NldHVwKSB7CgkJCXZhciBzdmducyA9ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsCgkJCQluMSwgc3ZnOwoKCQkJbjEgPSAkLmxpbmsodXJsLCAieGwtaGVhZGVyLWJhci1saW5rIHhsLWhlYWRlci1iYXItbGluay0iICsgbmFtZXNwYWNlKTsKCQkJbjEuc2V0QXR0cmlidXRlKCJ0aXRsZSIsIHRpdGxlKTsKCQkJJC5hZGQobjEsIHN2ZyA9ICQubm9kZV9ucyhzdmducywgInN2ZyIsICJ4bC1oZWFkZXItYmFyLXN2ZyB4bC1oZWFkZXItYmFyLXN2Zy0iICsgbmFtZXNwYWNlKSk7CgkJCXN2Zy5zZXRBdHRyaWJ1dGUoInZpZXdCb3giLCAiMCAwIDEwMCAxMDAiKTsKCQkJc3ZnLnNldEF0dHJpYnV0ZSgic3ZnbnMiLCBzdmducyk7CgkJCXN2Zy5zZXRBdHRyaWJ1dGUoInZlcnNpb24iLCAiMS4xIik7CgkJCXN2Z19zZXR1cChzdmcsIHN2Z25zKTsKCgkJCSQub24objEsICJtb3VzZW92ZXIiLCBvbl9pY29uX21vdXNlb3Zlcik7CgkJCSQub24objEsICJtb3VzZW91dCIsIG9uX2ljb25fbW91c2VvdXQpOwoJCQkkLm9uKG4xLCAiY2xpY2siLCBvbl9jbGljayk7CgoJCQlzaG9ydGN1dF9pY29ucy5wdXNoKG4xKTsKCgkJCWlmIChoZWFkZXJfYmFyICE9PSBudWxsKSBhZGRfc3ZnX2ljb25zKFsgbjEgXSk7CgoJCQlyZXR1cm4gbjE7CgkJfTsKCQl2YXIgaW5zZXJ0X21lbnVfbGluayA9IGZ1bmN0aW9uIChtZW51X25vZGUpIHsKCQkJbWVudV9ub2RlLmNsYXNzTGlzdC5hZGQoImVudHJ5Iik7CgkJCW1lbnVfbm9kZS5zdHlsZS5vcmRlciA9IDExMjsKCgkJCSQub24obWVudV9ub2RlLCAibW91c2VvdmVyIiwgb25fbWVudV9pdGVtX21vdXNlb3Zlcik7CgkJCSQub24obWVudV9ub2RlLCAibW91c2VvdXQiLCBvbl9tZW51X2l0ZW1fbW91c2VvdXQpOwoJCQkkLm9uKG1lbnVfbm9kZSwgImNsaWNrIiwgb25fbWVudV9pdGVtX2NsaWNrKTsKCgkJCW1lbnVfbm9kZXMucHVzaChtZW51X25vZGUpOwoJCX07CgoJCS8vIEV4cG9ydHMKCQlyZXR1cm4gewoJCQlyZWFkeTogcmVhZHksCgkJCWluc2VydF9zaG9ydGN1dF9pY29uOiBpbnNlcnRfc2hvcnRjdXRfaWNvbiwKCQkJaW5zZXJ0X21lbnVfbGluazogaW5zZXJ0X21lbnVfbGluawoJCX07CgoJfSkoKTsKCXZhciBOYXZpZ2F0aW9uID0gKGZ1bmN0aW9uICgpIHsKCgkJLy8gUHJpdmF0ZQoJCXZhciB3YWl0aW5nID0ge30sCgkJCXdhaXRpbmdfY291bnQgPSAwLAoJCQl3YWl0aW5nX29ic2VydmVyID0gbnVsbDsKCgkJdmFyIEZsYWdzID0gewoJCQlOb25lOiAweDAsCgkJCVByZXBlbmQ6IDB4MSwKCQkJQmVmb3JlOiAweDIsCgkJCUFmdGVyOiAweDQsCgkJCUlubmVyU3BhY2U6IDB4OCwKCQkJT3V0ZXJTcGFjZTogMHgxMCwKCQkJQnJhY2tldHM6IDB4MjAsCgkJCU1vYmlsZTogMHg0MCwKCQkJTG93ZXJDYXNlOiAweDgwCgkJfTsKCgkJdmFyIGNsZWFudXBfZnVuY3Rpb25zID0gewoJCQkiI25hdmJvdHJpZ2h0IjogZnVuY3Rpb24gKG5vZGUpIHsKCQkJCXZhciBsaW5rcyA9ICQkKCIueGwtbmF2LWxpbmsiLCBub2RlKSwKCQkJCQlsaW5rLCBuLCBpLCBpaTsKCgkJCQkvLyBSZW1vdmUgYmFkIGNvcGllcwoJCQkJZm9yIChpID0gMCwgaWkgPSBsaW5rcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJbGluayA9IGxpbmtzW2ldOwoJCQkJCWlmICgobiA9IGxpbmsucHJldmlvdXNTaWJsaW5nKSAhPT0gbnVsbCkgewoJCQkJCQkkLnJlbW92ZShuKTsKCQkJCQl9CgkJCQkJaWYgKChuID0gbGluay5uZXh0U2libGluZykgIT09IG51bGwgJiYgbi5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHsKCQkJCQkJbi5ub2RlVmFsdWUgPSBuLm5vZGVWYWx1ZS5yZXBsYWNlKC9eXHMqXF1ccyovLCAiIik7CgkJCQkJfQoJCQkJCSQucmVtb3ZlKGxpbmspOwoJCQkJfQoJCQl9CgkJfTsKCgkJdmFyIG9uX29ic2VydmVfYWxsID0gZnVuY3Rpb24gKHJlY29yZHMpIHsKCQkJdmFyIG5vZGVzLCBub2RlLCBsaXN0LCBmbiwgaSwgaWksIGosIGpqLCBrLCBtLCBtbTsKCgkJCWZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQlub2RlcyA9IHJlY29yZHNbaV0uYWRkZWROb2RlczsKCQkJCWlmIChub2RlcyAmJiAoamogPSBub2Rlcy5sZW5ndGgpID4gMCkgewoJCQkJCS8vIEFkZGVkIG5vZGVzCgkJCQkJZm9yIChrIGluIHdhaXRpbmcpIHsKCQkJCQkJZm9yIChqID0gMDsgaiA8IGpqOyArK2opIHsKCQkJCQkJCS8vIFNlbGVjdG9yIG1hdGNoZXMKCQkJCQkJCW5vZGUgPSBub2Rlc1tqXTsKCQkJCQkJCWlmICgKCQkJCQkJCQlub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSAmJgoJCQkJCQkJCSgkLnRlc3Qobm9kZSwgaykgfHwgKG5vZGUgPSAkKGssIG5vZGUpKSAhPT0gbnVsbCkKCQkJCQkJCSkgewoJCQkJCQkJCWZuID0gY2xlYW51cF9mdW5jdGlvbnNba107CgkJCQkJCQkJaWYgKGZuICE9PSB1bmRlZmluZWQpIHsKCQkJCQkJCQkJZm4uY2FsbChudWxsLCBub2RlKTsKCQkJCQkJCQl9CgoJCQkJCQkJCWxpc3QgPSB3YWl0aW5nW2tdOwoJCQkJCQkJCWZvciAobSA9IDAsIG1tID0gbGlzdC5sZW5ndGg7IG0gPCBtbTsgbSArPSAzKSB7CgkJCQkJCQkJCWxpc3RbbV0ubm9kZXMgPSBbIG5vZGUsIGxpc3RbbSArIDFdLCBsaXN0W20gKyAyXSBdOwoJCQkJCQkJCQlsaXN0W21dLmluc2VydCgpOwoJCQkJCQkJCX0KCgkJCQkJCQkJLS13YWl0aW5nX2NvdW50OwoJCQkJCQkJCWRlbGV0ZSB3YWl0aW5nW2tdOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQlpZiAod2FpdGluZ19jb3VudCA9PT0gMCkgewoJCQkJdGhpcy5kaXNjb25uZWN0KCk7CgkJCQl3YWl0aW5nX29ic2VydmVyID0gbnVsbDsKCQkJfQoJCX07CgoJCXZhciBMb2NhdGlvbkRhdGEgPSBmdW5jdGlvbiAodGV4dCwgdXJsLCBjbGFzc19uYW1lLCBvbl9jbGljaykgewoJCQl0aGlzLm5vZGVzID0gW107CgkJCXRoaXMudGV4dCA9IHRleHQ7CgkJCXRoaXMudXJsID0gdXJsOwoJCQl0aGlzLmNsYXNzX25hbWUgPSBjbGFzc19uYW1lOwoJCQl0aGlzLm9uX2NsaWNrID0gb25fY2xpY2s7CgkJfTsKCQlMb2NhdGlvbkRhdGEucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgZmxhZ3MsIHNlcGFyYXRvcikgewoJCQl2YXIgbm9kZSA9ICQoc2VsZWN0b3IpOwoJCQlpZiAobm9kZSAhPT0gbnVsbCkgewoJCQkJdGhpcy5ub2Rlcy5wdXNoKG5vZGUsIGZsYWdzLCBzZXBhcmF0b3IpOwoJCQl9CgkJCWVsc2UgewoJCQkJdmFyIGsgPSB3YWl0aW5nW3NlbGVjdG9yXTsKCQkJCWlmIChrID09PSB1bmRlZmluZWQpIHsKCQkJCQl3YWl0aW5nW3NlbGVjdG9yXSA9IGsgPSBbXTsKCQkJCQkrK3dhaXRpbmdfY291bnQ7CgkJCQl9CgkJCQlrLnB1c2godGhpcywgZmxhZ3MsIHNlcGFyYXRvcik7CgkJCQlpZiAod2FpdGluZ19vYnNlcnZlciA9PT0gbnVsbCkgewoJCQkJCXdhaXRpbmdfb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihvbl9vYnNlcnZlX2FsbCk7CgkJCQkJd2FpdGluZ19vYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOwoJCQkJfQoJCQl9CgkJfTsKCQlMb2NhdGlvbkRhdGEucHJvdG90eXBlLmFkZF9ub2RlID0gZnVuY3Rpb24gKG5vZGUsIGZsYWdzLCBzZXBhcmF0b3IpIHsKCQkJdGhpcy5ub2Rlcy5wdXNoKG5vZGUsIGZsYWdzLCBzZXBhcmF0b3IpOwoJCX07CgkJTG9jYXRpb25EYXRhLnByb3RvdHlwZS5hZGRfYWxsID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBmbGFncywgc2VwYXJhdG9yKSB7CgkJCXZhciBub2RlcyA9ICQkKHNlbGVjdG9yKSwKCQkJCWksIGlpOwoKCQkJZm9yIChpID0gMCwgaWkgPSBub2Rlcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQl0aGlzLm5vZGVzLnB1c2gobm9kZXNbaV0sIGZsYWdzLCBzZXBhcmF0b3IpOwoJCQl9CgkJfTsKCQlMb2NhdGlvbkRhdGEucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uICgpIHsKCQkJdmFyIGZpcnN0X21vYmlsZSA9IHRydWUsCgkJCQljb250YWluZXIsIGZsYWdzLCBub2RlLCBwYXIsIHByZSwgbmV4dCwgc2VwLCBpLCBpaSwgbjEsIHQsIHQyLCB0X29wdDsKCgkJCWZvciAoaSA9IDAsIGlpID0gdGhpcy5ub2Rlcy5sZW5ndGg7IGkgPCBpaTsgaSArPSAzKSB7CgkJCQlub2RlID0gdGhpcy5ub2Rlc1tpXTsKCQkJCWZsYWdzID0gdGhpcy5ub2Rlc1tpICsgMV07CgkJCQlzZXAgPSB0aGlzLm5vZGVzW2kgKyAyXTsKCgkJCQkvLyBUZXh0CgkJCQl0ID0gdGhpcy50ZXh0OwoJCQkJaWYgKChmbGFncyAmIEZsYWdzLklubmVyU3BhY2UpICE9PSAwKSB0ID0gIiAiICsgdCArICIgIjsKCgkJCQkvLyBDcmVhdGUKCQkJCWlmICgoZmxhZ3MgJiBGbGFncy5Nb2JpbGUpICE9PSAwKSB7CgkJCQkJcGFyID0gbm9kZS5wYXJlbnROb2RlOwoJCQkJCWNvbnRhaW5lciA9IGZpcnN0X21vYmlsZSA/IG5vZGUucHJldmlvdXNTaWJsaW5nIDogbm9kZS5uZXh0U2libGluZzsKCQkJCQlpZiAoY29udGFpbmVyID09PSBudWxsIHx8ICFjb250YWluZXIuY2xhc3NMaXN0IHx8ICFjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCJ4bC1uYXYtZXh0cmFzIikpIHsKCQkJCQkJY29udGFpbmVyID0gJC5ub2RlKCJkaXYiLCAibW9iaWxlIHhsLW5hdi1leHRyYXMtbW9iaWxlIik7CgkJCQkJfQoKCQkJCQkkLmFkZChjb250YWluZXIsIG4xID0gJC5ub2RlKCJzcGFuIiwgIm1vYmlsZWliIGJ1dHRvbiB4bC1uYXYtYnV0dG9uIiArIHRoaXMuY2xhc3NfbmFtZSkpOwoJCQkJCSQuYWRkKG4xLCAkLmxpbmsodGhpcy51cmwsICJ4bC1uYXYtYnV0dG9uLWlubmVyIiArIHRoaXMuY2xhc3NfbmFtZSwgdCkpOwoKCQkJCQlpZiAoZmlyc3RfbW9iaWxlKSB7CgkJCQkJCSQuYmVmb3JlKHBhciwgbm9kZSwgY29udGFpbmVyKTsKCQkJCQkJZmlyc3RfbW9iaWxlID0gZmFsc2U7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQkkLmFmdGVyKHBhciwgbm9kZSwgY29udGFpbmVyKTsKCQkJCQl9CgkJCQkJbm9kZSA9IGNvbnRhaW5lcjsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCW4xID0gJC5saW5rKHRoaXMudXJsLCAieGwtbmF2LWxpbmsiICsgdGhpcy5jbGFzc19uYW1lLCB0KTsKCQkJCX0KCQkJCSQub24objEsICJjbGljayIsIHRoaXMub25fY2xpY2spOwoKCQkJCS8vIENhc2UKCQkJCWlmICgoZmxhZ3MgJiBGbGFncy5Mb3dlckNhc2UpICE9PSAwKSB7CgkJCQkJbjEuc3R5bGUudGV4dFRyYW5zZm9ybSA9ICJsb3dlcmNhc2UiOwoJCQkJfQoKCQkJCS8vIFJlbGF0aXZlCgkJCQlpZiAoKGZsYWdzICYgRmxhZ3MuQmVmb3JlKSAhPT0gMCkgewoJCQkJCXBhciA9IG5vZGUucGFyZW50Tm9kZTsKCQkJCQluZXh0ID0gbm9kZTsKCQkJCX0KCQkJCWVsc2UgaWYgKChmbGFncyAmIEZsYWdzLkFmdGVyKSAhPT0gMCkgewoJCQkJCXBhciA9IG5vZGUucGFyZW50Tm9kZTsKCQkJCQluZXh0ID0gbm9kZS5uZXh0U2libGluZzsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCXBhciA9IG5vZGU7CgkJCQkJbmV4dCA9ICgoZmxhZ3MgJiBGbGFncy5QcmVwZW5kKSAhPT0gMCkgPyBub2RlLmZpcnN0Q2hpbGQgOiBudWxsOwoJCQkJfQoKCQkJCS8vIE5vZGUKCQkJCSQuYmVmb3JlKHBhciwgbmV4dCwgbjEpOwoKCQkJCS8vIEJyYWNrZXRzCgkJCQlpZiAoKGZsYWdzICYgRmxhZ3MuQnJhY2tldHMpICE9PSAwKSB7CgkJCQkJdCA9ICgoZmxhZ3MgJiBGbGFncy5PdXRlclNwYWNlKSAhPT0gMCkgPyAiXSAiIDogIl0iOwoJCQkJCXQyID0gKChmbGFncyAmIEZsYWdzLk91dGVyU3BhY2UpICE9PSAwKSA/ICIgWyIgOiAiWyI7CgkJCQkJdF9vcHQgPSBmYWxzZTsKCQkJCX0KCQkJCWVsc2UgaWYgKChmbGFncyAmIEZsYWdzLk91dGVyU3BhY2UpICE9PSAwKSB7CgkJCQkJdCA9ICIgIjsKCQkJCQl0MiA9ICIgIjsKCQkJCQl0X29wdCA9IHRydWU7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQl0ID0gbnVsbDsKCQkJCX0KCQkJCWlmICh0ICE9PSBudWxsKSB7CgkJCQkJaWYgKG5leHQgIT09IG51bGwpIHsKCQkJCQkJaWYgKHNlcCAhPT0gdW5kZWZpbmVkKSB0ID0gKChmbGFncyAmIEZsYWdzLk91dGVyU3BhY2UpICE9PSAwID8gIiAiIDogIiIpICsgc2VwICsgdDsKCQkJCQkJaWYgKG5leHQubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7CgkJCQkJCQluZXh0Lm5vZGVWYWx1ZSA9IHQgKyBuZXh0Lm5vZGVWYWx1ZS5yZXBsYWNlKC9eXHMqLywgIiIpOwoJCQkJCQl9CgkJCQkJCWVsc2UgewoJCQkJCQkJJC5hZnRlcihwYXIsIG4xLCAkLnRub2RlKHQpKTsKCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlIGlmICghdF9vcHQpIHsKCQkJCQkJJC5hZnRlcihwYXIsIG4xLCAkLnRub2RlKHQpKTsKCQkJCQl9CgoJCQkJCXByZSA9IG4xLnByZXZpb3VzU2libGluZzsKCQkJCQlpZiAocHJlICE9PSBudWxsKSB7CgkJCQkJCWlmIChzZXAgIT09IHVuZGVmaW5lZCkgdCArPSBzZXAgKyAoKGZsYWdzICYgRmxhZ3MuT3V0ZXJTcGFjZSkgIT09IDAgPyAiICIgOiAiIik7CgkJCQkJCWlmIChwcmUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7CgkJCQkJCQlwcmUubm9kZVZhbHVlID0gcHJlLm5vZGVWYWx1ZS5yZXBsYWNlKC9ccyokLywgIiIpICsgdDI7CgkJCQkJCX0KCQkJCQkJZWxzZSB7CgkJCQkJCQkkLmJlZm9yZShwYXIsIG4xLCAkLnRub2RlKHQyKSk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJZWxzZSBpZiAoIXRfb3B0KSB7CgkJCQkJCSQuYmVmb3JlKHBhciwgbjEsICQudG5vZGUodDIpKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCXRoaXMubm9kZXMgPSBudWxsOwoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciBpbnNlcnRfbGluayA9IGZ1bmN0aW9uIChtb2RlLCB0ZXh0LCB1cmwsIGNsYXNzX25hbWUsIG9uX2NsaWNrKSB7CgkJCXZhciBsb2NhdGlvbnMgPSBuZXcgTG9jYXRpb25EYXRhKHRleHQsIHVybCwgY2xhc3NfbmFtZSwgb25fY2xpY2spLAoJCQkJbm9kZXMsIG5vZGUsIGNsLCBpLCBpaTsKCgkJCWlmIChDb25maWcuaXNfNGNoYW4pIHsKCQkJCWlmIChtb2RlID09PSAibWFpbiIpIHsKCQkJCQlsb2NhdGlvbnMuYWRkKCIjbmF2dG9wcmlnaHQiLCBGbGFncy5PdXRlclNwYWNlIHwgRmxhZ3MuQnJhY2tldHMgfCBGbGFncy5QcmVwZW5kKTsKCQkJCQlsb2NhdGlvbnMuYWRkKCIjbmF2Ym90cmlnaHQiLCBGbGFncy5PdXRlclNwYWNlIHwgRmxhZ3MuQnJhY2tldHMgfCBGbGFncy5QcmVwZW5kKTsKCQkJCQlsb2NhdGlvbnMuYWRkKCIjc2V0dGluZ3NXaW5kb3dMaW5rTW9iaWxlIiwgRmxhZ3MuQmVmb3JlKTsKCQkJCQlsb2NhdGlvbnMuYWRkKCIjc2V0dGluZ3NXaW5kb3dMaW5rQ2xhc3NpYyIsIEZsYWdzLkJlZm9yZSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQljbCA9IGRvY3VtZW50X2VsZW1lbnQuY2xhc3NMaXN0OwoJCQkJCWlmICgKCQkJCQkJIWNsLmNvbnRhaW5zKCJjYXRhbG9nLW1vZGUiKSAmJgoJCQkJCQkhY2wuY29udGFpbnMoImFyY2hpdmUiKSAmJgoJCQkJCQkkKCIjb3JkZXItY3RybCwjYXJjLWxpc3QiKSA9PT0gbnVsbAoJCQkJCSkgewoJCQkJCQlub2RlcyA9ICQkKCIjY3RybC10b3AsLm5hdkxpbmtzIik7CgkJCQkJCWZvciAoaSA9IDAsIGlpID0gbm9kZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQkJbm9kZSA9IG5vZGVzW2ldOwoJCQkJCQkJbG9jYXRpb25zLmFkZF9ub2RlKAoJCQkJCQkJCW5vZGUsCgkJCQkJCQkJKG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJtb2JpbGUiKSA/IEZsYWdzLk1vYmlsZSA6IChGbGFncy5PdXRlclNwYWNlIHwgRmxhZ3MuQnJhY2tldHMpKQoJCQkJCQkJKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCQllbHNlIGlmIChDb25maWcuaXNfZm9vbHopIHsKCQkJCWxvY2F0aW9ucy5hZGRfYWxsKCIubGV0dGVycyIsIEZsYWdzLklubmVyU3BhY2UgfCBGbGFncy5PdXRlclNwYWNlIHwgRmxhZ3MuQnJhY2tldHMpOwoJCQl9CgkJCWVsc2UgaWYgKENvbmZpZy5pc19mdXVrYSkgewoJCQkJbG9jYXRpb25zLmFkZCgiYm9keT5kaXY6Zmlyc3QtY2hpbGQiLCBGbGFncy5Jbm5lclNwYWNlIHwgRmxhZ3MuT3V0ZXJTcGFjZSB8IEZsYWdzLkJyYWNrZXRzKTsKCQkJfQoJCQllbHNlIGlmIChDb25maWcuaXNfdGlueWJvYXJkKSB7CgkJCQlsb2NhdGlvbnMuYWRkX2FsbCgiLmJvYXJkbGlzdCIsIEZsYWdzLklubmVyU3BhY2UgfCBGbGFncy5PdXRlclNwYWNlIHwgRmxhZ3MuQnJhY2tldHMgfCBGbGFncy5Mb3dlckNhc2UpOwoJCQl9CgkJCWVsc2UgaWYgKENvbmZpZy5pc19pcGIpIHsKCQkJCWxvY2F0aW9ucy5hZGQoIiNsaXZlY2hhdCIsIEZsYWdzLlByZXBlbmQgfCBGbGFncy5PdXRlclNwYWNlKTsKCQkJfQoJCQllbHNlIGlmIChDb25maWcuaXNfaXBiX2xvZmkpIHsKCQkJCWxvY2F0aW9ucy5hZGQoIi5pcGJuYXZzbWFsbCIsIEZsYWdzLlByZXBlbmQgfCBGbGFncy5PdXRlclNwYWNlLCAiLSIpOwoJCQl9CgkJCWVsc2UgaWYgKENvbmZpZy5pc19tZWd1Y2EpIHsKCQkJCWxvY2F0aW9ucy5hZGQoIiNiYW5uZXItZXh0ZW5zaW9ucyIsIEZsYWdzLk91dGVyU3BhY2UgfCBGbGFncy5CcmFja2V0cyk7CgkJCX0KCgkJCWxvY2F0aW9ucy5pbnNlcnQoKTsKCQl9OwoKCQkvLyBFeHBvcnRzCgkJcmV0dXJuIHsKCQkJaW5zZXJ0X2xpbms6IGluc2VydF9saW5rCgkJfTsKCgl9KSgpOwoJdmFyIEV4dGVuc2lvbkFQSSA9IChmdW5jdGlvbiAoKSB7CgoJCS8vIFByaXZhdGUKCQl2YXIgaW50ZXJuYWxpemF0aW9uX2FsbG93ZWQgPSB0cnVlOwoKCQl2YXIgdHRsXzFfaG91ciA9IDYwICogNjAgKiAxMDAwOwoJCXZhciB0dGxfMV9kYXkgPSAyNCAqIHR0bF8xX2hvdXI7CgkJdmFyIHR0bF8xX3llYXIgPSAzNjUgKiB0dGxfMV9kYXk7CgoJCXZhciByYW5kb21fc3RyaW5nX2FscGhhYmV0ID0gImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IjsKCQl2YXIgcmFuZG9tX3N0cmluZyA9IGZ1bmN0aW9uIChjb3VudCkgewoJCQl2YXIgYWxwaGFfbGVuID0gcmFuZG9tX3N0cmluZ19hbHBoYWJldC5sZW5ndGgsCgkJCQlzID0gIiIsCgkJCQlpOwoJCQlmb3IgKGkgPSAwOyBpIDwgY291bnQ7ICsraSkgewoJCQkJcyArPSByYW5kb21fc3RyaW5nX2FscGhhYmV0W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFscGhhX2xlbildOwoJCQl9CgkJCXJldHVybiBzOwoJCX07CgoJCXZhciBpc19vYmplY3QgPSBmdW5jdGlvbiAob2JqKSB7CgkJCXJldHVybiAob2JqICE9PSBudWxsICYmIHR5cGVvZihvYmopID09PSAib2JqZWN0Iik7CgkJfTsKCgkJdmFyIGdldF9zaGFyZWRfbm9kZSA9IGZ1bmN0aW9uIChpZCkgewoJCQl2YXIgcGFyLCBuOwoKCQkJaWYgKAoJCQkJaWQgPT09IG51bGwgfHwKCQkJCShwYXIgPSAkKCIueGwtZXh0ZW5zaW9uLXNoYXJpbmctZWxlbWVudHMiKSkgPT09IG51bGwgfHwKCQkJCShuID0gZ2V0X3NoYXJlZF9ub2RlX2J5X2lkKHBhciwgaWQpKSA9PT0gbnVsbAoJCQkpIHsKCQkJCXJldHVybiBudWxsOwoJCQl9CgoJCQluLnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS14bC1zaGFyaW5nLWlkIik7CgkJCSQucmVtb3ZlKG4pOwoJCQlpZiAocGFyLmZpcnN0Q2hpbGQgPT09IG51bGwpICQucmVtb3ZlKHBhcik7CgoJCQlyZXR1cm4gbjsKCQl9OwoJCXZhciBnZXRfc2hhcmVkX25vZGVfYnlfaWQgPSBmdW5jdGlvbiAocGFyZW50LCBpZCkgewoJCQl0cnkgewoJCQkJcmV0dXJuICQoIltkYXRhLXhsLXNoYXJpbmctaWQ9JyIgKyBpZCArICInXSIsIHBhcmVudCk7CgkJCX0KCQkJY2F0Y2ggKGUpIHt9CgkJCXJldHVybiBudWxsOwoJCX07CgoJCXZhciBkaXNhYmxlZF9leHRlbnNpb25zX2tleSA9ICJ4bGlua3MtZXh0ZW5zaW9ucy1kaXNhYmxlZCI7CgkJdmFyIGRpc2FibGVkX2V4dGVuc2lvbnM7CgkJdmFyIHNhdmVfZXh0ZW5zaW9uc19lbmFibGVkX3N0YXRlcyA9IGZ1bmN0aW9uICgpIHsKCQkJdmFyIHNhdmVfZGF0YSA9IFtdLAoJCQkJaSwgaWksIHI7CgoJCQlmb3IgKGkgPSAwLCBpaSA9IHJlZ2lzdGVyZWQubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJciA9IHJlZ2lzdGVyZWRbaV07CgkJCQlpZiAoIXJbMF0pIHsKCQkJCQlzYXZlX2RhdGEucHVzaChbIHJbMV0sIHJbMl0sIHJbM10gXSk7CgkJCQl9CgkJCX0KCgkJCWlmIChzYXZlX2RhdGEubGVuZ3RoID4gMCkgewoJCQkJQ29uZmlnLnN0b3JhZ2Uuc2V0SXRlbShkaXNhYmxlZF9leHRlbnNpb25zX2tleSwgSlNPTi5zdHJpbmdpZnkoc2F2ZV9kYXRhKSk7CgkJCQlkaXNhYmxlZF9leHRlbnNpb25zID0gc2F2ZV9kYXRhOwoJCQl9CgkJCWVsc2UgewoJCQkJQ29uZmlnLnN0b3JhZ2UucmVtb3ZlSXRlbShkaXNhYmxlZF9leHRlbnNpb25zX2tleSk7CgkJCQlkaXNhYmxlZF9leHRlbnNpb25zID0gbnVsbDsKCQkJfQoJCX07CgkJdmFyIHNldF9leHRlbnNpb25zX2VuYWJsZWQgPSBmdW5jdGlvbiAoZW5hYmxlZF9hcnJheSkgewoJCQlpZiAoZW5hYmxlZF9hcnJheSA9PT0gbnVsbCkgcmV0dXJuOwoKCQkJZm9yICh2YXIgaSA9IDAsIGlpID0gTWF0aC5taW4ocmVnaXN0ZXJlZC5sZW5ndGgsIGVuYWJsZWRfYXJyYXkubGVuZ3RoKTsgaSA8IGlpOyArK2kpIHsKCQkJCXJlZ2lzdGVyZWRbaV1bMF0gPSBlbmFibGVkX2FycmF5W2ldOwoJCQl9CgkJCXNhdmVfZXh0ZW5zaW9uc19lbmFibGVkX3N0YXRlcygpOwoJCX07CgkJdmFyIGV4dGVuc2lvbl9pc19lbmFibGVkID0gZnVuY3Rpb24gKG5hbWUsIGF1dGhvciwgZGVzY3JpcHRpb24pIHsKCQkJaWYgKGRpc2FibGVkX2V4dGVuc2lvbnMgPT09IHVuZGVmaW5lZCkgewoJCQkJdHJ5IHsKCQkJCQlkaXNhYmxlZF9leHRlbnNpb25zID0gJC5qc29uX3BhcnNlX3NhZmUoQ29uZmlnLnN0b3JhZ2UuZ2V0SXRlbShkaXNhYmxlZF9leHRlbnNpb25zX2tleSksIG51bGwpOwoJCQkJfQoJCQkJY2F0Y2ggKGUpIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0KCQkJaWYgKGRpc2FibGVkX2V4dGVuc2lvbnMgPT09IG51bGwpIHJldHVybiB0cnVlOwoKCQkJdmFyIGksIGlpLCByOwoJCQlmb3IgKGkgPSAwLCBpaSA9IGRpc2FibGVkX2V4dGVuc2lvbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJciA9IGRpc2FibGVkX2V4dGVuc2lvbnNbaV07CgkJCQlpZiAoclswXSA9PT0gbmFtZSAmJiByWzFdID09PSBhdXRob3IgJiYgclsyXSA9PT0gZGVzY3JpcHRpb24pIHJldHVybiBmYWxzZTsKCQkJfQoKCQkJcmV0dXJuIHRydWU7CgkJfTsKCgkJdmFyIHJlZ2lzdGVyZWQgPSBbXTsKCgoJCXZhciBDb21tdW5pY2F0aW9uQ2hhbm5lbCA9IGZ1bmN0aW9uIChuYW1lLCBrZXksIGlzX2V4dGVuc2lvbiwgY2hhbm5lbCwgY2FsbGJhY2spIHsKCQkJdmFyIHNlbGYgPSB0aGlzOwoKCQkJdGhpcy5wb3J0ID0gbnVsbDsKCQkJdGhpcy5wb3J0X290aGVyID0gbnVsbDsKCQkJdGhpcy5wb3N0ID0gbnVsbDsKCQkJdGhpcy5vbl9tZXNzYWdlID0gbnVsbDsKCQkJdGhpcy5vcmlnaW4gPSBudWxsOwoJCQl0aGlzLm5hbWVfa2V5ID0gbnVsbDsKCQkJdGhpcy5pc19leHRlbnNpb24gPSBpc19leHRlbnNpb247CgkJCXRoaXMubmFtZSA9IG5hbWU7CgkJCXRoaXMua2V5ID0ga2V5OwoJCQl0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7CgoJCQlpZiAoY2hhbm5lbCA9PT0gbnVsbCkgewoJCQkJdGhpcy5uYW1lX2tleSA9IG5hbWU7CgkJCQlpZiAoa2V5ICE9PSBudWxsKSB7CgkJCQkJdGhpcy5uYW1lX2tleSArPSAiXyI7CgkJCQkJdGhpcy5uYW1lX2tleSArPSBrZXk7CgkJCQl9CgkJCQl0aGlzLm9yaWdpbiA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArICIvLyIgKyB3aW5kb3cubG9jYXRpb24uaG9zdDsKCQkJCXRoaXMucG9zdCA9IHRoaXMucG9zdF93aW5kb3c7CgkJCQl0aGlzLm9uX21lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJCQlzZWxmLm9uX3dpbmRvd19tZXNzYWdlKGV2ZW50KTsKCQkJCX07CgkJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIHRoaXMub25fbWVzc2FnZSwgZmFsc2UpOwoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5wb3J0ID0gY2hhbm5lbC5wb3J0MTsKCQkJCXRoaXMucG9ydF9vdGhlciA9IGNoYW5uZWwucG9ydDI7CgkJCQl0aGlzLnBvc3QgPSB0aGlzLnBvc3RfY2hhbm5lbDsKCQkJCXRoaXMub25fbWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkgewoJCQkJCXNlbGYub25fcG9ydF9tZXNzYWdlKGV2ZW50KTsKCQkJCX07CgkJCQl0aGlzLnBvcnQuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIHRoaXMub25fbWVzc2FnZSwgZmFsc2UpOwoJCQkJdGhpcy5wb3J0LnN0YXJ0KCk7CgkJCX0KCQl9OwoKCQlDb21tdW5pY2F0aW9uQ2hhbm5lbC5jcmVhdGVfY2hhbm5lbCA9IGZ1bmN0aW9uICgpIHsKCQkJdHJ5IHsKCQkJCXJldHVybiBuZXcgd2luZG93Lk1lc3NhZ2VDaGFubmVsKCk7CgkJCX0KCQkJY2F0Y2ggKGUpIHt9CgkJCXJldHVybiBudWxsOwoJCX07CgkJQ29tbXVuaWNhdGlvbkNoYW5uZWwucHJvdG90eXBlLnBvc3Rfd2luZG93ID0gZnVuY3Rpb24gKG1lc3NhZ2UsIHRyYW5zZmVyKSB7CgkJCXZhciBtc2cgPSB7CgkJCQlleHQ6IHRoaXMuaXNfZXh0ZW5zaW9uLAoJCQkJa2V5OiB0aGlzLm5hbWVfa2V5LAoJCQkJZGF0YTogbWVzc2FnZQoJCQl9OwoKCQkJdHJ5IHsKCQkJCXdpbmRvdy5wb3N0TWVzc2FnZShtc2csIHRoaXMub3JpZ2luLCB0cmFuc2Zlcik7CgkJCX0KCQkJY2F0Y2ggKGUpIHsKCQkJCS8vIFRhbXBlcm1vbmtleSBidWcKCQkJCXRyeSB7CgkJCQkJdW5zYWZlV2luZG93LnBvc3RNZXNzYWdlKG1zZywgdGhpcy5vcmlnaW4sIHRyYW5zZmVyKTsKCQkJCX0KCQkJCWNhdGNoIChlMikge30KCQkJfQoJCX07CgkJQ29tbXVuaWNhdGlvbkNoYW5uZWwucHJvdG90eXBlLnBvc3RfY2hhbm5lbCA9IGZ1bmN0aW9uIChtZXNzYWdlLCB0cmFuc2ZlcikgewoJCQl0aGlzLnBvcnQucG9zdE1lc3NhZ2UobWVzc2FnZSwgdHJhbnNmZXIpOwoJCX07CgkJQ29tbXVuaWNhdGlvbkNoYW5uZWwucHJvdG90eXBlLnBvc3RfbnVsbCA9IGZ1bmN0aW9uICgpIHsKCQl9OwoJCUNvbW11bmljYXRpb25DaGFubmVsLnByb3RvdHlwZS5vbl93aW5kb3dfbWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkgewoJCQl2YXIgZGF0YSA9IGV2ZW50LmRhdGE7CgkJCWlmICgKCQkJCWV2ZW50Lm9yaWdpbiA9PT0gdGhpcy5vcmlnaW4gJiYKCQkJCWlzX29iamVjdChkYXRhKSAmJgoJCQkJZGF0YS5leHQgPT09ICghdGhpcy5pc19leHRlbnNpb24pICYmIC8vIGpzaGludCBpZ25vcmU6bGluZQoJCQkJZGF0YS5rZXkgPT09IHRoaXMubmFtZV9rZXkgJiYKCQkJCWlzX29iamVjdCgoZGF0YSA9IGRhdGEuZGF0YSkpCgkJCSkgewoJCQkJdGhpcy5jYWxsYmFjayhldmVudCwgZGF0YSwgdGhpcyk7CgkJCX0KCQl9OwoJCUNvbW11bmljYXRpb25DaGFubmVsLnByb3RvdHlwZS5vbl9wb3J0X21lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHsKCQkJdmFyIGRhdGEgPSBldmVudC5kYXRhOwoJCQlpZiAoaXNfb2JqZWN0KGRhdGEpKSB7CgkJCQl0aGlzLmNhbGxiYWNrKGV2ZW50LCBkYXRhLCB0aGlzKTsKCQkJfQoJCX07CgkJQ29tbXVuaWNhdGlvbkNoYW5uZWwucHJvdG90eXBlLmdldF9wb3J0X3RyYW5zZmVyID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgcCA9IHRoaXMucG9ydF9vdGhlcjsKCQkJdGhpcy5wb3J0X290aGVyID0gbnVsbDsKCQkJcmV0dXJuIChwID09PSBudWxsID8gW10gOiBbIHAgXSk7CgkJfTsKCQlDb21tdW5pY2F0aW9uQ2hhbm5lbC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7CgkJCWlmICh0aGlzLm9uX21lc3NhZ2UgIT09IG51bGwpIHsKCQkJCWlmICh0aGlzLnBvcnQgPT09IG51bGwpIHsKCQkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIHRoaXMub25fbWVzc2FnZSwgZmFsc2UpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJdGhpcy5wb3J0LnJlbW92ZUV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCB0aGlzLm9uX21lc3NhZ2UsIGZhbHNlKTsKCQkJCQl0aGlzLnBvcnQuY2xvc2UoKTsKCQkJCQl0aGlzLnBvcnQgPSBudWxsOwoJCQkJfQoJCQkJdGhpcy5vbl9tZXNzYWdlID0gbnVsbDsKCQkJCXRoaXMucG9zdCA9IHRoaXMucG9zdF9udWxsOwoJCQl9CgkJfTsKCgoJCXZhciBhcGkgPSBudWxsOwoJCXZhciBFeHRlbnNpb25BUEkgPSBmdW5jdGlvbiAoKSB7CgkJCXRoaXMuZXZlbnQgPSBudWxsOwoJCQl0aGlzLnJlcGx5X2NhbGxiYWNrcyA9IHt9OwoKCQkJdGhpcy5yZWdpc3RyYXRpb24gPSBudWxsOwoJCQl0aGlzLnJlZ2lzdHJhdGlvbnMgPSB7fTsKCQkJdGhpcy5yZXF1ZXN0X2FwaXMgPSB7fTsKCgkJCXZhciBzZWxmID0gdGhpczsKCQkJdGhpcy5icm9hZGNhc3QgPSBuZXcgQ29tbXVuaWNhdGlvbkNoYW5uZWwoCgkJCQkieGxpbmtzX2Jyb2FkY2FzdCIsCgkJCQludWxsLAoJCQkJZmFsc2UsCgkJCQludWxsLAoJCQkJZnVuY3Rpb24gKGV2ZW50LCBkYXRhLCBjaGFubmVsKSB7CgkJCQkJc2VsZi5vbl9tZXNzYWdlKGV2ZW50LCBkYXRhLCBjaGFubmVsLCBFeHRlbnNpb25BUEkuaGFuZGxlcnNfaW5pdCk7CgkJCQl9CgkJCSk7CgkJfTsKCQlFeHRlbnNpb25BUEkucHJvdG90eXBlLm9uX21lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQsIGRhdGEsIGNoYW5uZWwsIGhhbmRsZXJzKSB7CgkJCXZhciBhY3Rpb24gPSBkYXRhLnhsaW5rc19hY3Rpb24sCgkJCQlhY3Rpb25faXNfbnVsbCA9IChhY3Rpb24gPT09IG51bGwpLAoJCQkJYWN0aW9uX2RhdGEsIHJlcGx5LCBmbiwgZXJyOwoKCQkJaWYgKAoJCQkJKGFjdGlvbl9pc19udWxsIHx8IHR5cGVvZihhY3Rpb24pID09PSAic3RyaW5nIikgJiYKCQkJCWlzX29iamVjdCgoYWN0aW9uX2RhdGEgPSBkYXRhLmRhdGEpKQoJCQkpIHsKCQkJCXJlcGx5ID0gZGF0YS5yZXBseTsKCQkJCWlmICh0eXBlb2YocmVwbHkpID09PSAic3RyaW5nIikgewoJCQkJCWlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcy5yZXBseV9jYWxsYmFja3MsIHJlcGx5KSkgewoJCQkJCQlmbiA9IHRoaXMucmVwbHlfY2FsbGJhY2tzW3JlcGx5XTsKCQkJCQkJZGVsZXRlIHRoaXMucmVwbHlfY2FsbGJhY2tzW3JlcGx5XTsKCQkJCQkJdGhpcy5ldmVudCA9IGV2ZW50OwoJCQkJCQlmbi5jYWxsKHRoaXMsIG51bGwsIGFjdGlvbl9kYXRhKTsKCQkJCQkJdGhpcy5ldmVudCA9IG51bGw7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQllcnIgPSAiQ2Fubm90IHJlcGx5IHRvIGV4dGVuc2lvbiI7CgkJCQkJfQoJCQkJfQoJCQkJZWxzZSBpZiAoYWN0aW9uX2lzX251bGwpIHsKCQkJCQllcnIgPSAiTWlzc2luZyBleHRlbnNpb24gYWN0aW9uIjsKCQkJCX0KCQkJCWVsc2UgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChoYW5kbGVycywgYWN0aW9uKSkgewoJCQkJCWhhbmRsZXJzW2FjdGlvbl0uY2FsbCh0aGlzLCBhY3Rpb25fZGF0YSwgY2hhbm5lbCwgZGF0YS5pZCk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQllcnIgPSAiSW52YWxpZCBleHRlbnNpb24gY2FsbCI7CgkJCQl9CgoJCQkJaWYgKGVyciAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZigocmVwbHkgPSBkYXRhLmlkKSkgPT09ICJzdHJpbmciKSB7CgkJCQkJdGhpcy5zZW5kKAoJCQkJCQljaGFubmVsLAoJCQkJCQludWxsLAoJCQkJCQlyZXBseSwKCQkJCQkJeyBlcnI6ICJJbnZhbGlkIGV4dGVuc2lvbiBjYWxsIiB9CgkJCQkJKTsKCQkJCX0KCQkJfQoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKGNoYW5uZWwsIGFjdGlvbiwgcmVwbHlfdG8sIGRhdGEsIHRpbWVvdXRfZGVsYXksIG9uX3JlcGx5LCB0cmFuc2ZlcikgewoJCQl2YXIgc2VsZiA9IHRoaXMsCgkJCQlpZCA9IG51bGwsCgkJCQl0aW1lb3V0ID0gbnVsbCwKCQkJCWNiLCBpOwoKCQkJaWYgKG9uX3JlcGx5ICE9PSB1bmRlZmluZWQpIHsKCQkJCWZvciAoaSA9IDA7IGkgPCAxMDsgKytpKSB7CgkJCQkJaWQgPSByYW5kb21fc3RyaW5nKDMyKTsKCQkJCQlpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLnJlcGx5X2NhbGxiYWNrcykpIGJyZWFrOwoJCQkJfQoKCQkJCWNiID0gZnVuY3Rpb24gKCkgewoJCQkJCWlmICh0aW1lb3V0ICE9PSBudWxsKSB7CgkJCQkJCWNsZWFyVGltZW91dCh0aW1lb3V0KTsKCQkJCQkJdGltZW91dCA9IG51bGw7CgkJCQkJfQoKCQkJCQlvbl9yZXBseS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJCQkJfTsKCgkJCQl0aGlzLnJlcGx5X2NhbGxiYWNrc1tpZF0gPSBjYjsKCQkJCWNiID0gbnVsbDsKCgkJCQlpZiAodGltZW91dF9kZWxheSA+PSAwKSB7CgkJCQkJdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewoJCQkJCQl0aW1lb3V0ID0gbnVsbDsKCQkJCQkJZGVsZXRlIHNlbGYucmVwbHlfY2FsbGJhY2tzW2lkXTsKCQkJCQkJb25fcmVwbHkuY2FsbChzZWxmLCAiUmVzcG9uc2UgdGltZW91dCIpOwoJCQkJCX0sIHRpbWVvdXRfZGVsYXkpOwoJCQkJfQoJCQl9CgoJCQljaGFubmVsLnBvc3QoewoJCQkJeGxpbmtzX2FjdGlvbjogYWN0aW9uLAoJCQkJZGF0YTogZGF0YSwKCQkJCWlkOiBpZCwKCQkJCXJlcGx5OiByZXBseV90bwoJCQl9LCB0cmFuc2Zlcik7CgkJfTsKCQlFeHRlbnNpb25BUEkucHJvdG90eXBlLnJlcXVlc3RfYXBpX2ZuX2NhbGxiYWNrID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkJCXJldHVybiBmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCQl2YXIgYXJnczsKCQkJCWlmIChlcnIgIT09IG51bGwpIHsKCQkJCQljYWxsYmFjay5jYWxsKG51bGwsIGVyciwgbnVsbCk7CgkJCQl9CgkJCQllbHNlIGlmICghaXNfb2JqZWN0KGRhdGEpIHx8ICFBcnJheS5pc0FycmF5KChhcmdzID0gZGF0YS5hcmdzKSkpIHsKCQkJCQljYWxsYmFjay5jYWxsKG51bGwsICJJbnZhbGlkIGV4dGVuc2lvbiByZXNwb25zZSIsIG51bGwpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJYXJncyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXJncykpOwoJCQkJCWNhbGxiYWNrLmFwcGx5KG51bGwsIGFyZ3MpOwoJCQkJfQoJCQl9OwoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5yZWdpc3Rlcl9zZXR0aW5ncyA9IGZ1bmN0aW9uIChyZWdfaW5mbykgewoJCQl2YXIgcmVzcG9uc2UgPSB7fSwKCQkJCW5hbWUsIGRlZmF1bHRfdmFsdWUsIHRpdGxlLCBkZXNjcmlwdGlvbiwgZGVzY3JpcHRvciwKCQkJCXJlcywgdmFsdWUsIGssIGksIGlpLCBhLCB2OwoKCQkJaWYgKGlzX29iamVjdChyZWdfaW5mbykpIHsKCQkJCWZvciAoayBpbiByZWdfaW5mbykgewoJCQkJCWEgPSByZWdfaW5mb1trXTsKCQkJCQlpZiAoIUFycmF5LmlzQXJyYXkoYSkpIGNvbnRpbnVlOwoKCQkJCQlyZXNwb25zZVtrXSA9IHJlcyA9IHt9OwoJCQkJCWZvciAoaSA9IDAsIGlpID0gYS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJCXYgPSBhW2ldOwoJCQkJCQlpZiAoIUFycmF5LmlzQXJyYXkodikgfHwgdHlwZW9mKChuYW1lID0gdlswXSkpICE9PSAic3RyaW5nIikgY29udGludWU7CgoJCQkJCQlkZWZhdWx0X3ZhbHVlID0gdlsxXTsKCQkJCQkJaWYgKGRlZmF1bHRfdmFsdWUgPT09IHVuZGVmaW5lZCkgZGVmYXVsdF92YWx1ZSA9IG51bGw7CgkJCQkJCXRpdGxlID0gdlsyXTsKCQkJCQkJaWYgKHR5cGVvZih0aXRsZSkgIT09ICJzdHJpbmciKSB0aXRsZSA9IG5hbWU7CgkJCQkJCWRlc2NyaXB0aW9uID0gdlszXTsKCQkJCQkJaWYgKHR5cGVvZihkZXNjcmlwdGlvbikgIT09ICJzdHJpbmciKSBkZXNjcmlwdGlvbiA9ICIiOwoJCQkJCQlkZXNjcmlwdG9yID0gdGhpcy5yZWdpc3Rlcl9zZXR0aW5nc19kZXNjcmlwdG9yX2luZm8odls0XSk7CgoJCQkJCQl2YWx1ZSA9IENvbmZpZy5yZWdpc3Rlcl9jdXN0b21fc2V0dGluZyhrLCBuYW1lLCBkZWZhdWx0X3ZhbHVlLCB0aXRsZSwgZGVzY3JpcHRpb24sIGRlc2NyaXB0b3IpOwoJCQkJCQlpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewoJCQkJCQkJdmFsdWUgPSBjb25maWdba11bbmFtZV07CgkJCQkJCX0KCgkJCQkJCXJlc1tuYW1lXSA9IHZhbHVlOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIHJlc3BvbnNlOwoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5yZWdpc3Rlcl9zZXR0aW5nc19kZXNjcmlwdG9yX2luZm8gPSBmdW5jdGlvbiAoaW5wdXQpIHsKCQkJaWYgKCFpc19vYmplY3QoaW5wdXQpKSByZXR1cm4gbnVsbDsKCgkJCXZhciBpbmZvID0ge30sCgkJCQlvcHQsIGxhYmVsLCBkZXNjLCBhLCBpLCBpaSwgdjsKCgkJCWlmICh0eXBlb2YoaW5wdXQudHlwZSkgPT09ICJzdHJpbmciKSB7CgkJCQlpbmZvLnR5cGUgPSBpbnB1dC50eXBlOwoJCQl9CgkJCWlmIChBcnJheS5pc0FycmF5KChhID0gaW5wdXQub3B0aW9ucykpKSB7CgkJCQlpbmZvLm9wdGlvbnMgPSBbXTsKCQkJCWZvciAoaSA9IDAsIGlpID0gYS5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJdiA9IGFbaV07CgkJCQkJaWYgKAoJCQkJCQlBcnJheS5pc0FycmF5KHYpICYmCgkJCQkJCXYubGVuZ3RoID49IDIgJiYKCQkJCQkJdHlwZW9mKChsYWJlbCA9IHZbMV0pKSA9PT0gInN0cmluZyIKCQkJCQkpIHsKCQkJCQkJb3B0ID0gWyB2WzBdLCB2WzFdIF07CgkJCQkJCWlmICh0eXBlb2YoKGRlc2MgPSB2WzJdKSkgPT09ICJzdHJpbmciKSB7CgkJCQkJCQlvcHQucHVzaChkZXNjKTsKCQkJCQkJfQoJCQkJCQlpbmZvLm9wdGlvbnMucHVzaChvcHQpOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGluZm87CgkJfTsKCQlFeHRlbnNpb25BUEkucHJvdG90eXBlLnJlZ2lzdGVyX3JlcXVlc3RfYXBpID0gZnVuY3Rpb24gKHJlZ19pbmZvLCBjaGFubmVsKSB7CgkJCWlmICghaXNfb2JqZWN0KHJlZ19pbmZvKSkgcmV0dXJuICJJbnZhbGlkIjsKCgkJCXZhciByZXFfZnVuY3Rpb25faWRzID0ge30sCgkJCQlyZXE7CgoJCQlyZXEgPSB0aGlzLnJlZ2lzdGVyX3JlcXVlc3RfYXBpX2Zyb21fZGF0YShyZWdfaW5mbywgZnVuY3Rpb24gKGZucywgcmVxX2Z1bmN0aW9ucykgewoJCQkJdmFyIGZuLCBmbl9pZCwgaSwgaWksIHY7CgkJCQlpZiAoQXJyYXkuaXNBcnJheShmbnMpKSB7CgkJCQkJZm9yIChpID0gMCwgaWkgPSBmbnMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQl2ID0gZm5zW2ldOwoJCQkJCQlpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKEV4dGVuc2lvbkFQSS5yZXF1ZXN0X2FwaV9mdW5jdGlvbnMsIHYpKSB7CgkJCQkJCQlmbiA9IEV4dGVuc2lvbkFQSS5yZXF1ZXN0X2FwaV9mdW5jdGlvbnNbdl07CgkJCQkJCQlmbl9pZCA9IHJhbmRvbV9zdHJpbmcoMzIpOwoJCQkJCQkJcmVxX2Z1bmN0aW9uc1t2XSA9IGZuKHRoaXMsIGZuX2lkLCBjaGFubmVsKTsKCQkJCQkJCXJlcV9mdW5jdGlvbl9pZHNbdl0gPSBmbl9pZDsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfSk7CgoJCQkvLyBFcnJvcgoJCQlpZiAodHlwZW9mKHJlcSkgPT09ICJzdHJpbmciKSByZXR1cm4gcmVxOwoKCQkJLy8gTW9yZSBzZXR1cAoJCQlyZXEucmVxdWVzdF9pbml0ID0gYXBpX3JlcXVlc3RfaW5pdF9mbjsKCQkJcmVxLnJlcXVlc3RfY29tcGxldGUgPSBjcmVhdGVfYXBpX3JlcXVlc3RfY29tcGxldGVfZm4oY2hhbm5lbCk7CgoJCQkvLyBEb25lCgkJCXJldHVybiByZXFfZnVuY3Rpb25faWRzOwoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5yZWdpc3Rlcl9yZXF1ZXN0X2FwaV9mcm9tX2RhdGEgPSBmdW5jdGlvbiAoZGF0YSwgZnVuY3Rpb25zX3NldHVwKSB7CgkJCXZhciByZXFfZ3JvdXAgPSAib3RoZXIiLAoJCQkJcmVxX25hbWVzcGFjZSA9ICJvdGhlciIsCgkJCQlyZXFfdHlwZSA9ICJvdGhlciIsCgkJCQlyZXFfY291bnQgPSAxLAoJCQkJcmVxX2NvbmN1cnJlbnQgPSAxLAoJCQkJcmVxX2RlbGF5X29rYXkgPSAyMDAsCgkJCQlyZXFfZGVsYXlfZXJyb3IgPSA1MDAwLAoJCQkJcmVxX2Z1bmN0aW9ucyA9IHt9LAoJCQkJcmVxLCBpLCBpaSwgaywgbywgdjsKCgkJCS8vIFNldHRpbmdzCgkJCWlmICh0eXBlb2YoKHYgPSBkYXRhLmdyb3VwKSkgPT09ICJzdHJpbmciKSByZXFfZ3JvdXAgPSB2OwoJCQlpZiAodHlwZW9mKCh2ID0gZGF0YS5uYW1lc3BhY2UpKSA9PT0gInN0cmluZyIpIHJlcV9uYW1lc3BhY2UgPSB2OwoJCQlpZiAodHlwZW9mKCh2ID0gZGF0YS50eXBlKSkgPT09ICJzdHJpbmciKSByZXFfdHlwZSA9IHY7CgkJCWlmICh0eXBlb2YoKHYgPSBkYXRhLmNvdW50KSkgPT09ICJudW1iZXIiKSByZXFfY291bnQgPSBNYXRoLm1heCgxLCB2KTsKCQkJaWYgKHR5cGVvZigodiA9IGRhdGEuY29uY3VycmVudCkpID09PSAibnVtYmVyIikgcmVxX2NvbmN1cnJlbnQgPSBNYXRoLm1heCgxLCB2KTsKCQkJaWYgKHR5cGVvZigodiA9IGRhdGEuZGVsYXlfb2theSkpID09PSAibnVtYmVyIikgcmVxX2RlbGF5X29rYXkgPSBNYXRoLm1heCgwLCB2KTsKCQkJaWYgKHR5cGVvZigodiA9IGRhdGEuZGVsYXlfZXJyb3IpKSA9PT0gIm51bWJlciIpIHJlcV9kZWxheV9lcnJvciA9IE1hdGgubWF4KDAsIHYpOwoKCQkJLy8gRnVuY3Rpb25zCgkJCWlmIChpc19vYmplY3QoKG8gPSBkYXRhLmZ1bmN0aW9ucykpKSB7CgkJCQlmdW5jdGlvbnNfc2V0dXAuY2FsbCh0aGlzLCBvLCByZXFfZnVuY3Rpb25zKTsKCQkJfQoKCQkJLy8gVmFsaWRhdGUKCQkJZm9yIChpID0gMCwgaWkgPSBFeHRlbnNpb25BUEkucmVxdWVzdF9hcGlfZnVuY3Rpb25zX3JlcXVpcmVkLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCWlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHJlcV9mdW5jdGlvbnMsIEV4dGVuc2lvbkFQSS5yZXF1ZXN0X2FwaV9mdW5jdGlvbnNfcmVxdWlyZWRbaV0pKSBicmVhazsKCQkJfQoJCQlpZiAoaSA8IGlpKSB7CgkJCQlyZXR1cm4gIk1pc3NpbmcgZnVuY3Rpb25zIjsKCQkJfQoKCQkJLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBuYW1lc3BhY2UvdHlwZSBpcyB1bmlxdWUKCQkJaWYgKAoJCQkJKG8gPSB0aGlzLnJlcXVlc3RfYXBpc1tyZXFfbmFtZXNwYWNlXSkgIT09IHVuZGVmaW5lZCAmJgoJCQkJb1tyZXFfdHlwZV0gIT09IHVuZGVmaW5lZAoJCQkpIHsKCQkJCXJldHVybiAiQWxyZWFkeSBleGlzdHMiOwoJCQl9CgoJCQkvLyBDcmVhdGUKCQkJcmVxID0gbmV3IEFQSS5SZXF1ZXN0VHlwZSgKCQkJCXJlcV9jb3VudCwKCQkJCXJlcV9jb25jdXJyZW50LAoJCQkJcmVxX2RlbGF5X29rYXksCgkJCQlyZXFfZGVsYXlfZXJyb3IsCgkJCQlyZXFfZ3JvdXAsCgkJCQlyZXFfbmFtZXNwYWNlLAoJCQkJcmVxX3R5cGUKCQkJKTsKCQkJZm9yIChrIGluIHJlcV9mdW5jdGlvbnMpIHsKCQkJCXJlcVtrXSA9IHJlcV9mdW5jdGlvbnNba107CgkJCX0KCgkJCWlmIChvID09PSB1bmRlZmluZWQpIHsKCQkJCXRoaXMucmVxdWVzdF9hcGlzW3JlcV9uYW1lc3BhY2VdID0gbyA9IHt9OwoJCQl9CgkJCW9bcmVxX3R5cGVdID0gcmVxOwoKCQkJLy8gRG9uZQoJCQlyZXR1cm4gcmVxOwoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5yZWdpc3Rlcl9saW5raWZpZXIgPSBmdW5jdGlvbiAocmVnX2luZm8pIHsKCQkJaWYgKCFpc19vYmplY3QocmVnX2luZm8pKSByZXR1cm4gIkludmFsaWQiOwoKCQkJdmFyIHJlZ2V4LAoJCQkJcHJlZml4X2dyb3VwID0gMCwKCQkJCXByZWZpeCA9ICIiLAoJCQkJZmxhZ3MsIHYsIHYyOwoKCQkJLy8gUmVnZXgKCQkJaWYgKAoJCQkJIUFycmF5LmlzQXJyYXkoKHYgPSByZWdfaW5mby5yZWdleCkpIHx8CgkJCQl0eXBlb2YoKHYyID0gdlswXSkpICE9PSAic3RyaW5nIgoJCQkpIHsKCQkJCXJldHVybiAiSW52YWxpZCByZWdleCI7CgkJCX0KCQkJaWYgKHR5cGVvZigoZmxhZ3MgPSB2WzFdKSkgPT09ICJzdHJpbmciKSB7CgkJCQlpZiAoZmxhZ3MuaW5kZXhPZigiZyIpIDwgMCkgZmxhZ3MgKz0gImciOwoJCQl9CgkJCWVsc2UgewoJCQkJZmxhZ3MgPSAiZyI7CgkJCX0KCQkJcmVnZXggPSAkLmNyZWF0ZV9yZWdleF9zYWZlKHYyLCBmbGFncyk7CgkJCWlmIChyZWdleCA9PT0gbnVsbCkgcmV0dXJuICJJbnZhbGlkIHJlZ2V4IjsKCgkJCS8vIFByZWZpeAoJCQlpZiAodHlwZW9mKCh2ID0gcmVnX2luZm8ucHJlZml4X2dyb3VwKSkgPT09ICJudW1iZXIiKSBwcmVmaXhfZ3JvdXAgPSB2OwoJCQlpZiAodHlwZW9mKCh2ID0gcmVnX2luZm8ucHJlZml4KSkgPT09ICJzdHJpbmciKSBwcmVmaXggPSB2OwoKCQkJLy8gUmVnaXN0ZXIKCQkJTGlua2lmaWVyLmxpbmtpZnlfcmVnaXN0ZXIocmVnZXgsIHByZWZpeF9ncm91cCwgcHJlZml4LCBudWxsLCBudWxsKTsKCQkJcmV0dXJuIG51bGw7CgkJfTsKCQlFeHRlbnNpb25BUEkucHJvdG90eXBlLnJlZ2lzdGVyX2NvbW1hbmQgPSBmdW5jdGlvbiAocmVnX2luZm8sIGNoYW5uZWwpIHsKCQkJaWYgKCFpc19vYmplY3QocmVnX2luZm8pIHx8IHJlZ19pbmZvLnVybF9pbmZvICE9PSB0cnVlIHx8IHJlZ19pbmZvLnRvX2RhdGEgIT09IHRydWUpIHsKCQkJCXJldHVybiAiSW52YWxpZCI7CgkJCX0KCgkJCXZhciBpZF9kYXRhID0geyBpZDogcmFuZG9tX3N0cmluZygzMiksIHVybDogbnVsbCB9LAoJCQkJaW5kZXg7CgoJCQlpbmRleCA9IEFQSS5yZWdpc3Rlcl91cmxfaW5mb19mdW5jdGlvbigKCQkJCXRoaXMucmVnaXN0ZXJfY29tbWFuZF9mbigidXJsX2luZm8iLCBpZF9kYXRhLCBjaGFubmVsKSwKCQkJCXRoaXMucmVnaXN0ZXJfY29tbWFuZF9mbigidXJsX2luZm9fdG9fZGF0YSIsIGlkX2RhdGEsIGNoYW5uZWwpCgkJCSk7CgoJCQlpZiAocmVnX2luZm8uZGV0YWlscyA9PT0gdHJ1ZSkgewoJCQkJVUkucmVnaXN0ZXJfZGV0YWlsc19jcmVhdGlvbihpbmRleCwgdGhpcy5yZWdpc3Rlcl9kZXRhaWxzX2FjdGlvbnNfZm4oCgkJCQkJImNyZWF0ZV9kZXRhaWxzIiwKCQkJCQl7IGlkOiBpZF9kYXRhLmlkLCBpbmZvOiBudWxsLCBkYXRhOiBudWxsIH0sCgkJCQkJY2hhbm5lbCwKCQkJCQlFeHRlbnNpb25BUEkuZGV0YWlsc192YWxpZGF0b3IKCQkJCSkpOwoJCQl9CgkJCWlmIChyZWdfaW5mby5hY3Rpb25zID09PSB0cnVlKSB7CgkJCQlVSS5yZWdpc3Rlcl9hY3Rpb25zX2NyZWF0aW9uKGluZGV4LCB0aGlzLnJlZ2lzdGVyX2RldGFpbHNfYWN0aW9uc19mbigKCQkJCQkiY3JlYXRlX2FjdGlvbnMiLAoJCQkJCXsgaWQ6IGlkX2RhdGEuaWQsIGluZm86IG51bGwsIGRhdGE6IG51bGwgfSwKCQkJCQljaGFubmVsLAoJCQkJCUV4dGVuc2lvbkFQSS5hY3Rpb25zX3ZhbGlkYXRvcgoJCQkJKSk7CgkJCX0KCgkJCXJldHVybiBpZF9kYXRhOwoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5yZWdpc3Rlcl9jb21tYW5kX2ZuID0gZnVuY3Rpb24gKGV2ZW50LCBzZW5kX2RhdGEsIGNoYW5uZWwpIHsKCQkJdmFyIHNlbGYgPSB0aGlzOwoKCQkJcmV0dXJuIGZ1bmN0aW9uICh1cmxfaW5mbywgY2IpIHsKCQkJCXNlbmRfZGF0YS51cmwgPSB1cmxfaW5mbzsKCgkJCQlzZWxmLnNlbmQoCgkJCQkJY2hhbm5lbCwKCQkJCQlldmVudCwKCQkJCQludWxsLAoJCQkJCXNlbmRfZGF0YSwKCQkJCQktMSwKCQkJCQlmdW5jdGlvbiAoZXJyLCBkYXRhKSB7CgkJCQkJCWlmIChlcnIgIT09IG51bGwgfHwgKGVyciA9IGRhdGEuZXJyKSAhPT0gbnVsbCkgewoJCQkJCQkJY2IoZXJyLCBudWxsKTsKCQkJCQkJfQoJCQkJCQllbHNlIGlmICghaXNfb2JqZWN0KGRhdGEuZGF0YSkpIHsKCQkJCQkJCWNiKCJJbnZhbGlkIGV4dGVuc2lvbiBkYXRhIiwgbnVsbCk7CgkJCQkJCX0KCQkJCQkJZWxzZSB7CgkJCQkJCQljYihudWxsLCBkYXRhLmRhdGEpOwoJCQkJCQl9CgkJCQkJfQoJCQkJKTsKCQkJfTsKCQl9OwoJCUV4dGVuc2lvbkFQSS5wcm90b3R5cGUucmVnaXN0ZXJfZGV0YWlsc19hY3Rpb25zX2ZuID0gZnVuY3Rpb24gKGV2ZW50LCBzZW5kX2RhdGEsIGNoYW5uZWwsIHZhbGlkYXRvcikgewoJCQl2YXIgc2VsZiA9IHRoaXM7CgoJCQlyZXR1cm4gZnVuY3Rpb24gKGRhdGEsIGluZm8sIGNiKSB7CgkJCQlzZW5kX2RhdGEuZGF0YSA9IGRhdGE7CgkJCQlzZW5kX2RhdGEuaW5mbyA9IGluZm87CgoJCQkJc2VsZi5zZW5kKAoJCQkJCWNoYW5uZWwsCgkJCQkJZXZlbnQsCgkJCQkJbnVsbCwKCQkJCQlzZW5kX2RhdGEsCgkJCQkJLTEsCgkJCQkJZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJCQlpZiAoZXJyICE9PSBudWxsIHx8IChlcnIgPSBkYXRhLmVycikgIT09IG51bGwpIHsKCQkJCQkJCWNiKGVyciwgbnVsbCk7CgkJCQkJCX0KCQkJCQkJZWxzZSB7CgkJCQkJCQl2YWxpZGF0b3IoZGF0YS5kYXRhLCBjYik7CgkJCQkJCX0KCQkJCQl9CgkJCQkpOwoJCQl9OwoJCX07CgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5yZWdpc3Rlcl9jcmVhdGVfdXJsID0gZnVuY3Rpb24gKGluZm8pIHsKCQkJcmV0dXJuIGludGVybmFsX2FwaV9mbnMucmVnaXN0ZXJfY3JlYXRlX3VybChpbmZvKTsKCQl9OwoKCQlFeHRlbnNpb25BUEkucHJvdG90eXBlLmNyZWF0ZV9leHRlbnNpb25fY2hhbm5lbCA9IGZ1bmN0aW9uIChhcGlfbmFtZSwgYXBpX2tleSkgewoJCQl2YXIgc2VsZiA9IHRoaXM7CgkJCXJldHVybiBuZXcgQ29tbXVuaWNhdGlvbkNoYW5uZWwoCgkJCQlhcGlfbmFtZSwKCQkJCWFwaV9rZXksCgkJCQlmYWxzZSwKCQkJCUNvbW11bmljYXRpb25DaGFubmVsLmNyZWF0ZV9jaGFubmVsKCksCgkJCQlmdW5jdGlvbiAoZXZlbnQsIGRhdGEsIGNoYW5uZWwpIHsKCQkJCQlzZWxmLm9uX21lc3NhZ2UoZXZlbnQsIGRhdGEsIGNoYW5uZWwsIEV4dGVuc2lvbkFQSS5oYW5kbGVycyk7CgkJCQl9CgkJCSk7CgkJfTsKCgkJRXh0ZW5zaW9uQVBJLnByb3RvdHlwZS5maW5hbGl6ZV9pbml0ID0gZnVuY3Rpb24gKGRhdGEsIGNoYW5uZWwsIHJlcGx5LCByZXBseV9rZXkpIHsKCQkJdmFyIG1haW4gPSAoaW50ZXJuYWxpemF0aW9uX2FsbG93ZWQgPyBkYXRhLm1haW4gOiBudWxsKSwKCQkJCW1haW5fZm4sIHJlcGx5X2RhdGEsIHJlcGx5X2NoYW5uZWwsIGV4dF9uYW1lLCByZWdpc3RyYXRpb25zOwoKCQkJLy8gUmVnaXN0ZXIKCQkJdGhpcy5yZWdpc3RyYXRpb25zW3JlcGx5X2tleV0gPSB7CgkJCQluYW1lOiBkYXRhLm5hbWVzcGFjZSwKCQkJCWtleTogcmVwbHlfa2V5LAoJCQkJYXBpczogW10KCQkJfTsKCQkJcmVwbHlfZGF0YSA9IHsKCQkJCWVycjogbnVsbCwKCQkJCWtleTogcmVwbHlfa2V5LAoJCQkJY2FjaGVfcHJlZml4OiBBUEkuY2FjaGVfZ2V0X3ByZWZpeCgpLAoJCQkJY2FjaGVfbW9kZTogY29uZmlnLmRlYnVnLmNhY2hlX21vZGUKCQkJfTsKCgkJCS8vIEludGVybmFsIG1haW4gZnVuY3Rpb24KCQkJaWYgKHR5cGVvZihtYWluKSA9PT0gInN0cmluZyIpIHsKCQkJCW1haW5fZm4gPSB0aGlzLmNyZWF0ZV9tYWluX2Z1bmN0aW9uKG1haW4pOwoJCQkJaWYgKG1haW5fZm4gIT09IG51bGwpIHsKCQkJCQkvLyBSZW1vdmUgcmVnaXN0cmF0aW9ucyB3YWl0aW5nCgkJCQkJcmVnaXN0cmF0aW9ucyA9IGRhdGEucmVnaXN0cmF0aW9uczsKCQkJCQlpZiAodHlwZW9mKHJlZ2lzdHJhdGlvbnMpICE9PSAibnVtYmVyIiB8fCByZWdpc3RyYXRpb25zIDwgMCkgcmVnaXN0cmF0aW9ucyA9IDE7CgoJCQkJCS8vIEludGVybmFsIGV4ZWN1dGlvbgoJCQkJCXRoaXMuc2VuZCgKCQkJCQkJY2hhbm5lbCwKCQkJCQkJbnVsbCwKCQkJCQkJcmVwbHksCgkJCQkJCXsgZXJyOiAiSW50ZXJuYWwiIH0KCQkJCQkpOwoKCQkJCQkvLyBFeGVjdXRlCgkJCQkJZXh0X25hbWUgPSBkYXRhLm5hbWU7CgkJCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCQkJCXRyeSB7CgkJCQkJCQltYWluX2ZuKGludGVybmFsX2FwaV9jcmVhdGUoY29uZmlnKSk7CgkJCQkJCX0KCQkJCQkJY2F0Y2ggKGUpIHsKCQkJCQkJCXJlbW92ZV93YWl0aW5nX3JlZ2lzdHJhdGlvbnMocmVnaXN0cmF0aW9ucyk7CgkJCQkJCQlEZWJ1Zy5sb2coIkludGVybmFsaXplZCBleHRlbnNpb24gZXJyb3IgKCIgKyBleHRfbmFtZSArICIpOiIsIGUpOwoJCQkJCQl9CgkJCQkJfSwgMSk7CgoJCQkJCS8vIERvbmUKCQkJCQlyZXR1cm47CgkJCQl9CgkJCX0KCgkJCS8vIENyZWF0ZSBhIHJlcGx5IGNoYW5uZWwKCQkJcmVwbHlfY2hhbm5lbCA9IHRoaXMuY3JlYXRlX2V4dGVuc2lvbl9jaGFubmVsKGRhdGEubmFtZXNwYWNlLCByZXBseV9rZXkpOwoKCQkJLy8gU2VuZCByZXBseQoJCQl0aGlzLnNlbmQoCgkJCQljaGFubmVsLAoJCQkJbnVsbCwKCQkJCXJlcGx5LAoJCQkJcmVwbHlfZGF0YSwKCQkJCS0xLAoJCQkJdW5kZWZpbmVkLAoJCQkJcmVwbHlfY2hhbm5lbC5nZXRfcG9ydF90cmFuc2ZlcigpCgkJCSk7CgkJfTsKCQlFeHRlbnNpb25BUEkucHJvdG90eXBlLmNyZWF0ZV9tYWluX2Z1bmN0aW9uID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJCQl0cnkgewoJCQkJdmFyIGZuID0gbmV3IEZ1bmN0aW9uKCJ2YXIgeGxpbmtzX2FwaSwiICsgRXh0ZW5zaW9uQVBJLmludGVybmFsaXphdGlvbl9oaWRkZW5fdmFycy5qb2luKCIsIikgKyAiO3JldHVybiAoIiArIHNvdXJjZSArICIpOyIpOyAvLyBqc2hpbnQgaWdub3JlOmxpbmUKCQkJCXJldHVybiBmbigpOwoJCQl9CgkJCWNhdGNoIChlKSB7fQoJCQlyZXR1cm4gbnVsbDsKCQl9OwoKCQlFeHRlbnNpb25BUEkuaW50ZXJuYWxpemF0aW9uX2hpZGRlbl92YXJzID0gWwoJCQkidW5zYWZlV2luZG93IiwKCQkJImNsb25lSW50byIsCgkJCSJleHBvcnRGdW5jdGlvbiIsCgkJCSJjcmVhdGVPYmplY3RJbiIsCgkJCSJHTSIsCgkJCSJHTV94bWxodHRwUmVxdWVzdCIsCgkJCSJHTV9zZXRWYWx1ZSIsCgkJCSJHTV9nZXRWYWx1ZSIsCgkJCSJHTV9kZWxldGVWYWx1ZSIsCgkJCSJHTV9pbmZvIgoJCV07CgoJCUV4dGVuc2lvbkFQSS5kZXRhaWxzX3ZhbGlkYXRvciA9IGZ1bmN0aW9uIChkYXRhLCBjYikgewoJCQlpZiAodHlwZW9mKGRhdGEpICE9PSAic3RyaW5nIikgewoJCQkJY2IoIkludmFsaWQgZXh0ZW5zaW9uIHJlc3BvbnNlIiwgbnVsbCk7CgkJCX0KCQkJZWxzZSB7CgkJCQlkYXRhID0gZ2V0X3NoYXJlZF9ub2RlKGRhdGEpOwoJCQkJaWYgKGRhdGEgPT09IG51bGwpIHsKCQkJCQljYigiSW52YWxpZCBleHRlbnNpb24gbm9kZSIsIG51bGwpOwoJCQkJfQoJCQkJZWxzZSB7CgkJCQkJY2IobnVsbCwgZGF0YSk7CgkJCQl9CgkJCX0KCQl9OwoJCUV4dGVuc2lvbkFQSS5hY3Rpb25zX3ZhbGlkYXRvciA9IGZ1bmN0aW9uIChkYXRhLCBjYikgewoJCQlpZiAoIUFycmF5LmlzQXJyYXkoZGF0YSkpIHsKCQkJCWNiKCJJbnZhbGlkIGV4dGVuc2lvbiByZXNwb25zZSIsIG51bGwpOwoJCQl9CgkJCWVsc2UgewoJCQkJdmFyIHJlc3BvbnNlID0gW10sCgkJCQkJZCwgaSwgaWk7CgoJCQkJZm9yIChpID0gMCwgaWkgPSBkYXRhLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQlkID0gZGF0YVtpXTsKCQkJCQlpZiAoZCA9PT0gbnVsbCB8fCBBcnJheS5pc0FycmF5KGQpKSB7CgkJCQkJCXJlc3BvbnNlLnB1c2goZCk7CgkJCQkJfQoJCQkJfQoKCQkJCWNiKG51bGwsIHJlc3BvbnNlKTsKCQkJfQoJCX07CgoJCUV4dGVuc2lvbkFQSS5yZXF1ZXN0X2FwaV9mdW5jdGlvbnNfcmVxdWlyZWQgPSBbCgkJCSJzZXR1cF94aHIiLAoJCQkicGFyc2VfcmVzcG9uc2UiCgkJXTsKCQlFeHRlbnNpb25BUEkucmVxdWVzdF9hcGlfZnVuY3Rpb25zID0gewoJCQlnZXRfZGF0YTogZnVuY3Rpb24gKHNlbGYsIGZuX2lkLCBjaGFubmVsKSB7CgkJCQlyZXR1cm4gZnVuY3Rpb24gKGluZm8sIGNhbGxiYWNrKSB7CgkJCQkJc2VsZi5zZW5kKAoJCQkJCQljaGFubmVsLAoJCQkJCQkiYXBpX2Z1bmN0aW9uIiwKCQkJCQkJbnVsbCwKCQkJCQkJewoJCQkJCQkJaWQ6IGZuX2lkLAoJCQkJCQkJYXJnczogWyBpbmZvIF0sCgkJCQkJCQlzdGF0ZTogbnVsbAoJCQkJCQl9LAoJCQkJCQktMSwKCQkJCQkJc2VsZi5yZXF1ZXN0X2FwaV9mbl9jYWxsYmFjayhjYWxsYmFjaykKCQkJCQkpOwoJCQkJfTsKCQkJfSwKCQkJc2V0X2RhdGE6IGZ1bmN0aW9uIChzZWxmLCBmbl9pZCwgY2hhbm5lbCkgewoJCQkJcmV0dXJuIGZ1bmN0aW9uIChkYXRhLCBpbmZvLCBjYWxsYmFjaykgewoJCQkJCXZhciBzdGF0ZSA9IHsKCQkJCQkJaWQ6IHRoaXMuZGF0YS5pZCwKCQkJCQkJcmV0cnlfY291bnQ6IHRoaXMucmV0cnlfY291bnQKCQkJCQl9OwoKCQkJCQlpZiAoIXRoaXMuZGF0YS5zZW50KSB7CgkJCQkJCXRoaXMuZGF0YS5zZW50ID0gdHJ1ZTsKCQkJCQkJc3RhdGUuaW5mb3MgPSB0aGlzLmluZm9zOwoJCQkJCX0KCgkJCQkJc2VsZi5zZW5kKAoJCQkJCQljaGFubmVsLAoJCQkJCQkiYXBpX2Z1bmN0aW9uIiwKCQkJCQkJbnVsbCwKCQkJCQkJewoJCQkJCQkJaWQ6IGZuX2lkLAoJCQkJCQkJYXJnczogWyBkYXRhLCBpbmZvIF0sCgkJCQkJCQlzdGF0ZTogc3RhdGUKCQkJCQkJfSwKCQkJCQkJLTEsCgkJCQkJCXNlbGYucmVxdWVzdF9hcGlfZm5fY2FsbGJhY2soY2FsbGJhY2spCgkJCQkJKTsKCQkJCX07CgkJCX0sCgkJCXNldHVwX3hocjogZnVuY3Rpb24gKHNlbGYsIGZuX2lkLCBjaGFubmVsKSB7CgkJCQlyZXR1cm4gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CgkJCQkJdmFyIHN0YXRlID0gewoJCQkJCQlpZDogdGhpcy5kYXRhLmlkLAoJCQkJCQlyZXRyeV9jb3VudDogdGhpcy5yZXRyeV9jb3VudAoJCQkJCX07CgoJCQkJCWlmICghdGhpcy5kYXRhLnNlbnQpIHsKCQkJCQkJdGhpcy5kYXRhLnNlbnQgPSB0cnVlOwoJCQkJCQlzdGF0ZS5pbmZvcyA9IHRoaXMuaW5mb3M7CgkJCQkJfQoKCQkJCQlzZWxmLnNlbmQoCgkJCQkJCWNoYW5uZWwsCgkJCQkJCSJhcGlfZnVuY3Rpb24iLAoJCQkJCQludWxsLAoJCQkJCQl7CgkJCQkJCQlpZDogZm5faWQsCgkJCQkJCQlhcmdzOiBbXSwKCQkJCQkJCXN0YXRlOiBzdGF0ZQoJCQkJCQl9LAoJCQkJCQktMSwKCQkJCQkJc2VsZi5yZXF1ZXN0X2FwaV9mbl9jYWxsYmFjayhjYWxsYmFjaykKCQkJCQkpOwoJCQkJfTsKCQkJfSwKCQkJcGFyc2VfcmVzcG9uc2U6IGZ1bmN0aW9uIChzZWxmLCBmbl9pZCwgY2hhbm5lbCkgewoJCQkJcmV0dXJuIGZ1bmN0aW9uICh4aHIsIGNhbGxiYWNrKSB7CgkJCQkJdmFyIHN0YXRlID0gewoJCQkJCQlpZDogdGhpcy5kYXRhLmlkLAoJCQkJCQlyZXRyeV9jb3VudDogdGhpcy5yZXRyeV9jb3VudAoJCQkJCX07CgoJCQkJCWlmICghdGhpcy5kYXRhLnNlbnQpIHsKCQkJCQkJdGhpcy5kYXRhLnNlbnQgPSB0cnVlOwoJCQkJCQlzdGF0ZS5pbmZvcyA9IHRoaXMuaW5mb3M7CgkJCQkJfQoKCQkJCQlpZiAoeGhyLnJlc3BvbnNlWE1MICE9PSBudWxsKSB7CgkJCQkJCXhociA9IHJlbW92ZV9yZXNwb25zZV94bWwoeGhyKTsKCQkJCQl9CgoJCQkJCXNlbGYuc2VuZCgKCQkJCQkJY2hhbm5lbCwKCQkJCQkJImFwaV9mdW5jdGlvbiIsCgkJCQkJCW51bGwsCgkJCQkJCXsKCQkJCQkJCWlkOiBmbl9pZCwKCQkJCQkJCWFyZ3M6IFsgeGhyIF0sCgkJCQkJCQlzdGF0ZTogc3RhdGUKCQkJCQkJfSwKCQkJCQkJLTEsCgkJCQkJCXNlbGYucmVxdWVzdF9hcGlfZm5fY2FsbGJhY2soY2FsbGJhY2spCgkJCQkJKTsKCQkJCX07CgkJCX0KCQl9OwoKCQl2YXIgcmVtb3ZlX3Jlc3BvbnNlX3htbCA9IGZ1bmN0aW9uICh4aHIpIHsKCQkJdHJ5IHsKCQkJCXhoci5yZXNwb25zZVhNTCA9IG51bGw7CgkJCX0KCQkJY2F0Y2ggKGUpIHsKCQkJCXhociA9ICQuY2xvbmUoeGhyKTsKCQkJCXhoci5yZXNwb25zZVhNTCA9IG51bGw7CgkJCX0KCQkJcmV0dXJuIHhocjsKCQl9OwoKCQl2YXIgcmVtb3ZlX3dhaXRpbmdfcmVnaXN0cmF0aW9ucyA9IGZ1bmN0aW9uIChjb3VudCkgewoJCQkvLyBEZWNyZWFzZSByZWdpc3RlciBjb3VudAoJCQl2YXIgYXR0ciA9ICJkYXRhLXhsaW5rcy1leHRlbnNpb25zLXdhaXRpbmciLAoJCQkJdmFsdWUgPSBkb2N1bWVudF9lbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyKTsKCgkJCWlmICh2YWx1ZSkgewoJCQkJdmFsdWUgPSAocGFyc2VJbnQodmFsdWUsIDEwKSB8fCAwKSAtIGNvdW50OwoJCQkJaWYgKHZhbHVlID4gMCkgewoJCQkJCWRvY3VtZW50X2VsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQlkb2N1bWVudF9lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShhdHRyKTsKCQkJfQoKCQkJcmV0dXJuIHRydWU7CgkJfTsKCgkJRXh0ZW5zaW9uQVBJLmhhbmRsZXJzX2luaXQgPSB7CgkJCWluaXQ6IGZ1bmN0aW9uIChkYXRhLCBjaGFubmVsLCByZXBseSkgewoJCQkJdmFyIHJlZywgZW5hYmxlZCwgbmFtZSwgYXV0aG9yLCBkZXNjcmlwdGlvbiwgdmVyc2lvbiwKCQkJCQlyZXBseV9rZXksIGk7CgoJCQkJLy8gQWRkIHRvIGxpc3QKCQkJCWlmICgKCQkJCQl0eXBlb2YoKG5hbWUgPSBkYXRhLm5hbWUpKSAhPT0gInN0cmluZyIgfHwKCQkJCQl0eXBlb2YoKGF1dGhvciA9IGRhdGEuYXV0aG9yKSkgIT09ICJzdHJpbmciIHx8CgkJCQkJdHlwZW9mKChkZXNjcmlwdGlvbiA9IGRhdGEuZGVzY3JpcHRpb24pKSAhPT0gInN0cmluZyIKCQkJCSkgewoJCQkJCXRoaXMuc2VuZCgKCQkJCQkJY2hhbm5lbCwKCQkJCQkJbnVsbCwKCQkJCQkJcmVwbHksCgkJCQkJCXsgZXJyOiAiTWlzc2luZyBleHRlbnNpb24gaWRlbnRpZmljYXRpb24iIH0KCQkJCQkpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJCWVuYWJsZWQgPSBleHRlbnNpb25faXNfZW5hYmxlZChuYW1lLCBhdXRob3IsIGRlc2NyaXB0aW9uKTsKCQkJCXJlZyA9IFsgZW5hYmxlZCwgbmFtZSwgYXV0aG9yLCBkZXNjcmlwdGlvbiwgbnVsbCBdOwoJCQkJaWYgKEFycmF5LmlzQXJyYXkoKHZlcnNpb24gPSBkYXRhLnZlcnNpb24pKSkgewoJCQkJCWZvciAoaSA9IDA7IGkgPCB2ZXJzaW9uLmxlbmd0aDsgKytpKSB7CgkJCQkJCWlmICh0eXBlb2YodmVyc2lvbltpXSkgIT09ICJudW1iZXIiKSBicmVhazsKCQkJCQl9CgkJCQkJaWYgKGkgPT09IHZlcnNpb24ubGVuZ3RoKSByZWdbNF0gPSB2ZXJzaW9uLnNsaWNlKDApOwoJCQkJfQoJCQkJcmVnaXN0ZXJlZC5wdXNoKHJlZyk7CgkJCQlpZiAoIWVuYWJsZWQpIHsKCQkJCQl0aGlzLnNlbmQoCgkJCQkJCWNoYW5uZWwsCgkJCQkJCW51bGwsCgkJCQkJCXJlcGx5LAoJCQkJCQl7IGVycjogIkV4dGVuc2lvbiBkaXNhYmxlZCIgfQoJCQkJCSk7CgkJCQkJaSA9IGRhdGEucmVnaXN0cmF0aW9uczsKCQkJCQlpZiAodHlwZW9mKGkpICE9PSAibnVtYmVyIikgaSA9IDE7CgkJCQkJTWFpbi5zdGFydF9wcm9jZXNzaW5nKCFyZW1vdmVfd2FpdGluZ19yZWdpc3RyYXRpb25zKGkpKTsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJLy8gR2V0IHVuaXF1ZSBJRAoJCQkJZm9yIChpID0gMDsgaSA8IDEwOyArK2kpIHsKCQkJCQlyZXBseV9rZXkgPSByYW5kb21fc3RyaW5nKDY0KTsKCQkJCQlpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLnJlZ2lzdHJhdGlvbnMsIHJlcGx5X2tleSkpIGJyZWFrOwoJCQkJfQoJCQkJaWYgKGkgPj0gMTApIHsKCQkJCQl0aGlzLnNlbmQoCgkJCQkJCWNoYW5uZWwsCgkJCQkJCW51bGwsCgkJCQkJCXJlcGx5LAoJCQkJCQl7IGVycjogIkNvdWxkIG5vdCBnZW5lcmF0ZSB1bmlxdWUga2V5IiB9CgkJCQkJKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCS8vIEZpbmFsaXplIGluaXQKCQkJCQl0aGlzLmZpbmFsaXplX2luaXQoZGF0YSwgY2hhbm5lbCwgcmVwbHksIHJlcGx5X2tleSk7CgkJCQl9CgkJCX0sCgkJfTsKCQlFeHRlbnNpb25BUEkuaGFuZGxlcnMgPSB7CgkJCXJlZ2lzdGVyOiBmdW5jdGlvbiAoZGF0YSwgY2hhbm5lbCwgcmVwbHkpIHsKCQkJCS8vIFJlZ2lzdGVyCgkJCQl2YXIgcmVzcG9uc2UgPSB7CgkJCQkJCXNldHRpbmdzOiBudWxsLAoJCQkJCQlyZXF1ZXN0X2FwaXM6IFtdLAoJCQkJCQlsaW5raWZpZXJzOiBbXSwKCQkJCQkJY29tbWFuZHM6IFtdLAoJCQkJCQljcmVhdGVfdXJsOiBudWxsCgkJCQkJfSwKCQkJCQljb21wbGV0ZSA9IHJlbW92ZV93YWl0aW5nX3JlZ2lzdHJhdGlvbnMoMSksCgkJCQkJbywgaSwgaWk7CgoJCQkJLy8gU2V0dGluZ3MKCQkJCXJlc3BvbnNlLnNldHRpbmdzID0gdGhpcy5yZWdpc3Rlcl9zZXR0aW5ncyhkYXRhLnNldHRpbmdzKTsKCgkJCQkvLyBSZXF1ZXN0IEFQSXMKCQkJCWlmIChBcnJheS5pc0FycmF5KChvID0gZGF0YS5yZXF1ZXN0X2FwaXMpKSkgewoJCQkJCWZvciAoaSA9IDAsIGlpID0gby5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJCXJlc3BvbnNlLnJlcXVlc3RfYXBpcy5wdXNoKHRoaXMucmVnaXN0ZXJfcmVxdWVzdF9hcGkob1tpXSwgY2hhbm5lbCkpOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBMaW5raWZpZXJzCgkJCQlpZiAoQXJyYXkuaXNBcnJheSgobyA9IGRhdGEubGlua2lmaWVycykpKSB7CgkJCQkJZm9yIChpID0gMCwgaWkgPSBvLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJcmVzcG9uc2UubGlua2lmaWVycy5wdXNoKHRoaXMucmVnaXN0ZXJfbGlua2lmaWVyKG9baV0pKTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gVVJMIGluZm8gZnVuY3Rpb24KCQkJCWlmIChBcnJheS5pc0FycmF5KChvID0gZGF0YS5jb21tYW5kcykpKSB7CgkJCQkJZm9yIChpID0gMCwgaWkgPSBvLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJcmVzcG9uc2UuY29tbWFuZHMucHVzaCh0aGlzLnJlZ2lzdGVyX2NvbW1hbmQob1tpXSwgY2hhbm5lbCkpOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBVUkwgY3JlYXRlIGZ1bmN0aW9ucwoJCQkJaWYgKGlzX29iamVjdCgobyA9IGRhdGEuY3JlYXRlX3VybCkpKSB7CgkJCQkJcmVzcG9uc2UuY3JlYXRlX3VybCA9IHRoaXMucmVnaXN0ZXJfY3JlYXRlX3VybChvKTsKCQkJCX0KCgkJCQkvLyBPa2F5CgkJCQl0aGlzLnNlbmQoCgkJCQkJY2hhbm5lbCwKCQkJCQludWxsLAoJCQkJCXJlcGx5LAoJCQkJCXsKCQkJCQkJZXJyOiBudWxsLAoJCQkJCQlyZXNwb25zZTogcmVzcG9uc2UKCQkJCQl9CgkJCQkpOwoKCQkJCS8vIERvbmUKCQkJCU1haW4uc3RhcnRfcHJvY2Vzc2luZyghY29tcGxldGUpOwoJCQl9LAoJCQlyZXF1ZXN0OiBmdW5jdGlvbiAoZGF0YSwgY2hhbm5lbCwgcmVwbHkpIHsKCQkJCXZhciBzZWxmID0gdGhpcywKCQkJCQluYW1lc3BhY2UsIHR5cGUsIHVuaXF1ZV9pZCwgaW5mbzsKCgkJCQlpZiAoCgkJCQkJdHlwZW9mKChuYW1lc3BhY2UgPSBkYXRhLm5hbWVzcGFjZSkpICE9PSAic3RyaW5nIiB8fAoJCQkJCXR5cGVvZigodHlwZSA9IGRhdGEudHlwZSkpICE9PSAic3RyaW5nIiB8fAoJCQkJCXR5cGVvZigodW5pcXVlX2lkID0gZGF0YS5pZCkpICE9PSAic3RyaW5nIiB8fAoJCQkJCShpbmZvID0gZGF0YS5pbmZvKSA9PT0gdW5kZWZpbmVkCgkJCQkpIHsKCQkJCQkvLyBGYWlsdXJlCgkJCQkJdGhpcy5zZW5kKAoJCQkJCQljaGFubmVsLAoJCQkJCQludWxsLAoJCQkJCQlyZXBseSwKCQkJCQkJeyBlcnI6ICJJbnZhbGlkIGV4dGVuc2lvbiBkYXRhIiB9CgkJCQkJKTsKCQkJCQlyZXR1cm47CgkJCQl9CgoJCQkJcmVxdWVzdChuYW1lc3BhY2UsIHR5cGUsIHVuaXF1ZV9pZCwgaW5mbywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewoJCQkJCWlmIChlcnIgIT09IG51bGwpIHsKCQkJCQkJZGF0YSA9IG51bGw7CgkJCQkJfQoKCQkJCQlzZWxmLnNlbmQoCgkJCQkJCWNoYW5uZWwsCgkJCQkJCW51bGwsCgkJCQkJCXJlcGx5LAoJCQkJCQl7CgkJCQkJCQllcnI6IGVyciwKCQkJCQkJCWRhdGE6IGRhdGEKCQkJCQkJfQoJCQkJCSk7CgkJCQl9KTsKCQkJfSwKCQkJZ2V0X2ltYWdlOiBmdW5jdGlvbiAoZGF0YSwgY2hhbm5lbCwgcmVwbHkpIHsKCQkJCXZhciBzZWxmID0gdGhpcywKCQkJCQl1cmwsIGZsYWdzOwoKCQkJCWlmICgKCQkJCQl0eXBlb2YoKHVybCA9IGRhdGEudXJsKSkgIT09ICJzdHJpbmciIHx8CgkJCQkJdHlwZW9mKChmbGFncyA9IGRhdGEuZmxhZ3MpKSAhPT0gIm51bWJlciIKCQkJCSkgewoJCQkJCS8vIEZhaWx1cmUKCQkJCQl0aGlzLnNlbmQoCgkJCQkJCWNoYW5uZWwsCgkJCQkJCW51bGwsCgkJCQkJCXJlcGx5LAoJCQkJCQl7IGVycjogIkludmFsaWQgZXh0ZW5zaW9uIGRhdGEiIH0KCQkJCQkpOwoJCQkJCXJldHVybjsKCQkJCX0KCgkJCQlBUEkuZ2V0X3RodW1ibmFpbCh1cmwsIGZsYWdzLCBmdW5jdGlvbiAoZXJyLCB1cmwpIHsKCQkJCQlzZWxmLnNlbmQoCgkJCQkJCWNoYW5uZWwsCgkJCQkJCW51bGwsCgkJCQkJCXJlcGx5LAoJCQkJCQl7IGVycjogZXJyLCB1cmw6IHVybCB9CgkJCQkJKTsKCQkJCX0pOwoJCQl9LAoJCX07CgoJCXZhciBhcGlfcmVxdWVzdF9pbml0X2ZuID0gZnVuY3Rpb24gKHJlcSkgewoJCQlyZXEuZGF0YSA9IHsKCQkJCWlkOiByYW5kb21fc3RyaW5nKDMyKSwKCQkJCXNlbnQ6IGZhbHNlCgkJCX07CgkJfTsKCQl2YXIgY3JlYXRlX2FwaV9yZXF1ZXN0X2NvbXBsZXRlX2ZuID0gZnVuY3Rpb24gKGNoYW5uZWwpIHsKCQkJcmV0dXJuIGZ1bmN0aW9uIChyZXEpIHsKCQkJCWFwaS5zZW5kKAoJCQkJCWNoYW5uZWwsCgkJCQkJInJlcXVlc3RfZW5kIiwKCQkJCQludWxsLAoJCQkJCXsgaWQ6IHJlcS5kYXRhLmlkIH0KCQkJCSk7CgkJCX07CgkJfTsKCgoJCXZhciBpbnRlcm5hbF9hcGlfZm5zID0gewoJCQlyZWdpc3Rlcl9zZXR0aW5nczogZnVuY3Rpb24gKHNldHRpbmdzLCBjb25maWcpIHsKCQkJCXZhciBjMSwgYzIsIGsxLCBrMiwgdGFyZ2V0OwoKCQkJCS8vIFNldHRpbmdzCgkJCQljMSA9IGFwaS5yZWdpc3Rlcl9zZXR0aW5ncyhzZXR0aW5ncyk7CgkJCQlmb3IgKGsxIGluIGMxKSB7CgkJCQkJaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjMSwgazEpKSB7CgkJCQkJCWMyID0gYzFbazFdOwoJCQkJCQl0YXJnZXQgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoY29uZmlnLCBrMSkgPyAoY29uZmlnW2sxXSkgOiAoY29uZmlnW2sxXSA9IHt9KTsKCQkJCQkJZm9yIChrMiBpbiBjMikgewoJCQkJCQkJaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChjMiwgazIpKSB7CgkJCQkJCQkJdGFyZ2V0W2syXSA9IGMyW2syXTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfSwKCQkJcmVnaXN0ZXJfbGlua2lmaWVyOiBmdW5jdGlvbiAoZGF0YSkgewoJCQkJdmFyIHJlX2RhdGEgPSBkYXRhLnJlZ2V4LAoJCQkJCXByZWZpeF9ncm91cCA9IGRhdGEucHJlZml4X2dyb3VwLAoJCQkJCXByZWZpeCA9IGRhdGEucHJlZml4LAoJCQkJCXJlX2ZsYWdzID0gImciLAoJCQkJCXJlX3N0ciA9IG51bGwsCgkJCQkJcmVnZXg7CgoJCQkJLy8gUmVnZXggY3JlYXRpb24KCQkJCWlmICh0eXBlb2YocmVfZGF0YSkgPT09ICJzdHJpbmciKSB7CgkJCQkJcmVfc3RyID0gcmVfZGF0YTsKCQkJCX0KCQkJCWVsc2UgaWYgKHJlX2RhdGEgaW5zdGFuY2VvZiBSZWdFeHApIHsKCQkJCQlyZV9zdHIgPSByZV9kYXRhLnNvdXJjZTsKCQkJCQlyZV9mbGFncyA9ICQuZ2V0X3JlZ2V4X2ZsYWdzKHJlX2RhdGEpOwoJCQkJfQoJCQkJZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZV9kYXRhKSkgewoJCQkJCWlmICh0eXBlb2YocmVfZGF0YVswXSkgPT09ICJzdHJpbmciKSB7CgkJCQkJCXJlX3N0ciA9IHJlX2RhdGFbMF07CgkJCQkJCWlmICh0eXBlb2YocmVfZGF0YVsxXSkgPT09ICJzdHJpbmciKSByZV9mbGFncyA9IHJlX2RhdGFbMV07CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFJlcXVpcmVzIGdsb2JhbCBmbGFnCgkJCQlpZiAocmVfZmxhZ3MuaW5kZXhPZigiZyIpIDwgMCkgewoJCQkJCXJlX2ZsYWdzICs9ICJnIjsKCQkJCX0KCgkJCQkvLyBDcmVhdGUKCQkJCWlmICgKCQkJCQlyZV9zdHIgPT09IG51bGwgfHwKCQkJCQkocmVnZXggPSAkLmNyZWF0ZV9yZWdleF9zYWZlKHJlX3N0ciwgcmVfZmxhZ3MpKSA9PT0gbnVsbAoJCQkJKSB7CgkJCQkJcmV0dXJuICJJbnZhbGlkIHJlZ2V4IjsKCQkJCX0KCgkJCQkvLyBQcmVmaXgKCQkJCWlmICh0eXBlb2YocHJlZml4X2dyb3VwKSAhPT0gIm51bWJlciIpIHByZWZpeF9ncm91cCA9IDA7CgkJCQlpZiAodHlwZW9mKHByZWZpeCkgIT09ICJzdHJpbmciKSBwcmVmaXggPSAiIjsKCgkJCQkvLyBSZWdpc3RlcgoJCQkJTGlua2lmaWVyLmxpbmtpZnlfcmVnaXN0ZXIocmVnZXgsIHByZWZpeF9ncm91cCwgcHJlZml4LCBudWxsLCBudWxsKTsKCgkJCQkvLyBEb25lCgkJCQlyZXR1cm4gbnVsbDsKCQkJfSwKCQkJcmVnaXN0ZXJfY29tbWFuZDogZnVuY3Rpb24gKGRhdGEpIHsKCQkJCXZhciB1cmxfaW5mbyA9IGRhdGEudXJsX2luZm8sCgkJCQkJdG9fZGF0YSA9IGRhdGEudG9fZGF0YSwKCQkJCQlpbmRleCwgZm47CgoJCQkJaWYgKHR5cGVvZih1cmxfaW5mbykgIT09ICJmdW5jdGlvbiIgfHwgdHlwZW9mKHRvX2RhdGEpICE9PSAiZnVuY3Rpb24iKSB7CgkJCQkJcmV0dXJuICJJbnZhbGlkIjsKCQkJCX0KCgkJCQlpbmRleCA9IEFQSS5yZWdpc3Rlcl91cmxfaW5mb19mdW5jdGlvbih1cmxfaW5mbywgdG9fZGF0YSk7CgoJCQkJaWYgKHR5cGVvZigoZm4gPSBkYXRhLmRldGFpbHMpKSA9PT0gImZ1bmN0aW9uIikgewoJCQkJCVVJLnJlZ2lzdGVyX2RldGFpbHNfY3JlYXRpb24oaW5kZXgsIGZuKTsKCQkJCX0KCQkJCWlmICh0eXBlb2YoKGZuID0gZGF0YS5hY3Rpb25zKSkgPT09ICJmdW5jdGlvbiIpIHsKCQkJCQlVSS5yZWdpc3Rlcl9hY3Rpb25zX2NyZWF0aW9uKGluZGV4LCBmbik7CgkJCQl9CgoJCQkJcmV0dXJuIG51bGw7CgkJCX0sCgkJCXJlZ2lzdGVyX3JlcXVlc3RfYXBpOiBmdW5jdGlvbiAoZGF0YSkgewoJCQkJdmFyIHJlcSA9IGFwaS5yZWdpc3Rlcl9yZXF1ZXN0X2FwaV9mcm9tX2RhdGEoZGF0YSwgZnVuY3Rpb24gKGZucywgcmVxX2Z1bmN0aW9ucykgewoJCQkJCXZhciBrOwoJCQkJCWZvciAoayBpbiBmbnMpIHsKCQkJCQkJaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChFeHRlbnNpb25BUEkucmVxdWVzdF9hcGlfZnVuY3Rpb25zLCBrKSkgewoJCQkJCQkJcmVxX2Z1bmN0aW9uc1trXSA9IGZuc1trXTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0pOwoJCQkJcmV0dXJuICh0eXBlb2YocmVxKSA9PT0gInN0cmluZyIpID8gcmVxIDogbnVsbDsKCQkJfSwKCQkJcmVnaXN0ZXJfY3JlYXRlX3VybDogZnVuY3Rpb24gKGluZm8pIHsKCQkJCXZhciBrZXlzID0gT2JqZWN0LmtleXMoaW5mbyksCgkJCQkJaSwgaWksIGssIG87CgkJCQlmb3IgKGkgPSAwLCBpaSA9IGtleXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCWsgPSBrZXlzW2ldOwoJCQkJCW8gPSBpbmZvW2tdOwoJCQkJCWlmIChpc19vYmplY3QobykpIHsKCQkJCQkJQ3JlYXRlVVJMLnJlZ2lzdGVyKGssIG8pOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBudWxsOwoJCQl9CgkJfTsKCQl2YXIgaW50ZXJuYWxfYXBpX2NyZWF0ZSA9IGZ1bmN0aW9uIChnbG9iYWxfY29uZmlnKSB7CgoJCQl2YXIgY29uZmlnID0ge307CgoJCQl2YXIgY2FjaGVfcHJlZml4ID0gIiI7CgkJCXZhciBjYWNoZV9zdG9yYWdlID0gd2luZG93LmxvY2FsU3RvcmFnZTsKCQkJdmFyIGNhY2hlX3NldCA9IGZ1bmN0aW9uIChrZXksIGRhdGEsIHR0bCkgewoJCQkJY2FjaGVfc3RvcmFnZS5zZXRJdGVtKGNhY2hlX3ByZWZpeCArICJleHQtIiArIGtleSwgSlNPTi5zdHJpbmdpZnkoewoJCQkJCWV4cGlyZXM6IERhdGUubm93KCkgKyB0dGwsCgkJCQkJZGF0YTogZGF0YQoJCQkJfSkpOwoJCQl9OwoJCQl2YXIgY2FjaGVfZ2V0ID0gZnVuY3Rpb24gKGtleSkgewoJCQkJdmFyIGpzb24gPSAkLmpzb25fcGFyc2Vfc2FmZShjYWNoZV9zdG9yYWdlLmdldEl0ZW0oY2FjaGVfcHJlZml4ICsgImV4dC0iICsga2V5KSwgbnVsbCk7CgoJCQkJaWYgKAoJCQkJCWpzb24gIT09IG51bGwgJiYKCQkJCQl0eXBlb2YoanNvbikgPT09ICJvYmplY3QiICYmCgkJCQkJRGF0ZS5ub3coKSA8IGpzb24uZXhwaXJlcyAmJgoJCQkJCXR5cGVvZihqc29uLmRhdGEpID09PSAib2JqZWN0IgoJCQkJKSB7CgkJCQkJcmV0dXJuIGpzb24uZGF0YTsKCQkJCX0KCgkJCQljYWNoZV9zdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTsKCQkJCXJldHVybiBudWxsOwoJCQl9OwoKCQkJdmFyIGluaXQgPSBmdW5jdGlvbiAoaW5mbywgY2FsbGJhY2spIHsKCQkJCS8vIFNldHVwIHZhcnMKCQkJCWNhY2hlX3ByZWZpeCA9IEFQSS5jYWNoZV9nZXRfcHJlZml4KCk7CgoJCQkJaWYgKGdsb2JhbF9jb25maWcuZGVidWcuY2FjaGVfbW9kZSA9PT0gInNlc3Npb24iKSB7CgkJCQkJY2FjaGVfc3RvcmFnZSA9IHdpbmRvdy5zZXNzaW9uU3RvcmFnZTsKCQkJCX0KCQkJCWVsc2UgaWYgKGdsb2JhbF9jb25maWcuZGVidWcuY2FjaGVfbW9kZSA9PT0gIm5vbmUiKSB7CgkJCQkJY2FjaGVfc3RvcmFnZSA9IEFQSS5jcmVhdGVfdGVtcF9zdG9yYWdlKCk7CgkJCQl9CgoJCQkJLy8gRG9uZQoJCQkJdm9pZChpbmZvKTsgLy8gdG8gbWFrZSBqc2hpbnQgaWdub3JlIHRoZSB1bnVzZWQgdmFyCgkJCQljYWxsYmFjayhudWxsKTsKCQkJfTsKCgkJCXZhciByZWdpc3RlciA9IGZ1bmN0aW9uIChkYXRhLCBjYWxsYmFjaykgewoJCQkJdmFyIGNvbXBsZXRlID0gcmVtb3ZlX3dhaXRpbmdfcmVnaXN0cmF0aW9ucygxKSwKCQkJCQlhcnIsIG8sIGksIGlpOwoKCQkJCS8vIFNldHRpbmdzCgkJCQlpbnRlcm5hbF9hcGlfZm5zLnJlZ2lzdGVyX3NldHRpbmdzKGRhdGEuc2V0dGluZ3MsIGNvbmZpZyk7CgoJCQkJLy8gTGlua2lmaWVycwoJCQkJaWYgKEFycmF5LmlzQXJyYXkoKGFyciA9IGRhdGEubGlua2lmaWVycykpKSB7CgkJCQkJZm9yIChpID0gMCwgaWkgPSBhcnIubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJCQlpZiAoaXNfb2JqZWN0KChvID0gYXJyW2ldKSkpIHsKCQkJCQkJCWludGVybmFsX2FwaV9mbnMucmVnaXN0ZXJfbGlua2lmaWVyKG8pOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIFJlcXVlc3QgQVBJcwoJCQkJaWYgKEFycmF5LmlzQXJyYXkoKGFyciA9IGRhdGEucmVxdWVzdF9hcGlzKSkpIHsKCQkJCQlmb3IgKGkgPSAwLCBpaSA9IGFyci5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQkJCWlmIChpc19vYmplY3QoKG8gPSBhcnJbaV0pKSkgewoJCQkJCQkJaW50ZXJuYWxfYXBpX2Zucy5yZWdpc3Rlcl9yZXF1ZXN0X2FwaShvKTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQkvLyBVUkwgaW5mbyBmdW5jdGlvbgoJCQkJaWYgKEFycmF5LmlzQXJyYXkoKGFyciA9IGRhdGEuY29tbWFuZHMpKSkgewoJCQkJCWZvciAoaSA9IDAsIGlpID0gYXJyLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJaWYgKGlzX29iamVjdCgobyA9IGFycltpXSkpKSB7CgkJCQkJCQlpbnRlcm5hbF9hcGlfZm5zLnJlZ2lzdGVyX2NvbW1hbmQobyk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgoJCQkJLy8gVVJMIGNyZWF0ZSBmdW5jdGlvbnMKCQkJCWlmIChpc19vYmplY3QoKG8gPSBkYXRhLmNyZWF0ZV91cmwpKSkgewoJCQkJCWludGVybmFsX2FwaV9mbnMucmVnaXN0ZXJfY3JlYXRlX3VybChvKTsKCQkJCX0KCgkJCQkvLyBEb25lCgkJCQlpZiAodHlwZW9mKGNhbGxiYWNrKSA9PT0gImZ1bmN0aW9uIikgY2FsbGJhY2sobnVsbCk7CgkJCQlNYWluLnN0YXJ0X3Byb2Nlc3NpbmcoIWNvbXBsZXRlKTsKCQkJfTsKCgkJCS8vIFRoaXMgc2hvdWxkIG1hdGNoIGFwaS5qcwoJCQlyZXR1cm4gewoJCQkJUmVxdWVzdEVycm9yTW9kZTogQVBJLlJlcXVlc3RFcnJvck1vZGUsCgkJCQlJbWFnZUZsYWdzOiBBUEkuSW1hZ2VGbGFncywKCQkJCWluaXQ6IGluaXQsCgkJCQljb25maWc6IGNvbmZpZywKCQkJCXJlZ2lzdGVyOiByZWdpc3RlciwKCQkJCXJlcXVlc3Q6IHJlcXVlc3QsCgkJCQlnZXRfaW1hZ2U6IEFQSS5nZXRfdGh1bWJuYWlsLAoJCQkJaW5zZXJ0X3N0eWxlczogJC5pbnNlcnRfc3R5bGVzLAoJCQkJcGFyc2VfanNvbjogJC5qc29uX3BhcnNlX3NhZmUsCgkJCQlwYXJzZV9odG1sOiAkLmh0bWxfcGFyc2Vfc2FmZSwKCQkJCXBhcnNlX3htbDogJC54bWxfcGFyc2Vfc2FmZSwKCQkJCWdldF9kb21haW46ICQuZ2V0X2RvbWFpbiwKCQkJCXJhbmRvbV9zdHJpbmc6IHJhbmRvbV9zdHJpbmcsCgkJCQlpc19vYmplY3Q6IGlzX29iamVjdCwKCQkJCXR0bF8xX2hvdXI6IHR0bF8xX2hvdXIsCgkJCQl0dGxfMV9kYXk6IHR0bF8xX2RheSwKCQkJCXR0bF8xX3llYXI6IHR0bF8xX3llYXIsCgkJCQljYWNoZV9zZXQ6IGNhY2hlX3NldCwKCQkJCWNhY2hlX2dldDogY2FjaGVfZ2V0CgkJCX07CgoJCX07CgoKCQkvLyBQdWJsaWMKCQl2YXIgaW5pdCA9IGZ1bmN0aW9uICgpIHsKCQkJaWYgKGFwaSA9PT0gbnVsbCkgYXBpID0gbmV3IEV4dGVuc2lvbkFQSSgpOwoJCX07CgoJCXZhciByZXF1ZXN0ID0gZnVuY3Rpb24gKG5hbWVzcGFjZSwgdHlwZSwgdW5pcXVlX2lkLCBpbmZvLCBjYWxsYmFjaykgewoJCQl2YXIgcmVxX2RhdGE7CgkJCWlmICgKCQkJCWFwaSA9PT0gbnVsbCB8fAoJCQkJKHJlcV9kYXRhID0gYXBpLnJlcXVlc3RfYXBpc1tuYW1lc3BhY2VdKSA9PT0gdW5kZWZpbmVkIHx8CgkJCQkocmVxX2RhdGEgPSByZXFfZGF0YVt0eXBlXSkgPT09IHVuZGVmaW5lZAoJCQkpIHsKCQkJCWNhbGxiYWNrLmNhbGwobnVsbCwgIkludmFsaWQgZXh0ZW5zaW9uIHJlcXVlc3QgQVBJIiwgbnVsbCk7CgkJCQlyZXR1cm47CgkJCX0KCgkJCXJldHVybiByZXFfZGF0YS5hZGQodW5pcXVlX2lkLCBpbmZvLCBmYWxzZSwgY2FsbGJhY2spOwoJCX07CgoJCXZhciBzaG91bGRfZGVmZXJfcHJvY2Vzc2luZyA9IGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIGRvY3VtZW50X2VsZW1lbnQuaGFzQXR0cmlidXRlKCJkYXRhLXhsaW5rcy1leHRlbnNpb25zLXdhaXRpbmciKTsKCQl9OwoKCQl2YXIgZ2V0X3JlZ2lzdGVyZWRfZXh0ZW5zaW9ucyA9IGZ1bmN0aW9uICgpIHsKCQkJcmV0dXJuIHJlZ2lzdGVyZWQ7CgkJfTsKCgoJCS8vIEV4cG9ydHMKCQlyZXR1cm4gewoJCQlpbml0OiBpbml0LAoJCQlyZXF1ZXN0OiByZXF1ZXN0LAoJCQlzaG91bGRfZGVmZXJfcHJvY2Vzc2luZzogc2hvdWxkX2RlZmVyX3Byb2Nlc3NpbmcsCgkJCWdldF9yZWdpc3RlcmVkX2V4dGVuc2lvbnM6IGdldF9yZWdpc3RlcmVkX2V4dGVuc2lvbnMsCgkJCXNldF9leHRlbnNpb25zX2VuYWJsZWQ6IHNldF9leHRlbnNpb25zX2VuYWJsZWQKCQl9OwoKCX0pKCk7Cgl2YXIgTWFpbiA9IChmdW5jdGlvbiAoKSB7CgoJCS8vIFByaXZhdGUKCQl2YXIgcmVhZHkgPSBmYWxzZSwKCQkJZm9udHNfaW5zZXJ0ZWQgPSBmYWxzZSwKCQkJYWxsX3Bvc3RzX3JlbG9hZGVkID0gZmFsc2UsCgkJCXByb2Nlc3Npbmdfc3RhcnRlZCA9IGZhbHNlLAoJCQlwcm9jZXNzaW5nX3N0YXJ0X3RpbWVyID0gbnVsbDsKCgkJdmFyIHJlbG9hZF9hbGxfcG9zdHMgPSBmdW5jdGlvbiAoKSB7CgkJCWlmIChhbGxfcG9zdHNfcmVsb2FkZWQpIHJldHVybjsKCQkJYWxsX3Bvc3RzX3JlbG9hZGVkID0gdHJ1ZTsKCgkJCUxpbmtpZmllci5yZWxpbmtpZnlfcG9zdHMoUG9zdC5nZXRfYWxsX3Bvc3RzKGRvY3VtZW50KSk7CgkJfTsKCgkJdmFyIG9uX3JlYWR5ID0gZnVuY3Rpb24gKCkgewoJCQlyZWFkeSA9IHRydWU7CgkJCURlYnVnLnRpbWVyKCJpbml0Iik7CgoJCQlpZiAoIUNvbmZpZy5yZWFkeSgpKSByZXR1cm47CgkJCVNldHRpbmdzLnJlYWR5KCk7CgoJCQkkLmluc2VydF9zdHlsZXMoIi54bC1zdGFycy1jb250YWluZXJ7cG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDowO3doaXRlLXNwYWNlOm5vd3JhcH0ueGwtc3RhcnMtY29udGFpbmVyLnhsLXN0YXJzLWNvbnRhaW5lci1uYXtvcGFjaXR5Oi41fS54bC1zdGFyLW5vbmV7YmFja2dyb3VuZC1pbWFnZTp1cmwoZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCd0FBQUFjQ0FRQUFBRFlCQmNmQUFBQTVVbEVRVlI0QVoyVndRbUVNQkJGZngwUzVpd1dKQ0loaFN3aFJYZ1NFZXNRQ1Z1SXpiZ0NHaUxKNEdUemJ1cGp2dnFOWUZjRGQ5S2djQkZtSENjenFFelVPQzUwbWVpQzZFbzBoUzJJRzVSYzdIRkU5SExSUGtRcmY2TCtJWHBRL24wWnVKaWd4YXA3WUVBaFZpRWErUHdyMXREd1JaS0h2dSthc0lpMTVaWnVkUkpwRXlodHkvQ3FEZmtXVldpeHM5S09GcFdnM0FtdW9ETk1mL2l2a0VITGd3ckRFcjZNOGhMV0pCZDZQaXdmZEFTZGpPOWhGZFpvVmc5MUhlMmp1V3V1QUYwNFBZUFNyZktpUzBXYkszRlFGMzRiTWNtMDNGU1QzL0l0YW5DcmhvMS9DVDk2TFY3aXlVRVd3Z0FBQUFCSlJVNUVya0pnZ2c9PSl9LnhsLXN0YXItaGFsZntiYWNrZ3JvdW5kLWltYWdlOnVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJ3QUFBQWNDQVlBQUFCeURkK1VBQUFEQTBsRVFWUjRBYldXQTdQa1FCUkcrOW0yOHViWk50YTJiZHUyYmR1MmJkdTJyWi93N2UydDlES1RIVlM2Nmd5U3laeTZYNU1aMi9KaldUd3gxTVdCVGJXMVpzbE15MFlpaWN0eUkyemhhbThCR3l1MmtpNUxXZ3FiY2xuRGtnN3dkYmVFblRVRFhXNnNtVkJVTjZ5RkgwTDliWVJ3cUpaeEx1WEMyWDEwaUFxeEU4S0RSTEJtY2ZacTRJdWpDOU9SRXUwTVZ5ZExMdVEwMUN6TzhWMTB1THV6T0xJUzNlRHVZaVdFZ3pXTGM5bW9SRHc2VUFiWnlSN3djcmNSd3NPRVpNeThha29NMVllUVRlNFZqY3RiUytINThjcklTZkZFZ0krZEVBcnBVQldhRXBLSUN2OWpTdTlvWE4xUkRxL1AxaVJxSURmTkM4SCtEa0ptS0kzL0VOSm5kS25wZ1pGdEFqQ21RekQxVnlnbWRnL0hpckVwNExJMzUrdmkvYVVHUkYza3BYdWJMQlNSTGhWejdNQ3NKRnpmbU04SEIvVlhXWXF3Q25obFhQYnhlbE44dXQ0QStSaytDQTR3V0hpWXl3aEpjZG5pRmRMUWw0Vmx3UHVNeDhncjQ3SnZ0K3FSME50UTRWSWhVbDByZXpid3dhS2hNVGkzcmhEUGpsYkFxOU5WOE81Q0RYeTRVaHVmcnRZa29VRjl1RkN2VEVuS21kQk5od3NiQy9IaVJBVzhQbE1aNzg1emNXWGtwWG1TMEY1Tk50UFFGVWhJbXhKSHVYVFp5Rmc4UFZ3YUw0Nlh4Y3VUNWZEcVZEbmtwbm9nMkU5UitKQ29Td1Nhc2JwSWVMaTNLQjRmTElHbmg0akRKWkNUN0lZZ1B6c2w0VkN6VjVjRmc4SnhaM3NlN3UzS3gvM2RCWGl3SngvWmlhNEk5TFhWTnlJbGt4ZnI3blU4Y0dodUFxNnR6OEROVFptNHVTVUx0NGpNQkdjRSt0anFuVyttNzMzTnZYRnVTUUl1TEUvQ3BWWEpPRGduRG5QN2h2RHRDWDZlMXZxRVEwMk9jM0lISHh5ZkU0MVQ4Mkt3ZTNJRWhyZjBoamhpdURtTDdjbk1XRVdjN1NvNllOM0FBR3djR29SSjdiM1J1WnF6V0FLWE90bXpjL0lHYkg2c0lzNWUxUjJ4b3BjMyt0YjVJUkt5b1lUa2JNK2liS3paVWhYaFVLUGo3RjdGQVQycU9rSlVKYy9ObjFIWjJUQ2R2TnNmVmhEdUo0SU5qck5XcmpXYWw3RDdveXFWeHlSaXNZSzB2cUZ4Y29tNlRGSDZUOFNERGEzUWNKbDZwVTBOUHNyTHhEUGpXNnhjMlZEaW4rZS9BenE0THhYNWlhVFdBQUFBQUVsRlRrU3VRbUNDKX0ueGwtc3Rhci1mdWxse2JhY2tncm91bmQtaW1hZ2U6dXJsKGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQndBQUFBY0NBWUFBQUJ5RGQrVUFBQURoRWxFUVZSNEFiV1dnM0lzVVJSRjgyemJ0bTNidG0zYnRtUGJ0bTNidHZFSis5M1RsYm1WaWdhcFNWVjNEM3RscjRORVFkcWY1Vk1WcHJQamRmMHhYZHJ2U3dzYlRhQ2xFenFEam5yb2FIa0NUeFBvK1BwdWRJaWdwK1VKRk5LOU9UY0VyODhPNWlubHFWT1hJTXFQeGtMNTRSZ1JVSmRybFlmT0I4Y0d3MWR6UG53MDV1SCswWUZjcTl4MGZyMDFGcW1PYTVIaXNCcGZibzdpV3VXbVUrL0RUR1I1YkVLbSswYm92SnNxclZZK1Y2ZjViRFYvQ0xDZkR5WWoybllEOHYxM0lzOTNHeUlzVitMNzNiRWNLdVlleEJqTlZZazdmajJjakZpSExTZ08zYytPZlNnSzNvV0NnRzJJSk9pZE1XSy96MnZkYUpCeGEzOC92TDgwREordWpXVDFHc01TaklmQjV6a0NyQ1Q4TU1xampySGpNTW9pOXFFNFpDY0svRGNqM0h3WmRONU14T2Zydy9IaDhoQzhQVGNRTDAvMnhiVWQzZW1lallGY3FhNW94anlVWmlIZWNqazFCNnZYWnFad0Z5VVRZSlh4cDFFVmZ3d1ZNUWRSRnI0TGhZRmJrT3UxRHVuT0s1Qm9zd2pSeG5NUXFqVVZ0cDlHNDluUlhsdzNWOXJNMnFLRTFQcjF3RTFVTTlKSXlRUllYZElSVk1YdVp5bDNvaWlJQWIzWEljTmxPWklZTU1aNE5seCtUY0RMVS8zRXI3K0cwUHZIQmtIcjlSU0VtYTJrQnFHYWtVWktKc0Fxb25lak5HdzdDZ00ySXNkckRkS2Rsc0ZmZXhaVUg0M0VuUU85RzhHa1dORGY3b3lsYnFRR29acVJSa3BHTUphTzZmWmRoMnozbFFneW1JdlAxNFpDaHNYT29lVGNWNWk5OTFPWnRvM1VJRlF6MGlna0UyQWVxNUhodkF4YUwvaDQrUEo2eWI1ZFJpUFRkVFd5UGRkUmcxRE5TQ01sRTJBcHRvdnc2ZXBRbnF6TjIwWGp4WGlrMkM5RG10Tnk2a1pxRUtvWmE2b2xTTFpaaUhqenVWQjVOS0pOeTV3djY3dUgrc0ZMZFFiaXpCY2cwV29odGI3UWpZbldDNUJnT1EreHByTVJaVGdETHIvSDQ5WStQZ2FuWmYvYmQzWWd3blJtSUVKL0ZxS01ac05UWlJwVUg0OFN1dEZEY1RMQ2RhY2pSSE15QXBUSDQ4V0pQbHlyekRwL1hoc0VmNVhKQ0ZLYkF1ZWZFL0QyL0VEZWlXL09EWURqMTlId1ZSd0hyNStqOFBWQ0g1bTBjcDFYdG5lRDJmTmhzSHc5QWordURzVE5QVDM1RFVXLzBQWGRQUmlvTDB5ZURvTGhnMzY0dEtXTDFGcTV6Z2Q3dThQZ3dVQThQdFN6eVh3MW50ZUgrN3BENTNZLzNOdmRuWDlPYXAxM2QzWGpOMmk4RHh2TksvLzhuUjNkcE5MS2RSNVkyaEZuMTNXUmFHczBUSHQyYldmc1g5SlJZcTFjSjdzMkR4TUhiZlJkaVJPS2hZbUI4b1R5L1ZkZS9QZi9BeHJCNFJyKzFiOWZBQUFBQUVsRlRrU3VRbUNDKX0ueGwtc3RhcntkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoxLjJlbTtoZWlnaHQ6MS40ZW07bWFyZ2luLWxlZnQ6LS4xZW07bWFyZ2luLXJpZ2h0Oi0uMWVtO21hcmdpbi1ib3R0b206LS4yZW07YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JhY2tncm91bmQtc2l6ZTpjb3ZlcjtiYWNrZ3JvdW5kLXBvc2l0aW9uOi0uMWVtIDA7cG9zaXRpb246cmVsYXRpdmV9LnhsLXN0YXItMXt6LWluZGV4OjQ7d2lkdGg6MS4zZW07YmFja2dyb3VuZC1wb3NpdGlvbjowIDB9LnhsLXN0YXItMnt6LWluZGV4OjN9LnhsLXN0YXItM3t6LWluZGV4OjJ9LnhsLXN0YXItNHt6LWluZGV4OjF9LnhsLXN0YXItNXt6LWluZGV4OjA7d2lkdGg6MS4zZW19LnhsLWJ1dHRvbntkaXNwbGF5OmlubGluZS1ibG9jaztwYWRkaW5nOi4zZW0gMWVtO2ZvbnQtc2l6ZTppbmhlcml0O2xpbmUtaGVpZ2h0OjEuNmVtO2NvbG9yOiMzMzM7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1zaGFkb3c6MCAuMDhlbSAuMDhlbSByZ2JhKDI1NSwyNTUsMjU1LC43NSk7dmVydGljYWwtYWxpZ246bWlkZGxlO2N1cnNvcjpwb2ludGVyO2JhY2tncm91bmQtY29sb3I6I2Y1ZjVmNTtiYWNrZ3JvdW5kLWltYWdlOi13ZWJraXQtZ3JhZGllbnQobGluZWFyLDAgMCwwIDEwMCUsZnJvbSgjZmZmKSx0bygjZTZlNmU2KSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsI2ZmZiwjZTZlNmU2KTtiYWNrZ3JvdW5kLWltYWdlOi1vLWxpbmVhci1ncmFkaWVudCh0b3AsI2ZmZiwjZTZlNmU2KTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCh0byBib3R0b20sI2ZmZiwjZTZlNmU2KTtiYWNrZ3JvdW5kLWltYWdlOi1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwjZmZmLCNlNmU2ZTYpO2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtib3JkZXI6MXB4IHNvbGlkICNiYmI7Ym9yZGVyLWNvbG9yOnJnYmEoMCwwLDAsLjEpIHJnYmEoMCwwLDAsLjEpIHJnYmEoMCwwLDAsLjI1KTtib3JkZXItY29sb3I6I2U2ZTZlNiAjZTZlNmU2ICNiZmJmYmY7Ym9yZGVyLWJvdHRvbS1jb2xvcjojYTJhMmEyO2JvcmRlci1yYWRpdXM6LjNlbTtib3gtc2hhZG93Omluc2V0IDAgLjA4ZW0gMCByZ2JhKDI1NSwyNTUsMjU1LC4yKSwwIC4wOGVtIC4xNmVtIHJnYmEoMCwwLDAsLjA1KX0ueGwtYnV0dG9uLWVoe2ZvbnQtZmFtaWx5OidTb3VyY2UgU2FucyBQcm8nLFRhaG9tYSxzYW5zLXNlcmlmO2ZvbnQtd2VpZ2h0OjkwMDtmb250LXNpemU6Ljg2ZW07d2lkdGg6MTAwJTtwYWRkaW5nOi4xNWVtIDA7Y29sb3I6I2ZmZiFpbXBvcnRhbnQ7Ym94LXNoYWRvdzowIDAgLjVlbSByZ2JhKDAsMCwwLC41KTt0ZXh0LXNoYWRvdzouMDllbSAuMDllbSAwIHJnYmEoMCwwLDAsLjUpLDAgMCAuM2VtICMwMDA7LXdlYmtpdC1mb250LXNtb290aGluZzphbnRpYWxpYXNlZH0ueGwtYnV0dG9uMXtiYWNrZ3JvdW5kLWNvbG9yOiM4NDA1MDU7YmFja2dyb3VuZC1pbWFnZTota2h0bWwtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGZyb20oI2Y3NDA0MCksdG8oIzg0MDUwNSkpO2JhY2tncm91bmQtaW1hZ2U6LW1vei1saW5lYXItZ3JhZGllbnQodG9wLCNmNzQwNDAsIzg0MDUwNSk7YmFja2dyb3VuZC1pbWFnZTotbXMtbGluZWFyLWdyYWRpZW50KHRvcCwjZjc0MDQwLCM4NDA1MDUpO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sY29sb3Itc3RvcCgwLCNmNzQwNDApLGNvbG9yLXN0b3AoMTAwJSwjODQwNTA1KSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsI2Y3NDA0MCwjODQwNTA1KTtiYWNrZ3JvdW5kLWltYWdlOi1vLWxpbmVhci1ncmFkaWVudCh0b3AsI2Y3NDA0MCwjODQwNTA1KTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjZjc0MDQwLCM4NDA1MDUpO2JvcmRlci1jb2xvcjojODQwNTA1ICM4NDA1MDUgaHNsKDAsOTIlLDE4LjUlKX0ueGwtYnV0dG9uMntiYWNrZ3JvdW5kLWNvbG9yOiM3YTI4MDA7YmFja2dyb3VuZC1pbWFnZTota2h0bWwtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGZyb20oI2ZmNzYzMiksdG8oIzdhMjgwMCkpO2JhY2tncm91bmQtaW1hZ2U6LW1vei1saW5lYXItZ3JhZGllbnQodG9wLCNmZjc2MzIsIzdhMjgwMCk7YmFja2dyb3VuZC1pbWFnZTotbXMtbGluZWFyLWdyYWRpZW50KHRvcCwjZmY3NjMyLCM3YTI4MDApO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sY29sb3Itc3RvcCgwLCNmZjc2MzIpLGNvbG9yLXN0b3AoMTAwJSwjN2EyODAwKSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsI2ZmNzYzMiwjN2EyODAwKTtiYWNrZ3JvdW5kLWltYWdlOi1vLWxpbmVhci1ncmFkaWVudCh0b3AsI2ZmNzYzMiwjN2EyODAwKTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjZmY3NjMyLCM3YTI4MDApO2JvcmRlci1jb2xvcjojN2EyODAwICM3YTI4MDAgIzRjMTkwMH0ueGwtYnV0dG9uM3tiYWNrZ3JvdW5kLWNvbG9yOiM3YTZhMDA7YmFja2dyb3VuZC1pbWFnZTota2h0bWwtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGZyb20oI2ZmZTk1YiksdG8oIzdhNmEwMCkpO2JhY2tncm91bmQtaW1hZ2U6LW1vei1saW5lYXItZ3JhZGllbnQodG9wLCNmZmU5NWIsIzdhNmEwMCk7YmFja2dyb3VuZC1pbWFnZTotbXMtbGluZWFyLWdyYWRpZW50KHRvcCwjZmZlOTViLCM3YTZhMDApO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sY29sb3Itc3RvcCgwLCNmZmU5NWIpLGNvbG9yLXN0b3AoMTAwJSwjN2E2YTAwKSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsI2ZmZTk1YiwjN2E2YTAwKTtiYWNrZ3JvdW5kLWltYWdlOi1vLWxpbmVhci1ncmFkaWVudCh0b3AsI2ZmZTk1YiwjN2E2YTAwKTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjZmZlOTViLCM3YTZhMDApO2JvcmRlci1jb2xvcjojN2E2YTAwICM3YTZhMDAgIzQyMzkwMH0ueGwtYnV0dG9uNHtiYWNrZ3JvdW5kLWNvbG9yOiMyNzMyMTQ7YmFja2dyb3VuZC1pbWFnZTotbW96LWxpbmVhci1ncmFkaWVudCh0b3AsIzk2YmE1OCwjMjczMjE0KTtiYWNrZ3JvdW5kLWltYWdlOi13ZWJraXQtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGNvbG9yLXN0b3AoMCwjOTZiYTU4KSxjb2xvci1zdG9wKDEwMCUsIzI3MzIxNCkpO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCM5NmJhNTgsIzI3MzIxNCk7YmFja2dyb3VuZC1pbWFnZTotby1saW5lYXItZ3JhZGllbnQodG9wLCM5NmJhNTgsIzI3MzIxNCk7YmFja2dyb3VuZC1pbWFnZTpsaW5lYXItZ3JhZGllbnQoIzk2YmE1OCwjMjczMjE0KTtib3JkZXItY29sb3I6IzI3MzIxNCAjMjczMjE0ICMwYjBlMDV9LnhsLWJ1dHRvbjV7YmFja2dyb3VuZC1jb2xvcjojNGQ3YTAwO2JhY2tncm91bmQtaW1hZ2U6LW1vei1saW5lYXItZ3JhZGllbnQodG9wLCNjM2ZmNWIsIzRkN2EwMCk7YmFja2dyb3VuZC1pbWFnZTotbXMtbGluZWFyLWdyYWRpZW50KHRvcCwjYzNmZjViLCM0ZDdhMDApO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sY29sb3Itc3RvcCgwLCNjM2ZmNWIpLGNvbG9yLXN0b3AoMTAwJSwjNGQ3YTAwKSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsI2MzZmY1YiwjNGQ3YTAwKTtiYWNrZ3JvdW5kLWltYWdlOi1vLWxpbmVhci1ncmFkaWVudCh0b3AsI2MzZmY1YiwjNGQ3YTAwKTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjYzNmZjViLCM0ZDdhMDApO2JvcmRlci1jb2xvcjojNGQ3YTAwICM0ZDdhMDAgIzI5NDIwMH0ueGwtYnV0dG9uNntiYWNrZ3JvdW5kLWNvbG9yOiMyMjUzNTg7YmFja2dyb3VuZC1pbWFnZTotbW96LWxpbmVhci1ncmFkaWVudCh0b3AsIzczYzFjOCwjMjI1MzU4KTtiYWNrZ3JvdW5kLWltYWdlOi13ZWJraXQtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGNvbG9yLXN0b3AoMCwjNzNjMWM4KSxjb2xvci1zdG9wKDEwMCUsIzIyNTM1OCkpO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCM3M2MxYzgsIzIyNTM1OCk7YmFja2dyb3VuZC1pbWFnZTotby1saW5lYXItZ3JhZGllbnQodG9wLCM3M2MxYzgsIzIyNTM1OCk7YmFja2dyb3VuZC1pbWFnZTpsaW5lYXItZ3JhZGllbnQoIzczYzFjOCwjMjI1MzU4KTtib3JkZXItY29sb3I6IzIyNTM1OCAjMjI1MzU4IGhzbCgxODUsNDQlLDE0LjUlKX0ueGwtYnV0dG9uN3tiYWNrZ3JvdW5kLWNvbG9yOiMwZTM5NjE7YmFja2dyb3VuZC1pbWFnZTotbW96LWxpbmVhci1ncmFkaWVudCh0b3AsIzU2YTBlNSwjMGUzOTYxKTtiYWNrZ3JvdW5kLWltYWdlOi13ZWJraXQtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGNvbG9yLXN0b3AoMCwjNTZhMGU1KSxjb2xvci1zdG9wKDEwMCUsIzBlMzk2MSkpO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCM1NmEwZTUsIzBlMzk2MSk7YmFja2dyb3VuZC1pbWFnZTotby1saW5lYXItZ3JhZGllbnQodG9wLCM1NmEwZTUsIzBlMzk2MSk7YmFja2dyb3VuZC1pbWFnZTpsaW5lYXItZ3JhZGllbnQoIzU2YTBlNSwjMGUzOTYxKTtib3JkZXItY29sb3I6IzBlMzk2MSAjMGUzOTYxICMwNzFmMzV9LnhsLWJ1dHRvbjh7YmFja2dyb3VuZC1jb2xvcjojM2EyODYxO2JhY2tncm91bmQtaW1hZ2U6LW1vei1saW5lYXItZ3JhZGllbnQodG9wLCNhOTk2ZDMsIzNhMjg2MSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWdyYWRpZW50KGxpbmVhcixsZWZ0IHRvcCxsZWZ0IGJvdHRvbSxjb2xvci1zdG9wKDAsI2E5OTZkMyksY29sb3Itc3RvcCgxMDAlLCMzYTI4NjEpKTtiYWNrZ3JvdW5kLWltYWdlOi13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwjYTk5NmQzLCMzYTI4NjEpO2JhY2tncm91bmQtaW1hZ2U6LW8tbGluZWFyLWdyYWRpZW50KHRvcCwjYTk5NmQzLCMzYTI4NjEpO2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KCNhOTk2ZDMsIzNhMjg2MSk7Ym9yZGVyLWNvbG9yOiMzYTI4NjEgIzNhMjg2MSAjMjIxODM5fS54bC1idXR0b245e2JhY2tncm91bmQtY29sb3I6Izc0MGY1MTtiYWNrZ3JvdW5kLWltYWdlOi1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwjZWM3OGMzLCM3NDBmNTEpO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sY29sb3Itc3RvcCgwLCNlYzc4YzMpLGNvbG9yLXN0b3AoMTAwJSwjNzQwZjUxKSk7YmFja2dyb3VuZC1pbWFnZTotd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsI2VjNzhjMywjNzQwZjUxKTtiYWNrZ3JvdW5kLWltYWdlOi1vLWxpbmVhci1ncmFkaWVudCh0b3AsI2VjNzhjMywjNzQwZjUxKTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjZWM3OGMzLCM3NDBmNTEpO2JvcmRlci1jb2xvcjojNzQwZjUxICM3NDBmNTEgIzQzMDkyZX0ueGwtYnV0dG9uMHtiYWNrZ3JvdW5kLWNvbG9yOiMzNTM1MzU7YmFja2dyb3VuZC1pbWFnZTotbW96LWxpbmVhci1ncmFkaWVudCh0b3AsI2JmYmZiZiwjMzUzNTM1KTtiYWNrZ3JvdW5kLWltYWdlOi13ZWJraXQtZ3JhZGllbnQobGluZWFyLGxlZnQgdG9wLGxlZnQgYm90dG9tLGNvbG9yLXN0b3AoMCwjYmZiZmJmKSxjb2xvci1zdG9wKDEwMCUsIzM1MzUzNSkpO2JhY2tncm91bmQtaW1hZ2U6LXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCNiZmJmYmYsIzM1MzUzNSk7YmFja2dyb3VuZC1pbWFnZTotby1saW5lYXItZ3JhZGllbnQodG9wLCNiZmJmYmYsIzM1MzUzNSk7YmFja2dyb3VuZC1pbWFnZTpsaW5lYXItZ3JhZGllbnQoI2JmYmZiZiwjMzUzNTM1KTtib3JkZXItY29sb3I6IzM1MzUzNSAjMzUzNTM1IGhzbCgzMjEsMCUsNy41JSl9LnhsLW5vaXNle2NvbG9yOiNmZmYhaW1wb3J0YW50O21hcmdpbjowO3BhZGRpbmc6LjEyNWVtIDA7bWFyZ2luLWJvdHRvbTotLjI1ZW07Ym9yZGVyLXJhZGl1czouMjVlbTtwb3NpdGlvbjpyZWxhdGl2ZTt0b3A6LS4xMjVlbTtiYWNrZ3JvdW5kLWltYWdlOnVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUdRQUFBQXlDQU1BQUFDZDY0Nk1BQUFBRzFCTVZFVUFBQUFmSHg4L1B6OWZYMTkvZjMrZm41Ky92Ny9mMzkvLy8vOE5YOWpQQUFBQUNYUlNUbE1JQ0FnSUNBZ0lDQVdIZ2FJWEFBQUVya2xFUVZSNDJyV1hPWklsTkJCRW4yckxkLzhUWXhCREFORXNBNzhkR1NwRHFpMFhHbURMMDRjS2FuUldocldCdkhxYlVvZW12SFpzY041RVZNVjFLelRYemZNWXRHVnZrZW1OSFZXaU5pdGlDKyt3dzNNNU1jTnNGeGFLa1ljb3RFeVVDS2NjTFh2eVhHRlZmVS91WUEyb1dxL0w5ZWFwbXNPbVFkN0JFN0JjRkViV1FwL2pORTlqcjZPallZYUFKOUswMUxyQ3JDT2MySW0yd1ZMc2ZqS0hzSEl0dENuMERsWXBVMHRCU1FNTTlnUlhwcjhwTGFSZEd6VVBwVmVmVDFEdjdhRloxd0dMNk9IUHRSS2c5QlcxR0NrdEN4cTllUFpqaGNzSkNvcllDT1pnSGRjY29td3JiMUZMMGZQUUoxbFl1S2ZhbHFqZURWRk1qK2JVWjBkN0JTSENQaG5xZVgwQ0tscXYxMUZsaGJYQWp1MFltb2RXVG8yb3R1ZTFWODRXUGxUNlBXdHZSVUdaUzYzNENza0dqNHNvZ3FKVERZMUJ0OEVNK1ZnbEtSV2dSMzJud2hySWsvR3AvM3NBQVZlbjNoUHZScFZ3cjVRRDBlZXFWZ0NOeXZTNldyUUMxSk4reTdoQTA2cUtMZkMzd1ZXRHJWWmJ2U0R2amFUVUtsZTBxQlVaaldpZm50dU41VFhJMjVvd2VLek90RWpadG1jY2xhbmhDbE1JTHRFbXJUNVJlS2JVWnpYNlJ4eEJsVFhkTFpBZGtSUjJGYlRQdDE3c1Uwa3BMZGRuTEgxSXFhcW9BTVRjcVpvNkNnVy91eXRQdFpWeElwWVcwb054SDNncVowUVFkeVhlaU9CNkN5dmF4UVNnckRYa3psaHZNZVBjeVNqNzFPYzRpbHdWQW9OaVpiMzFkVHpUSS92c3NOV3hoenB2RkhDUkhRMEE0Z090T2NMUjduTnBRVVY4NDZyeVlpM3lWSUQxK1U3c3gveTROU3F6RnFNVnpVTSt2dDVmQUNWb0ZzeVJaK3MySUl5SVN5YU1qaDV5eUxxckl1WjhmWTJMektTZTE2OThJb2ptTmFoVW84OTFWcDNzUTFYZkNNQ2JGVXZya0JQdlZobEQ0VW9wcnc0ZEhGbGx0TlNSczN3dm5YNmVGODBpbkI2ZzU3eTJGUjE3VDBRekRCaWZwZSt5NnJKSW1zaVVjRDlTK3RheGNsYjVheEx3dG5Ha1p3SWN0NEs0cHlDdEpRK1BVMVdqYkJyRExENFY4UjhGVFcrZWJ6THEyQTNHWVdxUnFEeTBrUWJQUTE3aktlZmQ4SFVSKzZCVVA0TnE0S0FPdXJGQnpEemVPcUw2K2drYWxsNlQ5N056ajgvOGVwU09yNFRWb2xoRWxYWkdMaTNvTWplcWdqTFBXaEVrZlJvY1RCcUN6ejQrcTB2U0NxKzNnZU9wZWhUeWVOdlMweTJLbUM3eFZ1YnB1ejFYeVpsVnRINUNHN0NLd3ZVNUxpSk5MVHowd2ZXVVVzRHF2aGJSeDR0b0tmb2tOTVUycmxaNTVuclA0VEZsZVhPcXFORHY5ZDE5VVBYeEtUZ3Z3b3pDRy9XcHBTUHJJUllBUFhpQ2lXcGpYZTZjUnRUdS84elVmTnRJU1hTY1FkS1dodWlJc29jTlptZHdvRlE1VE4yVml0a3ByVlg3bHNKekRsQ2hBUnpFTlp5L21jYzc2ZHVndUttWm5mYU1CdzlBcHd6YTJ2R0dpYXJqMDQ0ZXhGc0NBYlVNTnNCK1pjQSs2b2MvaVI0aXVtS3J2K05idnRPUC9pZ0gzeUdCL3J3enYxRmtLSFhWWGhqMWFFWDBVSm9GT2VBQWRNRTV4Wkxkb3hIb1ZZaUtOVDVoM1RPZXF2ZUdwaWh3UkcxMlBLUElxSDFjQ2pHOCtPQjFrNGdRUm5WMmRWUlJGS0tBNHN0cmpZTXFaUVRLNHRSUm4wOEJCTVQrZCthREQraUUxNExLcVJXKzROci9naE5uaWV4cU9OTkt1eURpYVhSVG80SmlZSWwyMlpsREorL0R4dnN2SGo5T0J0VzlkMmFsUnJ0QUZUZWlVNWFEMFVKRVpJdTJvYkVwUVBsZ1liNysyeTg0UDFqQVN3QWpvd0FBQUFCSlJVNUVya0pnZ2c9PSl9LnhsLWV4c2F1Y2UtbGlua3t3aGl0ZS1zcGFjZTpub3dyYXA7dGV4dC10cmFuc2Zvcm06bG93ZXJjYXNlfS54bC1leHNhdWNlLWhvdmVyLWxpbmt7dGV4dC1kZWNvcmF0aW9uOm5vbmUhaW1wb3J0YW50fWEueGwtZXhzYXVjZS1saW5rLnhsLWV4c2F1Y2UtbGluay1kaXNhYmxlZHt0ZXh0LWRlY29yYXRpb246bGluZS10aHJvdWdoIWltcG9ydGFudDtjdXJzb3I6ZGVmYXVsdCFpbXBvcnRhbnR9LnhsLWV4c2F1Y2UtcmVzdWx0c3tkaXNwbGF5OmJsb2NrO3doaXRlLXNwYWNlOm5vd3JhcH0ueGwtZXhzYXVjZS1yZXN1bHRzLnhsLWV4c2F1Y2UtcmVzdWx0cy1oaWRkZW57ZGlzcGxheTpub25lfS54bC1leHNhdWNlLXJlc3VsdHMtaW5uZXJ7ZGlzcGxheTp0YWJsZTtwYWRkaW5nOi4zZW07bWFyZ2luOi4yNWVtIDA7Ym9yZGVyLXJhZGl1czouMzc1ZW07YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4wNSk7cGFkZGluZzouNWVtO3doaXRlLXNwYWNlOm5vcm1hbH0ueGwtZXhzYXVjZS1yZXN1bHRzLWlubmVyLnhsLXRoZW1lLWRhcmt7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4wNSl9LnhsLWV4c2F1Y2UtcmVzdWx0cy1zZXB7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjAgLjVlbX0ueGwtZXhzYXVjZS1yZXN1bHRzLWxhYmVse3doaXRlLXNwYWNlOm5vd3JhcH0ueGwtZXhzYXVjZS1yZXN1bHRzLWxpbmt7dGV4dC1kZWNvcmF0aW9uOm5vbmUhaW1wb3J0YW50O3ZlcnRpY2FsLWFsaWduOnRvcDttYXJnaW46MCAuMzc1ZW07d2hpdGUtc3BhY2U6bm93cmFwO3RleHQtdHJhbnNmb3JtOmxvd2VyY2FzZX0ueGwtZXhzYXVjZS1yZXN1bHRzLWdyb3VwKy54bC1leHNhdWNlLXJlc3VsdHMtZ3JvdXB7bWFyZ2luLXRvcDouMjVlbX0ueGwtZXhzYXVjZS1ob3ZlcntvcGFjaXR5Oi45MztkaXNwbGF5OmJsb2NrO2ZvbnQtc2l6ZTppbmhlcml0O3Bvc2l0aW9uOmZpeGVkO3otaW5kZXg6OTkzO3BhZGRpbmc6LjVlbTttYXJnaW46MDtib3JkZXItcmFkaXVzOi4yNWVtO3dpZHRoOmF1dG87b3ZlcmZsb3c6dmlzaWJsZX0ueGwtZXhzYXVjZS1ob3Zlci54bC1leHNhdWNlLWhvdmVyLWhpZGRlbntkaXNwbGF5Om5vbmV9LnhsLWFjdGlvbnN7Ym9yZGVyLXJhZGl1czouMjVlbTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjU7Ym94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94fS54bC1hY3Rpb25zLnhsLWFjdGlvbnMtaGlkZGVue2Rpc3BsYXk6bm9uZX0ueGwtYWN0aW9uczpiZWZvcmV7Y29udGVudDpcIlwiO2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDowO2JvdHRvbTowO3JpZ2h0OjA7Ym9yZGVyLXJhZGl1czouMjVlbTtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjA1KX0ueGwtYWN0aW9ucy54bC10aGVtZS1kYXJrOmJlZm9yZXtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjA1KX0ueGwtYWN0aW9uc1tkYXRhLXhsLWFjdGlvbnMtdnBvcz1hYm92ZV06bm90KFtkYXRhLXhsLWFjdGlvbnMtaHBvcz1sZWZ0XSksLnhsLWFjdGlvbnNbZGF0YS14bC1hY3Rpb25zLXZwb3M9YWJvdmVdOm5vdChbZGF0YS14bC1hY3Rpb25zLWhwb3M9bGVmdF0pOmJlZm9yZXtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjB9LnhsLWFjdGlvbnNbZGF0YS14bC1hY3Rpb25zLXZwb3M9YmVsb3ddOm5vdChbZGF0YS14bC1hY3Rpb25zLWhwb3M9bGVmdF0pLC54bC1hY3Rpb25zW2RhdGEteGwtYWN0aW9ucy12cG9zPWJlbG93XTpub3QoW2RhdGEteGwtYWN0aW9ucy1ocG9zPWxlZnRdKTpiZWZvcmV7Ym9yZGVyLXRvcC1sZWZ0LXJhZGl1czowfS54bC1hY3Rpb25zW2RhdGEteGwtYWN0aW9ucy12cG9zPWFib3ZlXTpub3QoW2RhdGEteGwtYWN0aW9ucy1ocG9zPXJpZ2h0XSksLnhsLWFjdGlvbnNbZGF0YS14bC1hY3Rpb25zLXZwb3M9YWJvdmVdOm5vdChbZGF0YS14bC1hY3Rpb25zLWhwb3M9cmlnaHRdKTpiZWZvcmV7Ym9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6MH0ueGwtYWN0aW9uc1tkYXRhLXhsLWFjdGlvbnMtdnBvcz1iZWxvd106bm90KFtkYXRhLXhsLWFjdGlvbnMtaHBvcz1yaWdodF0pLC54bC1hY3Rpb25zW2RhdGEteGwtYWN0aW9ucy12cG9zPWJlbG93XTpub3QoW2RhdGEteGwtYWN0aW9ucy1ocG9zPXJpZ2h0XSk6YmVmb3Jle2JvcmRlci10b3AtcmlnaHQtcmFkaXVzOjB9LnhsLWFjdGlvbnMtaW5uZXJ7cG9zaXRpb246cmVsYXRpdmU7cGFkZGluZzouNWVtIDB9LnhsLWFjdGlvbnMtdGFibGV7ZGlzcGxheTp0YWJsZX0ueGwtYWN0aW9ucy10YWJsZS1yb3d7ZGlzcGxheTp0YWJsZS1yb3d9LnhsLWFjdGlvbnMtdGFibGUtY2VsbHtkaXNwbGF5OnRhYmxlLWNlbGw7aGVpZ2h0OjEwMCU7dmVydGljYWwtYWxpZ246dG9wO3RleHQtYWxpZ246bGVmdH0ueGwtYWN0aW9ucy10YWJsZS1jZWxsLnhsLWFjdGlvbnMtdGFibGUtY2VsbC1sYWJlbHt3aWR0aDowO3doaXRlLXNwYWNlOm5vd3JhcDt0ZXh0LWFsaWduOnJpZ2h0fS54bC1hY3Rpb25zLXRhYmxlLWNlbGwueGwtYWN0aW9ucy10YWJsZS1jZWxsLWxhYmVsLnhsLWFjdGlvbnMtdGFibGUtY2VsbC1mdWxse3RleHQtYWxpZ246bGVmdH0ueGwtYWN0aW9ucy10YWJsZS1zZXB7aGVpZ2h0Oi4yNWVtfS54bC1hY3Rpb25zLXRhYmxlLWhlYWRlcntmb250LXdlaWdodDo3MDA7cGFkZGluZzowIC4yNWVtIDAgMWVtO2xpbmUtaGVpZ2h0OjEuMzI1ZW19LnhsLWFjdGlvbnMtb3B0aW9uLC54bC1hY3Rpb25zLW9wdGlvbi10ZXh0e3BhZGRpbmc6MCAxZW0gMCAuMjVlbTtsaW5lLWhlaWdodDoxLjMyNWVtO2Rpc3BsYXk6YmxvY2t9LnhsLWFjdGlvbnMtdGFibGUtY2VsbC54bC1hY3Rpb25zLXRhYmxlLWNlbGwtZnVsbD4ueGwtYWN0aW9ucy10YWJsZS1oZWFkZXJ7cGFkZGluZy1yaWdodDoxZW19LnhsLWFjdGlvbnMtdGFibGUtY2VsbC54bC1hY3Rpb25zLXRhYmxlLWNlbGwtZnVsbD4ueGwtYWN0aW9ucy1vcHRpb24sLnhsLWFjdGlvbnMtdGFibGUtY2VsbC54bC1hY3Rpb25zLXRhYmxlLWNlbGwtZnVsbD4ueGwtYWN0aW9ucy1vcHRpb24tdGV4dHtwYWRkaW5nLWxlZnQ6MWVtO3BhZGRpbmctcmlnaHQ6MWVtfS54bC1hY3Rpb25zLW9wdGlvbjpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjA1KX0ueGwtYWN0aW9ucy1vcHRpb24ueGwtdGhlbWUtZGFyazpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjA1KX0ueGwtZGV0YWlsc3tvcGFjaXR5OjE7ZGlzcGxheTpibG9jaztmb250LXNpemU6aW5oZXJpdDtwb3NpdGlvbjpmaXhlZDt6LWluZGV4Ojk5NDtwYWRkaW5nOi41ZW07bWFyZ2luOjA7Ym9yZGVyLXJhZGl1czouNWVtO3RleHQtYWxpZ246Y2VudGVyO3dpZHRoOjYwJTttaW4td2lkdGg6NjAwcHg7Ym94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnZpc2libGV9LnhsLWRldGFpbHMueGwtZGV0YWlscy1oaWRkZW57ZGlzcGxheTpub25lfS54bC1kZXRhaWxzLnhsLWRldGFpbHMtbGltaXRlZC1zaXplLC54bC1kZXRhaWxzLnhsLWRldGFpbHMtc2l6ZWR7b3ZlcmZsb3c6aGlkZGVuO3RleHQtYWxpZ246bGVmdH0ueGwtZGV0YWlscy54bC1kZXRhaWxzLWxpbWl0ZWQtc2l6ZXttYXgtaGVpZ2h0OjE2ZW19LnhsLWRldGFpbHMtdGh1bWJuYWlse2Zsb2F0OmxlZnQ7bWFyZ2luLXJpZ2h0Oi42MjVlbTt3aWR0aDoxNDBweDtoZWlnaHQ6MjAwcHg7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4wMzEyNSk7YmFja2dyb3VuZC1yZXBlYXQ6bm8tcmVwZWF0O2JhY2tncm91bmQtc2l6ZTpjb250YWluO2JhY2tncm91bmQtcG9zaXRpb246Y2VudGVyIGNlbnRlcn0ueGwtZGV0YWlscy10aHVtYm5haWwueGwtZGV0YWlscy10aHVtYm5haWwtZnVsbHtiYWNrZ3JvdW5kLXNpemU6Y292ZXI7YmFja2dyb3VuZC1wb3NpdGlvbjoyNSUgMH0ueGwtZGV0YWlscy10aHVtYm5haWwueGwtdGhlbWUtZGFya3tiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjAzMTI1KX0ueGwtZGV0YWlscy1wYWdlLXRodW1ibmFpbHtkaXNwbGF5Om5vbmU7dmlzaWJpbGl0eTpoaWRkZW47cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZC1jb2xvcjojZmZmO3RleHQtYWxpZ246Y2VudGVyO3doaXRlLXNwYWNlOm5vd3JhcDt0cmFuc2Zvcm0tb3JpZ2luOjEwMCUgNTAlOy1tb3otdHJhbnNmb3JtLW9yaWdpbjoxMDAlIDUwJTstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46MTAwJSA1MCU7dHJhbnNmb3JtOnJvdGF0ZVkoMzVkZWcpIHRyYW5zbGF0ZSgxZW0sMCk7LW1vei10cmFuc2Zvcm06cm90YXRlWSgzNWRlZykgdHJhbnNsYXRlKDFlbSwwKTstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGVZKDM1ZGVnKSB0cmFuc2xhdGUoMWVtLDApO2JhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuOy1tb3otYmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47LXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjtvdmVyZmxvdzpoaWRkZW47dHJhbnNpdGlvbjp0cmFuc2Zvcm0gLjI1cyBlYXNlLW91dCAwcyxvcGFjaXR5IC4yNXMgZWFzZS1vdXQgMHM7LW1vei10cmFuc2l0aW9uOi1tb3otdHJhbnNmb3JtIC4yNXMgZWFzZS1vdXQgMHMsb3BhY2l0eSAuMjVzIGVhc2Utb3V0IDBzOy13ZWJraXQtdHJhbnNpdGlvbjotd2Via2l0LXRyYW5zZm9ybSAuMjVzIGVhc2Utb3V0IDBzLG9wYWNpdHkgLjI1cyBlYXNlLW91dCAwczt0cmFuc2Zvcm0tc3R5bGU6cHJlc2VydmUtM2Q7LW1vei10cmFuc2Zvcm0tc3R5bGU6cHJlc2VydmUtM2Q7LXdlYmtpdC10cmFuc2Zvcm0tc3R5bGU6cHJlc2VydmUtM2R9LnhsLWRldGFpbHMtcGFnZS10aHVtYm5haWwtc2l6ZXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3RyYW5zZm9ybS1vcmlnaW46NTAlIDUwJX0ueGwtZGV0YWlscy1wYWdlLXRodW1ibmFpbC1pbWFnZXt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtiYWNrZ3JvdW5kLXNpemU6Y29udGFpbjtiYWNrZ3JvdW5kLXBvc2l0aW9uOmNlbnRlciBjZW50ZXJ9LnhsLWRldGFpbHMueGwtZGV0YWlscy1oYXMtdGh1bWJuYWlsPi54bC1kZXRhaWxzLXRodW1ibmFpbHttYXJnaW4tcmlnaHQ6MWVtfS54bC1kZXRhaWxzLnhsLWRldGFpbHMtaGFzLXRodW1ibmFpbC54bC1kZXRhaWxzLWhhcy10aHVtYm5haWwtdmlzaWJsZT4ueGwtZGV0YWlscy10aHVtYm5haWx7cGVyc3BlY3RpdmU6NTAwcHg7LW1vei1wZXJzcGVjdGl2ZTo1MDBweDstd2Via2l0LXBlcnNwZWN0aXZlOjUwMHB4O3BlcnNwZWN0aXZlLW9yaWdpbjoxMDAlIDUwJTstbW96LXBlcnNwZWN0aXZlLW9yaWdpbjoxMDAlIDUwJTstd2Via2l0LXBlcnNwZWN0aXZlLW9yaWdpbjoxMDAlIDUwJX0ueGwtZGV0YWlscy54bC1kZXRhaWxzLWhhcy10aHVtYm5haWw+LnhsLWRldGFpbHMtdGh1bWJuYWlsPi54bC1kZXRhaWxzLXBhZ2UtdGh1bWJuYWlse2Rpc3BsYXk6YmxvY2t9LnhsLWRldGFpbHMueGwtZGV0YWlscy1oYXMtdGh1bWJuYWlsLnhsLWRldGFpbHMtaGFzLXRodW1ibmFpbC12aXNpYmxlPi54bC1kZXRhaWxzLXRodW1ibmFpbD4ueGwtZGV0YWlscy1wYWdlLXRodW1ibmFpbHt2aXNpYmlsaXR5OnZpc2libGU7b3BhY2l0eToxfS54bC1kZXRhaWxzLnhsLWRldGFpbHMtaGFzLXRodW1ibmFpbDpub3QoLnhsLWRldGFpbHMtaGFzLXRodW1ibmFpbC12aXNpYmxlKT4ueGwtZGV0YWlscy10aHVtYm5haWw+LnhsLWRldGFpbHMtcGFnZS10aHVtYm5haWx7dHJhbnNmb3JtOm5vbmU7LW1vei10cmFuc2Zvcm06bm9uZTstd2Via2l0LXRyYW5zZm9ybTpub25lO29wYWNpdHk6MH0ueGwtZGV0YWlscy1zaWRlLXBhbmVse2Zsb2F0OnJpZ2h0O21hcmdpbi1sZWZ0Oi41ZW07Zm9udC1zaXplOjEuMDYyNWVtIWltcG9ydGFudDtsaW5lLWhlaWdodDoxZW0haW1wb3J0YW50O3RleHQtYWxpZ246Y2VudGVyfS54bC1kZXRhaWxzLXNpZGUtYm94e3dpZHRoOjEwMCU7bWluLXdpZHRoOjZlbTtmb250LXNpemU6LjhlbTtwYWRkaW5nOi41ZW0gMDttYXJnaW46LjhlbSAwIC40ZW07Ym9yZGVyLXJhZGl1czouNWVtO2JhY2tncm91bmQtY2xpcDpwYWRkaW5nLWJveDtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjEyNSk7Ym94LXNoYWRvdzowIDAgLjVlbSByZ2JhKDAsMCwwLC4xMjUpO3RleHQtc2hhZG93OjAgLjFlbSAwIHJnYmEoMjU1LDI1NSwyNTUsLjUpfS54bC1kZXRhaWxzLXNpZGUtYm94PmRpdnt3aGl0ZS1zcGFjZTpub3dyYXB9LnhsLWRldGFpbHMtc2lkZS1ib3gueGwtdGhlbWUtZGFya3tiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjEyNSk7Ym94LXNoYWRvdzowIDAgLjVlbSByZ2JhKDI1NSwyNTUsMjU1LC4xMjUpO3RleHQtc2hhZG93OjAgLjFlbSAwIHJnYmEoMCwwLDAsLjUpfS54bC1kZXRhaWxzLXNpZGUtYm94LWVycm9ye2NvbG9yOiNlMDAwMDB9LnhsLWRldGFpbHMtc2lkZS1ib3gtZXJyb3IueGwtdGhlbWUtZGFya3tjb2xvcjojZmYxZjFmfS54bC1kZXRhaWxzLXRpdGxlLWNvbnRhaW5lcnttYXJnaW4tYm90dG9tOjFlbX0ueGwtZGV0YWlscy10aXRsZXtmb250LXNpemU6MS41ZW07Zm9udC13ZWlnaHQ6NzAwO3RleHQtc2hhZG93Oi4xZW0gLjFlbSAuNGVtIHJnYmEoMCwwLDAsLjE1KTt0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnR9LnhsLWRldGFpbHMtdGl0bGUtanB7bWFyZ2luLXRvcDouMjVlbTtvcGFjaXR5Oi41O2ZvbnQtc2l6ZToxLjFlbX0ueGwtZGV0YWlscy1yYXRpbmd7d2hpdGUtc3BhY2U6bm93cmFwO3RleHQtYWxpZ246Y2VudGVyO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZX0ueGwtZGV0YWlscy1yYXRpbmctdGV4dHtvcGFjaXR5Oi42NTtmb250LXNpemU6Ljk1ZW19LnhsLWRldGFpbHMtZmlsZS1zaXple29wYWNpdHk6LjY1O2ZvbnQtc2l6ZTouOTVlbX0ueGwtZGV0YWlscy11cGxvYWQtaW5mb3tmb250LXNpemU6MWVtO21hcmdpbi1ib3R0b206MWVtfS54bC1kZXRhaWxzLXVwbG9hZC1pbmZvLWlubmVye2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOmJhc2VsaW5lfS54bC1kZXRhaWxzLXVwbG9hZGVye2ZvbnQtc2l6ZToxZW0haW1wb3J0YW50O21hcmdpbjowIC42MjVlbX0ueGwtZGV0YWlscy11cGxvYWQtZGF0ZXtmb250LXNpemU6MWVtIWltcG9ydGFudDttYXJnaW4tbGVmdDouNjI1ZW19LnhsLWRldGFpbHMtZmF2b3JpdGUtaW5mby54bC1kZXRhaWxzLWZhdm9yaXRlLWluZm8taGlkZGVue2Rpc3BsYXk6bm9uZX0ueGwtZGV0YWlscy1mYXZvcml0ZS1pbmZve2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmctcmlnaHQ6MWVtO3ZlcnRpY2FsLWFsaWduOmJhc2VsaW5lfS54bC1kZXRhaWxzLWZhdm9yaXRlLWNhdGVnb3J5e3BhZGRpbmc6LjI1ZW0gLjVlbTtkaXNwbGF5OmlubGluZS1ibG9jaztmb250LXNpemU6Ljg3NWVtO2ZvbnQtd2VpZ2h0OjQwMDstZm9udC1mYW1pbHk6aW5oZXJpdDtsaW5lLWhlaWdodDoxLjEyNWVtO3dpZHRoOmF1dG99LnhsLWRldGFpbHMtZmF2b3JpdGUtbGFiZWx7Zm9udC13ZWlnaHQ6NzAwO21hcmdpbi1yaWdodDouMzc1ZW07ZGlzcGxheTpub25lfS54bC1kZXRhaWxzLXRhZy1ibG9ja3tmb250LXNpemU6MS4wNzVlbTtkaXNwbGF5OmlubGluZTtsaW5lLWhlaWdodDoxLjRlbX0ueGwtZGV0YWlscy10YWctYmxvY2stbGFiZWx7bWFyZ2luLXJpZ2h0Oi4yNWVtfS54bC1kZXRhaWxzLXRhZy1ibG9jay54bC1kZXRhaWxzLXRhZy1ibG9jay1tdWx0aWxpbmV7ZGlzcGxheTpibG9jazt0ZXh0LWFsaWduOmxlZnQ7b3ZlcmZsb3c6aGlkZGVufS54bC1kZXRhaWxzLXRhZy1ibG9jay54bC1kZXRhaWxzLXRhZy1ibG9jay1tdWx0aWxpbmU+LnhsLWRldGFpbHMtdGFnLWJsb2NrLWxhYmVse2Rpc3BsYXk6bm9uZX0ueGwtZGV0YWlscy1jbGVhcntjbGVhcjpib3RofTpyb290LnhsLWRldGFpbHMtdmlzaWJsZSAjaWhvdmVye2Rpc3BsYXk6bm9uZSFpbXBvcnRhbnQ7dmlzaWJpbGl0eTpoaWRkZW4haW1wb3J0YW50O29wYWNpdHk6MCFpbXBvcnRhbnR9LnhsLXRhZy1ibG9ja3tkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW46MCAuMTI1ZW19LnhsLXRhZ3t0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnQ7cG9zaXRpb246cmVsYXRpdmU7d2hpdGUtc3BhY2U6bm9icmVha30ueGwtdGFnLnhsLXRhZy1jb2xvci1pbmhlcml0e2NvbG9yOmluaGVyaXQhaW1wb3J0YW50fS54bC10YWctYmxvY2sueGwtdGFnLWJsb2NrLWxhc3Qtb2YtbmFtZXNwYWNle21hcmdpbi1yaWdodDouNWVtfS54bC10YWctYmxvY2sueGwtdGFnLWJsb2NrLWxhc3R7bWFyZ2luLXJpZ2h0OjB9LnhsLXRhZy1uYW1lc3BhY2V7ZGlzcGxheTppbmxpbmV9LnhsLWRldGFpbHMtdGFnLWJsb2NrLnhsLWRldGFpbHMtdGFnLWJsb2NrLW11bHRpbGluZT4ueGwtZGV0YWlscy10YWdzPi54bC10YWctbmFtZXNwYWNle2Rpc3BsYXk6YmxvY2s7bWFyZ2luLWxlZnQ6MWVtO3RleHQtaW5kZW50Oi0xZW19LnhsLWRldGFpbHMtdGFnLWJsb2NrLnhsLWRldGFpbHMtdGFnLWJsb2NrLW11bHRpbGluZT4ueGwtZGV0YWlscy10YWdzPi54bC10YWctbmFtZXNwYWNlPip7dGV4dC1pbmRlbnQ6MH0ueGwtZGV0YWlscy10YWctYmxvY2sueGwtZGV0YWlscy10YWctYmxvY2stbXVsdGlsaW5lPi54bC1kZXRhaWxzLXRhZ3M+LnhsLXRhZy1uYW1lc3BhY2UrLnhsLXRhZy1uYW1lc3BhY2V7bWFyZ2luLXRvcDouMWVtfS54bC10YWctbmFtZXNwYWNlLWZpcnN0LXRhZ3tkaXNwbGF5OmlubGluZS1ibG9ja30ueGwtdGFnLW5hbWVzcGFjZS1maXJzdC10YWc+LnhsLXRhZy1ibG9ja3tkaXNwbGF5OmlubGluZX0ueGwtdGFnLW5hbWVzcGFjZS1ibG9ja3tkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW46MCAuMTI1ZW19LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7ZGlzcGxheTppbmxpbmUtYmxvY2s7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDAsMCwwLC40KTtib3JkZXItcmFkaXVzOi4yNWVtO3BhZGRpbmc6MCAuMjVlbTtsaW5lLWhlaWdodDpub3JtYWx9LnhsLXRhZy1uYW1lc3BhY2UtYmxvY2sueGwtdGFnLW5hbWVzcGFjZS1ibG9jay1uby1vdXRsaW5lPi54bC10YWctbmFtZXNwYWNlLWxhYmVse2JvcmRlci1zdHlsZTpub25lfS54bC10YWctbmFtZXNwYWNlLWJsb2NrLnhsLXRoZW1lLWRhcms+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Ym9yZGVyLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjQpfS54bC10YWctbmFtZXNwYWNlLWJsb2NrLnhsLXRhZy1uYW1lc3BhY2UtbGFuZ3VhZ2U+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6IzY3MjFjNn0ueGwtdGFnLW5hbWVzcGFjZS1ibG9jay54bC10YWctbmFtZXNwYWNlLWdyb3VwPi54bC10YWctbmFtZXNwYWNlLWxhYmVse2NvbG9yOiM5Zjg2MzZ9LnhsLXRhZy1uYW1lc3BhY2UtYmxvY2sueGwtdGFnLW5hbWVzcGFjZS1hcnRpc3Q+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6I2M0NzUyNX0ueGwtdGFnLW5hbWVzcGFjZS1ibG9jay54bC10YWctbmFtZXNwYWNlLXBhcm9keT4ueGwtdGFnLW5hbWVzcGFjZS1sYWJlbHtjb2xvcjojMGVhNzllfS54bC10YWctbmFtZXNwYWNlLWJsb2NrLnhsLXRhZy1uYW1lc3BhY2UtY2hhcmFjdGVyPi54bC10YWctbmFtZXNwYWNlLWxhYmVse2NvbG9yOiMyODgwMjh9LnhsLXRhZy1uYW1lc3BhY2UtYmxvY2sueGwtdGFnLW5hbWVzcGFjZS1tYWxlPi54bC10YWctbmFtZXNwYWNlLWxhYmVse2NvbG9yOiMwNjU5YWV9LnhsLXRhZy1uYW1lc3BhY2UtYmxvY2sueGwtdGFnLW5hbWVzcGFjZS1mZW1hbGU+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6I2UwMzM4ZH0ueGwtdGFnLW5hbWVzcGFjZS1ibG9jay54bC10YWctbmFtZXNwYWNlLWxhbmd1YWdlLnhsLXRoZW1lLWRhcms+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6Izg5NWNjNn0ueGwtdGFnLW5hbWVzcGFjZS1ibG9jay54bC10YWctbmFtZXNwYWNlLWdyb3VwLnhsLXRoZW1lLWRhcms+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6I2U4YzQ0Zn0ueGwtdGFnLW5hbWVzcGFjZS1ibG9jay54bC10YWctbmFtZXNwYWNlLWFydGlzdC54bC10aGVtZS1kYXJrPi54bC10YWctbmFtZXNwYWNlLWxhYmVse2NvbG9yOiNlODljNGZ9LnhsLXRhZy1uYW1lc3BhY2UtYmxvY2sueGwtdGFnLW5hbWVzcGFjZS1wYXJvZHkueGwtdGhlbWUtZGFyaz4ueGwtdGFnLW5hbWVzcGFjZS1sYWJlbHtjb2xvcjojMjFlZGEyfS54bC10YWctbmFtZXNwYWNlLWJsb2NrLnhsLXRhZy1uYW1lc3BhY2UtY2hhcmFjdGVyLnhsLXRoZW1lLWRhcms+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6IzZjZTc2OX0ueGwtdGFnLW5hbWVzcGFjZS1ibG9jay54bC10YWctbmFtZXNwYWNlLW1hbGUueGwtdGhlbWUtZGFyaz4ueGwtdGFnLW5hbWVzcGFjZS1sYWJlbHtjb2xvcjojMjNhZGQwfS54bC10YWctbmFtZXNwYWNlLWJsb2NrLnhsLXRhZy1uYW1lc3BhY2UtZmVtYWxlLnhsLXRoZW1lLWRhcms+LnhsLXRhZy1uYW1lc3BhY2UtbGFiZWx7Y29sb3I6I2U4OWNjNH0ueGwtYWN0aW9ucy11cGxvYWRlci54bC1maWx0ZXItZ29vZCwueGwtZGV0YWlscy11cGxvYWRlci54bC1maWx0ZXItZ29vZCwueGwtbGluay54bC1maWx0ZXItZ29vZCwueGwtc2l0ZS10YWcueGwtZmlsdGVyLWdvb2QsLnhsLXRhZy54bC1maWx0ZXItZ29vZHtmb250LXdlaWdodDo3MDB9LnhsLWZpbHRlci10ZXh0e2Rpc3BsYXk6aW5saW5lfS54bC1zaXRlLXRhZ3tjdXJzb3I6cG9pbnRlcjt3aGl0ZS1zcGFjZTpub3dyYXA7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luLXJpZ2h0Oi4yNWVtO3Bvc2l0aW9uOnJlbGF0aXZlO3RleHQtZGVjb3JhdGlvbjpub25lIWltcG9ydGFudDtvdXRsaW5lOjAhaW1wb3J0YW50fS54bC1zaXRlLXRhZy1iZywueGwtc2l0ZS10YWctYmctc2hhZG93e2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0uMjVlbTt0b3A6LS4yNWVtO2JvdHRvbTotLjI1ZW07cmlnaHQ6LS4yNWVtO2JvcmRlci1yYWRpdXM6LjI1ZW07cG9pbnRlci1ldmVudHM6bm9uZX0ueGwtc2l0ZS10YWcueGwtc2l0ZS10YWctYWN0aXZlPi54bC1zaXRlLXRhZy1iZy1zaGFkb3d7ei1pbmRleDo0fS54bC1zaXRlLXRhZy54bC1zaXRlLXRhZy1hY3RpdmU+LnhsLXNpdGUtdGFnLWJnPi54bC1zaXRlLXRhZy1iZy1pbm5lciwueGwtc2l0ZS10YWcueGwtc2l0ZS10YWctYWN0aXZlPi54bC1zaXRlLXRhZy1pY29uLC54bC1zaXRlLXRhZy54bC1zaXRlLXRhZy1hY3RpdmU+LnhsLXNpdGUtdGFnLXRleHR7ei1pbmRleDo2fS54bC1zaXRlLXRhZy54bC1zaXRlLXRhZy1hY3RpdmU+LnhsLXNpdGUtdGFnLWJnLC54bC1zaXRlLXRhZy54bC1zaXRlLXRhZy1hY3RpdmU+LnhsLXNpdGUtdGFnLWJnLXNoYWRvd3tkaXNwbGF5OmJsb2NrfS54bC1zaXRlLXRhZy1iZy1pbm5lciwueGwtc2l0ZS10YWctYmctaW5uZXI6YWZ0ZXJ7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOjA7Ym90dG9tOjA7cmlnaHQ6MDtib3JkZXItcmFkaXVzOi4yNWVtfS54bC1zaXRlLXRhZy1iZy1pbm5lcjphZnRlcntjb250ZW50OlwiXCI7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4wNSl9LnhsLXNpdGUtdGFnLWJnLWlubmVyLnhsLXRoZW1lLWRhcms6YWZ0ZXJ7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4wNSl9LnhsLXNpdGUtdGFnW2RhdGEteGwtYWN0aW9ucy12cG9zPWFib3ZlXT4ueGwtc2l0ZS10YWctYmcsLnhsLXNpdGUtdGFnW2RhdGEteGwtYWN0aW9ucy12cG9zPWFib3ZlXT4ueGwtc2l0ZS10YWctYmctc2hhZG93LC54bC1zaXRlLXRhZ1tkYXRhLXhsLWFjdGlvbnMtdnBvcz1hYm92ZV0+LnhsLXNpdGUtdGFnLWJnPi54bC1zaXRlLXRhZy1iZy1pbm5lciwueGwtc2l0ZS10YWdbZGF0YS14bC1hY3Rpb25zLXZwb3M9YWJvdmVdPi54bC1zaXRlLXRhZy1iZz4ueGwtc2l0ZS10YWctYmctaW5uZXI6YWZ0ZXJ7Ym9yZGVyLXRvcC1sZWZ0LXJhZGl1czowO2JvcmRlci10b3AtcmlnaHQtcmFkaXVzOjB9LnhsLXNpdGUtdGFnW2RhdGEteGwtYWN0aW9ucy12cG9zPWJlbG93XT4ueGwtc2l0ZS10YWctYmcsLnhsLXNpdGUtdGFnW2RhdGEteGwtYWN0aW9ucy12cG9zPWJlbG93XT4ueGwtc2l0ZS10YWctYmctc2hhZG93LC54bC1zaXRlLXRhZ1tkYXRhLXhsLWFjdGlvbnMtdnBvcz1iZWxvd10+LnhsLXNpdGUtdGFnLWJnPi54bC1zaXRlLXRhZy1iZy1pbm5lciwueGwtc2l0ZS10YWdbZGF0YS14bC1hY3Rpb25zLXZwb3M9YmVsb3ddPi54bC1zaXRlLXRhZy1iZz4ueGwtc2l0ZS10YWctYmctaW5uZXI6YWZ0ZXJ7Ym9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjB9LnhsLXNpdGUtdGFnLXRleHR7cG9zaXRpb246cmVsYXRpdmV9LnhsLXNpdGUtdGFnLWljb257ZGlzcGxheTppbmxpbmUtYmxvY2s7dmVydGljYWwtYWxpZ246Ym90dG9tO3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjEuNWVtO2hlaWdodDoxLjI1ZW07dGV4dC1hbGlnbjpyaWdodDtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O2JhY2tncm91bmQtcmVwZWF0Om5vLXJlcGVhdDtiYWNrZ3JvdW5kLXNpemU6Y29udGFpbjtiYWNrZ3JvdW5kLXBvc2l0aW9uOjUwJSA1MCV9LnhsLXNpdGUtdGFnLWljb24rLnhsLXNpdGUtdGFnLXRleHR7ZGlzcGxheTppbmxpbmUtYmxvY2s7b3BhY2l0eTowO2NvbG9yOnRyYW5zcGFyZW50O3dpZHRoOjA7aGVpZ2h0OjA7b3ZlcmZsb3c6aGlkZGVufS5zcG9pbGVyOm5vdCg6aG92ZXIpIC54bC1zaXRlLXRhZzpub3QoLnhsLXNpdGUtdGFnLWFjdGl2ZSk+LnhsLXNpdGUtdGFnLWljb24sLnNwb2lsZXJzOm5vdCg6aG92ZXIpIC54bC1zaXRlLXRhZzpub3QoLnhsLXNpdGUtdGFnLWFjdGl2ZSk+LnhsLXNpdGUtdGFnLWljb24sczpub3QoOmhvdmVyKSAueGwtc2l0ZS10YWc6bm90KC54bC1zaXRlLXRhZy1hY3RpdmUpPi54bC1zaXRlLXRhZy1pY29ue29wYWNpdHk6MH0ueGwtbGluay54bC1saW5rLWZvcm1hdHRlZHt0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnR9LnhsLWxpbmsueGwtbGluay1lcnJvcntmb250LXN0eWxlOml0YWxpY30ueGwtbGluay1lcnJvci1tZXNzYWdle29wYWNpdHk6Ljc1fS54bC1saW5rLXBhZ2V7Zm9udC13ZWlnaHQ6NDAwO2ZvbnQtc3R5bGU6aXRhbGljO3doaXRlLXNwYWNlOm5vd3JhcH0ueGwtbGluay1leHRyYXtmb250LXdlaWdodDo0MDA7Zm9udC1zdHlsZTppdGFsaWN9LnhsLWxpbmstdXJsLXRleHR7ZGlzcGxheTpub25lIWltcG9ydGFudH0ueGwtc2l0ZS10YWcueGwtZmlsdGVyLWdvb2Q+LnhsLXNpdGUtdGFnLWljb246YWZ0ZXJ7Y29udGVudDpcIlwiO2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7cmlnaHQ6LS4yNWVtO3RvcDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDtiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7YmFja2dyb3VuZC1zaXplOmNvbnRhaW47YmFja2dyb3VuZC1wb3NpdGlvbjoxMDAlIDUwJTtiYWNrZ3JvdW5kLWltYWdlOnVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJJQUFBQWdDQVlBQUFBZmZDanhBQUFBaGtsRVFWUjQydTJUb1FxQVFBeUdmVldERnBQSlpMT1pMRnBNWi9ETlZ2Y0k1OEtCd3VCK2gySnhQM3hsc0k4ZmRsZDRQTDlKdkFMbldJS0JFdG81VW1DMVNJUE1lNGF5VTdJSnF6Q3prbEFudEh4REZKSmtFU1poWkNXaEJvdFNrN3lFYWl5Q1RhZ1NTaUJLWkpvb0Nid2NhR0o3UzRZbVdBYWFHR1NLTi8vZE01bkg4MEVPcDJzaGdobUVoZFlBQUFBQVNVVk9SSzVDWUlJPSl9LnhsLXNpdGUtdGFnLWljb25bZGF0YS14bC1zaXRlLXRhZy1pY29uPWVoZW50YWlde2JhY2tncm91bmQtaW1hZ2U6dXJsKGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ0FBQUFBZ0NBWUFBQUJ6ZW5yMEFBQUFWMGxFUVZSNEFXTVlCV2xzZ3YvSndaVHBSK0RCNDRESER5NFNnM0U1QUtjNkhQS0Qzd0dqRHNDVmFFYWdBeGh3Z0pIaUFNSjQyRG9BbHdaODR2andJSGJBcUFOR2M4Rm9TVGhhRzQ2MmlFWWRNTm96R3ZFQUFCL0g5ZXJyVEV5RkFBQUFBRWxGVGtTdVFtQ0MpfS54bC1zaXRlLXRhZy1pY29uW2RhdGEteGwtc2l0ZS10YWctaWNvbj1leGhlbnRhaV17YmFja2dyb3VuZC1pbWFnZTp1cmwoZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDQUFBQUFnQWdNQUFBQU9GSkpuQUFBQUNWQk1WRVVBQUFBME5Udmo0TkZXYlp0NkFBQUFBWFJTVGxNQVFPYllaZ0FBQUVoSlJFRlVlRjZGeTZFUndBQUlROUVZOXNQRXNGOU1wdXloU2tIMHF5Y1MzRWptRjJYL1F6d0FOaGhFY01BS1oybEJubER2bkJOQVdKaGc5bWJBWnQ4WHNnYllJZmppOUFBUmkwdWhYVStMU1FBQUFBQkpSVTVFcmtKZ2dnPT0pfS54bC1zaXRlLXRhZy1pY29uW2RhdGEteGwtc2l0ZS10YWctaWNvbj1uaGVudGFpXXtiYWNrZ3JvdW5kLWltYWdlOnVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNBQUFBQWdCQU1BQUFDQlZHZkhBQUFBRDFCTVZFVUFBQUFxTjBUc0tGVC8vLzlFS2pERWgxakFBQUFBQVhSU1RsTUFRT2JZWmdBQUFFbEpSRUZVZUY2MXlvRUZBREVVQk5IZndtOGhMVndMMjM5Tmx5R0lZNGh3QSt5enRaVlpLVERITEE1TXRvRWZQdUpBWVY5Q1U3TVZIdXBCY1VDU2xBSFdMQWV3L29XVndFRXZkdndraDhzWWo3NEFBQUFBU1VWT1JLNUNZSUk9KX0ueGwtc2l0ZS10YWctaWNvbltkYXRhLXhsLXNpdGUtdGFnLWljb249aGl0b21pXXtiYWNrZ3JvdW5kLWltYWdlOnVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNBQUFBQWdCQU1BQUFDQlZHZkhBQUFBRDFCTVZFVUFBQUQvLy84cE1UNCtLaW5VZVhLL1Q1WE5BQUFBQVhSU1RsTUFRT2JZWmdBQUFFZEpSRUZVZUFIRjBUY0J3REFVeFVCVEVJVkhRUlErZjBycG85c1d1ZC9xdGxQdXZtTUFRTjVqRG9yT3dLcDdqaUhXM1JoZ0RiZG9td0ZLeHBBcm1NSjkvQTN6bjF0M0F1ckdKcWVCRndDckFBQUFBRWxGVGtTdVFtQ0MpfS54bC1uYXYtZXh0cmFzLW1vYmlsZXt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW46LjVlbSAwfS54bC1uYXYtbGlua3tjdXJzb3I6cG9pbnRlcn0ueGwtaG92ZXItc2hhZG93e2JveC1zaGFkb3c6MCAwIC4xMjVlbSAwIHJnYmEoMCwwLDAsLjUpfS54bC1ob3Zlci1zaGFkb3cueGwtdGhlbWUtZGFya3tib3gtc2hhZG93OjAgMCAuMTI1ZW0gMCByZ2JhKDI1NSwyNTUsMjU1LC41KX06cm9vdC54bC1wb3B1cC1vdmVybGF5aW5nLDpyb290LnhsLXBvcHVwLW92ZXJsYXlpbmcgYm9keXtvdmVyZmxvdy14OmhpZGRlbiFpbXBvcnRhbnQ7b3ZlcmZsb3cteTpoaWRkZW4haW1wb3J0YW50fS54bC1wb3B1cC1vdmVybGF5e3Bvc2l0aW9uOmZpeGVkO2xlZnQ6MDt0b3A6MDtyaWdodDowO2JvdHRvbTowO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuNSk7ei1pbmRleDo0MDA7b3ZlcmZsb3cteDphdXRvO292ZXJmbG93LXk6c2Nyb2xsfS54bC1wb3B1cC1vdmVybGF5LnhsLXRoZW1lLWRhcmt7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC41KX0ueGwtcG9wdXAtYWxpZ25lcntwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOjA7cmlnaHQ6MDtib3R0b206MDt3aGl0ZS1zcGFjZTpub3dyYXA7bGluZS1oZWlnaHQ6MDt0ZXh0LWFsaWduOmNlbnRlcn0ueGwtcG9wdXAtYWxpZ25lcjpiZWZvcmV7Y29udGVudDpcIlwiO2Rpc3BsYXk6YmxvY2s7d2lkdGg6MDtoZWlnaHQ6MTAwJTtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGV9LnhsLXBvcHVwLWFsaWdue2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTt3aGl0ZS1zcGFjZTpub3JtYWw7bGluZS1oZWlnaHQ6bm9ybWFsO3RleHQtYWxpZ246bGVmdDtwYWRkaW5nOjFlbTttYXJnaW46MDt3aWR0aDo4MDBweDttaW4td2lkdGg6NjAlO21heC13aWR0aDoxMDAlO2JveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveH0ueGwtcG9wdXAtY29udGVudHtwb3NpdGlvbjpyZWxhdGl2ZTtkaXNwbGF5OmJsb2NrO3BhZGRpbmc6MWVtO21hcmdpbjowO3dpZHRoOjEwMCU7Ym9yZGVyOm5vbmU7Ym94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlci1yYWRpdXM6LjVlbTtvdmVyZmxvdzp2aXNpYmxlfS54bC1wb3B1cC10YWJsZXtkaXNwbGF5OnRhYmxlO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCV9LnhsLXBvcHVwLXJvd3tkaXNwbGF5OnRhYmxlLXJvdzt3aWR0aDoxMDAlO2hlaWdodDowfS54bC1wb3B1cC1yb3cueGwtcG9wdXAtcm93LWJvZHksLnhsLXBvcHVwLXJvdy54bC1wb3B1cC1yb3ctYm9keT4ueGwtcG9wdXAtY2VsbHtoZWlnaHQ6MTAwJX0ueGwtcG9wdXAtY2VsbHtkaXNwbGF5OnRhYmxlLWNlbGw7d2lkdGg6MTAwJTtoZWlnaHQ6MDt2ZXJ0aWNhbC1hbGlnbjp0b3A7dGV4dC1hbGlnbjpsZWZ0fS54bC1wb3B1cC1jZWxsLnhsLXBvcHVwLWNlbGwtc21hbGx7d2lkdGg6MDt3aGl0ZS1zcGFjZTpub3dyYXB9LnhsLXBvcHVwLWNlbGwueGwtcG9wdXAtY2VsbC1jZW50ZXJ7dGV4dC1hbGlnbjpjZW50ZXJ9LnhsLXBvcHVwLWNlbGwueGwtcG9wdXAtY2VsbC1yaWdodHt0ZXh0LWFsaWduOnJpZ2h0fS54bC1wb3B1cC1jZWxsLnhsLXBvcHVwLWNlbGwtbWlkZGxle3ZlcnRpY2FsLWFsaWduOm1pZGRsZX0ueGwtcG9wdXAtY2VsbC54bC1wb3B1cC1jZWxsLWJvdHRvbXt2ZXJ0aWNhbC1hbGlnbjpib3R0b219LnhsLXBvcHVwLWNlbGwtc2l6ZXtwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfS54bC1wb3B1cC1jZWxsLXNpemUtc2Nyb2xse3Bvc2l0aW9uOmFic29sdXRlO2xlZnQ6MDt0b3A6MDtyaWdodDowO2JvdHRvbTowO292ZXJmbG93OmF1dG99LnhsLXBvcHVwLWNlbGwtc2l6ZS1wYWRkaW5ne3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmc6LjM3NWVtO3dpZHRoOjEwMCU7bWluLWhlaWdodDoxMDAlO2JveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveH0ueGwtc2V0dGluZ3MtcG9wdXAtYWxpZ257bWluLWhlaWdodDo4MCU7aGVpZ2h0OjIwMHB4fS54bC1zZXR0aW5ncy1wb3B1cC1jb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDoxMDAlfS54bC1zZXR0aW5ncy1idXR0b257bWFyZ2luOjAgLjI1ZW07ZGlzcGxheTppbmxpbmUtYmxvY2shaW1wb3J0YW50O3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtwYWRkaW5nOi4yNWVtO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMDUpO2JvcmRlci1yYWRpdXM6LjJlbTt0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnQ7Y3Vyc29yOnBvaW50ZXI7Zm9udC1zaXplOmluaGVyaXQhaW1wb3J0YW50O2xpbmUtaGVpZ2h0Om5vcm1hbCFpbXBvcnRhbnQ7d2hpdGUtc3BhY2U6bm93cmFwIWltcG9ydGFudH0ueGwtc2V0dGluZ3MtYnV0dG9uLnhsLXRoZW1lLWRhcmt7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LC4wNSl9LnhsLXNldHRpbmdzLWJ1dHRvbi1jaGVja2JveCwueGwtc2V0dGluZ3MtYnV0dG9uLWNoZWNrYm94Ky5yaWNlQ2hlY2t7bWFyZ2luOjAhaW1wb3J0YW50O3BhZGRpbmc6MCFpbXBvcnRhbnQ7dmVydGljYWwtYWxpZ246bWlkZGxlfS54bC1zZXR0aW5ncy1idXR0b24tY2hlY2tib3gtdGV4dHtkaXNwbGF5Om5vbmV9LnhsLXNldHRpbmdzLWJ1dHRvbi1jaGVja2JveDpjaGVja2Vkfi54bC1zZXR0aW5ncy1idXR0b24tY2hlY2tib3gtdGV4dDpudGgtb2YtdHlwZSgxKSwueGwtc2V0dGluZ3MtYnV0dG9uLWNoZWNrYm94Om5vdCg6Y2hlY2tlZCl+LnhsLXNldHRpbmdzLWJ1dHRvbi1jaGVja2JveC10ZXh0Om50aC1vZi10eXBlKDIpe2Rpc3BsYXk6aW5saW5lfS54bC1zZXR0aW5ncy10aXRsZXtmb250LXNpemU6MmVtIWltcG9ydGFudDtmb250LXdlaWdodDo3MDAhaW1wb3J0YW50O3RleHQtZGVjb3JhdGlvbjpub25lIWltcG9ydGFudH0ueGwtc2V0dGluZ3MtdmVyc2lvbnttYXJnaW46MCAuMjVlbTtvcGFjaXR5Oi45O3ZlcnRpY2FsLWFsaWduOjc1JTt0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnQ7Y29sb3I6aW5oZXJpdCFpbXBvcnRhbnR9LnhsLXNldHRpbmdzLXRpdGxlLWluZm8sLnhsLXNldHRpbmdzLXZlcnNpb24ueGwtc2V0dGluZ3MtdmVyc2lvbi1sYXJnZXttYXJnaW46MDtmb250LXNpemU6MS44ZW07dmVydGljYWwtYWxpZ246YmFzZWxpbmU7b3BhY2l0eToxfS54bC1zZXR0aW5ncy1oZWFkaW5ne2Rpc3BsYXk6dGFibGU7d2lkdGg6MTAwJTtwYWRkaW5nOi4yNWVtIDB9LnhsLXNldHRpbmdzLWhlYWRpbmc+ZGl2e2Rpc3BsYXk6dGFibGUtcm93O2hlaWdodDoxMDAlfS54bC1zZXR0aW5ncy1oZWFkaW5nLWNlbGx7ZGlzcGxheTp0YWJsZS1jZWxsO2hlaWdodDoxMDAlO3dpZHRoOjEwMCV9LnhsLXNldHRpbmdzLWhlYWRpbmctdGl0bGV7dmVydGljYWwtYWxpZ246dG9wO3RleHQtYWxpZ246bGVmdDtmb250LXNpemU6MS41ZW07Zm9udC13ZWlnaHQ6NzAwO2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7d2hpdGUtc3BhY2U6bm93cmFwO3dpZHRoOjB9LnhsLXNldHRpbmdzLWhlYWRpbmctc3VidGl0bGV7dmVydGljYWwtYWxpZ246Ym90dG9tO3RleHQtYWxpZ246cmlnaHQ7cGFkZGluZy1sZWZ0Oi41ZW07b3BhY2l0eTouNn0ueGwtc2V0dGluZ3MtZ3JvdXB7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDAsMCwwLC4yKTtib3JkZXItcmFkaXVzOi4yNWVtO3BhZGRpbmc6LjEyNWVtO2JveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveH0ueGwtc2V0dGluZ3MtZ3JvdXAueGwtdGhlbWUtZGFya3tib3JkZXItY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuMil9LnhsLXNldHRpbmdzLWdyb3VwKy54bC1zZXR0aW5ncy1oZWFkaW5ne21hcmdpbi10b3A6Ljc1ZW19LnhsLXNldHRpbmdzLWVudHJ5LXRhYmxle2Rpc3BsYXk6dGFibGU7d2lkdGg6MTAwJTtwYWRkaW5nOi4zNzVlbSAuMjVlbTtib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3h9LnhsLXNldHRpbmdzLWVudHJ5LXJvd3tkaXNwbGF5OnRhYmxlLXJvdztoZWlnaHQ6MTAwJX0ueGwtc2V0dGluZ3MtZW50cnktY2VsbHt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7dGV4dC1hbGlnbjpsZWZ0O2Rpc3BsYXk6dGFibGUtY2VsbDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfS54bC1zZXR0aW5ncy1lbnRyeS1jZWxsOmxhc3Qtb2YtdHlwZTpub3QoOmZpcnN0LW9mLXR5cGUpe3ZlcnRpY2FsLWFsaWduOm1pZGRsZTt0ZXh0LWFsaWduOnJpZ2h0O3dpZHRoOjB9LnhsLXNldHRpbmdzLWVudHJ5Ky54bC1zZXR0aW5ncy1lbnRyeXtib3JkZXItdG9wOi4xMjVlbSBzb2xpZCB0cmFuc3BhcmVudH0ueGwtc2V0dGluZ3MtZW50cnk6bnRoLWNoaWxkKGV2ZW4pPi54bC1zZXR0aW5ncy1lbnRyeS10YWJsZXtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjA1KX0ueGwtc2V0dGluZ3MtZW50cnk6bnRoLWNoaWxkKG9kZCk+LnhsLXNldHRpbmdzLWVudHJ5LXRhYmxle2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMDI1KX0ueGwtc2V0dGluZ3MtZW50cnkueGwtdGhlbWUtZGFyazpudGgtY2hpbGQoZXZlbik+LnhsLXNldHRpbmdzLWVudHJ5LXRhYmxle2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuMDUpfS54bC1zZXR0aW5ncy1lbnRyeS54bC10aGVtZS1kYXJrOm50aC1jaGlsZChvZGQpPi54bC1zZXR0aW5ncy1lbnRyeS10YWJsZXtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjAyNSl9aW5wdXQueGwtc2V0dGluZ3MtZW50cnktaW5wdXRbdHlwZT10ZXh0XXt3aWR0aDo4ZW19YnV0dG9uLnhsLXNldHRpbmdzLWVudHJ5LWlucHV0LGlucHV0LnhsLXNldHRpbmdzLWVudHJ5LWlucHV0W3R5cGU9dGV4dF0sc2VsZWN0LnhsLXNldHRpbmdzLWVudHJ5LWlucHV0e21pbi13aWR0aDo4ZW07Ym94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O3BhZGRpbmc6LjA2MjVlbSAuMTI1ZW0haW1wb3J0YW50O21hcmdpbjowIWltcG9ydGFudDtmb250LXNpemU6aW5oZXJpdCFpbXBvcnRhbnQ7Zm9udC1mYW1pbHk6aW5oZXJpdCFpbXBvcnRhbnQ7bGluZS1oZWlnaHQ6MS4zZW0haW1wb3J0YW50fXNlbGVjdC54bC1zZXR0aW5ncy1lbnRyeS1pbnB1dHt3aWR0aDphdXRvO2hlaWdodDphdXRvfWxhYmVsLnhsLXNldHRpbmdzLWVudHJ5LWxhYmVse2N1cnNvcjpwb2ludGVyO21hcmdpbi1ib3R0b206MH0ueGwtc2V0dGluZ3MtZmlsdGVyLWd1aWRlLXRvZ2dsZXtjdXJzb3I6cG9pbnRlcjt0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnR9LnhsLXNldHRpbmdzLWZpbHRlci1ndWlkZXttYXJnaW4tYm90dG9tOi4yNWVtO3BhZGRpbmc6LjM3NWVtfS54bC1zZXR0aW5ncy1maWx0ZXItZ3VpZGU6bm90KC54bC1zZXR0aW5ncy1maWx0ZXItZ3VpZGUtdmlzaWJsZSl7ZGlzcGxheTpub25lfS54bC1zZXR0aW5ncy1wb3B1cC1jb250ZW50IHVse3BhZGRpbmc6MDttYXJnaW46MWVtIDA7bGlzdC1zdHlsZS10eXBlOmRpc2MhaW1wb3J0YW50fS54bC1zZXR0aW5ncy1wb3B1cC1jb250ZW50IHVsPmxpe21hcmdpbjowIC41ZW0gMCAyZW19LnhsLXNldHRpbmdzLXBvcHVwLWNvbnRlbnQgdWw+bGkrbGl7bWFyZ2luLXRvcDoxZW19LnhsLXNldHRpbmdzLXBvcHVwLWNvbnRlbnQgdWw+bGkueGwtc2V0dGluZ3MtbGktbm8tc3BhY2V7bWFyZ2luLXRvcDowfS54bC1zZXR0aW5ncy1wb3B1cC1jb250ZW50IGNvZGV7Y29sb3I6IzAwMDtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7Zm9udC1mYW1pbHk6Q291cmllcixtb25vc3BhY2UhaW1wb3J0YW50fS54bC1zZXR0aW5ncy1wb3B1cC1jb250ZW50LnhsLXRoZW1lLWRhcmsgY29kZXtjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6IzAwMDtmb250LWZhbWlseTpDb3VyaWVyLG1vbm9zcGFjZSFpbXBvcnRhbnR9LnhsLXNldHRpbmdzLWNvbG9yLWlucHV0e3BhZGRpbmc6LjI1ZW0haW1wb3J0YW50O21hcmdpbjowIDFlbSAwIDAhaW1wb3J0YW50O2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZSFpbXBvcnRhbnQ7bGluZS1oZWlnaHQ6MS41ZW0haW1wb3J0YW50O2hlaWdodDoyZW0haW1wb3J0YW50O3dpZHRoOjhlbSFpbXBvcnRhbnQ7Ym94LXNpemluZzpib3JkZXItYm94IWltcG9ydGFudDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveCFpbXBvcnRhbnQ7Y3Vyc29yOnRleHQhaW1wb3J0YW50fS54bC1zZXR0aW5ncy1jb2xvci1pbnB1dDpmaXJzdC1vZi10eXBle2N1cnNvcjpwb2ludGVyIWltcG9ydGFudH0ueGwtc2V0dGluZ3MtY29sb3ItaW5wdXQ6bGFzdC1vZi10eXBle3dpZHRoOjExZW0haW1wb3J0YW50fS54bC1zZXR0aW5ncy1leHBvcnQtdGV4dGFyZWEsdGV4dGFyZWEueGwtc2V0dGluZ3MtZW50cnktaW5wdXR7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlO2hlaWdodDoxNWVtO2xpbmUtaGVpZ2h0OjEuM2VtO3BhZGRpbmc6LjVlbSFpbXBvcnRhbnQ7bWFyZ2luOjAhaW1wb3J0YW50O2JveC1zaXppbmc6Ym9yZGVyLWJveDstbW96LWJveC1zaXppbmc6Ym9yZGVyLWJveDtyZXNpemU6dmVydGljYWw7Zm9udC1zaXplOi45ZW0haW1wb3J0YW50O2ZvbnQtZmFtaWx5OkNvdXJpZXIsbW9ub3NwYWNlIWltcG9ydGFudH1idXR0b24ueGwtc2V0dGluZ3MtZW50cnktaW5wdXR7ZmxvYXQ6cmlnaHQ7cGFkZGluZzouMTI1ZW0gLjI1ZW07bWFyZ2luOjA7Ym94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDAsMCwwLC4yNSk7Ym9yZGVyLXJhZGl1czouMjVlbTtmb250LXNpemU6aW5oZXJpdDtmb250LWZhbWlseTppbmhlcml0O2NvbG9yOmluaGVyaXQ7Y3Vyc29yOnBvaW50ZXJ9YnV0dG9uLnhsLXNldHRpbmdzLWVudHJ5LWlucHV0OmhvdmVye2JvcmRlci1jb2xvcjpyZ2JhKDAsMCwwLC41KX1idXR0b24ueGwtc2V0dGluZ3MtZW50cnktaW5wdXQueGwtdGhlbWUtZGFya3tib3JkZXItY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuMjUpfWJ1dHRvbi54bC1zZXR0aW5ncy1lbnRyeS1pbnB1dC54bC10aGVtZS1kYXJrOmhvdmVye2JvcmRlci1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC41KX0ueGwtc2V0dGluZ3MtZXhwb3J0LXRleHRhcmVhe2hlaWdodDoxMDAlO3Jlc2l6ZTpub25lfS54bC1zZXR0aW5ncy1leHBvcnQtdGV4dGFyZWEueGwtc2V0dGluZ3MtZXhwb3J0LXRleHRhcmVhLWVycm9ye2JvcmRlci1jb2xvcjojZjAwMDAwIWltcG9ydGFudDtjb2xvcjojZjAwMDAwIWltcG9ydGFudH0ueGwtc2V0dGluZ3MtZXhwb3J0LXRleHRhcmVhLnhsLXNldHRpbmdzLWV4cG9ydC10ZXh0YXJlYS1jaGFuZ2Vke2NvbG9yOiMwMDgwZjAhaW1wb3J0YW50fS54bC1zZXR0aW5ncy1leHBvcnQtdGV4dGFyZWEueGwtc2V0dGluZ3MtZXhwb3J0LXRleHRhcmVhLWNoYW5nZWQueGwtdGhlbWUtZGFya3tjb2xvcjojODBiMGZmIWltcG9ydGFudH0ueGwtc2V0dGluZ3MtZmlsZS1pbnB1dHtkaXNwbGF5OmlubGluZS1ibG9jaztkaXNwbGF5Om5vbmU7dmlzaWJpbGl0eTpoaWRkZW47b3BhY2l0eTowO3dpZHRoOjA7aGVpZ2h0OjB9LnhsLXNldHRpbmdzLWV4cG9ydC1tZXNzYWdle2xpbmUtaGVpZ2h0OjEuNmVtfS54bC1zZXR0aW5ncy1leHBvcnQtbGFiZWx7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjA7cGFkZGluZzowfS54bC1zZXR0aW5ncy1leHBvcnQtY2hlY2tib3h7ZGlzcGxheTpub25lfS54bC1zZXR0aW5ncy1leHBvcnQtbGFiZWwtdGV4dDpmaXJzdC1vZi10eXBle29wYWNpdHk6LjZ9LnhsLXNldHRpbmdzLWV4cG9ydC1jaGVja2JveDpjaGVja2Vkfi54bC1zZXR0aW5ncy1leHBvcnQtbGFiZWwtdGV4dDpmaXJzdC1vZi10eXBlLC54bC1zZXR0aW5ncy1leHBvcnQtY2hlY2tib3g6bm90KDpjaGVja2VkKX4ueGwtc2V0dGluZ3MtZXhwb3J0LWxhYmVsLXRleHQ6bm90KDpmaXJzdC1vZi10eXBlKXtkaXNwbGF5Om5vbmV9LnhsLWVhc3lsaXN0LXRpdGxle21hcmdpbi1sZWZ0Oi0yZW19LnhsLWVhc3lsaXN0LXRpdGxlLXRleHR7ZGlzcGxheTppbmxpbmUtYmxvY2s7Zm9udC1zaXplOjJlbTtmb250LXdlaWdodDo3MDA7bWFyZ2luLWxlZnQ6MWVtfS54bC1lYXN5bGlzdC1zdWJ0aXRsZXtkaXNwbGF5OmlubGluZS1ibG9jaztmb250LXN0eWxlOml0YWxpYztvcGFjaXR5Oi44O21hcmdpbi1sZWZ0OjJlbX0ueGwtZWFzeWxpc3QtdGl0bGUtbGluZXtib3JkZXItYm90dG9tOjFweCBzb2xpZCBncmV5O21hcmdpbjouNWVtIDB9LnhsLWVhc3lsaXN0LWNvbnRyb2wtbGlua3N7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7cmlnaHQ6MH0ueGwtZWFzeWxpc3QtY29udHJvbC1saW5re2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6LjVlbTtjdXJzb3I6cG9pbnRlcjtvcGFjaXR5Oi41O3RleHQtZGVjb3JhdGlvbjpub25lIWltcG9ydGFudH0ueGwtZWFzeWxpc3QtY29udHJvbC1saW5rLnhsLWVhc3lsaXN0LWNvbnRyb2wtbGluay1mb2N1cywueGwtZWFzeWxpc3QtY29udHJvbC1saW5rOmhvdmVye29wYWNpdHk6MX0ueGwtZWFzeWxpc3QtY29udHJvbC1saW5rKy54bC1lYXN5bGlzdC1jb250cm9sLWxpbmt7bWFyZ2luLWxlZnQ6LjVlbX0ueGwtZWFzeWxpc3QtZW1wdHktbm90aWZpY2F0aW9ue3RleHQtYWxpZ246Y2VudGVyO2ZvbnQtc2l6ZToyZW07Zm9udC1zdHlsZTppdGFsaWM7cGFkZGluZzoyZW19LnhsLWVhc3lsaXN0LWVtcHR5LW5vdGlmaWNhdGlvbjpub3QoLnhsLWVhc3lsaXN0LWVtcHR5LW5vdGlmaWNhdGlvbi12aXNpYmxlKXtkaXNwbGF5Om5vbmV9LnhsLWVhc3lsaXN0LWVtcHR5LW5vdGlmaWNhdGlvbi54bC1lYXN5bGlzdC1lbXB0eS1ub3RpZmljYXRpb24tdmlzaWJsZSsueGwtZWFzeWxpc3QtaXRlbXN7ZGlzcGxheTpub25lfS54bC1lYXN5bGlzdC1pdGVtc3tib3JkZXItcmFkaXVzOi41ZW07Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDAsMCwwLC4yNSk7Ym94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OmhpZGRlbn0ueGwtZWFzeWxpc3QtaXRlbXMueGwtdGhlbWUtZGFya3tib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjI1KX0ueGwtZWFzeWxpc3QtaXRlbXtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjAzMTI1KX0ueGwtZWFzeWxpc3QtaXRlbVtkYXRhLXhsLWVhc3lsaXN0LWl0ZW0tcGFyaXR5PWV2ZW5de2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMDYyNSl9LnhsLWVhc3lsaXN0LWl0ZW0ueGwtdGhlbWUtZGFya3tiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjAzMTI1KX0ueGwtZWFzeWxpc3QtaXRlbS54bC10aGVtZS1kYXJrW2RhdGEteGwtZWFzeWxpc3QtaXRlbS1wYXJpdHk9ZXZlbl17YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4wNjI1KX0ueGwtZWFzeWxpc3QtaXRlbS54bC1lYXN5bGlzdC1pdGVtLWhpZGRlbntkaXNwbGF5Om5vbmV9LnhsLWVhc3lsaXN0LWl0ZW0tdGFibGUtY29udGFpbmVye3BhZGRpbmc6LjVlbTtwb3NpdGlvbjpyZWxhdGl2ZTtib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3h9LnhsLWVhc3lsaXN0LWl0ZW0tdGFibGV7ZGlzcGxheTp0YWJsZTt3aWR0aDoxMDAlfS54bC1lYXN5bGlzdC1pdGVtLXJvd3tkaXNwbGF5OnRhYmxlLXJvd30ueGwtZWFzeWxpc3QtaXRlbS1jZWxse2Rpc3BsYXk6dGFibGUtY2VsbDt3aWR0aDoxMDAlO3ZlcnRpY2FsLWFsaWduOnRvcDtwYWRkaW5nOjAgLjVlbX0ueGwtZWFzeWxpc3QtaXRlbS1jZWxsLnhsLWVhc3lsaXN0LWl0ZW0tY2VsbC1pbWFnZXt3aWR0aDowO3BhZGRpbmc6MH0ueGwtZWFzeWxpc3QtaXRlbS1jZWxsLnhsLWVhc3lsaXN0LWl0ZW0tY2VsbC1zaWRle3dpZHRoOjA7cGFkZGluZzowfS54bC1lYXN5bGlzdC1pdGVtLWltYWdlLWNvbnRhaW5lcntkaXNwbGF5OmJsb2NrO21hcmdpbjowO3BhZGRpbmc6MDtib3JkZXI6bm9uZTt3aWR0aDoxNDBweDtoZWlnaHQ6MjAwcHg7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC4wMzEyNSk7dGV4dC1hbGlnbjpjZW50ZXI7d2hpdGUtc3BhY2U6bm93cmFwO2xpbmUtaGVpZ2h0OjB9LnhsLWVhc3lsaXN0LWl0ZW0taW1hZ2UtY29udGFpbmVyOmFmdGVye2NvbnRlbnQ6XCJcIjtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7d2lkdGg6MDtoZWlnaHQ6MTAwJX0ueGwtZWFzeWxpc3QtaXRlbS1pbWFnZS1jb250YWluZXIueGwtdGhlbWUtZGFya3tiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjAzMTI1KX0ueGwtZWFzeWxpc3QtaXRlbS1pbWFnZS1vdXRlcntkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7cG9zaXRpb246cmVsYXRpdmU7dGV4dC1hbGlnbjpjZW50ZXJ9LnhsLWVhc3lsaXN0LWl0ZW0taW1hZ2V7bWFyZ2luOjAhaW1wb3J0YW50O3BhZGRpbmc6MCFpbXBvcnRhbnQ7Ym9yZGVyOm5vbmUhaW1wb3J0YW50O2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTttYXgtd2lkdGg6MTQwcHg7bWF4LWhlaWdodDoyMDBweH0ueGwtZWFzeWxpc3QtaXRlbS1pbWFnZS1lcnJvci1hbGlnbmVye2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTt3aWR0aDowO2hlaWdodDoxMDAlfS54bC1lYXN5bGlzdC1pdGVtLWltYWdlLWVycm9ye2ZvbnQtc2l6ZTouNzVlbTtwYWRkaW5nOi4yNWVtO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTtsaW5lLWhlaWdodDpub3JtYWw7d2hpdGUtc3BhY2U6cHJlLXdyYXB9LnhsLWVhc3lsaXN0LWl0ZW0taW1hZ2UtaW5kZXh7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjA7dG9wOjA7cGFkZGluZzouMjVlbTtjb2xvcjojMDAwO3RleHQtc2hhZG93OjAgMCAuMTI1ZW0gI2ZmZiwwIDAgLjI1ZW0gI2ZmZjtsaW5lLWhlaWdodDpub3JtYWx9LnhsLWVhc3lsaXN0LWl0ZW0taW1hZ2UtaW5kZXgueGwtdGhlbWUtZGFya3tjb2xvcjojZmZmO3RleHQtc2hhZG93OjAgMCAuMTI1ZW0gIzAwMCwwIDAgLjI1ZW0gIzAwMH0ueGwtZWFzeWxpc3QtaXRlbS1pbmZve2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6MCAwIC41ZW0gLjVlbTt3aWR0aDo0LjhlbX0ueGwtZWFzeWxpc3QtaXRlbS1pbmZvLWl0ZW17Zm9udC1zaXplOi44MjVlbTttYXJnaW4tdG9wOjFlbTt0ZXh0LWFsaWduOmNlbnRlcjttYXgtd2lkdGg6MTAwJTtib3JkZXItcmFkaXVzOi41ZW07cGFkZGluZzouMzc1ZW0gMDtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjEyNSk7Ym94LXNoYWRvdzowIDAgLjVlbSByZ2JhKDAsMCwwLC4xMjUpO3RleHQtc2hhZG93OjAgLjFlbSAwIHJnYmEoMjU1LDI1NSwyNTUsLjUpfS54bC1lYXN5bGlzdC1pdGVtLWluZm8taXRlbS54bC10aGVtZS1kYXJre2JhY2tncm91bmQtY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuMTI1KTtib3gtc2hhZG93OjAgMCAuNWVtIHJnYmEoMjU1LDI1NSwyNTUsLjEyNSk7dGV4dC1zaGFkb3c6MCAuMWVtIDAgcmdiYSgwLDAsMCwuNSl9LnhsLWVhc3lsaXN0LWl0ZW0taW5mby1saWdodHtvcGFjaXR5Oi44fS54bC1lYXN5bGlzdC1pdGVtLWluZm8tYnV0dG9ue3RleHQtZGVjb3JhdGlvbjpub25lIWltcG9ydGFudH0ueGwtZWFzeWxpc3QtaXRlbS10aXRsZXtmb250LXNpemU6MS41ZW07Zm9udC13ZWlnaHQ6NzAwfS54bC1lYXN5bGlzdC1pdGVtLXRpdGxlOmhvdmVye3RleHQtc2hhZG93OjAgMCAuMjVlbSAjZmZmfS54bC1lYXN5bGlzdC1pdGVtLXRpdGxlLnhsLXRoZW1lLWRhcms6aG92ZXJ7dGV4dC1zaGFkb3c6MCAwIC4yNWVtICMwMDB9LnhsLWVhc3lsaXN0LWl0ZW0tdGl0bGUtbGlua3t0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnR9LnhsLWVhc3lsaXN0LWl0ZW0tdGl0bGUtdGFnLWxpbmt7dGV4dC1kZWNvcmF0aW9uOm5vbmUhaW1wb3J0YW50O21hcmdpbi1yaWdodDouMjVlbTtkaXNwbGF5Om5vbmV9LnhsLWVhc3lsaXN0LWl0ZW0tdGl0bGUtanB7b3BhY2l0eTouNTtmb250LXNpemU6MS4xZW07ZGlzcGxheTpibG9ja30ueGwtZWFzeWxpc3QtaXRlbS11cGxvYWQtaW5mb3ttYXJnaW4tdG9wOi41ZW19LnhsLWVhc3lsaXN0LWl0ZW0tdXBsb2FkZXJ7Zm9udC13ZWlnaHQ6NzAwO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6MCAuMjVlbX0ueGwtZWFzeWxpc3QtaXRlbS11cGxvYWQtZGF0ZXtmb250LXdlaWdodDo3MDA7ZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzowIC4yNWVtfS54bC1lYXN5bGlzdC1pdGVtLXRhZ3N7bWFyZ2luLXRvcDouNWVtfS54bC1lYXN5bGlzdC1pdGVtLXRhZy10YWJsZXtkaXNwbGF5OnRhYmxlO3dpZHRoOjEwMCV9LnhsLWVhc3lsaXN0LWl0ZW0tdGFnLXJvd3tkaXNwbGF5OnRhYmxlLXJvd30ueGwtZWFzeWxpc3QtaXRlbS10YWctcm93Ky54bC1lYXN5bGlzdC1pdGVtLXRhZy1yb3c+LnhsLWVhc3lsaXN0LWl0ZW0tdGFnLWNlbGx7cGFkZGluZy10b3A6LjI1ZW19LnhsLWVhc3lsaXN0LWl0ZW0tdGFnLWNlbGx7ZGlzcGxheTp0YWJsZS1jZWxsO3dpZHRoOjEwMCV9LnhsLWVhc3lsaXN0LWl0ZW0tdGFnLWNlbGwueGwtZWFzeWxpc3QtaXRlbS10YWctY2VsbC1sYWJlbHt3aWR0aDowO3doaXRlLXNwYWNlOm5vd3JhcDt0ZXh0LWFsaWduOnJpZ2h0O3BhZGRpbmctcmlnaHQ6LjI1ZW19LnhsLWVhc3lsaXN0LWNvbXBhY3QgLnhsLWVhc3lsaXN0LWl0ZW0taW1hZ2UtY29udGFpbmVye3dpZHRoOjcwcHg7aGVpZ2h0OjEwMHB4fS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLWltYWdle21heC13aWR0aDo3MHB4O21heC1oZWlnaHQ6MTAwcHh9LnhsLWVhc3lsaXN0LWNvbXBhY3QgLnhsLWVhc3lsaXN0LWl0ZW0tdXBsb2FkLWluZm97ZGlzcGxheTpub25lfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRpdGxle2ZvbnQtc2l6ZToxZW07bGluZS1oZWlnaHQ6MS4yNWVtO21heC1oZWlnaHQ6Mi41ZW07b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOnJlbGF0aXZlfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRpdGxlOmhvdmVye292ZXJmbG93OnZpc2libGU7ei1pbmRleDoxfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRpdGxlLWpwe2Rpc3BsYXk6bm9uZX0ueGwtZWFzeWxpc3QtY29tcGFjdCAueGwtZWFzeWxpc3QtaXRlbS1pbmZvLWl0ZW0ueGwtZWFzeWxpc3QtaXRlbS1pbmZvLWl0ZW0tZmlsZXM+Om5vdCg6Zmlyc3QtY2hpbGQpLC54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLWluZm8taXRlbS54bC1lYXN5bGlzdC1pdGVtLWluZm8taXRlbS1yYXRpbmc+Om5vdCg6Zmlyc3QtY2hpbGQpe2Rpc3BsYXk6bm9uZX0ueGwtZWFzeWxpc3QtY29tcGFjdCAueGwtZWFzeWxpc3QtaXRlbS10YWdze2ZvbnQtc2l6ZTouOWVtfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRhZy1yb3crLnhsLWVhc3lsaXN0LWl0ZW0tdGFnLXJvdz4ueGwtZWFzeWxpc3QtaXRlbS10YWctY2VsbHtwYWRkaW5nLXRvcDowfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRhZy10YWJsZXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuNGVtfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRhZy1yb3d7ZGlzcGxheTppbmxpbmV9LnhsLWVhc3lsaXN0LWNvbXBhY3QgLnhsLWVhc3lsaXN0LWl0ZW0tdGFnLXJvdysueGwtZWFzeWxpc3QtaXRlbS10YWctcm93OmJlZm9yZXtjb250ZW50OlwiXCI7ZGlzcGxheTppbmxpbmUtYmxvY2s7d2lkdGg6MWVtO2hlaWdodDowfS54bC1lYXN5bGlzdC1jb21wYWN0IC54bC1lYXN5bGlzdC1pdGVtLXRhZy1jZWxse2Rpc3BsYXk6aW5saW5lO3dpZHRoOmF1dG99LnhsLWVhc3lsaXN0LWNvbXBhY3QgLnhsLWVhc3lsaXN0LWl0ZW0tdGFnLWNlbGw+LnhsLXRhZy1uYW1lc3BhY2UtYmxvY2sueGwtdGFnLW5hbWVzcGFjZS1ibG9jay1uby1vdXRsaW5lPi54bC10YWctbmFtZXNwYWNle2JvcmRlci13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLWNlbGwtaW1hZ2V7ZGlzcGxheTpub25lfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLWNlbGx7cGFkZGluZy1sZWZ0OjA7dmVydGljYWwtYWxpZ246bWlkZGxlfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLWNlbGwtc2lkZXt2ZXJ0aWNhbC1hbGlnbjp0b3B9LnhsLWVhc3lsaXN0LW1pbmltYWwgLnhsLWVhc3lsaXN0LWl0ZW0tdXBsb2FkLWluZm97ZGlzcGxheTpub25lfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLXRpdGxle2ZvbnQtc2l6ZToxZW07bGluZS1oZWlnaHQ6MS4yNWVtfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLXRpdGxlLWpwe2Rpc3BsYXk6bm9uZX0ueGwtZWFzeWxpc3QtbWluaW1hbCAueGwtZWFzeWxpc3QtaXRlbS1pbmZvLWl0ZW17ZGlzcGxheTpub25lfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLXRhZ3N7ZGlzcGxheTpub25lfS54bC1lYXN5bGlzdC1taW5pbWFsIC54bC1lYXN5bGlzdC1pdGVtLXRpdGxlLXRhZy1saW5re2Rpc3BsYXk6aW5saW5lLWJsb2NrfS54bC1lYXN5bGlzdC1vcHRpb25zOm5vdCgueGwtZWFzeWxpc3Qtb3B0aW9ucy12aXNpYmxlKXtkaXNwbGF5Om5vbmV9LnhsLWVhc3lsaXN0LW9wdGlvbi10YWJsZXtkaXNwbGF5OnRhYmxlO3dpZHRoOjEwMCV9LnhsLWVhc3lsaXN0LW9wdGlvbi1yb3d7ZGlzcGxheTp0YWJsZS1yb3d9LnhsLWVhc3lsaXN0LW9wdGlvbi1yb3crLnhsLWVhc3lsaXN0LW9wdGlvbi1yb3c+LnhsLWVhc3lsaXN0LW9wdGlvbi1jZWxse3BhZGRpbmctdG9wOi41ZW19LnhsLWVhc3lsaXN0LW9wdGlvbi1jZWxse2Rpc3BsYXk6dGFibGUtY2VsbDt3aWR0aDoxMDAlO3ZlcnRpY2FsLWFsaWduOnRvcH0ueGwtZWFzeWxpc3Qtb3B0aW9uLWNlbGw6Zmlyc3Qtb2YtdHlwZXt3aWR0aDowO3RleHQtYWxpZ246cmlnaHR9LnhsLWVhc3lsaXN0LW9wdGlvbi1ncm91cCsueGwtZWFzeWxpc3Qtb3B0aW9uLWdyb3Vwe21hcmdpbi10b3A6LjVlbX0ueGwtZWFzeWxpc3Qtb3B0aW9uLXRpdGxle2ZvbnQtd2VpZ2h0OjcwMDttYXJnaW4tcmlnaHQ6MWVtO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6LjI1ZW0gMDtib3JkZXItdG9wOjFweCBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB0cmFuc3BhcmVudDt3aGl0ZS1zcGFjZTpub3dyYXB9LnhsLWVhc3lsaXN0LW9wdGlvbi10aXRsZS1zdWJ7bWF4LXdpZHRoOjEwMCU7bWFyZ2luLXJpZ2h0OjFlbTtvcGFjaXR5Oi45O3doaXRlLXNwYWNlOm5vcm1hbH0ueGwtZWFzeWxpc3Qtb3B0aW9uLXRpdGxlLXN1Yi10ZXh0e2ZvbnQtc2l6ZTouODc1ZW07bGluZS1oZWlnaHQ6MS4xZW19LnhsLWVhc3lsaXN0LW9wdGlvbi1sYWJlbHtkaXNwbGF5OmlubGluZS1ibG9ja30ueGwtZWFzeWxpc3Qtb3B0aW9uLWxhYmVsKy54bC1lYXN5bGlzdC1vcHRpb24tbGFiZWx7bWFyZ2luLWxlZnQ6LjVlbX0ueGwtZWFzeWxpc3Qtb3B0aW9uLWlucHV0LC54bC1lYXN5bGlzdC1vcHRpb24taW5wdXQrLnJpY2VDaGVja3tkaXNwbGF5Om5vbmV9LnhsLWVhc3lsaXN0LW9wdGlvbi1idXR0b257ZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzouMjVlbSAuNWVtO2JvcmRlci1yYWRpdXM6LjI1ZW07YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC4xMjUpO2JvcmRlcjoxcHggc29saWQgcmdiYSgwLDAsMCwuMDYyNSk7Y3Vyc29yOnBvaW50ZXJ9LnhsLWVhc3lsaXN0LW9wdGlvbi1idXR0b246aG92ZXJ7Ym9yZGVyLWNvbG9yOnJnYmEoMCwwLDAsLjI1KX0ueGwtZWFzeWxpc3Qtb3B0aW9uLWJ1dHRvbi54bC10aGVtZS1kYXJre2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMTI1KTtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjA2MjUpfS54bC1lYXN5bGlzdC1vcHRpb24tYnV0dG9uLnhsLXRoZW1lLWRhcms6aG92ZXJ7Ym9yZGVyLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjI1KX0ueGwtZWFzeWxpc3Qtb3B0aW9uLWlucHV0OmNoZWNrZWR+LnhsLWVhc3lsaXN0LW9wdGlvbi1idXR0b257YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC41KTtib3JkZXItY29sb3I6cmdiYSgwLDAsMCwuMjUpO2NvbG9yOiMwMDB9LnhsLWVhc3lsaXN0LW9wdGlvbi1pbnB1dDpjaGVja2Vkfi54bC1lYXN5bGlzdC1vcHRpb24tYnV0dG9uLnhsLXRoZW1lLWRhcmt7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC41KTtib3JkZXItY29sb3I6cmdiYSgyNTUsMjU1LDI1NSwuMjUpO2NvbG9yOiNmZmZ9LnhsLWVhc3lsaXN0LW9wdGlvbi10ZXh0YXJlYXtiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjEyNSkhaW1wb3J0YW50O2JvcmRlcjoxcHggc29saWQgcmdiYSgwLDAsMCwuMDYyNSkhaW1wb3J0YW50O21hcmdpbjowIWltcG9ydGFudDtwYWRkaW5nOi4yNWVtIWltcG9ydGFudDtib3gtc2l6aW5nOmJvcmRlci1ib3g7LW1vei1ib3gtc2l6aW5nOmJvcmRlci1ib3g7d2lkdGg6MTAwJTtsaW5lLWhlaWdodDoxLjRlbTtoZWlnaHQ6NC44ZW07bWluLWhlaWdodDoyZW07cmVzaXplOnZlcnRpY2FsO2ZvbnQtZmFtaWx5OkNvdXJpZXIsbW9ub3NwYWNlIWltcG9ydGFudH0ueGwtZWFzeWxpc3Qtb3B0aW9uLXRleHRhcmVhOmZvY3VzLC54bC1lYXN5bGlzdC1vcHRpb24tdGV4dGFyZWE6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LC41KSFpbXBvcnRhbnQ7Ym9yZGVyLWNvbG9yOnJnYmEoMCwwLDAsLjI1KSFpbXBvcnRhbnR9LnhsLWVhc3lsaXN0LW9wdGlvbi10ZXh0YXJlYS54bC10aGVtZS1kYXJre2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMTI1KSFpbXBvcnRhbnQ7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDI1NSwyNTUsMjU1LC4wNjI1KSFpbXBvcnRhbnQ7bWFyZ2luOjAhaW1wb3J0YW50O3BhZGRpbmc6LjI1ZW0haW1wb3J0YW50fS54bC1lYXN5bGlzdC1vcHRpb24tdGV4dGFyZWEueGwtdGhlbWUtZGFyazpmb2N1cywueGwtZWFzeWxpc3Qtb3B0aW9uLXRleHRhcmVhLnhsLXRoZW1lLWRhcms6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsMCwwLC41KSFpbXBvcnRhbnQ7Ym9yZGVyLWNvbG9yOnJnYmEoMjU1LDI1NSwyNTUsLjI1KSFpbXBvcnRhbnR9LnhsLWNoYW5nZWxvZy1wb3B1cC1hbGlnbnttaW4taGVpZ2h0OjgwJTtoZWlnaHQ6MjAwcHh9LnhsLWNoYW5nZWxvZy1wb3B1cC1jb250ZW50e3Bvc2l0aW9uOnJlbGF0aXZlO2hlaWdodDoxMDAlfS54bC1jaGFuZ2Vsb2ctbWVzc2FnZS1jb250YWluZXJ7cG9zaXRpb246YWJzb2x1dGU7bGVmdDowO3RvcDowO3JpZ2h0OjA7Ym90dG9tOjA7dGV4dC1hbGlnbjpjZW50ZXI7bGluZS1oZWlnaHQ6MDt3aGl0ZS1zcGFjZTpub3dyYXB9LnhsLWNoYW5nZWxvZy1tZXNzYWdlLWNvbnRhaW5lcjpiZWZvcmV7Y29udGVudDpcIlwiO2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTt3aWR0aDowO2hlaWdodDoxMDAlfS54bC1jaGFuZ2Vsb2ctbWVzc2FnZXt0ZXh0LWFsaWduOmxlZnQ7bGluZS1oZWlnaHQ6bm9ybWFsO3doaXRlLXNwYWNlOm5vcm1hbDtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGV9LnhsLWNoYW5nZWxvZy1lbnRyaWVze3BhZGRpbmc6LjM3NWVtfS54bC1jaGFuZ2Vsb2ctZW50cnkrLnhsLWNoYW5nZWxvZy1lbnRyeXttYXJnaW4tdG9wOjFlbX0ueGwtY2hhbmdlbG9nLWVudHJ5LXZlcnNpb257Zm9udC13ZWlnaHQ6NzAwO2ZvbnQtc2l6ZToxLjI1ZW07bGluZS1oZWlnaHQ6MS40ZW19LnhsLWNoYW5nZWxvZy1lbnRyeS11c2Vyc3ttYXJnaW4tbGVmdDoxZW19LnhsLWNoYW5nZWxvZy1lbnRyeS11c2VyKy54bC1jaGFuZ2Vsb2ctZW50cnktdXNlcnttYXJnaW4tdG9wOi41ZW19LnhsLWNoYW5nZWxvZy1lbnRyeS11c2VyLW5hbWV7Zm9udC13ZWlnaHQ6NzAwO2xpbmUtaGVpZ2h0OjEuNGVtfS54bC1jaGFuZ2Vsb2ctZW50cnktY2hhbmdlc3ttYXJnaW46MCAwIDAgMS41ZW0haW1wb3J0YW50O3BhZGRpbmc6MCFpbXBvcnRhbnQ7bGlzdC1zdHlsZS10eXBlOmRpc2MhaW1wb3J0YW50fS54bC1jaGFuZ2Vsb2ctZW50cnktY2hhbmdle21hcmdpbjowIWltcG9ydGFudDtwYWRkaW5nOjAhaW1wb3J0YW50fS54bC1jaGFuZ2Vsb2ctZW50cnktY2hhbmdlKy54bC1jaGFuZ2Vsb2ctZW50cnktY2hhbmdle21hcmdpbi10b3A6LjVlbSFpbXBvcnRhbnR9LnhsLWNvbXBhdGliaWxpdHktd2FybmluZysueGwtY29tcGF0aWJpbGl0eS13YXJuaW5ne21hcmdpbi10b3A6MWVtfS54bC1jb21wYXRpYmlsaXR5LXdhcm5pbmctdGl0bGV7Zm9udC13ZWlnaHQ6NzAwO2ZvbnQtc2l6ZToxLjI1ZW07bGluZS1oZWlnaHQ6MS40ZW19LnhsLWNvbXBhdGliaWxpdHktd2FybmluZy1jb250ZW50e21hcmdpbjowIDAgMCAxZW19LnhsLWhlYWRlci1iYXItbGlua3t2ZXJ0aWNhbC1hbGlnbjpiYXNlbGluZTtjdXJzb3I6cG9pbnRlcn0ueGwtaGVhZGVyLWJhci1zdmd7d2lkdGg6MS4yZW07aGVpZ2h0OjEuMTZlbTtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7ZmlsbDojMDAwO3N0cm9rZTpub25lfS54bC1oZWFkZXItYmFyLWxpbmsueGwtYXBwY2hhbnh7dmVydGljYWwtYWxpZ246bWlkZGxlfS54bC1oZWFkZXItYmFyLWxpbmsueGwtYXBwY2hhbng+LnhsLWhlYWRlci1iYXItc3Zne3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCV9LnhsLWhlYWRlci1iYXItbGluay54bC1oZWFkZXItYmFyLWxpbmstZGlte29wYWNpdHk6LjQ1fSIpOwoKCQkJVGhlbWUucmVhZHkoKTsKCQkJRWFzeUxpc3QucmVhZHkoKTsKCgkJCURlYnVnLnRpbWVyX2xvZygiaW5pdC5yZWFkeSBkdXJhdGlvbiIsICJpbml0Iik7CgoJCQlzdGFydF9wcm9jZXNzaW5nKEV4dGVuc2lvbkFQSS5zaG91bGRfZGVmZXJfcHJvY2Vzc2luZygpKTsKCgkJCUhlYWRlckJhci5yZWFkeSgpOwoKCQkJaWYgKE1vZHVsZS52ZXJzaW9uX2NoYW5nZSA9PT0gMSAmJiBjb25maWcuZ2VuZXJhbC5jaGFuZ2Vsb2dfb25fdXBkYXRlKSB7CgkJCQlDaGFuZ2Vsb2cub3BlbigiIHVwZGF0ZWQgdG8gIik7CgkJCX0KCgkJCWlmIChjb25maWcuZ2VuZXJhbC5jb21wYXRpYmlsaXR5X2NoZWNrKSB7CgkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcnVuX2NvbXBhdGliaWxpdHlfY2hlY2soKTsgfSwgMTAwMCk7CgkJCX0KCgkJCURlYnVnLnRpbWVyX2xvZygiaW5pdC5yZWFkeS5mdWxsIGR1cmF0aW9uIiwgImluaXQiKTsKCQl9OwoJCXZhciBvbl9ib2R5X29ic2VydmUgPSBmdW5jdGlvbiAocmVjb3JkcykgewoJCQl2YXIgcG9zdF9saXN0ID0gW10sCgkJCQlyZWxvYWRfYWxsID0gZmFsc2UsCgkJCQlub2Rlcywgbm9kZSwgbnMsIGUsIGksIGlpLCBqLCBqajsKCgkJCWZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7CgkJCQllID0gcmVjb3Jkc1tpXTsKCQkJCW5vZGVzID0gZS5yZW1vdmVkTm9kZXM7CgkJCQlpZiAobm9kZXMgJiYgbm9kZXMubGVuZ3RoID4gMCkgewoJCQkJCS8vIFJlbW92ZWQgcG9zdHMKCQkJCQljaGVja19yZW1vdmVkX25vZGVzKG5vZGVzKTsKCQkJCX0KCgkJCQlub2RlcyA9IGUuYWRkZWROb2RlczsKCQkJCWlmICghbm9kZXMpIGNvbnRpbnVlOwoKCQkJCS8vIEZpbmQgcG9zdHMKCQkJCWZvciAoaiA9IDAsIGpqID0gbm9kZXMubGVuZ3RoOyBqIDwgamo7ICsraikgewoJCQkJCW5vZGUgPSBub2Rlc1tqXTsKCQkJCQlpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHsKCQkJCQkJaWYgKFBvc3QuaXNfcG9zdChub2RlKSkgewoJCQkJCQkJcG9zdF9saXN0LnB1c2gobm9kZSk7CgkJCQkJCX0KCQkJCQkJZWxzZSBpZiAoaXNfcG9zdF9ncm91cF9jb250YWluZXIobm9kZSkpIHsKCQkJCQkJCW5zID0gUG9zdC5nZXRfYWxsX3Bvc3RzKG5vZGUpOwoJCQkJCQkJaWYgKG5zLmxlbmd0aCA+IDApIHsKCQkJCQkJCQkkLnB1c2hfbWFueShwb3N0X2xpc3QsIG5zKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCgkJCQlpZiAoQ29uZmlnLmlzXzRjaGFuKSB7CgkJCQkJLy8gNGNoYW4teCBjb25mbGljdHMKCQkJCQlpZiAoQ29uZmlnLmlzXzRjaGFuX3gzKSB7CgkJCQkJCS8vIFNvdXJjZSBsaW5rcwoJCQkJCQlpZiAoCgkJCQkJCQllLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoImZpbGVUZXh0IikgJiYKCQkJCQkJCWUucHJldmlvdXNTaWJsaW5nICYmCgkJCQkJCQllLnByZXZpb3VzU2libGluZy5jbGFzc0xpc3QgJiYKCQkJCQkJCWUucHJldmlvdXNTaWJsaW5nLmNsYXNzTGlzdC5jb250YWlucygiZmlsZS1pbmZvIikKCQkJCQkJKSB7CgkJCQkJCQlub2RlID0gUG9zdC5nZXRfcG9zdF9jb250YWluZXIoZS50YXJnZXQpOwoJCQkJCQkJaWYgKG5vZGUgIT09IG51bGwpIHsKCQkJCQkJCQlwb3N0X2xpc3QucHVzaChub2RlKTsKCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gNGNoYW4teCBsaW5raWZpY2F0aW9uIGNvbmZsaWN0cwoJCQkJCQlmb3IgKGogPSAwLCBqaiA9IG5vZGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKCQkJCQkJCW5vZGUgPSBub2Rlc1tqXTsKCQkJCQkJCWlmICgKCQkJCQkJCQlub2RlLnRhZ05hbWUgPT09ICJBIiAmJgoJCQkJCQkJCW5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJsaW5raWZ5IikgJiYKCQkJCQkJCQkobnMgPSAkJCgiLnhsLWxpbmstZXZlbnRzIiwgbm9kZSkpLmxlbmd0aCA+IDAKCQkJCQkJCSkgewoJCQkJCQkJCUxpbmtpZmllci5maXhfYnJva2VuXzRjaGFueF9saW5raWZpY2F0aW9uKG5vZGUsIG5zKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJLy8gNGNoYW4taW5saW5lIGNvbmZsaWN0cwoJCQkJCQlpZiAoIXJlbG9hZF9hbGwgJiYgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJuYXZMaW5rcyIpKSB7CgkJCQkJCQlmb3IgKGogPSAwLCBqaiA9IG5vZGVzLmxlbmd0aDsgaiA8IGpqOyArK2opIHsKCQkJCQkJCQlpZiAobm9kZXNbal0uY2xhc3NMaXN0ICYmIG5vZGVzW2pdLmNsYXNzTGlzdC5jb250YWlucygidGhyZWFkLXN0YXRzIikpIHsKCQkJCQkJCQkJLy8gUmVsb2FkIGV2ZXJ5IHNpbmdsZSBwb3N0IGJlY2F1c2UgNGNoYW4ncyBpbmxpbmUgc2NyaXB0IG1lc3NlZCBpdCBhbGwgdXAKCQkJCQkJCQkJLy8gVGhpcyBzZWVtcyB0byBiZSBzb21lIHNvcnQgb2YgdGltaW5nIGlzc3VlIHdoZXJlIDRjaGFuLWlubGluZSByZXBsYWNlcyB0aGUgYm9keSBjb250ZW50cyBvZiBFVkVSWSBTSU5HTEUgUE9TVCBvbiByZWFkeSgpCgkJCQkJCQkJCXJlbG9hZF9hbGwgPSB0cnVlOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJaWYgKHBvc3RfbGlzdC5sZW5ndGggPiAwKSB7CgkJCQlMaW5raWZpZXIucXVldWVfcG9zdHMocG9zdF9saXN0LCBMaW5raWZpZXIucXVldWVfcG9zdHMuRmxhZ3MuTm9uZSk7CgkJCX0KCQkJaWYgKHJlbG9hZF9hbGwpIHsKCQkJCXJlbG9hZF9hbGxfcG9zdHMoKTsKCQkJfQoJCX07CgkJdmFyIGNoZWNrX3JlbW92ZWRfbm9kZXMgPSBmdW5jdGlvbiAobm9kZXMpIHsKCQkJdmFyIG5vZGUsIG5zLCBpLCBpaSwgaiwgamo7CgkJCWZvciAoaSA9IDAsIGlpID0gbm9kZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkgewoJCQkJbm9kZSA9IG5vZGVzW2ldOwoJCQkJaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7CgkJCQkJaWYgKFBvc3QuaXNfcG9zdChub2RlKSkgewoJCQkJCQlVSS5jbGVhbnVwX3Bvc3RfcmVtb3ZlZChub2RlKTsKCQkJCQl9CgkJCQkJZWxzZSBpZiAoaXNfcG9zdF9ncm91cF9jb250YWluZXIobm9kZSkpIHsKCQkJCQkJbnMgPSBQb3N0LmdldF9hbGxfcG9zdHMobm9kZSk7CgkJCQkJCWZvciAoaiA9IDAsIGpqID0gbnMubGVuZ3RoOyBqIDwgamo7ICsraikgewoJCQkJCQkJVUkuY2xlYW51cF9wb3N0X3JlbW92ZWQobnNbal0pOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKCQl2YXIgaXNfcG9zdF9ncm91cF9jb250YWluZXIgPSBmdW5jdGlvbiAobm9kZSkgewoJCQlyZXR1cm4gbm9kZS5pZCA9PT0gInFwIiB8fAoJCQkJbm9kZS5pZCA9PT0gInRocmVhZC1jb250YWluZXIiIHx8CgkJCQlub2RlLmNsYXNzTGlzdC5jb250YWlucygidGhyZWFkIikgfHwKCQkJCW5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCJpbmxpbmUiKTsKCQl9OwoKCQl2YXIgcnVuX2NvbXBhdGliaWxpdHlfY2hlY2sgPSBmdW5jdGlvbiAoKSB7CgkJCXZhciBuID0gJCgiLmV4bGlua3NPcHRpb25zTGluayIpOwoKCQkJaWYgKG4gIT09IG51bGwpIHsKCQkJCXNob3dfY29tcGF0aWJpbGl0eV9lcnJvcihbCgkJCQkJewoJCQkJCQl0aXRsZTogIkV4TGlua3MgZW5hYmxlZCIsCgkJCQkJCWRlc2NyaXB0aW9uOiAiQm90aCBFeExpbmtzIGFuZCBYLWxpbmtzIGhhdmUgYmVlbiBkZXRlY3RlZCBhcyBlbmFibGVkLlxuRGlzYWJsZSBFeExpbmtzIGZvciBiZXN0IGZ1bmN0aW9uYWxpdHkuIgoJCQkJCX0KCQkJCV0pOwoJCQl9CgkJfTsKCgkJdmFyIHNob3dfY29tcGF0aWJpbGl0eV9lcnJvciA9IGZ1bmN0aW9uIChlcnJvcnMpIHsKCQkJdmFyIHRoZW1lID0gVGhlbWUuY2xhc3NlcywKCQkJCXBvcHVwOwoKCQkJdmFyIG9uX2Nsb3NlX2NsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7CgkJCQlpZiAoJC5pc19sZWZ0X21vdXNlKGV2ZW50KSkgewoJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQkJaWYgKHBvcHVwICE9PSBudWxsKSB7CgkJCQkJCVBvcHVwLmNsb3NlKHBvcHVwKTsKCQkJCQkJcG9wdXAgPSBudWxsOwoJCQkJCX0KCQkJCX0KCQkJfTsKCQkJdmFyIG9uX2NoYW5nZV9zYXZlID0gZnVuY3Rpb24gKCkgewoJCQkJY29uZmlnLmdlbmVyYWwuY29tcGF0aWJpbGl0eV9jaGVjayA9IHRoaXMuY2hlY2tlZDsKCQkJCUNvbmZpZy5zYXZlKCk7CgkJCX07CgoKCQkJcG9wdXAgPSBQb3B1cC5jcmVhdGUoInNldHRpbmdzIiwgW1t7CgkJCQlzbWFsbDogdHJ1ZSwKCQkJCXNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVyKSB7CgkJCQkJJC5hZGQoY29udGFpbmVyLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtdGl0bGUiICsgdGhlbWUsICJDb21wYXRpYmlsaXR5IFdhcm5pbmciKSk7CgkJCQl9CgkJCX0sIHsKCQkJCWFsaWduOiAicmlnaHQiLAoJCQkJc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXIpIHsKCQkJCQl2YXIgbjEsIG4yOwoJCQkJCSQuYWRkKGNvbnRhaW5lciwgbjEgPSAkLm5vZGUoImxhYmVsIiwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4xLCBuMiA9ICQubm9kZSgiaW5wdXQiLCAieGwtc2V0dGluZ3MtYnV0dG9uLWNoZWNrYm94IikpOwoJCQkJCSQuYWRkKG4xLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtYnV0dG9uLXRleHQgeGwtc2V0dGluZ3MtYnV0dG9uLWNoZWNrYm94LXRleHQiLCAiIFNob3cgd2FybmluZ3MiKSk7CgkJCQkJJC5hZGQobjEsICQubm9kZSgic3BhbiIsICJ4bC1zZXR0aW5ncy1idXR0b24tdGV4dCB4bC1zZXR0aW5ncy1idXR0b24tY2hlY2tib3gtdGV4dCIsICIgRG9uJ3Qgc2hvdyB3YXJuaW5ncyIpKTsKCQkJCQluMi50eXBlID0gImNoZWNrYm94IjsKCQkJCQluMi5jaGVja2VkID0gY29uZmlnLmdlbmVyYWwuY29tcGF0aWJpbGl0eV9jaGVjazsKCQkJCQkkLm9uKG4yLCAiY2hhbmdlIiwgb25fY2hhbmdlX3NhdmUpOwoKCQkJCQkkLmFkZChjb250YWluZXIsIG4xID0gJC5saW5rKCIjIiwgInhsLXNldHRpbmdzLWJ1dHRvbiIgKyB0aGVtZSkpOwoJCQkJCSQuYWRkKG4xLCAkLm5vZGUoInNwYW4iLCAieGwtc2V0dGluZ3MtYnV0dG9uLXRleHQiLCAiQ2xvc2UiKSk7CgkJCQkJJC5vbihuMSwgImNsaWNrIiwgb25fY2xvc2VfY2xpY2spOwoJCQkJfQoJCQl9XSwgewoJCQkJYm9keTogdHJ1ZSwKCQkJCXBhZGRpbmc6IGZhbHNlLAoJCQkJc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXIpIHsKCQkJCQl2YXIgaSwgaWksIGosIGpqLCBlcnIsIG4xLCBuMiwgbGluZXM7CgoJCQkJCWNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJ4bC1jb21wYXRpYmlsaXR5LXdhcm5pbmdzIik7CgoJCQkJCWZvciAoaSA9IDAsIGlpID0gZXJyb3JzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHsKCQkJCQkJZXJyID0gZXJyb3JzW2ldOwoKCQkJCQkJbjEgPSAkLm5vZGUoImRpdiIsICJ4bC1jb21wYXRpYmlsaXR5LXdhcm5pbmciICsgdGhlbWUpOwoJCQkJCQkkLmFkZChjb250YWluZXIsIG4xKTsKCgkJCQkJCSQuYWRkKG4xLCAkLm5vZGUoImRpdiIsICJ4bC1jb21wYXRpYmlsaXR5LXdhcm5pbmctdGl0bGUiICsgdGhlbWUsIGVyci50aXRsZSkpOwoKCQkJCQkJJC5hZGQobjEsIChuMiA9ICQubm9kZSgiZGl2IiwgInhsLWNvbXBhdGliaWxpdHktd2FybmluZy1jb250ZW50IiArIHRoZW1lKSkpOwoJCQkJCQlsaW5lcyA9IGVyci5kZXNjcmlwdGlvbi5zcGxpdCgiXG4iKTsKCQkJCQkJZm9yIChqID0gMCwgamogPSBsaW5lcy5sZW5ndGg7IGogPCBqajsgKytqKSB7CgkJCQkJCQlpZiAoaiA+IDApIHsKCQkJCQkJCQkkLmFkZChuMiwgJC5ub2RlX3NpbXBsZSgiYnIiKSk7CgkJCQkJCQl9CgkJCQkJCQkkLmFkZChuMiwgJC50bm9kZShsaW5lc1tqXSkpOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9XSk7CgoJCQkkLm9uKHBvcHVwLCAiY2xpY2siLCBvbl9jbG9zZV9jbGljayk7CgkJCVBvcHVwLm9wZW4ocG9wdXApOwoJCX07CgoJCS8vIFB1YmxpYwoJCXZhciBpbml0ID0gZnVuY3Rpb24gKCkgewoJCQl2YXIgdCA9IERlYnVnLnRpbWVyX2xvZygiaW5pdC5wcmUgZHVyYXRpb24iLCB0aW1pbmcuc3RhcnQpOwoJCQlDb25maWcuaW5pdCgpOwoJCQlEZWJ1Zy5pbml0KCk7CgkJCWlmIChNb2R1bGUudmVyc2lvbl9jaGFuZ2UgIT09IDAgJiYgTW9kdWxlLnZlcnNpb25fY2hhbmdlICE9PSAyKSB7CgkJCQlEZWJ1Zy5sb2coIkNsZWFyaW5nIGNhY2hlIG9uIHZlcnNpb24gY2hhbmdlIik7CgkJCQlBUEkuY2FjaGVfY2xlYXIoKTsKCQkJfQoJCQlBUEkuaW5pdCgpOwoJCQlVSS5pbml0KCk7CgkJCVNhdWNlLmluaXQoKTsKCQkJRXh0ZW5zaW9uQVBJLmluaXQoKTsKCQkJRGVidWcubG9nKHRbMF0sIHRbMV0pOwoJCQlEZWJ1Zy50aW1lcl9sb2coImluaXQgZHVyYXRpb24iLCB0aW1pbmcuc3RhcnQpOwoKCQkJLy8gVGltZW91dCBoZWxwcyBnaXZlIHRpbWUgZm9yIGFuIGV4dGVuc2lvbiB0byBzaWduYWwgaXQgd2FudHMgdG8gYmUgbG9hZGVkLiAoVmlvbGVudG1vbmtleSkKCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CgkJCQkkLnJlYWR5KG9uX3JlYWR5KTsKCQkJfSwgMSk7CgkJfTsKCQl2YXIgdmVyc2lvbl9jb21wYXJlID0gZnVuY3Rpb24gKHYxLCB2MikgewoJCQkvLyBSZXR1cm5zOiAtMSBpZiB2MTx2MiwgMCBpZiB2MT09djIsIDEgaWYgdjE+djIKCQkJdmFyIGlpID0gTWF0aC5taW4odjEubGVuZ3RoLCB2Mi5sZW5ndGgpLAoJCQkJaSwgeCwgeTsKCgkJCWZvciAoaSA9IDA7IGkgPCBpaTsgKytpKSB7CgkJCQl4ID0gdjFbaV07CgkJCQl5ID0gdjJbaV07CgkJCQlpZiAoeCA8IHkpIHJldHVybiAtMTsKCQkJCWlmICh4ID4geSkgcmV0dXJuIDE7CgkJCX0KCgkJCWlpID0gdjEubGVuZ3RoOwoJCQl5ID0gdjIubGVuZ3RoOwoJCQlpZiAoaWkgPT09IHkpIHJldHVybiAwOwoKCQkJaWYgKGlpID4geSkgewoJCQkJeSA9IDE7CgkJCX0KCQkJZWxzZSB7CgkJCQlpaSA9IHk7CgkJCQl2MSA9IHYyOwoJCQkJeSA9IC0xOwoJCQl9CgoJCQlmb3IgKDsgaSA8IGlpOyArK2kpIHsKCQkJCXggPSB2MVtpXTsKCQkJCWlmICh4IDwgMCkgcmV0dXJuIC15OwoJCQkJaWYgKHggPiAwKSByZXR1cm4geTsKCQkJfQoKCQkJcmV0dXJuIDA7CgkJfTsKCQl2YXIgaW5zZXJ0X2N1c3RvbV9mb250cyA9IGZ1bmN0aW9uICgpIHsKCQkJaWYgKGZvbnRzX2luc2VydGVkKSByZXR1cm47CgkJCWZvbnRzX2luc2VydGVkID0gdHJ1ZTsKCgkJCWlmICghY29uZmlnLmdlbmVyYWwuZXh0ZXJuYWxfcmVzb3VyY2VzKSByZXR1cm47CgoJCQl2YXIgZm9udCA9ICQubm9kZV9zaW1wbGUoImxpbmsiKTsKCQkJZm9udC5yZWwgPSAic3R5bGVzaGVldCI7CgkJCWZvbnQudHlwZSA9ICJ0ZXh0L2NzcyI7CgkJCWZvbnQuaHJlZiA9ICIvL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9U291cmNlK1NhbnMrUHJvOjkwMCI7CgkJCSQuYWRkKGRvY3VtZW50LmhlYWQsIGZvbnQpOwoJCX07CgkJdmFyIHN0YXJ0X3Byb2Nlc3NpbmcgPSBmdW5jdGlvbiAoZGVmZXIpIHsKCQkJaWYgKHByb2Nlc3Npbmdfc3RhcnRlZCB8fCAhcmVhZHkpIHJldHVybjsKCgkJCS8vIFN0b3AgdGltZXIKCQkJaWYgKHByb2Nlc3Npbmdfc3RhcnRfdGltZXIgIT09IG51bGwpIHsKCQkJCWNsZWFyVGltZW91dChwcm9jZXNzaW5nX3N0YXJ0X3RpbWVyKTsKCQkJCXByb2Nlc3Npbmdfc3RhcnRfdGltZXIgPSBudWxsOwoJCQl9CgoJCQlpZiAoZGVmZXIpIHsKCQkJCS8vIFdhaXQKCQkJCXByb2Nlc3Npbmdfc3RhcnRfdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKCQkJCQlwcm9jZXNzaW5nX3N0YXJ0X3RpbWVyID0gbnVsbDsKCQkJCQlzdGFydF9wcm9jZXNzaW5nKGZhbHNlKTsKCQkJCX0sIDEwMDAwKTsKCQkJfQoJCQllbHNlIHsKCQkJCS8vIFN0YXJ0IHByb2Nlc3NpbmcKCQkJCXByb2Nlc3Npbmdfc3RhcnRlZCA9IHRydWU7CgoJCQkJTGlua2lmaWVyLnF1ZXVlX3Bvc3RzKFBvc3QuZ2V0X2FsbF9wb3N0cyhkb2N1bWVudCksIExpbmtpZmllci5xdWV1ZV9wb3N0cy5GbGFncy5Vc2VEZWxheSk7CgoJCQkJaWYgKENvbmZpZy5keW5hbWljKSB7CgkJCQkJdmFyIHVwZGF0ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihvbl9ib2R5X29ic2VydmUpOwoJCQkJCXVwZGF0ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTsKCQkJCX0KCQkJfQoJCX07CgoJCS8vIEV4cG9ydHMKCQl2YXIgTW9kdWxlID0gewoJCQl0aXRsZTogIlgtbGlua3MiLAoJCQlob21lcGFnZTogImh0dHBzOi8vZG5zZXYtaC5naXRodWIuaW8veC1saW5rcy8iLAoJCQlzdXBwb3J0X3VybDogImh0dHBzOi8vZ2l0aHViLmNvbS9kbnNldi1oL3gtbGlua3MvaXNzdWVzIiwKCQkJdmVyc2lvbjogWzEsMiw4LDI2XSwKCQkJdmVyc2lvbl9jaGFuZ2U6IDAsCgkJCWluaXQ6IGluaXQsCgkJCXZlcnNpb25fY29tcGFyZTogdmVyc2lvbl9jb21wYXJlLAoJCQlpbnNlcnRfY3VzdG9tX2ZvbnRzOiBpbnNlcnRfY3VzdG9tX2ZvbnRzLAoJCQlzdGFydF9wcm9jZXNzaW5nOiBzdGFydF9wcm9jZXNzaW5nCgkJfTsKCgkJcmV0dXJuIE1vZHVsZTsKCgl9KSgpOwoKCU1haW4uaW5pdCgpOwoJRGVidWcudGltZXJfbG9nKCJpbml0LmZ1bGwgZHVyYXRpb24iLCB0aW1pbmcuc3RhcnQpOwoKfSkuY2FsbCh0aGlzLCB3aW5kb3cpOwoK"},{"name":"Download github repo sub-folder","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["raw.githubusercontent.com"],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://github.com/*","https://gist.github.com/*"],"orig_noframes":true,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609796829664,"data":{}},"enabled":true,"position":5,"file_url":"https://greasyfork.org/scripts/411834-download-github-repo-sub-folder/code/Download%20github%20repo%20sub-folder.user.js","uuid":"13509e24-4b9e-4873-802e-3d1ca38011ca","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgRG93bmxvYWQgZ2l0aHViIHJlcG8gc3ViLWZvbGRlcgovLyBAdmVyc2lvbiAwLjIuMwovLyBAYXV0aG9yIFNhaXlhCi8vIEBkZXNjcmlwdGlvbiBkb3dubG9hZCBnaXRodWIgc3ViLWZvbGRlciB2aWEgb25lIGNsaWNrLCBjb3B5IHRoZSBzaW5nbGUgZmlsZSdzIHNvdXJjZSBjb2RlIGVhc2lseQovLyBAc3VwcG9ydFVSTCBodHRwczovL2dpdGh1Yi5jb20vb2UvZG93bmxvYWQtZ2l0LXVzZXJzY3JpcHQvaXNzdWVzCi8vIEBtYXRjaCBodHRwczovL2dpdGh1Yi5jb20vKgovLyBAbWF0Y2ggaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vKgovLyBAbmFtZTp6aC1DTiDlnKjnur/kuIvovb1HaXRodWLku5PlupPmlofku7blpLkKLy8gQG5hbWVzcGFjZSBodHRwczovL2FwcC5ldmVjYWxtLmNvbQovLyBAZGVzY3JpcHRpb246emgtQ04g5peg6ZyA5YWL6ZqGR2l0SHVi5LuT5bqTLCDkuIDplK7lnKjnur/kuIvovb0gR2l0aHVi5LuT5bqT5a2Q5paH5Lu25aS5OyDlkIzml7bov5jog73lnKjmupDnoIHor6bmg4XpobXkuIDplK7lpI3liLbmupDnoIEuCi8vIEBob21lcGFnZVVSTCBodHRwczovL2dpdGh1Yi5jb20vb2UvZG93bmxvYWQtZ2l0LXVzZXJzY3JpcHQKLy8gQGNvbm5lY3QgcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbQovLyBAZ3JhbnQgR01fZG93bmxvYWQKLy8gQGdyYW50IEdNX3htbGh0dHBSZXF1ZXN0Ci8vIEBncmFudCBHTV9zZXRDbGlwYm9hcmQKLy8gQG5vZnJhbWVzIAovLyA9PS9Vc2VyU2NyaXB0PT0KCiFmdW5jdGlvbihlKXt2YXIgdD17fTtmdW5jdGlvbiBuKG8pe2lmKHRbb10pcmV0dXJuIHRbb10uZXhwb3J0czt2YXIgcj10W29dPXtpOm8sbDohMSxleHBvcnRzOnt9fTtyZXR1cm4gZVtvXS5jYWxsKHIuZXhwb3J0cyxyLHIuZXhwb3J0cyxuKSxyLmw9ITAsci5leHBvcnRzfW4ubT1lLG4uYz10LG4uZD1mdW5jdGlvbihlLHQsbyl7bi5vKGUsdCl8fE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse2VudW1lcmFibGU6ITAsZ2V0Om99KX0sbi5yPWZ1bmN0aW9uKGUpeyJ1bmRlZmluZWQiIT10eXBlb2YgU3ltYm9sJiZTeW1ib2wudG9TdHJpbmdUYWcmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLFN5bWJvbC50b1N0cmluZ1RhZyx7dmFsdWU6Ik1vZHVsZSJ9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSl9LG4udD1mdW5jdGlvbihlLHQpe2lmKDEmdCYmKGU9bihlKSksOCZ0KXJldHVybiBlO2lmKDQmdCYmIm9iamVjdCI9PXR5cGVvZiBlJiZlJiZlLl9fZXNNb2R1bGUpcmV0dXJuIGU7dmFyIG89T2JqZWN0LmNyZWF0ZShudWxsKTtpZihuLnIobyksT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sImRlZmF1bHQiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOmV9KSwyJnQmJiJzdHJpbmciIT10eXBlb2YgZSlmb3IodmFyIHIgaW4gZSluLmQobyxyLGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfS5iaW5kKG51bGwscikpO3JldHVybiBvfSxuLm49ZnVuY3Rpb24oZSl7dmFyIHQ9ZSYmZS5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIGUuZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gZX07cmV0dXJuIG4uZCh0LCJhIix0KSx0fSxuLm89ZnVuY3Rpb24oZSx0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCl9LG4ucD0iIixuKG4ucz0xKX0oW2Z1bmN0aW9uKGUsdCxuKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbygpe3JldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmF3LXVybCIpfU9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx0Lm9wZW5MaW5rPXQuZ2V0Q3VycmVudFVybFBhdGg9dC5nZXRSYXdCdG49dC5nZXRVcmxUZXh0UmVzcG9uc2U9dC5pc1RleHRCYXNlZFNpbmdsZVBhZ2U9dC5pc1JlcG9Sb290RGlyPXQuaXNQcml2YXRlUmVwbz10LmlzUmVwbz10LmlzR2lzdD12b2lkIDAsdC5pc0dpc3Q9ZnVuY3Rpb24oKXtyZXR1cm4iZ2lzdC5naXRodWIuY29tIj09PWxvY2F0aW9uLmhvc3RuYW1lfSx0LmlzUmVwbz1mdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIucmVwb3NpdG9yeS1jb250ZW50Iil9LHQuaXNQcml2YXRlUmVwbz1mdW5jdGlvbigpe2NvbnN0IGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2pzLXJlcG8tcGpheC1jb250YWluZXIgLmhpZGUtZnVsbC1zY3JlZW4gLkxhYmVsIik7cmV0dXJuIGUmJiJQcml2YXRlIj09PWUudGV4dENvbnRlbnR9LHQuaXNSZXBvUm9vdERpcj1mdW5jdGlvbigpe3JldHVybiEhZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnJlcG9zaXRvcnktY29udGVudCAgZ2V0LXJlcG8iKX0sdC5pc1RleHRCYXNlZFNpbmdsZVBhZ2U9ZnVuY3Rpb24oKXtpZighbygpKXJldHVybjtyZXR1cm4hIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJyZWFkbWUiKXx8ISFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJ0YWJsZS5oaWdobGlnaHQiKX0sdC5nZXRVcmxUZXh0UmVzcG9uc2U9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBQcm9taXNlKCh0LG4pPT57R01feG1saHR0cFJlcXVlc3Qoe21ldGhvZDoiR0VUIix1cmw6ZSxvbnRpbWVvdXQ6bixvbmFib3J0Om4sb25lcnJvcjpuLG9ubG9hZDplPT57ZS5yZXNwb25zZVRleHQ/dChlLnJlc3BvbnNlVGV4dCk6bihlKX19KX0pfSx0LmdldFJhd0J0bj1vLHQuZ2V0Q3VycmVudFVybFBhdGg9ZnVuY3Rpb24oKXtyZXR1cm4obG9jYXRpb24ub3JpZ2luK2xvY2F0aW9uLnBhdGhuYW1lKS5yZXBsYWNlKC9cLyQvLCIiKX0sdC5vcGVuTGluaz1mdW5jdGlvbihlKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTt0LnRhcmdldD0iX2JsYW5rIix0LmhyZWY9ZSx0LmNsaWNrKCl9fSxmdW5jdGlvbihlLHQsbil7InVzZSBzdHJpY3QiO3ZhciBvPXRoaXMmJnRoaXMuX19jcmVhdGVCaW5kaW5nfHwoT2JqZWN0LmNyZWF0ZT9mdW5jdGlvbihlLHQsbixvKXt2b2lkIDA9PT1vJiYobz1uKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxvLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiB0W25dfX0pfTpmdW5jdGlvbihlLHQsbixvKXt2b2lkIDA9PT1vJiYobz1uKSxlW29dPXRbbl19KSxyPXRoaXMmJnRoaXMuX19zZXRNb2R1bGVEZWZhdWx0fHwoT2JqZWN0LmNyZWF0ZT9mdW5jdGlvbihlLHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCJkZWZhdWx0Iix7ZW51bWVyYWJsZTohMCx2YWx1ZTp0fSl9OmZ1bmN0aW9uKGUsdCl7ZS5kZWZhdWx0PXR9KSxpPXRoaXMmJnRoaXMuX19pbXBvcnRTdGFyfHxmdW5jdGlvbihlKXtpZihlJiZlLl9fZXNNb2R1bGUpcmV0dXJuIGU7dmFyIHQ9e307aWYobnVsbCE9ZSlmb3IodmFyIG4gaW4gZSkiZGVmYXVsdCIhPT1uJiZPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmbyh0LGUsbik7cmV0dXJuIHIodCxlKSx0fTtPYmplY3QuZGVmaW5lUHJvcGVydHkodCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSk7Y29uc3QgdT1pKG4oMCkpLGM9bigwKTshZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7dS5pc1JlcG8oKSYmKGZ1bmN0aW9uKCl7bGV0IGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiLnJlcG9zaXRvcnktY29udGVudCAuZmlsZS1uYXZpZ2F0aW9uIik7aWYoZSl7Y29uc3Qgbj10KGUpO3JldHVybiBuLmNsYXNzTmFtZSs9IiBtbC0yIix2b2lkIGUuYXBwZW5kQ2hpbGQobil9Y29uc3Qgbj1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjYmxvYi1tb3JlLW9wdGlvbnMtZGV0YWlscyIpO2lmKCFuKXJldHVybjtlPW4ucGFyZW50RWxlbWVudDtjb25zdCBvPXQoZSk7by5jbGFzc05hbWUrPSIgbXItMiIsbi5pbnNlcnRBZGphY2VudEVsZW1lbnQoImJlZm9yZWJlZ2luIixvKX0oKSxmdW5jdGlvbigpe2lmKCF1LmlzVGV4dEJhc2VkU2luZ2xlUGFnZSgpfHxkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgieGl1LWNvcHktYnRuIikpcmV0dXJuO2NvbnN0IGU9Yy5nZXRSYXdCdG4oKSx0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImEiKTt0LnNldEF0dHJpYnV0ZSgicm9sZSIsImJ1dHRvbiIpLHQuY2xhc3NOYW1lPSJidG4gYnRuLXNtIEJ0bkdyb3VwLWl0ZW0iLHQuaHJlZj0iIyIsdC5pZD0ieGl1LWNvcHktYnRuIix0LnRleHRDb250ZW50PSJDb3B5Iix0Lm9uY2xpY2s9YXN5bmMgdD0+e3QucHJldmVudERlZmF1bHQoKTt0cnl7Y29uc3QgdD1hd2FpdCB1LmdldFVybFRleHRSZXNwb25zZShlLmhyZWYpO0dNX3NldENsaXBib2FyZCh0KX1jYXRjaChlKXtjb25zb2xlLndhcm4oZSl9fSxlLmluc2VydEFkamFjZW50RWxlbWVudCgiYmVmb3JlYmVnaW4iLHQpfSgpKX1mdW5jdGlvbiB0KGUpe2xldCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ4aXUtZG93bmxvYWQtYnRuIik7dHx8KHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpLHQuaWQ9InhpdS1kb3dubG9hZC1idG4iKSx0LmNsYXNzTmFtZT0iYnRuIGQtbm9uZSBkLW1kLWJsb2NrIix0LnRhcmdldD0iX2JsYW5rIjtsZXQgbj0iIjtpZih1LmlzUmVwb1Jvb3REaXIoKSl7bj1lLnF1ZXJ5U2VsZWN0b3IoJ2dldC1yZXBvIGFbaHJlZiQ9Ii56aXAiXScpLmhyZWZ9ZWxzZSBpZih1LmdldFJhd0J0bigpKXtjb25zdCBlPXUuZ2V0UmF3QnRuKCk7bj1lLmhyZWYsdC5vbmNsaWNrPWZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKTtjb25zdCBuPWUuaHJlZi5zcGxpdCgiLyIpLnBvcCgpO0dNX2Rvd25sb2FkKHt1cmw6ZS5ocmVmLG5hbWU6bixvbmVycm9yOmU9Pntjb25maXJtKGUuZXJyb3IrYDogeW91IG1heSBuZWVkIGFkZCBleHRlbnNpb24gIi4ke24uc3BsaXQoIi4iKS5wb3AoKX0iIHRvIFRhbXBlcm1vbmtleSdzIHdoaXRlbGlzdC4gQ2xpY2sgT0sgdG8gc2VlIGhvdy5gKSYmdS5vcGVuTGluaygiaHR0cHM6Ly9naXRodWIuY29tL29lL2Rvd25sb2FkLWdpdC11c2Vyc2NyaXB0I2NvbmZpZ3VyZS10aGUtc2NyaXB0LW1hbmFnZXIiKX19KX19ZWxzZSBuPSJodHRwczovL21pbmhhc2thbWFsLmdpdGh1Yi5pby9Eb3duR2l0LyMvaG9tZT91cmw9IitlbmNvZGVVUklDb21wb25lbnQodS5nZXRDdXJyZW50VXJsUGF0aCgpKTtyZXR1cm4gdC50ZXh0Q29udGVudD0iRG93bmxvYWQiLHQuaHJlZj1uLHR9ZSgpLGZ1bmN0aW9uKCl7bGV0IHQ7dD11LmlzR2lzdCgpP2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIiNnaXN0LXBqYXgtY29udGFpbmVyIik6ZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2pzLXJlcG8tcGpheC1jb250YWluZXIiKTtpZighdClyZXR1cm47bmV3IE11dGF0aW9uT2JzZXJ2ZXIoKGZ1bmN0aW9uKHQpe2NvbnNvbGUubG9nKCJtdXRhdGlvbiBjaGFuZ2UiLHQpLGUoKX0pKS5vYnNlcnZlKHQse2NoaWxkTGlzdDohMCxzdWJ0cmVlOiExfSl9KCl9KCl9XSk7"},{"name":"Wide Github","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["*github.com*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609796864157,"data":{}},"enabled":true,"position":6,"file_url":"https://openuserjs.org/install/xthexder/Wide_Github.user.js","uuid":"0f460ba1-a59f-49b9-bb83-c0e2e1660e66","source":"InVzZSBzdHJpY3QiOwoKLy8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFdpZGUgR2l0aHViCi8vIEBuYW1lc3BhY2UgICBodHRwczovL2dpdGh1Yi5jb20veHRoZXhkZXIvd2lkZS1naXRodWIKLy8gQGRlc2NyaXB0aW9uIENoYW5nZSBhbGwgR2l0aHViIHJlcG9zaXRvcnkgYW5kIGdpc3QgcGFnZXMgdG8gYmUgZnVsbCB3aWR0aCBhbmQgZHluYW1pY2FsbHkgc2l6ZWQuCi8vIEBhdXRob3IgICAgICB4dGhleGRlcgovLyBAY29weXJpZ2h0ICAgMjAxMyssIHh0aGV4ZGVyIChodHRwczovL2dpdGh1Yi5jb20veHRoZXhkZXIpCi8vIEBjb250cmlidXRvciBKYXNvbiBGcmV5IChodHRwczovL2dpdGh1Yi5jb20vRnJ5Z3V5KQovLyBAY29udHJpYnV0b3IgTWFydGkgTWFydHogKGh0dHBzOi8vZ2l0aHViLmNvbS9NYXJ0aWkpCi8vIEBjb250cmlidXRvciBQYXVsICJKb2V5IiBDbGFyayAoaHR0cHM6Ly9naXRodWIuY29tL2pvZXl0d2lkZGxlKQovLyBAY29udHJpYnV0b3IgUm9iZXJ0IExhdmVydHkgKGh0dHBzOi8vZ2l0aHViLmNvbS9yb2JsYXY5NikKLy8gQGxpY2Vuc2UgICAgIE1JVDsgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3h0aGV4ZGVyL3dpZGUtZ2l0aHViL21hc3Rlci9MSUNFTlNFCi8vIEB2ZXJzaW9uICAgICAxLjQuMQovLyBAaWNvbiAgICAgICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3h0aGV4ZGVyL3dpZGUtZ2l0aHViL21hc3Rlci9pY29uLnBuZwovLyBAaG9tZXBhZ2VVUkwgaHR0cHM6Ly9naXRodWIuY29tL3h0aGV4ZGVyL3dpZGUtZ2l0aHViCi8vIEBzdXBwb3J0VVJMICBodHRwczovL2dpdGh1Yi5jb20veHRoZXhkZXIvd2lkZS1naXRodWIvaXNzdWVzCi8vIEBpbmNsdWRlICAgICAqZ2l0aHViLmNvbSoKLy8gQGdyYW50ICAgICAgIG5vbmUKLy8gPT0vVXNlclNjcmlwdD09Cgp2YXIgc3R5bGVTaGVldCA9ICIiICsKImJvZHk6bm90KC53Z2gtZGlzYWJsZWQpIC5hcHBsaWNhdGlvbi1tYWluIC5jb250YWluZXIgeyIgKwogICJ3aWR0aDogYXV0byAhaW1wb3J0YW50OyIgKwogICJwYWRkaW5nLWxlZnQ6IDE2cHggIWltcG9ydGFudDsiICsKICAicGFkZGluZy1yaWdodDogMTZweCAhaW1wb3J0YW50OyIgKwogICJtYXJnaW4tbGVmdDogMHB4ICFpbXBvcnRhbnQ7IiArCiAgIm1pbi13aWR0aDogOTgwcHg7IiArCiJ9IiArCiJib2R5Om5vdCgud2doLWRpc2FibGVkKSAuYXBwbGljYXRpb24tbWFpbiAuY29udGFpbmVyLWxnLCIgKwoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLmZvb3Rlci5jb250YWluZXItbGcgeyIgKwogICJtYXgtd2lkdGg6IG5vbmUgIWltcG9ydGFudDsiICsKICAibWFyZ2luLWxlZnQ6IDBweCAhaW1wb3J0YW50OyIgKwoifSIgKwoKLy8gRmxvYXRpbmcgUFIgdG9vbGJhcgoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLnByLXRvb2xiYXIgeyIgKwogICJtYXJnaW4tbGVmdDogLTE2cHggIWltcG9ydGFudDsiICsKICAibWFyZ2luLXJpZ2h0OiAtMTZweCAhaW1wb3J0YW50OyIgKwogICJwYWRkaW5nLWxlZnQ6IDE2cHggIWltcG9ydGFudDsiICsKICAicGFkZGluZy1yaWdodDogMTZweCAhaW1wb3J0YW50OyIgKwoifSIgKwoKLy8gUmVwb3NpdG9yeSBJc3N1ZXMKImJvZHk6bm90KC53Z2gtZGlzYWJsZWQpICNqcy1yZXBvLXBqYXgtY29udGFpbmVyIC5yZXBvc2l0b3J5LWNvbnRlbnQgLmRpc2N1c3Npb24tdGltZWxpbmUgeyIgKyAgLy8gSXNzdWUgYm9keQogICJ3aWR0aDogMTAwJSAhaW1wb3J0YW50OyIgKwoifSIgKwoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLnJlcG9zaXRvcnktY29udGVudCAudGltZWxpbmUtbmV3LWNvbW1lbnQgeyIgKyAvLyBOZXcgSXNzdWUgLyBpc3N1ZSBjb21tZW50IGZvcm0KICAibWF4LXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7IiArCiJ9IiArCiJib2R5Om5vdCgud2doLWRpc2FibGVkKSAucmVwb3NpdG9yeS1jb250ZW50IC5pbmxpbmUtY29tbWVudHMgLmNvbW1lbnQtaG9sZGVyLCIgKyAvLyBEaWZmIC8gY29kZSBjb21tZW50cwoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLnJlcG9zaXRvcnktY29udGVudCAuaW5saW5lLWNvbW1lbnRzIC5pbmxpbmUtY29tbWVudC1mb3JtLWNvbnRhaW5lciwiICsKImJvZHk6bm90KC53Z2gtZGlzYWJsZWQpIC5yZXBvc2l0b3J5LWNvbnRlbnQgLmlubGluZS1jb21tZW50cyAuaW5saW5lLWNvbW1lbnQtZm9ybSwiICsKImJvZHk6bm90KC53Z2gtZGlzYWJsZWQpIC5yZXBvc2l0b3J5LWNvbnRlbnQgI2FsbF9jb21taXRfY29tbWVudHMgLmNvbW1pdC1jb21tZW50cy1oZWFkaW5nLCIgKwoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLnJlcG9zaXRvcnktY29udGVudCAjYWxsX2NvbW1pdF9jb21tZW50cyAuY29tbWVudC1ob2xkZXIgeyIgKwogICJtYXgtd2lkdGg6IGluaGVyaXQgIWltcG9ydGFudDsiICsKIn0iICsKCi8vIFJlcG9zaXRvcnkgZ3JhcGggcGFnZQoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLnJlcG9zaXRvcnktY29udGVudCAuY2FwcGVkLWNhcmQtY29udGVudCB7IiArIC8vIEdyYXBoIGNhcmRzIG9uIGNvbnRyaWJ1dG9ycyAvIGdyYXBoIGxpc3QKICAid2lkdGg6IDEwMCUgIWltcG9ydGFudDsiICsKIn0iICsKCi8vIEdpc3RzCiJib2R5Om5vdCgud2doLWRpc2FibGVkKSAuZ2lzdC1jb250ZW50LXdyYXBwZXIgLmNvbnRhaW5lciB7IiArCiAgIndpZHRoOiBhdXRvICFpbXBvcnRhbnQ7IiArCiAgIm1hcmdpbi1sZWZ0OiAyMHB4ICFpbXBvcnRhbnQ7IiArCiAgIm1hcmdpbi1yaWdodDogMjBweCAhaW1wb3J0YW50OyIgKwogICJtaW4td2lkdGg6IDk4MHB4OyIgKwoifSIgKwoiYm9keTpub3QoLndnaC1kaXNhYmxlZCkgLmdpc3QtY29udGVudC13cmFwcGVyIC5jb250YWluZXItbGcgeyIgKwogICJtYXgtd2lkdGg6IG5vbmUgIWltcG9ydGFudDsiICsKIn0iICsKImJvZHk6bm90KC53Z2gtZGlzYWJsZWQpIC5naXN0LWNvbnRlbnQtd3JhcHBlciAuY29udGFpbmVyLWxnIC5oLWNhcmQgeyIgKwogICJ3aWR0aDogMjUzcHggIWltcG9ydGFudDsiICsKIn0iICsKCiIiOwoKKGZ1bmN0aW9uICgpIHsKICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgcy50eXBlID0gInRleHQvY3NzIjsKICBzLmlubmVySFRNTCA9IHN0eWxlU2hlZXQ7CiAgKGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChzKTsKfSkoKTsK"},{"name":"Stack Overflow Extras (SOX)","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":["*://data.stackexchange.com/*","*://api.stackexchange.com/*","*://stackoverflow.com/c/*"],"orig_includes":[],"orig_matches":["https://*.stackoverflow.com/*","https://*.stackexchange.com/*","https://*.superuser.com/*","https://*.serverfault.com/*","https://*.askubuntu.com/*","https://*.stackapps.com/*","https://*.mathoverflow.net/*","*://github.com/soscripted/*","*://soscripted.github.io/sox/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{"SOX-accessToken":"n-2","SOX-lastVersionInstalled":"s2.7.0"},"ts":1609797278872},"enabled":true,"position":7,"file_url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.user.js","uuid":"93a1a13c-b07c-4ba0-b34b-32c47dd780fc","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBTdGFjayBPdmVyZmxvdyBFeHRyYXMgKFNPWCkKLy8gQG5hbWVzcGFjZSAgICBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gKLy8gQGhvbWVwYWdlICAgICBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gKLy8gQGhvbWVwYWdlVVJMICBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gKLy8gQHZlcnNpb24gICAgICAyLjcuMAovLyBAZGVzY3JpcHRpb24gIEV4dHJhIG9wdGlvbmFsIGZlYXR1cmVzIGZvciBTdGFjayBPdmVyZmxvdyBhbmQgU3RhY2sgRXhjaGFuZ2Ugc2l0ZXMKLy8gQGNvbnRyaWJ1dG9yICDhtInKnnXHnSAoaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS91c2Vycy8xNDU0NTM4LywgaHR0cHM6Ly9naXRodWIuY29tL21lem1pKQovLyBAY29udHJpYnV0b3IgIOGUleGWuuGYjuGViiAoaHR0cHM6Ly9zdGFja2V4Y2hhbmdlLmNvbS91c2Vycy80MzM3ODEwLywgaHR0cHM6Ly9naXRodWIuY29tL3NodTgpCi8vIEBjb250cmlidXRvciAgU2lyLUN1bWZlcmVuY2UgKGh0dHBzOi8vc3RhY2tleGNoYW5nZS5jb20vdXNlcnMvNDExOTE0Mi8sIGh0dHBzOi8vZ2l0aHViLmNvbS9TaXItQ3VtZmVyZW5jZSkKLy8gQGNvbnRyaWJ1dG9yICBHYXVyYW5nVGFuZG9uIChodHRwczovL2dpdGh1Yi5jb20vR2F1cmFuZ1RhbmRvbikKLy8gQGNvbnRyaWJ1dG9yICBkb3VibGUtYmVlcCAoaHR0cHM6Ly9zdGFja2V4Y2hhbmdlLmNvbS91c2Vycy8xNDY4ODQzNy9kb3VibGUtYmVlcCwgaHR0cHM6Ly9naXRodWIuY29tL2RvdWJsZS1iZWVwKQovLyBAdXBkYXRlVVJMICAgIGh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zb3NjcmlwdGVkL3NveEBkZXYvc294LnVzZXIuanMKCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly8qLnN0YWNrb3ZlcmZsb3cuY29tLyoKLy8gQG1hdGNoICAgICAgICBodHRwczovLyouc3RhY2tleGNoYW5nZS5jb20vKgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vKi5zdXBlcnVzZXIuY29tLyoKLy8gQG1hdGNoICAgICAgICBodHRwczovLyouc2VydmVyZmF1bHQuY29tLyoKLy8gQG1hdGNoICAgICAgICBodHRwczovLyouYXNrdWJ1bnR1LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly8qLnN0YWNrYXBwcy5jb20vKgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vKi5tYXRob3ZlcmZsb3cubmV0LyoKLy8gQG1hdGNoICAgICAgICAqOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkLyoKLy8gQG1hdGNoICAgICAgICAqOi8vc29zY3JpcHRlZC5naXRodWIuaW8vc294LyoKCi8vIEBleGNsdWRlICAgICAgKjovL2RhdGEuc3RhY2tleGNoYW5nZS5jb20vKgovLyBAZXhjbHVkZSAgICAgICo6Ly9hcGkuc3RhY2tleGNoYW5nZS5jb20vKgovLyBAZXhjbHVkZSAgICAgICo6Ly9zdGFja292ZXJmbG93LmNvbS9jLyoKCi8vIEByZXF1aXJlICAgICAgaHR0cHM6Ly9jb2RlLmpxdWVyeS5jb20vanF1ZXJ5LTMuMy4xLm1pbi5qcwovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vY29kZS5qcXVlcnkuY29tL3VpLzEuMTIuMS9qcXVlcnktdWkubWluLmpzCi8vIEByZXF1aXJlICAgICAgaHR0cHM6Ly9hcGkuc3RhY2tleGNoYW5nZS5jb20vanMvMi4wL2FsbC5qcwovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pxdWVyeS10aW1lYWdvLzEuNS4zL2pxdWVyeS50aW1lYWdvLm1pbi5qcwoKLy8gQHJlcXVpcmUgICAgICBzb3guY29tbW9uLmpzCi8vIEByZXF1aXJlICAgICAgc294LmdpdGh1Yi5qcwovLyBAcmVxdWlyZSAgICAgIHNveC5kaWFsb2cuanMKLy8gQHJlcXVpcmUgICAgICBzb3guZmVhdHVyZXMuanMKCi8vIEByZXNvdXJjZSAgICAgY3NzIHNveC5jc3MKLy8gQHJlc291cmNlICAgICBkaWFsb2cgc294LmRpYWxvZy5odG1sCi8vIEByZXNvdXJjZSAgICAgZmVhdHVyZXNKU09OIHNveC5mZWF0dXJlcy5pbmZvLmpzb24KLy8gQHJlc291cmNlICAgICBjb21tb24gc294LmNvbW1vbi5pbmZvLmpzb24KLy8gQHJlc291cmNlICAgICBzcHJpdGVzIHNveC5zcHJpdGVzLnN2ZwoKLy8gQGdyYW50ICAgICAgICBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgR01fZGVsZXRlVmFsdWUKLy8gQGdyYW50ICAgICAgICBHTV9saXN0VmFsdWVzCi8vIEBncmFudCAgICAgICAgR01fZ2V0UmVzb3VyY2VUZXh0Ci8vIEBncmFudCAgICAgICAgR01fYWRkU3R5bGUKLy8gQGdyYW50ICAgICAgICBHTV9pbmZvCi8vIEBncmFudCAgICAgICAgR01fc2V0Q2xpcGJvYXJkCi8vID09L1VzZXJTY3JpcHQ9PQovKmpzaGludCBsb29wZnVuYzogdHJ1ZSovCihmdW5jdGlvbihzb3gsICQpIHsKICAndXNlIHN0cmljdCc7CgogIGZ1bmN0aW9uIGluaXQoKSB7CiAgICBpZiAoc294LmxvY2F0aW9uLm9uKCdnaXRodWIuY29tL3Nvc2NyaXB0ZWQnKSkgewogICAgICB0cnkgewogICAgICAgIHNveC5naXRodWIuaW5pdChzb3guaW5mby52ZXJzaW9uLCBzb3guaW5mby5oYW5kbGVyKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRocm93ICgnU09YOiBUaGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgYXR0ZW1wdGluZyB0byBpbml0aWFsaXplIHRoZSBzb3guZ2l0aHViLmpzIGZpbGUsIHBsZWFzZSByZXBvcnQgdGhpcyBvbiBHaXRIdWIuXG4nICsgZSk7CiAgICAgIH0KICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChzb3gubG9jYXRpb24ub24oJ3Nvc2NyaXB0ZWQuZ2l0aHViLmlvL3NveC8jYWNjZXNzX3Rva2VuJykpIHsgLy9zYXZlIGFjY2VzcyB0b2tlbgogICAgICB0cnkgewogICAgICAgIGNvbnN0IGFjY2Vzc190b2tlbiA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCc9JylbMV0uc3BsaXQoJyYnKVswXTsKICAgICAgICBzb3gubG9naW5mbygnQUNDRVNTIFRPS0VOOiAnLCBhY2Nlc3NfdG9rZW4pOwogICAgICAgIEdNX3NldFZhbHVlKCdTT1gtYWNjZXNzVG9rZW4nLCBhY2Nlc3NfdG9rZW4pOwogICAgICAgIGFsZXJ0KCdBY2Nlc3MgdG9rZW4gc3VjY2Vzc2Z1bGx5IHNhdmVkISBZb3UgY2FuIGNsb3NlIHRoaXMgd2luZG93IDopJyk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aHJvdyAoJ1NPWDogVGhlcmUgd2FzIGFuIGVycm9yIHNhdmluZyB5b3VyIGFjY2VzcyB0b2tlbicpOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmIChzb3guaW5mby5kZWJ1Z2dpbmcpIHsKICAgICAgc294LmRlYnVnKCdERUJVR0dJTkcgU09YIFZFUlNJT04gJyArIHNveC5pbmZvLnZlcnNpb24pOwogICAgICBzb3guZGVidWcoJy0tLS0tLS0tLS0tLS0tLS1zYXZlZCB2YXJpYWJsZXMtLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTsKICAgICAgc294LnNldHRpbmdzLndyaXRlVG9Db25zb2xlKHRydWUpOyAvL3RydWUgPT4gaGlkZSBhY2Nlc3MgdG9rZW4KICAgICAgc294LmRlYnVnKCctLS0tLS0tLS0tLS0tLS0tZW5kIHNhdmVkIHZhcmlhYmxlcy0tLS0tLS0tLS0tLS0tLS0tLS0tLScpOwogICAgfQoKICAgIGNvbnN0IHNwcml0ZXNEaXYgPSAkKCc8ZGl2Lz4nLCB7IGh0bWw6IEdNX2dldFJlc291cmNlVGV4dCgnc3ByaXRlcycpIH0pOwogICAgJCgnaGVhZCcpLmFwcGVuZChzcHJpdGVzRGl2KTsKCiAgICBHTV9hZGRTdHlsZShHTV9nZXRSZXNvdXJjZVRleHQoJ2NzcycpKTsKCiAgICBjb25zdCBzZXR0aW5ncyA9IHNveC5zZXR0aW5ncy5sb2FkKCk7CiAgICAvL3JldHVybnMgdW5kZWZpbmVkIGlmIG5vdCBzZXQKCiAgICBjb25zdCBmZWF0dXJlSW5mbyA9IEpTT04ucGFyc2UoR01fZ2V0UmVzb3VyY2VUZXh0KCdmZWF0dXJlc0pTT04nKSk7CgogICAgdHJ5IHsKICAgICAgc294LmRlYnVnKCdTT1ggb2JqZWN0Jywgc294KTsKICAgICAgc294LmRpYWxvZy5pbml0KHsKICAgICAgICB2ZXJzaW9uOiBzb3guaW5mby52ZXJzaW9uLAogICAgICAgIGZlYXR1cmVzOiBmZWF0dXJlSW5mbywKICAgICAgICBzZXR0aW5nczogc2V0dGluZ3MsCiAgICAgICAgbGFzdFZlcnNpb25JbnN0YWxsZWQ6IHNveC5pbmZvLmxhc3RWZXJzaW9uSW5zdGFsbGVkLAogICAgICB9KTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdGhyb3cgKCdTT1g6IFRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBhdHRlbXB0aW5nIHRvIGluaXRpYWxpemUgdGhlIFNPWCBTZXR0aW5ncyBEaWFsb2csIHBsZWFzZSByZXBvcnQgdGhpcyBvbiBHaXRIdWIuXG4nICsgZSk7CiAgICB9CgogICAgaWYgKHNveC5zZXR0aW5ncy5hdmFpbGFibGUpIHsKICAgICAgLy8gRXhlY3V0ZSBmZWF0dXJlcwogICAgICBwZXJmb3JtYW5jZS5tYXJrKCdhbGxGZWF0dXJlcy1zdGFydCcpOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNldHRpbmdzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBzZXR0aW5nc1tpXS5zcGxpdCgnLScpWzBdOwogICAgICAgIGNvbnN0IGZlYXR1cmVJZCA9IHNldHRpbmdzW2ldLnNwbGl0KCctJylbMV07CgogICAgICAgIGlmICghKGNhdGVnb3J5IGluIGZlYXR1cmVJbmZvLmNhdGVnb3JpZXMpKSB7IC8vaWYgd2UgZXZlciByZW5hbWUgYSBjYXRlZ29yeQogICAgICAgICAgc294LmxvZ2luZm8oJ0RlbGV0aW5nIGZlYXR1cmUgIicgKyBzZXR0aW5nc1tpXSArICciIChjYXRlZ29yeSByZW5hbWU/KScpOwogICAgICAgICAgc2V0dGluZ3Muc3BsaWNlKGksIDEpOwogICAgICAgICAgc294LnNldHRpbmdzLnNhdmUoc2V0dGluZ3MpOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBmZWF0dXJlID0gZmVhdHVyZUluZm8uY2F0ZWdvcmllc1tjYXRlZ29yeV0uZmlsdGVyKG9iaiA9PiB7CiAgICAgICAgICByZXR1cm4gb2JqLm5hbWUgPT0gZmVhdHVyZUlkOwogICAgICAgIH0pWzBdOwoKICAgICAgICBsZXQgcnVuRmVhdHVyZSA9IHRydWU7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIC8vTk9URTogdGhlcmUgaXMgbm8gZWxzZSBpZigpIGJlY2F1c2UgaXQgaXMgcG9zc2libGUgdG8gaGF2ZSBib3RoIG1hdGNoIGFuZCBleGNsdWRlIHBhdHRlcm5zLi4KICAgICAgICAgIC8vd2hpY2ggY291bGQgaGF2ZSBtaW5vciBleGNlcHRpb25zIG1ha2luZyBpdCBuZWNjZXNzYXJ5IHRvIGNoZWNrIGJvdGgKICAgICAgICAgIGlmIChmZWF0dXJlLm1hdGNoICE9PSAnJykgewogICAgICAgICAgICBjb25zdCBzaXRlcyA9IGZlYXR1cmUubWF0Y2guc3BsaXQoJywnKTsKCiAgICAgICAgICAgIGZvciAobGV0IHBhdHRlcm4gPSAwOyBwYXR0ZXJuIDwgc2l0ZXMubGVuZ3RoOyBwYXR0ZXJuKyspIHsKICAgICAgICAgICAgICBpZiAoIXNveC5sb2NhdGlvbi5tYXRjaFdpdGhQYXR0ZXJuKHNpdGVzW3BhdHRlcm5dKSkgewogICAgICAgICAgICAgICAgcnVuRmVhdHVyZSA9IGZhbHNlOyAvL25vbmUgb2YgdGhlIHBhdHRlcm5zIG1hdGNoIHRoZSBjdXJyZW50IHNpdGUuLiB5ZXQuCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJ1bkZlYXR1cmUgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7IC8vaWYgaXQgZG9lcyBtYXRjaCwgdGhlbiBzdG9wIGxvb3Bpbmc7IHdlIHdhbnQgdGhlIGZlYXR1cmUgdG8gcnVuCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZmVhdHVyZS5leGNsdWRlICE9PSAnJykgewogICAgICAgICAgICBjb25zdCBzaXRlcyA9IGZlYXR1cmUuZXhjbHVkZS5zcGxpdCgnLCcpOwoKICAgICAgICAgICAgZm9yIChsZXQgcGF0dGVybiA9IDA7IHBhdHRlcm4gPCBzaXRlcy5sZW5ndGg7IHBhdHRlcm4rKykgewogICAgICAgICAgICAgIGlmIChzb3gubG9jYXRpb24ubWF0Y2hXaXRoUGF0dGVybihzaXRlc1twYXR0ZXJuXSkpIHsgLy9pZiBjdXJyZW50IHNpdGUgaXMgaW4gbGlzdCwgRE9OJ1QgcnVuIGZlYXR1cmUKICAgICAgICAgICAgICAgIHJ1bkZlYXR1cmUgPSBmYWxzZTsgLy9kb24ndCBydW4gZmVhdHVyZQogICAgICAgICAgICAgICAgYnJlYWs7IC8vbm8gbmVlZCB0byBrZWVwIG9uIGxvb3BpbmcKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmIChydW5GZWF0dXJlKSB7CiAgICAgICAgICAgIHNveC5kZWJ1ZygncnVubmluZyAnICsgZmVhdHVyZUlkKTsKICAgICAgICAgICAgcGVyZm9ybWFuY2UubWFyayhgJHtmZWF0dXJlSWR9LXN0YXJ0YCk7CiAgICAgICAgICAgIGlmIChmZWF0dXJlLnNldHRpbmdzKSB7CiAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3NUb1Bhc3MgPSBHTV9nZXRWYWx1ZSgnU09YLScgKyBmZWF0dXJlSWQgKyAnLXNldHRpbmdzJykgPyBKU09OLnBhcnNlKEdNX2dldFZhbHVlKCdTT1gtJyArIGZlYXR1cmVJZCArICctc2V0dGluZ3MnKSkgOiB7fTsKICAgICAgICAgICAgICBzb3guZmVhdHVyZXNbZmVhdHVyZUlkXShzZXR0aW5nc1RvUGFzcyk7IC8vcnVuIHRoZSBmZWF0dXJlIGlmIG1hdGNoIGFuZCBleGNsdWRlIGNvbmRpdGlvbnMgYXJlIG1ldCwgcGFzcyBvbiBzZXR0aW5ncyBvYmplY3QKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzb3guZmVhdHVyZXNbZmVhdHVyZUlkXSgpOyAvL3J1biB0aGUgZmVhdHVyZSBpZiBtYXRjaCBhbmQgZXhjbHVkZSBjb25kaXRpb25zIGFyZSBtZXQKICAgICAgICAgICAgfQogICAgICAgICAgICBwZXJmb3JtYW5jZS5tYXJrKGAke2ZlYXR1cmVJZH0tZW5kYCk7CiAgICAgICAgICAgIHBlcmZvcm1hbmNlLm1lYXN1cmUoZmVhdHVyZUlkLCBgJHtmZWF0dXJlSWR9LXN0YXJ0YCwgYCR7ZmVhdHVyZUlkfS1lbmRgKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIGlmICghc294LmZlYXR1cmVzW2ZlYXR1cmVJZF0gfHwgIWZlYXR1cmUpIHsgLy9yZW1vdmUgZGVwcmVjYXRlZC8nY29ycnVwdCcgZmVhdHVyZSBJRHMgZnJvbSBzYXZlZCBzZXR0aW5ncwogICAgICAgICAgICBzb3gubG9naW5mbygnRGVsZXRpbmcgZmVhdHVyZSAiJyArIHNldHRpbmdzW2ldICsgJyIgKGZlYXR1cmUgbm90IGZvdW5kKScpOwogICAgICAgICAgICBzZXR0aW5ncy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgIHNveC5zZXR0aW5ncy5zYXZlKHNldHRpbmdzKTsKICAgICAgICAgICAgJCgnI3NveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZXMnKS5maW5kKCcjJyArIHNldHRpbmdzW2ldLnNwbGl0KCctJylbMV0pLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJCgnI3NveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZXMnKS5maW5kKCcjJyArIHNldHRpbmdzW2ldLnNwbGl0KCctJylbMV0pLnBhcmVudCgpLmNzcygnY29sb3InLCAncmVkJykuYXR0cigndGl0bGUnLCAnVGhlcmUgd2FzIGFuIGVycm9yIGxvYWRpbmcgdGhpcyBmZWF0dXJlLiBQbGVhc2UgcmFpc2UgYW4gaXNzdWUgb24gR2l0SHViLicpOwogICAgICAgICAgICBzb3guZXJyb3IoJ1RoZXJlIHdhcyBhbiBlcnJvciBsb2FkaW5nIHRoZSBmZWF0dXJlICInICsgc2V0dGluZ3NbaV0gKyAnIi4gUGxlYXNlIHJhaXNlIGFuIGlzc3VlIG9uIEdpdEh1YiwgYW5kIGNvcHkgdGhlIGZvbGxvd2luZyBlcnJvciBsb2c6XG4nICsgZXJyKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcGVyZm9ybWFuY2UubWFyaygnYWxsRmVhdHVyZXMtZW5kJyk7CiAgICAgIHBlcmZvcm1hbmNlLm1lYXN1cmUoJ2FsbEZlYXR1cmVzJywgJ2FsbEZlYXR1cmVzLXN0YXJ0JywgJ2FsbEZlYXR1cmVzLWVuZCcpOwogICAgICBzb3guZGVidWcoJ1BlcmZvcm1hbmNlIERhdGEnLCBwZXJmb3JtYW5jZS5nZXRFbnRyaWVzQnlUeXBlKCdtZWFzdXJlJykpOwogICAgfQoKICAgIC8vY3VzdG9tIGV2ZW50cy4uLi4KICAgIHNveC5oZWxwZXJzLm9ic2VydmUoWy4uLmRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Bvc3QtbGF5b3V0JyldLCAnLm5ld19jb21tZW50LCAuY29tbWVudCwgLmNvbW1lbnRzLCAuY29tbWVudC10ZXh0Jywgbm9kZSA9PiB7CiAgICAgIHNveC5kZWJ1Zygnc294LW5ldy1jb21tZW50IGV2ZW50IHRyaWdnZXJlZCcpOwogICAgICAkKGRvY3VtZW50KS50cmlnZ2VyKCdzb3gtbmV3LWNvbW1lbnQnLCBbbm9kZV0pOwogICAgfSk7CgogICAgc294LmhlbHBlcnMub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCAndGV4dGFyZWFbaWRePSJ3bWQtaW5wdXQiXScsIG5vZGUgPT4gewogICAgICBzb3guZGVidWcoJ3NveC1lZGl0LXdpbmRvdyBldmVudCB0cmlnZ2VyZWQnKTsKICAgICAgJChkb2N1bWVudCkudHJpZ2dlcignc294LWVkaXQtd2luZG93JywgW25vZGVdKTsKICAgIH0pOwoKICAgIHNveC5oZWxwZXJzLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgJy5yZXZpZXdhYmxlLXBvc3QsIC5yZXZpZXctY29udGVudCcsIG5vZGUgPT4gewogICAgICBzb3guZGVidWcoJ3NveC1uZXctcmV2aWV3LXBvc3QtYXBwZWFyZWQgZXZlbnQgdHJpZ2dlcmVkJyk7CiAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ3NveC1uZXctcmV2aWV3LXBvc3QtYXBwZWFyZWQnLCBbbm9kZV0pOwogICAgfSk7CgogICAgY29uc3QgY2hhdEJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hhdC1ib2R5Jyk7CiAgICBpZiAoY2hhdEJvZHkpIHsKICAgICAgc294LmhlbHBlcnMub2JzZXJ2ZShjaGF0Qm9keSwgJy51c2VyLXBvcHVwJywgbm9kZSA9PiB7CiAgICAgICAgc294LmRlYnVnKCdzb3gtY2hhdC11c2VyLXBvcHVwIGV2ZW50IHRyaWdnZXJlZCcpOwogICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoJ3NveC1jaGF0LXVzZXItcG9wdXAnLCBbbm9kZV0pOwogICAgICB9KTsKICAgIH0KCiAgICBpZiAoR01fZ2V0VmFsdWUoJ1NPWC1hY2Nlc3NUb2tlbicsIC0xKSA9PSAtMSkgeyAvL3NldCBhY2Nlc3MgdG9rZW4KICAgICAgLy9UaGlzIHdhcyBvcmlnaW5hbGx5IGEgc2VyaWVzIG9mIElJRkVzIGFwcGVuZGVkIHRvIHRoZSBoZWFkIHdoaWNoIHVzZWQgdGhlIFNFIEFQSSBKUyBTREsgYnV0CiAgICAgIC8vaXQgd2FzIHZlcnkgdW5jZXJ0YWluIGFuZCBvZnRlbiBjYXVzZWQgaXNzdWVzLCBlc3BlY2lhbGx5IGluIEZGCiAgICAgIC8vaXQgbm93IHVzZXMgYSBHaXRodWIgcGFnZSB0byBzaG93IHRoZSBhY2Nlc3MgdG9rZW4KICAgICAgLy9hbmQgZGV0ZWN0cyB0aGF0IHBhZ2UgYW5kIHNhdmVzIGl0IGF1dG9tYXRpY2FsbHkuCiAgICAgIC8vdGhpcyBzZWVtcyB0byBiZSBhIG11Y2ggY2xlYW5lciBhbmQgZWFzaWVyLXRvLWRlYnVnIG1ldGhvZCEKICAgICAgR01fc2V0VmFsdWUoJ1NPWC1hY2Nlc3NUb2tlbicsIC0yKTsgLy9vbmNlIHdlIGFzayB0aGUgdXNlciBvbmNlLCBkb24ndCBhc2sgdGhlbSBhZ2Fpbjogc2V0IHRoZSB2YWx1ZSB0byAtMiBzbyB0aGlzIElGIG5ldmVyIGV2YWx1YXRlcyB0byB0cnVlCiAgICAgIGNvbnN0IGFza1VzZXJUb0F1dGhvcmlzZSA9IHdpbmRvdy5jb25maXJtKCdUbyBnZXQgdGhlIG1vc3Qgb3V0IG9mIFNPWCwgeW91IHNob3VsZCBnZXQgYW4gYWNjZXNzIHRva2VuISBQbGVhc2UgcHJlc3MgIk9LIiB0byBjb250aW51ZSBhbmQgZm9sbG93IHRoZSBpbnN0cnVjdGlvbnMgaW4gdGhlIHdpbmRvdyB0aGF0IG9wZW5zLiBOT1RFOiB0aGlzIG1lc3NhZ2Ugd2lsbCBub3QgYXBwZWFyIGFnYWluOyBpZiB5b3UgY2hvb3NlIG5vdCB0bywgeW91IGNhbiBjbGljayB0aGUga2V5IGF0IHRoZSBib3R0b20gb2YgdGhlIHNldHRpbmdzIGRpYWxvZyBhdCBhbnl0aW1lIHRvIGdldCBvbmUuJyk7CiAgICAgIGlmIChhc2tVc2VyVG9BdXRob3Jpc2UpIHdpbmRvdy5vcGVuKCdodHRwczovL3N0YWNrZXhjaGFuZ2UuY29tL29hdXRoL2RpYWxvZz9jbGllbnRfaWQ9NzEzOCZzY29wZT1ub19leHBpcnkmcmVkaXJlY3RfdXJpPWh0dHA6Ly9zb3NjcmlwdGVkLmdpdGh1Yi5pby9zb3gvJyk7CiAgICAgIHNveC53YXJuKCdQbGVhc2UgZ28gdG8gdGhlIGZvbGxvd2luZyBVUkwgdG8gZ2V0IHlvdXIgYWNjZXNzIHRva2VuIGZvciBjZXJ0YWluIFNPWCBmZWF0dXJlcycsICdodHRwczovL3N0YWNrZXhjaGFuZ2UuY29tL29hdXRoL2RpYWxvZz9jbGllbnRfaWQ9NzEzOCZzY29wZT1ub19leHBpcnkmcmVkaXJlY3RfdXJpPWh0dHA6Ly9zb3NjcmlwdGVkLmdpdGh1Yi5pby9zb3gvJyk7CiAgICB9CiAgfQogIHNveC5yZWFkeShpbml0KTsKfSkod2luZG93LnNveCA9IHdpbmRvdy5zb3ggfHwge30sIGpRdWVyeSk7Cg==","resources":[{"meta":{"name":"sox.css","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.css","ts":1609797269603,"mimetype":"text/css"},"source":"Lyogc3ByaXRlcyAqLwouc294LXNwcml0ZSB7CiAgICB3aWR0aDogMTVweDsKICAgIGhlaWdodDogMTVweDsKfQoKLyogLS0tLS0tLS0gc294IHNldHRpbmdzIGRpYWxvZyAgLS0tLS0tLSAqLwoKI3NveC1zZXR0aW5ncy1kaWFsb2cgewogICAgdG9wOiAzNHB4OwogICAgcmlnaHQ6IDIwOHB4OwogICAgbWluLWhlaWdodDogY2FsYygxMDB2aCAtIDkwcHgpOwogICAgd2lkdGg6IDU1MHB4OwogICAgZGlzcGxheTogbm9uZTsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2cubmV3LXRvcGJhciB7CiAgICBtaW4taGVpZ2h0OiBjYWxjKDEwMHZoIC0gNzVweCk7Cn0KCiNzb3gtc2V0dGluZ3MtZGlhbG9nIC5tb2RhbC1jb250ZW50IHsKICAgIG1heC1oZWlnaHQ6IG5vbmU7CiAgICBtaW4taGVpZ2h0OiBpbmhlcml0Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZyAuaGVhZGVyIGgzIHsKICAgIHdpZHRoOiAxMDAlOwp9Cgojc294LXNldHRpbmdzLWRpYWxvZy12ZXJzaW9uIHsKICAgIGZsb2F0OiByaWdodDsKICAgIGZvbnQtc2l6ZTogMTRweDsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2cgI3NlYXJjaC1jb250YWluZXIgewogICAgbWluLWhlaWdodDogMDsKICAgIHdpZHRoOiA1NzBweDsKICAgIGxlZnQ6IDEwcHg7Cn0KCiNzb3gtc2V0dGluZ3MtZGlhbG9nICNzZWFyY2gtY29udGFpbmVyIC5zb3gtc3ByaXRlLXNlYXJjaCB7CiAgICB3aWR0aDogMjBweDsKICAgIGhlaWdodDogMjBweDsKICAgIHRvcDogNXB4Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZzpub3QoLm5ldy10b3BiYXIpICNzZWFyY2gtY29udGFpbmVyIC5zb3gtc3ByaXRlLXNlYXJjaCB7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBsZWZ0OiAtNDg1cHg7Cn0KCiNzb3gtc2V0dGluZ3MtZGlhbG9nLm5ldy10b3BiYXIgI3NlYXJjaC1jb250YWluZXIgLnNveC1zcHJpdGUtc2VhcmNoIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGxlZnQ6IC00ODVweDsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2cgI3NlYXJjaC1jb250YWluZXIgI3NlYXJjaCB7CiAgICBtYXgtd2lkdGg6IDkwJTsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZXMgewogICAgcGFkZGluZzogMCAxMHB4IDEwcHggMTBweDsKICAgIG92ZXJmbG93LXk6IHNjcm9sbDsKICAgIGhlaWdodDogY2FsYygxMDB2aCAtIDI1MHB4KTsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZXMgLm1vZGFsLWNvbnRlbnQgZGl2IHsKICAgIG1hcmdpbi1ib3R0b206IDNweDsKICAgIHBhZGRpbmc6IDJweDsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZXMgLm1vZGFsLWNvbnRlbnQgZGl2OmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJsYWNrLTA3NSk7Cn0KCiNzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmVzIC5tb2RhbC1jb250ZW50IGxhYmVsPmlucHV0IHsKICAgIG1hcmdpbi1yaWdodDogNXB4Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZy1hY3Rpb25zIHsKICAgIGhlaWdodDogNDBweDsKICAgIHBhZGRpbmc6IDAgMTBweDsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2ctc2F2ZSB7CiAgICBtYXJnaW4tbGVmdDogNXB4OwogICAgZmxvYXQ6IHJpZ2h0Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZy1hY3Rpb25zIC5hY3Rpb24gewogICAgZmxvYXQ6IHJpZ2h0OwogICAgcGFkZGluZzogMTNweCAxMXB4Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZyAuc294LW5ldy12ZXJzaW9uLWl0ZW0gewogICAgcGFkZGluZzogNXB4Owp9Cgouc294LXNldHRpbmdzLWJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kLWltYWdlOiBub25lICFpbXBvcnRhbnQ7CiAgICBwYWRkaW5nLXRvcDogMTBweDsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGNvbG9yOiAjOWZhNmFkOwogICAgbWluLXdpZHRoOiAzOHB4OwogICAgY3Vyc29yOiBwb2ludGVyOwp9Cgouc294LXNldHRpbmdzLWJ1dHRvbjpub3QoLi1saW5rKSB7CiAgICBoZWlnaHQ6IDI0cHggIWltcG9ydGFudDsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2ctY2hlY2stdG9nZ2xlPmkgewogICAgcGFkZGluZzogMTRweCAwOwp9Cgojc294LXNldHRpbmdzLWRpYWxvZy1mZWF0dXJlcyB0ZXh0YXJlYS5mZWF0dXJlU2V0dGluZyB7CiAgICBtaW4td2lkdGg6IDgwJTsKfQoKLm5ldHdvcmstaXRlbXMgLmZhOmJlZm9yZSB7CiAgICAvKmh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9wdWxsLzEyNyovCiAgICBjb2xvcjogIzlmYTZhZDsKfQoKLnNveC1mZWF0dXJlLWluZm8sCi5zb3gtZmVhdHVyZS1zZXR0aW5ncyB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1ibGFjay0wMjUpOwogICAgYm9yZGVyLXJhZGl1czogOXB4OwogICAgbWFyZ2luLWxlZnQ6IDIwcHg7CiAgICBwYWRkaW5nOiA4cHg7CiAgICB3aWR0aDogOTAlOwogICAgbGluZS1oZWlnaHQ6IDEuNTsKICAgIHBhZGRpbmc6IDVweCAhaW1wb3J0YW50Owp9Cgouc294LWZlYXR1cmUgLnNveC1zcHJpdGUtaW5mbywKLnNveC1mZWF0dXJlIC5zb3gtc3ByaXRlLXdyZW5jaCB7CiAgICBmb250LXNpemU6IDEycHg7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5zb3gtZmVhdHVyZSAuc294LXNwcml0ZS13cmVuY2ggewogICAgbWFyZ2luLWxlZnQ6IDVweDsKICAgIHRyYW5zZm9ybTogcm90YXRlKDkwZGVnKTsKfQoKLnNveC1mZWF0dXJlIC5zb3gtc3ByaXRlLWluZm8gewogICAgZmxvYXQ6IHJpZ2h0OwogICAgd2lkdGg6IDE3cHg7CiAgICBoZWlnaHQ6IDE3cHg7CiAgICBmaWxsOiBncmF5Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZy1mZWF0dXJlcy1wYWNrcyB7CiAgICBtYXJnaW4tYm90dG9tOiA1cHg7Cn0KCi5zb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFja3MtbGlzdCB7CiAgICBwYWRkaW5nOiAxMHB4OwogICAgbWFyZ2luOiA1cHg7Cn0KCi5zb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFja3MtbGlzdCBsaS5zb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFjayB7CiAgICBkaXNwbGF5OiBpbmxpbmU7CiAgICBtYXJnaW46IDVweDsKICAgIHBhZGRpbmc6IDEwcHg7CiAgICBib3JkZXItcmFkaXVzOiA5cHg7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyZXk7CiAgICBjb2xvcjogIzNjNDE0NjsgLyogZGFyayBtb2RlIGNvbXBhdGliaWxpdHkgKi8KICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKLnNveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZS1wYWNrcy1saXN0IGxpLnNveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZS1wYWNrLmNsZWFyLWZlYXR1cmUtcGFjay1zZWxlY3Rpb24gewogICAgYmFja2dyb3VuZC1jb2xvcjogaW5oZXJpdDsKICAgIGNvbG9yOiBpbmhlcml0Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZyAuc294LWZlYXR1cmUuZmVhdHVyZS1mYWRlLW91dCwgI3NveC1zZXR0aW5ncy1kaWFsb2cgLnNveC1mZWF0dXJlLmRpc2FibGVkLWZlYXR1cmUgewogICAgb3BhY2l0eTogMC41Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZy5kYXJrLW1vZGUgLnNveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZS1wYWNrOmhvdmVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICMzYjlkZTIgIWltcG9ydGFudDsKfQoKI3NveC1zZXR0aW5ncy1kaWFsb2cuZGFyay1tb2RlIC5zb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFjaywKI3NveC1zZXR0aW5ncy1kaWFsb2cuZGFyay1tb2RlICNzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmVzIC5tb2RhbC1jb250ZW50IGRpdjpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjayAhaW1wb3J0YW50Owp9Cgojc294LXNldHRpbmdzLWRpYWxvZy5kYXJrLW1vZGUgLnNveC1mZWF0dXJlLXNldHRpbmdzLAojc294LXNldHRpbmdzLWRpYWxvZy5kYXJrLW1vZGUgLnNveC1mZWF0dXJlLWluZm8gewogICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7Cn0KCiNzb3gtc2V0dGluZ3MtZGlhbG9nLmRhcmstbW9kZSAuc294LXNwcml0ZSB7CiAgICBmaWxsOiAjY2NjOwp9CgovKiAtLS0tLS0tLSBzb3ggc3BlY2lmaWMgZmVhdHVyZXMnIENTUyAtLS0tLS0tICovCgojc294LXNjcm9sbFRvVG9wIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHJpZ2h0OiAwOwogICAgYm90dG9tOiAwOwogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyMDAsIDIwMCwgMjAwLCAuNyk7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCiNzb3gtc2Nyb2xsVG9Ub3AgLnNveC1zcHJpdGUtdG9wIHsKICAgIHdpZHRoOiA0NXB4OwogICAgaGVpZ2h0OiA0NXB4Owp9CgovKk1haW4gY2VudGVyZWQgZGl2cywgU0Utc3R5bGU6Ki8KCi5zb3gtY2VudGVyZWQgewogICAgd2lkdGg6IDQwMHB4OwogICAgei1pbmRleDogMTAwMTsKICAgIHRvcDogMTAycHg7CiAgICBsZWZ0OiA2MTUuNXB4OwogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgbWFyZ2luLXRvcDogLTk1LjVweDsKICAgIG1hcmdpbi1sZWZ0OiAtMjE2cHg7CiAgICBvdmVyZmxvdzogYXV0bzsKICAgIGhlaWdodDogOTAlOwp9CgovKlNwZWNpZmljYWxseSBmb3IgcXVpY2tDb21tZW50U2hvcnRjdXRzIC0tIHRoZSBkaXYncyB0b28gd2lkZSEgaHR0cHM6Ly9naXRodWIuY29tL3NodTgvU3RhY2stT3ZlcmZsb3ctT3B0aW9uYWwtRmVhdHVyZXMvaXNzdWVzLzM2Ki8KCiNxdWlja0NvbW1lbnRTaG9ydGN1dHMuc294LWNlbnRlcmVkIHsKICAgIHdpZHRoOiA3NSU7CiAgICBoZWlnaHQ6IDkwJTsKICAgIHotaW5kZXg6IDEwMDE7CiAgICB0b3A6IDIwJTsKICAgIGxlZnQ6IDE0JTsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIG92ZXJmbG93OiBhdXRvOwp9CgovKnN0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQgc2lnbnMgKi8KCi5zdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkLWR1cGxpY2F0ZSwKLnN0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQtY2xvc2VkLAouc3RhbmRPdXREdXBlQ2xvc2VNaWdyYXRlZC1taWdyYXRlZCwKLnN0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQtb25ob2xkIHsKICAgIGNvbG9yOiAjRkZGOwogICAgcGFkZGluZzogMnB4OwogICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgZm9udC1zaXplOiAxMnB4OwogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwp9Cgouc3RhbmRPdXREdXBlQ2xvc2VNaWdyYXRlZC1kdXBsaWNhdGUgewogICAgYmFja2dyb3VuZDogI0ZBMDsKfQoKLnN0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQtY2xvc2VkIHsKICAgIGJhY2tncm91bmQ6ICNGMDA7Cn0KCi5zdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkLW1pZ3JhdGVkIHsKICAgIGJhY2tncm91bmQ6ICMxOUY7Cn0KCi5zdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkLW9uaG9sZCB7CiAgICBiYWNrZ3JvdW5kOiAjODA4MDgwOwp9CgovKm1ldGFOZXdRdWVzdGlvbkFsZXJ0IGZvciB0aGUgbW9kIGRpYW1vbmQgYW5kIGRpYWxvZyAqLwoKI21ldGFOZXdRdWVzdGlvbkFsZXJ0RGlhbG9nIHsKICAgIHRvcDogNTBweDsKICAgIHJpZ2h0OiAyNDJweDsKICAgIHdpZHRoOiAzNzdweDsKfQoKI21ldGFOZXdRdWVzdGlvbkFsZXJ0RGlhbG9nTGlzdDplbXB0eTo6YWZ0ZXIgewogICAgY29udGVudDogIk5vIG5ldyBtZXRhIHF1ZXN0aW9ucyBhdCB0aGlzIHRpbWUuIjsKfQoKLyphZGRIb3RUZXh0IGZvciB0aGUgJ3RoaXMgcXVlc3Rpb24gaXMgaG90JyBiYW5uZXIgKi8KCi5zb3gtaG90IC5zb3gtc3ByaXRlLWhvdCB7CiAgICBmbG9hdDogbGVmdDsKICAgIHdpZHRoOiAzNXB4OwogICAgaGVpZ2h0OiAzNXB4OwogICAgbWFyZ2luLXJpZ2h0OiAzcHg7CiAgICBmaWxsOiByZWQ7Cn0KCi5zb3gtaG90LnF1ZXN0aW9uLWxpc3QgLnNveC1zcHJpdGUtaG90IHsKICAgIHdpZHRoOiAyMHB4OwogICAgaGVpZ2h0OiAyMHB4Owp9CgovKnF1aWNrQ29tbWVudFNob3J0Y3V0c01haW46ICovCgoucXVpY2tDb21tZW50U2hvcnRjdXRzUmVtaW5kZXIgewogICAgaGVpZ2h0OiA0MCU7CiAgICB3aWR0aDogMTMlOwogICAgbGVmdDogMDsKICAgIHRvcDogMTAlOwogICAgcG9zaXRpb246IGZpeGVkOwogICAgYmFja2dyb3VuZC1jb2xvcjogZ3JheTsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIG92ZXJmbG93OiBhdXRvOwp9CgovKlNpZGUgYnkgU2lkZSBFZGl0aW5nIChTQlMsIGFkZFNCU0J0biwgc3RhcnRTQlMpOiBodHRwczovL2dpdGh1Yi5jb20vc3plZ28vU0UtQW5zd2Vyc19zY3JpcHRzL2Jsb2Ivc2lkZS1ieS1zaWRlL2VkaXRpbmctYW5kLXRvZ2dsaW5nL3NpZGUtYnktc2lkZS1lZGl0aW5nLnVzZXIuanM6Ki8KCiNzaWRlYmFyLnNicy1vbiB7CiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7Cn0KCiNjb250ZW50LnNicy1vbiB7CiAgICB3aWR0aDogMTM2MHB4ICFpbXBvcnRhbnQ7Cn0KCi5kcmFmdC1zYXZlZC5zYnMtb24gewogICAgbWFyZ2luLWxlZnQ6IDM1cHggIWltcG9ydGFudDsKfQoKLmRyYWZ0LWRpc2NhcmRlZC5zYnMtb24gewogICAgbWFyZ2luLWxlZnQ6IDM1cHggIWltcG9ydGFudDsKfQoKLmRyYWZ0LXNhdmVkLnNicy1vbi5zYnMtbmV3cSB7CiAgICBtYXJnaW4tbGVmdDogNDBweCAhaW1wb3J0YW50OwogICAgaGVpZ2h0OiAxNXB4ICFpbXBvcnRhbnQ7CiAgICBmbG9hdDogbGVmdCAhaW1wb3J0YW50Owp9CgouZHJhZnQtZGlzY2FyZGVkLnNicy1vbi5zYnMtbmV3cSB7CiAgICBtYXJnaW4tbGVmdDogNDBweCAhaW1wb3J0YW50OwogICAgaGVpZ2h0OiAxNXB4ICFpbXBvcnRhbnQ7CiAgICBmbG9hdDogbGVmdCAhaW1wb3J0YW50Owp9Cgoudm90ZWNlbGwuc2JzLW9uIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQoKLmhpZGUtcHJldmlldy5zYnMtb24gewogICAgbWFyZ2luLWxlZnQ6IDM1cHggIWltcG9ydGFudDsKfQoKLnBvc3QtZWRpdG9yLnNicy1vbiB7CiAgICB3aWR0aDogMTM2MHB4ICFpbXBvcnRhbnQ7Cn0KCi5zYnMtb24tbGVmdC1zaWRlIHsKICAgIHdpZHRoOiA2NjBweDsKfQoKLndtZC1idXR0b24tYmFyLnNicy1vbiB7CiAgICBmbG9hdDogbm9uZSAhaW1wb3J0YW50Owp9Cgoud21kLWNvbnRhaW5lci5zYnMtb24gewogICAgZmxvYXQ6IGxlZnQgIWltcG9ydGFudDsKfQoKLndtZC1wcmV2aWV3LnNicy1vbiB7CiAgICB3aWR0aDogNjg1cHg7CiAgICBjbGVhcjogbm9uZSAhaW1wb3J0YW50OwogICAgZmxvYXQ6IHJpZ2h0ICFpbXBvcnRhbnQ7Cn0KCi53bWQtcHJldmlldy5zYnMtb24uc2JzLW5ld3EgewogICAgbWFyZ2luLXRvcDogMTBweCAhaW1wb3J0YW50Owp9CgoudGFnLWVkaXRvci1wLnNicy1vbi5zYnMtbmV3cSB7CiAgICBmbG9hdDogbGVmdCAhaW1wb3J0YW50Owp9CgouZm9ybS1pdGVtLnNicy1vbi5zYnMtbmV3cSB7CiAgICBmbG9hdDogbGVmdCAhaW1wb3J0YW50Owp9CgoucG9zdC1mb3JtLnNicy1vbiB7CiAgICAvKmh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMjQ3Ki8KICAgIHdpZHRoOiAxMzM1cHg7Cn0KCi5lZGl0LWNvbW1lbnQuc2JzLW9uIHsKICAgIGNsZWFyOiBib3RoOwogICAgcG9zaXRpb246IGluaXRpYWw7Cn0KCi8qbGlua2VkUG9zdHNJbmxpbmUgZm9yIHRoZSBkaXNwbGF5ZWQgcG9zdCB0ZXh0OyBodHRwczovL2dpdGh1Yi5jb20vc2h1OC9TdGFjay1PdmVyZmxvdy1PcHRpb25hbC1GZWF0dXJlcy9pc3N1ZXMvNDggKi8KCi5saW5rZWRQb3N0c0lubGluZS1sb2FkZWQtYm9keS1zb3ggewogICAgYmFja2dyb3VuZC1jb2xvcjogYWxpY2VibHVlOwogICAgYm9yZGVyLXJhZGl1czogMjBweDsKICAgIG92ZXJmbG93LXdyYXA6IGJyZWFrLXdvcmQ7CiAgICB3aWR0aDogYXV0bzsKICAgIHBhZGRpbmc6IDEwcHg7CiAgICAtd2Via2l0LWJveC1zaGFkb3c6IGluc2V0IDFweCAxcHggNHB4IDFweCByZ2JhKDAsIDAsIDAsIDAuNSk7CiAgICAtbW96LWJveC1zaGFkb3c6IGluc2V0IDFweCAxcHggNHB4IDFweCByZ2JhKDAsIDAsIDAsIDAuNSk7CiAgICBib3gtc2hhZG93OiBpbnNldCAxcHggMXB4IDRweCAxcHggcmdiYSgwLCAwLCAwLCAwLjUpOwp9CgoubGlua2VkUG9zdHNJbmxpbmUtbG9hZGVkLWJvZHktc294IC5wb3N0LXRleHQgewogICAgd2lkdGg6IGF1dG87CiAgICBmb250LXNpemU6IDkwJTsKfQoKLypmaW5kQW5kUmVwbGFjZSovCgouZmluZFJlcGxhY2VUb29sYmFyIHsKICAgIGRpc3BsYXk6IGJsb2NrOwogICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICBwYWRkaW5nOiAwIDEycHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjYzhjY2QwOwogICAgYm9yZGVyLWJvdHRvbTogMDsKICAgIGJvcmRlci10b3A6IDA7Cn0KCiNmaW5kUmVwbGFjZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5maW5kUmVwbGFjZVRvb2xiYXIuZmluZFJlcGxhY2U+aW5wdXRbdHlwZT0ndGV4dCddIHsKICAgIGhlaWdodDogMTBweDsKICAgIHdpZHRoOiAyNSU7Cn0KCi5maW5kUmVwbGFjZVRvb2xiYXIuZmluZFJlcGxhY2U+aW5wdXRbdHlwZT0nYnV0dG9uJ10gewogICAgd2lkdGg6IDEwJTsKICAgIGhlaWdodDogMTAwJTsKfQoKLypjaGF0RWFzeUFjY2VzcyAtIGZvciB0aGUgbGlua3MgKGIgZWxlbWVudHMpKi8KCi5jaGF0RWFzeUFjY2VzcyBiIHsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKLypoaWdobGlnaHRRdWVzdGlvbnMgLS0gZm9yIHRoZSB0YWdzKi8KCi5zb3gtdGFnZ2VkLWludGVyZXN0aW5nIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQoKLnNveC10YWdnZWQtaW50ZXJlc3Rpbmc6YmVmb3JlIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgZGlzcGxheTogYmxvY2s7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgd2lkdGg6IDJweDsKICAgIGhlaWdodDogMTAwJTsKICAgIGJhY2tncm91bmQ6IGJsYWNrOwp9CgovKiBzcG9pbGVyVGlwIC0tIGZvciB0aGUgcmVkICdob3ZlciB0byBzaG93IHNwb2lsZXInIHRleHQgKi8KCi5pc1Nwb2lsZXIgewogICAgY29sb3I6IHJlZDsKICAgIGZvbnQtc2l6ZTogc21hbGxlcjsKICAgIGZsb2F0OiByaWdodDsKICAgIG9wYWNpdHk6IDEgIWltcG9ydGFudDsKfQoKLypjb21tZW50UmVwbGllcyAtLSBmb3IgdGhlIHJlcGx5IGJ1dHRvbnMqLwoKLnNveFJlcGx5TGluayB7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICBmbG9hdDogcmlnaHQ7Cn0KCi8qZmxhZ1BlcmNlbnRhZ2VCYXIgLS0gZm9yIHRoZSBwZXJjZW50YWdlIGJhciBpdHNlbGYqLwoKI3NveC1mbGFnUGVyY2VudFByb2dyZXNzQmFyIHsKICAgIGJhY2tncm91bmQ6ICNjY2M7CiAgICBoZWlnaHQ6IDEwcHg7CiAgICB3aWR0aDogMjUwcHg7CiAgICBtYXJnaW46IDZweCAxMHB4IDEwcHggMDsKICAgIHBhZGRpbmc6IDBweDsKICAgIG1hcmdpbjogYXV0bzsKfQoKI3NveC1mbGFnUGVyY2VudFByb2dyZXNzQmFyOmFmdGVyIHsKICAgIGNvbnRlbnQ6ICcnOwogICAgZGlzcGxheTogYmxvY2s7CiAgICBoZWlnaHQ6IDEwMCU7Cn0KCiNzb3gtZmxhZ1BlcmNlbnRIZWxwZnVsIHsKICAgIG1hcmdpbi1ib3R0b206IDVweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKLnNveC1mbGFnUGVyY2VudFByb2dyZXNzQmFyLWNvbnRhaW5lciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmFmYWZiCn0KCi8qdGl0bGVFZGl0RGlmZiAtLSBmb3IgdGhlIHRvZ2dsZSBidXR0b24qLwoKLnNveC1iZXR0ZXItdGl0bGUtdG9nZ2xlIHsKICAgIGZsb2F0OiBsZWZ0OwogICAgbWFyZ2luLXJpZ2h0OiAxMHB4OwogICAgY3Vyc29yOiBwb2ludGVyOwogICAgd2lkdGg6IDI1cHg7CiAgICBoZWlnaHQ6IDI1cHg7Cn0KCi8qc294LWNvcHlDb2RlIC0tIGZvciB0aGUgYnV0dG9uIGFuZCB0ZXh0YXJlYSAoY29tcGxldGVseSBoaWRlIGl0KSovCgouc294LWNvcHlDb2RlQnV0dG9uIHsKICAgIGZsb2F0OiByaWdodDsKICAgIHBvc2l0aW9uOiBzdGlja3k7CiAgICB0b3A6IDA7CiAgICAvKiB6LWluZGV4IGZvciBjb21wYXRpYmlsaXR5IHdpdGggaHR0cHM6Ly9naXRodWIuY29tL1NtYXJ0TWFub2ovU21hcnRVc2VyU2NyaXB0cy9ibG9iL21hc3Rlci9TT19MaW5lcy51c2VyLmpzICovCiAgICB6LWluZGV4OiA1MDsKICAgIGRpc3BsYXk6IG5vbmU7CiAgICAvKiByZWxhdGl2ZSBwb3NpdGlvbiBwcmV2ZW50cyBjb2RlIGZyb20gYmVpbmcgaW4gZnJvbnQgb2YgYnV0dG9uICovCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWZmMGYxOwogICAgbWFyZ2luLWxlZnQ6IC0xNXB4Owp9Cgouc294LWNvcHlDb2RlVGV4dGFyZWEgewogICAgcG9zaXRpb246IGZpeGVkOwogICAgdG9wOiAwOwogICAgbGVmdDogMDsKICAgIGhlaWdodDogMXB4OwogICAgd2lkdGg6IDFweDsKICAgIHBhZGRpbmc6IDA7CiAgICBib3JkZXI6IDA7CiAgICBvdXRsaW5lOiAwOwogICAgYm94LXNoYWRvdzogbm9uZTsKICAgIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50OwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKfQoKLypvcGVuTGlua3NJbk5ld1RhYiAtLSBmb3IgdGhlIGV4dGVybmFsIGxpbmsgc2lnbiovCgouc294LW9wZW5MaW5rc0luTmV3VGFiLWV4dGVybmFsTGluayB7CiAgICBkaXNwbGF5OiBpbmxpbmUgIWltcG9ydGFudDsKICAgIG1hcmdpbi1sZWZ0OiAzcHg7Cn0KCi8qY29sb3JBbnN3ZXJlciAtLSBmb3IgdGhlIHVzZXJuYW1lKi8KCi5zb3gtYW5zd2VyZXIgewogICAgY29sb3I6IHJnYmEoMCwgNTAsIDIwMCwgMSk7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDIyMCwgMjIwLCAyMjAsIDEpOwogICAgcGFkZGluZzogMXB4IDVweCAhaW1wb3J0YW50Owp9CgovKmhvdE5ldHdvcmtRdWVzdGlvbnNGaWx0ZXJpbmcgLS0gZm9yIHRoZSBxdWVzdGlvbnMgdG8gaGlkZSovCgouc294LWhvdC1uZXR3b3JrLXF1ZXN0aW9uLWZpbHRlci1oaWRlIHsKICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQoKLyphZGRBdXRob3JOYW1lVG9JbmJveE5vdGlmaWNhdGlvbnMgLS0gZm9yIHRoZSBhdXRob3Igc3BhbiovCgouc294LW5vdGlmaWNhdGlvbi1hdXRob3IgewogICAgY29sb3I6ICM4NDhkOTU7Cn0KCi8qaG90TmV0d29ya1F1ZXN0aW9uc0ZpbHRlcmluZyAtLSBmb3IgdGhlIHRhZ3MgaWNvbiBhbmQgdGFncyBsaXN0IHNob3duIGFmdGVyIGhvdmVyaW5nIG92ZXIgaXQqLwoKLmdldFF1ZXN0aW9uVGFncyB7CiAgICBtYXJnaW4tbGVmdDogNXB4Owp9Cgouc294LWhucS1xdWVzdGlvbi10YWdzLXRvb2x0aXAgewogICAgZGlzcGxheTogYmxvY2s7CiAgICBtYXJnaW4tdG9wOiA1cHg7CiAgICBtYXJnaW4tbGVmdDogNXB4OwogICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZWVmZTsKICAgIGJvcmRlcjogMXB4IHNvbGlkIGRhcmtncmV5OwogICAgZm9udC1zaXplOiAxMXB4OwogICAgcGFkZGluZzogMnB4OwogICAgd2hpdGUtc3BhY2U6IG5vcm1hbDsKfQoKLyogb25seVNob3dDb21tZW50QWN0aW9uc09uSG92ZXIgLS0gdGhlIGZ1bmN0aW9uIGp1c3QgYWRkcyB0aGlzIENTUyB0byBhdm9pZCBoYXZpbmcgdG8gZG8gaXQgaW4gSlMqLwovKiB0aGFua3MgQE1ha3llbiA8aHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3F1ZXN0aW9ucy8zMTI3OTQvMzEyODAwI2NvbW1lbnQxMDI0NzQ2XzMxMjc5ND4gKi8KCi5zb3gtb25seVNob3dDb21tZW50QWN0aW9uc09uSG92ZXI6bm90KDpob3ZlcikgLmNvbW1lbnQtdXAtb2ZmLAouc294LW9ubHlTaG93Q29tbWVudEFjdGlvbnNPbkhvdmVyOm5vdCg6aG92ZXIpIC5qcy1jb21tZW50LWZsYWc6bm90KC5mYy1yZWQtNTAwKSB7CiAgICB2aXNpYmlsaXR5OiBoaWRkZW47Cn0KCi8qIGF1dG9TaG93Q29tbWVudEltYWdlcyAtLSBmb3IgdGhlIGltYWdlIGRpc3BsYXllZCAqLwouc294LWF1dG9TaG93Q29tbWVudEltYWdlcy1pbWFnZSB7CiAgICBwYWRkaW5nOiAycHg7CiAgICBtYXJnaW46IDJweDsKICAgIGJvcmRlcjogMXB4IGRvdHRlZCBibGFjazsKICAgIGRpc3BsYXk6IGJsb2NrOwp9CgovKiBlZGl0Q29tbWVudCAtLSBmb3IgdGhlIGRpYWxvZyBhbmQgY2hlY2tib3hlcyBzaG93biB3aGVuIGVkaXRpbmcgKi8KLnNveC1lZGl0Q29tbWVudC1jdXJyZW50VmFsdWVzIHsKICAgIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrOwogICAgcGFkZGluZzogMTJweDsKfQoKLnNveC1lZGl0Q29tbWVudC1kZWxldGVEaWFsb2dCdXR0b24sCi5zb3gtZWRpdENvbW1lbnQtZWRpdERpYWxvZ0J1dHRvbiB7CiAgICBtaW4taGVpZ2h0OiAyLjJlbSAhaW1wb3J0YW50OwogICAgcGFkZGluZzogNXB4ICFpbXBvcnRhbnQ7CiAgICBmb250LXNpemU6IDEycHg7CiAgICBtYXJnaW4tbGVmdDogNXB4Owp9Cgouc294LWVkaXRDb21tZW50LXJlYXNvbiB7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2sgIWltcG9ydGFudDsKICAgIGJhY2tncm91bmQtY29sb3I6IGluaGVyaXQ7CiAgICBjb2xvcjogaW5oZXJpdDsKICAgIG1hcmdpbi10b3A6IDdweDsKICAgIHBhZGRpbmc6IDNweDsKfQoKLnNveC1lZGl0Q29tbWVudC1yZWFzb246aG92ZXIgewogICAgYmFja2dyb3VuZC1jb2xvcjogZ3JheTsKICAgIGNvbG9yOiB3aGl0ZTsKfQoKI2N1cnJlbnRWYWx1ZXMgc2VjdGlvbiB7CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2sgIWltcG9ydGFudDsKICAgIHBhZGRpbmc6IDBweCAxMHB4Owp9CgovKiBjdXN0b21NYWdpY0xpbmtzIC0tIGZvciB0aGUgc2V0dGluZ3MgdGFibGUgaW4gdGhlIGRpYWxvZyAqLwouc294LWN1c3RvbU1hZ2ljTGlua3Mtc2V0dGluZ3MtdGFibGUgewogICAgbWFyZ2luLWJvdHRvbTogMTBweDsKfQoKLnNveC1jdXN0b21NYWdpY0xpbmtzLXNldHRpbmdzLXRhYmxlIHRkLAouc294LWN1c3RvbU1hZ2ljTGlua3Mtc2V0dGluZ3MtdGFibGUgdGggewogICAgYm9yZGVyOiAxcHggc29saWQgI2RkZDsKICAgIHBhZGRpbmc6IDhweDsKfQoKLnNveC1jdXN0b21NYWdpY0xpbmtzLXNldHRpbmdzLXRhYmxlIHRoIHsKICAgIGZvbnQtd2VpZ2h0OiBib2xkOwp9CgovKiBsaW5rZWRUb0Zyb20gLS0gZm9yIHRoZSA+LzwgY2hldnJvbnMgKi8KLnNveC1saW5rZWRUb0Zyb20tY2hldnJvbiB7CiAgICB3aWR0aDogMjJweDsKICAgIGhlaWdodDogMjJweDsKICAgIGZsb2F0OiByaWdodDsKfQoKLyogcXVpY2tBdXRob3JJbmZvIC0tIGZvciB0aGUgdXNlciBkZXRhaWxzICovCi5zb3gtcXVpY2tBdXRob3JJbmZvLWRldGFpbHMgewogICAgY29sb3I6ICM4NDhkOTU7CiAgICBmb250LXNpemU6IDExcHg7CiAgICBwYWRkaW5nLXRvcDogMzhweAp9Cgouc294LXF1aWNrQXV0aG9ySW5mby1kZXRhaWxzIC5zb3gtc3ByaXRlLWFjY2Vzc190aW1lIHsKICAgIG1hcmdpbi1yaWdodDogNXB4Owp9Cgouc294LXF1aWNrQXV0aG9ySW5mby11bnJlZ2lzdGVyZWQgewogICAgbWFyZ2luLWxlZnQ6IDVweDsKICAgIGZvbnQtc2l6ZTogc21hbGxlcjsKfQoKLyogbWFya0VtcGxveWVlcyAtLSBmb3IgdGhlIFNFIGljb24gKi8KLnNveC1tYXJrRW1wbG95ZWVzLWxvZ28gewogICAgbWFyZ2luLWxlZnQ6IDVweDsKICAgIGhlaWdodDogMTNweDsKICAgIHdpZHRoOiAxM3B4Owp9CgovKiBvcGVuSW1hZ2VzQXNNb2RhbHMgLS0gZm9yIHRoZSBzbWFsbCAnKHNvdXJjZSknIGxpbmsgaW4gaGVhZGVyICovCi5zb3gtb3BlbkltYWdlc0FzTW9kYWxzLXNvdXJjZUxpbmsgewogICAgZm9udC1zaXplOiAxOHB4OwogICAgbWFyZ2luLWxlZnQ6IDEwcHg7CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsKfQoKLyogc294LXNjcm9sbENoYXRSb29tc0xpc3QgLS0gZm9yIHRoZSB1c2VyIHBvcHVwIGFuZCBzaWRlYmFyIHNjcm9sbGJhciAqLwouc294LXNjcm9sbENoYXRSb29tc0xpc3QtdXNlci1wb3B1cCB7CiAgICBtYXgtaGVpZ2h0OiBjYWxjKDEwMHZoIC0gOTBweCk7Cn0KCi5zb3gtc2Nyb2xsQ2hhdFJvb21zTGlzdC11c2VyLXBvcHVwIHVsLm5vLWJ1bGxldHMgewogICAgbWF4LWhlaWdodDogY2FsYygxMDB2aCAtIDUwMHB4KTsKICAgIG92ZXJmbG93LXk6IGF1dG87Cn0KCi5zb3gtc2Nyb2xsQ2hhdFJvb21zTGlzdC1zaWRlYmFyIHsKICAgIG1heC1oZWlnaHQ6IGNhbGMoNDB2aCk7CiAgICBvdmVyZmxvdzogYXV0bzsKfQoKLnNveC1zY3JvbGxDaGF0Um9vbXNMaXN0LXNpZGViYXIgPiAjbXktcm9vbXMgewogICAgaGVpZ2h0OiAxMDAlOwogICAgb3ZlcmZsb3c6IGF1dG87Cn0KCi8qIHRhYnVsYXJSZXZpZXdlclN0YXRzIC0tIGZvciB0aGUgdGFibGUgd2l0aCB1c2VyJ3Mgc3RhdHMgKi8KLnNveC10YWJ1bGFyUmV2aWV3ZXJTdGF0cy10YWJsZSB0ciwKLnNveC10YWJ1bGFyUmV2aWV3ZXJTdGF0cy10YWJsZSB0aCwKLnNveC10YWJ1bGFyUmV2aWV3ZXJTdGF0cy10YWJsZSB0ZDpub3QoOmZpcnN0LWNoaWxkKSB7CiAgYm9yZGVyOiAxcHggc29saWQgI2NjY2NjYzsKICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwp9Cgouc294LXRhYnVsYXJSZXZpZXdlclN0YXRzLXRhYmxlIHRoLCAuc294LXRhYnVsYXJSZXZpZXdlclN0YXRzLXRhYmxlIHRkIHsKICAgIHBhZGRpbmc6IDRweDsKfQoKLyogc3RpY2t5Vm90ZUJ1dHRvbnMgLS0gZm9yIHRoZSB2b3RlIGJ1dHRvbnMgb24gdGhlIGxlZnQgb2YgdGhlIHBvc3QgKi8KLnNveC1zdGlja3lWb3RlQnV0dG9ucyA+IC5qcy12b3RpbmctY29udGFpbmVyIHsKICAgIHBvc2l0aW9uOiAtd2Via2l0LXN0aWNreTsKICAgIHBvc2l0aW9uOiBzdGlja3k7Cn0KCi5zb3gtc3RpY2t5Vm90ZUJ1dHRvbnMgLnMtcG9wb3ZlciB7CiAgICB3aWR0aDogbWF4LWNvbnRlbnQ7Cn0K"},{"meta":{"name":"sox.dialog.html","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.dialog.html","ts":1609797269869,"mimetype":"text/html"},"source":"PGRpdiBjbGFzcz0idG9wYmFyLWRpYWxvZyBkbm8iIGlkPSJzb3gtc2V0dGluZ3MtZGlhbG9nIj4KICAgIDxkaXYgY2xhc3M9ImhlYWRlciI+CiAgICAgICAgPGgzPgogICAgICAgICAgICBzb3ggc2V0dGluZ3M8c3BhbiBpZD0ic294LXNldHRpbmdzLWRpYWxvZy12ZXJzaW9uIj4gdjEuMC4zZGV2PC9zcGFuPgogICAgICAgIDwvaDM+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImhlYWRlciI+CiAgICAgICAgPGgzPnNlYXJjaDwvaDM+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImdyaWQtLWNlbGwgcHMtcmVsYXRpdmUgZmwxIG1vZGFsLWNvbnRlbnQiIGlkPSJzZWFyY2gtY29udGFpbmVyIj4KICAgICAgICA8aW5wdXQgY2xhc3M9InMtaW5wdXQgcy1pbnB1dF9fc2VhcmNoIGpzLXNlYXJjaC1maWVsZCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9Imxvb2tpbmcgZm9yIGEgZmVhdHVyZT8iIGlkPSJzZWFyY2giPgogICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGFzcz0ic3ZnLWljb24gcy1pbnB1dC1pY29uIHMtaW5wdXQtaWNvbl9fc2VhcmNoIGljb25TZWFyY2giIGFyaWEtaGlkZGVuPSJ0cnVlIiB2aWV3Qm94PSIwIDAgMTggMTgiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PHBhdGggZD0iTSAxOCAxNi41IGwgLTUuMTQgLTUuMTggaCAtMC4zNSBhIDcgNyAwIDEgMCAtMS4xOSAxLjE5IHYgMC4zNSBMIDE2LjUgMTggbCAxLjUgLTEuNSBaIE0gMTIgNyBBIDUgNSAwIDEgMSAyIDcgYSA1IDUgMCAwIDEgMTAgMCBaIiAvPjwvc3ZnPgogICAgPC9kaXY+CiAgICA8ZGl2IGlkPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmVzIj4KICAgICAgICA8ZGl2IGlkPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmVzLXBhY2tzIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxoMz5GZWF0dXJlIFBhY2tzPC9oMz4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDx1bCBjbGFzcz0ic294LXNldHRpbmdzLWRpYWxvZy1mZWF0dXJlLXBhY2tzLWxpc3QiPgogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFjayIgZGF0YS1mZWF0dXJlLXBhY2staWQ9Im1ham9yX3VpIj5NYWpvciBVSSB0d2Vha3M8L2xpPgogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFjayIgZGF0YS1mZWF0dXJlLXBhY2staWQ9ImtleV9mZWF0dXJlIj5LZXkgZmVhdHVyZXM8L2xpPgogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFjayIgZGF0YS1mZWF0dXJlLXBhY2staWQ9InBvd2VyX3VzZXIiPlBvd2VyIFVzZXIgZmVhdHVyZXM8L2xpPgogICAgICAgICAgICAgICAgPGxpIGNsYXNzPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWZlYXR1cmUtcGFjayBjbGVhci1mZWF0dXJlLXBhY2stc2VsZWN0aW9uIj5jbGVhcjwvbGk+CiAgICAgICAgICAgIDwvdWw+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICAgIDxkaXYgaWQ9InNveC1zZXR0aW5ncy1kaWFsb2ctYWN0aW9ucyI+CiAgICAgICAgPGlucHV0IGNsYXNzPSJzLWJ0biBzLWJ0bl9fcHJpbWFyeSBzLWJ0bl9fc20iIGlkPSJzb3gtc2V0dGluZ3MtZGlhbG9nLXNhdmUiIHR5cGU9InN1Ym1pdCIgdmFsdWU9IlNhdmUgQ2hhbmdlcyI+CiAgICAgICAgPGEgY2xhc3M9ImFjdGlvbiBzLWJ0biBzLWJ0bl9fc2Vjb25kYXJ5IHMtYnRuX19zbSIgaWQ9InNveC1zZXR0aW5ncy1kaWFsb2ctcmVzZXQiIHRpdGxlPSJyZXNldCBTT1ggKGRlbGV0ZXMgZXZlcnl0aGluZywgaW5jbHVkaW5nIHlvdXIgc2V0dGluZ3MgYW5kIGFjY2VzcyB0b2tlbikiPlJlc2V0PC9hPgogICAgICAgIDxhIGNsYXNzPSJhY3Rpb24gcy1idG4gcy1idG5fX3NlY29uZGFyeSBzLWJ0bl9fc20iIGlkPSJzb3gtc2V0dGluZ3MtZGlhbG9nLXJlcG9ydCIgdGl0bGU9InJlcG9ydCBpc3N1ZSBvbiBHaXRodWIiIHRhcmdldD0iX2JsYW5rIiBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzL25ldyI+UmVwb3J0IElzc3VlPC9hPgogICAgICAgIDxhIGNsYXNzPSJhY3Rpb24gcy1idG4gcy1idG5fX3NlY29uZGFyeSBzLWJ0bl9fc20iIGlkPSJzb3gtc2V0dGluZ3MtZGlhbG9nLWRlYnVnZ2luZyI+RW5hYmxlIERlYnVnZ2luZzwvYT4KICAgICAgICA8YSBjbGFzcz0iYWN0aW9uIiBpZD0ic294LXNldHRpbmdzLWRpYWxvZy1hY2Nlc3MtdG9rZW4iIHRpdGxlPSJyZXF1ZXN0IGEgbmV3IGFjY2VzcyB0b2tlbiI+CiAgICAgICAgICAgIDxzdmcgcm9sZT0iaW1nIiBjbGFzcz0ic294LXNwcml0ZSBzb3gtc3ByaXRlLWtleSI+IDx1c2UgeGxpbms6aHJlZj0iI3NveF9rZXkiPiA8L3VzZT4gPC9zdmc+CiAgICAgICAgPC9hPgogICAgICAgIDxhIGNsYXNzPSJhY3Rpb24iIGlkPSJzb3gtc2V0dGluZ3MtZXhwb3J0IiB0aXRsZT0iZXhwb3J0L2NvcHkgZmVhdHVyZSBzZXR0aW5ncyI+CiAgICAgICAgICAgIDxzdmcgcm9sZT0iaW1nIiBjbGFzcz0ic294LXNwcml0ZSBzb3gtc3ByaXRlLWV4cG9ydCI+IDx1c2UgeGxpbms6aHJlZj0iI3NveF9leHBvcnQiPiA8L3VzZT4gPC9zdmc+CiAgICAgICAgPC9hPgogICAgICAgIDxhIGNsYXNzPSJhY3Rpb24iIGlkPSJzb3gtc2V0dGluZ3MtaW1wb3J0IiB0aXRsZT0iaW1wb3J0L3Bhc3RlIGZlYXR1cmUgc2V0dGluZ3MiPgogICAgICAgICAgICA8c3ZnIHJvbGU9ImltZyIgY2xhc3M9InNveC1zcHJpdGUgc294LXNwcml0ZS1pbXBvcnQiPiA8dXNlIHhsaW5rOmhyZWY9IiNzb3hfaW1wb3J0Ij4gPC91c2U+IDwvc3ZnPgogICAgICAgIDwvYT4KICAgICAgICA8YSBjbGFzcz0iYWN0aW9uIiBpZD0ic294LXNldHRpbmdzLWRpYWxvZy1jaGVjay10b2dnbGUiIHRpdGxlPSJ0b2dnbGUgYWxsIGZlYXR1cmVzIG9uL29mZiI+CiAgICAgICAgICAgIDxzdmcgcm9sZT0iaW1nIiBjbGFzcz0ic294LXNwcml0ZSBzb3gtc3ByaXRlLWNoZWNrZWQtYm94Ij4gPHVzZSB4bGluazpocmVmPSIjc294X2NoZWNrZWRfYm94Ij4gPC91c2U+IDwvc3ZnPgogICAgICAgIDwvYT4KICAgIDwvZGl2Pgo8L2Rpdj4K"},{"meta":{"name":"sox.features.info.json","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.features.info.json","ts":1609797269888,"mimetype":"text/plain"},"source":"ewogICAgImNhdGVnb3JpZXMiOiB7CiAgICAgICAgIkFwcGVhcmFuY2UiOiBbewogICAgICAgICAgICAibmFtZSI6ICJhZGRBdXRob3JOYW1lVG9JbmJveE5vdGlmaWNhdGlvbnMiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgdGhlIGF1dGhvcidzIG5hbWUgdG8gbm90aWZpY2F0aW9ucyBpbiB0aGUgaW5ib3giLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiSWYgeW91IHJlY2VpdmUgYSBjb21tZW50L2Fuc3dlci9zdWdnZXN0ZWQgZWRpdCBub3RpZmljYXRpb24sIHRoaXMgZmVhdHVyZSB3aWxsIGFkZCB0aGUgbmFtZSBvZiB0aGUgYXV0aG9yIG9mIHRoZSBjb21tZW50L2Fuc3dlci9lZGl0IHRvIHRoZSBub3RpZmljYXRpb24iLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiIiwKICAgICAgICAgICAgInNldHRpbmdzIjogW3sKICAgICAgICAgICAgICAgICJpZCI6ICJhZGROYW1lQmVmb3JlTWVzc2FnZU9yQXRUb3AiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiY2hlY2tib3giLAogICAgICAgICAgICAgICAgImRlc2MiOiAiU2hvdyBuYW1lIGJlZm9yZSBjb250ZW50cyAoZS5nLiBbbmFtZV06IG1lc3NhZ2UpIHJhdGhlciB0aGFuIGF0IHRvcCAoZS5nLiAnY29tbWVudCBieSBbbmFtZV0nKT8iCiAgICAgICAgICAgIH1dLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsicG93ZXJfdXNlciJdLAogICAgICAgICAgICAidXNlc0FwaSI6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImFsaWduQmFkZ2VzQnlDbGFzcyIsCiAgICAgICAgICAgICJkZXNjIjogIkFsaWduIGJhZGdlcyBieSB0aGVpciBjbGFzcyBvbiB1c2VyIHByb2ZpbGUgcGFnZXMiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yNTQ2MDciLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovdXNlcnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiYW5zd2VyVGFnc1NlYXJjaCIsCiAgICAgICAgICAgICJkZXNjIjogIlNob3cgdGFncyBmb3IgdGhlIHF1ZXN0aW9uIGFuIGFuc3dlciBiZWxvbmdzIHRvIG9uIHNlYXJjaCBwYWdlcyAoZm9yIGJldHRlciBjb250ZXh0KSIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjcmlwdGlvbiI6ICJCeSBkZWZhdWx0LCBhbnkgc2VhcmNoIHJlc3VsdHMgdGhhdCBhcmUgYW5zd2VycyBkbyBub3Qgc2hvdyBpdHMgcXVlc3Rpb24ncyB0YWdzLiBUaGlzIGZlYXR1cmUgYWRkcyB0aGUgcXVlc3Rpb24ncyB0YWdzIHVuZGVybmVhdGggdGhlIHJlc3VsdC4iLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8xOTc4NzQiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyouY29tL3NlYXJjaCoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0sCiAgICAgICAgICAgICJ1c2VzQXBpIjogdHJ1ZQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiY29sb3JBbnN3ZXJlciIsCiAgICAgICAgICAgICJkZXNjIjogIkNvbG9yIGFuc3dlcmVyJ3MgY29tbWVudHMiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiSGlnaGxpZ2h0IHRoZSB1c2VybmFtZSBvZiBhIGNvbW1lbnRlciBpZiB0aGV5IGhhdmUgcG9zdGVkIGFuIGFuc3dlciBvbiB0aGF0IHBhZ2UuIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMTk1NzQiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJtYWpvcl91aSIsICJrZXlfZmVhdHVyZSIsICJwb3dlcl91c2VyIl0KICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImRpc3BsYXlOYW1lIiwKICAgICAgICAgICAgImRlc2MiOiAiQWRkIGRpc3BsYXkgbmFtZSBiZWZvcmUgZ3JhdmF0YXIgaW4gdG9wYmFyIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMjA5OTkyIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyosU0UxLjAiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJkcmFnQm91bnR5IiwKICAgICAgICAgICAgImRlc2MiOiAiTWFrZSBib3VudHkgYm94IGRyYWdnYWJsZSIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzE3MDEyNSIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiaGlnaGxpZ2h0UXVlc3Rpb25zIiwKICAgICAgICAgICAgImRlc2MiOiAiQ2hhbmdlIGhpZ2hsaWdodGluZyBmb3IgcXVlc3Rpb25zIHdpdGggZmF2b3VyaXRlIHRhZ3MiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiQ2hhbmdlcyB0aGUgZmF2b3VyaXRlIHRhZyBxdWVzdGlvbiBoaWdobGlnaHRpbmcgdG8gYmUgYSBtb3JlIHN1YnRsZSwgY29sb3VyZWQgbGVmdC1ib3JkZXIiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yMzg1OTEiLAogICAgICAgICAgICAibWF0Y2giOiAiIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovL2NoYXQuKi5jb20vKiwqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9xdWVzdGlvbnMvYXNrIiwKICAgICAgICAgICAgImZlYXR1cmVfcGFja3MiOiBbIm1ham9yX3VpIiwgImtleV9mZWF0dXJlIiwgInBvd2VyX3VzZXIiXQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiaXNRdWVzdGlvbkhvdCIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIGxhYmVsIG9uIHF1ZXN0aW9ucyB3aGljaCBhcmUgaG90LW5ldHdvcmsgcXVlc3Rpb25zIiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIklmIHRoZSBxdWVzdGlvbiB5b3UgYXJlIGN1cnJlbnRseSB2aWV3aW5nIGlzIEhPVCwgYSBmbGFtZSBpY29uIGlzIGFkZGVkIG5leHQgdG8gdGhlIHRpdGxlIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMjQ1MzkwIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3NlYXJjaCosKjovLyovPyIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovL21ldGEuKi8qIiwKICAgICAgICAgICAgInVzZXNBcGkiOiB0cnVlCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJsb2NhbFRpbWVzdGFtcHMiLAogICAgICAgICAgICAiZGVzYyI6ICJDb252ZXJ0IHRpbWVzdGFtcHMgdG8geW91ciBsb2NhbCB0aW1lIiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIkRpc3BsYXlzIHRpbWVzdGFtcHMgYmFzZWQgb24geW91ciB0aW1lIHpvbmUuIFlvdSBjYW4gYWxzbyBkaXNwbGF5IHRpbWUgaW4gMTItaG91ciBmb3JtYXQgYnkgY2hlY2tpbmcgdGhlIG9wdGlvbi4iLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAiLAogICAgICAgICAgICAic2V0dGluZ3MiOiBbewogICAgICAgICAgICAgICAgImlkIjogInR3ZWx2ZUhvdXJzIiwKICAgICAgICAgICAgICAgICJ0eXBlIjogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgICJkZXNjIjogIlVzZSAxMi1ob3VyIGZvcm1hdD8iCiAgICAgICAgICAgIH1dCiAgICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAibWFya0VtcGxveWVlcyIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZHMgdGhlIFN0YWNrIEV4Y2hhbmdlIGxvZ28gYWZ0ZXIgZW1wbG95ZWUgbmFtZXMgdG8gbWFrZSB0aGVtIHN0YW5kIG91dCIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzI0NjY3OCIsCiAgICAgICAgICAgICJtYXRjaCI6ICIiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vY2hhdC4qLmNvbS8qLFNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2siLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsibWFqb3JfdWkiLCAia2V5X2ZlYXR1cmUiLCAicG93ZXJfdXNlciJdLAogICAgICAgICAgICAidXNlc0FwaSI6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogIm1ldGFDaGF0QmxvZ1N0YWNrRXhjaGFuZ2VCdXR0b24iLAogICAgICAgICAgICAiZGVzYyI6ICJTaG93IG1ldGEgYW5kIGNoYXQgYnV0dG9ucyBvbiBob3ZlciBvZiBhIHNpdGUgdW5kZXIgdGhlIHNpdGUgc3dpdGNoZXIgYnV0dG9uIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMjU2MTgzIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJtZXRhTmV3UXVlc3Rpb25BbGVydCIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIG1vZCBkaWFtb25kIHRvIHRoZSB0b3BiYXIgdG8gYWxlcnQgeW91IG9mIG5ldyBxdWVzdGlvbnMgb24gdGhlIHNpdGUncyBjaGlsZC1tZXRhIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMjU2MzE4IiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyosU0UxLjAiLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsicG93ZXJfdXNlciJdLAogICAgICAgICAgICAidXNlc0FwaSI6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogInNjcm9sbFRvVG9wIiwKICAgICAgICAgICAgImRlc2MiOiAiQWRkIFNjcm9sbCBUbyBUb3AgYnV0dG9uIiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIlRoaXMgZmVhdHVyZSBhZGRzIGFuIHVwIGFycm93IGF0IHRoZSBib3R0b20tcmlnaHQgb2YgeW91ciBzY3JlZW4sIHRoYXQgd2lsbCBqdW1wIHRvIHRoZSB0b3Agb2YgdGhlIHBhZ2Ugd2hlbiBjbGlja2VkIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJzcG9pbGVyVGlwIiwKICAgICAgICAgICAgImRlc2MiOiAiRGlmZmVyZW50aWF0ZSBzcG9pbGVycyBmcm9tIGVtcHR5IGJsb2NrcXVvdGVzIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMTA0MDg1IiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogInN0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgaGlnaGxpZ2h0ZWQgdGFncyB0byBjbG9zZWQvb24gaG9sZC9kdXBsaWNhdGUvbWlncmF0ZWQgcXVlc3Rpb25zIG9uIHF1ZXN0aW9uIGxpc3RzIGFuZCByZXZpZXciLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiQWRkcyBhIGNvbG91cmVkIGJveCBhdCB0aGUgZW5kIG9mIGEgdGl0bGUgKHRoYXQgcmVwbGFjZXMgdGhlIHN0YW5kYXJkIFtkdXBsaWNhdGVdLCBldGMuKSBpbiBxdWVzdGlvbiBsaXN0cyB0byBtb3JlIGVhc2lseSB0ZWxsIHdoYXQgdGhlIHN0YXRlIG9mIGEgcXVlc3Rpb24gaXMiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yNTcwMjEiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyouKi8sKjovLyouKi9xdWVzdGlvbnMqLCo6Ly8qLiovcmV2aWV3KiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyosU0UxLjAiLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsibWFqb3JfdWksIGtleV9mZWF0dXJlIiwgInBvd2VyX3VzZXIiXSwKICAgICAgICAgICAgInVzZXNBcGkiOiB0cnVlCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJ0YWJ1bGFyUmV2aWV3ZXJTdGF0cyIsCiAgICAgICAgICAgICJkZXNjIjogIkRpc3BsYXkgcmV2aWV3ZXIgc3RhdHMgb24gL3Jldmlldy9zdWdnZXN0ZWQtZWRpdHMgaW4gdGFibGUgZm9ybSIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzI3Njk0NiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi5jb20vcmV2aWV3L3N1Z2dlc3RlZC1lZGl0cy8qIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiIiwKICAgICAgICAgICAgImZlYXR1cmVfcGFja3MiOiBbInBvd2VyX3VzZXIiXQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAidG9wQW5zd2VycyIsCiAgICAgICAgICAgICJkZXNjIjogIkltcHJvdmUgYW5zd2VyIHZpc2liaWxpdHkgYnkgbGlzdGluZyB0b3AgYW5zd2VycyIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAidW5zcG9pbCIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIGxpbmsgdG8gdGhlIGJvdHRvbSBvZiBhIHBvc3QgdG8gcmV2ZWFsIGFsbCBzcG9pbGVycyBpbiBhIHBvc3QiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yNDk4MDgiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiYWRkVGltZWxpbmVBbmRSZXZpc2lvbkxpbmtzIiwKICAgICAgICAgICAgImRlc2MiOiAiQWRkIGEgcmV2aXNpb24gbGluayB0byB0aGUgYm90dG9tIG9mIGVhY2ggcG9zdCBmb3IgcXVpY2sgYWNjZXNzIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0KICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogInNob3dUYWdXaWtpTGlua09uVGFnUG9wdXAiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgYSBsaW5rIHRvIHRoZSB0YWcgd2lraSBwYWdlIG9uIHRoZSBwb3B1cCB0aGF0IGFwcGVhcnMgd2hlbiBob3ZlcmluZyBvdmVyIGEgdGFnIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucyosKjovLyovcmV2aWV3KiwqOi8vKi90YWdzKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0KICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImhpZGVXZWxjb21lQmFja01lc3NhZ2UiLAogICAgICAgICAgICAiZGVzYyI6ICJIaWRlIHRoZSAnd2VsY29tZSBiYWNrLi4uZG9uJ3QgZm9yZ2V0IHRvIHZvdGUnIG1lc3NhZ2Ugd2hlbiB2aXNpdGluZyBhIHNpdGUgYWZ0ZXIgYSB3aGlsZSIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMqIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovLyovcXVlc3Rpb25zL2FzayIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogIm9wZW5JbWFnZXNBc01vZGFscyIsCiAgICAgICAgICAgICJkZXNjIjogIk9wZW4gaW1ndXIgaW1hZ2VzIGFzIGxhcmdlciBtb2RhbHMgb24gY2xpY2siLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiV2hlbiBjbGlja2luZyBvbiBhbiBpbWFnZSB0aGF0IGlzIGhvc3RlZCBvbiBTdGFjayBFeGNoYW5nZSdzIGltZ3VyIGFjY291bnQsIGEgbW9kYWwgd2lsbCBvcGVuIHNob3dpbmcgYSBsYXJnZXIgdmVyc2lvbiBvZiB0aGUgaW1hZ2UuIElmIHlvdSBzdGlsbCB3YW50IHRvIG9wZW4gdGhlIGltYWdlIGluIGEgbmV3IHRhYiwgdGhlcmUgaXMgYSAnc291cmNlJyBsaW5rIGluIHRoZSBtb2RhbC4iLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyosKjovLyovcmV2aWV3LyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIKICAgICAgICB9XSwKICAgICAgICAiQ29tbWVudHMiOiBbewogICAgICAgICAgICAibmFtZSI6ICJhdXRvU2hvd0NvbW1lbnRJbWFnZXMiLAogICAgICAgICAgICAiZGVzYyI6ICJWaWV3IGxpbmtlZCBpbWFnZXMgKHRvIGltZ3VyKSBpbiBjb21tZW50cyBpbmxpbmUiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiVGhpcyBmZWF0dXJlIHdpbGwgYXV0b21hdGljYWxseSBkZXRlY3QgY29tbWVudHMgd2l0aCBsaW5rcyB0byBpbWd1ciBhbmQgd2lsbCBkaXNwbGF5IHRoZW0gaW5saW5lIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJtYWpvcl91aSwga2V5X2ZlYXR1cmUiLCAicG93ZXJfdXNlciJdCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJjb21tZW50UmVwbGllcyIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCByZXBseSBsaW5rcyB0byBjb21tZW50cyBmb3IgcXVpY2sgcmVwbHlpbmcgKHdpdGhvdXQgaGF2aW5nIHRvIHR5cGUgc29tZW9uZSdzIHVzZXJuYW1lKSIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzc0Nzc4IiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0KICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImNvbW1lbnRTaG9ydGN1dHMiLAogICAgICAgICAgICAiZGVzYyI6ICJVc2UgQ3RybCtJLEIsSyAodG8gaXRhbGljaXNlLCBib2xkZW4gYW5kIGFkZCBjb2RlIGJhY2t0aWNrcykgaW4gY29tbWVudHMiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8xNDc1NiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiY29uZmlybU5hdmlnYXRlQXdheSIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIGNvbmZpcm1hdGlvbiBkaWFsb2cgd2hlbiBuYXZpZ2F0aW5nIGF3YXkgb24gcGFnZXMgd2hpbHN0IHN0aWxsIHR5cGluZyBhIGNvbW1lbnQiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yNTIyMDUiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImNvcHlDb21tZW50c0xpbmsiLAogICAgICAgICAgICAiZGVzYyI6ICJDb3B5ICdzaG93IHggbW9yZSBjb21tZW50cycgbGluayB0byB0aGUgdG9wIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvNTUwMjAiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogIm1vdmVCb3VudHkiLAogICAgICAgICAgICAiZGVzYyI6ICJNb3ZlIHRoZSAnc3RhcnQgYSBib3VudHknIGxpbmsgYmVmb3JlIHRoZSBjb21tZW50cyIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzIzNDA5NSIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAic2hvd0NvbW1lbnRTY29yZXMiLAogICAgICAgICAgICAiZGVzYyI6ICJTaG93IHlvdXIgY29tbWVudCBhbmQgY29tbWVudCByZXBsaWVzIHNjb3JlcyBpbiB5b3VyIHByb2ZpbGUgdGFicyIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjcmlwdGlvbiI6ICJBZGRzIGEgYnV0dG9uIG5leHQgdG8gY29tbWVudHMgaW4geW91ciBwcm9maWxlJ3MgcmVzcG9uc2VzL2FjdGl2aXR5IHRhYnMgdGhhdCB3aGVuIGNsaWNrZWQsIHNob3cgeW91IHRoZSBzY29yZSBvZiB5b3VyIGNvbW1lbnQiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8zODI4NSIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi91c2Vycy8qIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAsKjovL2NoYXQuKi5jb20vKiIsCiAgICAgICAgICAgICJ1c2VzQXBpIjogdHJ1ZQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiaGlkZGVuQ29tbWVudHNJbmRpY2F0b3IiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgYSBkYXJrZXIgYm9yZGVyIHVuZGVybmVhdGggY29tbWVudHMgaWYgdGhlcmUgYXJlIHNvbWUgaGlkZGVuIGFmdGVyIGl0IiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrb3ZlcmZsb3cuY29tL3EvMjk2NTgyIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0KICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogIm9ubHlTaG93Q29tbWVudEFjdGlvbnNPbkhvdmVyIiwKICAgICAgICAgICAgImRlc2MiOiAiT25seSBzaG93IHRoZSBjb21tZW50IGFjdGlvbnMgKGZsYWcvdXB2b3RlKSB3aGVuIGhvdmVyaW5nIG92ZXIgYSBjb21tZW50IiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMzEyNzk0IiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImNvcHlDb21tZW50TWFya2Rvd24iLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgYSBidXR0b24gdG8gY29weSB0aGUgbWFya2Rvd24gb2YgYSBjb21tZW50IG5leHQgdG8gdGhlbSIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9yZXZpZXcqIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiLAogICAgICAgICAgICAidXNlc0FwaSI6IHRydWUsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0KICAgICAgICB9XSwKICAgICAgICAiRWRpdGluZyI6IFt7CiAgICAgICAgICAgICJuYW1lIjogImFkZFNCU0J0biIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIGJ1dHRvbiB0byB0aGUgZWRpdG9yIHRvb2xiYXIgdG8gc3RhcnQgc2lkZS1ieS1zaWRlIGVkaXRpbmcgd2l0aCB0aGUgbWFya2Rvd24gZWRpdG9yIGFuZCBwcmV2aWV3IiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIkFuICdTQlMnIGJ1dHRvbiBpcyBhZGRlZCB0byB0aGUgcmlnaHQgb2YgdGhlIG1hcmtkb3duIGVkaXRvciB0b29sYmFyLiBDbGlja2luZyBpdCB3aWxsIG1ha2UgdGhlIG1hcmtkb3duIGFuZCB0aGUgcHJldmlldyBhcHBlYXIgc2lkZS1ieS1zaWRlIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMjUzMTEyIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAsKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiLAogICAgICAgICAgICAic2V0dGluZ3MiOiBbewogICAgICAgICAgICAgICAgImlkIjogInNic0J5RGVmYXVsdCIsCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjaGVja2JveCIsCiAgICAgICAgICAgICAgICAiZGVzYyI6ICJBdXRvbWF0aWNhbGx5IGVuYWJsZSBTQlMgb24gYWxsIHBvc3RzPyIKICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJrZXlfZmVhdHVyZSIsICJwb3dlcl91c2VyIl0KICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImVkaXRDb21tZW50IiwKICAgICAgICAgICAgImRlc2MiOiAiUHJlLWRlZmluZWQgZWRpdCBjb21tZW50IG9wdGlvbnMgKGNoZWNrYm94ZXMpIiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIkFkZHMgY2hlY2tib3hlcyB0byBhZGQgY2FubmVkIG1lc3NhZ2VzIGZvciBlZGl0IHJldmlzaW9ucyB3aGVuIGVkaXRpbmcuIFlvdSBjYW4gbWFrZSAqeW91ciBvd24qIGNhbm5lZCByZXNwb25zZXMgYnkgY2xpY2tpbmcgdGhlICdFZGl0IFJlYXNvbnMnIGJ1dHRvbiB0aGF0IGlzIGFkZGVkIHRvIHRoZSBIZWxwIGRyb3Bkb3duIG1lbnUgaW4gdGhlIHRvcGJhciIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzE5MDQ2MSIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIiwKICAgICAgICAgICAgImZlYXR1cmVfcGFja3MiOiBbInBvd2VyX3VzZXIiXQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiZWRpdFJlYXNvblRvb2x0aXAiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgYSB0b29sdGlwIHRvIHBvc3RzIHNob3dpbmcgdGhlIGxhc3QgcmV2aXNpb24ncyBjb21tZW50IiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIldoZW4gYSBwb3N0IGlzIGVkaXRlZCwgdGhlIGVkaXRvciBpcyBkaXNwbGF5ZWQgdW5kZXJuZWF0aCB0aGUgcG9zdC4gVGhpcyBmZWF0dXJlIHdpbGwgc2hvdyB3aGF0IHRoZSBsYXN0IHJldmlzaW9uJ3MgY29tbWVudCB3YXMgYXMgYSB0b29sdGlwIHdoZW4geW91IGhvdmVyIG92ZXIgJ2VkaXRlZCcgdW5kZXJuZWF0aCBhIHBvc3QgaW4gJ2VkaXRlZCBbZGF0ZV0gYXQgW3RpbWVdJyIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzIzMTUiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyosKjovLyovcmV2aWV3KiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIiwKICAgICAgICAgICAgImZlYXR1cmVfcGFja3MiOiBbInBvd2VyX3VzZXIiXSwKICAgICAgICAgICAgInVzZXNBcGkiOiB0cnVlCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJmaW5kQW5kUmVwbGFjZSIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIGZpbmQgJiByZXBsYWNlIGZlYXR1cmUgdG8gdGhlIG1hcmtkb3duIGVkaXRvciIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjcmlwdGlvbiI6ICIiLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyosKjovLyovcmV2aWV3KiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImtiZEFuZEJ1bGxldHMiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgS0JEIGFuZCBsaXN0IGJ1dHRvbnMgdG8gZWRpdG9yIHRvb2xiYXIiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiQWRkcyBhIGtiZCBhbmQgYnVsbGV0IGljb24gdG8gdGhlIG1hcmtkb3duIGVkaXRvciB0b29sYmFyIHRoYXQgbGV0cyB5b3Ugc3Vycm91bmQgdGhlIHNlbGVjdGVkIHRleHQgd2l0aCBLQkQgdGFncyBvciBsaXN0aWZ5J3MgdGhlIGN1cnJlbnQgc2VsZWN0aW9uIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMTAyODQxIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJ0aXRsZUVkaXREaWZmIiwKICAgICAgICAgICAgImRlc2MiOiAiTWFrZSB0aXRsZSBlZGl0cyBzaG93IHNlcGFyYXRlbHkgcmF0aGVyIHRoYW4gbWVyZ2VkIGluIGVkaXQgc3VnZ2VzdGlvbnMiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8xMzU3MTAiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyouKi9yZXZpZXcvc3VnZ2VzdGVkLWVkaXRzKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImlubGluZUVkaXRvckV2ZXJ5d2hlcmUiLAogICAgICAgICAgICAiZGVzYyI6ICJJbmxpbmUgZWRpdG9yIHJlZ2FyZGxlc3Mgb2YgcmVwdXRhdGlvbiIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjcmlwdGlvbiI6ICJFbmFibGVzIHRoZSBpbmxpbmUgZWRpdG9yIG9uIGFsbCBzaXRlcywgZXZlbiBpZiB5b3UgZG9uJ3QgaGF2ZSAyayByZXAgdGhlcmUgeWV0LiBOb3RlOiB0aGlzIGZlYXR1cmUgbWF5IG5vdCB3b3JrIG9uIEZpcmVmb3guIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiCiAgICAgICAgfV0sCiAgICAgICAgIkZsYWdzIjogW3sKICAgICAgICAgICAgIm5hbWUiOiAiZmxhZ091dGNvbWVUaW1lIiwKICAgICAgICAgICAgImRlc2MiOiAiU2hvdyB0aGUgZmxhZyBvdXRjb21lIHRpbWUgd2hlbiB2aWV3aW5nIHlvdXIgRmxhZyBIaXN0b3J5IiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3VzZXJzLyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vY2hhdC4qLmNvbS8qLFNFMS4wIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiZmxhZ1BlcmNlbnRhZ2VzIiwKICAgICAgICAgICAgImRlc2MiOiAiU2hvdyBmbGFnZ2luZyBwZXJjZW50YWdlcyBmb3IgZWFjaCB0eXBlIGluIHRoZSBGbGFnIFN1bW1hcnkiLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovdXNlcnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyosU0UxLjAiLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsicG93ZXJfdXNlciJdCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJmbGFnUGVyY2VudGFnZUJhciIsCiAgICAgICAgICAgICJkZXNjIjogIlNob3cgdGhlIHRvdGFsIHBlcmNlbnRhZ2Ugb2YgaGVscGZ1bCBmbGFncyBhcyBhIGNvbG91cmVkIGJhciBvbiB0aGUgRmxhZyBTdW1tYXJ5IFBhZ2UiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tvdmVyZmxvdy5jb20vcS8zMTA4ODEiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovdXNlcnMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyosU0UxLjAiLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsicG93ZXJfdXNlciJdCiAgICAgICAgfV0sCiAgICAgICAgIlNpZGViYXIiOiBbewogICAgICAgICAgICAibmFtZSI6ICJoaWRlQ29tbXVuaXR5QnVsbGV0aW4iLAogICAgICAgICAgICAiZGVzYyI6ICJIaWRlIHRoZSBDb21tdW5pdHkgQnVsbGV0aW4gbW9kdWxlIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJoaWRlSnVzdEhvdE1ldGFQb3N0cyIsCiAgICAgICAgICAgICJkZXNjIjogIkhpZGUganVzdCB0aGUgJ0hvdCBNZXRhIFBvc3RzJyBzZWN0aW9ucyBpbiB0aGUgQ29tbXVuaXR5IEJ1bGxldGluIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJoaWRlSGlyZU1lIiwKICAgICAgICAgICAgImRlc2MiOiAiSGlkZSB0aGUgTG9va2luZyBmb3IgYSBKb2IgbW9kdWxlIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJoaWRlQ2hhdFNpZGViYXIiLAogICAgICAgICAgICAiZGVzYyI6ICJIaWRlIHRoZSBDaGF0IG1vZHVsZSIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vY2hhdC4qLmNvbS8qIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiaGlkZUxvdmVUaGlzU2l0ZSIsCiAgICAgICAgICAgICJkZXNjIjogIkhpZGUgdGhlICdMb3ZlIHRoaXMgc2l0ZT8nIG1vZHVsZSIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vY2hhdC4qLmNvbS8qLCo6Ly8qL3JldmlldyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJsaW5rZWRUb0Zyb20iLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgYW4gYXJyb3cgdG8gbGlua2VkIHBvc3RzIGluIHRoZSBzaWRlYmFyIHRvIHNob3cgd2hldGhlciB0aGV5IGFyZSBsaW5rZWQgdG8gb3IgbGlua2VkIGZyb20iLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yNzYyMzUiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKixTRTEuMCIsCiAgICAgICAgICAgICJ1c2VzQXBpIjogdHJ1ZQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiaG90TmV0d29ya1F1ZXN0aW9uc0ZpbHRlcmluZyIsCiAgICAgICAgICAgICJkZXNjIjogIkZpbHRlciB0aGUgaG90IG5ldHdvcmsgcXVlc3Rpb25zIGJ5IHRoZWlyIGF0dHJpYnV0ZXMiLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovL2NoYXQuKi5jb20vKixTRTEuMCIsCiAgICAgICAgICAgICJzZXR0aW5ncyI6IFt7CiAgICAgICAgICAgICAgICAiaWQiOiAid29yZHNUb0Jsb2NrIiwKICAgICAgICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwKICAgICAgICAgICAgICAgICJkZXNjIjogIldvcmRzIHRvIGJsb2NrIGZyb20gdGl0bGVzIChjb21tYS1zZXBhcmF0ZWQpIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAiaWQiOiAic2l0ZXNUb0Jsb2NrIiwKICAgICAgICAgICAgICAgICJ0eXBlIjogInRleHRhcmVhIiwKICAgICAgICAgICAgICAgICJkZXNjIjogIlNpdGVzIHRvIGJsb2NrIChjb21tYS1zZXBhcmF0ZWQgbWF0Y2ggcGF0dGVybnMpIgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAiaWQiOiAidGl0bGVzVG9IaWRlUmVnZXgiLAogICAgICAgICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLAogICAgICAgICAgICAgICAgImRlc2MiOiAiVGl0bGVzIHRvIGhpZGUgKGNvbW1hLXNlcGFyYXRlZCByZWdleGVzKSIKICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJrZXlfZmVhdHVyZSJdLAogICAgICAgICAgICAidXNlc0FwaSI6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImFkZFRhZ3NUb0hOUXMiLAogICAgICAgICAgICAiZGVzYyI6ICJTaG93IEhOUSB0YWdzIG9uIGhvdmVyIGluIHRoZSBzaWRlYmFyIiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIldoZW4gaG92ZXJpbmcgb3ZlciBhIHF1ZXN0aW9uIHRpdGxlIGluIHRoZSBIb3QgTmV0d29yayBRdWVzdGlvbnMgc2lkZWJhciwgdGhlIHF1ZXN0aW9uJ3MgdGFncyBmcm9tIHRoZSBvcmlnaW5hdGluZyBzaXRlIHdpbGwgYmUgc2hvd24iLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wIiwKICAgICAgICAgICAgInVzZXNBcGkiOiB0cnVlCiAgICAgICAgfV0sCiAgICAgICAgIkNoYXQiOiBbewogICAgICAgICAgICAibmFtZSI6ICJjaGF0RWFzeUFjY2VzcyIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBidXR0b25zIHRvIHVzZXIgcHJvZmlsZXMgdG8gY2hhbmdlIHVzZXIgd3JpdGUgYWNjZXNzIGRpcmVjdGx5IGZyb20gYSBjaGF0IHJvb20iLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yMDM0ODAiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovL2NoYXQuKi5jb20vKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIiIKICAgICAgICB9LCAgewogICAgICAgICAgICAibmFtZSI6ICJyZXBseVRvT3duQ2hhdE1lc3NhZ2VzIiwKICAgICAgICAgICAgImRlc2MiOiAiQWRkIHJlcGx5IHNpZ25zIHRvIHlvdXIgb3duIGNoYXQgbWVzc2FnZXMiLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovL2NoYXQuKi5jb20vcm9vbXMvKiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIiIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogInJlbmFtZUNoYXQiLAogICAgICAgICAgICAiZGVzYyI6ICJQcmVwZW5kICdDaGF0IC0gJyB0byBjaGF0IHRhYnMnIHRpdGxlcyIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzI0NjI4OSIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vY2hhdC4qLmNvbS8qIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAic2Nyb2xsQ2hhdFJvb21zTGlzdCIsCiAgICAgICAgICAgICJkZXNjIjogIkVuYWJsZSBzY3JvbGxpbmcgZm9yIHJvb20gbGlzdCBpbiB1c2VyY2FyZHMgYW5kIHNpZGViYXIgd2hlbiB0aGVyZSBhcmUgbWFueSByb29tcyIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjIjogIkVuYWJsZSBzY3JvbGxpbmcgaW4gdGhlIHJvb20gbGlzdCB3aXRoaW4gdXNlcmNhcmRzIGFuZCBzaWRlYmFyIHdoZW4gdGhlcmUncyBhIHNpZ25pZmljYW50IGFtb3VudCBvZiByb29tcyBpbiB0aGUgbGlzdCwgcmF0aGVyIHRoYW4gdGhlIGxpc3Qgb3ZlcmZsb3dpbmcgYW5kIGhpZGluZyBzb21lIGNvbnRlbnQuIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvMTgzNDc5IiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly9jaGF0LiouY29tL3Jvb21zLyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIiCiAgICAgICAgfV0sCiAgICAgICAgIlZvdGluZyI6IFt7CiAgICAgICAgICAgICJuYW1lIjogImJldHRlckNTUyIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBleHRyYSBDU1MgZm9yIGFuaW1hdGlvbiBhY3Rpb25zIG9uIHZvdGluZyBhbmQgZmF2b3VyaXRlIGJ1dHRvbnMiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiUHVsc2UgZWZmZWN0IHdoZW4gaG92ZXJpbmcgb3ZlciB0aGUgdXB2b3RlL2Rvd252b3RlL2Zhdm91cml0ZSBidXR0b25zLiBDdXJyZW50bHkgb25seSBpbXBsZW1lbnRlZCBuYXRpdmVseSBvbiBBbmRyb2lkLlNFLiIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzI1MjY4NSIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9yZXZpZXcqIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAsKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiLAogICAgICAgICAgICAiZmVhdHVyZV9wYWNrcyI6IFsibWFqb3JfdWkiXQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAic3RpY2t5Vm90ZUJ1dHRvbnMiLAogICAgICAgICAgICAiZGVzYyI6ICJNYWtlIHZvdGUgYnV0dG9ucyBuZXh0IHRvIHBvc3RzIHN0aWNreSB3aGlsc3Qgc2Nyb2xsaW5nIG9uIHRoYXQgcG9zdCIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9hLzM1MDQ3IiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qLCo6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICJTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrLCo6Ly8qL3F1ZXN0aW9ucy90YWdnZWQqLCo6Ly8qL3F1ZXN0aW9ucy9ncmVhdGVzdC1oaXRzKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJtYWpvcl91aSwga2V5X2ZlYXR1cmUiLCAicG93ZXJfdXNlciJdCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJkaXNhYmxlVm90ZUJ1dHRvbnMiLAogICAgICAgICAgICAiZGVzYyI6ICJEaXNhYmxlIHZvdGUgYnV0dG9ucyBvbiB5b3VyIG93biBwb3N0cyBhbmQgZGVsZXRlZCBwb3N0cywgd2hpY2ggeW91IGNhbm5vdCB2b3RlIG9uIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucy8qIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAsKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiCiAgICAgICAgfV0sCiAgICAgICAgIkV4dHJhcyI6IFt7CiAgICAgICAgICAgICJuYW1lIjogImxpbmtlZFBvc3RzSW5saW5lIiwKICAgICAgICAgICAgImRlc2MiOiAiRGlzcGxheSBsaW5rZWQgcG9zdHMgaW5saW5lIGJ5IGNsaWNraW5nIG9uIGFuIGFycm93IiwKICAgICAgICAgICAgImV4dGVuZGVkX2Rlc2NyaXB0aW9uIjogIkFkZHMgYSBidXR0b24gbmV4dCB0byBTdGFjayBFeGNoYW5nZSBwb3N0cyB0aGF0IGV4cGFuZCB0byBzaG93IHRoZSBwb3N0IGlubGluZSIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9yZXZpZXcqIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAsKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiLAogICAgICAgICAgICAidXNlc0FwaSI6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogInBhcnNlQ3Jvc3NTaXRlTGlua3MiLAogICAgICAgICAgICAiZGVzYyI6ICJQYXJzZSB0aXRsZXMgdG8gbGlua3MgY3Jvc3MtU0Utc2l0ZXMiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiRGV0ZWN0cyBsaW5rcyB0byBvdGhlciBxdWVzdGlvbnMgb24gU0Ugc2l0ZXMgYW5kIGNvbnZlcnRzIHRoZW0gdG8gdGhlaXIgdGl0bGUiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS8yNTExODMiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyosKjovLyovcmV2aWV3KiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIiwKICAgICAgICAgICAgInVzZXNBcGkiOiB0cnVlCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJxdWlja0F1dGhvckluZm8iLAogICAgICAgICAgICAiZGVzYyI6ICJTaG93IHdoZW4gdGhlIHBvc3QncyBhdXRob3Igd2FzIGxhc3Qgc2VlbiBhbmQgd2hldGhlciB0aGV5IGFyZSByZWdpc3RlcmVkIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucyosKjovLyovcmV2aWV3KiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovL2NoYXQuKi5jb20vKiIsCiAgICAgICAgICAgICJmZWF0dXJlX3BhY2tzIjogWyJwb3dlcl91c2VyIl0sCiAgICAgICAgICAgICJ1c2VzQXBpIjogdHJ1ZQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAic2hhcmVMaW5rc1ByaXZhY3kiLAogICAgICAgICAgICAiZGVzYyI6ICJSZW1vdmUgeW91ciB1c2VyIElEIGZyb20gdGhlICdzaGFyZScgbGluayIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjcmlwdGlvbiI6ICJXaGVuIHlvdSBjbGljayAnc2hhcmUnIHVuZGVyIGEgcG9zdCwgdGhpcyBkaXNwbGF5cyBhIHJlZmVycmFsIGxpbmssIHdoaWNoIGluY29ycG9yYXRlcyB5b3VyIHVzZXIgSUQuIFRoaXMgb3B0aW9uIHN0cmlwcyB5b3VyIHVzZXIgSUQgZnJvbSB0aGUgZGlzcGxheWVkIGxpbmssIHByZXZlbnRpbmcgaW5hZHZlcnRlbnQgcHJpdmFjeSBsZWFrcyB3aGVuIGRpc3NlbWluYXRpbmcgdGhlIGxpbmsgdmlhIGNvcHktcGFzdGUuIFRoZSBzb2NpYWwtbWVkaWEgc2hhcmluZyBidXR0b25zIGFyZSB1bmFmZmVjdGVkLCBzaW5jZSB0aGUgbGFjayBvZiBwcml2YWN5IGlzIG9idmlvdXMuIiwKICAgICAgICAgICAgIm1ldGEiOiAiaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3EvNzQyNzQiLAogICAgICAgICAgICAibWF0Y2giOiAiKjovLyovcXVlc3Rpb25zLyosKjovLyovcmV2aWV3KiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIlNFMS4wLCo6Ly8qL3F1ZXN0aW9ucy9hc2ssKjovLyovcXVlc3Rpb25zL3RhZ2dlZCosKjovLyovcXVlc3Rpb25zL2dyZWF0ZXN0LWhpdHMqIiwKICAgICAgICAgICAgImZlYXR1cmVfcGFja3MiOiBbInBvd2VyX3VzZXIiXQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAic2hhcmVMaW5rc01hcmtkb3duIiwKICAgICAgICAgICAgImRlc2MiOiAiQ2hhbmdlICdzaGFyZScgbGluayB0byBmb3JtYXQgb2YgW3Bvc3QtbmFtZV0odXJsKSIsCiAgICAgICAgICAgICJleHRlbmRlZF9kZXNjcmlwdGlvbiI6ICJXaGVuIHlvdSBjbGljayAnc2hhcmUnIHVuZGVyIGEgcG9zdCwgdGhpcyB3aWxsIGNvbnZlcnQgdGhlIFVSTCBnaXZlbiB0byBhIG1hcmtkb3duLWZyaWVuZGx5IHZlcnNpb24sIHdpdGggdGhlIHBvc3QgbmFtZSBhcyB0aGUgbGluayB0ZXh0LiBUaGlzIGZlYXR1cmUgYWxzbyBhdXRvbWF0aWNhbGx5IGNvcGllcyB0aGUgY29udmVydGVkIHN0cmluZyB0byB5b3VyIGNsaXBib2FyZCIsCiAgICAgICAgICAgICJtZXRhIjogImh0dHBzOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzEyNjU0NCIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9yZXZpZXcqIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiU0UxLjAsKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJzb3J0QnlCb3VudHlBbW91bnQiLAogICAgICAgICAgICAiZGVzYyI6ICJBZGQgYW4gb3B0aW9uIHRvIGZpbHRlciBib3VudGllcyBieSB0aGVpciBhbW91bnQiLAogICAgICAgICAgICAibWV0YSI6ICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcS83NzUzIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly8qL3VzZXJzLyosKjovL2NoYXQuKi5jb20vKixTRTEuMCwqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9yZXZpZXcqIgogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAid2Fybk5vdExvZ2dlZEluIiwKICAgICAgICAgICAgImRlc2MiOiAiV2FybiB5b3Ugd2hlbiB5b3UgYXJlIG5vdCBsb2dnZWQgaW4iLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovL2NoYXQuKi5jb20vKixTRTEuMCIKICAgICAgICB9LCB7CiAgICAgICAgICAgICJuYW1lIjogImhpZGVDZXJ0YWluUXVlc3Rpb25zIiwKICAgICAgICAgICAgImRlc2MiOiAiSGlkZSBvbiBob2xkLCBjbG9zZWQsIG9yIGR1cGxpY2F0ZSBxdWVzdGlvbnMgb3IgZGVsZXRlZCBhbnN3ZXJzIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyoiLAogICAgICAgICAgICAic2V0dGluZ3MiOiBbewogICAgICAgICAgICAgICAgImlkIjogImR1cGxpY2F0ZSIsCiAgICAgICAgICAgICAgICAidHlwZSI6ICJjaGVja2JveCIsCiAgICAgICAgICAgICAgICAiZGVzYyI6ICJIaWRlIGR1cGxpY2F0ZSBxdWVzdGlvbnM/IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAiaWQiOiAiY2xvc2VkIiwKICAgICAgICAgICAgICAgICJ0eXBlIjogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgICJkZXNjIjogIkhpZGUgY2xvc2VkIHF1ZXN0aW9ucz8iCiAgICAgICAgICAgIH0sICB7CiAgICAgICAgICAgICAgICAiaWQiOiAibWlncmF0ZWQiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiY2hlY2tib3giLAogICAgICAgICAgICAgICAgImRlc2MiOiAiSGlkZSBtaWdyYXRlZCBxdWVzdGlvbnM/IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAiaWQiOiAib25Ib2xkIiwKICAgICAgICAgICAgICAgICJ0eXBlIjogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgICJkZXNjIjogIkhpZGUgb24gaG9sZCBxdWVzdGlvbnM/IgogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAiaWQiOiAiZGVsZXRlZEFuc3dlcnMiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiY2hlY2tib3giLAogICAgICAgICAgICAgICAgImRlc2MiOiAiSGlkZSBkZWxldGVkIGFuc3dlcnM/IgogICAgICAgICAgICB9XQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAic2hvd01ldGFSZXZpZXdDb3VudCIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBob3cgbWFueSByZXZpZXdzIGFyZSBhdmFpbGFibGUgb24gTWV0YSB0byB0aGUgbWFpbiBzaXRlIHJldmlldyBwYWdlIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3JldmlldyIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9tZXRhLiouY29tLyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJjb3B5Q29kZSIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIGJ1dHRvbiB0byBjb2RlIGluIHBvc3RzIHRvIGxldCB5b3UgY29weSBpdCIsCiAgICAgICAgICAgICJtZXRhIjogIiIsCiAgICAgICAgICAgICJtYXRjaCI6ICIqOi8vKi9xdWVzdGlvbnMvKiwqOi8vKi9yZXZpZXcqIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovLyovcXVlc3Rpb25zL2FzaywqOi8vKi9xdWVzdGlvbnMvdGFnZ2VkKiwqOi8vKi9xdWVzdGlvbnMvZ3JlYXRlc3QtaGl0cyoiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJkYWlseVJldmlld0JhciIsCiAgICAgICAgICAgICJkZXNjIjogIkFkZCBhIHByb2dyZXNzIGJhciBzaG93aW5nIGhvdyBtYW55IHJldmlld3MgeW91IGhhdmUgbGVmdCBpbiB0aGUgZGF5IiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3JldmlldyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJvcGVuTGlua3NJbk5ld1RhYiIsCiAgICAgICAgICAgICJkZXNjIjogIk9wZW4gYW55IGxpbmtzIHRvIHRoZSBzcGVjaWZpZWQgc2l0ZXMgaW4gYSBuZXcgdGFiIGJ5IGRlZmF1bHQiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiWW91IG5lZWQgdG8gc2V0IHRoZSBzaXRlcyB5b3Vyc2VsZiBieSBjbGlja2luZyB0aGUgYnV0dG9uIG5leHQgdG8gdGhpcyBmZWF0dXJlIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIio6Ly8qL3F1ZXN0aW9ucyoiLAogICAgICAgICAgICAiZXhjbHVkZSI6ICIiLAogICAgICAgICAgICAic2V0dGluZ3MiOiBbewogICAgICAgICAgICAgICAgImlkIjogImxpbmtzVG9PcGVuSW5OZXdUYWIiLAogICAgICAgICAgICAgICAgInR5cGUiOiAidGV4dGFyZWEiLAogICAgICAgICAgICAgICAgImRlc2MiOiAiTGlua3MgdG8gb3BlbiBpbiBuZXcgdGFiIChjb21tYS1zZXBhcmF0ZWQgbWF0Y2ggcGF0dGVybnMpIgogICAgICAgICAgICB9XQogICAgICAgIH0sIHsKICAgICAgICAgICAgIm5hbWUiOiAiYWRkT25Ub3BpY0xpbmtUb1NpdGVTd2l0Y2hlciIsCiAgICAgICAgICAgICJkZXNjIjogIlJlcGxhY2UgdGhlICdoZWxwJyBsaW5rIHdpdGggYW4gJ29uLXRvcGljJyBsaW5rIGluIHRoZSBzaXRlIHN3aXRjaGVyIGRyb3Bkb3duIiwKICAgICAgICAgICAgIm1ldGEiOiAiIiwKICAgICAgICAgICAgIm1hdGNoIjogIiIsCiAgICAgICAgICAgICJleGNsdWRlIjogIio6Ly9jaGF0LiouY29tLyosU0UxLjAiCiAgICAgICAgfSwgewogICAgICAgICAgICAibmFtZSI6ICJjdXN0b21NYWdpY0xpbmtzIiwKICAgICAgICAgICAgImRlc2MiOiAiQWRkIGN1c3RvbSBtYWdpYyBsaW5rcyB0byBjb21tZW50cyBhbmQgcG9zdHMiLAogICAgICAgICAgICAiZXh0ZW5kZWRfZGVzY3JpcHRpb24iOiAiQWxsb3dzIHlvdSB0byBjcmVhdGUgeW91ciBvd24gbWFnaWMgbGlua3MgKCdbdGV4dF0nIGF1dG8tY29udmVydHMgdG8gYSBsaW5rIG9mIHlvdXIgY2hvaWNlKS4gTGlua3MgY2FuIHVzZSB0aGUgcGxhY2Vob2xkZXJzICRCQVNFVVJMLCAkTUVUQUJBU0VVUkwsICRRVUVTVElPTklELCBhbmQgJEFOU1dFUklEIHdoaWNoIGFyZSBhdXRvLXJlcGxhY2VkIHdpdGggdGhlIHJlc3BlY3RpdmUgZGF0YS4gWW91IGNhbiBzZXQgdGhlIHJlYXNvbnMgYnkgY2xpY2tpbmcgdGhlICdNYWdpYyBMaW5rcycgYnV0dG9uIGFkZGVkIHRvIHRoZSAnSGVscCcgZHJvcGRvd24gYXQgdGhlIHRvcC1yaWdodCBvZiB0aGUgcGFnZS4gU2VlIGh0dHBzOi8vc3RhY2thcHBzLmNvbS9xLzY2NTAgZm9yIG1vcmUgZGV0YWlscy4iLAogICAgICAgICAgICAibWV0YSI6ICIiLAogICAgICAgICAgICAibWF0Y2giOiAiIiwKICAgICAgICAgICAgImV4Y2x1ZGUiOiAiKjovL2NoYXQuKi5jb20vKixTRTEuMCwqOi8vKi9xdWVzdGlvbnMvYXNrIiwKICAgICAgICAgICAgImZlYXR1cmVfcGFja3MiOiBbInBvd2VyX3VzZXIiXQogICAgICAgIH1dCiAgICB9Cn0KCg=="},{"meta":{"name":"sox.common.info.json","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.common.info.json","ts":1609797269961,"mimetype":"text/plain"},"source":"ewogICAgInByaXZpbGVnZXMiOiB7CiAgICAgICAgImJldGEiOiB7CiAgICAgICAgICAgICJhY2Nlc3MgcmV2aWV3IHF1ZXVlcyI6IDM1MCwKICAgICAgICAgICAgImFjY2VzcyB0byBtb2RlcmF0b3IgdG9vbHMiOiAyMDAwLAogICAgICAgICAgICAiYXBwcm92ZSB0YWcgd2lraSBlZGl0cyI6IDE1MDAsCiAgICAgICAgICAgICJjYXN0IGNsb3NlIGFuZCByZW9wZW4gdm90ZXMiOiA1MDAsCiAgICAgICAgICAgICJjb21tZW50IGV2ZXJ5d2hlcmUiOiA1MCwKICAgICAgICAgICAgImNyZWF0ZSBjaGF0IHJvb21zIjogMTAwLAogICAgICAgICAgICAiY3JlYXRlIGdhbGxlcnkgY2hhdCByb29tcyI6IDEwMDAsCiAgICAgICAgICAgICJjcmVhdGUgcG9zdHMiOiAxLAogICAgICAgICAgICAiY3JlYXRlIHRhZyBzeW5vbnltcyI6IDEyNTAsCiAgICAgICAgICAgICJjcmVhdGUgdGFncyI6IDE1MCwKICAgICAgICAgICAgImNyZWF0ZSB3aWtpIHBvc3RzIjogMTAsCiAgICAgICAgICAgICJlZGl0IGNvbW11bml0eSB3aWtpIjogMTAwLAogICAgICAgICAgICAiZWRpdCBxdWVzdGlvbnMgYW5kIGFuc3dlcnMiOiAxMDAwLAogICAgICAgICAgICAiZXN0YWJsaXNoZWQgdXNlciI6IDc1MCwKICAgICAgICAgICAgImZsYWcgcG9zdHMiOiAxNSwKICAgICAgICAgICAgInBhcnRpY2lwYXRlIGluIG1ldGEiOiA1LAogICAgICAgICAgICAicHJvdGVjdCBxdWVzdGlvbnMiOiAzNTAwLAogICAgICAgICAgICAicmVtb3ZlIG5ldyB1c2VyIHJlc3RyaWN0aW9ucyI6IDEwLAogICAgICAgICAgICAic2V0IGJvdW50aWVzIjogNzUsCiAgICAgICAgICAgICJ0YWxrIGluIGNoYXQiOiAyMCwKICAgICAgICAgICAgInRydXN0ZWQgdXNlciI6IDQwMDAsCiAgICAgICAgICAgICJ2aWV3IGNsb3NlIHZvdGVzIjogMjUwLAogICAgICAgICAgICAidm90ZSBkb3duIjogMTI1LAogICAgICAgICAgICAidm90ZSB1cCI6IDE1CiAgICAgICAgfSwKICAgICAgICAiZ3JhZHVhdGVkIjogewogICAgICAgICAgICAiYWNjZXNzIHJldmlldyBxdWV1ZXMiOiAyMDAwLAogICAgICAgICAgICAiYWNjZXNzIHRvIG1vZGVyYXRvciB0b29scyI6IDEwMDAwLAogICAgICAgICAgICAiYXBwcm92ZSB0YWcgd2lraSBlZGl0cyI6IDUwMDAsCiAgICAgICAgICAgICJjYXN0IGNsb3NlIGFuZCByZW9wZW4gdm90ZXMiOiAzMDAwLAogICAgICAgICAgICAiY29tbWVudCBldmVyeXdoZXJlIjogNSwKICAgICAgICAgICAgImNyZWF0ZSBjaGF0IHJvb21zIjogMTAwLAogICAgICAgICAgICAiY3JlYXRlIGdhbGxlcnkgY2hhdCByb29tcyI6IDEwMDAsCiAgICAgICAgICAgICJjcmVhdGUgcG9zdHMiOiAxLAogICAgICAgICAgICAiY3JlYXRlIHRhZyBzeW5vbnltcyI6IDI1MDAsCiAgICAgICAgICAgICJjcmVhdGUgdGFncyI6IDUwMCwKICAgICAgICAgICAgImNyZWF0ZSB3aWtpIHBvc3RzIjogMTAsCiAgICAgICAgICAgICJlZGl0IGNvbW11bml0eSB3aWtpIjogMTAwLAogICAgICAgICAgICAiZWRpdCBxdWVzdGlvbnMgYW5kIGFuc3dlcnMiOiAyMDAwLAogICAgICAgICAgICAiZXN0YWJsaXNoZWQgdXNlciI6IDEwMDAsCiAgICAgICAgICAgICJmbGFnIHBvc3RzIjogMTUsCiAgICAgICAgICAgICJwYXJ0aWNpcGF0ZSBpbiBtZXRhIjogNSwKICAgICAgICAgICAgInByb3RlY3QgcXVlc3Rpb25zIjogMTUwMDAsCiAgICAgICAgICAgICJyZWR1Y2UgYWRzIjogMjAwLAogICAgICAgICAgICAicmVtb3ZlIG5ldyB1c2VyIHJlc3RyaWN0aW9ucyI6IDEwLAogICAgICAgICAgICAic2V0IGJvdW50aWVzIjogNzUsCiAgICAgICAgICAgICJ0YWxrIGluIGNoYXQiOiAyMCwKICAgICAgICAgICAgInRydXN0ZWQgdXNlciI6IDIwMDAwLAogICAgICAgICAgICAidmlldyBjbG9zZSB2b3RlcyI6IDI1MCwKICAgICAgICAgICAgInZvdGUgZG93biI6IDEyNSwKICAgICAgICAgICAgInZvdGUgdXAiOiAxNQogICAgICAgIH0KICAgIH0KfQo="},{"meta":{"name":"sox.sprites.svg","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.sprites.svg","ts":1609797269968,"mimetype":"text/plain"},"source":"PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8c3ltYm9sIGlkPSJzb3hfYWNjZXNzX3RpbWUiIHZpZXdCb3g9IjAgMCAxOCAxOCIgZmlsbD0idmFyKC0tYmxhY2stNjAwKSI+PHBhdGggZD0iTSA5IDE3IEEgOCA4IDAgMSAxIDkgMSBhIDggOCAwIDAgMSAwIDE2IFogbSAwIC0yIEEgNiA2IDAgMSAwIDkgMyBhIDYgNiAwIDAgMCAwIDEyIFogTSA4IDUgaCAxLjAxIEwgOSA5LjM2IGwgMy4yMiAyLjEgbCAtMC42IDAuOTMgTCA4IDEwIFYgNSBaIiAvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X2NoZWNrZWRfYm94IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9InZhcigtLWJsYWNrLTkwMCkiPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48cGF0aCBkPSJNMTkgM0g1Yy0xLjExIDAtMiAuOS0yIDJ2MTRjMCAxLjEuODkgMiAyIDJoMTRjMS4xMSAwIDItLjkgMi0yVjVjMC0xLjEtLjg5LTItMi0yem0tOSAxNGwtNS01IDEuNDEtMS40MUwxMCAxNC4xN2w3LjU5LTcuNTlMMTkgOGwtOSA5eiIvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X2NoZXZyb25fbGVmdCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ2YXIoLS1ibGFjay05MDApIj48cGF0aCBkPSJNMTUuNDEgNy40MUwxNCA2bC02IDYgNiA2IDEuNDEtMS40MUwxMC44MyAxMnoiLz48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+Cjwvc3ltYm9sPgo8c3ltYm9sIGlkPSJzb3hfY2hldnJvbl9yaWdodCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ2YXIoLS1ibGFjay05MDApIj48cGF0aCBkPSJNMTAgNkw4LjU5IDcuNDEgMTMuMTcgMTJsLTQuNTggNC41OUwxMCAxOGw2LTZ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X2NvcHkiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0idmFyKC0tYmxhY2stNjAwKSI+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIvPjxwYXRoIGQ9Ik0xNiAxSDRjLTEuMSAwLTIgLjktMiAydjE0aDJWM2gxMlYxem0tMSA0bDYgNnYxMGMwIDEuMS0uOSAyLTIgMkg3Ljk5QzYuODkgMjMgNiAyMi4xIDYgMjFsLjAxLTE0YzAtMS4xLjg5LTIgMS45OS0yaDd6bS0xIDdoNS41TDE0IDYuNVYxMnoiLz4KPC9zeW1ib2w+CjxzeW1ib2wgaWQ9InNveF9leHBvcnQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0idmFyKC0tYmxhY2stOTAwKSI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMC4wOSAxNS41OUwxMS41IDE3bDUtNS01LTUtMS40MSAxLjQxTDEyLjY3IDExSDN2Mmg5LjY3bC0yLjU4IDIuNTl6TTE5IDNINWMtMS4xMSAwLTIgLjktMiAydjRoMlY1aDE0djE0SDV2LTRIM3Y0YzAgMS4xLjg5IDIgMiAyaDE0YzEuMSAwIDItLjkgMi0yVjVjMC0xLjEtLjktMi0yLTJ6Ii8+Cjwvc3ltYm9sPgo8c3ltYm9sIGlkPSJzb3hfaG90IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xMy41LjY3cy43NCAyLjY1Ljc0IDQuOGMwIDIuMDYtMS4zNSAzLjczLTMuNDEgMy43My0yLjA3IDAtMy42My0xLjY3LTMuNjMtMy43M2wuMDMtLjM2QzUuMjEgNy41MSA0IDEwLjYyIDQgMTRjMCA0LjQyIDMuNTggOCA4IDhzOC0zLjU4IDgtOEMyMCA4LjYxIDE3LjQxIDMuOCAxMy41LjY3ek0xMS43MSAxOWMtMS43OCAwLTMuMjItMS40LTMuMjItMy4xNCAwLTEuNjIgMS4wNS0yLjc2IDIuODEtMy4xMiAxLjc3LS4zNiAzLjYtMS4yMSA0LjYyLTIuNTguMzkgMS4yOS41OSAyLjY1LjU5IDQuMDQgMCAyLjY1LTIuMTUgNC44LTQuOCA0Ljh6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X2ltcG9ydCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ2YXIoLS1ibGFjay05MDApIj48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTIxIDMuMDFIM2MtMS4xIDAtMiAuOS0yIDJWOWgyVjQuOTloMTh2MTQuMDNIM1YxNUgxdjQuMDFjMCAxLjEuOSAxLjk4IDIgMS45OGgxOGMxLjEgMCAyLS44OCAyLTEuOTh2LTE0YzAtMS4xMS0uOS0yLTItMnpNMTEgMTZsNC00LTQtNHYzSDF2MmgxMHYzeiIvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X2luZm8iIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0idmFyKC0tYmxhY2stNjAwKSI+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xMiAyQzYuNDggMiAyIDYuNDggMiAxMnM0LjQ4IDEwIDEwIDEwIDEwLTQuNDggMTAtMTBTMTcuNTIgMiAxMiAyem0xIDE1aC0ydi02aDJ2NnptMC04aC0yVjdoMnYyeiIvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X2tleSIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ2YXIoLS1ibGFjay05MDApIj48cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyLjY1IDEwQzExLjgzIDcuNjcgOS42MSA2IDcgNmMtMy4zMSAwLTYgMi42OS02IDZzMi42OSA2IDYgNmMyLjYxIDAgNC44My0xLjY3IDUuNjUtNEgxN3Y0aDR2LTRoMnYtNEgxMi42NXpNNyAxNGMtMS4xIDAtMi0uOS0yLTJzLjktMiAyLTIgMiAuOSAyIDItLjkgMi0yIDJ6Ii8+Cjwvc3ltYm9sPgo8c3ltYm9sIGlkPSJzb3hfbGF1bmNoIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48cGF0aCBkPSJNMTkgMTlINVY1aDdWM0g1Yy0xLjExIDAtMiAuOS0yIDJ2MTRjMCAxLjEuODkgMiAyIDJoMTRjMS4xIDAgMi0uOSAyLTJ2LTdoLTJ2N3pNMTQgM3YyaDMuNTlsLTkuODMgOS44MyAxLjQxIDEuNDFMMTkgNi40MVYxMGgyVjNoLTd6Ii8+Cjwvc3ltYm9sPgo8c3ltYm9sIGlkPSJzb3hfc2VhcmNoIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xNS41IDE0aC0uNzlsLS4yOC0uMjdDMTUuNDEgMTIuNTkgMTYgMTEuMTEgMTYgOS41IDE2IDUuOTEgMTMuMDkgMyA5LjUgM1MzIDUuOTEgMyA5LjUgNS45MSAxNiA5LjUgMTZjMS42MSAwIDMuMDktLjU5IDQuMjMtMS41N2wuMjcuMjh2Ljc5bDUgNC45OUwyMC40OSAxOWwtNC45OS01em0tNiAwQzcuMDEgMTQgNSAxMS45OSA1IDkuNVM3LjAxIDUgOS41IDUgMTQgNy4wMSAxNCA5LjUgMTEuOTkgMTQgOS41IDE0eiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zeW1ib2w+CjxzeW1ib2wgaWQ9InNveF9zZXR0aW5ncyIgdmlld0JveD0iMCAwIDIwIDIwIj48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDIwdjIwSDBWMHoiLz48cGF0aCBkPSJNMTUuOTUgMTAuNzhjLjAzLS4yNS4wNS0uNTEuMDUtLjc4cy0uMDItLjUzLS4wNi0uNzhsMS42OS0xLjMyYy4xNS0uMTIuMTktLjM0LjEtLjUxbC0xLjYtMi43N2MtLjEtLjE4LS4zMS0uMjQtLjQ5LS4xOGwtMS45OS44Yy0uNDItLjMyLS44Ni0uNTgtMS4zNS0uNzhMMTIgMi4zNGMtLjAzLS4yLS4yLS4zNC0uNC0uMzRIOC40Yy0uMiAwLS4zNi4xNC0uMzkuMzRsLS4zIDIuMTJjLS40OS4yLS45NC40Ny0xLjM1Ljc4bC0xLjk5LS44Yy0uMTgtLjA3LS4zOSAwLS40OS4xOGwtMS42IDIuNzdjLS4xLjE4LS4wNi4zOS4xLjUxbDEuNjkgMS4zMmMtLjA0LjI1LS4wNy41Mi0uMDcuNzhzLjAyLjUzLjA2Ljc4TDIuMzcgMTIuMWMtLjE1LjEyLS4xOS4zNC0uMS41MWwxLjYgMi43N2MuMS4xOC4zMS4yNC40OS4xOGwxLjk5LS44Yy40Mi4zMi44Ni41OCAxLjM1Ljc4bC4zIDIuMTJjLjA0LjIuMi4zNC40LjM0aDMuMmMuMiAwIC4zNy0uMTQuMzktLjM0bC4zLTIuMTJjLjQ5LS4yLjk0LS40NyAxLjM1LS43OGwxLjk5LjhjLjE4LjA3LjM5IDAgLjQ5LS4xOGwxLjYtMi43N2MuMS0uMTguMDYtLjM5LS4xLS41MWwtMS42Ny0xLjMyek0xMCAxM2MtMS42NSAwLTMtMS4zNS0zLTNzMS4zNS0zIDMtMyAzIDEuMzUgMyAzLTEuMzUgMy0zIDN6Ii8+Cjwvc3ltYm9sPgo8c3ltYm9sIGlkPSJzb3hfdG9nZ2xlX29mZiIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTcgN0g3Yy0yLjc2IDAtNSAyLjI0LTUgNXMyLjI0IDUgNSA1aDEwYzIuNzYgMCA1LTIuMjQgNS01cy0yLjI0LTUtNS01ek03IDE1Yy0xLjY2IDAtMy0xLjM0LTMtM3MxLjM0LTMgMy0zIDMgMS4zNCAzIDMtMS4zNCAzLTMgM3oiLz48cGF0aCBmaWxsPSJub25lIiBkPSJNMCAwaDI0djI0SDB6Ii8+Cjwvc3ltYm9sPgo8c3ltYm9sIGlkPSJzb3hfdG9nZ2xlX29uIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xNyA3SDdjLTIuNzYgMC01IDIuMjQtNSA1czIuMjQgNSA1IDVoMTBjMi43NiAwIDUtMi4yNCA1LTVzLTIuMjQtNS01LTV6bTAgOGMtMS42NiAwLTMtMS4zNC0zLTNzMS4zNC0zIDMtMyAzIDEuMzQgMyAzLTEuMzQgMy0zIDN6Ii8+PHBhdGggZmlsbD0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIvPgo8L3N5bWJvbD4KPHN5bWJvbCBpZD0ic294X3RvcCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNOCAxMWgzdjEwaDJWMTFoM2wtNC00LTQgNHpNNCAzdjJoMTZWM0g0eiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zeW1ib2w+CjxzeW1ib2wgaWQ9InNveF91bmNoZWNrZWRfYm94IiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIGQ9Ik0xOSA1djE0SDVWNWgxNG0wLTJINWMtMS4xIDAtMiAuOS0yIDJ2MTRjMCAxLjEuOSAyIDIgMmgxNGMxLjEgMCAyLS45IDItMlY1YzAtMS4xLS45LTItMi0yeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KPC9zeW1ib2w+CjxzeW1ib2wgaWQ9InNveF93cmVuY2giIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0idmFyKC0tYmxhY2stOTAwKSI+PHBhdGggZmlsbD0ibm9uZSIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMCAwaDI0djI0SDB6Ii8+PHBhdGggZD0iTTIyLjcgMTlsLTkuMS05LjFjLjktMi4zLjQtNS0xLjUtNi45LTItMi01LTIuNC03LjQtMS4zTDkgNiA2IDkgMS42IDQuN0MuNCA3LjEuOSAxMC4xIDIuOSAxMi4xYzEuOSAxLjkgNC42IDIuNCA2LjkgMS41bDkuMSA5LjFjLjQuNCAxIC40IDEuNCAwbDIuMy0yLjNjLjUtLjQuNS0xLjEuMS0xLjR6Ii8+Cjwvc3ltYm9sPjwvc3ZnPgo="}],"requires":[{"meta":{"name":"jquery-3.3.1.min.js","url":"https://code.jquery.com/jquery-3.3.1.min.js","ts":1609797275329,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2My4zLjEgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovCiFmdW5jdGlvbihlLHQpeyJ1c2Ugc3RyaWN0Ijsib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmIm9iamVjdCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9tb2R1bGUuZXhwb3J0cz1lLmRvY3VtZW50P3QoZSwhMCk6ZnVuY3Rpb24oZSl7aWYoIWUuZG9jdW1lbnQpdGhyb3cgbmV3IEVycm9yKCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50Iik7cmV0dXJuIHQoZSl9OnQoZSl9KCJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzp0aGlzLGZ1bmN0aW9uKGUsdCl7InVzZSBzdHJpY3QiO3ZhciBuPVtdLHI9ZS5kb2N1bWVudCxpPU9iamVjdC5nZXRQcm90b3R5cGVPZixvPW4uc2xpY2UsYT1uLmNvbmNhdCxzPW4ucHVzaCx1PW4uaW5kZXhPZixsPXt9LGM9bC50b1N0cmluZyxmPWwuaGFzT3duUHJvcGVydHkscD1mLnRvU3RyaW5nLGQ9cC5jYWxsKE9iamVjdCksaD17fSxnPWZ1bmN0aW9uIGUodCl7cmV0dXJuImZ1bmN0aW9uIj09dHlwZW9mIHQmJiJudW1iZXIiIT10eXBlb2YgdC5ub2RlVHlwZX0seT1mdW5jdGlvbiBlKHQpe3JldHVybiBudWxsIT10JiZ0PT09dC53aW5kb3d9LHY9e3R5cGU6ITAsc3JjOiEwLG5vTW9kdWxlOiEwfTtmdW5jdGlvbiBtKGUsdCxuKXt2YXIgaSxvPSh0PXR8fHIpLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO2lmKG8udGV4dD1lLG4pZm9yKGkgaW4gdiluW2ldJiYob1tpXT1uW2ldKTt0LmhlYWQuYXBwZW5kQ2hpbGQobykucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKX1mdW5jdGlvbiB4KGUpe3JldHVybiBudWxsPT1lP2UrIiI6Im9iamVjdCI9PXR5cGVvZiBlfHwiZnVuY3Rpb24iPT10eXBlb2YgZT9sW2MuY2FsbChlKV18fCJvYmplY3QiOnR5cGVvZiBlfXZhciBiPSIzLjMuMSIsdz1mdW5jdGlvbihlLHQpe3JldHVybiBuZXcgdy5mbi5pbml0KGUsdCl9LFQ9L15bXHNcdUZFRkZceEEwXSt8W1xzXHVGRUZGXHhBMF0rJC9nO3cuZm49dy5wcm90b3R5cGU9e2pxdWVyeToiMy4zLjEiLGNvbnN0cnVjdG9yOncsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBvLmNhbGwodGhpcyl9LGdldDpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09ZT9vLmNhbGwodGhpcyk6ZTwwP3RoaXNbZSt0aGlzLmxlbmd0aF06dGhpc1tlXX0scHVzaFN0YWNrOmZ1bmN0aW9uKGUpe3ZhciB0PXcubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGUpO3JldHVybiB0LnByZXZPYmplY3Q9dGhpcyx0fSxlYWNoOmZ1bmN0aW9uKGUpe3JldHVybiB3LmVhY2godGhpcyxlKX0sbWFwOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnB1c2hTdGFjayh3Lm1hcCh0aGlzLGZ1bmN0aW9uKHQsbil7cmV0dXJuIGUuY2FsbCh0LG4sdCl9KSl9LHNsaWNlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG8uYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXE6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5sZW5ndGgsbj0rZSsoZTwwP3Q6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4+PTAmJm48dD9bdGhpc1tuXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKCl9LHB1c2g6cyxzb3J0Om4uc29ydCxzcGxpY2U6bi5zcGxpY2V9LHcuZXh0ZW5kPXcuZm4uZXh0ZW5kPWZ1bmN0aW9uKCl7dmFyIGUsdCxuLHIsaSxvLGE9YXJndW1lbnRzWzBdfHx7fSxzPTEsdT1hcmd1bWVudHMubGVuZ3RoLGw9ITE7Zm9yKCJib29sZWFuIj09dHlwZW9mIGEmJihsPWEsYT1hcmd1bWVudHNbc118fHt9LHMrKyksIm9iamVjdCI9PXR5cGVvZiBhfHxnKGEpfHwoYT17fSkscz09PXUmJihhPXRoaXMscy0tKTtzPHU7cysrKWlmKG51bGwhPShlPWFyZ3VtZW50c1tzXSkpZm9yKHQgaW4gZSluPWFbdF0sYSE9PShyPWVbdF0pJiYobCYmciYmKHcuaXNQbGFpbk9iamVjdChyKXx8KGk9QXJyYXkuaXNBcnJheShyKSkpPyhpPyhpPSExLG89biYmQXJyYXkuaXNBcnJheShuKT9uOltdKTpvPW4mJncuaXNQbGFpbk9iamVjdChuKT9uOnt9LGFbdF09dy5leHRlbmQobCxvLHIpKTp2b2lkIDAhPT1yJiYoYVt0XT1yKSk7cmV0dXJuIGF9LHcuZXh0ZW5kKHtleHBhbmRvOiJqUXVlcnkiKygiMy4zLjEiK01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csIiIpLGlzUmVhZHk6ITAsZXJyb3I6ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKGUpfSxub29wOmZ1bmN0aW9uKCl7fSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0LG47cmV0dXJuISghZXx8IltvYmplY3QgT2JqZWN0XSIhPT1jLmNhbGwoZSkpJiYoISh0PWkoZSkpfHwiZnVuY3Rpb24iPT10eXBlb2Yobj1mLmNhbGwodCwiY29uc3RydWN0b3IiKSYmdC5jb25zdHJ1Y3RvcikmJnAuY2FsbChuKT09PWQpfSxpc0VtcHR5T2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0O2Zvcih0IGluIGUpcmV0dXJuITE7cmV0dXJuITB9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oZSl7bShlKX0sZWFjaDpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MDtpZihDKGUpKXtmb3Iobj1lLmxlbmd0aDtyPG47cisrKWlmKCExPT09dC5jYWxsKGVbcl0scixlW3JdKSlicmVha31lbHNlIGZvcihyIGluIGUpaWYoITE9PT10LmNhbGwoZVtyXSxyLGVbcl0pKWJyZWFrO3JldHVybiBlfSx0cmltOmZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lPyIiOihlKyIiKS5yZXBsYWNlKFQsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oZSx0KXt2YXIgbj10fHxbXTtyZXR1cm4gbnVsbCE9ZSYmKEMoT2JqZWN0KGUpKT93Lm1lcmdlKG4sInN0cmluZyI9PXR5cGVvZiBlP1tlXTplKTpzLmNhbGwobixlKSksbn0saW5BcnJheTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIG51bGw9PXQ/LTE6dS5jYWxsKHQsZSxuKX0sbWVyZ2U6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49K3QubGVuZ3RoLHI9MCxpPWUubGVuZ3RoO3I8bjtyKyspZVtpKytdPXRbcl07cmV0dXJuIGUubGVuZ3RoPWksZX0sZ3JlcDpmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByLGk9W10sbz0wLGE9ZS5sZW5ndGgscz0hbjtvPGE7bysrKShyPSF0KGVbb10sbykpIT09cyYmaS5wdXNoKGVbb10pO3JldHVybiBpfSxtYXA6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz0wLHM9W107aWYoQyhlKSlmb3Iocj1lLmxlbmd0aDtvPHI7bysrKW51bGwhPShpPXQoZVtvXSxvLG4pKSYmcy5wdXNoKGkpO2Vsc2UgZm9yKG8gaW4gZSludWxsIT0oaT10KGVbb10sbyxuKSkmJnMucHVzaChpKTtyZXR1cm4gYS5hcHBseShbXSxzKX0sZ3VpZDoxLHN1cHBvcnQ6aH0pLCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJih3LmZuW1N5bWJvbC5pdGVyYXRvcl09bltTeW1ib2wuaXRlcmF0b3JdKSx3LmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGUsdCl7bFsiW29iamVjdCAiK3QrIl0iXT10LnRvTG93ZXJDYXNlKCl9KTtmdW5jdGlvbiBDKGUpe3ZhciB0PSEhZSYmImxlbmd0aCJpbiBlJiZlLmxlbmd0aCxuPXgoZSk7cmV0dXJuIWcoZSkmJiF5KGUpJiYoImFycmF5Ij09PW58fDA9PT10fHwibnVtYmVyIj09dHlwZW9mIHQmJnQ+MCYmdC0xIGluIGUpfXZhciBFPWZ1bmN0aW9uKGUpe3ZhciB0LG4scixpLG8sYSxzLHUsbCxjLGYscCxkLGgsZyx5LHYsbSx4LGI9InNpenpsZSIrMSpuZXcgRGF0ZSx3PWUuZG9jdW1lbnQsVD0wLEM9MCxFPWFlKCksaz1hZSgpLFM9YWUoKSxEPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9PT10JiYoZj0hMCksMH0sTj17fS5oYXNPd25Qcm9wZXJ0eSxBPVtdLGo9QS5wb3AscT1BLnB1c2gsTD1BLnB1c2gsSD1BLnNsaWNlLE89ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MCxyPWUubGVuZ3RoO248cjtuKyspaWYoZVtuXT09PXQpcmV0dXJuIG47cmV0dXJuLTF9LFA9ImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkIixNPSJbXFx4MjBcXHRcXHJcXG5cXGZdIixSPSIoPzpcXFxcLnxbXFx3LV18W15cMC1cXHhhMF0pKyIsST0iXFxbIitNKyIqKCIrUisiKSg/OiIrTSsiKihbKl4kfCF+XT89KSIrTSsiKig/OicoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwifCgiK1IrIikpfCkiK00rIipcXF0iLFc9IjooIitSKyIpKD86XFwoKCgnKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8KCg/OlxcXFwufFteXFxcXCgpW1xcXV18IitJKyIpKil8LiopXFwpfCkiLCQ9bmV3IFJlZ0V4cChNKyIrIiwiZyIpLEI9bmV3IFJlZ0V4cCgiXiIrTSsiK3woKD86XnxbXlxcXFxdKSg/OlxcXFwuKSopIitNKyIrJCIsImciKSxGPW5ldyBSZWdFeHAoIl4iK00rIiosIitNKyIqIiksXz1uZXcgUmVnRXhwKCJeIitNKyIqKFs+K35dfCIrTSsiKSIrTSsiKiIpLHo9bmV3IFJlZ0V4cCgiPSIrTSsiKihbXlxcXSdcIl0qPykiK00rIipcXF0iLCJnIiksWD1uZXcgUmVnRXhwKFcpLFU9bmV3IFJlZ0V4cCgiXiIrUisiJCIpLFY9e0lEOm5ldyBSZWdFeHAoIl4jKCIrUisiKSIpLENMQVNTOm5ldyBSZWdFeHAoIl5cXC4oIitSKyIpIiksVEFHOm5ldyBSZWdFeHAoIl4oIitSKyJ8WypdKSIpLEFUVFI6bmV3IFJlZ0V4cCgiXiIrSSksUFNFVURPOm5ldyBSZWdFeHAoIl4iK1cpLENISUxEOm5ldyBSZWdFeHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIrTSsiKihldmVufG9kZHwoKFsrLV18KShcXGQqKW58KSIrTSsiKig/OihbKy1dfCkiK00rIiooXFxkKyl8KSkiK00rIipcXCl8KSIsImkiKSxib29sOm5ldyBSZWdFeHAoIl4oPzoiK1ArIikkIiwiaSIpLG5lZWRzQ29udGV4dDpuZXcgUmVnRXhwKCJeIitNKyIqWz4rfl18OihldmVufG9kZHxlcXxndHxsdHxudGh8Zmlyc3R8bGFzdCkoPzpcXCgiK00rIiooKD86LVxcZCk/XFxkKikiK00rIipcXCl8KSg/PVteLV18JCkiLCJpIil9LEc9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSxZPS9eaFxkJC9pLFE9L15bXntdK1x7XHMqXFtuYXRpdmUgXHcvLEo9L14oPzojKFtcdy1dKyl8KFx3Kyl8XC4oW1x3LV0rKSkkLyxLPS9bK35dLyxaPW5ldyBSZWdFeHAoIlxcXFwoW1xcZGEtZl17MSw2fSIrTSsiP3woIitNKyIpfC4pIiwiaWciKSxlZT1mdW5jdGlvbihlLHQsbil7dmFyIHI9IjB4Iit0LTY1NTM2O3JldHVybiByIT09cnx8bj90OnI8MD9TdHJpbmcuZnJvbUNoYXJDb2RlKHIrNjU1MzYpOlN0cmluZy5mcm9tQ2hhckNvZGUocj4+MTB8NTUyOTYsMTAyMyZyfDU2MzIwKX0sdGU9LyhbXDAtXHgxZlx4N2ZdfF4tP1xkKXxeLSR8W15cMC1ceDFmXHg3Zi1cdUZGRkZcdy1dL2csbmU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdD8iXDAiPT09ZT8iXHVmZmZkIjplLnNsaWNlKDAsLTEpKyJcXCIrZS5jaGFyQ29kZUF0KGUubGVuZ3RoLTEpLnRvU3RyaW5nKDE2KSsiICI6IlxcIitlfSxyZT1mdW5jdGlvbigpe3AoKX0saWU9bWUoZnVuY3Rpb24oZSl7cmV0dXJuITA9PT1lLmRpc2FibGVkJiYoImZvcm0iaW4gZXx8ImxhYmVsImluIGUpfSx7ZGlyOiJwYXJlbnROb2RlIixuZXh0OiJsZWdlbmQifSk7dHJ5e0wuYXBwbHkoQT1ILmNhbGwody5jaGlsZE5vZGVzKSx3LmNoaWxkTm9kZXMpLEFbdy5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZSl7TD17YXBwbHk6QS5sZW5ndGg/ZnVuY3Rpb24oZSx0KXtxLmFwcGx5KGUsSC5jYWxsKHQpKX06ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLmxlbmd0aCxyPTA7d2hpbGUoZVtuKytdPXRbcisrXSk7ZS5sZW5ndGg9bi0xfX19ZnVuY3Rpb24gb2UoZSx0LHIsaSl7dmFyIG8scyxsLGMsZixoLHYsbT10JiZ0Lm93bmVyRG9jdW1lbnQsVD10P3Qubm9kZVR5cGU6OTtpZihyPXJ8fFtdLCJzdHJpbmciIT10eXBlb2YgZXx8IWV8fDEhPT1UJiY5IT09VCYmMTEhPT1UKXJldHVybiByO2lmKCFpJiYoKHQ/dC5vd25lckRvY3VtZW50fHx0OncpIT09ZCYmcCh0KSx0PXR8fGQsZykpe2lmKDExIT09VCYmKGY9Si5leGVjKGUpKSlpZihvPWZbMV0pe2lmKDk9PT1UKXtpZighKGw9dC5nZXRFbGVtZW50QnlJZChvKSkpcmV0dXJuIHI7aWYobC5pZD09PW8pcmV0dXJuIHIucHVzaChsKSxyfWVsc2UgaWYobSYmKGw9bS5nZXRFbGVtZW50QnlJZChvKSkmJngodCxsKSYmbC5pZD09PW8pcmV0dXJuIHIucHVzaChsKSxyfWVsc2V7aWYoZlsyXSlyZXR1cm4gTC5hcHBseShyLHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSkpLHI7aWYoKG89ZlszXSkmJm4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBMLmFwcGx5KHIsdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG8pKSxyfWlmKG4ucXNhJiYhU1tlKyIgIl0mJigheXx8IXkudGVzdChlKSkpe2lmKDEhPT1UKW09dCx2PWU7ZWxzZSBpZigib2JqZWN0IiE9PXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSl7KGM9dC5nZXRBdHRyaWJ1dGUoImlkIikpP2M9Yy5yZXBsYWNlKHRlLG5lKTp0LnNldEF0dHJpYnV0ZSgiaWQiLGM9Yikscz0oaD1hKGUpKS5sZW5ndGg7d2hpbGUocy0tKWhbc109IiMiK2MrIiAiK3ZlKGhbc10pO3Y9aC5qb2luKCIsIiksbT1LLnRlc3QoZSkmJmdlKHQucGFyZW50Tm9kZSl8fHR9aWYodil0cnl7cmV0dXJuIEwuYXBwbHkocixtLnF1ZXJ5U2VsZWN0b3JBbGwodikpLHJ9Y2F0Y2goZSl7fWZpbmFsbHl7Yz09PWImJnQucmVtb3ZlQXR0cmlidXRlKCJpZCIpfX19cmV0dXJuIHUoZS5yZXBsYWNlKEIsIiQxIiksdCxyLGkpfWZ1bmN0aW9uIGFlKCl7dmFyIGU9W107ZnVuY3Rpb24gdChuLGkpe3JldHVybiBlLnB1c2gobisiICIpPnIuY2FjaGVMZW5ndGgmJmRlbGV0ZSB0W2Uuc2hpZnQoKV0sdFtuKyIgIl09aX1yZXR1cm4gdH1mdW5jdGlvbiBzZShlKXtyZXR1cm4gZVtiXT0hMCxlfWZ1bmN0aW9uIHVlKGUpe3ZhciB0PWQuY3JlYXRlRWxlbWVudCgiZmllbGRzZXQiKTt0cnl7cmV0dXJuISFlKHQpfWNhdGNoKGUpe3JldHVybiExfWZpbmFsbHl7dC5wYXJlbnROb2RlJiZ0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCksdD1udWxsfX1mdW5jdGlvbiBsZShlLHQpe3ZhciBuPWUuc3BsaXQoInwiKSxpPW4ubGVuZ3RoO3doaWxlKGktLSlyLmF0dHJIYW5kbGVbbltpXV09dH1mdW5jdGlvbiBjZShlLHQpe3ZhciBuPXQmJmUscj1uJiYxPT09ZS5ub2RlVHlwZSYmMT09PXQubm9kZVR5cGUmJmUuc291cmNlSW5kZXgtdC5zb3VyY2VJbmRleDtpZihyKXJldHVybiByO2lmKG4pd2hpbGUobj1uLm5leHRTaWJsaW5nKWlmKG49PT10KXJldHVybi0xO3JldHVybiBlPzE6LTF9ZnVuY3Rpb24gZmUoZSl7cmV0dXJuIGZ1bmN0aW9uKHQpe3JldHVybiJpbnB1dCI9PT10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkmJnQudHlwZT09PWV9fWZ1bmN0aW9uIHBlKGUpe3JldHVybiBmdW5jdGlvbih0KXt2YXIgbj10Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKCJpbnB1dCI9PT1ufHwiYnV0dG9uIj09PW4pJiZ0LnR5cGU9PT1lfX1mdW5jdGlvbiBkZShlKXtyZXR1cm4gZnVuY3Rpb24odCl7cmV0dXJuImZvcm0iaW4gdD90LnBhcmVudE5vZGUmJiExPT09dC5kaXNhYmxlZD8ibGFiZWwiaW4gdD8ibGFiZWwiaW4gdC5wYXJlbnROb2RlP3QucGFyZW50Tm9kZS5kaXNhYmxlZD09PWU6dC5kaXNhYmxlZD09PWU6dC5pc0Rpc2FibGVkPT09ZXx8dC5pc0Rpc2FibGVkIT09IWUmJmllKHQpPT09ZTp0LmRpc2FibGVkPT09ZToibGFiZWwiaW4gdCYmdC5kaXNhYmxlZD09PWV9fWZ1bmN0aW9uIGhlKGUpe3JldHVybiBzZShmdW5jdGlvbih0KXtyZXR1cm4gdD0rdCxzZShmdW5jdGlvbihuLHIpe3ZhciBpLG89ZShbXSxuLmxlbmd0aCx0KSxhPW8ubGVuZ3RoO3doaWxlKGEtLSluW2k9b1thXV0mJihuW2ldPSEocltpXT1uW2ldKSl9KX0pfWZ1bmN0aW9uIGdlKGUpe3JldHVybiBlJiYidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmV9bj1vZS5zdXBwb3J0PXt9LG89b2UuaXNYTUw9ZnVuY3Rpb24oZSl7dmFyIHQ9ZSYmKGUub3duZXJEb2N1bWVudHx8ZSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiEhdCYmIkhUTUwiIT09dC5ub2RlTmFtZX0scD1vZS5zZXREb2N1bWVudD1mdW5jdGlvbihlKXt2YXIgdCxpLGE9ZT9lLm93bmVyRG9jdW1lbnR8fGU6dztyZXR1cm4gYSE9PWQmJjk9PT1hLm5vZGVUeXBlJiZhLmRvY3VtZW50RWxlbWVudD8oZD1hLGg9ZC5kb2N1bWVudEVsZW1lbnQsZz0hbyhkKSx3IT09ZCYmKGk9ZC5kZWZhdWx0VmlldykmJmkudG9wIT09aSYmKGkuYWRkRXZlbnRMaXN0ZW5lcj9pLmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIscmUsITEpOmkuYXR0YWNoRXZlbnQmJmkuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixyZSkpLG4uYXR0cmlidXRlcz11ZShmdW5jdGlvbihlKXtyZXR1cm4gZS5jbGFzc05hbWU9ImkiLCFlLmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIil9KSxuLmdldEVsZW1lbnRzQnlUYWdOYW1lPXVlKGZ1bmN0aW9uKGUpe3JldHVybiBlLmFwcGVuZENoaWxkKGQuY3JlYXRlQ29tbWVudCgiIikpLCFlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RofSksbi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPVEudGVzdChkLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLG4uZ2V0QnlJZD11ZShmdW5jdGlvbihlKXtyZXR1cm4gaC5hcHBlbmRDaGlsZChlKS5pZD1iLCFkLmdldEVsZW1lbnRzQnlOYW1lfHwhZC5nZXRFbGVtZW50c0J5TmFtZShiKS5sZW5ndGh9KSxuLmdldEJ5SWQ/KHIuZmlsdGVyLklEPWZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShaLGVlKTtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIGUuZ2V0QXR0cmlidXRlKCJpZCIpPT09dH19LHIuZmluZC5JRD1mdW5jdGlvbihlLHQpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgdC5nZXRFbGVtZW50QnlJZCYmZyl7dmFyIG49dC5nZXRFbGVtZW50QnlJZChlKTtyZXR1cm4gbj9bbl06W119fSk6KHIuZmlsdGVyLklEPWZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShaLGVlKTtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIG49InVuZGVmaW5lZCIhPXR5cGVvZiBlLmdldEF0dHJpYnV0ZU5vZGUmJmUuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTtyZXR1cm4gbiYmbi52YWx1ZT09PXR9fSxyLmZpbmQuSUQ9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudEJ5SWQmJmcpe3ZhciBuLHIsaSxvPXQuZ2V0RWxlbWVudEJ5SWQoZSk7aWYobyl7aWYoKG49by5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpKSYmbi52YWx1ZT09PWUpcmV0dXJuW29dO2k9dC5nZXRFbGVtZW50c0J5TmFtZShlKSxyPTA7d2hpbGUobz1pW3IrK10paWYoKG49by5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpKSYmbi52YWx1ZT09PWUpcmV0dXJuW29dfXJldHVybltdfX0pLHIuZmluZC5UQUc9bi5nZXRFbGVtZW50c0J5VGFnTmFtZT9mdW5jdGlvbihlLHQpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgdC5nZXRFbGVtZW50c0J5VGFnTmFtZT90LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUpOm4ucXNhP3QucXVlcnlTZWxlY3RvckFsbChlKTp2b2lkIDB9OmZ1bmN0aW9uKGUsdCl7dmFyIG4scj1bXSxpPTAsbz10LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUpO2lmKCIqIj09PWUpe3doaWxlKG49b1tpKytdKTE9PT1uLm5vZGVUeXBlJiZyLnB1c2gobik7cmV0dXJuIHJ9cmV0dXJuIG99LHIuZmluZC5DTEFTUz1uLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmcpcmV0dXJuIHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShlKX0sdj1bXSx5PVtdLChuLnFzYT1RLnRlc3QoZC5xdWVyeVNlbGVjdG9yQWxsKSkmJih1ZShmdW5jdGlvbihlKXtoLmFwcGVuZENoaWxkKGUpLmlubmVySFRNTD0iPGEgaWQ9JyIrYisiJz48L2E+PHNlbGVjdCBpZD0nIitiKyItXHJcXCcgbXNhbGxvd2NhcHR1cmU9Jyc+PG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVjdD4iLGUucXVlcnlTZWxlY3RvckFsbCgiW21zYWxsb3djYXB0dXJlXj0nJ10iKS5sZW5ndGgmJnkucHVzaCgiWypeJF09IitNKyIqKD86Jyd8XCJcIikiKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGh8fHkucHVzaCgiXFxbIitNKyIqKD86dmFsdWV8IitQKyIpIiksZS5xdWVyeVNlbGVjdG9yQWxsKCJbaWR+PSIrYisiLV0iKS5sZW5ndGh8fHkucHVzaCgifj0iKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RofHx5LnB1c2goIjpjaGVja2VkIiksZS5xdWVyeVNlbGVjdG9yQWxsKCJhIyIrYisiKyoiKS5sZW5ndGh8fHkucHVzaCgiLiMuK1srfl0iKX0pLHVlKGZ1bmN0aW9uKGUpe2UuaW5uZXJIVE1MPSI8YSBocmVmPScnIGRpc2FibGVkPSdkaXNhYmxlZCc+PC9hPjxzZWxlY3QgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0aW9uLz48L3NlbGVjdD4iO3ZhciB0PWQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTt0LnNldEF0dHJpYnV0ZSgidHlwZSIsImhpZGRlbiIpLGUuYXBwZW5kQ2hpbGQodCkuc2V0QXR0cmlidXRlKCJuYW1lIiwiRCIpLGUucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGgmJnkucHVzaCgibmFtZSIrTSsiKlsqXiR8IX5dPz0iKSwyIT09ZS5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCYmeS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLGguYXBwZW5kQ2hpbGQoZSkuZGlzYWJsZWQ9ITAsMiE9PWUucXVlcnlTZWxlY3RvckFsbCgiOmRpc2FibGVkIikubGVuZ3RoJiZ5LnB1c2goIjplbmFibGVkIiwiOmRpc2FibGVkIiksZS5xdWVyeVNlbGVjdG9yQWxsKCIqLDp4IikseS5wdXNoKCIsLio6Iil9KSksKG4ubWF0Y2hlc1NlbGVjdG9yPVEudGVzdChtPWgubWF0Y2hlc3x8aC53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fGgubW96TWF0Y2hlc1NlbGVjdG9yfHxoLm9NYXRjaGVzU2VsZWN0b3J8fGgubXNNYXRjaGVzU2VsZWN0b3IpKSYmdWUoZnVuY3Rpb24oZSl7bi5kaXNjb25uZWN0ZWRNYXRjaD1tLmNhbGwoZSwiKiIpLG0uY2FsbChlLCJbcyE9JyddOngiKSx2LnB1c2goIiE9IixXKX0pLHk9eS5sZW5ndGgmJm5ldyBSZWdFeHAoeS5qb2luKCJ8IikpLHY9di5sZW5ndGgmJm5ldyBSZWdFeHAodi5qb2luKCJ8IikpLHQ9US50ZXN0KGguY29tcGFyZURvY3VtZW50UG9zaXRpb24pLHg9dHx8US50ZXN0KGguY29udGFpbnMpP2Z1bmN0aW9uKGUsdCl7dmFyIG49OT09PWUubm9kZVR5cGU/ZS5kb2N1bWVudEVsZW1lbnQ6ZSxyPXQmJnQucGFyZW50Tm9kZTtyZXR1cm4gZT09PXJ8fCEoIXJ8fDEhPT1yLm5vZGVUeXBlfHwhKG4uY29udGFpbnM/bi5jb250YWlucyhyKTplLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKHIpKSl9OmZ1bmN0aW9uKGUsdCl7aWYodCl3aGlsZSh0PXQucGFyZW50Tm9kZSlpZih0PT09ZSlyZXR1cm4hMDtyZXR1cm4hMX0sRD10P2Z1bmN0aW9uKGUsdCl7aWYoZT09PXQpcmV0dXJuIGY9ITAsMDt2YXIgcj0hZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbi0hdC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjtyZXR1cm4gcnx8KDEmKHI9KGUub3duZXJEb2N1bWVudHx8ZSk9PT0odC5vd25lckRvY3VtZW50fHx0KT9lLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKHQpOjEpfHwhbi5zb3J0RGV0YWNoZWQmJnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZSk9PT1yP2U9PT1kfHxlLm93bmVyRG9jdW1lbnQ9PT13JiZ4KHcsZSk/LTE6dD09PWR8fHQub3duZXJEb2N1bWVudD09PXcmJngodyx0KT8xOmM/TyhjLGUpLU8oYyx0KTowOjQmcj8tMToxKX06ZnVuY3Rpb24oZSx0KXtpZihlPT09dClyZXR1cm4gZj0hMCwwO3ZhciBuLHI9MCxpPWUucGFyZW50Tm9kZSxvPXQucGFyZW50Tm9kZSxhPVtlXSxzPVt0XTtpZighaXx8IW8pcmV0dXJuIGU9PT1kPy0xOnQ9PT1kPzE6aT8tMTpvPzE6Yz9PKGMsZSktTyhjLHQpOjA7aWYoaT09PW8pcmV0dXJuIGNlKGUsdCk7bj1lO3doaWxlKG49bi5wYXJlbnROb2RlKWEudW5zaGlmdChuKTtuPXQ7d2hpbGUobj1uLnBhcmVudE5vZGUpcy51bnNoaWZ0KG4pO3doaWxlKGFbcl09PT1zW3JdKXIrKztyZXR1cm4gcj9jZShhW3JdLHNbcl0pOmFbcl09PT13Py0xOnNbcl09PT13PzE6MH0sZCk6ZH0sb2UubWF0Y2hlcz1mdW5jdGlvbihlLHQpe3JldHVybiBvZShlLG51bGwsbnVsbCx0KX0sb2UubWF0Y2hlc1NlbGVjdG9yPWZ1bmN0aW9uKGUsdCl7aWYoKGUub3duZXJEb2N1bWVudHx8ZSkhPT1kJiZwKGUpLHQ9dC5yZXBsYWNlKHosIj0nJDEnXSIpLG4ubWF0Y2hlc1NlbGVjdG9yJiZnJiYhU1t0KyIgIl0mJighdnx8IXYudGVzdCh0KSkmJigheXx8IXkudGVzdCh0KSkpdHJ5e3ZhciByPW0uY2FsbChlLHQpO2lmKHJ8fG4uZGlzY29ubmVjdGVkTWF0Y2h8fGUuZG9jdW1lbnQmJjExIT09ZS5kb2N1bWVudC5ub2RlVHlwZSlyZXR1cm4gcn1jYXRjaChlKXt9cmV0dXJuIG9lKHQsZCxudWxsLFtlXSkubGVuZ3RoPjB9LG9lLmNvbnRhaW5zPWZ1bmN0aW9uKGUsdCl7cmV0dXJuKGUub3duZXJEb2N1bWVudHx8ZSkhPT1kJiZwKGUpLHgoZSx0KX0sb2UuYXR0cj1mdW5jdGlvbihlLHQpeyhlLm93bmVyRG9jdW1lbnR8fGUpIT09ZCYmcChlKTt2YXIgaT1yLmF0dHJIYW5kbGVbdC50b0xvd2VyQ2FzZSgpXSxvPWkmJk4uY2FsbChyLmF0dHJIYW5kbGUsdC50b0xvd2VyQ2FzZSgpKT9pKGUsdCwhZyk6dm9pZCAwO3JldHVybiB2b2lkIDAhPT1vP286bi5hdHRyaWJ1dGVzfHwhZz9lLmdldEF0dHJpYnV0ZSh0KToobz1lLmdldEF0dHJpYnV0ZU5vZGUodCkpJiZvLnNwZWNpZmllZD9vLnZhbHVlOm51bGx9LG9lLmVzY2FwZT1mdW5jdGlvbihlKXtyZXR1cm4oZSsiIikucmVwbGFjZSh0ZSxuZSl9LG9lLmVycm9yPWZ1bmN0aW9uKGUpe3Rocm93IG5ldyBFcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIitlKX0sb2UudW5pcXVlU29ydD1mdW5jdGlvbihlKXt2YXIgdCxyPVtdLGk9MCxvPTA7aWYoZj0hbi5kZXRlY3REdXBsaWNhdGVzLGM9IW4uc29ydFN0YWJsZSYmZS5zbGljZSgwKSxlLnNvcnQoRCksZil7d2hpbGUodD1lW28rK10pdD09PWVbb10mJihpPXIucHVzaChvKSk7d2hpbGUoaS0tKWUuc3BsaWNlKHJbaV0sMSl9cmV0dXJuIGM9bnVsbCxlfSxpPW9lLmdldFRleHQ9ZnVuY3Rpb24oZSl7dmFyIHQsbj0iIixyPTAsbz1lLm5vZGVUeXBlO2lmKG8pe2lmKDE9PT1vfHw5PT09b3x8MTE9PT1vKXtpZigic3RyaW5nIj09dHlwZW9mIGUudGV4dENvbnRlbnQpcmV0dXJuIGUudGV4dENvbnRlbnQ7Zm9yKGU9ZS5maXJzdENoaWxkO2U7ZT1lLm5leHRTaWJsaW5nKW4rPWkoZSl9ZWxzZSBpZigzPT09b3x8ND09PW8pcmV0dXJuIGUubm9kZVZhbHVlfWVsc2Ugd2hpbGUodD1lW3IrK10pbis9aSh0KTtyZXR1cm4gbn0sKHI9b2Uuc2VsZWN0b3JzPXtjYWNoZUxlbmd0aDo1MCxjcmVhdGVQc2V1ZG86c2UsbWF0Y2g6VixhdHRySGFuZGxlOnt9LGZpbmQ6e30scmVsYXRpdmU6eyI+Ijp7ZGlyOiJwYXJlbnROb2RlIixmaXJzdDohMH0sIiAiOntkaXI6InBhcmVudE5vZGUifSwiKyI6e2RpcjoicHJldmlvdXNTaWJsaW5nIixmaXJzdDohMH0sIn4iOntkaXI6InByZXZpb3VzU2libGluZyJ9fSxwcmVGaWx0ZXI6e0FUVFI6ZnVuY3Rpb24oZSl7cmV0dXJuIGVbMV09ZVsxXS5yZXBsYWNlKFosZWUpLGVbM109KGVbM118fGVbNF18fGVbNV18fCIiKS5yZXBsYWNlKFosZWUpLCJ+PSI9PT1lWzJdJiYoZVszXT0iICIrZVszXSsiICIpLGUuc2xpY2UoMCw0KX0sQ0hJTEQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGVbMV09ZVsxXS50b0xvd2VyQ2FzZSgpLCJudGgiPT09ZVsxXS5zbGljZSgwLDMpPyhlWzNdfHxvZS5lcnJvcihlWzBdKSxlWzRdPSsoZVs0XT9lWzVdKyhlWzZdfHwxKToyKigiZXZlbiI9PT1lWzNdfHwib2RkIj09PWVbM10pKSxlWzVdPSsoZVs3XStlWzhdfHwib2RkIj09PWVbM10pKTplWzNdJiZvZS5lcnJvcihlWzBdKSxlfSxQU0VVRE86ZnVuY3Rpb24oZSl7dmFyIHQsbj0hZVs2XSYmZVsyXTtyZXR1cm4gVi5DSElMRC50ZXN0KGVbMF0pP251bGw6KGVbM10/ZVsyXT1lWzRdfHxlWzVdfHwiIjpuJiZYLnRlc3QobikmJih0PWEobiwhMCkpJiYodD1uLmluZGV4T2YoIikiLG4ubGVuZ3RoLXQpLW4ubGVuZ3RoKSYmKGVbMF09ZVswXS5zbGljZSgwLHQpLGVbMl09bi5zbGljZSgwLHQpKSxlLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5yZXBsYWNlKFosZWUpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIioiPT09ZT9mdW5jdGlvbigpe3JldHVybiEwfTpmdW5jdGlvbihlKXtyZXR1cm4gZS5ub2RlTmFtZSYmZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09dH19LENMQVNTOmZ1bmN0aW9uKGUpe3ZhciB0PUVbZSsiICJdO3JldHVybiB0fHwodD1uZXcgUmVnRXhwKCIoXnwiK00rIikiK2UrIigiK00rInwkKSIpKSYmRShlLGZ1bmN0aW9uKGUpe3JldHVybiB0LnRlc3QoInN0cmluZyI9PXR5cGVvZiBlLmNsYXNzTmFtZSYmZS5jbGFzc05hbWV8fCJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRBdHRyaWJ1dGUmJmUuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIil9KX0sQVRUUjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGZ1bmN0aW9uKHIpe3ZhciBpPW9lLmF0dHIocixlKTtyZXR1cm4gbnVsbD09aT8iIT0iPT09dDohdHx8KGkrPSIiLCI9Ij09PXQ/aT09PW46IiE9Ij09PXQ/aSE9PW46Il49Ij09PXQ/biYmMD09PWkuaW5kZXhPZihuKToiKj0iPT09dD9uJiZpLmluZGV4T2Yobik+LTE6IiQ9Ij09PXQ/biYmaS5zbGljZSgtbi5sZW5ndGgpPT09bjoifj0iPT09dD8oIiAiK2kucmVwbGFjZSgkLCIgIikrIiAiKS5pbmRleE9mKG4pPi0xOiJ8PSI9PT10JiYoaT09PW58fGkuc2xpY2UoMCxuLmxlbmd0aCsxKT09PW4rIi0iKSl9fSxDSElMRDpmdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvPSJudGgiIT09ZS5zbGljZSgwLDMpLGE9Imxhc3QiIT09ZS5zbGljZSgtNCkscz0ib2YtdHlwZSI9PT10O3JldHVybiAxPT09ciYmMD09PWk/ZnVuY3Rpb24oZSl7cmV0dXJuISFlLnBhcmVudE5vZGV9OmZ1bmN0aW9uKHQsbix1KXt2YXIgbCxjLGYscCxkLGgsZz1vIT09YT8ibmV4dFNpYmxpbmciOiJwcmV2aW91c1NpYmxpbmciLHk9dC5wYXJlbnROb2RlLHY9cyYmdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLG09IXUmJiFzLHg9ITE7aWYoeSl7aWYobyl7d2hpbGUoZyl7cD10O3doaWxlKHA9cFtnXSlpZihzP3Aubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXY6MT09PXAubm9kZVR5cGUpcmV0dXJuITE7aD1nPSJvbmx5Ij09PWUmJiFoJiYibmV4dFNpYmxpbmcifXJldHVybiEwfWlmKGg9W2E/eS5maXJzdENoaWxkOnkubGFzdENoaWxkXSxhJiZtKXt4PShkPShsPShjPShmPShwPXkpW2JdfHwocFtiXT17fSkpW3AudW5pcXVlSURdfHwoZltwLnVuaXF1ZUlEXT17fSkpW2VdfHxbXSlbMF09PT1UJiZsWzFdKSYmbFsyXSxwPWQmJnkuY2hpbGROb2Rlc1tkXTt3aGlsZShwPSsrZCYmcCYmcFtnXXx8KHg9ZD0wKXx8aC5wb3AoKSlpZigxPT09cC5ub2RlVHlwZSYmKyt4JiZwPT09dCl7Y1tlXT1bVCxkLHhdO2JyZWFrfX1lbHNlIGlmKG0mJih4PWQ9KGw9KGM9KGY9KHA9dClbYl18fChwW2JdPXt9KSlbcC51bmlxdWVJRF18fChmW3AudW5pcXVlSURdPXt9KSlbZV18fFtdKVswXT09PVQmJmxbMV0pLCExPT09eCl3aGlsZShwPSsrZCYmcCYmcFtnXXx8KHg9ZD0wKXx8aC5wb3AoKSlpZigocz9wLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT12OjE9PT1wLm5vZGVUeXBlKSYmKyt4JiYobSYmKChjPShmPXBbYl18fChwW2JdPXt9KSlbcC51bmlxdWVJRF18fChmW3AudW5pcXVlSURdPXt9KSlbZV09W1QseF0pLHA9PT10KSlicmVhaztyZXR1cm4oeC09aSk9PT1yfHx4JXI9PTAmJngvcj49MH19fSxQU0VVRE86ZnVuY3Rpb24oZSx0KXt2YXIgbixpPXIucHNldWRvc1tlXXx8ci5zZXRGaWx0ZXJzW2UudG9Mb3dlckNhc2UoKV18fG9lLmVycm9yKCJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIrZSk7cmV0dXJuIGlbYl0/aSh0KTppLmxlbmd0aD4xPyhuPVtlLGUsIiIsdF0sci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KGUudG9Mb3dlckNhc2UoKSk/c2UoZnVuY3Rpb24oZSxuKXt2YXIgcixvPWkoZSx0KSxhPW8ubGVuZ3RoO3doaWxlKGEtLSllW3I9TyhlLG9bYV0pXT0hKG5bcl09b1thXSl9KTpmdW5jdGlvbihlKXtyZXR1cm4gaShlLDAsbil9KTppfX0scHNldWRvczp7bm90OnNlKGZ1bmN0aW9uKGUpe3ZhciB0PVtdLG49W10scj1zKGUucmVwbGFjZShCLCIkMSIpKTtyZXR1cm4gcltiXT9zZShmdW5jdGlvbihlLHQsbixpKXt2YXIgbyxhPXIoZSxudWxsLGksW10pLHM9ZS5sZW5ndGg7d2hpbGUocy0tKShvPWFbc10pJiYoZVtzXT0hKHRbc109bykpfSk6ZnVuY3Rpb24oZSxpLG8pe3JldHVybiB0WzBdPWUscih0LG51bGwsbyxuKSx0WzBdPW51bGwsIW4ucG9wKCl9fSksaGFzOnNlKGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gb2UoZSx0KS5sZW5ndGg+MH19KSxjb250YWluczpzZShmdW5jdGlvbihlKXtyZXR1cm4gZT1lLnJlcGxhY2UoWixlZSksZnVuY3Rpb24odCl7cmV0dXJuKHQudGV4dENvbnRlbnR8fHQuaW5uZXJUZXh0fHxpKHQpKS5pbmRleE9mKGUpPi0xfX0pLGxhbmc6c2UoZnVuY3Rpb24oZSl7cmV0dXJuIFUudGVzdChlfHwiIil8fG9lLmVycm9yKCJ1bnN1cHBvcnRlZCBsYW5nOiAiK2UpLGU9ZS5yZXBsYWNlKFosZWUpLnRvTG93ZXJDYXNlKCksZnVuY3Rpb24odCl7dmFyIG47ZG97aWYobj1nP3QubGFuZzp0LmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKXx8dC5nZXRBdHRyaWJ1dGUoImxhbmciKSlyZXR1cm4obj1uLnRvTG93ZXJDYXNlKCkpPT09ZXx8MD09PW4uaW5kZXhPZihlKyItIil9d2hpbGUoKHQ9dC5wYXJlbnROb2RlKSYmMT09PXQubm9kZVR5cGUpO3JldHVybiExfX0pLHRhcmdldDpmdW5jdGlvbih0KXt2YXIgbj1lLmxvY2F0aW9uJiZlLmxvY2F0aW9uLmhhc2g7cmV0dXJuIG4mJm4uc2xpY2UoMSk9PT10LmlkfSxyb290OmZ1bmN0aW9uKGUpe3JldHVybiBlPT09aH0sZm9jdXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1kLmFjdGl2ZUVsZW1lbnQmJighZC5oYXNGb2N1c3x8ZC5oYXNGb2N1cygpKSYmISEoZS50eXBlfHxlLmhyZWZ8fH5lLnRhYkluZGV4KX0sZW5hYmxlZDpkZSghMSksZGlzYWJsZWQ6ZGUoITApLGNoZWNrZWQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybiJpbnB1dCI9PT10JiYhIWUuY2hlY2tlZHx8Im9wdGlvbiI9PT10JiYhIWUuc2VsZWN0ZWR9LHNlbGVjdGVkOmZ1bmN0aW9uKGUpe3JldHVybiBlLnBhcmVudE5vZGUmJmUucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LCEwPT09ZS5zZWxlY3RlZH0sZW1wdHk6ZnVuY3Rpb24oZSl7Zm9yKGU9ZS5maXJzdENoaWxkO2U7ZT1lLm5leHRTaWJsaW5nKWlmKGUubm9kZVR5cGU8NilyZXR1cm4hMTtyZXR1cm4hMH0scGFyZW50OmZ1bmN0aW9uKGUpe3JldHVybiFyLnBzZXVkb3MuZW1wdHkoZSl9LGhlYWRlcjpmdW5jdGlvbihlKXtyZXR1cm4gWS50ZXN0KGUubm9kZU5hbWUpfSxpbnB1dDpmdW5jdGlvbihlKXtyZXR1cm4gRy50ZXN0KGUubm9kZU5hbWUpfSxidXR0b246ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybiJpbnB1dCI9PT10JiYiYnV0dG9uIj09PWUudHlwZXx8ImJ1dHRvbiI9PT10fSx0ZXh0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiJpbnB1dCI9PT1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkmJiJ0ZXh0Ij09PWUudHlwZSYmKG51bGw9PSh0PWUuZ2V0QXR0cmlidXRlKCJ0eXBlIikpfHwidGV4dCI9PT10LnRvTG93ZXJDYXNlKCkpfSxmaXJzdDpoZShmdW5jdGlvbigpe3JldHVyblswXX0pLGxhc3Q6aGUoZnVuY3Rpb24oZSx0KXtyZXR1cm5bdC0xXX0pLGVxOmhlKGZ1bmN0aW9uKGUsdCxuKXtyZXR1cm5bbjwwP24rdDpuXX0pLGV2ZW46aGUoZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MDtuPHQ7bis9MillLnB1c2gobik7cmV0dXJuIGV9KSxvZGQ6aGUoZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MTtuPHQ7bis9MillLnB1c2gobik7cmV0dXJuIGV9KSxsdDpoZShmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPW48MD9uK3Q6bjstLXI+PTA7KWUucHVzaChyKTtyZXR1cm4gZX0pLGd0OmhlKGZ1bmN0aW9uKGUsdCxuKXtmb3IodmFyIHI9bjwwP24rdDpuOysrcjx0OyllLnB1c2gocik7cmV0dXJuIGV9KX19KS5wc2V1ZG9zLm50aD1yLnBzZXVkb3MuZXE7Zm9yKHQgaW57cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pci5wc2V1ZG9zW3RdPWZlKHQpO2Zvcih0IGlue3N1Ym1pdDohMCxyZXNldDohMH0pci5wc2V1ZG9zW3RdPXBlKHQpO2Z1bmN0aW9uIHllKCl7fXllLnByb3RvdHlwZT1yLmZpbHRlcnM9ci5wc2V1ZG9zLHIuc2V0RmlsdGVycz1uZXcgeWUsYT1vZS50b2tlbml6ZT1mdW5jdGlvbihlLHQpe3ZhciBuLGksbyxhLHMsdSxsLGM9a1tlKyIgIl07aWYoYylyZXR1cm4gdD8wOmMuc2xpY2UoMCk7cz1lLHU9W10sbD1yLnByZUZpbHRlcjt3aGlsZShzKXtuJiYhKGk9Ri5leGVjKHMpKXx8KGkmJihzPXMuc2xpY2UoaVswXS5sZW5ndGgpfHxzKSx1LnB1c2gobz1bXSkpLG49ITEsKGk9Xy5leGVjKHMpKSYmKG49aS5zaGlmdCgpLG8ucHVzaCh7dmFsdWU6bix0eXBlOmlbMF0ucmVwbGFjZShCLCIgIil9KSxzPXMuc2xpY2Uobi5sZW5ndGgpKTtmb3IoYSBpbiByLmZpbHRlcikhKGk9VlthXS5leGVjKHMpKXx8bFthXSYmIShpPWxbYV0oaSkpfHwobj1pLnNoaWZ0KCksby5wdXNoKHt2YWx1ZTpuLHR5cGU6YSxtYXRjaGVzOml9KSxzPXMuc2xpY2Uobi5sZW5ndGgpKTtpZighbilicmVha31yZXR1cm4gdD9zLmxlbmd0aDpzP29lLmVycm9yKGUpOmsoZSx1KS5zbGljZSgwKX07ZnVuY3Rpb24gdmUoZSl7Zm9yKHZhciB0PTAsbj1lLmxlbmd0aCxyPSIiO3Q8bjt0Kyspcis9ZVt0XS52YWx1ZTtyZXR1cm4gcn1mdW5jdGlvbiBtZShlLHQsbil7dmFyIHI9dC5kaXIsaT10Lm5leHQsbz1pfHxyLGE9biYmInBhcmVudE5vZGUiPT09byxzPUMrKztyZXR1cm4gdC5maXJzdD9mdW5jdGlvbih0LG4saSl7d2hpbGUodD10W3JdKWlmKDE9PT10Lm5vZGVUeXBlfHxhKXJldHVybiBlKHQsbixpKTtyZXR1cm4hMX06ZnVuY3Rpb24odCxuLHUpe3ZhciBsLGMsZixwPVtULHNdO2lmKHUpe3doaWxlKHQ9dFtyXSlpZigoMT09PXQubm9kZVR5cGV8fGEpJiZlKHQsbix1KSlyZXR1cm4hMH1lbHNlIHdoaWxlKHQ9dFtyXSlpZigxPT09dC5ub2RlVHlwZXx8YSlpZihmPXRbYl18fCh0W2JdPXt9KSxjPWZbdC51bmlxdWVJRF18fChmW3QudW5pcXVlSURdPXt9KSxpJiZpPT09dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKXQ9dFtyXXx8dDtlbHNle2lmKChsPWNbb10pJiZsWzBdPT09VCYmbFsxXT09PXMpcmV0dXJuIHBbMl09bFsyXTtpZihjW29dPXAscFsyXT1lKHQsbix1KSlyZXR1cm4hMH1yZXR1cm4hMX19ZnVuY3Rpb24geGUoZSl7cmV0dXJuIGUubGVuZ3RoPjE/ZnVuY3Rpb24odCxuLHIpe3ZhciBpPWUubGVuZ3RoO3doaWxlKGktLSlpZighZVtpXSh0LG4scikpcmV0dXJuITE7cmV0dXJuITB9OmVbMF19ZnVuY3Rpb24gYmUoZSx0LG4pe2Zvcih2YXIgcj0wLGk9dC5sZW5ndGg7cjxpO3IrKylvZShlLHRbcl0sbik7cmV0dXJuIG59ZnVuY3Rpb24gd2UoZSx0LG4scixpKXtmb3IodmFyIG8sYT1bXSxzPTAsdT1lLmxlbmd0aCxsPW51bGwhPXQ7czx1O3MrKykobz1lW3NdKSYmKG4mJiFuKG8scixpKXx8KGEucHVzaChvKSxsJiZ0LnB1c2gocykpKTtyZXR1cm4gYX1mdW5jdGlvbiBUZShlLHQsbixyLGksbyl7cmV0dXJuIHImJiFyW2JdJiYocj1UZShyKSksaSYmIWlbYl0mJihpPVRlKGksbykpLHNlKGZ1bmN0aW9uKG8sYSxzLHUpe3ZhciBsLGMsZixwPVtdLGQ9W10saD1hLmxlbmd0aCxnPW98fGJlKHR8fCIqIixzLm5vZGVUeXBlP1tzXTpzLFtdKSx5PSFlfHwhbyYmdD9nOndlKGcscCxlLHMsdSksdj1uP2l8fChvP2U6aHx8cik/W106YTp5O2lmKG4mJm4oeSx2LHMsdSkscil7bD13ZSh2LGQpLHIobCxbXSxzLHUpLGM9bC5sZW5ndGg7d2hpbGUoYy0tKShmPWxbY10pJiYodltkW2NdXT0hKHlbZFtjXV09ZikpfWlmKG8pe2lmKGl8fGUpe2lmKGkpe2w9W10sYz12Lmxlbmd0aDt3aGlsZShjLS0pKGY9dltjXSkmJmwucHVzaCh5W2NdPWYpO2kobnVsbCx2PVtdLGwsdSl9Yz12Lmxlbmd0aDt3aGlsZShjLS0pKGY9dltjXSkmJihsPWk/TyhvLGYpOnBbY10pPi0xJiYob1tsXT0hKGFbbF09ZikpfX1lbHNlIHY9d2Uodj09PWE/di5zcGxpY2UoaCx2Lmxlbmd0aCk6diksaT9pKG51bGwsYSx2LHUpOkwuYXBwbHkoYSx2KX0pfWZ1bmN0aW9uIENlKGUpe2Zvcih2YXIgdCxuLGksbz1lLmxlbmd0aCxhPXIucmVsYXRpdmVbZVswXS50eXBlXSxzPWF8fHIucmVsYXRpdmVbIiAiXSx1PWE/MTowLGM9bWUoZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT10fSxzLCEwKSxmPW1lKGZ1bmN0aW9uKGUpe3JldHVybiBPKHQsZSk+LTF9LHMsITApLHA9W2Z1bmN0aW9uKGUsbixyKXt2YXIgaT0hYSYmKHJ8fG4hPT1sKXx8KCh0PW4pLm5vZGVUeXBlP2MoZSxuLHIpOmYoZSxuLHIpKTtyZXR1cm4gdD1udWxsLGl9XTt1PG87dSsrKWlmKG49ci5yZWxhdGl2ZVtlW3VdLnR5cGVdKXA9W21lKHhlKHApLG4pXTtlbHNle2lmKChuPXIuZmlsdGVyW2VbdV0udHlwZV0uYXBwbHkobnVsbCxlW3VdLm1hdGNoZXMpKVtiXSl7Zm9yKGk9Kyt1O2k8bztpKyspaWYoci5yZWxhdGl2ZVtlW2ldLnR5cGVdKWJyZWFrO3JldHVybiBUZSh1PjEmJnhlKHApLHU+MSYmdmUoZS5zbGljZSgwLHUtMSkuY29uY2F0KHt2YWx1ZToiICI9PT1lW3UtMl0udHlwZT8iKiI6IiJ9KSkucmVwbGFjZShCLCIkMSIpLG4sdTxpJiZDZShlLnNsaWNlKHUsaSkpLGk8byYmQ2UoZT1lLnNsaWNlKGkpKSxpPG8mJnZlKGUpKX1wLnB1c2gobil9cmV0dXJuIHhlKHApfWZ1bmN0aW9uIEVlKGUsdCl7dmFyIG49dC5sZW5ndGg+MCxpPWUubGVuZ3RoPjAsbz1mdW5jdGlvbihvLGEscyx1LGMpe3ZhciBmLGgseSx2PTAsbT0iMCIseD1vJiZbXSxiPVtdLHc9bCxDPW98fGkmJnIuZmluZC5UQUcoIioiLGMpLEU9VCs9bnVsbD09dz8xOk1hdGgucmFuZG9tKCl8fC4xLGs9Qy5sZW5ndGg7Zm9yKGMmJihsPWE9PT1kfHxhfHxjKTttIT09ayYmbnVsbCE9KGY9Q1ttXSk7bSsrKXtpZihpJiZmKXtoPTAsYXx8Zi5vd25lckRvY3VtZW50PT09ZHx8KHAoZikscz0hZyk7d2hpbGUoeT1lW2grK10paWYoeShmLGF8fGQscykpe3UucHVzaChmKTticmVha31jJiYoVD1FKX1uJiYoKGY9IXkmJmYpJiZ2LS0sbyYmeC5wdXNoKGYpKX1pZih2Kz1tLG4mJm0hPT12KXtoPTA7d2hpbGUoeT10W2grK10peSh4LGIsYSxzKTtpZihvKXtpZih2PjApd2hpbGUobS0tKXhbbV18fGJbbV18fChiW21dPWouY2FsbCh1KSk7Yj13ZShiKX1MLmFwcGx5KHUsYiksYyYmIW8mJmIubGVuZ3RoPjAmJnYrdC5sZW5ndGg+MSYmb2UudW5pcXVlU29ydCh1KX1yZXR1cm4gYyYmKFQ9RSxsPXcpLHh9O3JldHVybiBuP3NlKG8pOm99cmV0dXJuIHM9b2UuY29tcGlsZT1mdW5jdGlvbihlLHQpe3ZhciBuLHI9W10saT1bXSxvPVNbZSsiICJdO2lmKCFvKXt0fHwodD1hKGUpKSxuPXQubGVuZ3RoO3doaWxlKG4tLSkobz1DZSh0W25dKSlbYl0/ci5wdXNoKG8pOmkucHVzaChvKTsobz1TKGUsRWUoaSxyKSkpLnNlbGVjdG9yPWV9cmV0dXJuIG99LHU9b2Uuc2VsZWN0PWZ1bmN0aW9uKGUsdCxuLGkpe3ZhciBvLHUsbCxjLGYscD0iZnVuY3Rpb24iPT10eXBlb2YgZSYmZSxkPSFpJiZhKGU9cC5zZWxlY3Rvcnx8ZSk7aWYobj1ufHxbXSwxPT09ZC5sZW5ndGgpe2lmKCh1PWRbMF09ZFswXS5zbGljZSgwKSkubGVuZ3RoPjImJiJJRCI9PT0obD11WzBdKS50eXBlJiY5PT09dC5ub2RlVHlwZSYmZyYmci5yZWxhdGl2ZVt1WzFdLnR5cGVdKXtpZighKHQ9KHIuZmluZC5JRChsLm1hdGNoZXNbMF0ucmVwbGFjZShaLGVlKSx0KXx8W10pWzBdKSlyZXR1cm4gbjtwJiYodD10LnBhcmVudE5vZGUpLGU9ZS5zbGljZSh1LnNoaWZ0KCkudmFsdWUubGVuZ3RoKX1vPVYubmVlZHNDb250ZXh0LnRlc3QoZSk/MDp1Lmxlbmd0aDt3aGlsZShvLS0pe2lmKGw9dVtvXSxyLnJlbGF0aXZlW2M9bC50eXBlXSlicmVhaztpZigoZj1yLmZpbmRbY10pJiYoaT1mKGwubWF0Y2hlc1swXS5yZXBsYWNlKFosZWUpLEsudGVzdCh1WzBdLnR5cGUpJiZnZSh0LnBhcmVudE5vZGUpfHx0KSkpe2lmKHUuc3BsaWNlKG8sMSksIShlPWkubGVuZ3RoJiZ2ZSh1KSkpcmV0dXJuIEwuYXBwbHkobixpKSxuO2JyZWFrfX19cmV0dXJuKHB8fHMoZSxkKSkoaSx0LCFnLG4sIXR8fEsudGVzdChlKSYmZ2UodC5wYXJlbnROb2RlKXx8dCksbn0sbi5zb3J0U3RhYmxlPWIuc3BsaXQoIiIpLnNvcnQoRCkuam9pbigiIik9PT1iLG4uZGV0ZWN0RHVwbGljYXRlcz0hIWYscCgpLG4uc29ydERldGFjaGVkPXVlKGZ1bmN0aW9uKGUpe3JldHVybiAxJmUuY29tcGFyZURvY3VtZW50UG9zaXRpb24oZC5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpKX0pLHVlKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlubmVySFRNTD0iPGEgaHJlZj0nIyc+PC9hPiIsIiMiPT09ZS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpfSl8fGxlKCJ0eXBlfGhyZWZ8aGVpZ2h0fHdpZHRoIixmdW5jdGlvbihlLHQsbil7aWYoIW4pcmV0dXJuIGUuZ2V0QXR0cmlidXRlKHQsInR5cGUiPT09dC50b0xvd2VyQ2FzZSgpPzE6Mil9KSxuLmF0dHJpYnV0ZXMmJnVlKGZ1bmN0aW9uKGUpe3JldHVybiBlLmlubmVySFRNTD0iPGlucHV0Lz4iLGUuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoInZhbHVlIiwiIiksIiI9PT1lLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpfSl8fGxlKCJ2YWx1ZSIsZnVuY3Rpb24oZSx0LG4pe2lmKCFuJiYiaW5wdXQiPT09ZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiBlLmRlZmF1bHRWYWx1ZX0pLHVlKGZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lLmdldEF0dHJpYnV0ZSgiZGlzYWJsZWQiKX0pfHxsZShQLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZighbilyZXR1cm4hMD09PWVbdF0/dC50b0xvd2VyQ2FzZSgpOihyPWUuZ2V0QXR0cmlidXRlTm9kZSh0KSkmJnIuc3BlY2lmaWVkP3IudmFsdWU6bnVsbH0pLG9lfShlKTt3LmZpbmQ9RSx3LmV4cHI9RS5zZWxlY3RvcnMsdy5leHByWyI6Il09dy5leHByLnBzZXVkb3Msdy51bmlxdWVTb3J0PXcudW5pcXVlPUUudW5pcXVlU29ydCx3LnRleHQ9RS5nZXRUZXh0LHcuaXNYTUxEb2M9RS5pc1hNTCx3LmNvbnRhaW5zPUUuY29udGFpbnMsdy5lc2NhcGVTZWxlY3Rvcj1FLmVzY2FwZTt2YXIgaz1mdW5jdGlvbihlLHQsbil7dmFyIHI9W10saT12b2lkIDAhPT1uO3doaWxlKChlPWVbdF0pJiY5IT09ZS5ub2RlVHlwZSlpZigxPT09ZS5ub2RlVHlwZSl7aWYoaSYmdyhlKS5pcyhuKSlicmVhaztyLnB1c2goZSl9cmV0dXJuIHJ9LFM9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49W107ZTtlPWUubmV4dFNpYmxpbmcpMT09PWUubm9kZVR5cGUmJmUhPT10JiZuLnB1c2goZSk7cmV0dXJuIG59LEQ9dy5leHByLm1hdGNoLm5lZWRzQ29udGV4dDtmdW5jdGlvbiBOKGUsdCl7cmV0dXJuIGUubm9kZU5hbWUmJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXQudG9Mb3dlckNhc2UoKX12YXIgQT0vXjwoW2Etel1bXlwvXDA+Olx4MjBcdFxyXG5cZl0qKVtceDIwXHRcclxuXGZdKlwvPz4oPzo8XC9cMT58KSQvaTtmdW5jdGlvbiBqKGUsdCxuKXtyZXR1cm4gZyh0KT93LmdyZXAoZSxmdW5jdGlvbihlLHIpe3JldHVybiEhdC5jYWxsKGUscixlKSE9PW59KTp0Lm5vZGVUeXBlP3cuZ3JlcChlLGZ1bmN0aW9uKGUpe3JldHVybiBlPT09dCE9PW59KToic3RyaW5nIiE9dHlwZW9mIHQ/dy5ncmVwKGUsZnVuY3Rpb24oZSl7cmV0dXJuIHUuY2FsbCh0LGUpPi0xIT09bn0pOncuZmlsdGVyKHQsZSxuKX13LmZpbHRlcj1mdW5jdGlvbihlLHQsbil7dmFyIHI9dFswXTtyZXR1cm4gbiYmKGU9Ijpub3QoIitlKyIpIiksMT09PXQubGVuZ3RoJiYxPT09ci5ub2RlVHlwZT93LmZpbmQubWF0Y2hlc1NlbGVjdG9yKHIsZSk/W3JdOltdOncuZmluZC5tYXRjaGVzKGUsdy5ncmVwKHQsZnVuY3Rpb24oZSl7cmV0dXJuIDE9PT1lLm5vZGVUeXBlfSkpfSx3LmZuLmV4dGVuZCh7ZmluZDpmdW5jdGlvbihlKXt2YXIgdCxuLHI9dGhpcy5sZW5ndGgsaT10aGlzO2lmKCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm4gdGhpcy5wdXNoU3RhY2sodyhlKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodD0wO3Q8cjt0KyspaWYody5jb250YWlucyhpW3RdLHRoaXMpKXJldHVybiEwfSkpO2ZvcihuPXRoaXMucHVzaFN0YWNrKFtdKSx0PTA7dDxyO3QrKyl3LmZpbmQoZSxpW3RdLG4pO3JldHVybiByPjE/dy51bmlxdWVTb3J0KG4pOm59LGZpbHRlcjpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soaih0aGlzLGV8fFtdLCExKSl9LG5vdDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soaih0aGlzLGV8fFtdLCEwKSl9LGlzOmZ1bmN0aW9uKGUpe3JldHVybiEhaih0aGlzLCJzdHJpbmciPT10eXBlb2YgZSYmRC50ZXN0KGUpP3coZSk6ZXx8W10sITEpLmxlbmd0aH19KTt2YXIgcSxMPS9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKykpJC87KHcuZm4uaW5pdD1mdW5jdGlvbihlLHQsbil7dmFyIGksbztpZighZSlyZXR1cm4gdGhpcztpZihuPW58fHEsInN0cmluZyI9PXR5cGVvZiBlKXtpZighKGk9IjwiPT09ZVswXSYmIj4iPT09ZVtlLmxlbmd0aC0xXSYmZS5sZW5ndGg+PTM/W251bGwsZSxudWxsXTpMLmV4ZWMoZSkpfHwhaVsxXSYmdClyZXR1cm4hdHx8dC5qcXVlcnk/KHR8fG4pLmZpbmQoZSk6dGhpcy5jb25zdHJ1Y3Rvcih0KS5maW5kKGUpO2lmKGlbMV0pe2lmKHQ9dCBpbnN0YW5jZW9mIHc/dFswXTp0LHcubWVyZ2UodGhpcyx3LnBhcnNlSFRNTChpWzFdLHQmJnQubm9kZVR5cGU/dC5vd25lckRvY3VtZW50fHx0OnIsITApKSxBLnRlc3QoaVsxXSkmJncuaXNQbGFpbk9iamVjdCh0KSlmb3IoaSBpbiB0KWcodGhpc1tpXSk/dGhpc1tpXSh0W2ldKTp0aGlzLmF0dHIoaSx0W2ldKTtyZXR1cm4gdGhpc31yZXR1cm4obz1yLmdldEVsZW1lbnRCeUlkKGlbMl0pKSYmKHRoaXNbMF09byx0aGlzLmxlbmd0aD0xKSx0aGlzfXJldHVybiBlLm5vZGVUeXBlPyh0aGlzWzBdPWUsdGhpcy5sZW5ndGg9MSx0aGlzKTpnKGUpP3ZvaWQgMCE9PW4ucmVhZHk/bi5yZWFkeShlKTplKHcpOncubWFrZUFycmF5KGUsdGhpcyl9KS5wcm90b3R5cGU9dy5mbixxPXcocik7dmFyIEg9L14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sTz17Y2hpbGRyZW46ITAsY29udGVudHM6ITAsbmV4dDohMCxwcmV2OiEwfTt3LmZuLmV4dGVuZCh7aGFzOmZ1bmN0aW9uKGUpe3ZhciB0PXcoZSx0aGlzKSxuPXQubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8bjtlKyspaWYody5jb250YWlucyh0aGlzLHRbZV0pKXJldHVybiEwfSl9LGNsb3Nlc3Q6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTAsaT10aGlzLmxlbmd0aCxvPVtdLGE9InN0cmluZyIhPXR5cGVvZiBlJiZ3KGUpO2lmKCFELnRlc3QoZSkpZm9yKDtyPGk7cisrKWZvcihuPXRoaXNbcl07biYmbiE9PXQ7bj1uLnBhcmVudE5vZGUpaWYobi5ub2RlVHlwZTwxMSYmKGE/YS5pbmRleChuKT4tMToxPT09bi5ub2RlVHlwZSYmdy5maW5kLm1hdGNoZXNTZWxlY3RvcihuLGUpKSl7by5wdXNoKG4pO2JyZWFrfXJldHVybiB0aGlzLnB1c2hTdGFjayhvLmxlbmd0aD4xP3cudW5pcXVlU29ydChvKTpvKX0saW5kZXg6ZnVuY3Rpb24oZSl7cmV0dXJuIGU/InN0cmluZyI9PXR5cGVvZiBlP3UuY2FsbCh3KGUpLHRoaXNbMF0pOnUuY2FsbCh0aGlzLGUuanF1ZXJ5P2VbMF06ZSk6dGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlP3RoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoOi0xfSxhZGQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5wdXNoU3RhY2sody51bmlxdWVTb3J0KHcubWVyZ2UodGhpcy5nZXQoKSx3KGUsdCkpKSl9LGFkZEJhY2s6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuYWRkKG51bGw9PWU/dGhpcy5wcmV2T2JqZWN0OnRoaXMucHJldk9iamVjdC5maWx0ZXIoZSkpfX0pO2Z1bmN0aW9uIFAoZSx0KXt3aGlsZSgoZT1lW3RdKSYmMSE9PWUubm9kZVR5cGUpO3JldHVybiBlfXcuZWFjaCh7cGFyZW50OmZ1bmN0aW9uKGUpe3ZhciB0PWUucGFyZW50Tm9kZTtyZXR1cm4gdCYmMTEhPT10Lm5vZGVUeXBlP3Q6bnVsbH0scGFyZW50czpmdW5jdGlvbihlKXtyZXR1cm4gayhlLCJwYXJlbnROb2RlIil9LHBhcmVudHNVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGsoZSwicGFyZW50Tm9kZSIsbil9LG5leHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFAoZSwibmV4dFNpYmxpbmciKX0scHJldjpmdW5jdGlvbihlKXtyZXR1cm4gUChlLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dEFsbDpmdW5jdGlvbihlKXtyZXR1cm4gayhlLCJuZXh0U2libGluZyIpfSxwcmV2QWxsOmZ1bmN0aW9uKGUpe3JldHVybiBrKGUsInByZXZpb3VzU2libGluZyIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBrKGUsIm5leHRTaWJsaW5nIixuKX0scHJldlVudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gayhlLCJwcmV2aW91c1NpYmxpbmciLG4pfSxzaWJsaW5nczpmdW5jdGlvbihlKXtyZXR1cm4gUygoZS5wYXJlbnROb2RlfHx7fSkuZmlyc3RDaGlsZCxlKX0sY2hpbGRyZW46ZnVuY3Rpb24oZSl7cmV0dXJuIFMoZS5maXJzdENoaWxkKX0sY29udGVudHM6ZnVuY3Rpb24oZSl7cmV0dXJuIE4oZSwiaWZyYW1lIik/ZS5jb250ZW50RG9jdW1lbnQ6KE4oZSwidGVtcGxhdGUiKSYmKGU9ZS5jb250ZW50fHxlKSx3Lm1lcmdlKFtdLGUuY2hpbGROb2RlcykpfX0sZnVuY3Rpb24oZSx0KXt3LmZuW2VdPWZ1bmN0aW9uKG4scil7dmFyIGk9dy5tYXAodGhpcyx0LG4pO3JldHVybiJVbnRpbCIhPT1lLnNsaWNlKC01KSYmKHI9biksciYmInN0cmluZyI9PXR5cGVvZiByJiYoaT13LmZpbHRlcihyLGkpKSx0aGlzLmxlbmd0aD4xJiYoT1tlXXx8dy51bmlxdWVTb3J0KGkpLEgudGVzdChlKSYmaS5yZXZlcnNlKCkpLHRoaXMucHVzaFN0YWNrKGkpfX0pO3ZhciBNPS9bXlx4MjBcdFxyXG5cZl0rL2c7ZnVuY3Rpb24gUihlKXt2YXIgdD17fTtyZXR1cm4gdy5lYWNoKGUubWF0Y2goTSl8fFtdLGZ1bmN0aW9uKGUsbil7dFtuXT0hMH0pLHR9dy5DYWxsYmFja3M9ZnVuY3Rpb24oZSl7ZT0ic3RyaW5nIj09dHlwZW9mIGU/UihlKTp3LmV4dGVuZCh7fSxlKTt2YXIgdCxuLHIsaSxvPVtdLGE9W10scz0tMSx1PWZ1bmN0aW9uKCl7Zm9yKGk9aXx8ZS5vbmNlLHI9dD0hMDthLmxlbmd0aDtzPS0xKXtuPWEuc2hpZnQoKTt3aGlsZSgrK3M8by5sZW5ndGgpITE9PT1vW3NdLmFwcGx5KG5bMF0sblsxXSkmJmUuc3RvcE9uRmFsc2UmJihzPW8ubGVuZ3RoLG49ITEpfWUubWVtb3J5fHwobj0hMSksdD0hMSxpJiYobz1uP1tdOiIiKX0sbD17YWRkOmZ1bmN0aW9uKCl7cmV0dXJuIG8mJihuJiYhdCYmKHM9by5sZW5ndGgtMSxhLnB1c2gobikpLGZ1bmN0aW9uIHQobil7dy5lYWNoKG4sZnVuY3Rpb24obixyKXtnKHIpP2UudW5pcXVlJiZsLmhhcyhyKXx8by5wdXNoKHIpOnImJnIubGVuZ3RoJiYic3RyaW5nIiE9PXgocikmJnQocil9KX0oYXJndW1lbnRzKSxuJiYhdCYmdSgpKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gdy5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihlLHQpe3ZhciBuO3doaWxlKChuPXcuaW5BcnJheSh0LG8sbikpPi0xKW8uc3BsaWNlKG4sMSksbjw9cyYmcy0tfSksdGhpc30saGFzOmZ1bmN0aW9uKGUpe3JldHVybiBlP3cuaW5BcnJheShlLG8pPi0xOm8ubGVuZ3RoPjB9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIG8mJihvPVtdKSx0aGlzfSxkaXNhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGk9YT1bXSxvPW49IiIsdGhpc30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hb30sbG9jazpmdW5jdGlvbigpe3JldHVybiBpPWE9W10sbnx8dHx8KG89bj0iIiksdGhpc30sbG9ja2VkOmZ1bmN0aW9uKCl7cmV0dXJuISFpfSxmaXJlV2l0aDpmdW5jdGlvbihlLG4pe3JldHVybiBpfHwobj1bZSwobj1ufHxbXSkuc2xpY2U/bi5zbGljZSgpOm5dLGEucHVzaChuKSx0fHx1KCkpLHRoaXN9LGZpcmU6ZnVuY3Rpb24oKXtyZXR1cm4gbC5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyksdGhpc30sZmlyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIXJ9fTtyZXR1cm4gbH07ZnVuY3Rpb24gSShlKXtyZXR1cm4gZX1mdW5jdGlvbiBXKGUpe3Rocm93IGV9ZnVuY3Rpb24gJChlLHQsbixyKXt2YXIgaTt0cnl7ZSYmZyhpPWUucHJvbWlzZSk/aS5jYWxsKGUpLmRvbmUodCkuZmFpbChuKTplJiZnKGk9ZS50aGVuKT9pLmNhbGwoZSx0LG4pOnQuYXBwbHkodm9pZCAwLFtlXS5zbGljZShyKSl9Y2F0Y2goZSl7bi5hcHBseSh2b2lkIDAsW2VdKX19dy5leHRlbmQoe0RlZmVycmVkOmZ1bmN0aW9uKHQpe3ZhciBuPVtbIm5vdGlmeSIsInByb2dyZXNzIix3LkNhbGxiYWNrcygibWVtb3J5Iiksdy5DYWxsYmFja3MoIm1lbW9yeSIpLDJdLFsicmVzb2x2ZSIsImRvbmUiLHcuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHcuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDAsInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIix3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSx3LkNhbGxiYWNrcygib25jZSBtZW1vcnkiKSwxLCJyZWplY3RlZCJdXSxyPSJwZW5kaW5nIixpPXtzdGF0ZTpmdW5jdGlvbigpe3JldHVybiByfSxhbHdheXM6ZnVuY3Rpb24oKXtyZXR1cm4gby5kb25lKGFyZ3VtZW50cykuZmFpbChhcmd1bWVudHMpLHRoaXN9LCJjYXRjaCI6ZnVuY3Rpb24oZSl7cmV0dXJuIGkudGhlbihudWxsLGUpfSxwaXBlOmZ1bmN0aW9uKCl7dmFyIGU9YXJndW1lbnRzO3JldHVybiB3LkRlZmVycmVkKGZ1bmN0aW9uKHQpe3cuZWFjaChuLGZ1bmN0aW9uKG4scil7dmFyIGk9ZyhlW3JbNF1dKSYmZVtyWzRdXTtvW3JbMV1dKGZ1bmN0aW9uKCl7dmFyIGU9aSYmaS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZSYmZyhlLnByb21pc2UpP2UucHJvbWlzZSgpLnByb2dyZXNzKHQubm90aWZ5KS5kb25lKHQucmVzb2x2ZSkuZmFpbCh0LnJlamVjdCk6dFtyWzBdKyJXaXRoIl0odGhpcyxpP1tlXTphcmd1bWVudHMpfSl9KSxlPW51bGx9KS5wcm9taXNlKCl9LHRoZW46ZnVuY3Rpb24odCxyLGkpe3ZhciBvPTA7ZnVuY3Rpb24gYSh0LG4scixpKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcz10aGlzLHU9YXJndW1lbnRzLGw9ZnVuY3Rpb24oKXt2YXIgZSxsO2lmKCEodDxvKSl7aWYoKGU9ci5hcHBseShzLHUpKT09PW4ucHJvbWlzZSgpKXRocm93IG5ldyBUeXBlRXJyb3IoIlRoZW5hYmxlIHNlbGYtcmVzb2x1dGlvbiIpO2w9ZSYmKCJvYmplY3QiPT10eXBlb2YgZXx8ImZ1bmN0aW9uIj09dHlwZW9mIGUpJiZlLnRoZW4sZyhsKT9pP2wuY2FsbChlLGEobyxuLEksaSksYShvLG4sVyxpKSk6KG8rKyxsLmNhbGwoZSxhKG8sbixJLGkpLGEobyxuLFcsaSksYShvLG4sSSxuLm5vdGlmeVdpdGgpKSk6KHIhPT1JJiYocz12b2lkIDAsdT1bZV0pLChpfHxuLnJlc29sdmVXaXRoKShzLHUpKX19LGM9aT9sOmZ1bmN0aW9uKCl7dHJ5e2woKX1jYXRjaChlKXt3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2smJncuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayhlLGMuc3RhY2tUcmFjZSksdCsxPj1vJiYociE9PVcmJihzPXZvaWQgMCx1PVtlXSksbi5yZWplY3RXaXRoKHMsdSkpfX07dD9jKCk6KHcuRGVmZXJyZWQuZ2V0U3RhY2tIb29rJiYoYy5zdGFja1RyYWNlPXcuRGVmZXJyZWQuZ2V0U3RhY2tIb29rKCkpLGUuc2V0VGltZW91dChjKSl9fXJldHVybiB3LkRlZmVycmVkKGZ1bmN0aW9uKGUpe25bMF1bM10uYWRkKGEoMCxlLGcoaSk/aTpJLGUubm90aWZ5V2l0aCkpLG5bMV1bM10uYWRkKGEoMCxlLGcodCk/dDpJKSksblsyXVszXS5hZGQoYSgwLGUsZyhyKT9yOlcpKX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZT93LmV4dGVuZChlLGkpOml9fSxvPXt9O3JldHVybiB3LmVhY2gobixmdW5jdGlvbihlLHQpe3ZhciBhPXRbMl0scz10WzVdO2lbdFsxXV09YS5hZGQscyYmYS5hZGQoZnVuY3Rpb24oKXtyPXN9LG5bMy1lXVsyXS5kaXNhYmxlLG5bMy1lXVszXS5kaXNhYmxlLG5bMF1bMl0ubG9jayxuWzBdWzNdLmxvY2spLGEuYWRkKHRbM10uZmlyZSksb1t0WzBdXT1mdW5jdGlvbigpe3JldHVybiBvW3RbMF0rIldpdGgiXSh0aGlzPT09bz92b2lkIDA6dGhpcyxhcmd1bWVudHMpLHRoaXN9LG9bdFswXSsiV2l0aCJdPWEuZmlyZVdpdGh9KSxpLnByb21pc2UobyksdCYmdC5jYWxsKG8sbyksb30sd2hlbjpmdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoLG49dCxyPUFycmF5KG4pLGk9by5jYWxsKGFyZ3VtZW50cyksYT13LkRlZmVycmVkKCkscz1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24obil7cltlXT10aGlzLGlbZV09YXJndW1lbnRzLmxlbmd0aD4xP28uY2FsbChhcmd1bWVudHMpOm4sLS10fHxhLnJlc29sdmVXaXRoKHIsaSl9fTtpZih0PD0xJiYoJChlLGEuZG9uZShzKG4pKS5yZXNvbHZlLGEucmVqZWN0LCF0KSwicGVuZGluZyI9PT1hLnN0YXRlKCl8fGcoaVtuXSYmaVtuXS50aGVuKSkpcmV0dXJuIGEudGhlbigpO3doaWxlKG4tLSkkKGlbbl0scyhuKSxhLnJlamVjdCk7cmV0dXJuIGEucHJvbWlzZSgpfX0pO3ZhciBCPS9eKEV2YWx8SW50ZXJuYWx8UmFuZ2V8UmVmZXJlbmNlfFN5bnRheHxUeXBlfFVSSSlFcnJvciQvO3cuRGVmZXJyZWQuZXhjZXB0aW9uSG9vaz1mdW5jdGlvbih0LG4pe2UuY29uc29sZSYmZS5jb25zb2xlLndhcm4mJnQmJkIudGVzdCh0Lm5hbWUpJiZlLmNvbnNvbGUud2FybigialF1ZXJ5LkRlZmVycmVkIGV4Y2VwdGlvbjogIit0Lm1lc3NhZ2UsdC5zdGFjayxuKX0sdy5yZWFkeUV4Y2VwdGlvbj1mdW5jdGlvbih0KXtlLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aHJvdyB0fSl9O3ZhciBGPXcuRGVmZXJyZWQoKTt3LmZuLnJlYWR5PWZ1bmN0aW9uKGUpe3JldHVybiBGLnRoZW4oZSlbImNhdGNoIl0oZnVuY3Rpb24oZSl7dy5yZWFkeUV4Y2VwdGlvbihlKX0pLHRoaXN9LHcuZXh0ZW5kKHtpc1JlYWR5OiExLHJlYWR5V2FpdDoxLHJlYWR5OmZ1bmN0aW9uKGUpeyghMD09PWU/LS13LnJlYWR5V2FpdDp3LmlzUmVhZHkpfHwody5pc1JlYWR5PSEwLCEwIT09ZSYmLS13LnJlYWR5V2FpdD4wfHxGLnJlc29sdmVXaXRoKHIsW3ddKSl9fSksdy5yZWFkeS50aGVuPUYudGhlbjtmdW5jdGlvbiBfKCl7ci5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixfKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImxvYWQiLF8pLHcucmVhZHkoKX0iY29tcGxldGUiPT09ci5yZWFkeVN0YXRlfHwibG9hZGluZyIhPT1yLnJlYWR5U3RhdGUmJiFyLmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbD9lLnNldFRpbWVvdXQody5yZWFkeSk6KHIuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsXyksZS5hZGRFdmVudExpc3RlbmVyKCJsb2FkIixfKSk7dmFyIHo9ZnVuY3Rpb24oZSx0LG4scixpLG8sYSl7dmFyIHM9MCx1PWUubGVuZ3RoLGw9bnVsbD09bjtpZigib2JqZWN0Ij09PXgobikpe2k9ITA7Zm9yKHMgaW4gbil6KGUsdCxzLG5bc10sITAsbyxhKX1lbHNlIGlmKHZvaWQgMCE9PXImJihpPSEwLGcocil8fChhPSEwKSxsJiYoYT8odC5jYWxsKGUsciksdD1udWxsKToobD10LHQ9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBsLmNhbGwodyhlKSxuKX0pKSx0KSlmb3IoO3M8dTtzKyspdChlW3NdLG4sYT9yOnIuY2FsbChlW3NdLHMsdChlW3NdLG4pKSk7cmV0dXJuIGk/ZTpsP3QuY2FsbChlKTp1P3QoZVswXSxuKTpvfSxYPS9eLW1zLS8sVT0vLShbYS16XSkvZztmdW5jdGlvbiBWKGUsdCl7cmV0dXJuIHQudG9VcHBlckNhc2UoKX1mdW5jdGlvbiBHKGUpe3JldHVybiBlLnJlcGxhY2UoWCwibXMtIikucmVwbGFjZShVLFYpfXZhciBZPWZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZXx8OT09PWUubm9kZVR5cGV8fCErZS5ub2RlVHlwZX07ZnVuY3Rpb24gUSgpe3RoaXMuZXhwYW5kbz13LmV4cGFuZG8rUS51aWQrK31RLnVpZD0xLFEucHJvdG90eXBlPXtjYWNoZTpmdW5jdGlvbihlKXt2YXIgdD1lW3RoaXMuZXhwYW5kb107cmV0dXJuIHR8fCh0PXt9LFkoZSkmJihlLm5vZGVUeXBlP2VbdGhpcy5leHBhbmRvXT10Ok9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHRoaXMuZXhwYW5kbyx7dmFsdWU6dCxjb25maWd1cmFibGU6ITB9KSkpLHR9LHNldDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaT10aGlzLmNhY2hlKGUpO2lmKCJzdHJpbmciPT10eXBlb2YgdClpW0codCldPW47ZWxzZSBmb3IociBpbiB0KWlbRyhyKV09dFtyXTtyZXR1cm4gaX0sZ2V0OmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQ/dGhpcy5jYWNoZShlKTplW3RoaXMuZXhwYW5kb10mJmVbdGhpcy5leHBhbmRvXVtHKHQpXX0sYWNjZXNzOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdm9pZCAwPT09dHx8dCYmInN0cmluZyI9PXR5cGVvZiB0JiZ2b2lkIDA9PT1uP3RoaXMuZ2V0KGUsdCk6KHRoaXMuc2V0KGUsdCxuKSx2b2lkIDAhPT1uP246dCl9LHJlbW92ZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9ZVt0aGlzLmV4cGFuZG9dO2lmKHZvaWQgMCE9PXIpe2lmKHZvaWQgMCE9PXQpe249KHQ9QXJyYXkuaXNBcnJheSh0KT90Lm1hcChHKToodD1HKHQpKWluIHI/W3RdOnQubWF0Y2goTSl8fFtdKS5sZW5ndGg7d2hpbGUobi0tKWRlbGV0ZSByW3Rbbl1dfSh2b2lkIDA9PT10fHx3LmlzRW1wdHlPYmplY3QocikpJiYoZS5ub2RlVHlwZT9lW3RoaXMuZXhwYW5kb109dm9pZCAwOmRlbGV0ZSBlW3RoaXMuZXhwYW5kb10pfX0saGFzRGF0YTpmdW5jdGlvbihlKXt2YXIgdD1lW3RoaXMuZXhwYW5kb107cmV0dXJuIHZvaWQgMCE9PXQmJiF3LmlzRW1wdHlPYmplY3QodCl9fTt2YXIgSj1uZXcgUSxLPW5ldyBRLFo9L14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLyxlZT0vW0EtWl0vZztmdW5jdGlvbiB0ZShlKXtyZXR1cm4idHJ1ZSI9PT1lfHwiZmFsc2UiIT09ZSYmKCJudWxsIj09PWU/bnVsbDplPT09K2UrIiI/K2U6Wi50ZXN0KGUpP0pTT04ucGFyc2UoZSk6ZSl9ZnVuY3Rpb24gbmUoZSx0LG4pe3ZhciByO2lmKHZvaWQgMD09PW4mJjE9PT1lLm5vZGVUeXBlKWlmKHI9ImRhdGEtIit0LnJlcGxhY2UoZWUsIi0kJiIpLnRvTG93ZXJDYXNlKCksInN0cmluZyI9PXR5cGVvZihuPWUuZ2V0QXR0cmlidXRlKHIpKSl7dHJ5e249dGUobil9Y2F0Y2goZSl7fUsuc2V0KGUsdCxuKX1lbHNlIG49dm9pZCAwO3JldHVybiBufXcuZXh0ZW5kKHtoYXNEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiBLLmhhc0RhdGEoZSl8fEouaGFzRGF0YShlKX0sZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIEsuYWNjZXNzKGUsdCxuKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe0sucmVtb3ZlKGUsdCl9LF9kYXRhOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gSi5hY2Nlc3MoZSx0LG4pfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe0oucmVtb3ZlKGUsdCl9fSksdy5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oZSx0KXt2YXIgbixyLGksbz10aGlzWzBdLGE9byYmby5hdHRyaWJ1dGVzO2lmKHZvaWQgMD09PWUpe2lmKHRoaXMubGVuZ3RoJiYoaT1LLmdldChvKSwxPT09by5ub2RlVHlwZSYmIUouZ2V0KG8sImhhc0RhdGFBdHRycyIpKSl7bj1hLmxlbmd0aDt3aGlsZShuLS0pYVtuXSYmMD09PShyPWFbbl0ubmFtZSkuaW5kZXhPZigiZGF0YS0iKSYmKHI9RyhyLnNsaWNlKDUpKSxuZShvLHIsaVtyXSkpO0ouc2V0KG8sImhhc0RhdGFBdHRycyIsITApfXJldHVybiBpfXJldHVybiJvYmplY3QiPT10eXBlb2YgZT90aGlzLmVhY2goZnVuY3Rpb24oKXtLLnNldCh0aGlzLGUpfSk6eih0aGlzLGZ1bmN0aW9uKHQpe3ZhciBuO2lmKG8mJnZvaWQgMD09PXQpe2lmKHZvaWQgMCE9PShuPUsuZ2V0KG8sZSkpKXJldHVybiBuO2lmKHZvaWQgMCE9PShuPW5lKG8sZSkpKXJldHVybiBufWVsc2UgdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Sy5zZXQodGhpcyxlLHQpfSl9LG51bGwsdCxhcmd1bWVudHMubGVuZ3RoPjEsbnVsbCwhMCl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe0sucmVtb3ZlKHRoaXMsZSl9KX19KSx3LmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByO2lmKGUpcmV0dXJuIHQ9KHR8fCJmeCIpKyJxdWV1ZSIscj1KLmdldChlLHQpLG4mJighcnx8QXJyYXkuaXNBcnJheShuKT9yPUouYWNjZXNzKGUsdCx3Lm1ha2VBcnJheShuKSk6ci5wdXNoKG4pKSxyfHxbXX0sZGVxdWV1ZTpmdW5jdGlvbihlLHQpe3Q9dHx8ImZ4Ijt2YXIgbj13LnF1ZXVlKGUsdCkscj1uLmxlbmd0aCxpPW4uc2hpZnQoKSxvPXcuX3F1ZXVlSG9va3MoZSx0KSxhPWZ1bmN0aW9uKCl7dy5kZXF1ZXVlKGUsdCl9OyJpbnByb2dyZXNzIj09PWkmJihpPW4uc2hpZnQoKSxyLS0pLGkmJigiZngiPT09dCYmbi51bnNoaWZ0KCJpbnByb2dyZXNzIiksZGVsZXRlIG8uc3RvcCxpLmNhbGwoZSxhLG8pKSwhciYmbyYmby5lbXB0eS5maXJlKCl9LF9xdWV1ZUhvb2tzOmZ1bmN0aW9uKGUsdCl7dmFyIG49dCsicXVldWVIb29rcyI7cmV0dXJuIEouZ2V0KGUsbil8fEouYWNjZXNzKGUsbix7ZW1wdHk6dy5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IikuYWRkKGZ1bmN0aW9uKCl7Si5yZW1vdmUoZSxbdCsicXVldWUiLG5dKX0pfSl9fSksdy5mbi5leHRlbmQoe3F1ZXVlOmZ1bmN0aW9uKGUsdCl7dmFyIG49MjtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGUmJih0PWUsZT0iZngiLG4tLSksYXJndW1lbnRzLmxlbmd0aDxuP3cucXVldWUodGhpc1swXSxlKTp2b2lkIDA9PT10P3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIG49dy5xdWV1ZSh0aGlzLGUsdCk7dy5fcXVldWVIb29rcyh0aGlzLGUpLCJmeCI9PT1lJiYiaW5wcm9ncmVzcyIhPT1uWzBdJiZ3LmRlcXVldWUodGhpcyxlKX0pfSxkZXF1ZXVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt3LmRlcXVldWUodGhpcyxlKX0pfSxjbGVhclF1ZXVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnF1ZXVlKGV8fCJmeCIsW10pfSxwcm9taXNlOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0xLGk9dy5EZWZlcnJlZCgpLG89dGhpcyxhPXRoaXMubGVuZ3RoLHM9ZnVuY3Rpb24oKXstLXJ8fGkucmVzb2x2ZVdpdGgobyxbb10pfTsic3RyaW5nIiE9dHlwZW9mIGUmJih0PWUsZT12b2lkIDApLGU9ZXx8ImZ4Ijt3aGlsZShhLS0pKG49Si5nZXQob1thXSxlKyJxdWV1ZUhvb2tzIikpJiZuLmVtcHR5JiYocisrLG4uZW1wdHkuYWRkKHMpKTtyZXR1cm4gcygpLGkucHJvbWlzZSh0KX19KTt2YXIgcmU9L1srLV0/KD86XGQqXC58KVxkKyg/OltlRV1bKy1dP1xkK3wpLy5zb3VyY2UsaWU9bmV3IFJlZ0V4cCgiXig/OihbKy1dKT18KSgiK3JlKyIpKFthLXolXSopJCIsImkiKSxvZT1bIlRvcCIsIlJpZ2h0IiwiQm90dG9tIiwiTGVmdCJdLGFlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIm5vbmUiPT09KGU9dHx8ZSkuc3R5bGUuZGlzcGxheXx8IiI9PT1lLnN0eWxlLmRpc3BsYXkmJncuY29udGFpbnMoZS5vd25lckRvY3VtZW50LGUpJiYibm9uZSI9PT13LmNzcyhlLCJkaXNwbGF5Iil9LHNlPWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpLG8sYT17fTtmb3IobyBpbiB0KWFbb109ZS5zdHlsZVtvXSxlLnN0eWxlW29dPXRbb107aT1uLmFwcGx5KGUscnx8W10pO2ZvcihvIGluIHQpZS5zdHlsZVtvXT1hW29dO3JldHVybiBpfTtmdW5jdGlvbiB1ZShlLHQsbixyKXt2YXIgaSxvLGE9MjAscz1yP2Z1bmN0aW9uKCl7cmV0dXJuIHIuY3VyKCl9OmZ1bmN0aW9uKCl7cmV0dXJuIHcuY3NzKGUsdCwiIil9LHU9cygpLGw9biYmblszXXx8KHcuY3NzTnVtYmVyW3RdPyIiOiJweCIpLGM9KHcuY3NzTnVtYmVyW3RdfHwicHgiIT09bCYmK3UpJiZpZS5leGVjKHcuY3NzKGUsdCkpO2lmKGMmJmNbM10hPT1sKXt1Lz0yLGw9bHx8Y1szXSxjPSt1fHwxO3doaWxlKGEtLSl3LnN0eWxlKGUsdCxjK2wpLCgxLW8pKigxLShvPXMoKS91fHwuNSkpPD0wJiYoYT0wKSxjLz1vO2MqPTIsdy5zdHlsZShlLHQsYytsKSxuPW58fFtdfXJldHVybiBuJiYoYz0rY3x8K3V8fDAsaT1uWzFdP2MrKG5bMV0rMSkqblsyXTorblsyXSxyJiYoci51bml0PWwsci5zdGFydD1jLHIuZW5kPWkpKSxpfXZhciBsZT17fTtmdW5jdGlvbiBjZShlKXt2YXIgdCxuPWUub3duZXJEb2N1bWVudCxyPWUubm9kZU5hbWUsaT1sZVtyXTtyZXR1cm4gaXx8KHQ9bi5ib2R5LmFwcGVuZENoaWxkKG4uY3JlYXRlRWxlbWVudChyKSksaT13LmNzcyh0LCJkaXNwbGF5IiksdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLCJub25lIj09PWkmJihpPSJibG9jayIpLGxlW3JdPWksaSl9ZnVuY3Rpb24gZmUoZSx0KXtmb3IodmFyIG4scixpPVtdLG89MCxhPWUubGVuZ3RoO288YTtvKyspKHI9ZVtvXSkuc3R5bGUmJihuPXIuc3R5bGUuZGlzcGxheSx0Pygibm9uZSI9PT1uJiYoaVtvXT1KLmdldChyLCJkaXNwbGF5Iil8fG51bGwsaVtvXXx8KHIuc3R5bGUuZGlzcGxheT0iIikpLCIiPT09ci5zdHlsZS5kaXNwbGF5JiZhZShyKSYmKGlbb109Y2UocikpKToibm9uZSIhPT1uJiYoaVtvXT0ibm9uZSIsSi5zZXQociwiZGlzcGxheSIsbikpKTtmb3Iobz0wO288YTtvKyspbnVsbCE9aVtvXSYmKGVbb10uc3R5bGUuZGlzcGxheT1pW29dKTtyZXR1cm4gZX13LmZuLmV4dGVuZCh7c2hvdzpmdW5jdGlvbigpe3JldHVybiBmZSh0aGlzLCEwKX0saGlkZTpmdW5jdGlvbigpe3JldHVybiBmZSh0aGlzKX0sdG9nZ2xlOmZ1bmN0aW9uKGUpe3JldHVybiJib29sZWFuIj09dHlwZW9mIGU/ZT90aGlzLnNob3coKTp0aGlzLmhpZGUoKTp0aGlzLmVhY2goZnVuY3Rpb24oKXthZSh0aGlzKT93KHRoaXMpLnNob3coKTp3KHRoaXMpLmhpZGUoKX0pfX0pO3ZhciBwZT0vXig/OmNoZWNrYm94fHJhZGlvKSQvaSxkZT0vPChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKykvaSxoZT0vXiR8Xm1vZHVsZSR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2ksZ2U9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLHRoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxjb2w6WzIsIjx0YWJsZT48Y29sZ3JvdXA+IiwiPC9jb2xncm91cD48L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sX2RlZmF1bHQ6WzAsIiIsIiJdfTtnZS5vcHRncm91cD1nZS5vcHRpb24sZ2UudGJvZHk9Z2UudGZvb3Q9Z2UuY29sZ3JvdXA9Z2UuY2FwdGlvbj1nZS50aGVhZCxnZS50aD1nZS50ZDtmdW5jdGlvbiB5ZShlLHQpe3ZhciBuO3JldHVybiBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRFbGVtZW50c0J5VGFnTmFtZT9lLmdldEVsZW1lbnRzQnlUYWdOYW1lKHR8fCIqIik6InVuZGVmaW5lZCIhPXR5cGVvZiBlLnF1ZXJ5U2VsZWN0b3JBbGw/ZS5xdWVyeVNlbGVjdG9yQWxsKHR8fCIqIik6W10sdm9pZCAwPT09dHx8dCYmTihlLHQpP3cubWVyZ2UoW2VdLG4pOm59ZnVuY3Rpb24gdmUoZSx0KXtmb3IodmFyIG49MCxyPWUubGVuZ3RoO248cjtuKyspSi5zZXQoZVtuXSwiZ2xvYmFsRXZhbCIsIXR8fEouZ2V0KHRbbl0sImdsb2JhbEV2YWwiKSl9dmFyIG1lPS88fCYjP1x3KzsvO2Z1bmN0aW9uIHhlKGUsdCxuLHIsaSl7Zm9yKHZhciBvLGEscyx1LGwsYyxmPXQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLHA9W10sZD0wLGg9ZS5sZW5ndGg7ZDxoO2QrKylpZigobz1lW2RdKXx8MD09PW8paWYoIm9iamVjdCI9PT14KG8pKXcubWVyZ2UocCxvLm5vZGVUeXBlP1tvXTpvKTtlbHNlIGlmKG1lLnRlc3Qobykpe2E9YXx8Zi5hcHBlbmRDaGlsZCh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxzPShkZS5leGVjKG8pfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLHU9Z2Vbc118fGdlLl9kZWZhdWx0LGEuaW5uZXJIVE1MPXVbMV0rdy5odG1sUHJlZmlsdGVyKG8pK3VbMl0sYz11WzBdO3doaWxlKGMtLSlhPWEubGFzdENoaWxkO3cubWVyZ2UocCxhLmNoaWxkTm9kZXMpLChhPWYuZmlyc3RDaGlsZCkudGV4dENvbnRlbnQ9IiJ9ZWxzZSBwLnB1c2godC5jcmVhdGVUZXh0Tm9kZShvKSk7Zi50ZXh0Q29udGVudD0iIixkPTA7d2hpbGUobz1wW2QrK10paWYociYmdy5pbkFycmF5KG8scik+LTEpaSYmaS5wdXNoKG8pO2Vsc2UgaWYobD13LmNvbnRhaW5zKG8ub3duZXJEb2N1bWVudCxvKSxhPXllKGYuYXBwZW5kQ2hpbGQobyksInNjcmlwdCIpLGwmJnZlKGEpLG4pe2M9MDt3aGlsZShvPWFbYysrXSloZS50ZXN0KG8udHlwZXx8IiIpJiZuLnB1c2gobyl9cmV0dXJuIGZ9IWZ1bmN0aW9uKCl7dmFyIGU9ci5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkuYXBwZW5kQ2hpbGQoci5jcmVhdGVFbGVtZW50KCJkaXYiKSksdD1yLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7dC5zZXRBdHRyaWJ1dGUoInR5cGUiLCJyYWRpbyIpLHQuc2V0QXR0cmlidXRlKCJjaGVja2VkIiwiY2hlY2tlZCIpLHQuc2V0QXR0cmlidXRlKCJuYW1lIiwidCIpLGUuYXBwZW5kQ2hpbGQodCksaC5jaGVja0Nsb25lPWUuY2xvbmVOb2RlKCEwKS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5jaGVja2VkLGUuaW5uZXJIVE1MPSI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+IixoLm5vQ2xvbmVDaGVja2VkPSEhZS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5kZWZhdWx0VmFsdWV9KCk7dmFyIGJlPXIuZG9jdW1lbnRFbGVtZW50LHdlPS9ea2V5LyxUZT0vXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnV8ZHJhZ3xkcm9wKXxjbGljay8sQ2U9L14oW14uXSopKD86XC4oLispfCkvO2Z1bmN0aW9uIEVlKCl7cmV0dXJuITB9ZnVuY3Rpb24ga2UoKXtyZXR1cm4hMX1mdW5jdGlvbiBTZSgpe3RyeXtyZXR1cm4gci5hY3RpdmVFbGVtZW50fWNhdGNoKGUpe319ZnVuY3Rpb24gRGUoZSx0LG4scixpLG8pe3ZhciBhLHM7aWYoIm9iamVjdCI9PXR5cGVvZiB0KXsic3RyaW5nIiE9dHlwZW9mIG4mJihyPXJ8fG4sbj12b2lkIDApO2ZvcihzIGluIHQpRGUoZSxzLG4scix0W3NdLG8pO3JldHVybiBlfWlmKG51bGw9PXImJm51bGw9PWk/KGk9bixyPW49dm9pZCAwKTpudWxsPT1pJiYoInN0cmluZyI9PXR5cGVvZiBuPyhpPXIscj12b2lkIDApOihpPXIscj1uLG49dm9pZCAwKSksITE9PT1pKWk9a2U7ZWxzZSBpZighaSlyZXR1cm4gZTtyZXR1cm4gMT09PW8mJihhPWksKGk9ZnVuY3Rpb24oZSl7cmV0dXJuIHcoKS5vZmYoZSksYS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KS5ndWlkPWEuZ3VpZHx8KGEuZ3VpZD13Lmd1aWQrKykpLGUuZWFjaChmdW5jdGlvbigpe3cuZXZlbnQuYWRkKHRoaXMsdCxpLHIsbil9KX13LmV2ZW50PXtnbG9iYWw6e30sYWRkOmZ1bmN0aW9uKGUsdCxuLHIsaSl7dmFyIG8sYSxzLHUsbCxjLGYscCxkLGgsZyx5PUouZ2V0KGUpO2lmKHkpe24uaGFuZGxlciYmKG49KG89bikuaGFuZGxlcixpPW8uc2VsZWN0b3IpLGkmJncuZmluZC5tYXRjaGVzU2VsZWN0b3IoYmUsaSksbi5ndWlkfHwobi5ndWlkPXcuZ3VpZCsrKSwodT15LmV2ZW50cyl8fCh1PXkuZXZlbnRzPXt9KSwoYT15LmhhbmRsZSl8fChhPXkuaGFuZGxlPWZ1bmN0aW9uKHQpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgdyYmdy5ldmVudC50cmlnZ2VyZWQhPT10LnR5cGU/dy5ldmVudC5kaXNwYXRjaC5hcHBseShlLGFyZ3VtZW50cyk6dm9pZCAwfSksbD0odD0odHx8IiIpLm1hdGNoKE0pfHxbIiJdKS5sZW5ndGg7d2hpbGUobC0tKWQ9Zz0ocz1DZS5leGVjKHRbbF0pfHxbXSlbMV0saD0oc1syXXx8IiIpLnNwbGl0KCIuIikuc29ydCgpLGQmJihmPXcuZXZlbnQuc3BlY2lhbFtkXXx8e30sZD0oaT9mLmRlbGVnYXRlVHlwZTpmLmJpbmRUeXBlKXx8ZCxmPXcuZXZlbnQuc3BlY2lhbFtkXXx8e30sYz13LmV4dGVuZCh7dHlwZTpkLG9yaWdUeXBlOmcsZGF0YTpyLGhhbmRsZXI6bixndWlkOm4uZ3VpZCxzZWxlY3RvcjppLG5lZWRzQ29udGV4dDppJiZ3LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoaSksbmFtZXNwYWNlOmguam9pbigiLiIpfSxvKSwocD11W2RdKXx8KChwPXVbZF09W10pLmRlbGVnYXRlQ291bnQ9MCxmLnNldHVwJiYhMSE9PWYuc2V0dXAuY2FsbChlLHIsaCxhKXx8ZS5hZGRFdmVudExpc3RlbmVyJiZlLmFkZEV2ZW50TGlzdGVuZXIoZCxhKSksZi5hZGQmJihmLmFkZC5jYWxsKGUsYyksYy5oYW5kbGVyLmd1aWR8fChjLmhhbmRsZXIuZ3VpZD1uLmd1aWQpKSxpP3Auc3BsaWNlKHAuZGVsZWdhdGVDb3VudCsrLDAsYyk6cC5wdXNoKGMpLHcuZXZlbnQuZ2xvYmFsW2RdPSEwKX19LHJlbW92ZTpmdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvLGEscyx1LGwsYyxmLHAsZCxoLGcseT1KLmhhc0RhdGEoZSkmJkouZ2V0KGUpO2lmKHkmJih1PXkuZXZlbnRzKSl7bD0odD0odHx8IiIpLm1hdGNoKE0pfHxbIiJdKS5sZW5ndGg7d2hpbGUobC0tKWlmKHM9Q2UuZXhlYyh0W2xdKXx8W10sZD1nPXNbMV0saD0oc1syXXx8IiIpLnNwbGl0KCIuIikuc29ydCgpLGQpe2Y9dy5ldmVudC5zcGVjaWFsW2RdfHx7fSxwPXVbZD0ocj9mLmRlbGVnYXRlVHlwZTpmLmJpbmRUeXBlKXx8ZF18fFtdLHM9c1syXSYmbmV3IFJlZ0V4cCgiKF58XFwuKSIraC5qb2luKCJcXC4oPzouKlxcLnwpIikrIihcXC58JCkiKSxhPW89cC5sZW5ndGg7d2hpbGUoby0tKWM9cFtvXSwhaSYmZyE9PWMub3JpZ1R5cGV8fG4mJm4uZ3VpZCE9PWMuZ3VpZHx8cyYmIXMudGVzdChjLm5hbWVzcGFjZSl8fHImJnIhPT1jLnNlbGVjdG9yJiYoIioqIiE9PXJ8fCFjLnNlbGVjdG9yKXx8KHAuc3BsaWNlKG8sMSksYy5zZWxlY3RvciYmcC5kZWxlZ2F0ZUNvdW50LS0sZi5yZW1vdmUmJmYucmVtb3ZlLmNhbGwoZSxjKSk7YSYmIXAubGVuZ3RoJiYoZi50ZWFyZG93biYmITEhPT1mLnRlYXJkb3duLmNhbGwoZSxoLHkuaGFuZGxlKXx8dy5yZW1vdmVFdmVudChlLGQseS5oYW5kbGUpLGRlbGV0ZSB1W2RdKX1lbHNlIGZvcihkIGluIHUpdy5ldmVudC5yZW1vdmUoZSxkK3RbbF0sbixyLCEwKTt3LmlzRW1wdHlPYmplY3QodSkmJkoucmVtb3ZlKGUsImhhbmRsZSBldmVudHMiKX19LGRpc3BhdGNoOmZ1bmN0aW9uKGUpe3ZhciB0PXcuZXZlbnQuZml4KGUpLG4scixpLG8sYSxzLHU9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLGw9KEouZ2V0KHRoaXMsImV2ZW50cyIpfHx7fSlbdC50eXBlXXx8W10sYz13LmV2ZW50LnNwZWNpYWxbdC50eXBlXXx8e307Zm9yKHVbMF09dCxuPTE7bjxhcmd1bWVudHMubGVuZ3RoO24rKyl1W25dPWFyZ3VtZW50c1tuXTtpZih0LmRlbGVnYXRlVGFyZ2V0PXRoaXMsIWMucHJlRGlzcGF0Y2h8fCExIT09Yy5wcmVEaXNwYXRjaC5jYWxsKHRoaXMsdCkpe3M9dy5ldmVudC5oYW5kbGVycy5jYWxsKHRoaXMsdCxsKSxuPTA7d2hpbGUoKG89c1tuKytdKSYmIXQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSl7dC5jdXJyZW50VGFyZ2V0PW8uZWxlbSxyPTA7d2hpbGUoKGE9by5oYW5kbGVyc1tyKytdKSYmIXQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSl0LnJuYW1lc3BhY2UmJiF0LnJuYW1lc3BhY2UudGVzdChhLm5hbWVzcGFjZSl8fCh0LmhhbmRsZU9iaj1hLHQuZGF0YT1hLmRhdGEsdm9pZCAwIT09KGk9KCh3LmV2ZW50LnNwZWNpYWxbYS5vcmlnVHlwZV18fHt9KS5oYW5kbGV8fGEuaGFuZGxlcikuYXBwbHkoby5lbGVtLHUpKSYmITE9PT0odC5yZXN1bHQ9aSkmJih0LnByZXZlbnREZWZhdWx0KCksdC5zdG9wUHJvcGFnYXRpb24oKSkpfXJldHVybiBjLnBvc3REaXNwYXRjaCYmYy5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLHQpLHQucmVzdWx0fX0saGFuZGxlcnM6ZnVuY3Rpb24oZSx0KXt2YXIgbixyLGksbyxhLHM9W10sdT10LmRlbGVnYXRlQ291bnQsbD1lLnRhcmdldDtpZih1JiZsLm5vZGVUeXBlJiYhKCJjbGljayI9PT1lLnR5cGUmJmUuYnV0dG9uPj0xKSlmb3IoO2whPT10aGlzO2w9bC5wYXJlbnROb2RlfHx0aGlzKWlmKDE9PT1sLm5vZGVUeXBlJiYoImNsaWNrIiE9PWUudHlwZXx8ITAhPT1sLmRpc2FibGVkKSl7Zm9yKG89W10sYT17fSxuPTA7bjx1O24rKyl2b2lkIDA9PT1hW2k9KHI9dFtuXSkuc2VsZWN0b3IrIiAiXSYmKGFbaV09ci5uZWVkc0NvbnRleHQ/dyhpLHRoaXMpLmluZGV4KGwpPi0xOncuZmluZChpLHRoaXMsbnVsbCxbbF0pLmxlbmd0aCksYVtpXSYmby5wdXNoKHIpO28ubGVuZ3RoJiZzLnB1c2goe2VsZW06bCxoYW5kbGVyczpvfSl9cmV0dXJuIGw9dGhpcyx1PHQubGVuZ3RoJiZzLnB1c2goe2VsZW06bCxoYW5kbGVyczp0LnNsaWNlKHUpfSksc30sYWRkUHJvcDpmdW5jdGlvbihlLHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh3LkV2ZW50LnByb3RvdHlwZSxlLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCxnZXQ6Zyh0KT9mdW5jdGlvbigpe2lmKHRoaXMub3JpZ2luYWxFdmVudClyZXR1cm4gdCh0aGlzLm9yaWdpbmFsRXZlbnQpfTpmdW5jdGlvbigpe2lmKHRoaXMub3JpZ2luYWxFdmVudClyZXR1cm4gdGhpcy5vcmlnaW5hbEV2ZW50W2VdfSxzZXQ6ZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsZSx7ZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITAsdmFsdWU6dH0pfX0pfSxmaXg6ZnVuY3Rpb24oZSl7cmV0dXJuIGVbdy5leHBhbmRvXT9lOm5ldyB3LkV2ZW50KGUpfSxzcGVjaWFsOntsb2FkOntub0J1YmJsZTohMH0sZm9jdXM6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZih0aGlzIT09U2UoKSYmdGhpcy5mb2N1cylyZXR1cm4gdGhpcy5mb2N1cygpLCExfSxkZWxlZ2F0ZVR5cGU6ImZvY3VzaW4ifSxibHVyOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYodGhpcz09PVNlKCkmJnRoaXMuYmx1cilyZXR1cm4gdGhpcy5ibHVyKCksITF9LGRlbGVnYXRlVHlwZToiZm9jdXNvdXQifSxjbGljazp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKCJjaGVja2JveCI9PT10aGlzLnR5cGUmJnRoaXMuY2xpY2smJk4odGhpcywiaW5wdXQiKSlyZXR1cm4gdGhpcy5jbGljaygpLCExfSxfZGVmYXVsdDpmdW5jdGlvbihlKXtyZXR1cm4gTihlLnRhcmdldCwiYSIpfX0sYmVmb3JldW5sb2FkOntwb3N0RGlzcGF0Y2g6ZnVuY3Rpb24oZSl7dm9pZCAwIT09ZS5yZXN1bHQmJmUub3JpZ2luYWxFdmVudCYmKGUub3JpZ2luYWxFdmVudC5yZXR1cm5WYWx1ZT1lLnJlc3VsdCl9fX19LHcucmVtb3ZlRXZlbnQ9ZnVuY3Rpb24oZSx0LG4pe2UucmVtb3ZlRXZlbnRMaXN0ZW5lciYmZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsbil9LHcuRXZlbnQ9ZnVuY3Rpb24oZSx0KXtpZighKHRoaXMgaW5zdGFuY2VvZiB3LkV2ZW50KSlyZXR1cm4gbmV3IHcuRXZlbnQoZSx0KTtlJiZlLnR5cGU/KHRoaXMub3JpZ2luYWxFdmVudD1lLHRoaXMudHlwZT1lLnR5cGUsdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9ZS5kZWZhdWx0UHJldmVudGVkfHx2b2lkIDA9PT1lLmRlZmF1bHRQcmV2ZW50ZWQmJiExPT09ZS5yZXR1cm5WYWx1ZT9FZTprZSx0aGlzLnRhcmdldD1lLnRhcmdldCYmMz09PWUudGFyZ2V0Lm5vZGVUeXBlP2UudGFyZ2V0LnBhcmVudE5vZGU6ZS50YXJnZXQsdGhpcy5jdXJyZW50VGFyZ2V0PWUuY3VycmVudFRhcmdldCx0aGlzLnJlbGF0ZWRUYXJnZXQ9ZS5yZWxhdGVkVGFyZ2V0KTp0aGlzLnR5cGU9ZSx0JiZ3LmV4dGVuZCh0aGlzLHQpLHRoaXMudGltZVN0YW1wPWUmJmUudGltZVN0YW1wfHxEYXRlLm5vdygpLHRoaXNbdy5leHBhbmRvXT0hMH0sdy5FdmVudC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOncuRXZlbnQsaXNEZWZhdWx0UHJldmVudGVkOmtlLGlzUHJvcGFnYXRpb25TdG9wcGVkOmtlLGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOmtlLGlzU2ltdWxhdGVkOiExLHByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNEZWZhdWx0UHJldmVudGVkPUVlLGUmJiF0aGlzLmlzU2ltdWxhdGVkJiZlLnByZXZlbnREZWZhdWx0KCl9LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkPUVlLGUmJiF0aGlzLmlzU2ltdWxhdGVkJiZlLnN0b3BQcm9wYWdhdGlvbigpfSxzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1FZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSx0aGlzLnN0b3BQcm9wYWdhdGlvbigpfX0sdy5lYWNoKHthbHRLZXk6ITAsYnViYmxlczohMCxjYW5jZWxhYmxlOiEwLGNoYW5nZWRUb3VjaGVzOiEwLGN0cmxLZXk6ITAsZGV0YWlsOiEwLGV2ZW50UGhhc2U6ITAsbWV0YUtleTohMCxwYWdlWDohMCxwYWdlWTohMCxzaGlmdEtleTohMCx2aWV3OiEwLCJjaGFyIjohMCxjaGFyQ29kZTohMCxrZXk6ITAsa2V5Q29kZTohMCxidXR0b246ITAsYnV0dG9uczohMCxjbGllbnRYOiEwLGNsaWVudFk6ITAsb2Zmc2V0WDohMCxvZmZzZXRZOiEwLHBvaW50ZXJJZDohMCxwb2ludGVyVHlwZTohMCxzY3JlZW5YOiEwLHNjcmVlblk6ITAsdGFyZ2V0VG91Y2hlczohMCx0b0VsZW1lbnQ6ITAsdG91Y2hlczohMCx3aGljaDpmdW5jdGlvbihlKXt2YXIgdD1lLmJ1dHRvbjtyZXR1cm4gbnVsbD09ZS53aGljaCYmd2UudGVzdChlLnR5cGUpP251bGwhPWUuY2hhckNvZGU/ZS5jaGFyQ29kZTplLmtleUNvZGU6IWUud2hpY2gmJnZvaWQgMCE9PXQmJlRlLnRlc3QoZS50eXBlKT8xJnQ/MToyJnQ/Mzo0JnQ/MjowOmUud2hpY2h9fSx3LmV2ZW50LmFkZFByb3ApLHcuZWFjaCh7bW91c2VlbnRlcjoibW91c2VvdmVyIixtb3VzZWxlYXZlOiJtb3VzZW91dCIscG9pbnRlcmVudGVyOiJwb2ludGVyb3ZlciIscG9pbnRlcmxlYXZlOiJwb2ludGVyb3V0In0sZnVuY3Rpb24oZSx0KXt3LmV2ZW50LnNwZWNpYWxbZV09e2RlbGVnYXRlVHlwZTp0LGJpbmRUeXBlOnQsaGFuZGxlOmZ1bmN0aW9uKGUpe3ZhciBuLHI9dGhpcyxpPWUucmVsYXRlZFRhcmdldCxvPWUuaGFuZGxlT2JqO3JldHVybiBpJiYoaT09PXJ8fHcuY29udGFpbnMocixpKSl8fChlLnR5cGU9by5vcmlnVHlwZSxuPW8uaGFuZGxlci5hcHBseSh0aGlzLGFyZ3VtZW50cyksZS50eXBlPXQpLG59fX0pLHcuZm4uZXh0ZW5kKHtvbjpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gRGUodGhpcyxlLHQsbixyKX0sb25lOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiBEZSh0aGlzLGUsdCxuLHIsMSl9LG9mZjpmdW5jdGlvbihlLHQsbil7dmFyIHIsaTtpZihlJiZlLnByZXZlbnREZWZhdWx0JiZlLmhhbmRsZU9iailyZXR1cm4gcj1lLmhhbmRsZU9iaix3KGUuZGVsZWdhdGVUYXJnZXQpLm9mZihyLm5hbWVzcGFjZT9yLm9yaWdUeXBlKyIuIityLm5hbWVzcGFjZTpyLm9yaWdUeXBlLHIuc2VsZWN0b3Isci5oYW5kbGVyKSx0aGlzO2lmKCJvYmplY3QiPT10eXBlb2YgZSl7Zm9yKGkgaW4gZSl0aGlzLm9mZihpLHQsZVtpXSk7cmV0dXJuIHRoaXN9cmV0dXJuITEhPT10JiYiZnVuY3Rpb24iIT10eXBlb2YgdHx8KG49dCx0PXZvaWQgMCksITE9PT1uJiYobj1rZSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dy5ldmVudC5yZW1vdmUodGhpcyxlLG4sdCl9KX19KTt2YXIgTmU9LzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW2Etel1bXlwvXDA+XHgyMFx0XHJcblxmXSopW14+XSopXC8+L2dpLEFlPS88c2NyaXB0fDxzdHlsZXw8bGluay9pLGplPS9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLHFlPS9eXHMqPCEoPzpcW0NEQVRBXFt8LS0pfCg/OlxdXF18LS0pPlxzKiQvZztmdW5jdGlvbiBMZShlLHQpe3JldHVybiBOKGUsInRhYmxlIikmJk4oMTEhPT10Lm5vZGVUeXBlP3Q6dC5maXJzdENoaWxkLCJ0ciIpP3coZSkuY2hpbGRyZW4oInRib2R5IilbMF18fGU6ZX1mdW5jdGlvbiBIZShlKXtyZXR1cm4gZS50eXBlPShudWxsIT09ZS5nZXRBdHRyaWJ1dGUoInR5cGUiKSkrIi8iK2UudHlwZSxlfWZ1bmN0aW9uIE9lKGUpe3JldHVybiJ0cnVlLyI9PT0oZS50eXBlfHwiIikuc2xpY2UoMCw1KT9lLnR5cGU9ZS50eXBlLnNsaWNlKDUpOmUucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIiksZX1mdW5jdGlvbiBQZShlLHQpe3ZhciBuLHIsaSxvLGEscyx1LGw7aWYoMT09PXQubm9kZVR5cGUpe2lmKEouaGFzRGF0YShlKSYmKG89Si5hY2Nlc3MoZSksYT1KLnNldCh0LG8pLGw9by5ldmVudHMpKXtkZWxldGUgYS5oYW5kbGUsYS5ldmVudHM9e307Zm9yKGkgaW4gbClmb3Iobj0wLHI9bFtpXS5sZW5ndGg7bjxyO24rKyl3LmV2ZW50LmFkZCh0LGksbFtpXVtuXSl9Sy5oYXNEYXRhKGUpJiYocz1LLmFjY2VzcyhlKSx1PXcuZXh0ZW5kKHt9LHMpLEsuc2V0KHQsdSkpfX1mdW5jdGlvbiBNZShlLHQpe3ZhciBuPXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsiaW5wdXQiPT09biYmcGUudGVzdChlLnR5cGUpP3QuY2hlY2tlZD1lLmNoZWNrZWQ6ImlucHV0IiE9PW4mJiJ0ZXh0YXJlYSIhPT1ufHwodC5kZWZhdWx0VmFsdWU9ZS5kZWZhdWx0VmFsdWUpfWZ1bmN0aW9uIFJlKGUsdCxuLHIpe3Q9YS5hcHBseShbXSx0KTt2YXIgaSxvLHMsdSxsLGMsZj0wLHA9ZS5sZW5ndGgsZD1wLTEseT10WzBdLHY9Zyh5KTtpZih2fHxwPjEmJiJzdHJpbmciPT10eXBlb2YgeSYmIWguY2hlY2tDbG9uZSYmamUudGVzdCh5KSlyZXR1cm4gZS5lYWNoKGZ1bmN0aW9uKGkpe3ZhciBvPWUuZXEoaSk7diYmKHRbMF09eS5jYWxsKHRoaXMsaSxvLmh0bWwoKSkpLFJlKG8sdCxuLHIpfSk7aWYocCYmKGk9eGUodCxlWzBdLm93bmVyRG9jdW1lbnQsITEsZSxyKSxvPWkuZmlyc3RDaGlsZCwxPT09aS5jaGlsZE5vZGVzLmxlbmd0aCYmKGk9byksb3x8cikpe2Zvcih1PShzPXcubWFwKHllKGksInNjcmlwdCIpLEhlKSkubGVuZ3RoO2Y8cDtmKyspbD1pLGYhPT1kJiYobD13LmNsb25lKGwsITAsITApLHUmJncubWVyZ2Uocyx5ZShsLCJzY3JpcHQiKSkpLG4uY2FsbChlW2ZdLGwsZik7aWYodSlmb3IoYz1zW3MubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsdy5tYXAocyxPZSksZj0wO2Y8dTtmKyspbD1zW2ZdLGhlLnRlc3QobC50eXBlfHwiIikmJiFKLmFjY2VzcyhsLCJnbG9iYWxFdmFsIikmJncuY29udGFpbnMoYyxsKSYmKGwuc3JjJiYibW9kdWxlIiE9PShsLnR5cGV8fCIiKS50b0xvd2VyQ2FzZSgpP3cuX2V2YWxVcmwmJncuX2V2YWxVcmwobC5zcmMpOm0obC50ZXh0Q29udGVudC5yZXBsYWNlKHFlLCIiKSxjLGwpKX1yZXR1cm4gZX1mdW5jdGlvbiBJZShlLHQsbil7Zm9yKHZhciByLGk9dD93LmZpbHRlcih0LGUpOmUsbz0wO251bGwhPShyPWlbb10pO28rKylufHwxIT09ci5ub2RlVHlwZXx8dy5jbGVhbkRhdGEoeWUocikpLHIucGFyZW50Tm9kZSYmKG4mJncuY29udGFpbnMoci5vd25lckRvY3VtZW50LHIpJiZ2ZSh5ZShyLCJzY3JpcHQiKSksci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHIpKTtyZXR1cm4gZX13LmV4dGVuZCh7aHRtbFByZWZpbHRlcjpmdW5jdGlvbihlKXtyZXR1cm4gZS5yZXBsYWNlKE5lLCI8JDE+PC8kMj4iKX0sY2xvbmU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHM9ZS5jbG9uZU5vZGUoITApLHU9dy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSk7aWYoIShoLm5vQ2xvbmVDaGVja2VkfHwxIT09ZS5ub2RlVHlwZSYmMTEhPT1lLm5vZGVUeXBlfHx3LmlzWE1MRG9jKGUpKSlmb3IoYT15ZShzKSxyPTAsaT0obz15ZShlKSkubGVuZ3RoO3I8aTtyKyspTWUob1tyXSxhW3JdKTtpZih0KWlmKG4pZm9yKG89b3x8eWUoZSksYT1hfHx5ZShzKSxyPTAsaT1vLmxlbmd0aDtyPGk7cisrKVBlKG9bcl0sYVtyXSk7ZWxzZSBQZShlLHMpO3JldHVybihhPXllKHMsInNjcmlwdCIpKS5sZW5ndGg+MCYmdmUoYSwhdSYmeWUoZSwic2NyaXB0IikpLHN9LGNsZWFuRGF0YTpmdW5jdGlvbihlKXtmb3IodmFyIHQsbixyLGk9dy5ldmVudC5zcGVjaWFsLG89MDt2b2lkIDAhPT0obj1lW29dKTtvKyspaWYoWShuKSl7aWYodD1uW0ouZXhwYW5kb10pe2lmKHQuZXZlbnRzKWZvcihyIGluIHQuZXZlbnRzKWlbcl0/dy5ldmVudC5yZW1vdmUobixyKTp3LnJlbW92ZUV2ZW50KG4scix0LmhhbmRsZSk7bltKLmV4cGFuZG9dPXZvaWQgMH1uW0suZXhwYW5kb10mJihuW0suZXhwYW5kb109dm9pZCAwKX19fSksdy5mbi5leHRlbmQoe2RldGFjaDpmdW5jdGlvbihlKXtyZXR1cm4gSWUodGhpcyxlLCEwKX0scmVtb3ZlOmZ1bmN0aW9uKGUpe3JldHVybiBJZSh0aGlzLGUpfSx0ZXh0OmZ1bmN0aW9uKGUpe3JldHVybiB6KHRoaXMsZnVuY3Rpb24oZSl7cmV0dXJuIHZvaWQgMD09PWU/dy50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCl7MSE9PXRoaXMubm9kZVR5cGUmJjExIT09dGhpcy5ub2RlVHlwZSYmOSE9PXRoaXMubm9kZVR5cGV8fCh0aGlzLnRleHRDb250ZW50PWUpfSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIFJlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHxMZSh0aGlzLGUpLmFwcGVuZENoaWxkKGUpfSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gUmUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciB0PUxlKHRoaXMsZSk7dC5pbnNlcnRCZWZvcmUoZSx0LmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gUmUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gUmUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsdGhpcy5uZXh0U2libGluZyl9KX0sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGUsdD0wO251bGwhPShlPXRoaXNbdF0pO3QrKykxPT09ZS5ub2RlVHlwZSYmKHcuY2xlYW5EYXRhKHllKGUsITEpKSxlLnRleHRDb250ZW50PSIiKTtyZXR1cm4gdGhpc30sY2xvbmU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT1udWxsIT1lJiZlLHQ9bnVsbD09dD9lOnQsdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gdy5jbG9uZSh0aGlzLGUsdCl9KX0saHRtbDpmdW5jdGlvbihlKXtyZXR1cm4geih0aGlzLGZ1bmN0aW9uKGUpe3ZhciB0PXRoaXNbMF18fHt9LG49MCxyPXRoaXMubGVuZ3RoO2lmKHZvaWQgMD09PWUmJjE9PT10Lm5vZGVUeXBlKXJldHVybiB0LmlubmVySFRNTDtpZigic3RyaW5nIj09dHlwZW9mIGUmJiFBZS50ZXN0KGUpJiYhZ2VbKGRlLmV4ZWMoZSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCldKXtlPXcuaHRtbFByZWZpbHRlcihlKTt0cnl7Zm9yKDtuPHI7bisrKTE9PT0odD10aGlzW25dfHx7fSkubm9kZVR5cGUmJih3LmNsZWFuRGF0YSh5ZSh0LCExKSksdC5pbm5lckhUTUw9ZSk7dD0wfWNhdGNoKGUpe319dCYmdGhpcy5lbXB0eSgpLmFwcGVuZChlKX0sbnVsbCxlLGFyZ3VtZW50cy5sZW5ndGgpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybiBSZSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbih0KXt2YXIgbj10aGlzLnBhcmVudE5vZGU7dy5pbkFycmF5KHRoaXMsZSk8MCYmKHcuY2xlYW5EYXRhKHllKHRoaXMpKSxuJiZuLnJlcGxhY2VDaGlsZCh0LHRoaXMpKX0sZSl9fSksdy5lYWNoKHthcHBlbmRUbzoiYXBwZW5kIixwcmVwZW5kVG86InByZXBlbmQiLGluc2VydEJlZm9yZToiYmVmb3JlIixpbnNlcnRBZnRlcjoiYWZ0ZXIiLHJlcGxhY2VBbGw6InJlcGxhY2VXaXRoIn0sZnVuY3Rpb24oZSx0KXt3LmZuW2VdPWZ1bmN0aW9uKGUpe2Zvcih2YXIgbixyPVtdLGk9dyhlKSxvPWkubGVuZ3RoLTEsYT0wO2E8PW87YSsrKW49YT09PW8/dGhpczp0aGlzLmNsb25lKCEwKSx3KGlbYV0pW3RdKG4pLHMuYXBwbHkocixuLmdldCgpKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2socil9fSk7dmFyIFdlPW5ldyBSZWdFeHAoIl4oIityZSsiKSg/IXB4KVthLXolXSskIiwiaSIpLCRlPWZ1bmN0aW9uKHQpe3ZhciBuPXQub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztyZXR1cm4gbiYmbi5vcGVuZXJ8fChuPWUpLG4uZ2V0Q29tcHV0ZWRTdHlsZSh0KX0sQmU9bmV3IFJlZ0V4cChvZS5qb2luKCJ8IiksImkiKTshZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7aWYoYyl7bC5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O3dpZHRoOjYwcHg7bWFyZ2luLXRvcDoxcHg7cGFkZGluZzowO2JvcmRlcjowIixjLnN0eWxlLmNzc1RleHQ9InBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7Ym94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnNjcm9sbDttYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjYwJTt0b3A6MSUiLGJlLmFwcGVuZENoaWxkKGwpLmFwcGVuZENoaWxkKGMpO3ZhciB0PWUuZ2V0Q29tcHV0ZWRTdHlsZShjKTtpPSIxJSIhPT10LnRvcCx1PTEyPT09bih0Lm1hcmdpbkxlZnQpLGMuc3R5bGUucmlnaHQ9IjYwJSIscz0zNj09PW4odC5yaWdodCksbz0zNj09PW4odC53aWR0aCksYy5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLGE9MzY9PT1jLm9mZnNldFdpZHRofHwiYWJzb2x1dGUiLGJlLnJlbW92ZUNoaWxkKGwpLGM9bnVsbH19ZnVuY3Rpb24gbihlKXtyZXR1cm4gTWF0aC5yb3VuZChwYXJzZUZsb2F0KGUpKX12YXIgaSxvLGEscyx1LGw9ci5jcmVhdGVFbGVtZW50KCJkaXYiKSxjPXIuY3JlYXRlRWxlbWVudCgiZGl2Iik7Yy5zdHlsZSYmKGMuc3R5bGUuYmFja2dyb3VuZENsaXA9ImNvbnRlbnQtYm94IixjLmNsb25lTm9kZSghMCkuc3R5bGUuYmFja2dyb3VuZENsaXA9IiIsaC5jbGVhckNsb25lU3R5bGU9ImNvbnRlbnQtYm94Ij09PWMuc3R5bGUuYmFja2dyb3VuZENsaXAsdy5leHRlbmQoaCx7Ym94U2l6aW5nUmVsaWFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdCgpLG99LHBpeGVsQm94U3R5bGVzOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxzfSxwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHQoKSxpfSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdCgpLHV9LHNjcm9sbGJveFNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gdCgpLGF9fSkpfSgpO2Z1bmN0aW9uIEZlKGUsdCxuKXt2YXIgcixpLG8sYSxzPWUuc3R5bGU7cmV0dXJuKG49bnx8JGUoZSkpJiYoIiIhPT0oYT1uLmdldFByb3BlcnR5VmFsdWUodCl8fG5bdF0pfHx3LmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKXx8KGE9dy5zdHlsZShlLHQpKSwhaC5waXhlbEJveFN0eWxlcygpJiZXZS50ZXN0KGEpJiZCZS50ZXN0KHQpJiYocj1zLndpZHRoLGk9cy5taW5XaWR0aCxvPXMubWF4V2lkdGgscy5taW5XaWR0aD1zLm1heFdpZHRoPXMud2lkdGg9YSxhPW4ud2lkdGgscy53aWR0aD1yLHMubWluV2lkdGg9aSxzLm1heFdpZHRoPW8pKSx2b2lkIDAhPT1hP2ErIiI6YX1mdW5jdGlvbiBfZShlLHQpe3JldHVybntnZXQ6ZnVuY3Rpb24oKXtpZighZSgpKXJldHVybih0aGlzLmdldD10KS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7ZGVsZXRlIHRoaXMuZ2V0fX19dmFyIHplPS9eKG5vbmV8dGFibGUoPyEtY1tlYV0pLispLyxYZT0vXi0tLyxVZT17cG9zaXRpb246ImFic29sdXRlIix2aXNpYmlsaXR5OiJoaWRkZW4iLGRpc3BsYXk6ImJsb2NrIn0sVmU9e2xldHRlclNwYWNpbmc6IjAiLGZvbnRXZWlnaHQ6IjQwMCJ9LEdlPVsiV2Via2l0IiwiTW96IiwibXMiXSxZZT1yLmNyZWF0ZUVsZW1lbnQoImRpdiIpLnN0eWxlO2Z1bmN0aW9uIFFlKGUpe2lmKGUgaW4gWWUpcmV0dXJuIGU7dmFyIHQ9ZVswXS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSksbj1HZS5sZW5ndGg7d2hpbGUobi0tKWlmKChlPUdlW25dK3QpaW4gWWUpcmV0dXJuIGV9ZnVuY3Rpb24gSmUoZSl7dmFyIHQ9dy5jc3NQcm9wc1tlXTtyZXR1cm4gdHx8KHQ9dy5jc3NQcm9wc1tlXT1RZShlKXx8ZSksdH1mdW5jdGlvbiBLZShlLHQsbil7dmFyIHI9aWUuZXhlYyh0KTtyZXR1cm4gcj9NYXRoLm1heCgwLHJbMl0tKG58fDApKSsoclszXXx8InB4Iik6dH1mdW5jdGlvbiBaZShlLHQsbixyLGksbyl7dmFyIGE9IndpZHRoIj09PXQ/MTowLHM9MCx1PTA7aWYobj09PShyPyJib3JkZXIiOiJjb250ZW50IikpcmV0dXJuIDA7Zm9yKDthPDQ7YSs9MikibWFyZ2luIj09PW4mJih1Kz13LmNzcyhlLG4rb2VbYV0sITAsaSkpLHI/KCJjb250ZW50Ij09PW4mJih1LT13LmNzcyhlLCJwYWRkaW5nIitvZVthXSwhMCxpKSksIm1hcmdpbiIhPT1uJiYodS09dy5jc3MoZSwiYm9yZGVyIitvZVthXSsiV2lkdGgiLCEwLGkpKSk6KHUrPXcuY3NzKGUsInBhZGRpbmciK29lW2FdLCEwLGkpLCJwYWRkaW5nIiE9PW4/dSs9dy5jc3MoZSwiYm9yZGVyIitvZVthXSsiV2lkdGgiLCEwLGkpOnMrPXcuY3NzKGUsImJvcmRlciIrb2VbYV0rIldpZHRoIiwhMCxpKSk7cmV0dXJuIXImJm8+PTAmJih1Kz1NYXRoLm1heCgwLE1hdGguY2VpbChlWyJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpXS1vLXUtcy0uNSkpKSx1fWZ1bmN0aW9uIGV0KGUsdCxuKXt2YXIgcj0kZShlKSxpPUZlKGUsdCxyKSxvPSJib3JkZXItYm94Ij09PXcuY3NzKGUsImJveFNpemluZyIsITEsciksYT1vO2lmKFdlLnRlc3QoaSkpe2lmKCFuKXJldHVybiBpO2k9ImF1dG8ifXJldHVybiBhPWEmJihoLmJveFNpemluZ1JlbGlhYmxlKCl8fGk9PT1lLnN0eWxlW3RdKSwoImF1dG8iPT09aXx8IXBhcnNlRmxvYXQoaSkmJiJpbmxpbmUiPT09dy5jc3MoZSwiZGlzcGxheSIsITEscikpJiYoaT1lWyJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpXSxhPSEwKSwoaT1wYXJzZUZsb2F0KGkpfHwwKStaZShlLHQsbnx8KG8/ImJvcmRlciI6ImNvbnRlbnQiKSxhLHIsaSkrInB4In13LmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihlLHQpe2lmKHQpe3ZhciBuPUZlKGUsIm9wYWNpdHkiKTtyZXR1cm4iIj09PW4/IjEiOm59fX19LGNzc051bWJlcjp7YW5pbWF0aW9uSXRlcmF0aW9uQ291bnQ6ITAsY29sdW1uQ291bnQ6ITAsZmlsbE9wYWNpdHk6ITAsZmxleEdyb3c6ITAsZmxleFNocmluazohMCxmb250V2VpZ2h0OiEwLGxpbmVIZWlnaHQ6ITAsb3BhY2l0eTohMCxvcmRlcjohMCxvcnBoYW5zOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMH0sY3NzUHJvcHM6e30sc3R5bGU6ZnVuY3Rpb24oZSx0LG4scil7aWYoZSYmMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiZlLnN0eWxlKXt2YXIgaSxvLGEscz1HKHQpLHU9WGUudGVzdCh0KSxsPWUuc3R5bGU7aWYodXx8KHQ9SmUocykpLGE9dy5jc3NIb29rc1t0XXx8dy5jc3NIb29rc1tzXSx2b2lkIDA9PT1uKXJldHVybiBhJiYiZ2V0ImluIGEmJnZvaWQgMCE9PShpPWEuZ2V0KGUsITEscikpP2k6bFt0XTsic3RyaW5nIj09KG89dHlwZW9mIG4pJiYoaT1pZS5leGVjKG4pKSYmaVsxXSYmKG49dWUoZSx0LGkpLG89Im51bWJlciIpLG51bGwhPW4mJm49PT1uJiYoIm51bWJlciI9PT1vJiYobis9aSYmaVszXXx8KHcuY3NzTnVtYmVyW3NdPyIiOiJweCIpKSxoLmNsZWFyQ2xvbmVTdHlsZXx8IiIhPT1ufHwwIT09dC5pbmRleE9mKCJiYWNrZ3JvdW5kIil8fChsW3RdPSJpbmhlcml0IiksYSYmInNldCJpbiBhJiZ2b2lkIDA9PT0obj1hLnNldChlLG4scikpfHwodT9sLnNldFByb3BlcnR5KHQsbik6bFt0XT1uKSl9fSxjc3M6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHM9Ryh0KTtyZXR1cm4gWGUudGVzdCh0KXx8KHQ9SmUocykpLChhPXcuY3NzSG9va3NbdF18fHcuY3NzSG9va3Nbc10pJiYiZ2V0ImluIGEmJihpPWEuZ2V0KGUsITAsbikpLHZvaWQgMD09PWkmJihpPUZlKGUsdCxyKSksIm5vcm1hbCI9PT1pJiZ0IGluIFZlJiYoaT1WZVt0XSksIiI9PT1ufHxuPyhvPXBhcnNlRmxvYXQoaSksITA9PT1ufHxpc0Zpbml0ZShvKT9vfHwwOmkpOml9fSksdy5lYWNoKFsiaGVpZ2h0Iiwid2lkdGgiXSxmdW5jdGlvbihlLHQpe3cuY3NzSG9va3NbdF09e2dldDpmdW5jdGlvbihlLG4scil7aWYobilyZXR1cm4hemUudGVzdCh3LmNzcyhlLCJkaXNwbGF5IikpfHxlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoJiZlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoP2V0KGUsdCxyKTpzZShlLFVlLGZ1bmN0aW9uKCl7cmV0dXJuIGV0KGUsdCxyKX0pfSxzZXQ6ZnVuY3Rpb24oZSxuLHIpe3ZhciBpLG89JGUoZSksYT0iYm9yZGVyLWJveCI9PT13LmNzcyhlLCJib3hTaXppbmciLCExLG8pLHM9ciYmWmUoZSx0LHIsYSxvKTtyZXR1cm4gYSYmaC5zY3JvbGxib3hTaXplKCk9PT1vLnBvc2l0aW9uJiYocy09TWF0aC5jZWlsKGVbIm9mZnNldCIrdFswXS50b1VwcGVyQ2FzZSgpK3Quc2xpY2UoMSldLXBhcnNlRmxvYXQob1t0XSktWmUoZSx0LCJib3JkZXIiLCExLG8pLS41KSkscyYmKGk9aWUuZXhlYyhuKSkmJiJweCIhPT0oaVszXXx8InB4IikmJihlLnN0eWxlW3RdPW4sbj13LmNzcyhlLHQpKSxLZShlLG4scyl9fX0pLHcuY3NzSG9va3MubWFyZ2luTGVmdD1fZShoLnJlbGlhYmxlTWFyZ2luTGVmdCxmdW5jdGlvbihlLHQpe2lmKHQpcmV0dXJuKHBhcnNlRmxvYXQoRmUoZSwibWFyZ2luTGVmdCIpKXx8ZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0LXNlKGUse21hcmdpbkxlZnQ6MH0sZnVuY3Rpb24oKXtyZXR1cm4gZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0fSkpKyJweCJ9KSx3LmVhY2goe21hcmdpbjoiIixwYWRkaW5nOiIiLGJvcmRlcjoiV2lkdGgifSxmdW5jdGlvbihlLHQpe3cuY3NzSG9va3NbZSt0XT17ZXhwYW5kOmZ1bmN0aW9uKG4pe2Zvcih2YXIgcj0wLGk9e30sbz0ic3RyaW5nIj09dHlwZW9mIG4/bi5zcGxpdCgiICIpOltuXTtyPDQ7cisrKWlbZStvZVtyXSt0XT1vW3JdfHxvW3ItMl18fG9bMF07cmV0dXJuIGl9fSwibWFyZ2luIiE9PWUmJih3LmNzc0hvb2tzW2UrdF0uc2V0PUtlKX0pLHcuZm4uZXh0ZW5kKHtjc3M6ZnVuY3Rpb24oZSx0KXtyZXR1cm4geih0aGlzLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89e30sYT0wO2lmKEFycmF5LmlzQXJyYXkodCkpe2ZvcihyPSRlKGUpLGk9dC5sZW5ndGg7YTxpO2ErKylvW3RbYV1dPXcuY3NzKGUsdFthXSwhMSxyKTtyZXR1cm4gb31yZXR1cm4gdm9pZCAwIT09bj93LnN0eWxlKGUsdCxuKTp3LmNzcyhlLHQpfSxlLHQsYXJndW1lbnRzLmxlbmd0aD4xKX19KTtmdW5jdGlvbiB0dChlLHQsbixyLGkpe3JldHVybiBuZXcgdHQucHJvdG90eXBlLmluaXQoZSx0LG4scixpKX13LlR3ZWVuPXR0LHR0LnByb3RvdHlwZT17Y29uc3RydWN0b3I6dHQsaW5pdDpmdW5jdGlvbihlLHQsbixyLGksbyl7dGhpcy5lbGVtPWUsdGhpcy5wcm9wPW4sdGhpcy5lYXNpbmc9aXx8dy5lYXNpbmcuX2RlZmF1bHQsdGhpcy5vcHRpb25zPXQsdGhpcy5zdGFydD10aGlzLm5vdz10aGlzLmN1cigpLHRoaXMuZW5kPXIsdGhpcy51bml0PW98fCh3LmNzc051bWJlcltuXT8iIjoicHgiKX0sY3VyOmZ1bmN0aW9uKCl7dmFyIGU9dHQucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIGUmJmUuZ2V0P2UuZ2V0KHRoaXMpOnR0LnByb3BIb29rcy5fZGVmYXVsdC5nZXQodGhpcyl9LHJ1bjpmdW5jdGlvbihlKXt2YXIgdCxuPXR0LnByb3BIb29rc1t0aGlzLnByb3BdO3JldHVybiB0aGlzLm9wdGlvbnMuZHVyYXRpb24/dGhpcy5wb3M9dD13LmVhc2luZ1t0aGlzLmVhc2luZ10oZSx0aGlzLm9wdGlvbnMuZHVyYXRpb24qZSwwLDEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKTp0aGlzLnBvcz10PWUsdGhpcy5ub3c9KHRoaXMuZW5kLXRoaXMuc3RhcnQpKnQrdGhpcy5zdGFydCx0aGlzLm9wdGlvbnMuc3RlcCYmdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyksbiYmbi5zZXQ/bi5zZXQodGhpcyk6dHQucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKSx0aGlzfX0sdHQucHJvdG90eXBlLmluaXQucHJvdG90eXBlPXR0LnByb3RvdHlwZSx0dC5wcm9wSG9va3M9e19kZWZhdWx0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIDEhPT1lLmVsZW0ubm9kZVR5cGV8fG51bGwhPWUuZWxlbVtlLnByb3BdJiZudWxsPT1lLmVsZW0uc3R5bGVbZS5wcm9wXT9lLmVsZW1bZS5wcm9wXToodD13LmNzcyhlLmVsZW0sZS5wcm9wLCIiKSkmJiJhdXRvIiE9PXQ/dDowfSxzZXQ6ZnVuY3Rpb24oZSl7dy5meC5zdGVwW2UucHJvcF0/dy5meC5zdGVwW2UucHJvcF0oZSk6MSE9PWUuZWxlbS5ub2RlVHlwZXx8bnVsbD09ZS5lbGVtLnN0eWxlW3cuY3NzUHJvcHNbZS5wcm9wXV0mJiF3LmNzc0hvb2tzW2UucHJvcF0/ZS5lbGVtW2UucHJvcF09ZS5ub3c6dy5zdHlsZShlLmVsZW0sZS5wcm9wLGUubm93K2UudW5pdCl9fX0sdHQucHJvcEhvb2tzLnNjcm9sbFRvcD10dC5wcm9wSG9va3Muc2Nyb2xsTGVmdD17c2V0OmZ1bmN0aW9uKGUpe2UuZWxlbS5ub2RlVHlwZSYmZS5lbGVtLnBhcmVudE5vZGUmJihlLmVsZW1bZS5wcm9wXT1lLm5vdyl9fSx3LmVhc2luZz17bGluZWFyOmZ1bmN0aW9uKGUpe3JldHVybiBlfSxzd2luZzpmdW5jdGlvbihlKXtyZXR1cm4uNS1NYXRoLmNvcyhlKk1hdGguUEkpLzJ9LF9kZWZhdWx0OiJzd2luZyJ9LHcuZng9dHQucHJvdG90eXBlLmluaXQsdy5meC5zdGVwPXt9O3ZhciBudCxydCxpdD0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sb3Q9L3F1ZXVlSG9va3MkLztmdW5jdGlvbiBhdCgpe3J0JiYoITE9PT1yLmhpZGRlbiYmZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU/ZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYXQpOmUuc2V0VGltZW91dChhdCx3LmZ4LmludGVydmFsKSx3LmZ4LnRpY2soKSl9ZnVuY3Rpb24gc3QoKXtyZXR1cm4gZS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7bnQ9dm9pZCAwfSksbnQ9RGF0ZS5ub3coKX1mdW5jdGlvbiB1dChlLHQpe3ZhciBuLHI9MCxpPXtoZWlnaHQ6ZX07Zm9yKHQ9dD8xOjA7cjw0O3IrPTItdClpWyJtYXJnaW4iKyhuPW9lW3JdKV09aVsicGFkZGluZyIrbl09ZTtyZXR1cm4gdCYmKGkub3BhY2l0eT1pLndpZHRoPWUpLGl9ZnVuY3Rpb24gbHQoZSx0LG4pe2Zvcih2YXIgcixpPShwdC50d2VlbmVyc1t0XXx8W10pLmNvbmNhdChwdC50d2VlbmVyc1siKiJdKSxvPTAsYT1pLmxlbmd0aDtvPGE7bysrKWlmKHI9aVtvXS5jYWxsKG4sdCxlKSlyZXR1cm4gcn1mdW5jdGlvbiBjdChlLHQsbil7dmFyIHIsaSxvLGEscyx1LGwsYyxmPSJ3aWR0aCJpbiB0fHwiaGVpZ2h0ImluIHQscD10aGlzLGQ9e30saD1lLnN0eWxlLGc9ZS5ub2RlVHlwZSYmYWUoZSkseT1KLmdldChlLCJmeHNob3ciKTtuLnF1ZXVlfHwobnVsbD09KGE9dy5fcXVldWVIb29rcyhlLCJmeCIpKS51bnF1ZXVlZCYmKGEudW5xdWV1ZWQ9MCxzPWEuZW1wdHkuZmlyZSxhLmVtcHR5LmZpcmU9ZnVuY3Rpb24oKXthLnVucXVldWVkfHxzKCl9KSxhLnVucXVldWVkKysscC5hbHdheXMoZnVuY3Rpb24oKXtwLmFsd2F5cyhmdW5jdGlvbigpe2EudW5xdWV1ZWQtLSx3LnF1ZXVlKGUsImZ4IikubGVuZ3RofHxhLmVtcHR5LmZpcmUoKX0pfSkpO2ZvcihyIGluIHQpaWYoaT10W3JdLGl0LnRlc3QoaSkpe2lmKGRlbGV0ZSB0W3JdLG89b3x8InRvZ2dsZSI9PT1pLGk9PT0oZz8iaGlkZSI6InNob3ciKSl7aWYoInNob3ciIT09aXx8IXl8fHZvaWQgMD09PXlbcl0pY29udGludWU7Zz0hMH1kW3JdPXkmJnlbcl18fHcuc3R5bGUoZSxyKX1pZigodT0hdy5pc0VtcHR5T2JqZWN0KHQpKXx8IXcuaXNFbXB0eU9iamVjdChkKSl7ZiYmMT09PWUubm9kZVR5cGUmJihuLm92ZXJmbG93PVtoLm92ZXJmbG93LGgub3ZlcmZsb3dYLGgub3ZlcmZsb3dZXSxudWxsPT0obD15JiZ5LmRpc3BsYXkpJiYobD1KLmdldChlLCJkaXNwbGF5IikpLCJub25lIj09PShjPXcuY3NzKGUsImRpc3BsYXkiKSkmJihsP2M9bDooZmUoW2VdLCEwKSxsPWUuc3R5bGUuZGlzcGxheXx8bCxjPXcuY3NzKGUsImRpc3BsYXkiKSxmZShbZV0pKSksKCJpbmxpbmUiPT09Y3x8ImlubGluZS1ibG9jayI9PT1jJiZudWxsIT1sKSYmIm5vbmUiPT09dy5jc3MoZSwiZmxvYXQiKSYmKHV8fChwLmRvbmUoZnVuY3Rpb24oKXtoLmRpc3BsYXk9bH0pLG51bGw9PWwmJihjPWguZGlzcGxheSxsPSJub25lIj09PWM/IiI6YykpLGguZGlzcGxheT0iaW5saW5lLWJsb2NrIikpLG4ub3ZlcmZsb3cmJihoLm92ZXJmbG93PSJoaWRkZW4iLHAuYWx3YXlzKGZ1bmN0aW9uKCl7aC5vdmVyZmxvdz1uLm92ZXJmbG93WzBdLGgub3ZlcmZsb3dYPW4ub3ZlcmZsb3dbMV0saC5vdmVyZmxvd1k9bi5vdmVyZmxvd1syXX0pKSx1PSExO2ZvcihyIGluIGQpdXx8KHk/ImhpZGRlbiJpbiB5JiYoZz15LmhpZGRlbik6eT1KLmFjY2VzcyhlLCJmeHNob3ciLHtkaXNwbGF5Omx9KSxvJiYoeS5oaWRkZW49IWcpLGcmJmZlKFtlXSwhMCkscC5kb25lKGZ1bmN0aW9uKCl7Z3x8ZmUoW2VdKSxKLnJlbW92ZShlLCJmeHNob3ciKTtmb3IociBpbiBkKXcuc3R5bGUoZSxyLGRbcl0pfSkpLHU9bHQoZz95W3JdOjAscixwKSxyIGluIHl8fCh5W3JdPXUuc3RhcnQsZyYmKHUuZW5kPXUuc3RhcnQsdS5zdGFydD0wKSl9fWZ1bmN0aW9uIGZ0KGUsdCl7dmFyIG4scixpLG8sYTtmb3IobiBpbiBlKWlmKHI9RyhuKSxpPXRbcl0sbz1lW25dLEFycmF5LmlzQXJyYXkobykmJihpPW9bMV0sbz1lW25dPW9bMF0pLG4hPT1yJiYoZVtyXT1vLGRlbGV0ZSBlW25dKSwoYT13LmNzc0hvb2tzW3JdKSYmImV4cGFuZCJpbiBhKXtvPWEuZXhwYW5kKG8pLGRlbGV0ZSBlW3JdO2ZvcihuIGluIG8pbiBpbiBlfHwoZVtuXT1vW25dLHRbbl09aSl9ZWxzZSB0W3JdPWl9ZnVuY3Rpb24gcHQoZSx0LG4pe3ZhciByLGksbz0wLGE9cHQucHJlZmlsdGVycy5sZW5ndGgscz13LkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIHUuZWxlbX0pLHU9ZnVuY3Rpb24oKXtpZihpKXJldHVybiExO2Zvcih2YXIgdD1udHx8c3QoKSxuPU1hdGgubWF4KDAsbC5zdGFydFRpbWUrbC5kdXJhdGlvbi10KSxyPTEtKG4vbC5kdXJhdGlvbnx8MCksbz0wLGE9bC50d2VlbnMubGVuZ3RoO288YTtvKyspbC50d2VlbnNbb10ucnVuKHIpO3JldHVybiBzLm5vdGlmeVdpdGgoZSxbbCxyLG5dKSxyPDEmJmE/bjooYXx8cy5ub3RpZnlXaXRoKGUsW2wsMSwwXSkscy5yZXNvbHZlV2l0aChlLFtsXSksITEpfSxsPXMucHJvbWlzZSh7ZWxlbTplLHByb3BzOncuZXh0ZW5kKHt9LHQpLG9wdHM6dy5leHRlbmQoITAse3NwZWNpYWxFYXNpbmc6e30sZWFzaW5nOncuZWFzaW5nLl9kZWZhdWx0fSxuKSxvcmlnaW5hbFByb3BlcnRpZXM6dCxvcmlnaW5hbE9wdGlvbnM6bixzdGFydFRpbWU6bnR8fHN0KCksZHVyYXRpb246bi5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24odCxuKXt2YXIgcj13LlR3ZWVuKGUsbC5vcHRzLHQsbixsLm9wdHMuc3BlY2lhbEVhc2luZ1t0XXx8bC5vcHRzLmVhc2luZyk7cmV0dXJuIGwudHdlZW5zLnB1c2gocikscn0sc3RvcDpmdW5jdGlvbih0KXt2YXIgbj0wLHI9dD9sLnR3ZWVucy5sZW5ndGg6MDtpZihpKXJldHVybiB0aGlzO2ZvcihpPSEwO248cjtuKyspbC50d2VlbnNbbl0ucnVuKDEpO3JldHVybiB0PyhzLm5vdGlmeVdpdGgoZSxbbCwxLDBdKSxzLnJlc29sdmVXaXRoKGUsW2wsdF0pKTpzLnJlamVjdFdpdGgoZSxbbCx0XSksdGhpc319KSxjPWwucHJvcHM7Zm9yKGZ0KGMsbC5vcHRzLnNwZWNpYWxFYXNpbmcpO288YTtvKyspaWYocj1wdC5wcmVmaWx0ZXJzW29dLmNhbGwobCxlLGMsbC5vcHRzKSlyZXR1cm4gZyhyLnN0b3ApJiYody5fcXVldWVIb29rcyhsLmVsZW0sbC5vcHRzLnF1ZXVlKS5zdG9wPXIuc3RvcC5iaW5kKHIpKSxyO3JldHVybiB3Lm1hcChjLGx0LGwpLGcobC5vcHRzLnN0YXJ0KSYmbC5vcHRzLnN0YXJ0LmNhbGwoZSxsKSxsLnByb2dyZXNzKGwub3B0cy5wcm9ncmVzcykuZG9uZShsLm9wdHMuZG9uZSxsLm9wdHMuY29tcGxldGUpLmZhaWwobC5vcHRzLmZhaWwpLmFsd2F5cyhsLm9wdHMuYWx3YXlzKSx3LmZ4LnRpbWVyKHcuZXh0ZW5kKHUse2VsZW06ZSxhbmltOmwscXVldWU6bC5vcHRzLnF1ZXVlfSkpLGx9dy5BbmltYXRpb249dy5leHRlbmQocHQse3R3ZWVuZXJzOnsiKiI6W2Z1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5jcmVhdGVUd2VlbihlLHQpO3JldHVybiB1ZShuLmVsZW0sZSxpZS5leGVjKHQpLG4pLG59XX0sdHdlZW5lcjpmdW5jdGlvbihlLHQpe2coZSk/KHQ9ZSxlPVsiKiJdKTplPWUubWF0Y2goTSk7Zm9yKHZhciBuLHI9MCxpPWUubGVuZ3RoO3I8aTtyKyspbj1lW3JdLHB0LnR3ZWVuZXJzW25dPXB0LnR3ZWVuZXJzW25dfHxbXSxwdC50d2VlbmVyc1tuXS51bnNoaWZ0KHQpfSxwcmVmaWx0ZXJzOltjdF0scHJlZmlsdGVyOmZ1bmN0aW9uKGUsdCl7dD9wdC5wcmVmaWx0ZXJzLnVuc2hpZnQoZSk6cHQucHJlZmlsdGVycy5wdXNoKGUpfX0pLHcuc3BlZWQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWUmJiJvYmplY3QiPT10eXBlb2YgZT93LmV4dGVuZCh7fSxlKTp7Y29tcGxldGU6bnx8IW4mJnR8fGcoZSkmJmUsZHVyYXRpb246ZSxlYXNpbmc6biYmdHx8dCYmIWcodCkmJnR9O3JldHVybiB3LmZ4Lm9mZj9yLmR1cmF0aW9uPTA6Im51bWJlciIhPXR5cGVvZiByLmR1cmF0aW9uJiYoci5kdXJhdGlvbiBpbiB3LmZ4LnNwZWVkcz9yLmR1cmF0aW9uPXcuZnguc3BlZWRzW3IuZHVyYXRpb25dOnIuZHVyYXRpb249dy5meC5zcGVlZHMuX2RlZmF1bHQpLG51bGwhPXIucXVldWUmJiEwIT09ci5xdWV1ZXx8KHIucXVldWU9ImZ4Iiksci5vbGQ9ci5jb21wbGV0ZSxyLmNvbXBsZXRlPWZ1bmN0aW9uKCl7ZyhyLm9sZCkmJnIub2xkLmNhbGwodGhpcyksci5xdWV1ZSYmdy5kZXF1ZXVlKHRoaXMsci5xdWV1ZSl9LHJ9LHcuZm4uZXh0ZW5kKHtmYWRlVG86ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIHRoaXMuZmlsdGVyKGFlKS5jc3MoIm9wYWNpdHkiLDApLnNob3coKS5lbmQoKS5hbmltYXRlKHtvcGFjaXR5OnR9LGUsbixyKX0sYW5pbWF0ZTpmdW5jdGlvbihlLHQsbixyKXt2YXIgaT13LmlzRW1wdHlPYmplY3QoZSksbz13LnNwZWVkKHQsbixyKSxhPWZ1bmN0aW9uKCl7dmFyIHQ9cHQodGhpcyx3LmV4dGVuZCh7fSxlKSxvKTsoaXx8Si5nZXQodGhpcywiZmluaXNoIikpJiZ0LnN0b3AoITApfTtyZXR1cm4gYS5maW5pc2g9YSxpfHwhMT09PW8ucXVldWU/dGhpcy5lYWNoKGEpOnRoaXMucXVldWUoby5xdWV1ZSxhKX0sc3RvcDpmdW5jdGlvbihlLHQsbil7dmFyIHI9ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5zdG9wO2RlbGV0ZSBlLnN0b3AsdChuKX07cmV0dXJuInN0cmluZyIhPXR5cGVvZiBlJiYobj10LHQ9ZSxlPXZvaWQgMCksdCYmITEhPT1lJiZ0aGlzLnF1ZXVlKGV8fCJmeCIsW10pLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PSEwLGk9bnVsbCE9ZSYmZSsicXVldWVIb29rcyIsbz13LnRpbWVycyxhPUouZ2V0KHRoaXMpO2lmKGkpYVtpXSYmYVtpXS5zdG9wJiZyKGFbaV0pO2Vsc2UgZm9yKGkgaW4gYSlhW2ldJiZhW2ldLnN0b3AmJm90LnRlc3QoaSkmJnIoYVtpXSk7Zm9yKGk9by5sZW5ndGg7aS0tOylvW2ldLmVsZW0hPT10aGlzfHxudWxsIT1lJiZvW2ldLnF1ZXVlIT09ZXx8KG9baV0uYW5pbS5zdG9wKG4pLHQ9ITEsby5zcGxpY2UoaSwxKSk7IXQmJm58fHcuZGVxdWV1ZSh0aGlzLGUpfSl9LGZpbmlzaDpmdW5jdGlvbihlKXtyZXR1cm4hMSE9PWUmJihlPWV8fCJmeCIpLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0LG49Si5nZXQodGhpcykscj1uW2UrInF1ZXVlIl0saT1uW2UrInF1ZXVlSG9va3MiXSxvPXcudGltZXJzLGE9cj9yLmxlbmd0aDowO2ZvcihuLmZpbmlzaD0hMCx3LnF1ZXVlKHRoaXMsZSxbXSksaSYmaS5zdG9wJiZpLnN0b3AuY2FsbCh0aGlzLCEwKSx0PW8ubGVuZ3RoO3QtLTspb1t0XS5lbGVtPT09dGhpcyYmb1t0XS5xdWV1ZT09PWUmJihvW3RdLmFuaW0uc3RvcCghMCksby5zcGxpY2UodCwxKSk7Zm9yKHQ9MDt0PGE7dCsrKXJbdF0mJnJbdF0uZmluaXNoJiZyW3RdLmZpbmlzaC5jYWxsKHRoaXMpO2RlbGV0ZSBuLmZpbmlzaH0pfX0pLHcuZWFjaChbInRvZ2dsZSIsInNob3ciLCJoaWRlIl0sZnVuY3Rpb24oZSx0KXt2YXIgbj13LmZuW3RdO3cuZm5bdF09ZnVuY3Rpb24oZSxyLGkpe3JldHVybiBudWxsPT1lfHwiYm9vbGVhbiI9PXR5cGVvZiBlP24uYXBwbHkodGhpcyxhcmd1bWVudHMpOnRoaXMuYW5pbWF0ZSh1dCh0LCEwKSxlLHIsaSl9fSksdy5lYWNoKHtzbGlkZURvd246dXQoInNob3ciKSxzbGlkZVVwOnV0KCJoaWRlIiksc2xpZGVUb2dnbGU6dXQoInRvZ2dsZSIpLGZhZGVJbjp7b3BhY2l0eToic2hvdyJ9LGZhZGVPdXQ6e29wYWNpdHk6ImhpZGUifSxmYWRlVG9nZ2xlOntvcGFjaXR5OiJ0b2dnbGUifX0sZnVuY3Rpb24oZSx0KXt3LmZuW2VdPWZ1bmN0aW9uKGUsbixyKXtyZXR1cm4gdGhpcy5hbmltYXRlKHQsZSxuLHIpfX0pLHcudGltZXJzPVtdLHcuZngudGljaz1mdW5jdGlvbigpe3ZhciBlLHQ9MCxuPXcudGltZXJzO2ZvcihudD1EYXRlLm5vdygpO3Q8bi5sZW5ndGg7dCsrKShlPW5bdF0pKCl8fG5bdF0hPT1lfHxuLnNwbGljZSh0LS0sMSk7bi5sZW5ndGh8fHcuZnguc3RvcCgpLG50PXZvaWQgMH0sdy5meC50aW1lcj1mdW5jdGlvbihlKXt3LnRpbWVycy5wdXNoKGUpLHcuZnguc3RhcnQoKX0sdy5meC5pbnRlcnZhbD0xMyx3LmZ4LnN0YXJ0PWZ1bmN0aW9uKCl7cnR8fChydD0hMCxhdCgpKX0sdy5meC5zdG9wPWZ1bmN0aW9uKCl7cnQ9bnVsbH0sdy5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sdy5mbi5kZWxheT1mdW5jdGlvbih0LG4pe3JldHVybiB0PXcuZng/dy5meC5zcGVlZHNbdF18fHQ6dCxuPW58fCJmeCIsdGhpcy5xdWV1ZShuLGZ1bmN0aW9uKG4scil7dmFyIGk9ZS5zZXRUaW1lb3V0KG4sdCk7ci5zdG9wPWZ1bmN0aW9uKCl7ZS5jbGVhclRpbWVvdXQoaSl9fSl9LGZ1bmN0aW9uKCl7dmFyIGU9ci5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLHQ9ci5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKS5hcHBlbmRDaGlsZChyLmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpKTtlLnR5cGU9ImNoZWNrYm94IixoLmNoZWNrT249IiIhPT1lLnZhbHVlLGgub3B0U2VsZWN0ZWQ9dC5zZWxlY3RlZCwoZT1yLmNyZWF0ZUVsZW1lbnQoImlucHV0IikpLnZhbHVlPSJ0IixlLnR5cGU9InJhZGlvIixoLnJhZGlvVmFsdWU9InQiPT09ZS52YWx1ZX0oKTt2YXIgZHQsaHQ9dy5leHByLmF0dHJIYW5kbGU7dy5mbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0KXtyZXR1cm4geih0aGlzLHcuYXR0cixlLHQsYXJndW1lbnRzLmxlbmd0aD4xKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dy5yZW1vdmVBdHRyKHRoaXMsZSl9KX19KSx3LmV4dGVuZCh7YXR0cjpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvPWUubm9kZVR5cGU7aWYoMyE9PW8mJjghPT1vJiYyIT09bylyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIGUuZ2V0QXR0cmlidXRlP3cucHJvcChlLHQsbik6KDE9PT1vJiZ3LmlzWE1MRG9jKGUpfHwoaT13LmF0dHJIb29rc1t0LnRvTG93ZXJDYXNlKCldfHwody5leHByLm1hdGNoLmJvb2wudGVzdCh0KT9kdDp2b2lkIDApKSx2b2lkIDAhPT1uP251bGw9PT1uP3ZvaWQgdy5yZW1vdmVBdHRyKGUsdCk6aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6KGUuc2V0QXR0cmlidXRlKHQsbisiIiksbik6aSYmImdldCJpbiBpJiZudWxsIT09KHI9aS5nZXQoZSx0KSk/cjpudWxsPT0ocj13LmZpbmQuYXR0cihlLHQpKT92b2lkIDA6cil9LGF0dHJIb29rczp7dHlwZTp7c2V0OmZ1bmN0aW9uKGUsdCl7aWYoIWgucmFkaW9WYWx1ZSYmInJhZGlvIj09PXQmJk4oZSwiaW5wdXQiKSl7dmFyIG49ZS52YWx1ZTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoInR5cGUiLHQpLG4mJihlLnZhbHVlPW4pLHR9fX19LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTAsaT10JiZ0Lm1hdGNoKE0pO2lmKGkmJjE9PT1lLm5vZGVUeXBlKXdoaWxlKG49aVtyKytdKWUucmVtb3ZlQXR0cmlidXRlKG4pfX0pLGR0PXtzZXQ6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiExPT09dD93LnJlbW92ZUF0dHIoZSxuKTplLnNldEF0dHJpYnV0ZShuLG4pLG59fSx3LmVhY2gody5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oZSx0KXt2YXIgbj1odFt0XXx8dy5maW5kLmF0dHI7aHRbdF09ZnVuY3Rpb24oZSx0LHIpe3ZhciBpLG8sYT10LnRvTG93ZXJDYXNlKCk7cmV0dXJuIHJ8fChvPWh0W2FdLGh0W2FdPWksaT1udWxsIT1uKGUsdCxyKT9hOm51bGwsaHRbYV09byksaX19KTt2YXIgZ3Q9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSx5dD0vXig/OmF8YXJlYSkkL2k7dy5mbi5leHRlbmQoe3Byb3A6ZnVuY3Rpb24oZSx0KXtyZXR1cm4geih0aGlzLHcucHJvcCxlLHQsYXJndW1lbnRzLmxlbmd0aD4xKX0scmVtb3ZlUHJvcDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXNbdy5wcm9wRml4W2VdfHxlXX0pfX0pLHcuZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89ZS5ub2RlVHlwZTtpZigzIT09byYmOCE9PW8mJjIhPT1vKXJldHVybiAxPT09byYmdy5pc1hNTERvYyhlKXx8KHQ9dy5wcm9wRml4W3RdfHx0LGk9dy5wcm9wSG9va3NbdF0pLHZvaWQgMCE9PW4/aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6ZVt0XT1uOmkmJiJnZXQiaW4gaSYmbnVsbCE9PShyPWkuZ2V0KGUsdCkpP3I6ZVt0XX0scHJvcEhvb2tzOnt0YWJJbmRleDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PXcuZmluZC5hdHRyKGUsInRhYmluZGV4Iik7cmV0dXJuIHQ/cGFyc2VJbnQodCwxMCk6Z3QudGVzdChlLm5vZGVOYW1lKXx8eXQudGVzdChlLm5vZGVOYW1lKSYmZS5ocmVmPzA6LTF9fX0scHJvcEZpeDp7ImZvciI6Imh0bWxGb3IiLCJjbGFzcyI6ImNsYXNzTmFtZSJ9fSksaC5vcHRTZWxlY3RlZHx8KHcucHJvcEhvb2tzLnNlbGVjdGVkPXtnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3JldHVybiB0JiZ0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LG51bGx9LHNldDpmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGU7dCYmKHQuc2VsZWN0ZWRJbmRleCx0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KX19KSx3LmVhY2goWyJ0YWJJbmRleCIsInJlYWRPbmx5IiwibWF4TGVuZ3RoIiwiY2VsbFNwYWNpbmciLCJjZWxsUGFkZGluZyIsInJvd1NwYW4iLCJjb2xTcGFuIiwidXNlTWFwIiwiZnJhbWVCb3JkZXIiLCJjb250ZW50RWRpdGFibGUiXSxmdW5jdGlvbigpe3cucHJvcEZpeFt0aGlzLnRvTG93ZXJDYXNlKCldPXRoaXN9KTtmdW5jdGlvbiB2dChlKXtyZXR1cm4oZS5tYXRjaChNKXx8W10pLmpvaW4oIiAiKX1mdW5jdGlvbiBtdChlKXtyZXR1cm4gZS5nZXRBdHRyaWJ1dGUmJmUuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIn1mdW5jdGlvbiB4dChlKXtyZXR1cm4gQXJyYXkuaXNBcnJheShlKT9lOiJzdHJpbmciPT10eXBlb2YgZT9lLm1hdGNoKE0pfHxbXTpbXX13LmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGksbyxhLHMsdT0wO2lmKGcoZSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbih0KXt3KHRoaXMpLmFkZENsYXNzKGUuY2FsbCh0aGlzLHQsbXQodGhpcykpKX0pO2lmKCh0PXh0KGUpKS5sZW5ndGgpd2hpbGUobj10aGlzW3UrK10paWYoaT1tdChuKSxyPTE9PT1uLm5vZGVUeXBlJiYiICIrdnQoaSkrIiAiKXthPTA7d2hpbGUobz10W2ErK10pci5pbmRleE9mKCIgIitvKyIgIik8MCYmKHIrPW8rIiAiKTtpIT09KHM9dnQocikpJiZuLnNldEF0dHJpYnV0ZSgiY2xhc3MiLHMpfXJldHVybiB0aGlzfSxyZW1vdmVDbGFzczpmdW5jdGlvbihlKXt2YXIgdCxuLHIsaSxvLGEscyx1PTA7aWYoZyhlKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKHQpe3codGhpcykucmVtb3ZlQ2xhc3MoZS5jYWxsKHRoaXMsdCxtdCh0aGlzKSkpfSk7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuYXR0cigiY2xhc3MiLCIiKTtpZigodD14dChlKSkubGVuZ3RoKXdoaWxlKG49dGhpc1t1KytdKWlmKGk9bXQobikscj0xPT09bi5ub2RlVHlwZSYmIiAiK3Z0KGkpKyIgIil7YT0wO3doaWxlKG89dFthKytdKXdoaWxlKHIuaW5kZXhPZigiICIrbysiICIpPi0xKXI9ci5yZXBsYWNlKCIgIitvKyIgIiwiICIpO2khPT0ocz12dChyKSkmJm4uc2V0QXR0cmlidXRlKCJjbGFzcyIscyl9cmV0dXJuIHRoaXN9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGUsdCl7dmFyIG49dHlwZW9mIGUscj0ic3RyaW5nIj09PW58fEFycmF5LmlzQXJyYXkoZSk7cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgdCYmcj90P3RoaXMuYWRkQ2xhc3MoZSk6dGhpcy5yZW1vdmVDbGFzcyhlKTpnKGUpP3RoaXMuZWFjaChmdW5jdGlvbihuKXt3KHRoaXMpLnRvZ2dsZUNsYXNzKGUuY2FsbCh0aGlzLG4sbXQodGhpcyksdCksdCl9KTp0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgdCxpLG8sYTtpZihyKXtpPTAsbz13KHRoaXMpLGE9eHQoZSk7d2hpbGUodD1hW2krK10pby5oYXNDbGFzcyh0KT9vLnJlbW92ZUNsYXNzKHQpOm8uYWRkQ2xhc3ModCl9ZWxzZSB2b2lkIDAhPT1lJiYiYm9vbGVhbiIhPT1ufHwoKHQ9bXQodGhpcykpJiZKLnNldCh0aGlzLCJfX2NsYXNzTmFtZV9fIix0KSx0aGlzLnNldEF0dHJpYnV0ZSYmdGhpcy5zZXRBdHRyaWJ1dGUoImNsYXNzIix0fHwhMT09PWU/IiI6Si5nZXQodGhpcywiX19jbGFzc05hbWVfXyIpfHwiIikpfSl9LGhhc0NsYXNzOmZ1bmN0aW9uKGUpe3ZhciB0LG4scj0wO3Q9IiAiK2UrIiAiO3doaWxlKG49dGhpc1tyKytdKWlmKDE9PT1uLm5vZGVUeXBlJiYoIiAiK3Z0KG10KG4pKSsiICIpLmluZGV4T2YodCk+LTEpcmV0dXJuITA7cmV0dXJuITF9fSk7dmFyIGJ0PS9cci9nO3cuZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGk9dGhpc1swXTt7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gcj1nKGUpLHRoaXMuZWFjaChmdW5jdGlvbihuKXt2YXIgaTsxPT09dGhpcy5ub2RlVHlwZSYmKG51bGw9PShpPXI/ZS5jYWxsKHRoaXMsbix3KHRoaXMpLnZhbCgpKTplKT9pPSIiOiJudW1iZXIiPT10eXBlb2YgaT9pKz0iIjpBcnJheS5pc0FycmF5KGkpJiYoaT13Lm1hcChpLGZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lPyIiOmUrIiJ9KSksKHQ9dy52YWxIb29rc1t0aGlzLnR5cGVdfHx3LnZhbEhvb2tzW3RoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pJiYic2V0ImluIHQmJnZvaWQgMCE9PXQuc2V0KHRoaXMsaSwidmFsdWUiKXx8KHRoaXMudmFsdWU9aSkpfSk7aWYoaSlyZXR1cm4odD13LnZhbEhvb2tzW2kudHlwZV18fHcudmFsSG9va3NbaS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkmJiJnZXQiaW4gdCYmdm9pZCAwIT09KG49dC5nZXQoaSwidmFsdWUiKSk/bjoic3RyaW5nIj09dHlwZW9mKG49aS52YWx1ZSk/bi5yZXBsYWNlKGJ0LCIiKTpudWxsPT1uPyIiOm59fX0pLHcuZXh0ZW5kKHt2YWxIb29rczp7b3B0aW9uOntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9dy5maW5kLmF0dHIoZSwidmFsdWUiKTtyZXR1cm4gbnVsbCE9dD90OnZ0KHcudGV4dChlKSl9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihlKXt2YXIgdCxuLHIsaT1lLm9wdGlvbnMsbz1lLnNlbGVjdGVkSW5kZXgsYT0ic2VsZWN0LW9uZSI9PT1lLnR5cGUscz1hP251bGw6W10sdT1hP28rMTppLmxlbmd0aDtmb3Iocj1vPDA/dTphP286MDtyPHU7cisrKWlmKCgobj1pW3JdKS5zZWxlY3RlZHx8cj09PW8pJiYhbi5kaXNhYmxlZCYmKCFuLnBhcmVudE5vZGUuZGlzYWJsZWR8fCFOKG4ucGFyZW50Tm9kZSwib3B0Z3JvdXAiKSkpe2lmKHQ9dyhuKS52YWwoKSxhKXJldHVybiB0O3MucHVzaCh0KX1yZXR1cm4gc30sc2V0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpPWUub3B0aW9ucyxvPXcubWFrZUFycmF5KHQpLGE9aS5sZW5ndGg7d2hpbGUoYS0tKSgocj1pW2FdKS5zZWxlY3RlZD13LmluQXJyYXkody52YWxIb29rcy5vcHRpb24uZ2V0KHIpLG8pPi0xKSYmKG49ITApO3JldHVybiBufHwoZS5zZWxlY3RlZEluZGV4PS0xKSxvfX19fSksdy5lYWNoKFsicmFkaW8iLCJjaGVja2JveCJdLGZ1bmN0aW9uKCl7dy52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGUsdCl7aWYoQXJyYXkuaXNBcnJheSh0KSlyZXR1cm4gZS5jaGVja2VkPXcuaW5BcnJheSh3KGUpLnZhbCgpLHQpPi0xfX0saC5jaGVja09ufHwody52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PT1lLmdldEF0dHJpYnV0ZSgidmFsdWUiKT8ib24iOmUudmFsdWV9KX0pLGguZm9jdXNpbj0ib25mb2N1c2luImluIGU7dmFyIHd0PS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLyxUdD1mdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpfTt3LmV4dGVuZCh3LmV2ZW50LHt0cmlnZ2VyOmZ1bmN0aW9uKHQsbixpLG8pe3ZhciBhLHMsdSxsLGMscCxkLGgsdj1baXx8cl0sbT1mLmNhbGwodCwidHlwZSIpP3QudHlwZTp0LHg9Zi5jYWxsKHQsIm5hbWVzcGFjZSIpP3QubmFtZXNwYWNlLnNwbGl0KCIuIik6W107aWYocz1oPXU9aT1pfHxyLDMhPT1pLm5vZGVUeXBlJiY4IT09aS5ub2RlVHlwZSYmIXd0LnRlc3QobSt3LmV2ZW50LnRyaWdnZXJlZCkmJihtLmluZGV4T2YoIi4iKT4tMSYmKG09KHg9bS5zcGxpdCgiLiIpKS5zaGlmdCgpLHguc29ydCgpKSxjPW0uaW5kZXhPZigiOiIpPDAmJiJvbiIrbSx0PXRbdy5leHBhbmRvXT90Om5ldyB3LkV2ZW50KG0sIm9iamVjdCI9PXR5cGVvZiB0JiZ0KSx0LmlzVHJpZ2dlcj1vPzI6Myx0Lm5hbWVzcGFjZT14LmpvaW4oIi4iKSx0LnJuYW1lc3BhY2U9dC5uYW1lc3BhY2U/bmV3IFJlZ0V4cCgiKF58XFwuKSIreC5qb2luKCJcXC4oPzouKlxcLnwpIikrIihcXC58JCkiKTpudWxsLHQucmVzdWx0PXZvaWQgMCx0LnRhcmdldHx8KHQudGFyZ2V0PWkpLG49bnVsbD09bj9bdF06dy5tYWtlQXJyYXkobixbdF0pLGQ9dy5ldmVudC5zcGVjaWFsW21dfHx7fSxvfHwhZC50cmlnZ2VyfHwhMSE9PWQudHJpZ2dlci5hcHBseShpLG4pKSl7aWYoIW8mJiFkLm5vQnViYmxlJiYheShpKSl7Zm9yKGw9ZC5kZWxlZ2F0ZVR5cGV8fG0sd3QudGVzdChsK20pfHwocz1zLnBhcmVudE5vZGUpO3M7cz1zLnBhcmVudE5vZGUpdi5wdXNoKHMpLHU9czt1PT09KGkub3duZXJEb2N1bWVudHx8cikmJnYucHVzaCh1LmRlZmF1bHRWaWV3fHx1LnBhcmVudFdpbmRvd3x8ZSl9YT0wO3doaWxlKChzPXZbYSsrXSkmJiF0LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpaD1zLHQudHlwZT1hPjE/bDpkLmJpbmRUeXBlfHxtLChwPShKLmdldChzLCJldmVudHMiKXx8e30pW3QudHlwZV0mJkouZ2V0KHMsImhhbmRsZSIpKSYmcC5hcHBseShzLG4pLChwPWMmJnNbY10pJiZwLmFwcGx5JiZZKHMpJiYodC5yZXN1bHQ9cC5hcHBseShzLG4pLCExPT09dC5yZXN1bHQmJnQucHJldmVudERlZmF1bHQoKSk7cmV0dXJuIHQudHlwZT1tLG98fHQuaXNEZWZhdWx0UHJldmVudGVkKCl8fGQuX2RlZmF1bHQmJiExIT09ZC5fZGVmYXVsdC5hcHBseSh2LnBvcCgpLG4pfHwhWShpKXx8YyYmZyhpW21dKSYmIXkoaSkmJigodT1pW2NdKSYmKGlbY109bnVsbCksdy5ldmVudC50cmlnZ2VyZWQ9bSx0LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkmJmguYWRkRXZlbnRMaXN0ZW5lcihtLFR0KSxpW21dKCksdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiZoLnJlbW92ZUV2ZW50TGlzdGVuZXIobSxUdCksdy5ldmVudC50cmlnZ2VyZWQ9dm9pZCAwLHUmJihpW2NdPXUpKSx0LnJlc3VsdH19LHNpbXVsYXRlOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj13LmV4dGVuZChuZXcgdy5FdmVudCxuLHt0eXBlOmUsaXNTaW11bGF0ZWQ6ITB9KTt3LmV2ZW50LnRyaWdnZXIocixudWxsLHQpfX0pLHcuZm4uZXh0ZW5kKHt0cmlnZ2VyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3cuZXZlbnQudHJpZ2dlcihlLHQsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzWzBdO2lmKG4pcmV0dXJuIHcuZXZlbnQudHJpZ2dlcihlLHQsbiwhMCl9fSksaC5mb2N1c2lufHx3LmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKGUsdCl7dmFyIG49ZnVuY3Rpb24oZSl7dy5ldmVudC5zaW11bGF0ZSh0LGUudGFyZ2V0LHcuZXZlbnQuZml4KGUpKX07dy5ldmVudC5zcGVjaWFsW3RdPXtzZXR1cDpmdW5jdGlvbigpe3ZhciByPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyxpPUouYWNjZXNzKHIsdCk7aXx8ci5hZGRFdmVudExpc3RlbmVyKGUsbiwhMCksSi5hY2Nlc3Mocix0LChpfHwwKSsxKX0sdGVhcmRvd246ZnVuY3Rpb24oKXt2YXIgcj10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsaT1KLmFjY2VzcyhyLHQpLTE7aT9KLmFjY2VzcyhyLHQsaSk6KHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLG4sITApLEoucmVtb3ZlKHIsdCkpfX19KTt2YXIgQ3Q9ZS5sb2NhdGlvbixFdD1EYXRlLm5vdygpLGt0PS9cPy87dy5wYXJzZVhNTD1mdW5jdGlvbih0KXt2YXIgbjtpZighdHx8InN0cmluZyIhPXR5cGVvZiB0KXJldHVybiBudWxsO3RyeXtuPShuZXcgZS5ET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyh0LCJ0ZXh0L3htbCIpfWNhdGNoKGUpe249dm9pZCAwfXJldHVybiBuJiYhbi5nZXRFbGVtZW50c0J5VGFnTmFtZSgicGFyc2VyZXJyb3IiKS5sZW5ndGh8fHcuZXJyb3IoIkludmFsaWQgWE1MOiAiK3QpLG59O3ZhciBTdD0vXFtcXSQvLER0PS9ccj9cbi9nLE50PS9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSxBdD0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7ZnVuY3Rpb24ganQoZSx0LG4scil7dmFyIGk7aWYoQXJyYXkuaXNBcnJheSh0KSl3LmVhY2godCxmdW5jdGlvbih0LGkpe258fFN0LnRlc3QoZSk/cihlLGkpOmp0KGUrIlsiKygib2JqZWN0Ij09dHlwZW9mIGkmJm51bGwhPWk/dDoiIikrIl0iLGksbixyKX0pO2Vsc2UgaWYobnx8Im9iamVjdCIhPT14KHQpKXIoZSx0KTtlbHNlIGZvcihpIGluIHQpanQoZSsiWyIraSsiXSIsdFtpXSxuLHIpfXcucGFyYW09ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9ZnVuY3Rpb24oZSx0KXt2YXIgbj1nKHQpP3QoKTp0O3Jbci5sZW5ndGhdPWVuY29kZVVSSUNvbXBvbmVudChlKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG51bGw9PW4/IiI6bil9O2lmKEFycmF5LmlzQXJyYXkoZSl8fGUuanF1ZXJ5JiYhdy5pc1BsYWluT2JqZWN0KGUpKXcuZWFjaChlLGZ1bmN0aW9uKCl7aSh0aGlzLm5hbWUsdGhpcy52YWx1ZSl9KTtlbHNlIGZvcihuIGluIGUpanQobixlW25dLHQsaSk7cmV0dXJuIHIuam9pbigiJiIpfSx3LmZuLmV4dGVuZCh7c2VyaWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHcucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKX0sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZT13LnByb3AodGhpcywiZWxlbWVudHMiKTtyZXR1cm4gZT93Lm1ha2VBcnJheShlKTp0aGlzfSkuZmlsdGVyKGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy50eXBlO3JldHVybiB0aGlzLm5hbWUmJiF3KHRoaXMpLmlzKCI6ZGlzYWJsZWQiKSYmQXQudGVzdCh0aGlzLm5vZGVOYW1lKSYmIU50LnRlc3QoZSkmJih0aGlzLmNoZWNrZWR8fCFwZS50ZXN0KGUpKX0pLm1hcChmdW5jdGlvbihlLHQpe3ZhciBuPXcodGhpcykudmFsKCk7cmV0dXJuIG51bGw9PW4/bnVsbDpBcnJheS5pc0FycmF5KG4pP3cubWFwKG4sZnVuY3Rpb24oZSl7cmV0dXJue25hbWU6dC5uYW1lLHZhbHVlOmUucmVwbGFjZShEdCwiXHJcbiIpfX0pOntuYW1lOnQubmFtZSx2YWx1ZTpuLnJlcGxhY2UoRHQsIlxyXG4iKX19KS5nZXQoKX19KTt2YXIgcXQ9LyUyMC9nLEx0PS8jLiokLyxIdD0vKFs/Jl0pXz1bXiZdKi8sT3Q9L14oLio/KTpbIFx0XSooW15cclxuXSopJC9nbSxQdD0vXig/OmFib3V0fGFwcHxhcHAtc3RvcmFnZXwuKy1leHRlbnNpb258ZmlsZXxyZXN8d2lkZ2V0KTokLyxNdD0vXig/OkdFVHxIRUFEKSQvLFJ0PS9eXC9cLy8sSXQ9e30sV3Q9e30sJHQ9IiovIi5jb25jYXQoIioiKSxCdD1yLmNyZWF0ZUVsZW1lbnQoImEiKTtCdC5ocmVmPUN0LmhyZWY7ZnVuY3Rpb24gRnQoZSl7cmV0dXJuIGZ1bmN0aW9uKHQsbil7InN0cmluZyIhPXR5cGVvZiB0JiYobj10LHQ9IioiKTt2YXIgcixpPTAsbz10LnRvTG93ZXJDYXNlKCkubWF0Y2goTSl8fFtdO2lmKGcobikpd2hpbGUocj1vW2krK10pIisiPT09clswXT8ocj1yLnNsaWNlKDEpfHwiKiIsKGVbcl09ZVtyXXx8W10pLnVuc2hpZnQobikpOihlW3JdPWVbcl18fFtdKS5wdXNoKG4pfX1mdW5jdGlvbiBfdChlLHQsbixyKXt2YXIgaT17fSxvPWU9PT1XdDtmdW5jdGlvbiBhKHMpe3ZhciB1O3JldHVybiBpW3NdPSEwLHcuZWFjaChlW3NdfHxbXSxmdW5jdGlvbihlLHMpe3ZhciBsPXModCxuLHIpO3JldHVybiJzdHJpbmciIT10eXBlb2YgbHx8b3x8aVtsXT9vPyEodT1sKTp2b2lkIDA6KHQuZGF0YVR5cGVzLnVuc2hpZnQobCksYShsKSwhMSl9KSx1fXJldHVybiBhKHQuZGF0YVR5cGVzWzBdKXx8IWlbIioiXSYmYSgiKiIpfWZ1bmN0aW9uIHp0KGUsdCl7dmFyIG4scixpPXcuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IobiBpbiB0KXZvaWQgMCE9PXRbbl0mJigoaVtuXT9lOnJ8fChyPXt9KSlbbl09dFtuXSk7cmV0dXJuIHImJncuZXh0ZW5kKCEwLGUsciksZX1mdW5jdGlvbiBYdChlLHQsbil7dmFyIHIsaSxvLGEscz1lLmNvbnRlbnRzLHU9ZS5kYXRhVHlwZXM7d2hpbGUoIioiPT09dVswXSl1LnNoaWZ0KCksdm9pZCAwPT09ciYmKHI9ZS5taW1lVHlwZXx8dC5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1UeXBlIikpO2lmKHIpZm9yKGkgaW4gcylpZihzW2ldJiZzW2ldLnRlc3Qocikpe3UudW5zaGlmdChpKTticmVha31pZih1WzBdaW4gbilvPXVbMF07ZWxzZXtmb3IoaSBpbiBuKXtpZighdVswXXx8ZS5jb252ZXJ0ZXJzW2krIiAiK3VbMF1dKXtvPWk7YnJlYWt9YXx8KGE9aSl9bz1vfHxhfWlmKG8pcmV0dXJuIG8hPT11WzBdJiZ1LnVuc2hpZnQobyksbltvXX1mdW5jdGlvbiBVdChlLHQsbixyKXt2YXIgaSxvLGEscyx1LGw9e30sYz1lLmRhdGFUeXBlcy5zbGljZSgpO2lmKGNbMV0pZm9yKGEgaW4gZS5jb252ZXJ0ZXJzKWxbYS50b0xvd2VyQ2FzZSgpXT1lLmNvbnZlcnRlcnNbYV07bz1jLnNoaWZ0KCk7d2hpbGUobylpZihlLnJlc3BvbnNlRmllbGRzW29dJiYobltlLnJlc3BvbnNlRmllbGRzW29dXT10KSwhdSYmciYmZS5kYXRhRmlsdGVyJiYodD1lLmRhdGFGaWx0ZXIodCxlLmRhdGFUeXBlKSksdT1vLG89Yy5zaGlmdCgpKWlmKCIqIj09PW8pbz11O2Vsc2UgaWYoIioiIT09dSYmdSE9PW8pe2lmKCEoYT1sW3UrIiAiK29dfHxsWyIqICIrb10pKWZvcihpIGluIGwpaWYoKHM9aS5zcGxpdCgiICIpKVsxXT09PW8mJihhPWxbdSsiICIrc1swXV18fGxbIiogIitzWzBdXSkpeyEwPT09YT9hPWxbaV06ITAhPT1sW2ldJiYobz1zWzBdLGMudW5zaGlmdChzWzFdKSk7YnJlYWt9aWYoITAhPT1hKWlmKGEmJmVbInRocm93cyJdKXQ9YSh0KTtlbHNlIHRyeXt0PWEodCl9Y2F0Y2goZSl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6YT9lOiJObyBjb252ZXJzaW9uIGZyb20gIit1KyIgdG8gIitvfX19cmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOnR9fXcuZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fSxhamF4U2V0dGluZ3M6e3VybDpDdC5ocmVmLHR5cGU6IkdFVCIsaXNMb2NhbDpQdC50ZXN0KEN0LnByb3RvY29sKSxnbG9iYWw6ITAscHJvY2Vzc0RhdGE6ITAsYXN5bmM6ITAsY29udGVudFR5cGU6ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsYWNjZXB0czp7IioiOiR0LHRleHQ6InRleHQvcGxhaW4iLGh0bWw6InRleHQvaHRtbCIseG1sOiJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIixqc29uOiJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQifSxjb250ZW50czp7eG1sOi9cYnhtbFxiLyxodG1sOi9cYmh0bWwvLGpzb246L1xianNvblxiL30scmVzcG9uc2VGaWVsZHM6e3htbDoicmVzcG9uc2VYTUwiLHRleHQ6InJlc3BvbnNlVGV4dCIsanNvbjoicmVzcG9uc2VKU09OIn0sY29udmVydGVyczp7IiogdGV4dCI6U3RyaW5nLCJ0ZXh0IGh0bWwiOiEwLCJ0ZXh0IGpzb24iOkpTT04ucGFyc2UsInRleHQgeG1sIjp3LnBhcnNlWE1MfSxmbGF0T3B0aW9uczp7dXJsOiEwLGNvbnRleHQ6ITB9fSxhamF4U2V0dXA6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdD96dCh6dChlLHcuYWpheFNldHRpbmdzKSx0KTp6dCh3LmFqYXhTZXR0aW5ncyxlKX0sYWpheFByZWZpbHRlcjpGdChJdCksYWpheFRyYW5zcG9ydDpGdChXdCksYWpheDpmdW5jdGlvbih0LG4peyJvYmplY3QiPT10eXBlb2YgdCYmKG49dCx0PXZvaWQgMCksbj1ufHx7fTt2YXIgaSxvLGEscyx1LGwsYyxmLHAsZCxoPXcuYWpheFNldHVwKHt9LG4pLGc9aC5jb250ZXh0fHxoLHk9aC5jb250ZXh0JiYoZy5ub2RlVHlwZXx8Zy5qcXVlcnkpP3coZyk6dy5ldmVudCx2PXcuRGVmZXJyZWQoKSxtPXcuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHg9aC5zdGF0dXNDb2RlfHx7fSxiPXt9LFQ9e30sQz0iY2FuY2VsZWQiLEU9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihlKXt2YXIgdDtpZihjKXtpZighcyl7cz17fTt3aGlsZSh0PU90LmV4ZWMoYSkpc1t0WzFdLnRvTG93ZXJDYXNlKCldPXRbMl19dD1zW2UudG9Mb3dlckNhc2UoKV19cmV0dXJuIG51bGw9PXQ/bnVsbDp0fSxnZXRBbGxSZXNwb25zZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gYz9hOm51bGx9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbnVsbD09YyYmKGU9VFtlLnRvTG93ZXJDYXNlKCldPVRbZS50b0xvd2VyQ2FzZSgpXXx8ZSxiW2VdPXQpLHRoaXN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWMmJihoLm1pbWVUeXBlPWUpLHRoaXN9LHN0YXR1c0NvZGU6ZnVuY3Rpb24oZSl7dmFyIHQ7aWYoZSlpZihjKUUuYWx3YXlzKGVbRS5zdGF0dXNdKTtlbHNlIGZvcih0IGluIGUpeFt0XT1beFt0XSxlW3RdXTtyZXR1cm4gdGhpc30sYWJvcnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZXx8QztyZXR1cm4gaSYmaS5hYm9ydCh0KSxrKDAsdCksdGhpc319O2lmKHYucHJvbWlzZShFKSxoLnVybD0oKHR8fGgudXJsfHxDdC5ocmVmKSsiIikucmVwbGFjZShSdCxDdC5wcm90b2NvbCsiLy8iKSxoLnR5cGU9bi5tZXRob2R8fG4udHlwZXx8aC5tZXRob2R8fGgudHlwZSxoLmRhdGFUeXBlcz0oaC5kYXRhVHlwZXx8IioiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKE0pfHxbIiJdLG51bGw9PWguY3Jvc3NEb21haW4pe2w9ci5jcmVhdGVFbGVtZW50KCJhIik7dHJ5e2wuaHJlZj1oLnVybCxsLmhyZWY9bC5ocmVmLGguY3Jvc3NEb21haW49QnQucHJvdG9jb2wrIi8vIitCdC5ob3N0IT1sLnByb3RvY29sKyIvLyIrbC5ob3N0fWNhdGNoKGUpe2guY3Jvc3NEb21haW49ITB9fWlmKGguZGF0YSYmaC5wcm9jZXNzRGF0YSYmInN0cmluZyIhPXR5cGVvZiBoLmRhdGEmJihoLmRhdGE9dy5wYXJhbShoLmRhdGEsaC50cmFkaXRpb25hbCkpLF90KEl0LGgsbixFKSxjKXJldHVybiBFOyhmPXcuZXZlbnQmJmguZ2xvYmFsKSYmMD09dy5hY3RpdmUrKyYmdy5ldmVudC50cmlnZ2VyKCJhamF4U3RhcnQiKSxoLnR5cGU9aC50eXBlLnRvVXBwZXJDYXNlKCksaC5oYXNDb250ZW50PSFNdC50ZXN0KGgudHlwZSksbz1oLnVybC5yZXBsYWNlKEx0LCIiKSxoLmhhc0NvbnRlbnQ/aC5kYXRhJiZoLnByb2Nlc3NEYXRhJiYwPT09KGguY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmKGguZGF0YT1oLmRhdGEucmVwbGFjZShxdCwiKyIpKTooZD1oLnVybC5zbGljZShvLmxlbmd0aCksaC5kYXRhJiYoaC5wcm9jZXNzRGF0YXx8InN0cmluZyI9PXR5cGVvZiBoLmRhdGEpJiYobys9KGt0LnRlc3Qobyk/IiYiOiI/IikraC5kYXRhLGRlbGV0ZSBoLmRhdGEpLCExPT09aC5jYWNoZSYmKG89by5yZXBsYWNlKEh0LCIkMSIpLGQ9KGt0LnRlc3Qobyk/IiYiOiI/IikrIl89IitFdCsrK2QpLGgudXJsPW8rZCksaC5pZk1vZGlmaWVkJiYody5sYXN0TW9kaWZpZWRbb10mJkUuc2V0UmVxdWVzdEhlYWRlcigiSWYtTW9kaWZpZWQtU2luY2UiLHcubGFzdE1vZGlmaWVkW29dKSx3LmV0YWdbb10mJkUuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsdy5ldGFnW29dKSksKGguZGF0YSYmaC5oYXNDb250ZW50JiYhMSE9PWguY29udGVudFR5cGV8fG4uY29udGVudFR5cGUpJiZFLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsaC5jb250ZW50VHlwZSksRS5zZXRSZXF1ZXN0SGVhZGVyKCJBY2NlcHQiLGguZGF0YVR5cGVzWzBdJiZoLmFjY2VwdHNbaC5kYXRhVHlwZXNbMF1dP2guYWNjZXB0c1toLmRhdGFUeXBlc1swXV0rKCIqIiE9PWguZGF0YVR5cGVzWzBdPyIsICIrJHQrIjsgcT0wLjAxIjoiIik6aC5hY2NlcHRzWyIqIl0pO2ZvcihwIGluIGguaGVhZGVycylFLnNldFJlcXVlc3RIZWFkZXIocCxoLmhlYWRlcnNbcF0pO2lmKGguYmVmb3JlU2VuZCYmKCExPT09aC5iZWZvcmVTZW5kLmNhbGwoZyxFLGgpfHxjKSlyZXR1cm4gRS5hYm9ydCgpO2lmKEM9ImFib3J0IixtLmFkZChoLmNvbXBsZXRlKSxFLmRvbmUoaC5zdWNjZXNzKSxFLmZhaWwoaC5lcnJvciksaT1fdChXdCxoLG4sRSkpe2lmKEUucmVhZHlTdGF0ZT0xLGYmJnkudHJpZ2dlcigiYWpheFNlbmQiLFtFLGhdKSxjKXJldHVybiBFO2guYXN5bmMmJmgudGltZW91dD4wJiYodT1lLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtFLmFib3J0KCJ0aW1lb3V0Iil9LGgudGltZW91dCkpO3RyeXtjPSExLGkuc2VuZChiLGspfWNhdGNoKGUpe2lmKGMpdGhyb3cgZTtrKC0xLGUpfX1lbHNlIGsoLTEsIk5vIFRyYW5zcG9ydCIpO2Z1bmN0aW9uIGsodCxuLHIscyl7dmFyIGwscCxkLGIsVCxDPW47Y3x8KGM9ITAsdSYmZS5jbGVhclRpbWVvdXQodSksaT12b2lkIDAsYT1zfHwiIixFLnJlYWR5U3RhdGU9dD4wPzQ6MCxsPXQ+PTIwMCYmdDwzMDB8fDMwND09PXQsciYmKGI9WHQoaCxFLHIpKSxiPVV0KGgsYixFLGwpLGw/KGguaWZNb2RpZmllZCYmKChUPUUuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKSkmJih3Lmxhc3RNb2RpZmllZFtvXT1UKSwoVD1FLmdldFJlc3BvbnNlSGVhZGVyKCJldGFnIikpJiYody5ldGFnW29dPVQpKSwyMDQ9PT10fHwiSEVBRCI9PT1oLnR5cGU/Qz0ibm9jb250ZW50IjozMDQ9PT10P0M9Im5vdG1vZGlmaWVkIjooQz1iLnN0YXRlLHA9Yi5kYXRhLGw9IShkPWIuZXJyb3IpKSk6KGQ9QywhdCYmQ3x8KEM9ImVycm9yIix0PDAmJih0PTApKSksRS5zdGF0dXM9dCxFLnN0YXR1c1RleHQ9KG58fEMpKyIiLGw/di5yZXNvbHZlV2l0aChnLFtwLEMsRV0pOnYucmVqZWN0V2l0aChnLFtFLEMsZF0pLEUuc3RhdHVzQ29kZSh4KSx4PXZvaWQgMCxmJiZ5LnRyaWdnZXIobD8iYWpheFN1Y2Nlc3MiOiJhamF4RXJyb3IiLFtFLGgsbD9wOmRdKSxtLmZpcmVXaXRoKGcsW0UsQ10pLGYmJih5LnRyaWdnZXIoImFqYXhDb21wbGV0ZSIsW0UsaF0pLC0tdy5hY3RpdmV8fHcuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSkpfXJldHVybiBFfSxnZXRKU09OOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdy5nZXQoZSx0LG4sImpzb24iKX0sZ2V0U2NyaXB0OmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHcuZ2V0KGUsdm9pZCAwLHQsInNjcmlwdCIpfX0pLHcuZWFjaChbImdldCIsInBvc3QiXSxmdW5jdGlvbihlLHQpe3dbdF09ZnVuY3Rpb24oZSxuLHIsaSl7cmV0dXJuIGcobikmJihpPWl8fHIscj1uLG49dm9pZCAwKSx3LmFqYXgody5leHRlbmQoe3VybDplLHR5cGU6dCxkYXRhVHlwZTppLGRhdGE6bixzdWNjZXNzOnJ9LHcuaXNQbGFpbk9iamVjdChlKSYmZSkpfX0pLHcuX2V2YWxVcmw9ZnVuY3Rpb24oZSl7cmV0dXJuIHcuYWpheCh7dXJsOmUsdHlwZToiR0VUIixkYXRhVHlwZToic2NyaXB0IixjYWNoZTohMCxhc3luYzohMSxnbG9iYWw6ITEsInRocm93cyI6ITB9KX0sdy5mbi5leHRlbmQoe3dyYXBBbGw6ZnVuY3Rpb24oZSl7dmFyIHQ7cmV0dXJuIHRoaXNbMF0mJihnKGUpJiYoZT1lLmNhbGwodGhpc1swXSkpLHQ9dyhlLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApLHRoaXNbMF0ucGFyZW50Tm9kZSYmdC5pbnNlcnRCZWZvcmUodGhpc1swXSksdC5tYXAoZnVuY3Rpb24oKXt2YXIgZT10aGlzO3doaWxlKGUuZmlyc3RFbGVtZW50Q2hpbGQpZT1lLmZpcnN0RWxlbWVudENoaWxkO3JldHVybiBlfSkuYXBwZW5kKHRoaXMpKSx0aGlzfSx3cmFwSW5uZXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGcoZSk/dGhpcy5lYWNoKGZ1bmN0aW9uKHQpe3codGhpcykud3JhcElubmVyKGUuY2FsbCh0aGlzLHQpKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciB0PXcodGhpcyksbj10LmNvbnRlbnRzKCk7bi5sZW5ndGg/bi53cmFwQWxsKGUpOnQuYXBwZW5kKGUpfSl9LHdyYXA6ZnVuY3Rpb24oZSl7dmFyIHQ9ZyhlKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKG4pe3codGhpcykud3JhcEFsbCh0P2UuY2FsbCh0aGlzLG4pOmUpfSl9LHVud3JhcDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wYXJlbnQoZSkubm90KCJib2R5IikuZWFjaChmdW5jdGlvbigpe3codGhpcykucmVwbGFjZVdpdGgodGhpcy5jaGlsZE5vZGVzKX0pLHRoaXN9fSksdy5leHByLnBzZXVkb3MuaGlkZGVuPWZ1bmN0aW9uKGUpe3JldHVybiF3LmV4cHIucHNldWRvcy52aXNpYmxlKGUpfSx3LmV4cHIucHNldWRvcy52aXNpYmxlPWZ1bmN0aW9uKGUpe3JldHVybiEhKGUub2Zmc2V0V2lkdGh8fGUub2Zmc2V0SGVpZ2h0fHxlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKX0sdy5hamF4U2V0dGluZ3MueGhyPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiBuZXcgZS5YTUxIdHRwUmVxdWVzdH1jYXRjaChlKXt9fTt2YXIgVnQ9ezA6MjAwLDEyMjM6MjA0fSxHdD13LmFqYXhTZXR0aW5ncy54aHIoKTtoLmNvcnM9ISFHdCYmIndpdGhDcmVkZW50aWFscyJpbiBHdCxoLmFqYXg9R3Q9ISFHdCx3LmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24odCl7dmFyIG4scjtpZihoLmNvcnN8fEd0JiYhdC5jcm9zc0RvbWFpbilyZXR1cm57c2VuZDpmdW5jdGlvbihpLG8pe3ZhciBhLHM9dC54aHIoKTtpZihzLm9wZW4odC50eXBlLHQudXJsLHQuYXN5bmMsdC51c2VybmFtZSx0LnBhc3N3b3JkKSx0LnhockZpZWxkcylmb3IoYSBpbiB0LnhockZpZWxkcylzW2FdPXQueGhyRmllbGRzW2FdO3QubWltZVR5cGUmJnMub3ZlcnJpZGVNaW1lVHlwZSYmcy5vdmVycmlkZU1pbWVUeXBlKHQubWltZVR5cGUpLHQuY3Jvc3NEb21haW58fGlbIlgtUmVxdWVzdGVkLVdpdGgiXXx8KGlbIlgtUmVxdWVzdGVkLVdpdGgiXT0iWE1MSHR0cFJlcXVlc3QiKTtmb3IoYSBpbiBpKXMuc2V0UmVxdWVzdEhlYWRlcihhLGlbYV0pO249ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKCl7biYmKG49cj1zLm9ubG9hZD1zLm9uZXJyb3I9cy5vbmFib3J0PXMub250aW1lb3V0PXMub25yZWFkeXN0YXRlY2hhbmdlPW51bGwsImFib3J0Ij09PWU/cy5hYm9ydCgpOiJlcnJvciI9PT1lPyJudW1iZXIiIT10eXBlb2Ygcy5zdGF0dXM/bygwLCJlcnJvciIpOm8ocy5zdGF0dXMscy5zdGF0dXNUZXh0KTpvKFZ0W3Muc3RhdHVzXXx8cy5zdGF0dXMscy5zdGF0dXNUZXh0LCJ0ZXh0IiE9PShzLnJlc3BvbnNlVHlwZXx8InRleHQiKXx8InN0cmluZyIhPXR5cGVvZiBzLnJlc3BvbnNlVGV4dD97YmluYXJ5OnMucmVzcG9uc2V9Ont0ZXh0OnMucmVzcG9uc2VUZXh0fSxzLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSl9fSxzLm9ubG9hZD1uKCkscj1zLm9uZXJyb3I9cy5vbnRpbWVvdXQ9bigiZXJyb3IiKSx2b2lkIDAhPT1zLm9uYWJvcnQ/cy5vbmFib3J0PXI6cy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKXs0PT09cy5yZWFkeVN0YXRlJiZlLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtuJiZyKCl9KX0sbj1uKCJhYm9ydCIpO3RyeXtzLnNlbmQodC5oYXNDb250ZW50JiZ0LmRhdGF8fG51bGwpfWNhdGNoKGUpe2lmKG4pdGhyb3cgZX19LGFib3J0OmZ1bmN0aW9uKCl7biYmbigpfX19KSx3LmFqYXhQcmVmaWx0ZXIoZnVuY3Rpb24oZSl7ZS5jcm9zc0RvbWFpbiYmKGUuY29udGVudHMuc2NyaXB0PSExKX0pLHcuYWpheFNldHVwKHthY2NlcHRzOntzY3JpcHQ6InRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0In0sY29udGVudHM6e3NjcmlwdDovXGIoPzpqYXZhfGVjbWEpc2NyaXB0XGIvfSxjb252ZXJ0ZXJzOnsidGV4dCBzY3JpcHQiOmZ1bmN0aW9uKGUpe3JldHVybiB3Lmdsb2JhbEV2YWwoZSksZX19fSksdy5hamF4UHJlZmlsdGVyKCJzY3JpcHQiLGZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUuY2FjaGUmJihlLmNhY2hlPSExKSxlLmNyb3NzRG9tYWluJiYoZS50eXBlPSJHRVQiKX0pLHcuYWpheFRyYW5zcG9ydCgic2NyaXB0IixmdW5jdGlvbihlKXtpZihlLmNyb3NzRG9tYWluKXt2YXIgdCxuO3JldHVybntzZW5kOmZ1bmN0aW9uKGksbyl7dD13KCI8c2NyaXB0PiIpLnByb3Aoe2NoYXJzZXQ6ZS5zY3JpcHRDaGFyc2V0LHNyYzplLnVybH0pLm9uKCJsb2FkIGVycm9yIixuPWZ1bmN0aW9uKGUpe3QucmVtb3ZlKCksbj1udWxsLGUmJm8oImVycm9yIj09PWUudHlwZT80MDQ6MjAwLGUudHlwZSl9KSxyLmhlYWQuYXBwZW5kQ2hpbGQodFswXSl9LGFib3J0OmZ1bmN0aW9uKCl7biYmbigpfX19fSk7dmFyIFl0PVtdLFF0PS8oPSlcPyg/PSZ8JCl8XD9cPy87dy5hamF4U2V0dXAoe2pzb25wOiJjYWxsYmFjayIsanNvbnBDYWxsYmFjazpmdW5jdGlvbigpe3ZhciBlPVl0LnBvcCgpfHx3LmV4cGFuZG8rIl8iK0V0Kys7cmV0dXJuIHRoaXNbZV09ITAsZX19KSx3LmFqYXhQcmVmaWx0ZXIoImpzb24ganNvbnAiLGZ1bmN0aW9uKHQsbixyKXt2YXIgaSxvLGEscz0hMSE9PXQuanNvbnAmJihRdC50ZXN0KHQudXJsKT8idXJsIjoic3RyaW5nIj09dHlwZW9mIHQuZGF0YSYmMD09PSh0LmNvbnRlbnRUeXBlfHwiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikmJlF0LnRlc3QodC5kYXRhKSYmImRhdGEiKTtpZihzfHwianNvbnAiPT09dC5kYXRhVHlwZXNbMF0pcmV0dXJuIGk9dC5qc29ucENhbGxiYWNrPWcodC5qc29ucENhbGxiYWNrKT90Lmpzb25wQ2FsbGJhY2soKTp0Lmpzb25wQ2FsbGJhY2sscz90W3NdPXRbc10ucmVwbGFjZShRdCwiJDEiK2kpOiExIT09dC5qc29ucCYmKHQudXJsKz0oa3QudGVzdCh0LnVybCk/IiYiOiI/IikrdC5qc29ucCsiPSIraSksdC5jb252ZXJ0ZXJzWyJzY3JpcHQganNvbiJdPWZ1bmN0aW9uKCl7cmV0dXJuIGF8fHcuZXJyb3IoaSsiIHdhcyBub3QgY2FsbGVkIiksYVswXX0sdC5kYXRhVHlwZXNbMF09Impzb24iLG89ZVtpXSxlW2ldPWZ1bmN0aW9uKCl7YT1hcmd1bWVudHN9LHIuYWx3YXlzKGZ1bmN0aW9uKCl7dm9pZCAwPT09bz93KGUpLnJlbW92ZVByb3AoaSk6ZVtpXT1vLHRbaV0mJih0Lmpzb25wQ2FsbGJhY2s9bi5qc29ucENhbGxiYWNrLFl0LnB1c2goaSkpLGEmJmcobykmJm8oYVswXSksYT1vPXZvaWQgMH0pLCJzY3JpcHQifSksaC5jcmVhdGVIVE1MRG9jdW1lbnQ9ZnVuY3Rpb24oKXt2YXIgZT1yLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keTtyZXR1cm4gZS5pbm5lckhUTUw9Ijxmb3JtPjwvZm9ybT48Zm9ybT48L2Zvcm0+IiwyPT09ZS5jaGlsZE5vZGVzLmxlbmd0aH0oKSx3LnBhcnNlSFRNTD1mdW5jdGlvbihlLHQsbil7aWYoInN0cmluZyIhPXR5cGVvZiBlKXJldHVybltdOyJib29sZWFuIj09dHlwZW9mIHQmJihuPXQsdD0hMSk7dmFyIGksbyxhO3JldHVybiB0fHwoaC5jcmVhdGVIVE1MRG9jdW1lbnQ/KChpPSh0PXIuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCIiKSkuY3JlYXRlRWxlbWVudCgiYmFzZSIpKS5ocmVmPXIubG9jYXRpb24uaHJlZix0LmhlYWQuYXBwZW5kQ2hpbGQoaSkpOnQ9ciksbz1BLmV4ZWMoZSksYT0hbiYmW10sbz9bdC5jcmVhdGVFbGVtZW50KG9bMV0pXToobz14ZShbZV0sdCxhKSxhJiZhLmxlbmd0aCYmdyhhKS5yZW1vdmUoKSx3Lm1lcmdlKFtdLG8uY2hpbGROb2RlcykpfSx3LmZuLmxvYWQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPXRoaXMscz1lLmluZGV4T2YoIiAiKTtyZXR1cm4gcz4tMSYmKHI9dnQoZS5zbGljZShzKSksZT1lLnNsaWNlKDAscykpLGcodCk/KG49dCx0PXZvaWQgMCk6dCYmIm9iamVjdCI9PXR5cGVvZiB0JiYoaT0iUE9TVCIpLGEubGVuZ3RoPjAmJncuYWpheCh7dXJsOmUsdHlwZTppfHwiR0VUIixkYXRhVHlwZToiaHRtbCIsZGF0YTp0fSkuZG9uZShmdW5jdGlvbihlKXtvPWFyZ3VtZW50cyxhLmh0bWwocj93KCI8ZGl2PiIpLmFwcGVuZCh3LnBhcnNlSFRNTChlKSkuZmluZChyKTplKX0pLmFsd2F5cyhuJiZmdW5jdGlvbihlLHQpe2EuZWFjaChmdW5jdGlvbigpe24uYXBwbHkodGhpcyxvfHxbZS5yZXNwb25zZVRleHQsdCxlXSl9KX0pLHRoaXN9LHcuZWFjaChbImFqYXhTdGFydCIsImFqYXhTdG9wIiwiYWpheENvbXBsZXRlIiwiYWpheEVycm9yIiwiYWpheFN1Y2Nlc3MiLCJhamF4U2VuZCJdLGZ1bmN0aW9uKGUsdCl7dy5mblt0XT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5vbih0LGUpfX0pLHcuZXhwci5wc2V1ZG9zLmFuaW1hdGVkPWZ1bmN0aW9uKGUpe3JldHVybiB3LmdyZXAody50aW1lcnMsZnVuY3Rpb24odCl7cmV0dXJuIGU9PT10LmVsZW19KS5sZW5ndGh9LHcub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsLGM9dy5jc3MoZSwicG9zaXRpb24iKSxmPXcoZSkscD17fTsic3RhdGljIj09PWMmJihlLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSIpLHM9Zi5vZmZzZXQoKSxvPXcuY3NzKGUsInRvcCIpLHU9dy5jc3MoZSwibGVmdCIpLChsPSgiYWJzb2x1dGUiPT09Y3x8ImZpeGVkIj09PWMpJiYobyt1KS5pbmRleE9mKCJhdXRvIik+LTEpPyhhPShyPWYucG9zaXRpb24oKSkudG9wLGk9ci5sZWZ0KTooYT1wYXJzZUZsb2F0KG8pfHwwLGk9cGFyc2VGbG9hdCh1KXx8MCksZyh0KSYmKHQ9dC5jYWxsKGUsbix3LmV4dGVuZCh7fSxzKSkpLG51bGwhPXQudG9wJiYocC50b3A9dC50b3Atcy50b3ArYSksbnVsbCE9dC5sZWZ0JiYocC5sZWZ0PXQubGVmdC1zLmxlZnQraSksInVzaW5nImluIHQ/dC51c2luZy5jYWxsKGUscCk6Zi5jc3MocCl9fSx3LmZuLmV4dGVuZCh7b2Zmc2V0OmZ1bmN0aW9uKGUpe2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHZvaWQgMD09PWU/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24odCl7dy5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsZSx0KX0pO3ZhciB0LG4scj10aGlzWzBdO2lmKHIpcmV0dXJuIHIuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGg/KHQ9ci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxuPXIub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldyx7dG9wOnQudG9wK24ucGFnZVlPZmZzZXQsbGVmdDp0LmxlZnQrbi5wYWdlWE9mZnNldH0pOnt0b3A6MCxsZWZ0OjB9fSxwb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXNbMF0pe3ZhciBlLHQsbixyPXRoaXNbMF0saT17dG9wOjAsbGVmdDowfTtpZigiZml4ZWQiPT09dy5jc3MociwicG9zaXRpb24iKSl0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7ZWxzZXt0PXRoaXMub2Zmc2V0KCksbj1yLm93bmVyRG9jdW1lbnQsZT1yLm9mZnNldFBhcmVudHx8bi5kb2N1bWVudEVsZW1lbnQ7d2hpbGUoZSYmKGU9PT1uLmJvZHl8fGU9PT1uLmRvY3VtZW50RWxlbWVudCkmJiJzdGF0aWMiPT09dy5jc3MoZSwicG9zaXRpb24iKSllPWUucGFyZW50Tm9kZTtlJiZlIT09ciYmMT09PWUubm9kZVR5cGUmJigoaT13KGUpLm9mZnNldCgpKS50b3ArPXcuY3NzKGUsImJvcmRlclRvcFdpZHRoIiwhMCksaS5sZWZ0Kz13LmNzcyhlLCJib3JkZXJMZWZ0V2lkdGgiLCEwKSl9cmV0dXJue3RvcDp0LnRvcC1pLnRvcC13LmNzcyhyLCJtYXJnaW5Ub3AiLCEwKSxsZWZ0OnQubGVmdC1pLmxlZnQtdy5jc3MociwibWFyZ2luTGVmdCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBlPXRoaXMub2Zmc2V0UGFyZW50O3doaWxlKGUmJiJzdGF0aWMiPT09dy5jc3MoZSwicG9zaXRpb24iKSllPWUub2Zmc2V0UGFyZW50O3JldHVybiBlfHxiZX0pfX0pLHcuZWFjaCh7c2Nyb2xsTGVmdDoicGFnZVhPZmZzZXQiLHNjcm9sbFRvcDoicGFnZVlPZmZzZXQifSxmdW5jdGlvbihlLHQpe3ZhciBuPSJwYWdlWU9mZnNldCI9PT10O3cuZm5bZV09ZnVuY3Rpb24ocil7cmV0dXJuIHoodGhpcyxmdW5jdGlvbihlLHIsaSl7dmFyIG87aWYoeShlKT9vPWU6OT09PWUubm9kZVR5cGUmJihvPWUuZGVmYXVsdFZpZXcpLHZvaWQgMD09PWkpcmV0dXJuIG8/b1t0XTplW3JdO28/by5zY3JvbGxUbyhuP28ucGFnZVhPZmZzZXQ6aSxuP2k6by5wYWdlWU9mZnNldCk6ZVtyXT1pfSxlLHIsYXJndW1lbnRzLmxlbmd0aCl9fSksdy5lYWNoKFsidG9wIiwibGVmdCJdLGZ1bmN0aW9uKGUsdCl7dy5jc3NIb29rc1t0XT1fZShoLnBpeGVsUG9zaXRpb24sZnVuY3Rpb24oZSxuKXtpZihuKXJldHVybiBuPUZlKGUsdCksV2UudGVzdChuKT93KGUpLnBvc2l0aW9uKClbdF0rInB4IjpufSl9KSx3LmVhY2goe0hlaWdodDoiaGVpZ2h0IixXaWR0aDoid2lkdGgifSxmdW5jdGlvbihlLHQpe3cuZWFjaCh7cGFkZGluZzoiaW5uZXIiK2UsY29udGVudDp0LCIiOiJvdXRlciIrZX0sZnVuY3Rpb24obixyKXt3LmZuW3JdPWZ1bmN0aW9uKGksbyl7dmFyIGE9YXJndW1lbnRzLmxlbmd0aCYmKG58fCJib29sZWFuIiE9dHlwZW9mIGkpLHM9bnx8KCEwPT09aXx8ITA9PT1vPyJtYXJnaW4iOiJib3JkZXIiKTtyZXR1cm4geih0aGlzLGZ1bmN0aW9uKHQsbixpKXt2YXIgbztyZXR1cm4geSh0KT8wPT09ci5pbmRleE9mKCJvdXRlciIpP3RbImlubmVyIitlXTp0LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IitlXTo5PT09dC5ub2RlVHlwZT8obz10LmRvY3VtZW50RWxlbWVudCxNYXRoLm1heCh0LmJvZHlbInNjcm9sbCIrZV0sb1sic2Nyb2xsIitlXSx0LmJvZHlbIm9mZnNldCIrZV0sb1sib2Zmc2V0IitlXSxvWyJjbGllbnQiK2VdKSk6dm9pZCAwPT09aT93LmNzcyh0LG4scyk6dy5zdHlsZSh0LG4saSxzKX0sdCxhP2k6dm9pZCAwLGEpfX0pfSksdy5lYWNoKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgcmVzaXplIHNjcm9sbCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGNvbnRleHRtZW51Ii5zcGxpdCgiICIpLGZ1bmN0aW9uKGUsdCl7dy5mblt0XT1mdW5jdGlvbihlLG4pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbih0LG51bGwsZSxuKTp0aGlzLnRyaWdnZXIodCl9fSksdy5mbi5leHRlbmQoe2hvdmVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMubW91c2VlbnRlcihlKS5tb3VzZWxlYXZlKHR8fGUpfX0pLHcuZm4uZXh0ZW5kKHtiaW5kOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5vbihlLG51bGwsdCxuKX0sdW5iaW5kOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMub2ZmKGUsbnVsbCx0KX0sZGVsZWdhdGU6ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIHRoaXMub24odCxlLG4scil9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiAxPT09YXJndW1lbnRzLmxlbmd0aD90aGlzLm9mZihlLCIqKiIpOnRoaXMub2ZmKHQsZXx8IioqIixuKX19KSx3LnByb3h5PWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpO2lmKCJzdHJpbmciPT10eXBlb2YgdCYmKG49ZVt0XSx0PWUsZT1uKSxnKGUpKXJldHVybiByPW8uY2FsbChhcmd1bWVudHMsMiksaT1mdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHR8fHRoaXMsci5jb25jYXQoby5jYWxsKGFyZ3VtZW50cykpKX0saS5ndWlkPWUuZ3VpZD1lLmd1aWR8fHcuZ3VpZCsrLGl9LHcuaG9sZFJlYWR5PWZ1bmN0aW9uKGUpe2U/dy5yZWFkeVdhaXQrKzp3LnJlYWR5KCEwKX0sdy5pc0FycmF5PUFycmF5LmlzQXJyYXksdy5wYXJzZUpTT049SlNPTi5wYXJzZSx3Lm5vZGVOYW1lPU4sdy5pc0Z1bmN0aW9uPWcsdy5pc1dpbmRvdz15LHcuY2FtZWxDYXNlPUcsdy50eXBlPXgsdy5ub3c9RGF0ZS5ub3csdy5pc051bWVyaWM9ZnVuY3Rpb24oZSl7dmFyIHQ9dy50eXBlKGUpO3JldHVybigibnVtYmVyIj09PXR8fCJzdHJpbmciPT09dCkmJiFpc05hTihlLXBhcnNlRmxvYXQoZSkpfSwiZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kJiZkZWZpbmUoImpxdWVyeSIsW10sZnVuY3Rpb24oKXtyZXR1cm4gd30pO3ZhciBKdD1lLmpRdWVyeSxLdD1lLiQ7cmV0dXJuIHcubm9Db25mbGljdD1mdW5jdGlvbih0KXtyZXR1cm4gZS4kPT09dyYmKGUuJD1LdCksdCYmZS5qUXVlcnk9PT13JiYoZS5qUXVlcnk9SnQpLHd9LHR8fChlLmpRdWVyeT1lLiQ9dyksd30pOwo="},{"meta":{"name":"jquery-ui.min.js","url":"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js","ts":1609797275367,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSBVSSAtIHYxLjEyLjEgLSAyMDE2LTA5LTE0CiogaHR0cDovL2pxdWVyeXVpLmNvbQoqIEluY2x1ZGVzOiB3aWRnZXQuanMsIHBvc2l0aW9uLmpzLCBkYXRhLmpzLCBkaXNhYmxlLXNlbGVjdGlvbi5qcywgZWZmZWN0LmpzLCBlZmZlY3RzL2VmZmVjdC1ibGluZC5qcywgZWZmZWN0cy9lZmZlY3QtYm91bmNlLmpzLCBlZmZlY3RzL2VmZmVjdC1jbGlwLmpzLCBlZmZlY3RzL2VmZmVjdC1kcm9wLmpzLCBlZmZlY3RzL2VmZmVjdC1leHBsb2RlLmpzLCBlZmZlY3RzL2VmZmVjdC1mYWRlLmpzLCBlZmZlY3RzL2VmZmVjdC1mb2xkLmpzLCBlZmZlY3RzL2VmZmVjdC1oaWdobGlnaHQuanMsIGVmZmVjdHMvZWZmZWN0LXB1ZmYuanMsIGVmZmVjdHMvZWZmZWN0LXB1bHNhdGUuanMsIGVmZmVjdHMvZWZmZWN0LXNjYWxlLmpzLCBlZmZlY3RzL2VmZmVjdC1zaGFrZS5qcywgZWZmZWN0cy9lZmZlY3Qtc2l6ZS5qcywgZWZmZWN0cy9lZmZlY3Qtc2xpZGUuanMsIGVmZmVjdHMvZWZmZWN0LXRyYW5zZmVyLmpzLCBmb2N1c2FibGUuanMsIGZvcm0tcmVzZXQtbWl4aW4uanMsIGpxdWVyeS0xLTcuanMsIGtleWNvZGUuanMsIGxhYmVscy5qcywgc2Nyb2xsLXBhcmVudC5qcywgdGFiYmFibGUuanMsIHVuaXF1ZS1pZC5qcywgd2lkZ2V0cy9hY2NvcmRpb24uanMsIHdpZGdldHMvYXV0b2NvbXBsZXRlLmpzLCB3aWRnZXRzL2J1dHRvbi5qcywgd2lkZ2V0cy9jaGVja2JveHJhZGlvLmpzLCB3aWRnZXRzL2NvbnRyb2xncm91cC5qcywgd2lkZ2V0cy9kYXRlcGlja2VyLmpzLCB3aWRnZXRzL2RpYWxvZy5qcywgd2lkZ2V0cy9kcmFnZ2FibGUuanMsIHdpZGdldHMvZHJvcHBhYmxlLmpzLCB3aWRnZXRzL21lbnUuanMsIHdpZGdldHMvbW91c2UuanMsIHdpZGdldHMvcHJvZ3Jlc3NiYXIuanMsIHdpZGdldHMvcmVzaXphYmxlLmpzLCB3aWRnZXRzL3NlbGVjdGFibGUuanMsIHdpZGdldHMvc2VsZWN0bWVudS5qcywgd2lkZ2V0cy9zbGlkZXIuanMsIHdpZGdldHMvc29ydGFibGUuanMsIHdpZGdldHMvc3Bpbm5lci5qcywgd2lkZ2V0cy90YWJzLmpzLCB3aWRnZXRzL3Rvb2x0aXAuanMKKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yczsgTGljZW5zZWQgTUlUICovCgooZnVuY3Rpb24odCl7ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoWyJqcXVlcnkiXSx0KTp0KGpRdWVyeSl9KShmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQpe2Zvcih2YXIgZT10LmNzcygidmlzaWJpbGl0eSIpOyJpbmhlcml0Ij09PWU7KXQ9dC5wYXJlbnQoKSxlPXQuY3NzKCJ2aXNpYmlsaXR5Iik7cmV0dXJuImhpZGRlbiIhPT1lfWZ1bmN0aW9uIGkodCl7Zm9yKHZhciBlLGk7dC5sZW5ndGgmJnRbMF0hPT1kb2N1bWVudDspe2lmKGU9dC5jc3MoInBvc2l0aW9uIiksKCJhYnNvbHV0ZSI9PT1lfHwicmVsYXRpdmUiPT09ZXx8ImZpeGVkIj09PWUpJiYoaT1wYXJzZUludCh0LmNzcygiekluZGV4IiksMTApLCFpc05hTihpKSYmMCE9PWkpKXJldHVybiBpO3Q9dC5wYXJlbnQoKX1yZXR1cm4gMH1mdW5jdGlvbiBzKCl7dGhpcy5fY3VySW5zdD1udWxsLHRoaXMuX2tleUV2ZW50PSExLHRoaXMuX2Rpc2FibGVkSW5wdXRzPVtdLHRoaXMuX2RhdGVwaWNrZXJTaG93aW5nPSExLHRoaXMuX2luRGlhbG9nPSExLHRoaXMuX21haW5EaXZJZD0idWktZGF0ZXBpY2tlci1kaXYiLHRoaXMuX2lubGluZUNsYXNzPSJ1aS1kYXRlcGlja2VyLWlubGluZSIsdGhpcy5fYXBwZW5kQ2xhc3M9InVpLWRhdGVwaWNrZXItYXBwZW5kIix0aGlzLl90cmlnZ2VyQ2xhc3M9InVpLWRhdGVwaWNrZXItdHJpZ2dlciIsdGhpcy5fZGlhbG9nQ2xhc3M9InVpLWRhdGVwaWNrZXItZGlhbG9nIix0aGlzLl9kaXNhYmxlQ2xhc3M9InVpLWRhdGVwaWNrZXItZGlzYWJsZWQiLHRoaXMuX3Vuc2VsZWN0YWJsZUNsYXNzPSJ1aS1kYXRlcGlja2VyLXVuc2VsZWN0YWJsZSIsdGhpcy5fY3VycmVudENsYXNzPSJ1aS1kYXRlcGlja2VyLWN1cnJlbnQtZGF5Iix0aGlzLl9kYXlPdmVyQ2xhc3M9InVpLWRhdGVwaWNrZXItZGF5cy1jZWxsLW92ZXIiLHRoaXMucmVnaW9uYWw9W10sdGhpcy5yZWdpb25hbFsiIl09e2Nsb3NlVGV4dDoiRG9uZSIscHJldlRleHQ6IlByZXYiLG5leHRUZXh0OiJOZXh0IixjdXJyZW50VGV4dDoiVG9kYXkiLG1vbnRoTmFtZXM6WyJKYW51YXJ5IiwiRmVicnVhcnkiLCJNYXJjaCIsIkFwcmlsIiwiTWF5IiwiSnVuZSIsIkp1bHkiLCJBdWd1c3QiLCJTZXB0ZW1iZXIiLCJPY3RvYmVyIiwiTm92ZW1iZXIiLCJEZWNlbWJlciJdLG1vbnRoTmFtZXNTaG9ydDpbIkphbiIsIkZlYiIsIk1hciIsIkFwciIsIk1heSIsIkp1biIsIkp1bCIsIkF1ZyIsIlNlcCIsIk9jdCIsIk5vdiIsIkRlYyJdLGRheU5hbWVzOlsiU3VuZGF5IiwiTW9uZGF5IiwiVHVlc2RheSIsIldlZG5lc2RheSIsIlRodXJzZGF5IiwiRnJpZGF5IiwiU2F0dXJkYXkiXSxkYXlOYW1lc1Nob3J0OlsiU3VuIiwiTW9uIiwiVHVlIiwiV2VkIiwiVGh1IiwiRnJpIiwiU2F0Il0sZGF5TmFtZXNNaW46WyJTdSIsIk1vIiwiVHUiLCJXZSIsIlRoIiwiRnIiLCJTYSJdLHdlZWtIZWFkZXI6IldrIixkYXRlRm9ybWF0OiJtbS9kZC95eSIsZmlyc3REYXk6MCxpc1JUTDohMSxzaG93TW9udGhBZnRlclllYXI6ITEseWVhclN1ZmZpeDoiIn0sdGhpcy5fZGVmYXVsdHM9e3Nob3dPbjoiZm9jdXMiLHNob3dBbmltOiJmYWRlSW4iLHNob3dPcHRpb25zOnt9LGRlZmF1bHREYXRlOm51bGwsYXBwZW5kVGV4dDoiIixidXR0b25UZXh0OiIuLi4iLGJ1dHRvbkltYWdlOiIiLGJ1dHRvbkltYWdlT25seTohMSxoaWRlSWZOb1ByZXZOZXh0OiExLG5hdmlnYXRpb25Bc0RhdGVGb3JtYXQ6ITEsZ290b0N1cnJlbnQ6ITEsY2hhbmdlTW9udGg6ITEsY2hhbmdlWWVhcjohMSx5ZWFyUmFuZ2U6ImMtMTA6YysxMCIsc2hvd090aGVyTW9udGhzOiExLHNlbGVjdE90aGVyTW9udGhzOiExLHNob3dXZWVrOiExLGNhbGN1bGF0ZVdlZWs6dGhpcy5pc284NjAxV2VlayxzaG9ydFllYXJDdXRvZmY6IisxMCIsbWluRGF0ZTpudWxsLG1heERhdGU6bnVsbCxkdXJhdGlvbjoiZmFzdCIsYmVmb3JlU2hvd0RheTpudWxsLGJlZm9yZVNob3c6bnVsbCxvblNlbGVjdDpudWxsLG9uQ2hhbmdlTW9udGhZZWFyOm51bGwsb25DbG9zZTpudWxsLG51bWJlck9mTW9udGhzOjEsc2hvd0N1cnJlbnRBdFBvczowLHN0ZXBNb250aHM6MSxzdGVwQmlnTW9udGhzOjEyLGFsdEZpZWxkOiIiLGFsdEZvcm1hdDoiIixjb25zdHJhaW5JbnB1dDohMCxzaG93QnV0dG9uUGFuZWw6ITEsYXV0b1NpemU6ITEsZGlzYWJsZWQ6ITF9LHQuZXh0ZW5kKHRoaXMuX2RlZmF1bHRzLHRoaXMucmVnaW9uYWxbIiJdKSx0aGlzLnJlZ2lvbmFsLmVuPXQuZXh0ZW5kKCEwLHt9LHRoaXMucmVnaW9uYWxbIiJdKSx0aGlzLnJlZ2lvbmFsWyJlbi1VUyJdPXQuZXh0ZW5kKCEwLHt9LHRoaXMucmVnaW9uYWwuZW4pLHRoaXMuZHBEaXY9bih0KCI8ZGl2IGlkPSciK3RoaXMuX21haW5EaXZJZCsiJyBjbGFzcz0ndWktZGF0ZXBpY2tlciB1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQgdWktaGVscGVyLWNsZWFyZml4IHVpLWNvcm5lci1hbGwnPjwvZGl2PiIpKX1mdW5jdGlvbiBuKGUpe3ZhciBpPSJidXR0b24sIC51aS1kYXRlcGlja2VyLXByZXYsIC51aS1kYXRlcGlja2VyLW5leHQsIC51aS1kYXRlcGlja2VyLWNhbGVuZGFyIHRkIGEiO3JldHVybiBlLm9uKCJtb3VzZW91dCIsaSxmdW5jdGlvbigpe3QodGhpcykucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWhvdmVyIiksLTEhPT10aGlzLmNsYXNzTmFtZS5pbmRleE9mKCJ1aS1kYXRlcGlja2VyLXByZXYiKSYmdCh0aGlzKS5yZW1vdmVDbGFzcygidWktZGF0ZXBpY2tlci1wcmV2LWhvdmVyIiksLTEhPT10aGlzLmNsYXNzTmFtZS5pbmRleE9mKCJ1aS1kYXRlcGlja2VyLW5leHQiKSYmdCh0aGlzKS5yZW1vdmVDbGFzcygidWktZGF0ZXBpY2tlci1uZXh0LWhvdmVyIil9KS5vbigibW91c2VvdmVyIixpLG8pfWZ1bmN0aW9uIG8oKXt0LmRhdGVwaWNrZXIuX2lzRGlzYWJsZWREYXRlcGlja2VyKG0uaW5saW5lP20uZHBEaXYucGFyZW50KClbMF06bS5pbnB1dFswXSl8fCh0KHRoaXMpLnBhcmVudHMoIi51aS1kYXRlcGlja2VyLWNhbGVuZGFyIikuZmluZCgiYSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1ob3ZlciIpLHQodGhpcykuYWRkQ2xhc3MoInVpLXN0YXRlLWhvdmVyIiksLTEhPT10aGlzLmNsYXNzTmFtZS5pbmRleE9mKCJ1aS1kYXRlcGlja2VyLXByZXYiKSYmdCh0aGlzKS5hZGRDbGFzcygidWktZGF0ZXBpY2tlci1wcmV2LWhvdmVyIiksLTEhPT10aGlzLmNsYXNzTmFtZS5pbmRleE9mKCJ1aS1kYXRlcGlja2VyLW5leHQiKSYmdCh0aGlzKS5hZGRDbGFzcygidWktZGF0ZXBpY2tlci1uZXh0LWhvdmVyIikpfWZ1bmN0aW9uIGEoZSxpKXt0LmV4dGVuZChlLGkpO2Zvcih2YXIgcyBpbiBpKW51bGw9PWlbc10mJihlW3NdPWlbc10pO3JldHVybiBlfWZ1bmN0aW9uIHIodCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5lbGVtZW50LnZhbCgpO3QuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX3JlZnJlc2goKSxlIT09dGhpcy5lbGVtZW50LnZhbCgpJiZ0aGlzLl90cmlnZ2VyKCJjaGFuZ2UiKX19dC51aT10LnVpfHx7fSx0LnVpLnZlcnNpb249IjEuMTIuMSI7dmFyIGg9MCxsPUFycmF5LnByb3RvdHlwZS5zbGljZTt0LmNsZWFuRGF0YT1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oaSl7dmFyIHMsbixvO2ZvcihvPTA7bnVsbCE9KG49aVtvXSk7bysrKXRyeXtzPXQuX2RhdGEobiwiZXZlbnRzIikscyYmcy5yZW1vdmUmJnQobikudHJpZ2dlckhhbmRsZXIoInJlbW92ZSIpfWNhdGNoKGEpe31lKGkpfX0odC5jbGVhbkRhdGEpLHQud2lkZ2V0PWZ1bmN0aW9uKGUsaSxzKXt2YXIgbixvLGEscj17fSxoPWUuc3BsaXQoIi4iKVswXTtlPWUuc3BsaXQoIi4iKVsxXTt2YXIgbD1oKyItIitlO3JldHVybiBzfHwocz1pLGk9dC5XaWRnZXQpLHQuaXNBcnJheShzKSYmKHM9dC5leHRlbmQuYXBwbHkobnVsbCxbe31dLmNvbmNhdChzKSkpLHQuZXhwclsiOiJdW2wudG9Mb3dlckNhc2UoKV09ZnVuY3Rpb24oZSl7cmV0dXJuISF0LmRhdGEoZSxsKX0sdFtoXT10W2hdfHx7fSxuPXRbaF1bZV0sbz10W2hdW2VdPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX2NyZWF0ZVdpZGdldD8oYXJndW1lbnRzLmxlbmd0aCYmdGhpcy5fY3JlYXRlV2lkZ2V0KHQsZSksdm9pZCAwKTpuZXcgbyh0LGUpfSx0LmV4dGVuZChvLG4se3ZlcnNpb246cy52ZXJzaW9uLF9wcm90bzp0LmV4dGVuZCh7fSxzKSxfY2hpbGRDb25zdHJ1Y3RvcnM6W119KSxhPW5ldyBpLGEub3B0aW9ucz10LndpZGdldC5leHRlbmQoe30sYS5vcHRpb25zKSx0LmVhY2gocyxmdW5jdGlvbihlLHMpe3JldHVybiB0LmlzRnVuY3Rpb24ocyk/KHJbZV09ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KCl7cmV0dXJuIGkucHJvdG90eXBlW2VdLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBuKHQpe3JldHVybiBpLnByb3RvdHlwZVtlXS5hcHBseSh0aGlzLHQpfXJldHVybiBmdW5jdGlvbigpe3ZhciBlLGk9dGhpcy5fc3VwZXIsbz10aGlzLl9zdXBlckFwcGx5O3JldHVybiB0aGlzLl9zdXBlcj10LHRoaXMuX3N1cGVyQXBwbHk9bixlPXMuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX3N1cGVyPWksdGhpcy5fc3VwZXJBcHBseT1vLGV9fSgpLHZvaWQgMCk6KHJbZV09cyx2b2lkIDApfSksby5wcm90b3R5cGU9dC53aWRnZXQuZXh0ZW5kKGEse3dpZGdldEV2ZW50UHJlZml4Om4/YS53aWRnZXRFdmVudFByZWZpeHx8ZTplfSxyLHtjb25zdHJ1Y3RvcjpvLG5hbWVzcGFjZTpoLHdpZGdldE5hbWU6ZSx3aWRnZXRGdWxsTmFtZTpsfSksbj8odC5lYWNoKG4uX2NoaWxkQ29uc3RydWN0b3JzLGZ1bmN0aW9uKGUsaSl7dmFyIHM9aS5wcm90b3R5cGU7dC53aWRnZXQocy5uYW1lc3BhY2UrIi4iK3Mud2lkZ2V0TmFtZSxvLGkuX3Byb3RvKX0pLGRlbGV0ZSBuLl9jaGlsZENvbnN0cnVjdG9ycyk6aS5fY2hpbGRDb25zdHJ1Y3RvcnMucHVzaChvKSx0LndpZGdldC5icmlkZ2UoZSxvKSxvfSx0LndpZGdldC5leHRlbmQ9ZnVuY3Rpb24oZSl7Zm9yKHZhciBpLHMsbj1sLmNhbGwoYXJndW1lbnRzLDEpLG89MCxhPW4ubGVuZ3RoO2E+bztvKyspZm9yKGkgaW4gbltvXSlzPW5bb11baV0sbltvXS5oYXNPd25Qcm9wZXJ0eShpKSYmdm9pZCAwIT09cyYmKGVbaV09dC5pc1BsYWluT2JqZWN0KHMpP3QuaXNQbGFpbk9iamVjdChlW2ldKT90LndpZGdldC5leHRlbmQoe30sZVtpXSxzKTp0LndpZGdldC5leHRlbmQoe30scyk6cyk7cmV0dXJuIGV9LHQud2lkZ2V0LmJyaWRnZT1mdW5jdGlvbihlLGkpe3ZhciBzPWkucHJvdG90eXBlLndpZGdldEZ1bGxOYW1lfHxlO3QuZm5bZV09ZnVuY3Rpb24obil7dmFyIG89InN0cmluZyI9PXR5cGVvZiBuLGE9bC5jYWxsKGFyZ3VtZW50cywxKSxyPXRoaXM7cmV0dXJuIG8/dGhpcy5sZW5ndGh8fCJpbnN0YW5jZSIhPT1uP3RoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBpLG89dC5kYXRhKHRoaXMscyk7cmV0dXJuImluc3RhbmNlIj09PW4/KHI9bywhMSk6bz90LmlzRnVuY3Rpb24ob1tuXSkmJiJfIiE9PW4uY2hhckF0KDApPyhpPW9bbl0uYXBwbHkobyxhKSxpIT09byYmdm9pZCAwIT09aT8ocj1pJiZpLmpxdWVyeT9yLnB1c2hTdGFjayhpLmdldCgpKTppLCExKTp2b2lkIDApOnQuZXJyb3IoIm5vIHN1Y2ggbWV0aG9kICciK24rIicgZm9yICIrZSsiIHdpZGdldCBpbnN0YW5jZSIpOnQuZXJyb3IoImNhbm5vdCBjYWxsIG1ldGhvZHMgb24gIitlKyIgcHJpb3IgdG8gaW5pdGlhbGl6YXRpb247ICIrImF0dGVtcHRlZCB0byBjYWxsIG1ldGhvZCAnIituKyInIil9KTpyPXZvaWQgMDooYS5sZW5ndGgmJihuPXQud2lkZ2V0LmV4dGVuZC5hcHBseShudWxsLFtuXS5jb25jYXQoYSkpKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10LmRhdGEodGhpcyxzKTtlPyhlLm9wdGlvbihufHx7fSksZS5faW5pdCYmZS5faW5pdCgpKTp0LmRhdGEodGhpcyxzLG5ldyBpKG4sdGhpcykpfSkpLHJ9fSx0LldpZGdldD1mdW5jdGlvbigpe30sdC5XaWRnZXQuX2NoaWxkQ29uc3RydWN0b3JzPVtdLHQuV2lkZ2V0LnByb3RvdHlwZT17d2lkZ2V0TmFtZToid2lkZ2V0Iix3aWRnZXRFdmVudFByZWZpeDoiIixkZWZhdWx0RWxlbWVudDoiPGRpdj4iLG9wdGlvbnM6e2NsYXNzZXM6e30sZGlzYWJsZWQ6ITEsY3JlYXRlOm51bGx9LF9jcmVhdGVXaWRnZXQ6ZnVuY3Rpb24oZSxpKXtpPXQoaXx8dGhpcy5kZWZhdWx0RWxlbWVudHx8dGhpcylbMF0sdGhpcy5lbGVtZW50PXQoaSksdGhpcy51dWlkPWgrKyx0aGlzLmV2ZW50TmFtZXNwYWNlPSIuIit0aGlzLndpZGdldE5hbWUrdGhpcy51dWlkLHRoaXMuYmluZGluZ3M9dCgpLHRoaXMuaG92ZXJhYmxlPXQoKSx0aGlzLmZvY3VzYWJsZT10KCksdGhpcy5jbGFzc2VzRWxlbWVudExvb2t1cD17fSxpIT09dGhpcyYmKHQuZGF0YShpLHRoaXMud2lkZ2V0RnVsbE5hbWUsdGhpcyksdGhpcy5fb24oITAsdGhpcy5lbGVtZW50LHtyZW1vdmU6ZnVuY3Rpb24odCl7dC50YXJnZXQ9PT1pJiZ0aGlzLmRlc3Ryb3koKX19KSx0aGlzLmRvY3VtZW50PXQoaS5zdHlsZT9pLm93bmVyRG9jdW1lbnQ6aS5kb2N1bWVudHx8aSksdGhpcy53aW5kb3c9dCh0aGlzLmRvY3VtZW50WzBdLmRlZmF1bHRWaWV3fHx0aGlzLmRvY3VtZW50WzBdLnBhcmVudFdpbmRvdykpLHRoaXMub3B0aW9ucz10LndpZGdldC5leHRlbmQoe30sdGhpcy5vcHRpb25zLHRoaXMuX2dldENyZWF0ZU9wdGlvbnMoKSxlKSx0aGlzLl9jcmVhdGUoKSx0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJnRoaXMuX3NldE9wdGlvbkRpc2FibGVkKHRoaXMub3B0aW9ucy5kaXNhYmxlZCksdGhpcy5fdHJpZ2dlcigiY3JlYXRlIixudWxsLHRoaXMuX2dldENyZWF0ZUV2ZW50RGF0YSgpKSx0aGlzLl9pbml0KCl9LF9nZXRDcmVhdGVPcHRpb25zOmZ1bmN0aW9uKCl7cmV0dXJue319LF9nZXRDcmVhdGVFdmVudERhdGE6dC5ub29wLF9jcmVhdGU6dC5ub29wLF9pbml0OnQubm9vcCxkZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLl9kZXN0cm95KCksdC5lYWNoKHRoaXMuY2xhc3Nlc0VsZW1lbnRMb29rdXAsZnVuY3Rpb24odCxpKXtlLl9yZW1vdmVDbGFzcyhpLHQpfSksdGhpcy5lbGVtZW50Lm9mZih0aGlzLmV2ZW50TmFtZXNwYWNlKS5yZW1vdmVEYXRhKHRoaXMud2lkZ2V0RnVsbE5hbWUpLHRoaXMud2lkZ2V0KCkub2ZmKHRoaXMuZXZlbnROYW1lc3BhY2UpLnJlbW92ZUF0dHIoImFyaWEtZGlzYWJsZWQiKSx0aGlzLmJpbmRpbmdzLm9mZih0aGlzLmV2ZW50TmFtZXNwYWNlKX0sX2Rlc3Ryb3k6dC5ub29wLHdpZGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVsZW1lbnR9LG9wdGlvbjpmdW5jdGlvbihlLGkpe3ZhciBzLG4sbyxhPWU7aWYoMD09PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHQud2lkZ2V0LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMpO2lmKCJzdHJpbmciPT10eXBlb2YgZSlpZihhPXt9LHM9ZS5zcGxpdCgiLiIpLGU9cy5zaGlmdCgpLHMubGVuZ3RoKXtmb3Iobj1hW2VdPXQud2lkZ2V0LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnNbZV0pLG89MDtzLmxlbmd0aC0xPm87bysrKW5bc1tvXV09bltzW29dXXx8e30sbj1uW3Nbb11dO2lmKGU9cy5wb3AoKSwxPT09YXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdm9pZCAwPT09bltlXT9udWxsOm5bZV07bltlXT1pfWVsc2V7aWYoMT09PWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHZvaWQgMD09PXRoaXMub3B0aW9uc1tlXT9udWxsOnRoaXMub3B0aW9uc1tlXTthW2VdPWl9cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoYSksdGhpc30sX3NldE9wdGlvbnM6ZnVuY3Rpb24odCl7dmFyIGU7Zm9yKGUgaW4gdCl0aGlzLl9zZXRPcHRpb24oZSx0W2VdKTtyZXR1cm4gdGhpc30sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3JldHVybiJjbGFzc2VzIj09PXQmJnRoaXMuX3NldE9wdGlvbkNsYXNzZXMoZSksdGhpcy5vcHRpb25zW3RdPWUsImRpc2FibGVkIj09PXQmJnRoaXMuX3NldE9wdGlvbkRpc2FibGVkKGUpLHRoaXN9LF9zZXRPcHRpb25DbGFzc2VzOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbjtmb3IoaSBpbiBlKW49dGhpcy5jbGFzc2VzRWxlbWVudExvb2t1cFtpXSxlW2ldIT09dGhpcy5vcHRpb25zLmNsYXNzZXNbaV0mJm4mJm4ubGVuZ3RoJiYocz10KG4uZ2V0KCkpLHRoaXMuX3JlbW92ZUNsYXNzKG4saSkscy5hZGRDbGFzcyh0aGlzLl9jbGFzc2VzKHtlbGVtZW50OnMsa2V5czppLGNsYXNzZXM6ZSxhZGQ6ITB9KSkpfSxfc2V0T3B0aW9uRGlzYWJsZWQ6ZnVuY3Rpb24odCl7dGhpcy5fdG9nZ2xlQ2xhc3ModGhpcy53aWRnZXQoKSx0aGlzLndpZGdldEZ1bGxOYW1lKyItZGlzYWJsZWQiLG51bGwsISF0KSx0JiYodGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5ob3ZlcmFibGUsbnVsbCwidWktc3RhdGUtaG92ZXIiKSx0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLmZvY3VzYWJsZSxudWxsLCJ1aS1zdGF0ZS1mb2N1cyIpKX0sZW5hYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NldE9wdGlvbnMoe2Rpc2FibGVkOiExfSl9LGRpc2FibGU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2V0T3B0aW9ucyh7ZGlzYWJsZWQ6ITB9KX0sX2NsYXNzZXM6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaShpLG8pe3ZhciBhLHI7Zm9yKHI9MDtpLmxlbmd0aD5yO3IrKylhPW4uY2xhc3Nlc0VsZW1lbnRMb29rdXBbaVtyXV18fHQoKSxhPWUuYWRkP3QodC51bmlxdWUoYS5nZXQoKS5jb25jYXQoZS5lbGVtZW50LmdldCgpKSkpOnQoYS5ub3QoZS5lbGVtZW50KS5nZXQoKSksbi5jbGFzc2VzRWxlbWVudExvb2t1cFtpW3JdXT1hLHMucHVzaChpW3JdKSxvJiZlLmNsYXNzZXNbaVtyXV0mJnMucHVzaChlLmNsYXNzZXNbaVtyXV0pfXZhciBzPVtdLG49dGhpcztyZXR1cm4gZT10LmV4dGVuZCh7ZWxlbWVudDp0aGlzLmVsZW1lbnQsY2xhc3Nlczp0aGlzLm9wdGlvbnMuY2xhc3Nlc3x8e319LGUpLHRoaXMuX29uKGUuZWxlbWVudCx7cmVtb3ZlOiJfdW50cmFja0NsYXNzZXNFbGVtZW50In0pLGUua2V5cyYmaShlLmtleXMubWF0Y2goL1xTKy9nKXx8W10sITApLGUuZXh0cmEmJmkoZS5leHRyYS5tYXRjaCgvXFMrL2cpfHxbXSkscy5qb2luKCIgIil9LF91bnRyYWNrQ2xhc3Nlc0VsZW1lbnQ6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpczt0LmVhY2goaS5jbGFzc2VzRWxlbWVudExvb2t1cCxmdW5jdGlvbihzLG4pey0xIT09dC5pbkFycmF5KGUudGFyZ2V0LG4pJiYoaS5jbGFzc2VzRWxlbWVudExvb2t1cFtzXT10KG4ubm90KGUudGFyZ2V0KS5nZXQoKSkpfSl9LF9yZW1vdmVDbGFzczpmdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX3RvZ2dsZUNsYXNzKHQsZSxpLCExKX0sX2FkZENsYXNzOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdGhpcy5fdG9nZ2xlQ2xhc3ModCxlLGksITApfSxfdG9nZ2xlQ2xhc3M6ZnVuY3Rpb24odCxlLGkscyl7cz0iYm9vbGVhbiI9PXR5cGVvZiBzP3M6aTt2YXIgbj0ic3RyaW5nIj09dHlwZW9mIHR8fG51bGw9PT10LG89e2V4dHJhOm4/ZTppLGtleXM6bj90OmUsZWxlbWVudDpuP3RoaXMuZWxlbWVudDp0LGFkZDpzfTtyZXR1cm4gby5lbGVtZW50LnRvZ2dsZUNsYXNzKHRoaXMuX2NsYXNzZXMobykscyksdGhpc30sX29uOmZ1bmN0aW9uKGUsaSxzKXt2YXIgbixvPXRoaXM7ImJvb2xlYW4iIT10eXBlb2YgZSYmKHM9aSxpPWUsZT0hMSkscz8oaT1uPXQoaSksdGhpcy5iaW5kaW5ncz10aGlzLmJpbmRpbmdzLmFkZChpKSk6KHM9aSxpPXRoaXMuZWxlbWVudCxuPXRoaXMud2lkZ2V0KCkpLHQuZWFjaChzLGZ1bmN0aW9uKHMsYSl7ZnVuY3Rpb24gcigpe3JldHVybiBlfHxvLm9wdGlvbnMuZGlzYWJsZWQhPT0hMCYmIXQodGhpcykuaGFzQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIik/KCJzdHJpbmciPT10eXBlb2YgYT9vW2FdOmEpLmFwcGx5KG8sYXJndW1lbnRzKTp2b2lkIDB9InN0cmluZyIhPXR5cGVvZiBhJiYoci5ndWlkPWEuZ3VpZD1hLmd1aWR8fHIuZ3VpZHx8dC5ndWlkKyspO3ZhciBoPXMubWF0Y2goL14oW1x3Oi1dKilccyooLiopJC8pLGw9aFsxXStvLmV2ZW50TmFtZXNwYWNlLGM9aFsyXTtjP24ub24obCxjLHIpOmkub24obCxyKX0pfSxfb2ZmOmZ1bmN0aW9uKGUsaSl7aT0oaXx8IiIpLnNwbGl0KCIgIikuam9pbih0aGlzLmV2ZW50TmFtZXNwYWNlKyIgIikrdGhpcy5ldmVudE5hbWVzcGFjZSxlLm9mZihpKS5vZmYoaSksdGhpcy5iaW5kaW5ncz10KHRoaXMuYmluZGluZ3Mubm90KGUpLmdldCgpKSx0aGlzLmZvY3VzYWJsZT10KHRoaXMuZm9jdXNhYmxlLm5vdChlKS5nZXQoKSksdGhpcy5ob3ZlcmFibGU9dCh0aGlzLmhvdmVyYWJsZS5ub3QoZSkuZ2V0KCkpfSxfZGVsYXk6ZnVuY3Rpb24odCxlKXtmdW5jdGlvbiBpKCl7cmV0dXJuKCJzdHJpbmciPT10eXBlb2YgdD9zW3RdOnQpLmFwcGx5KHMsYXJndW1lbnRzKX12YXIgcz10aGlzO3JldHVybiBzZXRUaW1lb3V0KGksZXx8MCl9LF9ob3ZlcmFibGU6ZnVuY3Rpb24oZSl7dGhpcy5ob3ZlcmFibGU9dGhpcy5ob3ZlcmFibGUuYWRkKGUpLHRoaXMuX29uKGUse21vdXNlZW50ZXI6ZnVuY3Rpb24oZSl7dGhpcy5fYWRkQ2xhc3ModChlLmN1cnJlbnRUYXJnZXQpLG51bGwsInVpLXN0YXRlLWhvdmVyIil9LG1vdXNlbGVhdmU6ZnVuY3Rpb24oZSl7dGhpcy5fcmVtb3ZlQ2xhc3ModChlLmN1cnJlbnRUYXJnZXQpLG51bGwsInVpLXN0YXRlLWhvdmVyIil9fSl9LF9mb2N1c2FibGU6ZnVuY3Rpb24oZSl7dGhpcy5mb2N1c2FibGU9dGhpcy5mb2N1c2FibGUuYWRkKGUpLHRoaXMuX29uKGUse2ZvY3VzaW46ZnVuY3Rpb24oZSl7dGhpcy5fYWRkQ2xhc3ModChlLmN1cnJlbnRUYXJnZXQpLG51bGwsInVpLXN0YXRlLWZvY3VzIil9LGZvY3Vzb3V0OmZ1bmN0aW9uKGUpe3RoaXMuX3JlbW92ZUNsYXNzKHQoZS5jdXJyZW50VGFyZ2V0KSxudWxsLCJ1aS1zdGF0ZS1mb2N1cyIpfX0pfSxfdHJpZ2dlcjpmdW5jdGlvbihlLGkscyl7dmFyIG4sbyxhPXRoaXMub3B0aW9uc1tlXTtpZihzPXN8fHt9LGk9dC5FdmVudChpKSxpLnR5cGU9KGU9PT10aGlzLndpZGdldEV2ZW50UHJlZml4P2U6dGhpcy53aWRnZXRFdmVudFByZWZpeCtlKS50b0xvd2VyQ2FzZSgpLGkudGFyZ2V0PXRoaXMuZWxlbWVudFswXSxvPWkub3JpZ2luYWxFdmVudClmb3IobiBpbiBvKW4gaW4gaXx8KGlbbl09b1tuXSk7cmV0dXJuIHRoaXMuZWxlbWVudC50cmlnZ2VyKGkscyksISh0LmlzRnVuY3Rpb24oYSkmJmEuYXBwbHkodGhpcy5lbGVtZW50WzBdLFtpXS5jb25jYXQocykpPT09ITF8fGkuaXNEZWZhdWx0UHJldmVudGVkKCkpfX0sdC5lYWNoKHtzaG93OiJmYWRlSW4iLGhpZGU6ImZhZGVPdXQifSxmdW5jdGlvbihlLGkpe3QuV2lkZ2V0LnByb3RvdHlwZVsiXyIrZV09ZnVuY3Rpb24ocyxuLG8peyJzdHJpbmciPT10eXBlb2YgbiYmKG49e2VmZmVjdDpufSk7dmFyIGEscj1uP249PT0hMHx8Im51bWJlciI9PXR5cGVvZiBuP2k6bi5lZmZlY3R8fGk6ZTtuPW58fHt9LCJudW1iZXIiPT10eXBlb2YgbiYmKG49e2R1cmF0aW9uOm59KSxhPSF0LmlzRW1wdHlPYmplY3Qobiksbi5jb21wbGV0ZT1vLG4uZGVsYXkmJnMuZGVsYXkobi5kZWxheSksYSYmdC5lZmZlY3RzJiZ0LmVmZmVjdHMuZWZmZWN0W3JdP3NbZV0obik6ciE9PWUmJnNbcl0/c1tyXShuLmR1cmF0aW9uLG4uZWFzaW5nLG8pOnMucXVldWUoZnVuY3Rpb24oaSl7dCh0aGlzKVtlXSgpLG8mJm8uY2FsbChzWzBdKSxpKCl9KX19KSx0LndpZGdldCxmdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxlLGkpe3JldHVybltwYXJzZUZsb2F0KHRbMF0pKih1LnRlc3QodFswXSk/ZS8xMDA6MSkscGFyc2VGbG9hdCh0WzFdKSoodS50ZXN0KHRbMV0pP2kvMTAwOjEpXX1mdW5jdGlvbiBpKGUsaSl7cmV0dXJuIHBhcnNlSW50KHQuY3NzKGUsaSksMTApfHwwfWZ1bmN0aW9uIHMoZSl7dmFyIGk9ZVswXTtyZXR1cm4gOT09PWkubm9kZVR5cGU/e3dpZHRoOmUud2lkdGgoKSxoZWlnaHQ6ZS5oZWlnaHQoKSxvZmZzZXQ6e3RvcDowLGxlZnQ6MH19OnQuaXNXaW5kb3coaSk/e3dpZHRoOmUud2lkdGgoKSxoZWlnaHQ6ZS5oZWlnaHQoKSxvZmZzZXQ6e3RvcDplLnNjcm9sbFRvcCgpLGxlZnQ6ZS5zY3JvbGxMZWZ0KCl9fTppLnByZXZlbnREZWZhdWx0P3t3aWR0aDowLGhlaWdodDowLG9mZnNldDp7dG9wOmkucGFnZVksbGVmdDppLnBhZ2VYfX06e3dpZHRoOmUub3V0ZXJXaWR0aCgpLGhlaWdodDplLm91dGVySGVpZ2h0KCksb2Zmc2V0OmUub2Zmc2V0KCl9fXZhciBuLG89TWF0aC5tYXgsYT1NYXRoLmFicyxyPS9sZWZ0fGNlbnRlcnxyaWdodC8saD0vdG9wfGNlbnRlcnxib3R0b20vLGw9L1tcK1wtXVxkKyhcLltcZF0rKT8lPy8sYz0vXlx3Ky8sdT0vJSQvLGQ9dC5mbi5wb3NpdGlvbjt0LnBvc2l0aW9uPXtzY3JvbGxiYXJXaWR0aDpmdW5jdGlvbigpe2lmKHZvaWQgMCE9PW4pcmV0dXJuIG47dmFyIGUsaSxzPXQoIjxkaXYgc3R5bGU9J2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6NTBweDtoZWlnaHQ6NTBweDtvdmVyZmxvdzpoaWRkZW47Jz48ZGl2IHN0eWxlPSdoZWlnaHQ6MTAwcHg7d2lkdGg6YXV0bzsnPjwvZGl2PjwvZGl2PiIpLG89cy5jaGlsZHJlbigpWzBdO3JldHVybiB0KCJib2R5IikuYXBwZW5kKHMpLGU9by5vZmZzZXRXaWR0aCxzLmNzcygib3ZlcmZsb3ciLCJzY3JvbGwiKSxpPW8ub2Zmc2V0V2lkdGgsZT09PWkmJihpPXNbMF0uY2xpZW50V2lkdGgpLHMucmVtb3ZlKCksbj1lLWl9LGdldFNjcm9sbEluZm86ZnVuY3Rpb24oZSl7dmFyIGk9ZS5pc1dpbmRvd3x8ZS5pc0RvY3VtZW50PyIiOmUuZWxlbWVudC5jc3MoIm92ZXJmbG93LXgiKSxzPWUuaXNXaW5kb3d8fGUuaXNEb2N1bWVudD8iIjplLmVsZW1lbnQuY3NzKCJvdmVyZmxvdy15Iiksbj0ic2Nyb2xsIj09PWl8fCJhdXRvIj09PWkmJmUud2lkdGg8ZS5lbGVtZW50WzBdLnNjcm9sbFdpZHRoLG89InNjcm9sbCI9PT1zfHwiYXV0byI9PT1zJiZlLmhlaWdodDxlLmVsZW1lbnRbMF0uc2Nyb2xsSGVpZ2h0O3JldHVybnt3aWR0aDpvP3QucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKTowLGhlaWdodDpuP3QucG9zaXRpb24uc2Nyb2xsYmFyV2lkdGgoKTowfX0sZ2V0V2l0aGluSW5mbzpmdW5jdGlvbihlKXt2YXIgaT10KGV8fHdpbmRvdykscz10LmlzV2luZG93KGlbMF0pLG49ISFpWzBdJiY5PT09aVswXS5ub2RlVHlwZSxvPSFzJiYhbjtyZXR1cm57ZWxlbWVudDppLGlzV2luZG93OnMsaXNEb2N1bWVudDpuLG9mZnNldDpvP3QoZSkub2Zmc2V0KCk6e2xlZnQ6MCx0b3A6MH0sc2Nyb2xsTGVmdDppLnNjcm9sbExlZnQoKSxzY3JvbGxUb3A6aS5zY3JvbGxUb3AoKSx3aWR0aDppLm91dGVyV2lkdGgoKSxoZWlnaHQ6aS5vdXRlckhlaWdodCgpfX19LHQuZm4ucG9zaXRpb249ZnVuY3Rpb24obil7aWYoIW58fCFuLm9mKXJldHVybiBkLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtuPXQuZXh0ZW5kKHt9LG4pO3ZhciB1LHAsZixnLG0sXyx2PXQobi5vZiksYj10LnBvc2l0aW9uLmdldFdpdGhpbkluZm8obi53aXRoaW4pLHk9dC5wb3NpdGlvbi5nZXRTY3JvbGxJbmZvKGIpLHc9KG4uY29sbGlzaW9ufHwiZmxpcCIpLnNwbGl0KCIgIiksaz17fTtyZXR1cm4gXz1zKHYpLHZbMF0ucHJldmVudERlZmF1bHQmJihuLmF0PSJsZWZ0IHRvcCIpLHA9Xy53aWR0aCxmPV8uaGVpZ2h0LGc9Xy5vZmZzZXQsbT10LmV4dGVuZCh7fSxnKSx0LmVhY2goWyJteSIsImF0Il0sZnVuY3Rpb24oKXt2YXIgdCxlLGk9KG5bdGhpc118fCIiKS5zcGxpdCgiICIpOzE9PT1pLmxlbmd0aCYmKGk9ci50ZXN0KGlbMF0pP2kuY29uY2F0KFsiY2VudGVyIl0pOmgudGVzdChpWzBdKT9bImNlbnRlciJdLmNvbmNhdChpKTpbImNlbnRlciIsImNlbnRlciJdKSxpWzBdPXIudGVzdChpWzBdKT9pWzBdOiJjZW50ZXIiLGlbMV09aC50ZXN0KGlbMV0pP2lbMV06ImNlbnRlciIsdD1sLmV4ZWMoaVswXSksZT1sLmV4ZWMoaVsxXSksa1t0aGlzXT1bdD90WzBdOjAsZT9lWzBdOjBdLG5bdGhpc109W2MuZXhlYyhpWzBdKVswXSxjLmV4ZWMoaVsxXSlbMF1dfSksMT09PXcubGVuZ3RoJiYod1sxXT13WzBdKSwicmlnaHQiPT09bi5hdFswXT9tLmxlZnQrPXA6ImNlbnRlciI9PT1uLmF0WzBdJiYobS5sZWZ0Kz1wLzIpLCJib3R0b20iPT09bi5hdFsxXT9tLnRvcCs9ZjoiY2VudGVyIj09PW4uYXRbMV0mJihtLnRvcCs9Zi8yKSx1PWUoay5hdCxwLGYpLG0ubGVmdCs9dVswXSxtLnRvcCs9dVsxXSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgcyxyLGg9dCh0aGlzKSxsPWgub3V0ZXJXaWR0aCgpLGM9aC5vdXRlckhlaWdodCgpLGQ9aSh0aGlzLCJtYXJnaW5MZWZ0IiksXz1pKHRoaXMsIm1hcmdpblRvcCIpLHg9bCtkK2kodGhpcywibWFyZ2luUmlnaHQiKSt5LndpZHRoLEM9YytfK2kodGhpcywibWFyZ2luQm90dG9tIikreS5oZWlnaHQsRD10LmV4dGVuZCh7fSxtKSxJPWUoay5teSxoLm91dGVyV2lkdGgoKSxoLm91dGVySGVpZ2h0KCkpOyJyaWdodCI9PT1uLm15WzBdP0QubGVmdC09bDoiY2VudGVyIj09PW4ubXlbMF0mJihELmxlZnQtPWwvMiksImJvdHRvbSI9PT1uLm15WzFdP0QudG9wLT1jOiJjZW50ZXIiPT09bi5teVsxXSYmKEQudG9wLT1jLzIpLEQubGVmdCs9SVswXSxELnRvcCs9SVsxXSxzPXttYXJnaW5MZWZ0OmQsbWFyZ2luVG9wOl99LHQuZWFjaChbImxlZnQiLCJ0b3AiXSxmdW5jdGlvbihlLGkpe3QudWkucG9zaXRpb25bd1tlXV0mJnQudWkucG9zaXRpb25bd1tlXV1baV0oRCx7dGFyZ2V0V2lkdGg6cCx0YXJnZXRIZWlnaHQ6ZixlbGVtV2lkdGg6bCxlbGVtSGVpZ2h0OmMsY29sbGlzaW9uUG9zaXRpb246cyxjb2xsaXNpb25XaWR0aDp4LGNvbGxpc2lvbkhlaWdodDpDLG9mZnNldDpbdVswXStJWzBdLHVbMV0rSVsxXV0sbXk6bi5teSxhdDpuLmF0LHdpdGhpbjpiLGVsZW06aH0pfSksbi51c2luZyYmKHI9ZnVuY3Rpb24odCl7dmFyIGU9Zy5sZWZ0LUQubGVmdCxpPWUrcC1sLHM9Zy50b3AtRC50b3Ascj1zK2YtYyx1PXt0YXJnZXQ6e2VsZW1lbnQ6dixsZWZ0OmcubGVmdCx0b3A6Zy50b3Asd2lkdGg6cCxoZWlnaHQ6Zn0sZWxlbWVudDp7ZWxlbWVudDpoLGxlZnQ6RC5sZWZ0LHRvcDpELnRvcCx3aWR0aDpsLGhlaWdodDpjfSxob3Jpem9udGFsOjA+aT8ibGVmdCI6ZT4wPyJyaWdodCI6ImNlbnRlciIsdmVydGljYWw6MD5yPyJ0b3AiOnM+MD8iYm90dG9tIjoibWlkZGxlIn07bD5wJiZwPmEoZStpKSYmKHUuaG9yaXpvbnRhbD0iY2VudGVyIiksYz5mJiZmPmEocytyKSYmKHUudmVydGljYWw9Im1pZGRsZSIpLHUuaW1wb3J0YW50PW8oYShlKSxhKGkpKT5vKGEocyksYShyKSk/Imhvcml6b250YWwiOiJ2ZXJ0aWNhbCIsbi51c2luZy5jYWxsKHRoaXMsdCx1KX0pLGgub2Zmc2V0KHQuZXh0ZW5kKEQse3VzaW5nOnJ9KSl9KX0sdC51aS5wb3NpdGlvbj17Zml0OntsZWZ0OmZ1bmN0aW9uKHQsZSl7dmFyIGkscz1lLndpdGhpbixuPXMuaXNXaW5kb3c/cy5zY3JvbGxMZWZ0OnMub2Zmc2V0LmxlZnQsYT1zLndpZHRoLHI9dC5sZWZ0LWUuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCxoPW4tcixsPXIrZS5jb2xsaXNpb25XaWR0aC1hLW47ZS5jb2xsaXNpb25XaWR0aD5hP2g+MCYmMD49bD8oaT10LmxlZnQraCtlLmNvbGxpc2lvbldpZHRoLWEtbix0LmxlZnQrPWgtaSk6dC5sZWZ0PWw+MCYmMD49aD9uOmg+bD9uK2EtZS5jb2xsaXNpb25XaWR0aDpuOmg+MD90LmxlZnQrPWg6bD4wP3QubGVmdC09bDp0LmxlZnQ9byh0LmxlZnQtcix0LmxlZnQpfSx0b3A6ZnVuY3Rpb24odCxlKXt2YXIgaSxzPWUud2l0aGluLG49cy5pc1dpbmRvdz9zLnNjcm9sbFRvcDpzLm9mZnNldC50b3AsYT1lLndpdGhpbi5oZWlnaHQscj10LnRvcC1lLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCxoPW4tcixsPXIrZS5jb2xsaXNpb25IZWlnaHQtYS1uO2UuY29sbGlzaW9uSGVpZ2h0PmE/aD4wJiYwPj1sPyhpPXQudG9wK2grZS5jb2xsaXNpb25IZWlnaHQtYS1uLHQudG9wKz1oLWkpOnQudG9wPWw+MCYmMD49aD9uOmg+bD9uK2EtZS5jb2xsaXNpb25IZWlnaHQ6bjpoPjA/dC50b3ArPWg6bD4wP3QudG9wLT1sOnQudG9wPW8odC50b3Atcix0LnRvcCl9fSxmbGlwOntsZWZ0OmZ1bmN0aW9uKHQsZSl7dmFyIGkscyxuPWUud2l0aGluLG89bi5vZmZzZXQubGVmdCtuLnNjcm9sbExlZnQscj1uLndpZHRoLGg9bi5pc1dpbmRvdz9uLnNjcm9sbExlZnQ6bi5vZmZzZXQubGVmdCxsPXQubGVmdC1lLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpbkxlZnQsYz1sLWgsdT1sK2UuY29sbGlzaW9uV2lkdGgtci1oLGQ9ImxlZnQiPT09ZS5teVswXT8tZS5lbGVtV2lkdGg6InJpZ2h0Ij09PWUubXlbMF0/ZS5lbGVtV2lkdGg6MCxwPSJsZWZ0Ij09PWUuYXRbMF0/ZS50YXJnZXRXaWR0aDoicmlnaHQiPT09ZS5hdFswXT8tZS50YXJnZXRXaWR0aDowLGY9LTIqZS5vZmZzZXRbMF07MD5jPyhpPXQubGVmdCtkK3ArZitlLmNvbGxpc2lvbldpZHRoLXItbywoMD5pfHxhKGMpPmkpJiYodC5sZWZ0Kz1kK3ArZikpOnU+MCYmKHM9dC5sZWZ0LWUuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luTGVmdCtkK3ArZi1oLChzPjB8fHU+YShzKSkmJih0LmxlZnQrPWQrcCtmKSl9LHRvcDpmdW5jdGlvbih0LGUpe3ZhciBpLHMsbj1lLndpdGhpbixvPW4ub2Zmc2V0LnRvcCtuLnNjcm9sbFRvcCxyPW4uaGVpZ2h0LGg9bi5pc1dpbmRvdz9uLnNjcm9sbFRvcDpuLm9mZnNldC50b3AsbD10LnRvcC1lLmNvbGxpc2lvblBvc2l0aW9uLm1hcmdpblRvcCxjPWwtaCx1PWwrZS5jb2xsaXNpb25IZWlnaHQtci1oLGQ9InRvcCI9PT1lLm15WzFdLHA9ZD8tZS5lbGVtSGVpZ2h0OiJib3R0b20iPT09ZS5teVsxXT9lLmVsZW1IZWlnaHQ6MCxmPSJ0b3AiPT09ZS5hdFsxXT9lLnRhcmdldEhlaWdodDoiYm90dG9tIj09PWUuYXRbMV0/LWUudGFyZ2V0SGVpZ2h0OjAsZz0tMiplLm9mZnNldFsxXTswPmM/KHM9dC50b3ArcCtmK2crZS5jb2xsaXNpb25IZWlnaHQtci1vLCgwPnN8fGEoYyk+cykmJih0LnRvcCs9cCtmK2cpKTp1PjAmJihpPXQudG9wLWUuY29sbGlzaW9uUG9zaXRpb24ubWFyZ2luVG9wK3ArZitnLWgsKGk+MHx8dT5hKGkpKSYmKHQudG9wKz1wK2YrZykpfX0sZmxpcGZpdDp7bGVmdDpmdW5jdGlvbigpe3QudWkucG9zaXRpb24uZmxpcC5sZWZ0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0LnVpLnBvc2l0aW9uLmZpdC5sZWZ0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdG9wOmZ1bmN0aW9uKCl7dC51aS5wb3NpdGlvbi5mbGlwLnRvcC5hcHBseSh0aGlzLGFyZ3VtZW50cyksdC51aS5wb3NpdGlvbi5maXQudG9wLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19fX0oKSx0LnVpLnBvc2l0aW9uLHQuZXh0ZW5kKHQuZXhwclsiOiJdLHtkYXRhOnQuZXhwci5jcmVhdGVQc2V1ZG8/dC5leHByLmNyZWF0ZVBzZXVkbyhmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oaSl7cmV0dXJuISF0LmRhdGEoaSxlKX19KTpmdW5jdGlvbihlLGkscyl7cmV0dXJuISF0LmRhdGEoZSxzWzNdKX19KSx0LmZuLmV4dGVuZCh7ZGlzYWJsZVNlbGVjdGlvbjpmdW5jdGlvbigpe3ZhciB0PSJvbnNlbGVjdHN0YXJ0ImluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpPyJzZWxlY3RzdGFydCI6Im1vdXNlZG93biI7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub24odCsiLnVpLWRpc2FibGVTZWxlY3Rpb24iLGZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKX0pfX0oKSxlbmFibGVTZWxlY3Rpb246ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vZmYoIi51aS1kaXNhYmxlU2VsZWN0aW9uIil9fSk7dmFyIGM9InVpLWVmZmVjdHMtIix1PSJ1aS1lZmZlY3RzLXN0eWxlIixkPSJ1aS1lZmZlY3RzLWFuaW1hdGVkIixwPXQ7dC5lZmZlY3RzPXtlZmZlY3Q6e319LGZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSh0LGUsaSl7dmFyIHM9dVtlLnR5cGVdfHx7fTtyZXR1cm4gbnVsbD09dD9pfHwhZS5kZWY/bnVsbDplLmRlZjoodD1zLmZsb29yP35+dDpwYXJzZUZsb2F0KHQpLGlzTmFOKHQpP2UuZGVmOnMubW9kPyh0K3MubW9kKSVzLm1vZDowPnQ/MDp0PnMubWF4P3MubWF4OnQpfWZ1bmN0aW9uIHMoaSl7dmFyIHM9bCgpLG49cy5fcmdiYT1bXTtyZXR1cm4gaT1pLnRvTG93ZXJDYXNlKCksZihoLGZ1bmN0aW9uKHQsbyl7dmFyIGEscj1vLnJlLmV4ZWMoaSksaD1yJiZvLnBhcnNlKHIpLGw9by5zcGFjZXx8InJnYmEiO3JldHVybiBoPyhhPXNbbF0oaCksc1tjW2xdLmNhY2hlXT1hW2NbbF0uY2FjaGVdLG49cy5fcmdiYT1hLl9yZ2JhLCExKTplfSksbi5sZW5ndGg/KCIwLDAsMCwwIj09PW4uam9pbigpJiZ0LmV4dGVuZChuLG8udHJhbnNwYXJlbnQpLHMpOm9baV19ZnVuY3Rpb24gbih0LGUsaSl7cmV0dXJuIGk9KGkrMSklMSwxPjYqaT90KzYqKGUtdCkqaToxPjIqaT9lOjI+MyppP3QrNiooZS10KSooMi8zLWkpOnR9dmFyIG8sYT0iYmFja2dyb3VuZENvbG9yIGJvcmRlckJvdHRvbUNvbG9yIGJvcmRlckxlZnRDb2xvciBib3JkZXJSaWdodENvbG9yIGJvcmRlclRvcENvbG9yIGNvbG9yIGNvbHVtblJ1bGVDb2xvciBvdXRsaW5lQ29sb3IgdGV4dERlY29yYXRpb25Db2xvciB0ZXh0RW1waGFzaXNDb2xvciIscj0vXihbXC0rXSk9XHMqKFxkK1wuP1xkKikvLGg9W3tyZTovcmdiYT9cKFxzKihcZHsxLDN9KVxzKixccyooXGR7MSwzfSlccyosXHMqKFxkezEsM30pXHMqKD86LFxzKihcZD8oPzpcLlxkKyk/KVxzKik/XCkvLHBhcnNlOmZ1bmN0aW9uKHQpe3JldHVyblt0WzFdLHRbMl0sdFszXSx0WzRdXX19LHtyZTovcmdiYT9cKFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqLFxzKihcZCsoPzpcLlxkKyk/KVwlXHMqKD86LFxzKihcZD8oPzpcLlxkKyk/KVxzKik/XCkvLHBhcnNlOmZ1bmN0aW9uKHQpe3JldHVyblsyLjU1KnRbMV0sMi41NSp0WzJdLDIuNTUqdFszXSx0WzRdXX19LHtyZTovIyhbYS1mMC05XXsyfSkoW2EtZjAtOV17Mn0pKFthLWYwLTldezJ9KS8scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuW3BhcnNlSW50KHRbMV0sMTYpLHBhcnNlSW50KHRbMl0sMTYpLHBhcnNlSW50KHRbM10sMTYpXX19LHtyZTovIyhbYS1mMC05XSkoW2EtZjAtOV0pKFthLWYwLTldKS8scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuW3BhcnNlSW50KHRbMV0rdFsxXSwxNikscGFyc2VJbnQodFsyXSt0WzJdLDE2KSxwYXJzZUludCh0WzNdK3RbM10sMTYpXX19LHtyZTovaHNsYT9cKFxzKihcZCsoPzpcLlxkKyk/KVxzKixccyooXGQrKD86XC5cZCspPylcJVxzKixccyooXGQrKD86XC5cZCspPylcJVxzKig/OixccyooXGQ/KD86XC5cZCspPylccyopP1wpLyxzcGFjZToiaHNsYSIscGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuW3RbMV0sdFsyXS8xMDAsdFszXS8xMDAsdFs0XV19fV0sbD10LkNvbG9yPWZ1bmN0aW9uKGUsaSxzLG4pe3JldHVybiBuZXcgdC5Db2xvci5mbi5wYXJzZShlLGkscyxuKX0sYz17cmdiYTp7cHJvcHM6e3JlZDp7aWR4OjAsdHlwZToiYnl0ZSJ9LGdyZWVuOntpZHg6MSx0eXBlOiJieXRlIn0sYmx1ZTp7aWR4OjIsdHlwZToiYnl0ZSJ9fX0saHNsYTp7cHJvcHM6e2h1ZTp7aWR4OjAsdHlwZToiZGVncmVlcyJ9LHNhdHVyYXRpb246e2lkeDoxLHR5cGU6InBlcmNlbnQifSxsaWdodG5lc3M6e2lkeDoyLHR5cGU6InBlcmNlbnQifX19fSx1PXsiYnl0ZSI6e2Zsb29yOiEwLG1heDoyNTV9LHBlcmNlbnQ6e21heDoxfSxkZWdyZWVzOnttb2Q6MzYwLGZsb29yOiEwfX0sZD1sLnN1cHBvcnQ9e30scD10KCI8cD4iKVswXSxmPXQuZWFjaDtwLnN0eWxlLmNzc1RleHQ9ImJhY2tncm91bmQtY29sb3I6cmdiYSgxLDEsMSwuNSkiLGQucmdiYT1wLnN0eWxlLmJhY2tncm91bmRDb2xvci5pbmRleE9mKCJyZ2JhIik+LTEsZihjLGZ1bmN0aW9uKHQsZSl7ZS5jYWNoZT0iXyIrdCxlLnByb3BzLmFscGhhPXtpZHg6Myx0eXBlOiJwZXJjZW50IixkZWY6MX19KSxsLmZuPXQuZXh0ZW5kKGwucHJvdG90eXBlLHtwYXJzZTpmdW5jdGlvbihuLGEscixoKXtpZihuPT09ZSlyZXR1cm4gdGhpcy5fcmdiYT1bbnVsbCxudWxsLG51bGwsbnVsbF0sdGhpczsobi5qcXVlcnl8fG4ubm9kZVR5cGUpJiYobj10KG4pLmNzcyhhKSxhPWUpO3ZhciB1PXRoaXMsZD10LnR5cGUobikscD10aGlzLl9yZ2JhPVtdO3JldHVybiBhIT09ZSYmKG49W24sYSxyLGhdLGQ9ImFycmF5IiksInN0cmluZyI9PT1kP3RoaXMucGFyc2UocyhuKXx8by5fZGVmYXVsdCk6ImFycmF5Ij09PWQ/KGYoYy5yZ2JhLnByb3BzLGZ1bmN0aW9uKHQsZSl7cFtlLmlkeF09aShuW2UuaWR4XSxlKX0pLHRoaXMpOiJvYmplY3QiPT09ZD8obiBpbnN0YW5jZW9mIGw/ZihjLGZ1bmN0aW9uKHQsZSl7bltlLmNhY2hlXSYmKHVbZS5jYWNoZV09bltlLmNhY2hlXS5zbGljZSgpKX0pOmYoYyxmdW5jdGlvbihlLHMpe3ZhciBvPXMuY2FjaGU7ZihzLnByb3BzLGZ1bmN0aW9uKHQsZSl7aWYoIXVbb10mJnMudG8pe2lmKCJhbHBoYSI9PT10fHxudWxsPT1uW3RdKXJldHVybjt1W29dPXMudG8odS5fcmdiYSl9dVtvXVtlLmlkeF09aShuW3RdLGUsITApfSksdVtvXSYmMD50LmluQXJyYXkobnVsbCx1W29dLnNsaWNlKDAsMykpJiYodVtvXVszXT0xLHMuZnJvbSYmKHUuX3JnYmE9cy5mcm9tKHVbb10pKSl9KSx0aGlzKTplfSxpczpmdW5jdGlvbih0KXt2YXIgaT1sKHQpLHM9ITAsbj10aGlzO3JldHVybiBmKGMsZnVuY3Rpb24odCxvKXt2YXIgYSxyPWlbby5jYWNoZV07cmV0dXJuIHImJihhPW5bby5jYWNoZV18fG8udG8mJm8udG8obi5fcmdiYSl8fFtdLGYoby5wcm9wcyxmdW5jdGlvbih0LGkpe3JldHVybiBudWxsIT1yW2kuaWR4XT9zPXJbaS5pZHhdPT09YVtpLmlkeF06ZX0pKSxzfSksc30sX3NwYWNlOmZ1bmN0aW9uKCl7dmFyIHQ9W10sZT10aGlzO3JldHVybiBmKGMsZnVuY3Rpb24oaSxzKXtlW3MuY2FjaGVdJiZ0LnB1c2goaSl9KSx0LnBvcCgpfSx0cmFuc2l0aW9uOmZ1bmN0aW9uKHQsZSl7dmFyIHM9bCh0KSxuPXMuX3NwYWNlKCksbz1jW25dLGE9MD09PXRoaXMuYWxwaGEoKT9sKCJ0cmFuc3BhcmVudCIpOnRoaXMscj1hW28uY2FjaGVdfHxvLnRvKGEuX3JnYmEpLGg9ci5zbGljZSgpO3JldHVybiBzPXNbby5jYWNoZV0sZihvLnByb3BzLGZ1bmN0aW9uKHQsbil7dmFyIG89bi5pZHgsYT1yW29dLGw9c1tvXSxjPXVbbi50eXBlXXx8e307bnVsbCE9PWwmJihudWxsPT09YT9oW29dPWw6KGMubW9kJiYobC1hPmMubW9kLzI/YSs9Yy5tb2Q6YS1sPmMubW9kLzImJihhLT1jLm1vZCkpLGhbb109aSgobC1hKSplK2EsbikpKX0pLHRoaXNbbl0oaCl9LGJsZW5kOmZ1bmN0aW9uKGUpe2lmKDE9PT10aGlzLl9yZ2JhWzNdKXJldHVybiB0aGlzO3ZhciBpPXRoaXMuX3JnYmEuc2xpY2UoKSxzPWkucG9wKCksbj1sKGUpLl9yZ2JhO3JldHVybiBsKHQubWFwKGksZnVuY3Rpb24odCxlKXtyZXR1cm4oMS1zKSpuW2VdK3MqdH0pKX0sdG9SZ2JhU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIGU9InJnYmEoIixpPXQubWFwKHRoaXMuX3JnYmEsZnVuY3Rpb24odCxlKXtyZXR1cm4gbnVsbD09dD9lPjI/MTowOnR9KTtyZXR1cm4gMT09PWlbM10mJihpLnBvcCgpLGU9InJnYigiKSxlK2kuam9pbigpKyIpIn0sdG9Ic2xhU3RyaW5nOmZ1bmN0aW9uKCl7dmFyIGU9ImhzbGEoIixpPXQubWFwKHRoaXMuaHNsYSgpLGZ1bmN0aW9uKHQsZSl7cmV0dXJuIG51bGw9PXQmJih0PWU+Mj8xOjApLGUmJjM+ZSYmKHQ9TWF0aC5yb3VuZCgxMDAqdCkrIiUiKSx0fSk7cmV0dXJuIDE9PT1pWzNdJiYoaS5wb3AoKSxlPSJoc2woIiksZStpLmpvaW4oKSsiKSJ9LHRvSGV4U3RyaW5nOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX3JnYmEuc2xpY2UoKSxzPWkucG9wKCk7cmV0dXJuIGUmJmkucHVzaCh+figyNTUqcykpLCIjIit0Lm1hcChpLGZ1bmN0aW9uKHQpe3JldHVybiB0PSh0fHwwKS50b1N0cmluZygxNiksMT09PXQubGVuZ3RoPyIwIit0OnR9KS5qb2luKCIiKX0sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gMD09PXRoaXMuX3JnYmFbM10/InRyYW5zcGFyZW50Ijp0aGlzLnRvUmdiYVN0cmluZygpfX0pLGwuZm4ucGFyc2UucHJvdG90eXBlPWwuZm4sYy5oc2xhLnRvPWZ1bmN0aW9uKHQpe2lmKG51bGw9PXRbMF18fG51bGw9PXRbMV18fG51bGw9PXRbMl0pcmV0dXJuW251bGwsbnVsbCxudWxsLHRbM11dO3ZhciBlLGkscz10WzBdLzI1NSxuPXRbMV0vMjU1LG89dFsyXS8yNTUsYT10WzNdLHI9TWF0aC5tYXgocyxuLG8pLGg9TWF0aC5taW4ocyxuLG8pLGw9ci1oLGM9citoLHU9LjUqYztyZXR1cm4gZT1oPT09cj8wOnM9PT1yPzYwKihuLW8pL2wrMzYwOm49PT1yPzYwKihvLXMpL2wrMTIwOjYwKihzLW4pL2wrMjQwLGk9MD09PWw/MDouNT49dT9sL2M6bC8oMi1jKSxbTWF0aC5yb3VuZChlKSUzNjAsaSx1LG51bGw9PWE/MTphXX0sYy5oc2xhLmZyb209ZnVuY3Rpb24odCl7aWYobnVsbD09dFswXXx8bnVsbD09dFsxXXx8bnVsbD09dFsyXSlyZXR1cm5bbnVsbCxudWxsLG51bGwsdFszXV07dmFyIGU9dFswXS8zNjAsaT10WzFdLHM9dFsyXSxvPXRbM10sYT0uNT49cz9zKigxK2kpOnMraS1zKmkscj0yKnMtYTtyZXR1cm5bTWF0aC5yb3VuZCgyNTUqbihyLGEsZSsxLzMpKSxNYXRoLnJvdW5kKDI1NSpuKHIsYSxlKSksTWF0aC5yb3VuZCgyNTUqbihyLGEsZS0xLzMpKSxvXX0sZihjLGZ1bmN0aW9uKHMsbil7dmFyIG89bi5wcm9wcyxhPW4uY2FjaGUsaD1uLnRvLGM9bi5mcm9tO2wuZm5bc109ZnVuY3Rpb24ocyl7aWYoaCYmIXRoaXNbYV0mJih0aGlzW2FdPWgodGhpcy5fcmdiYSkpLHM9PT1lKXJldHVybiB0aGlzW2FdLnNsaWNlKCk7dmFyIG4scj10LnR5cGUocyksdT0iYXJyYXkiPT09cnx8Im9iamVjdCI9PT1yP3M6YXJndW1lbnRzLGQ9dGhpc1thXS5zbGljZSgpO3JldHVybiBmKG8sZnVuY3Rpb24odCxlKXt2YXIgcz11WyJvYmplY3QiPT09cj90OmUuaWR4XTtudWxsPT1zJiYocz1kW2UuaWR4XSksZFtlLmlkeF09aShzLGUpfSksYz8obj1sKGMoZCkpLG5bYV09ZCxuKTpsKGQpfSxmKG8sZnVuY3Rpb24oZSxpKXtsLmZuW2VdfHwobC5mbltlXT1mdW5jdGlvbihuKXt2YXIgbyxhPXQudHlwZShuKSxoPSJhbHBoYSI9PT1lP3RoaXMuX2hzbGE/ImhzbGEiOiJyZ2JhIjpzLGw9dGhpc1toXSgpLGM9bFtpLmlkeF07cmV0dXJuInVuZGVmaW5lZCI9PT1hP2M6KCJmdW5jdGlvbiI9PT1hJiYobj1uLmNhbGwodGhpcyxjKSxhPXQudHlwZShuKSksbnVsbD09biYmaS5lbXB0eT90aGlzOigic3RyaW5nIj09PWEmJihvPXIuZXhlYyhuKSxvJiYobj1jK3BhcnNlRmxvYXQob1syXSkqKCIrIj09PW9bMV0/MTotMSkpKSxsW2kuaWR4XT1uLHRoaXNbaF0obCkpKX0pfSl9KSxsLmhvb2s9ZnVuY3Rpb24oZSl7dmFyIGk9ZS5zcGxpdCgiICIpO2YoaSxmdW5jdGlvbihlLGkpe3QuY3NzSG9va3NbaV09e3NldDpmdW5jdGlvbihlLG4pe3ZhciBvLGEscj0iIjtpZigidHJhbnNwYXJlbnQiIT09biYmKCJzdHJpbmciIT09dC50eXBlKG4pfHwobz1zKG4pKSkpe2lmKG49bChvfHxuKSwhZC5yZ2JhJiYxIT09bi5fcmdiYVszXSl7Zm9yKGE9ImJhY2tncm91bmRDb2xvciI9PT1pP2UucGFyZW50Tm9kZTplOygiIj09PXJ8fCJ0cmFuc3BhcmVudCI9PT1yKSYmYSYmYS5zdHlsZTspdHJ5e3I9dC5jc3MoYSwiYmFja2dyb3VuZENvbG9yIiksYT1hLnBhcmVudE5vZGV9Y2F0Y2goaCl7fW49bi5ibGVuZChyJiYidHJhbnNwYXJlbnQiIT09cj9yOiJfZGVmYXVsdCIpfW49bi50b1JnYmFTdHJpbmcoKX10cnl7ZS5zdHlsZVtpXT1ufWNhdGNoKGgpe319fSx0LmZ4LnN0ZXBbaV09ZnVuY3Rpb24oZSl7ZS5jb2xvckluaXR8fChlLnN0YXJ0PWwoZS5lbGVtLGkpLGUuZW5kPWwoZS5lbmQpLGUuY29sb3JJbml0PSEwKSx0LmNzc0hvb2tzW2ldLnNldChlLmVsZW0sZS5zdGFydC50cmFuc2l0aW9uKGUuZW5kLGUucG9zKSl9fSl9LGwuaG9vayhhKSx0LmNzc0hvb2tzLmJvcmRlckNvbG9yPXtleHBhbmQ6ZnVuY3Rpb24odCl7dmFyIGU9e307cmV0dXJuIGYoWyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxmdW5jdGlvbihpLHMpe2VbImJvcmRlciIrcysiQ29sb3IiXT10fSksZX19LG89dC5Db2xvci5uYW1lcz17YXF1YToiIzAwZmZmZiIsYmxhY2s6IiMwMDAwMDAiLGJsdWU6IiMwMDAwZmYiLGZ1Y2hzaWE6IiNmZjAwZmYiLGdyYXk6IiM4MDgwODAiLGdyZWVuOiIjMDA4MDAwIixsaW1lOiIjMDBmZjAwIixtYXJvb246IiM4MDAwMDAiLG5hdnk6IiMwMDAwODAiLG9saXZlOiIjODA4MDAwIixwdXJwbGU6IiM4MDAwODAiLHJlZDoiI2ZmMDAwMCIsc2lsdmVyOiIjYzBjMGMwIix0ZWFsOiIjMDA4MDgwIix3aGl0ZToiI2ZmZmZmZiIseWVsbG93OiIjZmZmZjAwIix0cmFuc3BhcmVudDpbbnVsbCxudWxsLG51bGwsMF0sX2RlZmF1bHQ6IiNmZmZmZmYifX0ocCksZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3ZhciBpLHMsbj1lLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc/ZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZSxudWxsKTplLmN1cnJlbnRTdHlsZSxvPXt9O2lmKG4mJm4ubGVuZ3RoJiZuWzBdJiZuW25bMF1dKWZvcihzPW4ubGVuZ3RoO3MtLTspaT1uW3NdLCJzdHJpbmciPT10eXBlb2YgbltpXSYmKG9bdC5jYW1lbENhc2UoaSldPW5baV0pO2Vsc2UgZm9yKGkgaW4gbikic3RyaW5nIj09dHlwZW9mIG5baV0mJihvW2ldPW5baV0pO3JldHVybiBvfWZ1bmN0aW9uIGkoZSxpKXt2YXIgcyxvLGE9e307Zm9yKHMgaW4gaSlvPWlbc10sZVtzXSE9PW8mJihuW3NdfHwodC5meC5zdGVwW3NdfHwhaXNOYU4ocGFyc2VGbG9hdChvKSkpJiYoYVtzXT1vKSk7cmV0dXJuIGF9dmFyIHM9WyJhZGQiLCJyZW1vdmUiLCJ0b2dnbGUiXSxuPXtib3JkZXI6MSxib3JkZXJCb3R0b206MSxib3JkZXJDb2xvcjoxLGJvcmRlckxlZnQ6MSxib3JkZXJSaWdodDoxLGJvcmRlclRvcDoxLGJvcmRlcldpZHRoOjEsbWFyZ2luOjEscGFkZGluZzoxfTt0LmVhY2goWyJib3JkZXJMZWZ0U3R5bGUiLCJib3JkZXJSaWdodFN0eWxlIiwiYm9yZGVyQm90dG9tU3R5bGUiLCJib3JkZXJUb3BTdHlsZSJdLGZ1bmN0aW9uKGUsaSl7dC5meC5zdGVwW2ldPWZ1bmN0aW9uKHQpeygibm9uZSIhPT10LmVuZCYmIXQuc2V0QXR0cnx8MT09PXQucG9zJiYhdC5zZXRBdHRyKSYmKHAuc3R5bGUodC5lbGVtLGksdC5lbmQpLHQuc2V0QXR0cj0hMCl9fSksdC5mbi5hZGRCYWNrfHwodC5mbi5hZGRCYWNrPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmFkZChudWxsPT10P3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKHQpKX0pLHQuZWZmZWN0cy5hbmltYXRlQ2xhc3M9ZnVuY3Rpb24obixvLGEscil7dmFyIGg9dC5zcGVlZChvLGEscik7cmV0dXJuIHRoaXMucXVldWUoZnVuY3Rpb24oKXt2YXIgbyxhPXQodGhpcykscj1hLmF0dHIoImNsYXNzIil8fCIiLGw9aC5jaGlsZHJlbj9hLmZpbmQoIioiKS5hZGRCYWNrKCk6YTtsPWwubWFwKGZ1bmN0aW9uKCl7dmFyIGk9dCh0aGlzKTtyZXR1cm57ZWw6aSxzdGFydDplKHRoaXMpfX0pLG89ZnVuY3Rpb24oKXt0LmVhY2gocyxmdW5jdGlvbih0LGUpe25bZV0mJmFbZSsiQ2xhc3MiXShuW2VdKX0pfSxvKCksbD1sLm1hcChmdW5jdGlvbigpe3JldHVybiB0aGlzLmVuZD1lKHRoaXMuZWxbMF0pLHRoaXMuZGlmZj1pKHRoaXMuc3RhcnQsdGhpcy5lbmQpLHRoaXN9KSxhLmF0dHIoImNsYXNzIixyKSxsPWwubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dGhpcyxpPXQuRGVmZXJyZWQoKSxzPXQuZXh0ZW5kKHt9LGgse3F1ZXVlOiExLGNvbXBsZXRlOmZ1bmN0aW9uKCl7aS5yZXNvbHZlKGUpfX0pO3JldHVybiB0aGlzLmVsLmFuaW1hdGUodGhpcy5kaWZmLHMpLGkucHJvbWlzZSgpfSksdC53aGVuLmFwcGx5KHQsbC5nZXQoKSkuZG9uZShmdW5jdGlvbigpe28oKSx0LmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5lbDt0LmVhY2godGhpcy5kaWZmLGZ1bmN0aW9uKHQpe2UuY3NzKHQsIiIpfSl9KSxoLmNvbXBsZXRlLmNhbGwoYVswXSl9KX0pfSx0LmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKGkscyxuLG8pe3JldHVybiBzP3QuZWZmZWN0cy5hbmltYXRlQ2xhc3MuY2FsbCh0aGlzLHthZGQ6aX0scyxuLG8pOmUuYXBwbHkodGhpcyxhcmd1bWVudHMpfX0odC5mbi5hZGRDbGFzcykscmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKGkscyxuLG8pe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjE/dC5lZmZlY3RzLmFuaW1hdGVDbGFzcy5jYWxsKHRoaXMse3JlbW92ZTppfSxzLG4sbyk6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSh0LmZuLnJlbW92ZUNsYXNzKSx0b2dnbGVDbGFzczpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oaSxzLG4sbyxhKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBzfHx2b2lkIDA9PT1zP24/dC5lZmZlY3RzLmFuaW1hdGVDbGFzcy5jYWxsKHRoaXMscz97YWRkOml9OntyZW1vdmU6aX0sbixvLGEpOmUuYXBwbHkodGhpcyxhcmd1bWVudHMpOnQuZWZmZWN0cy5hbmltYXRlQ2xhc3MuY2FsbCh0aGlzLHt0b2dnbGU6aX0scyxuLG8pfX0odC5mbi50b2dnbGVDbGFzcyksc3dpdGNoQ2xhc3M6ZnVuY3Rpb24oZSxpLHMsbixvKXtyZXR1cm4gdC5lZmZlY3RzLmFuaW1hdGVDbGFzcy5jYWxsKHRoaXMse2FkZDppLHJlbW92ZTplfSxzLG4sbyl9fSl9KCksZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsaSxzLG4pe3JldHVybiB0LmlzUGxhaW5PYmplY3QoZSkmJihpPWUsZT1lLmVmZmVjdCksZT17ZWZmZWN0OmV9LG51bGw9PWkmJihpPXt9KSx0LmlzRnVuY3Rpb24oaSkmJihuPWkscz1udWxsLGk9e30pLCgibnVtYmVyIj09dHlwZW9mIGl8fHQuZnguc3BlZWRzW2ldKSYmKG49cyxzPWksaT17fSksdC5pc0Z1bmN0aW9uKHMpJiYobj1zLHM9bnVsbCksaSYmdC5leHRlbmQoZSxpKSxzPXN8fGkuZHVyYXRpb24sZS5kdXJhdGlvbj10LmZ4Lm9mZj8wOiJudW1iZXIiPT10eXBlb2Ygcz9zOnMgaW4gdC5meC5zcGVlZHM/dC5meC5zcGVlZHNbc106dC5meC5zcGVlZHMuX2RlZmF1bHQsZS5jb21wbGV0ZT1ufHxpLmNvbXBsZXRlLGV9ZnVuY3Rpb24gaShlKXtyZXR1cm4hZXx8Im51bWJlciI9PXR5cGVvZiBlfHx0LmZ4LnNwZWVkc1tlXT8hMDoic3RyaW5nIiE9dHlwZW9mIGV8fHQuZWZmZWN0cy5lZmZlY3RbZV0/dC5pc0Z1bmN0aW9uKGUpPyEwOiJvYmplY3QiIT10eXBlb2YgZXx8ZS5lZmZlY3Q/ITE6ITA6ITB9ZnVuY3Rpb24gcyh0LGUpe3ZhciBpPWUub3V0ZXJXaWR0aCgpLHM9ZS5vdXRlckhlaWdodCgpLG49L15yZWN0XCgoLT9cZCpcLj9cZCpweHwtP1xkKyV8YXV0byksP1xzKigtP1xkKlwuP1xkKnB4fC0/XGQrJXxhdXRvKSw/XHMqKC0/XGQqXC4/XGQqcHh8LT9cZCslfGF1dG8pLD9ccyooLT9cZCpcLj9cZCpweHwtP1xkKyV8YXV0bylcKSQvLG89bi5leGVjKHQpfHxbIiIsMCxpLHMsMF07cmV0dXJue3RvcDpwYXJzZUZsb2F0KG9bMV0pfHwwLHJpZ2h0OiJhdXRvIj09PW9bMl0/aTpwYXJzZUZsb2F0KG9bMl0pLGJvdHRvbToiYXV0byI9PT1vWzNdP3M6cGFyc2VGbG9hdChvWzNdKSxsZWZ0OnBhcnNlRmxvYXQob1s0XSl8fDB9fXQuZXhwciYmdC5leHByLmZpbHRlcnMmJnQuZXhwci5maWx0ZXJzLmFuaW1hdGVkJiYodC5leHByLmZpbHRlcnMuYW5pbWF0ZWQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGZ1bmN0aW9uKGkpe3JldHVybiEhdChpKS5kYXRhKGQpfHxlKGkpfX0odC5leHByLmZpbHRlcnMuYW5pbWF0ZWQpKSx0LnVpQmFja0NvbXBhdCE9PSExJiZ0LmV4dGVuZCh0LmVmZmVjdHMse3NhdmU6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGk9MCxzPWUubGVuZ3RoO3M+aTtpKyspbnVsbCE9PWVbaV0mJnQuZGF0YShjK2VbaV0sdFswXS5zdHlsZVtlW2ldXSl9LHJlc3RvcmU6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGkscz0wLG49ZS5sZW5ndGg7bj5zO3MrKyludWxsIT09ZVtzXSYmKGk9dC5kYXRhKGMrZVtzXSksdC5jc3MoZVtzXSxpKSl9LHNldE1vZGU6ZnVuY3Rpb24odCxlKXtyZXR1cm4idG9nZ2xlIj09PWUmJihlPXQuaXMoIjpoaWRkZW4iKT8ic2hvdyI6ImhpZGUiKSxlfSxjcmVhdGVXcmFwcGVyOmZ1bmN0aW9uKGUpe2lmKGUucGFyZW50KCkuaXMoIi51aS1lZmZlY3RzLXdyYXBwZXIiKSlyZXR1cm4gZS5wYXJlbnQoKTt2YXIgaT17d2lkdGg6ZS5vdXRlcldpZHRoKCEwKSxoZWlnaHQ6ZS5vdXRlckhlaWdodCghMCksImZsb2F0IjplLmNzcygiZmxvYXQiKX0scz10KCI8ZGl2PjwvZGl2PiIpLmFkZENsYXNzKCJ1aS1lZmZlY3RzLXdyYXBwZXIiKS5jc3Moe2ZvbnRTaXplOiIxMDAlIixiYWNrZ3JvdW5kOiJ0cmFuc3BhcmVudCIsYm9yZGVyOiJub25lIixtYXJnaW46MCxwYWRkaW5nOjB9KSxuPXt3aWR0aDplLndpZHRoKCksaGVpZ2h0OmUuaGVpZ2h0KCl9LG89ZG9jdW1lbnQuYWN0aXZlRWxlbWVudDt0cnl7by5pZH1jYXRjaChhKXtvPWRvY3VtZW50LmJvZHl9cmV0dXJuIGUud3JhcChzKSwoZVswXT09PW98fHQuY29udGFpbnMoZVswXSxvKSkmJnQobykudHJpZ2dlcigiZm9jdXMiKSxzPWUucGFyZW50KCksInN0YXRpYyI9PT1lLmNzcygicG9zaXRpb24iKT8ocy5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSJ9KSxlLmNzcyh7cG9zaXRpb246InJlbGF0aXZlIn0pKToodC5leHRlbmQoaSx7cG9zaXRpb246ZS5jc3MoInBvc2l0aW9uIiksekluZGV4OmUuY3NzKCJ6LWluZGV4Iil9KSx0LmVhY2goWyJ0b3AiLCJsZWZ0IiwiYm90dG9tIiwicmlnaHQiXSxmdW5jdGlvbih0LHMpe2lbc109ZS5jc3MocyksaXNOYU4ocGFyc2VJbnQoaVtzXSwxMCkpJiYoaVtzXT0iYXV0byIpfSksZS5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSIsdG9wOjAsbGVmdDowLHJpZ2h0OiJhdXRvIixib3R0b206ImF1dG8ifSkpLGUuY3NzKG4pLHMuY3NzKGkpLnNob3coKX0scmVtb3ZlV3JhcHBlcjpmdW5jdGlvbihlKXt2YXIgaT1kb2N1bWVudC5hY3RpdmVFbGVtZW50O3JldHVybiBlLnBhcmVudCgpLmlzKCIudWktZWZmZWN0cy13cmFwcGVyIikmJihlLnBhcmVudCgpLnJlcGxhY2VXaXRoKGUpLChlWzBdPT09aXx8dC5jb250YWlucyhlWzBdLGkpKSYmdChpKS50cmlnZ2VyKCJmb2N1cyIpKSxlfX0pLHQuZXh0ZW5kKHQuZWZmZWN0cyx7dmVyc2lvbjoiMS4xMi4xIixkZWZpbmU6ZnVuY3Rpb24oZSxpLHMpe3JldHVybiBzfHwocz1pLGk9ImVmZmVjdCIpLHQuZWZmZWN0cy5lZmZlY3RbZV09cyx0LmVmZmVjdHMuZWZmZWN0W2VdLm1vZGU9aSxzfSxzY2FsZWREaW1lbnNpb25zOmZ1bmN0aW9uKHQsZSxpKXtpZigwPT09ZSlyZXR1cm57aGVpZ2h0OjAsd2lkdGg6MCxvdXRlckhlaWdodDowLG91dGVyV2lkdGg6MH07dmFyIHM9Imhvcml6b250YWwiIT09aT8oZXx8MTAwKS8xMDA6MSxuPSJ2ZXJ0aWNhbCIhPT1pPyhlfHwxMDApLzEwMDoxO3JldHVybntoZWlnaHQ6dC5oZWlnaHQoKSpuLHdpZHRoOnQud2lkdGgoKSpzLG91dGVySGVpZ2h0OnQub3V0ZXJIZWlnaHQoKSpuLG91dGVyV2lkdGg6dC5vdXRlcldpZHRoKCkqc319LGNsaXBUb0JveDpmdW5jdGlvbih0KXtyZXR1cm57d2lkdGg6dC5jbGlwLnJpZ2h0LXQuY2xpcC5sZWZ0LGhlaWdodDp0LmNsaXAuYm90dG9tLXQuY2xpcC50b3AsbGVmdDp0LmNsaXAubGVmdCx0b3A6dC5jbGlwLnRvcH19LHVuc2hpZnQ6ZnVuY3Rpb24odCxlLGkpe3ZhciBzPXQucXVldWUoKTtlPjEmJnMuc3BsaWNlLmFwcGx5KHMsWzEsMF0uY29uY2F0KHMuc3BsaWNlKGUsaSkpKSx0LmRlcXVldWUoKX0sc2F2ZVN0eWxlOmZ1bmN0aW9uKHQpe3QuZGF0YSh1LHRbMF0uc3R5bGUuY3NzVGV4dCl9LHJlc3RvcmVTdHlsZTpmdW5jdGlvbih0KXt0WzBdLnN0eWxlLmNzc1RleHQ9dC5kYXRhKHUpfHwiIix0LnJlbW92ZURhdGEodSl9LG1vZGU6ZnVuY3Rpb24odCxlKXt2YXIgaT10LmlzKCI6aGlkZGVuIik7cmV0dXJuInRvZ2dsZSI9PT1lJiYoZT1pPyJzaG93IjoiaGlkZSIpLChpPyJoaWRlIj09PWU6InNob3ciPT09ZSkmJihlPSJub25lIiksZX0sZ2V0QmFzZWxpbmU6ZnVuY3Rpb24odCxlKXt2YXIgaSxzO3N3aXRjaCh0WzBdKXtjYXNlInRvcCI6aT0wO2JyZWFrO2Nhc2UibWlkZGxlIjppPS41O2JyZWFrO2Nhc2UiYm90dG9tIjppPTE7YnJlYWs7ZGVmYXVsdDppPXRbMF0vZS5oZWlnaHR9c3dpdGNoKHRbMV0pe2Nhc2UibGVmdCI6cz0wO2JyZWFrO2Nhc2UiY2VudGVyIjpzPS41O2JyZWFrO2Nhc2UicmlnaHQiOnM9MTticmVhaztkZWZhdWx0OnM9dFsxXS9lLndpZHRofXJldHVybnt4OnMseTppfX0sY3JlYXRlUGxhY2Vob2xkZXI6ZnVuY3Rpb24oZSl7dmFyIGkscz1lLmNzcygicG9zaXRpb24iKSxuPWUucG9zaXRpb24oKTtyZXR1cm4gZS5jc3Moe21hcmdpblRvcDplLmNzcygibWFyZ2luVG9wIiksbWFyZ2luQm90dG9tOmUuY3NzKCJtYXJnaW5Cb3R0b20iKSxtYXJnaW5MZWZ0OmUuY3NzKCJtYXJnaW5MZWZ0IiksbWFyZ2luUmlnaHQ6ZS5jc3MoIm1hcmdpblJpZ2h0Iil9KS5vdXRlcldpZHRoKGUub3V0ZXJXaWR0aCgpKS5vdXRlckhlaWdodChlLm91dGVySGVpZ2h0KCkpLC9eKHN0YXRpY3xyZWxhdGl2ZSkvLnRlc3QocykmJihzPSJhYnNvbHV0ZSIsaT10KCI8IitlWzBdLm5vZGVOYW1lKyI+IikuaW5zZXJ0QWZ0ZXIoZSkuY3NzKHtkaXNwbGF5Oi9eKGlubGluZXxydWJ5KS8udGVzdChlLmNzcygiZGlzcGxheSIpKT8iaW5saW5lLWJsb2NrIjoiYmxvY2siLHZpc2liaWxpdHk6ImhpZGRlbiIsbWFyZ2luVG9wOmUuY3NzKCJtYXJnaW5Ub3AiKSxtYXJnaW5Cb3R0b206ZS5jc3MoIm1hcmdpbkJvdHRvbSIpLG1hcmdpbkxlZnQ6ZS5jc3MoIm1hcmdpbkxlZnQiKSxtYXJnaW5SaWdodDplLmNzcygibWFyZ2luUmlnaHQiKSwiZmxvYXQiOmUuY3NzKCJmbG9hdCIpfSkub3V0ZXJXaWR0aChlLm91dGVyV2lkdGgoKSkub3V0ZXJIZWlnaHQoZS5vdXRlckhlaWdodCgpKS5hZGRDbGFzcygidWktZWZmZWN0cy1wbGFjZWhvbGRlciIpLGUuZGF0YShjKyJwbGFjZWhvbGRlciIsaSkpLGUuY3NzKHtwb3NpdGlvbjpzLGxlZnQ6bi5sZWZ0LHRvcDpuLnRvcH0pLGl9LHJlbW92ZVBsYWNlaG9sZGVyOmZ1bmN0aW9uKHQpe3ZhciBlPWMrInBsYWNlaG9sZGVyIixpPXQuZGF0YShlKTtpJiYoaS5yZW1vdmUoKSx0LnJlbW92ZURhdGEoZSkpfSxjbGVhblVwOmZ1bmN0aW9uKGUpe3QuZWZmZWN0cy5yZXN0b3JlU3R5bGUoZSksdC5lZmZlY3RzLnJlbW92ZVBsYWNlaG9sZGVyKGUpfSxzZXRUcmFuc2l0aW9uOmZ1bmN0aW9uKGUsaSxzLG4pe3JldHVybiBuPW58fHt9LHQuZWFjaChpLGZ1bmN0aW9uKHQsaSl7dmFyIG89ZS5jc3NVbml0KGkpO29bMF0+MCYmKG5baV09b1swXSpzK29bMV0pfSksbn19KSx0LmZuLmV4dGVuZCh7ZWZmZWN0OmZ1bmN0aW9uKCl7ZnVuY3Rpb24gaShlKXtmdW5jdGlvbiBpKCl7ci5yZW1vdmVEYXRhKGQpLHQuZWZmZWN0cy5jbGVhblVwKHIpLCJoaWRlIj09PXMubW9kZSYmci5oaWRlKCksYSgpfWZ1bmN0aW9uIGEoKXt0LmlzRnVuY3Rpb24oaCkmJmguY2FsbChyWzBdKSx0LmlzRnVuY3Rpb24oZSkmJmUoKX12YXIgcj10KHRoaXMpO3MubW9kZT1jLnNoaWZ0KCksdC51aUJhY2tDb21wYXQ9PT0hMXx8bz8ibm9uZSI9PT1zLm1vZGU/KHJbbF0oKSxhKCkpOm4uY2FsbChyWzBdLHMsaSk6KHIuaXMoIjpoaWRkZW4iKT8iaGlkZSI9PT1sOiJzaG93Ij09PWwpPyhyW2xdKCksYSgpKTpuLmNhbGwoclswXSxzLGEpfXZhciBzPWUuYXBwbHkodGhpcyxhcmd1bWVudHMpLG49dC5lZmZlY3RzLmVmZmVjdFtzLmVmZmVjdF0sbz1uLm1vZGUsYT1zLnF1ZXVlLHI9YXx8ImZ4IixoPXMuY29tcGxldGUsbD1zLm1vZGUsYz1bXSx1PWZ1bmN0aW9uKGUpe3ZhciBpPXQodGhpcykscz10LmVmZmVjdHMubW9kZShpLGwpfHxvO2kuZGF0YShkLCEwKSxjLnB1c2gocyksbyYmKCJzaG93Ij09PXN8fHM9PT1vJiYiaGlkZSI9PT1zKSYmaS5zaG93KCksbyYmIm5vbmUiPT09c3x8dC5lZmZlY3RzLnNhdmVTdHlsZShpKSx0LmlzRnVuY3Rpb24oZSkmJmUoKX07cmV0dXJuIHQuZngub2ZmfHwhbj9sP3RoaXNbbF0ocy5kdXJhdGlvbixoKTp0aGlzLmVhY2goZnVuY3Rpb24oKXtoJiZoLmNhbGwodGhpcyl9KTphPT09ITE/dGhpcy5lYWNoKHUpLmVhY2goaSk6dGhpcy5xdWV1ZShyLHUpLnF1ZXVlKHIsaSl9LHNob3c6ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKHMpe2lmKGkocykpcmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBuPWUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBuLm1vZGU9InNob3ciLHRoaXMuZWZmZWN0LmNhbGwodGhpcyxuKQp9fSh0LmZuLnNob3cpLGhpZGU6ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKHMpe2lmKGkocykpcmV0dXJuIHQuYXBwbHkodGhpcyxhcmd1bWVudHMpO3ZhciBuPWUuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiBuLm1vZGU9ImhpZGUiLHRoaXMuZWZmZWN0LmNhbGwodGhpcyxuKX19KHQuZm4uaGlkZSksdG9nZ2xlOmZ1bmN0aW9uKHQpe3JldHVybiBmdW5jdGlvbihzKXtpZihpKHMpfHwiYm9vbGVhbiI9PXR5cGVvZiBzKXJldHVybiB0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgbj1lLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gbi5tb2RlPSJ0b2dnbGUiLHRoaXMuZWZmZWN0LmNhbGwodGhpcyxuKX19KHQuZm4udG9nZ2xlKSxjc3NVbml0OmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuY3NzKGUpLHM9W107cmV0dXJuIHQuZWFjaChbImVtIiwicHgiLCIlIiwicHQiXSxmdW5jdGlvbih0LGUpe2kuaW5kZXhPZihlKT4wJiYocz1bcGFyc2VGbG9hdChpKSxlXSl9KSxzfSxjc3NDbGlwOmZ1bmN0aW9uKHQpe3JldHVybiB0P3RoaXMuY3NzKCJjbGlwIiwicmVjdCgiK3QudG9wKyJweCAiK3QucmlnaHQrInB4ICIrdC5ib3R0b20rInB4ICIrdC5sZWZ0KyJweCkiKTpzKHRoaXMuY3NzKCJjbGlwIiksdGhpcyl9LHRyYW5zZmVyOmZ1bmN0aW9uKGUsaSl7dmFyIHM9dCh0aGlzKSxuPXQoZS50byksbz0iZml4ZWQiPT09bi5jc3MoInBvc2l0aW9uIiksYT10KCJib2R5Iikscj1vP2Euc2Nyb2xsVG9wKCk6MCxoPW8/YS5zY3JvbGxMZWZ0KCk6MCxsPW4ub2Zmc2V0KCksYz17dG9wOmwudG9wLXIsbGVmdDpsLmxlZnQtaCxoZWlnaHQ6bi5pbm5lckhlaWdodCgpLHdpZHRoOm4uaW5uZXJXaWR0aCgpfSx1PXMub2Zmc2V0KCksZD10KCI8ZGl2IGNsYXNzPSd1aS1lZmZlY3RzLXRyYW5zZmVyJz48L2Rpdj4iKS5hcHBlbmRUbygiYm9keSIpLmFkZENsYXNzKGUuY2xhc3NOYW1lKS5jc3Moe3RvcDp1LnRvcC1yLGxlZnQ6dS5sZWZ0LWgsaGVpZ2h0OnMuaW5uZXJIZWlnaHQoKSx3aWR0aDpzLmlubmVyV2lkdGgoKSxwb3NpdGlvbjpvPyJmaXhlZCI6ImFic29sdXRlIn0pLmFuaW1hdGUoYyxlLmR1cmF0aW9uLGUuZWFzaW5nLGZ1bmN0aW9uKCl7ZC5yZW1vdmUoKSx0LmlzRnVuY3Rpb24oaSkmJmkoKX0pfX0pLHQuZnguc3RlcC5jbGlwPWZ1bmN0aW9uKGUpe2UuY2xpcEluaXR8fChlLnN0YXJ0PXQoZS5lbGVtKS5jc3NDbGlwKCksInN0cmluZyI9PXR5cGVvZiBlLmVuZCYmKGUuZW5kPXMoZS5lbmQsZS5lbGVtKSksZS5jbGlwSW5pdD0hMCksdChlLmVsZW0pLmNzc0NsaXAoe3RvcDplLnBvcyooZS5lbmQudG9wLWUuc3RhcnQudG9wKStlLnN0YXJ0LnRvcCxyaWdodDplLnBvcyooZS5lbmQucmlnaHQtZS5zdGFydC5yaWdodCkrZS5zdGFydC5yaWdodCxib3R0b206ZS5wb3MqKGUuZW5kLmJvdHRvbS1lLnN0YXJ0LmJvdHRvbSkrZS5zdGFydC5ib3R0b20sbGVmdDplLnBvcyooZS5lbmQubGVmdC1lLnN0YXJ0LmxlZnQpK2Uuc3RhcnQubGVmdH0pfX0oKSxmdW5jdGlvbigpe3ZhciBlPXt9O3QuZWFjaChbIlF1YWQiLCJDdWJpYyIsIlF1YXJ0IiwiUXVpbnQiLCJFeHBvIl0sZnVuY3Rpb24odCxpKXtlW2ldPWZ1bmN0aW9uKGUpe3JldHVybiBNYXRoLnBvdyhlLHQrMil9fSksdC5leHRlbmQoZSx7U2luZTpmdW5jdGlvbih0KXtyZXR1cm4gMS1NYXRoLmNvcyh0Kk1hdGguUEkvMil9LENpcmM6ZnVuY3Rpb24odCl7cmV0dXJuIDEtTWF0aC5zcXJ0KDEtdCp0KX0sRWxhc3RpYzpmdW5jdGlvbih0KXtyZXR1cm4gMD09PXR8fDE9PT10P3Q6LU1hdGgucG93KDIsOCoodC0xKSkqTWF0aC5zaW4oKDgwKih0LTEpLTcuNSkqTWF0aC5QSS8xNSl9LEJhY2s6ZnVuY3Rpb24odCl7cmV0dXJuIHQqdCooMyp0LTIpfSxCb3VuY2U6ZnVuY3Rpb24odCl7Zm9yKHZhciBlLGk9NDsoKGU9TWF0aC5wb3coMiwtLWkpKS0xKS8xMT50Oyk7cmV0dXJuIDEvTWF0aC5wb3coNCwzLWkpLTcuNTYyNSpNYXRoLnBvdygoMyplLTIpLzIyLXQsMil9fSksdC5lYWNoKGUsZnVuY3Rpb24oZSxpKXt0LmVhc2luZ1siZWFzZUluIitlXT1pLHQuZWFzaW5nWyJlYXNlT3V0IitlXT1mdW5jdGlvbih0KXtyZXR1cm4gMS1pKDEtdCl9LHQuZWFzaW5nWyJlYXNlSW5PdXQiK2VdPWZ1bmN0aW9uKHQpe3JldHVybi41PnQ/aSgyKnQpLzI6MS1pKC0yKnQrMikvMn19KX0oKTt2YXIgZj10LmVmZmVjdHM7dC5lZmZlY3RzLmRlZmluZSgiYmxpbmQiLCJoaWRlIixmdW5jdGlvbihlLGkpe3ZhciBzPXt1cDpbImJvdHRvbSIsInRvcCJdLHZlcnRpY2FsOlsiYm90dG9tIiwidG9wIl0sZG93bjpbInRvcCIsImJvdHRvbSJdLGxlZnQ6WyJyaWdodCIsImxlZnQiXSxob3Jpem9udGFsOlsicmlnaHQiLCJsZWZ0Il0scmlnaHQ6WyJsZWZ0IiwicmlnaHQiXX0sbj10KHRoaXMpLG89ZS5kaXJlY3Rpb258fCJ1cCIsYT1uLmNzc0NsaXAoKSxyPXtjbGlwOnQuZXh0ZW5kKHt9LGEpfSxoPXQuZWZmZWN0cy5jcmVhdGVQbGFjZWhvbGRlcihuKTtyLmNsaXBbc1tvXVswXV09ci5jbGlwW3Nbb11bMV1dLCJzaG93Ij09PWUubW9kZSYmKG4uY3NzQ2xpcChyLmNsaXApLGgmJmguY3NzKHQuZWZmZWN0cy5jbGlwVG9Cb3gocikpLHIuY2xpcD1hKSxoJiZoLmFuaW1hdGUodC5lZmZlY3RzLmNsaXBUb0JveChyKSxlLmR1cmF0aW9uLGUuZWFzaW5nKSxuLmFuaW1hdGUocix7cXVldWU6ITEsZHVyYXRpb246ZS5kdXJhdGlvbixlYXNpbmc6ZS5lYXNpbmcsY29tcGxldGU6aX0pfSksdC5lZmZlY3RzLmRlZmluZSgiYm91bmNlIixmdW5jdGlvbihlLGkpe3ZhciBzLG4sbyxhPXQodGhpcykscj1lLm1vZGUsaD0iaGlkZSI9PT1yLGw9InNob3ciPT09cixjPWUuZGlyZWN0aW9ufHwidXAiLHU9ZS5kaXN0YW5jZSxkPWUudGltZXN8fDUscD0yKmQrKGx8fGg/MTowKSxmPWUuZHVyYXRpb24vcCxnPWUuZWFzaW5nLG09InVwIj09PWN8fCJkb3duIj09PWM/InRvcCI6ImxlZnQiLF89InVwIj09PWN8fCJsZWZ0Ij09PWMsdj0wLGI9YS5xdWV1ZSgpLmxlbmd0aDtmb3IodC5lZmZlY3RzLmNyZWF0ZVBsYWNlaG9sZGVyKGEpLG89YS5jc3MobSksdXx8KHU9YVsidG9wIj09PW0/Im91dGVySGVpZ2h0Ijoib3V0ZXJXaWR0aCJdKCkvMyksbCYmKG49e29wYWNpdHk6MX0sblttXT1vLGEuY3NzKCJvcGFjaXR5IiwwKS5jc3MobSxfPzIqLXU6Mip1KS5hbmltYXRlKG4sZixnKSksaCYmKHUvPU1hdGgucG93KDIsZC0xKSksbj17fSxuW21dPW87ZD52O3YrKylzPXt9LHNbbV09KF8/Ii09IjoiKz0iKSt1LGEuYW5pbWF0ZShzLGYsZykuYW5pbWF0ZShuLGYsZyksdT1oPzIqdTp1LzI7aCYmKHM9e29wYWNpdHk6MH0sc1ttXT0oXz8iLT0iOiIrPSIpK3UsYS5hbmltYXRlKHMsZixnKSksYS5xdWV1ZShpKSx0LmVmZmVjdHMudW5zaGlmdChhLGIscCsxKX0pLHQuZWZmZWN0cy5kZWZpbmUoImNsaXAiLCJoaWRlIixmdW5jdGlvbihlLGkpe3ZhciBzLG49e30sbz10KHRoaXMpLGE9ZS5kaXJlY3Rpb258fCJ2ZXJ0aWNhbCIscj0iYm90aCI9PT1hLGg9cnx8Imhvcml6b250YWwiPT09YSxsPXJ8fCJ2ZXJ0aWNhbCI9PT1hO3M9by5jc3NDbGlwKCksbi5jbGlwPXt0b3A6bD8ocy5ib3R0b20tcy50b3ApLzI6cy50b3AscmlnaHQ6aD8ocy5yaWdodC1zLmxlZnQpLzI6cy5yaWdodCxib3R0b206bD8ocy5ib3R0b20tcy50b3ApLzI6cy5ib3R0b20sbGVmdDpoPyhzLnJpZ2h0LXMubGVmdCkvMjpzLmxlZnR9LHQuZWZmZWN0cy5jcmVhdGVQbGFjZWhvbGRlcihvKSwic2hvdyI9PT1lLm1vZGUmJihvLmNzc0NsaXAobi5jbGlwKSxuLmNsaXA9cyksby5hbmltYXRlKG4se3F1ZXVlOiExLGR1cmF0aW9uOmUuZHVyYXRpb24sZWFzaW5nOmUuZWFzaW5nLGNvbXBsZXRlOml9KX0pLHQuZWZmZWN0cy5kZWZpbmUoImRyb3AiLCJoaWRlIixmdW5jdGlvbihlLGkpe3ZhciBzLG49dCh0aGlzKSxvPWUubW9kZSxhPSJzaG93Ij09PW8scj1lLmRpcmVjdGlvbnx8ImxlZnQiLGg9InVwIj09PXJ8fCJkb3duIj09PXI/InRvcCI6ImxlZnQiLGw9InVwIj09PXJ8fCJsZWZ0Ij09PXI/Ii09IjoiKz0iLGM9Iis9Ij09PWw/Ii09IjoiKz0iLHU9e29wYWNpdHk6MH07dC5lZmZlY3RzLmNyZWF0ZVBsYWNlaG9sZGVyKG4pLHM9ZS5kaXN0YW5jZXx8blsidG9wIj09PWg/Im91dGVySGVpZ2h0Ijoib3V0ZXJXaWR0aCJdKCEwKS8yLHVbaF09bCtzLGEmJihuLmNzcyh1KSx1W2hdPWMrcyx1Lm9wYWNpdHk9MSksbi5hbmltYXRlKHUse3F1ZXVlOiExLGR1cmF0aW9uOmUuZHVyYXRpb24sZWFzaW5nOmUuZWFzaW5nLGNvbXBsZXRlOml9KX0pLHQuZWZmZWN0cy5kZWZpbmUoImV4cGxvZGUiLCJoaWRlIixmdW5jdGlvbihlLGkpe2Z1bmN0aW9uIHMoKXtiLnB1c2godGhpcyksYi5sZW5ndGg9PT11KmQmJm4oKX1mdW5jdGlvbiBuKCl7cC5jc3Moe3Zpc2liaWxpdHk6InZpc2libGUifSksdChiKS5yZW1vdmUoKSxpKCl9dmFyIG8sYSxyLGgsbCxjLHU9ZS5waWVjZXM/TWF0aC5yb3VuZChNYXRoLnNxcnQoZS5waWVjZXMpKTozLGQ9dSxwPXQodGhpcyksZj1lLm1vZGUsZz0ic2hvdyI9PT1mLG09cC5zaG93KCkuY3NzKCJ2aXNpYmlsaXR5IiwiaGlkZGVuIikub2Zmc2V0KCksXz1NYXRoLmNlaWwocC5vdXRlcldpZHRoKCkvZCksdj1NYXRoLmNlaWwocC5vdXRlckhlaWdodCgpL3UpLGI9W107Zm9yKG89MDt1Pm87bysrKWZvcihoPW0udG9wK28qdixjPW8tKHUtMSkvMixhPTA7ZD5hO2ErKylyPW0ubGVmdCthKl8sbD1hLShkLTEpLzIscC5jbG9uZSgpLmFwcGVuZFRvKCJib2R5Iikud3JhcCgiPGRpdj48L2Rpdj4iKS5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdmlzaWJpbGl0eToidmlzaWJsZSIsbGVmdDotYSpfLHRvcDotbyp2fSkucGFyZW50KCkuYWRkQ2xhc3MoInVpLWVmZmVjdHMtZXhwbG9kZSIpLmNzcyh7cG9zaXRpb246ImFic29sdXRlIixvdmVyZmxvdzoiaGlkZGVuIix3aWR0aDpfLGhlaWdodDp2LGxlZnQ6cisoZz9sKl86MCksdG9wOmgrKGc/Yyp2OjApLG9wYWNpdHk6Zz8wOjF9KS5hbmltYXRlKHtsZWZ0OnIrKGc/MDpsKl8pLHRvcDpoKyhnPzA6Yyp2KSxvcGFjaXR5Omc/MTowfSxlLmR1cmF0aW9ufHw1MDAsZS5lYXNpbmcscyl9KSx0LmVmZmVjdHMuZGVmaW5lKCJmYWRlIiwidG9nZ2xlIixmdW5jdGlvbihlLGkpe3ZhciBzPSJzaG93Ij09PWUubW9kZTt0KHRoaXMpLmNzcygib3BhY2l0eSIscz8wOjEpLmFuaW1hdGUoe29wYWNpdHk6cz8xOjB9LHtxdWV1ZTohMSxkdXJhdGlvbjplLmR1cmF0aW9uLGVhc2luZzplLmVhc2luZyxjb21wbGV0ZTppfSl9KSx0LmVmZmVjdHMuZGVmaW5lKCJmb2xkIiwiaGlkZSIsZnVuY3Rpb24oZSxpKXt2YXIgcz10KHRoaXMpLG49ZS5tb2RlLG89InNob3ciPT09bixhPSJoaWRlIj09PW4scj1lLnNpemV8fDE1LGg9LyhbMC05XSspJS8uZXhlYyhyKSxsPSEhZS5ob3JpekZpcnN0LGM9bD9bInJpZ2h0IiwiYm90dG9tIl06WyJib3R0b20iLCJyaWdodCJdLHU9ZS5kdXJhdGlvbi8yLGQ9dC5lZmZlY3RzLmNyZWF0ZVBsYWNlaG9sZGVyKHMpLHA9cy5jc3NDbGlwKCksZj17Y2xpcDp0LmV4dGVuZCh7fSxwKX0sZz17Y2xpcDp0LmV4dGVuZCh7fSxwKX0sbT1bcFtjWzBdXSxwW2NbMV1dXSxfPXMucXVldWUoKS5sZW5ndGg7aCYmKHI9cGFyc2VJbnQoaFsxXSwxMCkvMTAwKm1bYT8wOjFdKSxmLmNsaXBbY1swXV09cixnLmNsaXBbY1swXV09cixnLmNsaXBbY1sxXV09MCxvJiYocy5jc3NDbGlwKGcuY2xpcCksZCYmZC5jc3ModC5lZmZlY3RzLmNsaXBUb0JveChnKSksZy5jbGlwPXApLHMucXVldWUoZnVuY3Rpb24oaSl7ZCYmZC5hbmltYXRlKHQuZWZmZWN0cy5jbGlwVG9Cb3goZiksdSxlLmVhc2luZykuYW5pbWF0ZSh0LmVmZmVjdHMuY2xpcFRvQm94KGcpLHUsZS5lYXNpbmcpLGkoKX0pLmFuaW1hdGUoZix1LGUuZWFzaW5nKS5hbmltYXRlKGcsdSxlLmVhc2luZykucXVldWUoaSksdC5lZmZlY3RzLnVuc2hpZnQocyxfLDQpfSksdC5lZmZlY3RzLmRlZmluZSgiaGlnaGxpZ2h0Iiwic2hvdyIsZnVuY3Rpb24oZSxpKXt2YXIgcz10KHRoaXMpLG49e2JhY2tncm91bmRDb2xvcjpzLmNzcygiYmFja2dyb3VuZENvbG9yIil9OyJoaWRlIj09PWUubW9kZSYmKG4ub3BhY2l0eT0wKSx0LmVmZmVjdHMuc2F2ZVN0eWxlKHMpLHMuY3NzKHtiYWNrZ3JvdW5kSW1hZ2U6Im5vbmUiLGJhY2tncm91bmRDb2xvcjplLmNvbG9yfHwiI2ZmZmY5OSJ9KS5hbmltYXRlKG4se3F1ZXVlOiExLGR1cmF0aW9uOmUuZHVyYXRpb24sZWFzaW5nOmUuZWFzaW5nLGNvbXBsZXRlOml9KX0pLHQuZWZmZWN0cy5kZWZpbmUoInNpemUiLGZ1bmN0aW9uKGUsaSl7dmFyIHMsbixvLGE9dCh0aGlzKSxyPVsiZm9udFNpemUiXSxoPVsiYm9yZGVyVG9wV2lkdGgiLCJib3JkZXJCb3R0b21XaWR0aCIsInBhZGRpbmdUb3AiLCJwYWRkaW5nQm90dG9tIl0sbD1bImJvcmRlckxlZnRXaWR0aCIsImJvcmRlclJpZ2h0V2lkdGgiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCJdLGM9ZS5tb2RlLHU9ImVmZmVjdCIhPT1jLGQ9ZS5zY2FsZXx8ImJvdGgiLHA9ZS5vcmlnaW58fFsibWlkZGxlIiwiY2VudGVyIl0sZj1hLmNzcygicG9zaXRpb24iKSxnPWEucG9zaXRpb24oKSxtPXQuZWZmZWN0cy5zY2FsZWREaW1lbnNpb25zKGEpLF89ZS5mcm9tfHxtLHY9ZS50b3x8dC5lZmZlY3RzLnNjYWxlZERpbWVuc2lvbnMoYSwwKTt0LmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIoYSksInNob3ciPT09YyYmKG89XyxfPXYsdj1vKSxuPXtmcm9tOnt5Ol8uaGVpZ2h0L20uaGVpZ2h0LHg6Xy53aWR0aC9tLndpZHRofSx0bzp7eTp2LmhlaWdodC9tLmhlaWdodCx4OnYud2lkdGgvbS53aWR0aH19LCgiYm94Ij09PWR8fCJib3RoIj09PWQpJiYobi5mcm9tLnkhPT1uLnRvLnkmJihfPXQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKGEsaCxuLmZyb20ueSxfKSx2PXQuZWZmZWN0cy5zZXRUcmFuc2l0aW9uKGEsaCxuLnRvLnksdikpLG4uZnJvbS54IT09bi50by54JiYoXz10LmVmZmVjdHMuc2V0VHJhbnNpdGlvbihhLGwsbi5mcm9tLngsXyksdj10LmVmZmVjdHMuc2V0VHJhbnNpdGlvbihhLGwsbi50by54LHYpKSksKCJjb250ZW50Ij09PWR8fCJib3RoIj09PWQpJiZuLmZyb20ueSE9PW4udG8ueSYmKF89dC5lZmZlY3RzLnNldFRyYW5zaXRpb24oYSxyLG4uZnJvbS55LF8pLHY9dC5lZmZlY3RzLnNldFRyYW5zaXRpb24oYSxyLG4udG8ueSx2KSkscCYmKHM9dC5lZmZlY3RzLmdldEJhc2VsaW5lKHAsbSksXy50b3A9KG0ub3V0ZXJIZWlnaHQtXy5vdXRlckhlaWdodCkqcy55K2cudG9wLF8ubGVmdD0obS5vdXRlcldpZHRoLV8ub3V0ZXJXaWR0aCkqcy54K2cubGVmdCx2LnRvcD0obS5vdXRlckhlaWdodC12Lm91dGVySGVpZ2h0KSpzLnkrZy50b3Asdi5sZWZ0PShtLm91dGVyV2lkdGgtdi5vdXRlcldpZHRoKSpzLngrZy5sZWZ0KSxhLmNzcyhfKSwoImNvbnRlbnQiPT09ZHx8ImJvdGgiPT09ZCkmJihoPWguY29uY2F0KFsibWFyZ2luVG9wIiwibWFyZ2luQm90dG9tIl0pLmNvbmNhdChyKSxsPWwuY29uY2F0KFsibWFyZ2luTGVmdCIsIm1hcmdpblJpZ2h0Il0pLGEuZmluZCgiKlt3aWR0aF0iKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGk9dCh0aGlzKSxzPXQuZWZmZWN0cy5zY2FsZWREaW1lbnNpb25zKGkpLG89e2hlaWdodDpzLmhlaWdodCpuLmZyb20ueSx3aWR0aDpzLndpZHRoKm4uZnJvbS54LG91dGVySGVpZ2h0OnMub3V0ZXJIZWlnaHQqbi5mcm9tLnksb3V0ZXJXaWR0aDpzLm91dGVyV2lkdGgqbi5mcm9tLnh9LGE9e2hlaWdodDpzLmhlaWdodCpuLnRvLnksd2lkdGg6cy53aWR0aCpuLnRvLngsb3V0ZXJIZWlnaHQ6cy5oZWlnaHQqbi50by55LG91dGVyV2lkdGg6cy53aWR0aCpuLnRvLnh9O24uZnJvbS55IT09bi50by55JiYobz10LmVmZmVjdHMuc2V0VHJhbnNpdGlvbihpLGgsbi5mcm9tLnksbyksYT10LmVmZmVjdHMuc2V0VHJhbnNpdGlvbihpLGgsbi50by55LGEpKSxuLmZyb20ueCE9PW4udG8ueCYmKG89dC5lZmZlY3RzLnNldFRyYW5zaXRpb24oaSxsLG4uZnJvbS54LG8pLGE9dC5lZmZlY3RzLnNldFRyYW5zaXRpb24oaSxsLG4udG8ueCxhKSksdSYmdC5lZmZlY3RzLnNhdmVTdHlsZShpKSxpLmNzcyhvKSxpLmFuaW1hdGUoYSxlLmR1cmF0aW9uLGUuZWFzaW5nLGZ1bmN0aW9uKCl7dSYmdC5lZmZlY3RzLnJlc3RvcmVTdHlsZShpKX0pfSkpLGEuYW5pbWF0ZSh2LHtxdWV1ZTohMSxkdXJhdGlvbjplLmR1cmF0aW9uLGVhc2luZzplLmVhc2luZyxjb21wbGV0ZTpmdW5jdGlvbigpe3ZhciBlPWEub2Zmc2V0KCk7MD09PXYub3BhY2l0eSYmYS5jc3MoIm9wYWNpdHkiLF8ub3BhY2l0eSksdXx8KGEuY3NzKCJwb3NpdGlvbiIsInN0YXRpYyI9PT1mPyJyZWxhdGl2ZSI6Zikub2Zmc2V0KGUpLHQuZWZmZWN0cy5zYXZlU3R5bGUoYSkpLGkoKX19KX0pLHQuZWZmZWN0cy5kZWZpbmUoInNjYWxlIixmdW5jdGlvbihlLGkpe3ZhciBzPXQodGhpcyksbj1lLm1vZGUsbz1wYXJzZUludChlLnBlcmNlbnQsMTApfHwoMD09PXBhcnNlSW50KGUucGVyY2VudCwxMCk/MDoiZWZmZWN0IiE9PW4/MDoxMDApLGE9dC5leHRlbmQoITAse2Zyb206dC5lZmZlY3RzLnNjYWxlZERpbWVuc2lvbnMocyksdG86dC5lZmZlY3RzLnNjYWxlZERpbWVuc2lvbnMocyxvLGUuZGlyZWN0aW9ufHwiYm90aCIpLG9yaWdpbjplLm9yaWdpbnx8WyJtaWRkbGUiLCJjZW50ZXIiXX0sZSk7ZS5mYWRlJiYoYS5mcm9tLm9wYWNpdHk9MSxhLnRvLm9wYWNpdHk9MCksdC5lZmZlY3RzLmVmZmVjdC5zaXplLmNhbGwodGhpcyxhLGkpfSksdC5lZmZlY3RzLmRlZmluZSgicHVmZiIsImhpZGUiLGZ1bmN0aW9uKGUsaSl7dmFyIHM9dC5leHRlbmQoITAse30sZSx7ZmFkZTohMCxwZXJjZW50OnBhcnNlSW50KGUucGVyY2VudCwxMCl8fDE1MH0pO3QuZWZmZWN0cy5lZmZlY3Quc2NhbGUuY2FsbCh0aGlzLHMsaSl9KSx0LmVmZmVjdHMuZGVmaW5lKCJwdWxzYXRlIiwic2hvdyIsZnVuY3Rpb24oZSxpKXt2YXIgcz10KHRoaXMpLG49ZS5tb2RlLG89InNob3ciPT09bixhPSJoaWRlIj09PW4scj1vfHxhLGg9MiooZS50aW1lc3x8NSkrKHI/MTowKSxsPWUuZHVyYXRpb24vaCxjPTAsdT0xLGQ9cy5xdWV1ZSgpLmxlbmd0aDtmb3IoKG98fCFzLmlzKCI6dmlzaWJsZSIpKSYmKHMuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCksYz0xKTtoPnU7dSsrKXMuYW5pbWF0ZSh7b3BhY2l0eTpjfSxsLGUuZWFzaW5nKSxjPTEtYztzLmFuaW1hdGUoe29wYWNpdHk6Y30sbCxlLmVhc2luZykscy5xdWV1ZShpKSx0LmVmZmVjdHMudW5zaGlmdChzLGQsaCsxKX0pLHQuZWZmZWN0cy5kZWZpbmUoInNoYWtlIixmdW5jdGlvbihlLGkpe3ZhciBzPTEsbj10KHRoaXMpLG89ZS5kaXJlY3Rpb258fCJsZWZ0IixhPWUuZGlzdGFuY2V8fDIwLHI9ZS50aW1lc3x8MyxoPTIqcisxLGw9TWF0aC5yb3VuZChlLmR1cmF0aW9uL2gpLGM9InVwIj09PW98fCJkb3duIj09PW8/InRvcCI6ImxlZnQiLHU9InVwIj09PW98fCJsZWZ0Ij09PW8sZD17fSxwPXt9LGY9e30sZz1uLnF1ZXVlKCkubGVuZ3RoO2Zvcih0LmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIobiksZFtjXT0odT8iLT0iOiIrPSIpK2EscFtjXT0odT8iKz0iOiItPSIpKzIqYSxmW2NdPSh1PyItPSI6Iis9IikrMiphLG4uYW5pbWF0ZShkLGwsZS5lYXNpbmcpO3I+cztzKyspbi5hbmltYXRlKHAsbCxlLmVhc2luZykuYW5pbWF0ZShmLGwsZS5lYXNpbmcpO24uYW5pbWF0ZShwLGwsZS5lYXNpbmcpLmFuaW1hdGUoZCxsLzIsZS5lYXNpbmcpLnF1ZXVlKGkpLHQuZWZmZWN0cy51bnNoaWZ0KG4sZyxoKzEpfSksdC5lZmZlY3RzLmRlZmluZSgic2xpZGUiLCJzaG93IixmdW5jdGlvbihlLGkpe3ZhciBzLG4sbz10KHRoaXMpLGE9e3VwOlsiYm90dG9tIiwidG9wIl0sZG93bjpbInRvcCIsImJvdHRvbSJdLGxlZnQ6WyJyaWdodCIsImxlZnQiXSxyaWdodDpbImxlZnQiLCJyaWdodCJdfSxyPWUubW9kZSxoPWUuZGlyZWN0aW9ufHwibGVmdCIsbD0idXAiPT09aHx8ImRvd24iPT09aD8idG9wIjoibGVmdCIsYz0idXAiPT09aHx8ImxlZnQiPT09aCx1PWUuZGlzdGFuY2V8fG9bInRvcCI9PT1sPyJvdXRlckhlaWdodCI6Im91dGVyV2lkdGgiXSghMCksZD17fTt0LmVmZmVjdHMuY3JlYXRlUGxhY2Vob2xkZXIobykscz1vLmNzc0NsaXAoKSxuPW8ucG9zaXRpb24oKVtsXSxkW2xdPShjPy0xOjEpKnUrbixkLmNsaXA9by5jc3NDbGlwKCksZC5jbGlwW2FbaF1bMV1dPWQuY2xpcFthW2hdWzBdXSwic2hvdyI9PT1yJiYoby5jc3NDbGlwKGQuY2xpcCksby5jc3MobCxkW2xdKSxkLmNsaXA9cyxkW2xdPW4pLG8uYW5pbWF0ZShkLHtxdWV1ZTohMSxkdXJhdGlvbjplLmR1cmF0aW9uLGVhc2luZzplLmVhc2luZyxjb21wbGV0ZTppfSl9KTt2YXIgZjt0LnVpQmFja0NvbXBhdCE9PSExJiYoZj10LmVmZmVjdHMuZGVmaW5lKCJ0cmFuc2ZlciIsZnVuY3Rpb24oZSxpKXt0KHRoaXMpLnRyYW5zZmVyKGUsaSl9KSksdC51aS5mb2N1c2FibGU9ZnVuY3Rpb24oaSxzKXt2YXIgbixvLGEscixoLGw9aS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO3JldHVybiJhcmVhIj09PWw/KG49aS5wYXJlbnROb2RlLG89bi5uYW1lLGkuaHJlZiYmbyYmIm1hcCI9PT1uLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk/KGE9dCgiaW1nW3VzZW1hcD0nIyIrbysiJ10iKSxhLmxlbmd0aD4wJiZhLmlzKCI6dmlzaWJsZSIpKTohMSk6KC9eKGlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b258b2JqZWN0KSQvLnRlc3QobCk/KHI9IWkuZGlzYWJsZWQsciYmKGg9dChpKS5jbG9zZXN0KCJmaWVsZHNldCIpWzBdLGgmJihyPSFoLmRpc2FibGVkKSkpOnI9ImEiPT09bD9pLmhyZWZ8fHM6cyxyJiZ0KGkpLmlzKCI6dmlzaWJsZSIpJiZlKHQoaSkpKX0sdC5leHRlbmQodC5leHByWyI6Il0se2ZvY3VzYWJsZTpmdW5jdGlvbihlKXtyZXR1cm4gdC51aS5mb2N1c2FibGUoZSxudWxsIT10LmF0dHIoZSwidGFiaW5kZXgiKSl9fSksdC51aS5mb2N1c2FibGUsdC5mbi5mb3JtPWZ1bmN0aW9uKCl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0aGlzWzBdLmZvcm0/dGhpcy5jbG9zZXN0KCJmb3JtIik6dCh0aGlzWzBdLmZvcm0pfSx0LnVpLmZvcm1SZXNldE1peGluPXtfZm9ybVJlc2V0SGFuZGxlcjpmdW5jdGlvbigpe3ZhciBlPXQodGhpcyk7c2V0VGltZW91dChmdW5jdGlvbigpe3ZhciBpPWUuZGF0YSgidWktZm9ybS1yZXNldC1pbnN0YW5jZXMiKTt0LmVhY2goaSxmdW5jdGlvbigpe3RoaXMucmVmcmVzaCgpfSl9KX0sX2JpbmRGb3JtUmVzZXRIYW5kbGVyOmZ1bmN0aW9uKCl7aWYodGhpcy5mb3JtPXRoaXMuZWxlbWVudC5mb3JtKCksdGhpcy5mb3JtLmxlbmd0aCl7dmFyIHQ9dGhpcy5mb3JtLmRhdGEoInVpLWZvcm0tcmVzZXQtaW5zdGFuY2VzIil8fFtdO3QubGVuZ3RofHx0aGlzLmZvcm0ub24oInJlc2V0LnVpLWZvcm0tcmVzZXQiLHRoaXMuX2Zvcm1SZXNldEhhbmRsZXIpLHQucHVzaCh0aGlzKSx0aGlzLmZvcm0uZGF0YSgidWktZm9ybS1yZXNldC1pbnN0YW5jZXMiLHQpfX0sX3VuYmluZEZvcm1SZXNldEhhbmRsZXI6ZnVuY3Rpb24oKXtpZih0aGlzLmZvcm0ubGVuZ3RoKXt2YXIgZT10aGlzLmZvcm0uZGF0YSgidWktZm9ybS1yZXNldC1pbnN0YW5jZXMiKTtlLnNwbGljZSh0LmluQXJyYXkodGhpcyxlKSwxKSxlLmxlbmd0aD90aGlzLmZvcm0uZGF0YSgidWktZm9ybS1yZXNldC1pbnN0YW5jZXMiLGUpOnRoaXMuZm9ybS5yZW1vdmVEYXRhKCJ1aS1mb3JtLXJlc2V0LWluc3RhbmNlcyIpLm9mZigicmVzZXQudWktZm9ybS1yZXNldCIpfX19LCIxLjciPT09dC5mbi5qcXVlcnkuc3Vic3RyaW5nKDAsMykmJih0LmVhY2goWyJXaWR0aCIsIkhlaWdodCJdLGZ1bmN0aW9uKGUsaSl7ZnVuY3Rpb24gcyhlLGkscyxvKXtyZXR1cm4gdC5lYWNoKG4sZnVuY3Rpb24oKXtpLT1wYXJzZUZsb2F0KHQuY3NzKGUsInBhZGRpbmciK3RoaXMpKXx8MCxzJiYoaS09cGFyc2VGbG9hdCh0LmNzcyhlLCJib3JkZXIiK3RoaXMrIldpZHRoIikpfHwwKSxvJiYoaS09cGFyc2VGbG9hdCh0LmNzcyhlLCJtYXJnaW4iK3RoaXMpKXx8MCl9KSxpfXZhciBuPSJXaWR0aCI9PT1pP1siTGVmdCIsIlJpZ2h0Il06WyJUb3AiLCJCb3R0b20iXSxvPWkudG9Mb3dlckNhc2UoKSxhPXtpbm5lcldpZHRoOnQuZm4uaW5uZXJXaWR0aCxpbm5lckhlaWdodDp0LmZuLmlubmVySGVpZ2h0LG91dGVyV2lkdGg6dC5mbi5vdXRlcldpZHRoLG91dGVySGVpZ2h0OnQuZm4ub3V0ZXJIZWlnaHR9O3QuZm5bImlubmVyIitpXT1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT9hWyJpbm5lciIraV0uY2FsbCh0aGlzKTp0aGlzLmVhY2goZnVuY3Rpb24oKXt0KHRoaXMpLmNzcyhvLHModGhpcyxlKSsicHgiKX0pfSx0LmZuWyJvdXRlciIraV09ZnVuY3Rpb24oZSxuKXtyZXR1cm4ibnVtYmVyIiE9dHlwZW9mIGU/YVsib3V0ZXIiK2ldLmNhbGwodGhpcyxlKTp0aGlzLmVhY2goZnVuY3Rpb24oKXt0KHRoaXMpLmNzcyhvLHModGhpcyxlLCEwLG4pKyJweCIpfSl9fSksdC5mbi5hZGRCYWNrPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmFkZChudWxsPT10P3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKHQpKX0pLHQudWkua2V5Q29kZT17QkFDS1NQQUNFOjgsQ09NTUE6MTg4LERFTEVURTo0NixET1dOOjQwLEVORDozNSxFTlRFUjoxMyxFU0NBUEU6MjcsSE9NRTozNixMRUZUOjM3LFBBR0VfRE9XTjozNCxQQUdFX1VQOjMzLFBFUklPRDoxOTAsUklHSFQ6MzksU1BBQ0U6MzIsVEFCOjksVVA6Mzh9LHQudWkuZXNjYXBlU2VsZWN0b3I9ZnVuY3Rpb24oKXt2YXIgdD0vKFshIiMkJSYnKCkqKywuLzo7PD0+P0BbXF1eYHt8fX5dKS9nO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5yZXBsYWNlKHQsIlxcJDEiKX19KCksdC5mbi5sYWJlbHM9ZnVuY3Rpb24oKXt2YXIgZSxpLHMsbixvO3JldHVybiB0aGlzWzBdLmxhYmVscyYmdGhpc1swXS5sYWJlbHMubGVuZ3RoP3RoaXMucHVzaFN0YWNrKHRoaXNbMF0ubGFiZWxzKToobj10aGlzLmVxKDApLnBhcmVudHMoImxhYmVsIikscz10aGlzLmF0dHIoImlkIikscyYmKGU9dGhpcy5lcSgwKS5wYXJlbnRzKCkubGFzdCgpLG89ZS5hZGQoZS5sZW5ndGg/ZS5zaWJsaW5ncygpOnRoaXMuc2libGluZ3MoKSksaT0ibGFiZWxbZm9yPSciK3QudWkuZXNjYXBlU2VsZWN0b3IocykrIiddIixuPW4uYWRkKG8uZmluZChpKS5hZGRCYWNrKGkpKSksdGhpcy5wdXNoU3RhY2sobikpfSx0LmZuLnNjcm9sbFBhcmVudD1mdW5jdGlvbihlKXt2YXIgaT10aGlzLmNzcygicG9zaXRpb24iKSxzPSJhYnNvbHV0ZSI9PT1pLG49ZT8vKGF1dG98c2Nyb2xsfGhpZGRlbikvOi8oYXV0b3xzY3JvbGwpLyxvPXRoaXMucGFyZW50cygpLmZpbHRlcihmdW5jdGlvbigpe3ZhciBlPXQodGhpcyk7cmV0dXJuIHMmJiJzdGF0aWMiPT09ZS5jc3MoInBvc2l0aW9uIik/ITE6bi50ZXN0KGUuY3NzKCJvdmVyZmxvdyIpK2UuY3NzKCJvdmVyZmxvdy15IikrZS5jc3MoIm92ZXJmbG93LXgiKSl9KS5lcSgwKTtyZXR1cm4iZml4ZWQiIT09aSYmby5sZW5ndGg/bzp0KHRoaXNbMF0ub3duZXJEb2N1bWVudHx8ZG9jdW1lbnQpfSx0LmV4dGVuZCh0LmV4cHJbIjoiXSx7dGFiYmFibGU6ZnVuY3Rpb24oZSl7dmFyIGk9dC5hdHRyKGUsInRhYmluZGV4Iikscz1udWxsIT1pO3JldHVybighc3x8aT49MCkmJnQudWkuZm9jdXNhYmxlKGUscyl9fSksdC5mbi5leHRlbmQoe3VuaXF1ZUlkOmZ1bmN0aW9uKCl7dmFyIHQ9MDtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dGhpcy5pZHx8KHRoaXMuaWQ9InVpLWlkLSIrICsrdCl9KX19KCkscmVtb3ZlVW5pcXVlSWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7L151aS1pZC1cZCskLy50ZXN0KHRoaXMuaWQpJiZ0KHRoaXMpLnJlbW92ZUF0dHIoImlkIil9KX19KSx0LndpZGdldCgidWkuYWNjb3JkaW9uIix7dmVyc2lvbjoiMS4xMi4xIixvcHRpb25zOnthY3RpdmU6MCxhbmltYXRlOnt9LGNsYXNzZXM6eyJ1aS1hY2NvcmRpb24taGVhZGVyIjoidWktY29ybmVyLXRvcCIsInVpLWFjY29yZGlvbi1oZWFkZXItY29sbGFwc2VkIjoidWktY29ybmVyLWFsbCIsInVpLWFjY29yZGlvbi1jb250ZW50IjoidWktY29ybmVyLWJvdHRvbSJ9LGNvbGxhcHNpYmxlOiExLGV2ZW50OiJjbGljayIsaGVhZGVyOiI+IGxpID4gOmZpcnN0LWNoaWxkLCA+IDpub3QobGkpOmV2ZW4iLGhlaWdodFN0eWxlOiJhdXRvIixpY29uczp7YWN0aXZlSGVhZGVyOiJ1aS1pY29uLXRyaWFuZ2xlLTEtcyIsaGVhZGVyOiJ1aS1pY29uLXRyaWFuZ2xlLTEtZSJ9LGFjdGl2YXRlOm51bGwsYmVmb3JlQWN0aXZhdGU6bnVsbH0saGlkZVByb3BzOntib3JkZXJUb3BXaWR0aDoiaGlkZSIsYm9yZGVyQm90dG9tV2lkdGg6ImhpZGUiLHBhZGRpbmdUb3A6ImhpZGUiLHBhZGRpbmdCb3R0b206ImhpZGUiLGhlaWdodDoiaGlkZSJ9LHNob3dQcm9wczp7Ym9yZGVyVG9wV2lkdGg6InNob3ciLGJvcmRlckJvdHRvbVdpZHRoOiJzaG93IixwYWRkaW5nVG9wOiJzaG93IixwYWRkaW5nQm90dG9tOiJzaG93IixoZWlnaHQ6InNob3cifSxfY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zO3RoaXMucHJldlNob3c9dGhpcy5wcmV2SGlkZT10KCksdGhpcy5fYWRkQ2xhc3MoInVpLWFjY29yZGlvbiIsInVpLXdpZGdldCB1aS1oZWxwZXItcmVzZXQiKSx0aGlzLmVsZW1lbnQuYXR0cigicm9sZSIsInRhYmxpc3QiKSxlLmNvbGxhcHNpYmxlfHxlLmFjdGl2ZSE9PSExJiZudWxsIT1lLmFjdGl2ZXx8KGUuYWN0aXZlPTApLHRoaXMuX3Byb2Nlc3NQYW5lbHMoKSwwPmUuYWN0aXZlJiYoZS5hY3RpdmUrPXRoaXMuaGVhZGVycy5sZW5ndGgpLHRoaXMuX3JlZnJlc2goKX0sX2dldENyZWF0ZUV2ZW50RGF0YTpmdW5jdGlvbigpe3JldHVybntoZWFkZXI6dGhpcy5hY3RpdmUscGFuZWw6dGhpcy5hY3RpdmUubGVuZ3RoP3RoaXMuYWN0aXZlLm5leHQoKTp0KCl9fSxfY3JlYXRlSWNvbnM6ZnVuY3Rpb24oKXt2YXIgZSxpLHM9dGhpcy5vcHRpb25zLmljb25zO3MmJihlPXQoIjxzcGFuPiIpLHRoaXMuX2FkZENsYXNzKGUsInVpLWFjY29yZGlvbi1oZWFkZXItaWNvbiIsInVpLWljb24gIitzLmhlYWRlciksZS5wcmVwZW5kVG8odGhpcy5oZWFkZXJzKSxpPXRoaXMuYWN0aXZlLmNoaWxkcmVuKCIudWktYWNjb3JkaW9uLWhlYWRlci1pY29uIiksdGhpcy5fcmVtb3ZlQ2xhc3MoaSxzLmhlYWRlcikuX2FkZENsYXNzKGksbnVsbCxzLmFjdGl2ZUhlYWRlcikuX2FkZENsYXNzKHRoaXMuaGVhZGVycywidWktYWNjb3JkaW9uLWljb25zIikpfSxfZGVzdHJveUljb25zOmZ1bmN0aW9uKCl7dGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5oZWFkZXJzLCJ1aS1hY2NvcmRpb24taWNvbnMiKSx0aGlzLmhlYWRlcnMuY2hpbGRyZW4oIi51aS1hY2NvcmRpb24taGVhZGVyLWljb24iKS5yZW1vdmUoKX0sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgdDt0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cigicm9sZSIpLHRoaXMuaGVhZGVycy5yZW1vdmVBdHRyKCJyb2xlIGFyaWEtZXhwYW5kZWQgYXJpYS1zZWxlY3RlZCBhcmlhLWNvbnRyb2xzIHRhYkluZGV4IikucmVtb3ZlVW5pcXVlSWQoKSx0aGlzLl9kZXN0cm95SWNvbnMoKSx0PXRoaXMuaGVhZGVycy5uZXh0KCkuY3NzKCJkaXNwbGF5IiwiIikucmVtb3ZlQXR0cigicm9sZSBhcmlhLWhpZGRlbiBhcmlhLWxhYmVsbGVkYnkiKS5yZW1vdmVVbmlxdWVJZCgpLCJjb250ZW50IiE9PXRoaXMub3B0aW9ucy5oZWlnaHRTdHlsZSYmdC5jc3MoImhlaWdodCIsIiIpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKHQsZSl7cmV0dXJuImFjdGl2ZSI9PT10Pyh0aGlzLl9hY3RpdmF0ZShlKSx2b2lkIDApOigiZXZlbnQiPT09dCYmKHRoaXMub3B0aW9ucy5ldmVudCYmdGhpcy5fb2ZmKHRoaXMuaGVhZGVycyx0aGlzLm9wdGlvbnMuZXZlbnQpLHRoaXMuX3NldHVwRXZlbnRzKGUpKSx0aGlzLl9zdXBlcih0LGUpLCJjb2xsYXBzaWJsZSIhPT10fHxlfHx0aGlzLm9wdGlvbnMuYWN0aXZlIT09ITF8fHRoaXMuX2FjdGl2YXRlKDApLCJpY29ucyI9PT10JiYodGhpcy5fZGVzdHJveUljb25zKCksZSYmdGhpcy5fY3JlYXRlSWNvbnMoKSksdm9pZCAwKX0sX3NldE9wdGlvbkRpc2FibGVkOmZ1bmN0aW9uKHQpe3RoaXMuX3N1cGVyKHQpLHRoaXMuZWxlbWVudC5hdHRyKCJhcmlhLWRpc2FibGVkIix0KSx0aGlzLl90b2dnbGVDbGFzcyhudWxsLCJ1aS1zdGF0ZS1kaXNhYmxlZCIsISF0KSx0aGlzLl90b2dnbGVDbGFzcyh0aGlzLmhlYWRlcnMuYWRkKHRoaXMuaGVhZGVycy5uZXh0KCkpLG51bGwsInVpLXN0YXRlLWRpc2FibGVkIiwhIXQpfSxfa2V5ZG93bjpmdW5jdGlvbihlKXtpZighZS5hbHRLZXkmJiFlLmN0cmxLZXkpe3ZhciBpPXQudWkua2V5Q29kZSxzPXRoaXMuaGVhZGVycy5sZW5ndGgsbj10aGlzLmhlYWRlcnMuaW5kZXgoZS50YXJnZXQpLG89ITE7c3dpdGNoKGUua2V5Q29kZSl7Y2FzZSBpLlJJR0hUOmNhc2UgaS5ET1dOOm89dGhpcy5oZWFkZXJzWyhuKzEpJXNdO2JyZWFrO2Nhc2UgaS5MRUZUOmNhc2UgaS5VUDpvPXRoaXMuaGVhZGVyc1sobi0xK3MpJXNdO2JyZWFrO2Nhc2UgaS5TUEFDRTpjYXNlIGkuRU5URVI6dGhpcy5fZXZlbnRIYW5kbGVyKGUpO2JyZWFrO2Nhc2UgaS5IT01FOm89dGhpcy5oZWFkZXJzWzBdO2JyZWFrO2Nhc2UgaS5FTkQ6bz10aGlzLmhlYWRlcnNbcy0xXX1vJiYodChlLnRhcmdldCkuYXR0cigidGFiSW5kZXgiLC0xKSx0KG8pLmF0dHIoInRhYkluZGV4IiwwKSx0KG8pLnRyaWdnZXIoImZvY3VzIiksZS5wcmV2ZW50RGVmYXVsdCgpKX19LF9wYW5lbEtleURvd246ZnVuY3Rpb24oZSl7ZS5rZXlDb2RlPT09dC51aS5rZXlDb2RlLlVQJiZlLmN0cmxLZXkmJnQoZS5jdXJyZW50VGFyZ2V0KS5wcmV2KCkudHJpZ2dlcigiZm9jdXMiKX0scmVmcmVzaDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9uczt0aGlzLl9wcm9jZXNzUGFuZWxzKCksZS5hY3RpdmU9PT0hMSYmZS5jb2xsYXBzaWJsZT09PSEwfHwhdGhpcy5oZWFkZXJzLmxlbmd0aD8oZS5hY3RpdmU9ITEsdGhpcy5hY3RpdmU9dCgpKTplLmFjdGl2ZT09PSExP3RoaXMuX2FjdGl2YXRlKDApOnRoaXMuYWN0aXZlLmxlbmd0aCYmIXQuY29udGFpbnModGhpcy5lbGVtZW50WzBdLHRoaXMuYWN0aXZlWzBdKT90aGlzLmhlYWRlcnMubGVuZ3RoPT09dGhpcy5oZWFkZXJzLmZpbmQoIi51aS1zdGF0ZS1kaXNhYmxlZCIpLmxlbmd0aD8oZS5hY3RpdmU9ITEsdGhpcy5hY3RpdmU9dCgpKTp0aGlzLl9hY3RpdmF0ZShNYXRoLm1heCgwLGUuYWN0aXZlLTEpKTplLmFjdGl2ZT10aGlzLmhlYWRlcnMuaW5kZXgodGhpcy5hY3RpdmUpLHRoaXMuX2Rlc3Ryb3lJY29ucygpLHRoaXMuX3JlZnJlc2goKX0sX3Byb2Nlc3NQYW5lbHM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmhlYWRlcnMsZT10aGlzLnBhbmVsczt0aGlzLmhlYWRlcnM9dGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLmhlYWRlciksdGhpcy5fYWRkQ2xhc3ModGhpcy5oZWFkZXJzLCJ1aS1hY2NvcmRpb24taGVhZGVyIHVpLWFjY29yZGlvbi1oZWFkZXItY29sbGFwc2VkIiwidWktc3RhdGUtZGVmYXVsdCIpLHRoaXMucGFuZWxzPXRoaXMuaGVhZGVycy5uZXh0KCkuZmlsdGVyKCI6bm90KC51aS1hY2NvcmRpb24tY29udGVudC1hY3RpdmUpIikuaGlkZSgpLHRoaXMuX2FkZENsYXNzKHRoaXMucGFuZWxzLCJ1aS1hY2NvcmRpb24tY29udGVudCIsInVpLWhlbHBlci1yZXNldCB1aS13aWRnZXQtY29udGVudCIpLGUmJih0aGlzLl9vZmYodC5ub3QodGhpcy5oZWFkZXJzKSksdGhpcy5fb2ZmKGUubm90KHRoaXMucGFuZWxzKSkpfSxfcmVmcmVzaDpmdW5jdGlvbigpe3ZhciBlLGk9dGhpcy5vcHRpb25zLHM9aS5oZWlnaHRTdHlsZSxuPXRoaXMuZWxlbWVudC5wYXJlbnQoKTt0aGlzLmFjdGl2ZT10aGlzLl9maW5kQWN0aXZlKGkuYWN0aXZlKSx0aGlzLl9hZGRDbGFzcyh0aGlzLmFjdGl2ZSwidWktYWNjb3JkaW9uLWhlYWRlci1hY3RpdmUiLCJ1aS1zdGF0ZS1hY3RpdmUiKS5fcmVtb3ZlQ2xhc3ModGhpcy5hY3RpdmUsInVpLWFjY29yZGlvbi1oZWFkZXItY29sbGFwc2VkIiksdGhpcy5fYWRkQ2xhc3ModGhpcy5hY3RpdmUubmV4dCgpLCJ1aS1hY2NvcmRpb24tY29udGVudC1hY3RpdmUiKSx0aGlzLmFjdGl2ZS5uZXh0KCkuc2hvdygpLHRoaXMuaGVhZGVycy5hdHRyKCJyb2xlIiwidGFiIikuZWFjaChmdW5jdGlvbigpe3ZhciBlPXQodGhpcyksaT1lLnVuaXF1ZUlkKCkuYXR0cigiaWQiKSxzPWUubmV4dCgpLG49cy51bmlxdWVJZCgpLmF0dHIoImlkIik7ZS5hdHRyKCJhcmlhLWNvbnRyb2xzIixuKSxzLmF0dHIoImFyaWEtbGFiZWxsZWRieSIsaSl9KS5uZXh0KCkuYXR0cigicm9sZSIsInRhYnBhbmVsIiksdGhpcy5oZWFkZXJzLm5vdCh0aGlzLmFjdGl2ZSkuYXR0cih7ImFyaWEtc2VsZWN0ZWQiOiJmYWxzZSIsImFyaWEtZXhwYW5kZWQiOiJmYWxzZSIsdGFiSW5kZXg6LTF9KS5uZXh0KCkuYXR0cih7ImFyaWEtaGlkZGVuIjoidHJ1ZSJ9KS5oaWRlKCksdGhpcy5hY3RpdmUubGVuZ3RoP3RoaXMuYWN0aXZlLmF0dHIoeyJhcmlhLXNlbGVjdGVkIjoidHJ1ZSIsImFyaWEtZXhwYW5kZWQiOiJ0cnVlIix0YWJJbmRleDowfSkubmV4dCgpLmF0dHIoeyJhcmlhLWhpZGRlbiI6ImZhbHNlIn0pOnRoaXMuaGVhZGVycy5lcSgwKS5hdHRyKCJ0YWJJbmRleCIsMCksdGhpcy5fY3JlYXRlSWNvbnMoKSx0aGlzLl9zZXR1cEV2ZW50cyhpLmV2ZW50KSwiZmlsbCI9PT1zPyhlPW4uaGVpZ2h0KCksdGhpcy5lbGVtZW50LnNpYmxpbmdzKCI6dmlzaWJsZSIpLmVhY2goZnVuY3Rpb24oKXt2YXIgaT10KHRoaXMpLHM9aS5jc3MoInBvc2l0aW9uIik7ImFic29sdXRlIiE9PXMmJiJmaXhlZCIhPT1zJiYoZS09aS5vdXRlckhlaWdodCghMCkpfSksdGhpcy5oZWFkZXJzLmVhY2goZnVuY3Rpb24oKXtlLT10KHRoaXMpLm91dGVySGVpZ2h0KCEwKX0pLHRoaXMuaGVhZGVycy5uZXh0KCkuZWFjaChmdW5jdGlvbigpe3QodGhpcykuaGVpZ2h0KE1hdGgubWF4KDAsZS10KHRoaXMpLmlubmVySGVpZ2h0KCkrdCh0aGlzKS5oZWlnaHQoKSkpfSkuY3NzKCJvdmVyZmxvdyIsImF1dG8iKSk6ImF1dG8iPT09cyYmKGU9MCx0aGlzLmhlYWRlcnMubmV4dCgpLmVhY2goZnVuY3Rpb24oKXt2YXIgaT10KHRoaXMpLmlzKCI6dmlzaWJsZSIpO2l8fHQodGhpcykuc2hvdygpLGU9TWF0aC5tYXgoZSx0KHRoaXMpLmNzcygiaGVpZ2h0IiwiIikuaGVpZ2h0KCkpLGl8fHQodGhpcykuaGlkZSgpfSkuaGVpZ2h0KGUpKX0sX2FjdGl2YXRlOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX2ZpbmRBY3RpdmUoZSlbMF07aSE9PXRoaXMuYWN0aXZlWzBdJiYoaT1pfHx0aGlzLmFjdGl2ZVswXSx0aGlzLl9ldmVudEhhbmRsZXIoe3RhcmdldDppLGN1cnJlbnRUYXJnZXQ6aSxwcmV2ZW50RGVmYXVsdDp0Lm5vb3B9KSl9LF9maW5kQWN0aXZlOmZ1bmN0aW9uKGUpe3JldHVybiJudW1iZXIiPT10eXBlb2YgZT90aGlzLmhlYWRlcnMuZXEoZSk6dCgpfSxfc2V0dXBFdmVudHM6ZnVuY3Rpb24oZSl7dmFyIGk9e2tleWRvd246Il9rZXlkb3duIn07ZSYmdC5lYWNoKGUuc3BsaXQoIiAiKSxmdW5jdGlvbih0LGUpe2lbZV09Il9ldmVudEhhbmRsZXIifSksdGhpcy5fb2ZmKHRoaXMuaGVhZGVycy5hZGQodGhpcy5oZWFkZXJzLm5leHQoKSkpLHRoaXMuX29uKHRoaXMuaGVhZGVycyxpKSx0aGlzLl9vbih0aGlzLmhlYWRlcnMubmV4dCgpLHtrZXlkb3duOiJfcGFuZWxLZXlEb3duIn0pLHRoaXMuX2hvdmVyYWJsZSh0aGlzLmhlYWRlcnMpLHRoaXMuX2ZvY3VzYWJsZSh0aGlzLmhlYWRlcnMpfSxfZXZlbnRIYW5kbGVyOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbj10aGlzLm9wdGlvbnMsbz10aGlzLmFjdGl2ZSxhPXQoZS5jdXJyZW50VGFyZ2V0KSxyPWFbMF09PT1vWzBdLGg9ciYmbi5jb2xsYXBzaWJsZSxsPWg/dCgpOmEubmV4dCgpLGM9by5uZXh0KCksdT17b2xkSGVhZGVyOm8sb2xkUGFuZWw6YyxuZXdIZWFkZXI6aD90KCk6YSxuZXdQYW5lbDpsfTtlLnByZXZlbnREZWZhdWx0KCksciYmIW4uY29sbGFwc2libGV8fHRoaXMuX3RyaWdnZXIoImJlZm9yZUFjdGl2YXRlIixlLHUpPT09ITF8fChuLmFjdGl2ZT1oPyExOnRoaXMuaGVhZGVycy5pbmRleChhKSx0aGlzLmFjdGl2ZT1yP3QoKTphLHRoaXMuX3RvZ2dsZSh1KSx0aGlzLl9yZW1vdmVDbGFzcyhvLCJ1aS1hY2NvcmRpb24taGVhZGVyLWFjdGl2ZSIsInVpLXN0YXRlLWFjdGl2ZSIpLG4uaWNvbnMmJihpPW8uY2hpbGRyZW4oIi51aS1hY2NvcmRpb24taGVhZGVyLWljb24iKSx0aGlzLl9yZW1vdmVDbGFzcyhpLG51bGwsbi5pY29ucy5hY3RpdmVIZWFkZXIpLl9hZGRDbGFzcyhpLG51bGwsbi5pY29ucy5oZWFkZXIpKSxyfHwodGhpcy5fcmVtb3ZlQ2xhc3MoYSwidWktYWNjb3JkaW9uLWhlYWRlci1jb2xsYXBzZWQiKS5fYWRkQ2xhc3MoYSwidWktYWNjb3JkaW9uLWhlYWRlci1hY3RpdmUiLCJ1aS1zdGF0ZS1hY3RpdmUiKSxuLmljb25zJiYocz1hLmNoaWxkcmVuKCIudWktYWNjb3JkaW9uLWhlYWRlci1pY29uIiksdGhpcy5fcmVtb3ZlQ2xhc3MocyxudWxsLG4uaWNvbnMuaGVhZGVyKS5fYWRkQ2xhc3MocyxudWxsLG4uaWNvbnMuYWN0aXZlSGVhZGVyKSksdGhpcy5fYWRkQ2xhc3MoYS5uZXh0KCksInVpLWFjY29yZGlvbi1jb250ZW50LWFjdGl2ZSIpKSl9LF90b2dnbGU6ZnVuY3Rpb24oZSl7dmFyIGk9ZS5uZXdQYW5lbCxzPXRoaXMucHJldlNob3cubGVuZ3RoP3RoaXMucHJldlNob3c6ZS5vbGRQYW5lbDt0aGlzLnByZXZTaG93LmFkZCh0aGlzLnByZXZIaWRlKS5zdG9wKCEwLCEwKSx0aGlzLnByZXZTaG93PWksdGhpcy5wcmV2SGlkZT1zLHRoaXMub3B0aW9ucy5hbmltYXRlP3RoaXMuX2FuaW1hdGUoaSxzLGUpOihzLmhpZGUoKSxpLnNob3coKSx0aGlzLl90b2dnbGVDb21wbGV0ZShlKSkscy5hdHRyKHsiYXJpYS1oaWRkZW4iOiJ0cnVlIn0pLHMucHJldigpLmF0dHIoeyJhcmlhLXNlbGVjdGVkIjoiZmFsc2UiLCJhcmlhLWV4cGFuZGVkIjoiZmFsc2UifSksaS5sZW5ndGgmJnMubGVuZ3RoP3MucHJldigpLmF0dHIoe3RhYkluZGV4Oi0xLCJhcmlhLWV4cGFuZGVkIjoiZmFsc2UifSk6aS5sZW5ndGgmJnRoaXMuaGVhZGVycy5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gMD09PXBhcnNlSW50KHQodGhpcykuYXR0cigidGFiSW5kZXgiKSwxMCl9KS5hdHRyKCJ0YWJJbmRleCIsLTEpLGkuYXR0cigiYXJpYS1oaWRkZW4iLCJmYWxzZSIpLnByZXYoKS5hdHRyKHsiYXJpYS1zZWxlY3RlZCI6InRydWUiLCJhcmlhLWV4cGFuZGVkIjoidHJ1ZSIsdGFiSW5kZXg6MH0pfSxfYW5pbWF0ZTpmdW5jdGlvbih0LGUsaSl7dmFyIHMsbixvLGE9dGhpcyxyPTAsaD10LmNzcygiYm94LXNpemluZyIpLGw9dC5sZW5ndGgmJighZS5sZW5ndGh8fHQuaW5kZXgoKTxlLmluZGV4KCkpLGM9dGhpcy5vcHRpb25zLmFuaW1hdGV8fHt9LHU9bCYmYy5kb3dufHxjLGQ9ZnVuY3Rpb24oKXthLl90b2dnbGVDb21wbGV0ZShpKX07cmV0dXJuIm51bWJlciI9PXR5cGVvZiB1JiYobz11KSwic3RyaW5nIj09dHlwZW9mIHUmJihuPXUpLG49bnx8dS5lYXNpbmd8fGMuZWFzaW5nLG89b3x8dS5kdXJhdGlvbnx8Yy5kdXJhdGlvbixlLmxlbmd0aD90Lmxlbmd0aD8ocz10LnNob3coKS5vdXRlckhlaWdodCgpLGUuYW5pbWF0ZSh0aGlzLmhpZGVQcm9wcyx7ZHVyYXRpb246byxlYXNpbmc6bixzdGVwOmZ1bmN0aW9uKHQsZSl7ZS5ub3c9TWF0aC5yb3VuZCh0KX19KSx0LmhpZGUoKS5hbmltYXRlKHRoaXMuc2hvd1Byb3BzLHtkdXJhdGlvbjpvLGVhc2luZzpuLGNvbXBsZXRlOmQsc3RlcDpmdW5jdGlvbih0LGkpe2kubm93PU1hdGgucm91bmQodCksImhlaWdodCIhPT1pLnByb3A/ImNvbnRlbnQtYm94Ij09PWgmJihyKz1pLm5vdyk6ImNvbnRlbnQiIT09YS5vcHRpb25zLmhlaWdodFN0eWxlJiYoaS5ub3c9TWF0aC5yb3VuZChzLWUub3V0ZXJIZWlnaHQoKS1yKSxyPTApfX0pLHZvaWQgMCk6ZS5hbmltYXRlKHRoaXMuaGlkZVByb3BzLG8sbixkKTp0LmFuaW1hdGUodGhpcy5zaG93UHJvcHMsbyxuLGQpfSxfdG9nZ2xlQ29tcGxldGU6ZnVuY3Rpb24odCl7dmFyIGU9dC5vbGRQYW5lbCxpPWUucHJldigpO3RoaXMuX3JlbW92ZUNsYXNzKGUsInVpLWFjY29yZGlvbi1jb250ZW50LWFjdGl2ZSIpLHRoaXMuX3JlbW92ZUNsYXNzKGksInVpLWFjY29yZGlvbi1oZWFkZXItYWN0aXZlIikuX2FkZENsYXNzKGksInVpLWFjY29yZGlvbi1oZWFkZXItY29sbGFwc2VkIiksZS5sZW5ndGgmJihlLnBhcmVudCgpWzBdLmNsYXNzTmFtZT1lLnBhcmVudCgpWzBdLmNsYXNzTmFtZSksdGhpcy5fdHJpZ2dlcigiYWN0aXZhdGUiLG51bGwsdCl9fSksdC51aS5zYWZlQWN0aXZlRWxlbWVudD1mdW5jdGlvbih0KXt2YXIgZTt0cnl7ZT10LmFjdGl2ZUVsZW1lbnR9Y2F0Y2goaSl7ZT10LmJvZHl9cmV0dXJuIGV8fChlPXQuYm9keSksZS5ub2RlTmFtZXx8KGU9dC5ib2R5KSxlfSx0LndpZGdldCgidWkubWVudSIse3ZlcnNpb246IjEuMTIuMSIsZGVmYXVsdEVsZW1lbnQ6Ijx1bD4iLGRlbGF5OjMwMCxvcHRpb25zOntpY29uczp7c3VibWVudToidWktaWNvbi1jYXJldC0xLWUifSxpdGVtczoiPiAqIixtZW51czoidWwiLHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJyaWdodCB0b3AifSxyb2xlOiJtZW51IixibHVyOm51bGwsZm9jdXM6bnVsbCxzZWxlY3Q6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuYWN0aXZlTWVudT10aGlzLmVsZW1lbnQsdGhpcy5tb3VzZUhhbmRsZWQ9ITEsdGhpcy5lbGVtZW50LnVuaXF1ZUlkKCkuYXR0cih7cm9sZTp0aGlzLm9wdGlvbnMucm9sZSx0YWJJbmRleDowfSksdGhpcy5fYWRkQ2xhc3MoInVpLW1lbnUiLCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQiKSx0aGlzLl9vbih7Im1vdXNlZG93biAudWktbWVudS1pdGVtIjpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCl9LCJjbGljayAudWktbWVudS1pdGVtIjpmdW5jdGlvbihlKXt2YXIgaT10KGUudGFyZ2V0KSxzPXQodC51aS5zYWZlQWN0aXZlRWxlbWVudCh0aGlzLmRvY3VtZW50WzBdKSk7IXRoaXMubW91c2VIYW5kbGVkJiZpLm5vdCgiLnVpLXN0YXRlLWRpc2FibGVkIikubGVuZ3RoJiYodGhpcy5zZWxlY3QoZSksZS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpfHwodGhpcy5tb3VzZUhhbmRsZWQ9ITApLGkuaGFzKCIudWktbWVudSIpLmxlbmd0aD90aGlzLmV4cGFuZChlKTohdGhpcy5lbGVtZW50LmlzKCI6Zm9jdXMiKSYmcy5jbG9zZXN0KCIudWktbWVudSIpLmxlbmd0aCYmKHRoaXMuZWxlbWVudC50cmlnZ2VyKCJmb2N1cyIsWyEwXSksdGhpcy5hY3RpdmUmJjE9PT10aGlzLmFjdGl2ZS5wYXJlbnRzKCIudWktbWVudSIpLmxlbmd0aCYmY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpKSl9LCJtb3VzZWVudGVyIC51aS1tZW51LWl0ZW0iOmZ1bmN0aW9uKGUpe2lmKCF0aGlzLnByZXZpb3VzRmlsdGVyKXt2YXIgaT10KGUudGFyZ2V0KS5jbG9zZXN0KCIudWktbWVudS1pdGVtIikscz10KGUuY3VycmVudFRhcmdldCk7aVswXT09PXNbMF0mJih0aGlzLl9yZW1vdmVDbGFzcyhzLnNpYmxpbmdzKCkuY2hpbGRyZW4oIi51aS1zdGF0ZS1hY3RpdmUiKSxudWxsLCJ1aS1zdGF0ZS1hY3RpdmUiKSx0aGlzLmZvY3VzKGUscykpfX0sbW91c2VsZWF2ZToiY29sbGFwc2VBbGwiLCJtb3VzZWxlYXZlIC51aS1tZW51IjoiY29sbGFwc2VBbGwiLGZvY3VzOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5hY3RpdmV8fHRoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5pdGVtcykuZXEoMCk7ZXx8dGhpcy5mb2N1cyh0LGkpfSxibHVyOmZ1bmN0aW9uKGUpe3RoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dmFyIGk9IXQuY29udGFpbnModGhpcy5lbGVtZW50WzBdLHQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSkpO2kmJnRoaXMuY29sbGFwc2VBbGwoZSl9KX0sa2V5ZG93bjoiX2tleWRvd24ifSksdGhpcy5yZWZyZXNoKCksdGhpcy5fb24odGhpcy5kb2N1bWVudCx7Y2xpY2s6ZnVuY3Rpb24odCl7dGhpcy5fY2xvc2VPbkRvY3VtZW50Q2xpY2sodCkmJnRoaXMuY29sbGFwc2VBbGwodCksdGhpcy5tb3VzZUhhbmRsZWQ9ITF9fSl9LF9kZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5lbGVtZW50LmZpbmQoIi51aS1tZW51LWl0ZW0iKS5yZW1vdmVBdHRyKCJyb2xlIGFyaWEtZGlzYWJsZWQiKSxpPWUuY2hpbGRyZW4oIi51aS1tZW51LWl0ZW0td3JhcHBlciIpLnJlbW92ZVVuaXF1ZUlkKCkucmVtb3ZlQXR0cigidGFiSW5kZXggcm9sZSBhcmlhLWhhc3BvcHVwIik7dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoImFyaWEtYWN0aXZlZGVzY2VuZGFudCIpLmZpbmQoIi51aS1tZW51IikuYWRkQmFjaygpLnJlbW92ZUF0dHIoInJvbGUgYXJpYS1sYWJlbGxlZGJ5IGFyaWEtZXhwYW5kZWQgYXJpYS1oaWRkZW4gYXJpYS1kaXNhYmxlZCB0YWJJbmRleCIpLnJlbW92ZVVuaXF1ZUlkKCkuc2hvdygpLGkuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzKTtlLmRhdGEoInVpLW1lbnUtc3VibWVudS1jYXJldCIpJiZlLnJlbW92ZSgpfSl9LF9rZXlkb3duOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbixvLGE9ITA7c3dpdGNoKGUua2V5Q29kZSl7Y2FzZSB0LnVpLmtleUNvZGUuUEFHRV9VUDp0aGlzLnByZXZpb3VzUGFnZShlKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5QQUdFX0RPV046dGhpcy5uZXh0UGFnZShlKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5IT01FOnRoaXMuX21vdmUoImZpcnN0IiwiZmlyc3QiLGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLkVORDp0aGlzLl9tb3ZlKCJsYXN0IiwibGFzdCIsZSk7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuVVA6dGhpcy5wcmV2aW91cyhlKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5ET1dOOnRoaXMubmV4dChlKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5MRUZUOnRoaXMuY29sbGFwc2UoZSk7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuUklHSFQ6dGhpcy5hY3RpdmUmJiF0aGlzLmFjdGl2ZS5pcygiLnVpLXN0YXRlLWRpc2FibGVkIikmJnRoaXMuZXhwYW5kKGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLkVOVEVSOmNhc2UgdC51aS5rZXlDb2RlLlNQQUNFOnRoaXMuX2FjdGl2YXRlKGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLkVTQ0FQRTp0aGlzLmNvbGxhcHNlKGUpO2JyZWFrO2RlZmF1bHQ6YT0hMSxzPXRoaXMucHJldmlvdXNGaWx0ZXJ8fCIiLG89ITEsbj1lLmtleUNvZGU+PTk2JiYxMDU+PWUua2V5Q29kZT8iIisoZS5rZXlDb2RlLTk2KTpTdHJpbmcuZnJvbUNoYXJDb2RlKGUua2V5Q29kZSksY2xlYXJUaW1lb3V0KHRoaXMuZmlsdGVyVGltZXIpLG49PT1zP289ITA6bj1zK24saT10aGlzLl9maWx0ZXJNZW51SXRlbXMobiksaT1vJiYtMSE9PWkuaW5kZXgodGhpcy5hY3RpdmUubmV4dCgpKT90aGlzLmFjdGl2ZS5uZXh0QWxsKCIudWktbWVudS1pdGVtIik6aSxpLmxlbmd0aHx8KG49U3RyaW5nLmZyb21DaGFyQ29kZShlLmtleUNvZGUpLGk9dGhpcy5fZmlsdGVyTWVudUl0ZW1zKG4pKSxpLmxlbmd0aD8odGhpcy5mb2N1cyhlLGkpLHRoaXMucHJldmlvdXNGaWx0ZXI9bix0aGlzLmZpbHRlclRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7ZGVsZXRlIHRoaXMucHJldmlvdXNGaWx0ZXJ9LDFlMykpOmRlbGV0ZSB0aGlzLnByZXZpb3VzRmlsdGVyfWEmJmUucHJldmVudERlZmF1bHQoKX0sX2FjdGl2YXRlOmZ1bmN0aW9uKHQpe3RoaXMuYWN0aXZlJiYhdGhpcy5hY3RpdmUuaXMoIi51aS1zdGF0ZS1kaXNhYmxlZCIpJiYodGhpcy5hY3RpdmUuY2hpbGRyZW4oIlthcmlhLWhhc3BvcHVwPSd0cnVlJ10iKS5sZW5ndGg/dGhpcy5leHBhbmQodCk6dGhpcy5zZWxlY3QodCkpfSxyZWZyZXNoOmZ1bmN0aW9uKCl7dmFyIGUsaSxzLG4sbyxhPXRoaXMscj10aGlzLm9wdGlvbnMuaWNvbnMuc3VibWVudSxoPXRoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5tZW51cyk7dGhpcy5fdG9nZ2xlQ2xhc3MoInVpLW1lbnUtaWNvbnMiLG51bGwsISF0aGlzLmVsZW1lbnQuZmluZCgiLnVpLWljb24iKS5sZW5ndGgpLHM9aC5maWx0ZXIoIjpub3QoLnVpLW1lbnUpIikuaGlkZSgpLmF0dHIoe3JvbGU6dGhpcy5vcHRpb25zLnJvbGUsImFyaWEtaGlkZGVuIjoidHJ1ZSIsImFyaWEtZXhwYW5kZWQiOiJmYWxzZSJ9KS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzKSxpPWUucHJldigpLHM9dCgiPHNwYW4+IikuZGF0YSgidWktbWVudS1zdWJtZW51LWNhcmV0IiwhMCk7YS5fYWRkQ2xhc3MocywidWktbWVudS1pY29uIiwidWktaWNvbiAiK3IpLGkuYXR0cigiYXJpYS1oYXNwb3B1cCIsInRydWUiKS5wcmVwZW5kKHMpLGUuYXR0cigiYXJpYS1sYWJlbGxlZGJ5IixpLmF0dHIoImlkIikpfSksdGhpcy5fYWRkQ2xhc3MocywidWktbWVudSIsInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1mcm9udCIpLGU9aC5hZGQodGhpcy5lbGVtZW50KSxpPWUuZmluZCh0aGlzLm9wdGlvbnMuaXRlbXMpLGkubm90KCIudWktbWVudS1pdGVtIikuZWFjaChmdW5jdGlvbigpe3ZhciBlPXQodGhpcyk7YS5faXNEaXZpZGVyKGUpJiZhLl9hZGRDbGFzcyhlLCJ1aS1tZW51LWRpdmlkZXIiLCJ1aS13aWRnZXQtY29udGVudCIpfSksbj1pLm5vdCgiLnVpLW1lbnUtaXRlbSwgLnVpLW1lbnUtZGl2aWRlciIpLG89bi5jaGlsZHJlbigpLm5vdCgiLnVpLW1lbnUiKS51bmlxdWVJZCgpLmF0dHIoe3RhYkluZGV4Oi0xLHJvbGU6dGhpcy5faXRlbVJvbGUoKX0pLHRoaXMuX2FkZENsYXNzKG4sInVpLW1lbnUtaXRlbSIpLl9hZGRDbGFzcyhvLCJ1aS1tZW51LWl0ZW0td3JhcHBlciIpLGkuZmlsdGVyKCIudWktc3RhdGUtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIiwidHJ1ZSIpLHRoaXMuYWN0aXZlJiYhdC5jb250YWlucyh0aGlzLmVsZW1lbnRbMF0sdGhpcy5hY3RpdmVbMF0pJiZ0aGlzLmJsdXIoKX0sX2l0ZW1Sb2xlOmZ1bmN0aW9uKCl7cmV0dXJue21lbnU6Im1lbnVpdGVtIixsaXN0Ym94OiJvcHRpb24ifVt0aGlzLm9wdGlvbnMucm9sZV19LF9zZXRPcHRpb246ZnVuY3Rpb24odCxlKXtpZigiaWNvbnMiPT09dCl7dmFyIGk9dGhpcy5lbGVtZW50LmZpbmQoIi51aS1tZW51LWljb24iKTt0aGlzLl9yZW1vdmVDbGFzcyhpLG51bGwsdGhpcy5vcHRpb25zLmljb25zLnN1Ym1lbnUpLl9hZGRDbGFzcyhpLG51bGwsZS5zdWJtZW51KX10aGlzLl9zdXBlcih0LGUpfSxfc2V0T3B0aW9uRGlzYWJsZWQ6ZnVuY3Rpb24odCl7dGhpcy5fc3VwZXIodCksdGhpcy5lbGVtZW50LmF0dHIoImFyaWEtZGlzYWJsZWQiLHQrIiIpLHRoaXMuX3RvZ2dsZUNsYXNzKG51bGwsInVpLXN0YXRlLWRpc2FibGVkIiwhIXQpfSxmb2N1czpmdW5jdGlvbih0LGUpe3ZhciBpLHMsbjt0aGlzLmJsdXIodCx0JiYiZm9jdXMiPT09dC50eXBlKSx0aGlzLl9zY3JvbGxJbnRvVmlldyhlKSx0aGlzLmFjdGl2ZT1lLmZpcnN0KCkscz10aGlzLmFjdGl2ZS5jaGlsZHJlbigiLnVpLW1lbnUtaXRlbS13cmFwcGVyIiksdGhpcy5fYWRkQ2xhc3MocyxudWxsLCJ1aS1zdGF0ZS1hY3RpdmUiKSx0aGlzLm9wdGlvbnMucm9sZSYmdGhpcy5lbGVtZW50LmF0dHIoImFyaWEtYWN0aXZlZGVzY2VuZGFudCIscy5hdHRyKCJpZCIpKSxuPXRoaXMuYWN0aXZlLnBhcmVudCgpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iKS5jaGlsZHJlbigiLnVpLW1lbnUtaXRlbS13cmFwcGVyIiksdGhpcy5fYWRkQ2xhc3MobixudWxsLCJ1aS1zdGF0ZS1hY3RpdmUiKSx0JiYia2V5ZG93biI9PT10LnR5cGU/dGhpcy5fY2xvc2UoKTp0aGlzLnRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5fY2xvc2UoKX0sdGhpcy5kZWxheSksaT1lLmNoaWxkcmVuKCIudWktbWVudSIpLGkubGVuZ3RoJiZ0JiYvXm1vdXNlLy50ZXN0KHQudHlwZSkmJnRoaXMuX3N0YXJ0T3BlbmluZyhpKSx0aGlzLmFjdGl2ZU1lbnU9ZS5wYXJlbnQoKSx0aGlzLl90cmlnZ2VyKCJmb2N1cyIsdCx7aXRlbTplfSl9LF9zY3JvbGxJbnRvVmlldzpmdW5jdGlvbihlKXt2YXIgaSxzLG4sbyxhLHI7dGhpcy5faGFzU2Nyb2xsKCkmJihpPXBhcnNlRmxvYXQodC5jc3ModGhpcy5hY3RpdmVNZW51WzBdLCJib3JkZXJUb3BXaWR0aCIpKXx8MCxzPXBhcnNlRmxvYXQodC5jc3ModGhpcy5hY3RpdmVNZW51WzBdLCJwYWRkaW5nVG9wIikpfHwwLG49ZS5vZmZzZXQoKS50b3AtdGhpcy5hY3RpdmVNZW51Lm9mZnNldCgpLnRvcC1pLXMsbz10aGlzLmFjdGl2ZU1lbnUuc2Nyb2xsVG9wKCksYT10aGlzLmFjdGl2ZU1lbnUuaGVpZ2h0KCkscj1lLm91dGVySGVpZ2h0KCksMD5uP3RoaXMuYWN0aXZlTWVudS5zY3JvbGxUb3AobytuKTpuK3I+YSYmdGhpcy5hY3RpdmVNZW51LnNjcm9sbFRvcChvK24tYStyKSl9LGJsdXI6ZnVuY3Rpb24odCxlKXtlfHxjbGVhclRpbWVvdXQodGhpcy50aW1lciksdGhpcy5hY3RpdmUmJih0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLmFjdGl2ZS5jaGlsZHJlbigiLnVpLW1lbnUtaXRlbS13cmFwcGVyIiksbnVsbCwidWktc3RhdGUtYWN0aXZlIiksdGhpcy5fdHJpZ2dlcigiYmx1ciIsdCx7aXRlbTp0aGlzLmFjdGl2ZX0pLHRoaXMuYWN0aXZlPW51bGwpfSxfc3RhcnRPcGVuaW5nOmZ1bmN0aW9uKHQpe2NsZWFyVGltZW91dCh0aGlzLnRpbWVyKSwidHJ1ZSI9PT10LmF0dHIoImFyaWEtaGlkZGVuIikmJih0aGlzLnRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5fY2xvc2UoKSx0aGlzLl9vcGVuKHQpfSx0aGlzLmRlbGF5KSl9LF9vcGVuOmZ1bmN0aW9uKGUpe3ZhciBpPXQuZXh0ZW5kKHtvZjp0aGlzLmFjdGl2ZX0sdGhpcy5vcHRpb25zLnBvc2l0aW9uKTtjbGVhclRpbWVvdXQodGhpcy50aW1lciksdGhpcy5lbGVtZW50LmZpbmQoIi51aS1tZW51Iikubm90KGUucGFyZW50cygiLnVpLW1lbnUiKSkuaGlkZSgpLmF0dHIoImFyaWEtaGlkZGVuIiwidHJ1ZSIpLGUuc2hvdygpLnJlbW92ZUF0dHIoImFyaWEtaGlkZGVuIikuYXR0cigiYXJpYS1leHBhbmRlZCIsInRydWUiKS5wb3NpdGlvbihpKX0sY29sbGFwc2VBbGw6ZnVuY3Rpb24oZSxpKXtjbGVhclRpbWVvdXQodGhpcy50aW1lciksdGhpcy50aW1lcj10aGlzLl9kZWxheShmdW5jdGlvbigpe3ZhciBzPWk/dGhpcy5lbGVtZW50OnQoZSYmZS50YXJnZXQpLmNsb3Nlc3QodGhpcy5lbGVtZW50LmZpbmQoIi51aS1tZW51IikpO3MubGVuZ3RofHwocz10aGlzLmVsZW1lbnQpLHRoaXMuX2Nsb3NlKHMpLHRoaXMuYmx1cihlKSx0aGlzLl9yZW1vdmVDbGFzcyhzLmZpbmQoIi51aS1zdGF0ZS1hY3RpdmUiKSxudWxsLCJ1aS1zdGF0ZS1hY3RpdmUiKSx0aGlzLmFjdGl2ZU1lbnU9c30sdGhpcy5kZWxheSl9LF9jbG9zZTpmdW5jdGlvbih0KXt0fHwodD10aGlzLmFjdGl2ZT90aGlzLmFjdGl2ZS5wYXJlbnQoKTp0aGlzLmVsZW1lbnQpLHQuZmluZCgiLnVpLW1lbnUiKS5oaWRlKCkuYXR0cigiYXJpYS1oaWRkZW4iLCJ0cnVlIikuYXR0cigiYXJpYS1leHBhbmRlZCIsImZhbHNlIil9LF9jbG9zZU9uRG9jdW1lbnRDbGljazpmdW5jdGlvbihlKXtyZXR1cm4hdChlLnRhcmdldCkuY2xvc2VzdCgiLnVpLW1lbnUiKS5sZW5ndGh9LF9pc0RpdmlkZXI6ZnVuY3Rpb24odCl7cmV0dXJuIS9bXlwtXHUyMDE0XHUyMDEzXHNdLy50ZXN0KHQudGV4dCgpKX0sY29sbGFwc2U6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5hY3RpdmUmJnRoaXMuYWN0aXZlLnBhcmVudCgpLmNsb3Nlc3QoIi51aS1tZW51LWl0ZW0iLHRoaXMuZWxlbWVudCk7ZSYmZS5sZW5ndGgmJih0aGlzLl9jbG9zZSgpLHRoaXMuZm9jdXModCxlKSl9LGV4cGFuZDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmFjdGl2ZSYmdGhpcy5hY3RpdmUuY2hpbGRyZW4oIi51aS1tZW51ICIpLmZpbmQodGhpcy5vcHRpb25zLml0ZW1zKS5maXJzdCgpO2UmJmUubGVuZ3RoJiYodGhpcy5fb3BlbihlLnBhcmVudCgpKSx0aGlzLl9kZWxheShmdW5jdGlvbigpe3RoaXMuZm9jdXModCxlKX0pKX0sbmV4dDpmdW5jdGlvbih0KXt0aGlzLl9tb3ZlKCJuZXh0IiwiZmlyc3QiLHQpfSxwcmV2aW91czpmdW5jdGlvbih0KXt0aGlzLl9tb3ZlKCJwcmV2IiwibGFzdCIsdCl9LGlzRmlyc3RJdGVtOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWN0aXZlJiYhdGhpcy5hY3RpdmUucHJldkFsbCgiLnVpLW1lbnUtaXRlbSIpLmxlbmd0aH0saXNMYXN0SXRlbTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmFjdGl2ZSYmIXRoaXMuYWN0aXZlLm5leHRBbGwoIi51aS1tZW51LWl0ZW0iKS5sZW5ndGh9LF9tb3ZlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgczt0aGlzLmFjdGl2ZSYmKHM9ImZpcnN0Ij09PXR8fCJsYXN0Ij09PXQ/dGhpcy5hY3RpdmVbImZpcnN0Ij09PXQ/InByZXZBbGwiOiJuZXh0QWxsIl0oIi51aS1tZW51LWl0ZW0iKS5lcSgtMSk6dGhpcy5hY3RpdmVbdCsiQWxsIl0oIi51aS1tZW51LWl0ZW0iKS5lcSgwKSkscyYmcy5sZW5ndGgmJnRoaXMuYWN0aXZlfHwocz10aGlzLmFjdGl2ZU1lbnUuZmluZCh0aGlzLm9wdGlvbnMuaXRlbXMpW2VdKCkpLHRoaXMuZm9jdXMoaSxzKX0sbmV4dFBhZ2U6ZnVuY3Rpb24oZSl7dmFyIGkscyxuO3JldHVybiB0aGlzLmFjdGl2ZT8odGhpcy5pc0xhc3RJdGVtKCl8fCh0aGlzLl9oYXNTY3JvbGwoKT8ocz10aGlzLmFjdGl2ZS5vZmZzZXQoKS50b3Asbj10aGlzLmVsZW1lbnQuaGVpZ2h0KCksdGhpcy5hY3RpdmUubmV4dEFsbCgiLnVpLW1lbnUtaXRlbSIpLmVhY2goZnVuY3Rpb24oKXtyZXR1cm4gaT10KHRoaXMpLDA+aS5vZmZzZXQoKS50b3Atcy1ufSksdGhpcy5mb2N1cyhlLGkpKTp0aGlzLmZvY3VzKGUsdGhpcy5hY3RpdmVNZW51LmZpbmQodGhpcy5vcHRpb25zLml0ZW1zKVt0aGlzLmFjdGl2ZT8ibGFzdCI6ImZpcnN0Il0oKSkpLHZvaWQgMCk6KHRoaXMubmV4dChlKSx2b2lkIDApfSxwcmV2aW91c1BhZ2U6ZnVuY3Rpb24oZSl7dmFyIGkscyxuO3JldHVybiB0aGlzLmFjdGl2ZT8odGhpcy5pc0ZpcnN0SXRlbSgpfHwodGhpcy5faGFzU2Nyb2xsKCk/KHM9dGhpcy5hY3RpdmUub2Zmc2V0KCkudG9wLG49dGhpcy5lbGVtZW50LmhlaWdodCgpLHRoaXMuYWN0aXZlLnByZXZBbGwoIi51aS1tZW51LWl0ZW0iKS5lYWNoKGZ1bmN0aW9uKCl7cmV0dXJuIGk9dCh0aGlzKSxpLm9mZnNldCgpLnRvcC1zK24+MH0pLHRoaXMuZm9jdXMoZSxpKSk6dGhpcy5mb2N1cyhlLHRoaXMuYWN0aXZlTWVudS5maW5kKHRoaXMub3B0aW9ucy5pdGVtcykuZmlyc3QoKSkpLHZvaWQgMCk6KHRoaXMubmV4dChlKSx2b2lkIDApfSxfaGFzU2Nyb2xsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpPHRoaXMuZWxlbWVudC5wcm9wKCJzY3JvbGxIZWlnaHQiKX0sc2VsZWN0OmZ1bmN0aW9uKGUpe3RoaXMuYWN0aXZlPXRoaXMuYWN0aXZlfHx0KGUudGFyZ2V0KS5jbG9zZXN0KCIudWktbWVudS1pdGVtIik7dmFyIGk9e2l0ZW06dGhpcy5hY3RpdmV9O3RoaXMuYWN0aXZlLmhhcygiLnVpLW1lbnUiKS5sZW5ndGh8fHRoaXMuY29sbGFwc2VBbGwoZSwhMCksdGhpcy5fdHJpZ2dlcigic2VsZWN0IixlLGkpfSxfZmlsdGVyTWVudUl0ZW1zOmZ1bmN0aW9uKGUpe3ZhciBpPWUucmVwbGFjZSgvW1wtXFtcXXt9KCkqKz8uLFxcXF4kfCNcc10vZywiXFwkJiIpLHM9UmVnRXhwKCJeIitpLCJpIik7cmV0dXJuIHRoaXMuYWN0aXZlTWVudS5maW5kKHRoaXMub3B0aW9ucy5pdGVtcykuZmlsdGVyKCIudWktbWVudS1pdGVtIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHMudGVzdCh0LnRyaW0odCh0aGlzKS5jaGlsZHJlbigiLnVpLW1lbnUtaXRlbS13cmFwcGVyIikudGV4dCgpKSl9KX19KSx0LndpZGdldCgidWkuYXV0b2NvbXBsZXRlIix7dmVyc2lvbjoiMS4xMi4xIixkZWZhdWx0RWxlbWVudDoiPGlucHV0PiIsb3B0aW9uczp7YXBwZW5kVG86bnVsbCxhdXRvRm9jdXM6ITEsZGVsYXk6MzAwLG1pbkxlbmd0aDoxLHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJsZWZ0IGJvdHRvbSIsY29sbGlzaW9uOiJub25lIn0sc291cmNlOm51bGwsY2hhbmdlOm51bGwsY2xvc2U6bnVsbCxmb2N1czpudWxsLG9wZW46bnVsbCxyZXNwb25zZTpudWxsLHNlYXJjaDpudWxsLHNlbGVjdDpudWxsfSxyZXF1ZXN0SW5kZXg6MCxwZW5kaW5nOjAsX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBlLGkscyxuPXRoaXMuZWxlbWVudFswXS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLG89InRleHRhcmVhIj09PW4sYT0iaW5wdXQiPT09bjsKdGhpcy5pc011bHRpTGluZT1vfHwhYSYmdGhpcy5faXNDb250ZW50RWRpdGFibGUodGhpcy5lbGVtZW50KSx0aGlzLnZhbHVlTWV0aG9kPXRoaXMuZWxlbWVudFtvfHxhPyJ2YWwiOiJ0ZXh0Il0sdGhpcy5pc05ld01lbnU9ITAsdGhpcy5fYWRkQ2xhc3MoInVpLWF1dG9jb21wbGV0ZS1pbnB1dCIpLHRoaXMuZWxlbWVudC5hdHRyKCJhdXRvY29tcGxldGUiLCJvZmYiKSx0aGlzLl9vbih0aGlzLmVsZW1lbnQse2tleWRvd246ZnVuY3Rpb24obil7aWYodGhpcy5lbGVtZW50LnByb3AoInJlYWRPbmx5IikpcmV0dXJuIGU9ITAscz0hMCxpPSEwLHZvaWQgMDtlPSExLHM9ITEsaT0hMTt2YXIgbz10LnVpLmtleUNvZGU7c3dpdGNoKG4ua2V5Q29kZSl7Y2FzZSBvLlBBR0VfVVA6ZT0hMCx0aGlzLl9tb3ZlKCJwcmV2aW91c1BhZ2UiLG4pO2JyZWFrO2Nhc2Ugby5QQUdFX0RPV046ZT0hMCx0aGlzLl9tb3ZlKCJuZXh0UGFnZSIsbik7YnJlYWs7Y2FzZSBvLlVQOmU9ITAsdGhpcy5fa2V5RXZlbnQoInByZXZpb3VzIixuKTticmVhaztjYXNlIG8uRE9XTjplPSEwLHRoaXMuX2tleUV2ZW50KCJuZXh0IixuKTticmVhaztjYXNlIG8uRU5URVI6dGhpcy5tZW51LmFjdGl2ZSYmKGU9ITAsbi5wcmV2ZW50RGVmYXVsdCgpLHRoaXMubWVudS5zZWxlY3QobikpO2JyZWFrO2Nhc2Ugby5UQUI6dGhpcy5tZW51LmFjdGl2ZSYmdGhpcy5tZW51LnNlbGVjdChuKTticmVhaztjYXNlIG8uRVNDQVBFOnRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpJiYodGhpcy5pc011bHRpTGluZXx8dGhpcy5fdmFsdWUodGhpcy50ZXJtKSx0aGlzLmNsb3NlKG4pLG4ucHJldmVudERlZmF1bHQoKSk7YnJlYWs7ZGVmYXVsdDppPSEwLHRoaXMuX3NlYXJjaFRpbWVvdXQobil9fSxrZXlwcmVzczpmdW5jdGlvbihzKXtpZihlKXJldHVybiBlPSExLCghdGhpcy5pc011bHRpTGluZXx8dGhpcy5tZW51LmVsZW1lbnQuaXMoIjp2aXNpYmxlIikpJiZzLnByZXZlbnREZWZhdWx0KCksdm9pZCAwO2lmKCFpKXt2YXIgbj10LnVpLmtleUNvZGU7c3dpdGNoKHMua2V5Q29kZSl7Y2FzZSBuLlBBR0VfVVA6dGhpcy5fbW92ZSgicHJldmlvdXNQYWdlIixzKTticmVhaztjYXNlIG4uUEFHRV9ET1dOOnRoaXMuX21vdmUoIm5leHRQYWdlIixzKTticmVhaztjYXNlIG4uVVA6dGhpcy5fa2V5RXZlbnQoInByZXZpb3VzIixzKTticmVhaztjYXNlIG4uRE9XTjp0aGlzLl9rZXlFdmVudCgibmV4dCIscyl9fX0saW5wdXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHM/KHM9ITEsdC5wcmV2ZW50RGVmYXVsdCgpLHZvaWQgMCk6KHRoaXMuX3NlYXJjaFRpbWVvdXQodCksdm9pZCAwKX0sZm9jdXM6ZnVuY3Rpb24oKXt0aGlzLnNlbGVjdGVkSXRlbT1udWxsLHRoaXMucHJldmlvdXM9dGhpcy5fdmFsdWUoKX0sYmx1cjpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5jYW5jZWxCbHVyPyhkZWxldGUgdGhpcy5jYW5jZWxCbHVyLHZvaWQgMCk6KGNsZWFyVGltZW91dCh0aGlzLnNlYXJjaGluZyksdGhpcy5jbG9zZSh0KSx0aGlzLl9jaGFuZ2UodCksdm9pZCAwKX19KSx0aGlzLl9pbml0U291cmNlKCksdGhpcy5tZW51PXQoIjx1bD4iKS5hcHBlbmRUbyh0aGlzLl9hcHBlbmRUbygpKS5tZW51KHtyb2xlOm51bGx9KS5oaWRlKCkubWVudSgiaW5zdGFuY2UiKSx0aGlzLl9hZGRDbGFzcyh0aGlzLm1lbnUuZWxlbWVudCwidWktYXV0b2NvbXBsZXRlIiwidWktZnJvbnQiKSx0aGlzLl9vbih0aGlzLm1lbnUuZWxlbWVudCx7bW91c2Vkb3duOmZ1bmN0aW9uKGUpe2UucHJldmVudERlZmF1bHQoKSx0aGlzLmNhbmNlbEJsdXI9ITAsdGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5jYW5jZWxCbHVyLHRoaXMuZWxlbWVudFswXSE9PXQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSkmJnRoaXMuZWxlbWVudC50cmlnZ2VyKCJmb2N1cyIpfSl9LG1lbnVmb2N1czpmdW5jdGlvbihlLGkpe3ZhciBzLG47cmV0dXJuIHRoaXMuaXNOZXdNZW51JiYodGhpcy5pc05ld01lbnU9ITEsZS5vcmlnaW5hbEV2ZW50JiYvXm1vdXNlLy50ZXN0KGUub3JpZ2luYWxFdmVudC50eXBlKSk/KHRoaXMubWVudS5ibHVyKCksdGhpcy5kb2N1bWVudC5vbmUoIm1vdXNlbW92ZSIsZnVuY3Rpb24oKXt0KGUudGFyZ2V0KS50cmlnZ2VyKGUub3JpZ2luYWxFdmVudCl9KSx2b2lkIDApOihuPWkuaXRlbS5kYXRhKCJ1aS1hdXRvY29tcGxldGUtaXRlbSIpLCExIT09dGhpcy5fdHJpZ2dlcigiZm9jdXMiLGUse2l0ZW06bn0pJiZlLm9yaWdpbmFsRXZlbnQmJi9ea2V5Ly50ZXN0KGUub3JpZ2luYWxFdmVudC50eXBlKSYmdGhpcy5fdmFsdWUobi52YWx1ZSkscz1pLml0ZW0uYXR0cigiYXJpYS1sYWJlbCIpfHxuLnZhbHVlLHMmJnQudHJpbShzKS5sZW5ndGgmJih0aGlzLmxpdmVSZWdpb24uY2hpbGRyZW4oKS5oaWRlKCksdCgiPGRpdj4iKS50ZXh0KHMpLmFwcGVuZFRvKHRoaXMubGl2ZVJlZ2lvbikpLHZvaWQgMCl9LG1lbnVzZWxlY3Q6ZnVuY3Rpb24oZSxpKXt2YXIgcz1pLml0ZW0uZGF0YSgidWktYXV0b2NvbXBsZXRlLWl0ZW0iKSxuPXRoaXMucHJldmlvdXM7dGhpcy5lbGVtZW50WzBdIT09dC51aS5zYWZlQWN0aXZlRWxlbWVudCh0aGlzLmRvY3VtZW50WzBdKSYmKHRoaXMuZWxlbWVudC50cmlnZ2VyKCJmb2N1cyIpLHRoaXMucHJldmlvdXM9bix0aGlzLl9kZWxheShmdW5jdGlvbigpe3RoaXMucHJldmlvdXM9bix0aGlzLnNlbGVjdGVkSXRlbT1zfSkpLCExIT09dGhpcy5fdHJpZ2dlcigic2VsZWN0IixlLHtpdGVtOnN9KSYmdGhpcy5fdmFsdWUocy52YWx1ZSksdGhpcy50ZXJtPXRoaXMuX3ZhbHVlKCksdGhpcy5jbG9zZShlKSx0aGlzLnNlbGVjdGVkSXRlbT1zfX0pLHRoaXMubGl2ZVJlZ2lvbj10KCI8ZGl2PiIse3JvbGU6InN0YXR1cyIsImFyaWEtbGl2ZSI6ImFzc2VydGl2ZSIsImFyaWEtcmVsZXZhbnQiOiJhZGRpdGlvbnMifSkuYXBwZW5kVG8odGhpcy5kb2N1bWVudFswXS5ib2R5KSx0aGlzLl9hZGRDbGFzcyh0aGlzLmxpdmVSZWdpb24sbnVsbCwidWktaGVscGVyLWhpZGRlbi1hY2Nlc3NpYmxlIiksdGhpcy5fb24odGhpcy53aW5kb3cse2JlZm9yZXVubG9hZDpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCJhdXRvY29tcGxldGUiKX19KX0sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXtjbGVhclRpbWVvdXQodGhpcy5zZWFyY2hpbmcpLHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCJhdXRvY29tcGxldGUiKSx0aGlzLm1lbnUuZWxlbWVudC5yZW1vdmUoKSx0aGlzLmxpdmVSZWdpb24ucmVtb3ZlKCl9LF9zZXRPcHRpb246ZnVuY3Rpb24odCxlKXt0aGlzLl9zdXBlcih0LGUpLCJzb3VyY2UiPT09dCYmdGhpcy5faW5pdFNvdXJjZSgpLCJhcHBlbmRUbyI9PT10JiZ0aGlzLm1lbnUuZWxlbWVudC5hcHBlbmRUbyh0aGlzLl9hcHBlbmRUbygpKSwiZGlzYWJsZWQiPT09dCYmZSYmdGhpcy54aHImJnRoaXMueGhyLmFib3J0KCl9LF9pc0V2ZW50VGFyZ2V0SW5XaWRnZXQ6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5tZW51LmVsZW1lbnRbMF07cmV0dXJuIGUudGFyZ2V0PT09dGhpcy5lbGVtZW50WzBdfHxlLnRhcmdldD09PWl8fHQuY29udGFpbnMoaSxlLnRhcmdldCl9LF9jbG9zZU9uQ2xpY2tPdXRzaWRlOmZ1bmN0aW9uKHQpe3RoaXMuX2lzRXZlbnRUYXJnZXRJbldpZGdldCh0KXx8dGhpcy5jbG9zZSgpfSxfYXBwZW5kVG86ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMuYXBwZW5kVG87cmV0dXJuIGUmJihlPWUuanF1ZXJ5fHxlLm5vZGVUeXBlP3QoZSk6dGhpcy5kb2N1bWVudC5maW5kKGUpLmVxKDApKSxlJiZlWzBdfHwoZT10aGlzLmVsZW1lbnQuY2xvc2VzdCgiLnVpLWZyb250LCBkaWFsb2ciKSksZS5sZW5ndGh8fChlPXRoaXMuZG9jdW1lbnRbMF0uYm9keSksZX0sX2luaXRTb3VyY2U6ZnVuY3Rpb24oKXt2YXIgZSxpLHM9dGhpczt0LmlzQXJyYXkodGhpcy5vcHRpb25zLnNvdXJjZSk/KGU9dGhpcy5vcHRpb25zLnNvdXJjZSx0aGlzLnNvdXJjZT1mdW5jdGlvbihpLHMpe3ModC51aS5hdXRvY29tcGxldGUuZmlsdGVyKGUsaS50ZXJtKSl9KToic3RyaW5nIj09dHlwZW9mIHRoaXMub3B0aW9ucy5zb3VyY2U/KGk9dGhpcy5vcHRpb25zLnNvdXJjZSx0aGlzLnNvdXJjZT1mdW5jdGlvbihlLG4pe3MueGhyJiZzLnhoci5hYm9ydCgpLHMueGhyPXQuYWpheCh7dXJsOmksZGF0YTplLGRhdGFUeXBlOiJqc29uIixzdWNjZXNzOmZ1bmN0aW9uKHQpe24odCl9LGVycm9yOmZ1bmN0aW9uKCl7bihbXSl9fSl9KTp0aGlzLnNvdXJjZT10aGlzLm9wdGlvbnMuc291cmNlfSxfc2VhcmNoVGltZW91dDpmdW5jdGlvbih0KXtjbGVhclRpbWVvdXQodGhpcy5zZWFyY2hpbmcpLHRoaXMuc2VhcmNoaW5nPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy50ZXJtPT09dGhpcy5fdmFsdWUoKSxpPXRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpLHM9dC5hbHRLZXl8fHQuY3RybEtleXx8dC5tZXRhS2V5fHx0LnNoaWZ0S2V5OyghZXx8ZSYmIWkmJiFzKSYmKHRoaXMuc2VsZWN0ZWRJdGVtPW51bGwsdGhpcy5zZWFyY2gobnVsbCx0KSl9LHRoaXMub3B0aW9ucy5kZWxheSl9LHNlYXJjaDpmdW5jdGlvbih0LGUpe3JldHVybiB0PW51bGwhPXQ/dDp0aGlzLl92YWx1ZSgpLHRoaXMudGVybT10aGlzLl92YWx1ZSgpLHQubGVuZ3RoPHRoaXMub3B0aW9ucy5taW5MZW5ndGg/dGhpcy5jbG9zZShlKTp0aGlzLl90cmlnZ2VyKCJzZWFyY2giLGUpIT09ITE/dGhpcy5fc2VhcmNoKHQpOnZvaWQgMH0sX3NlYXJjaDpmdW5jdGlvbih0KXt0aGlzLnBlbmRpbmcrKyx0aGlzLl9hZGRDbGFzcygidWktYXV0b2NvbXBsZXRlLWxvYWRpbmciKSx0aGlzLmNhbmNlbFNlYXJjaD0hMSx0aGlzLnNvdXJjZSh7dGVybTp0fSx0aGlzLl9yZXNwb25zZSgpKX0sX3Jlc3BvbnNlOmZ1bmN0aW9uKCl7dmFyIGU9Kyt0aGlzLnJlcXVlc3RJbmRleDtyZXR1cm4gdC5wcm94eShmdW5jdGlvbih0KXtlPT09dGhpcy5yZXF1ZXN0SW5kZXgmJnRoaXMuX19yZXNwb25zZSh0KSx0aGlzLnBlbmRpbmctLSx0aGlzLnBlbmRpbmd8fHRoaXMuX3JlbW92ZUNsYXNzKCJ1aS1hdXRvY29tcGxldGUtbG9hZGluZyIpfSx0aGlzKX0sX19yZXNwb25zZTpmdW5jdGlvbih0KXt0JiYodD10aGlzLl9ub3JtYWxpemUodCkpLHRoaXMuX3RyaWdnZXIoInJlc3BvbnNlIixudWxsLHtjb250ZW50OnR9KSwhdGhpcy5vcHRpb25zLmRpc2FibGVkJiZ0JiZ0Lmxlbmd0aCYmIXRoaXMuY2FuY2VsU2VhcmNoPyh0aGlzLl9zdWdnZXN0KHQpLHRoaXMuX3RyaWdnZXIoIm9wZW4iKSk6dGhpcy5fY2xvc2UoKX0sY2xvc2U6ZnVuY3Rpb24odCl7dGhpcy5jYW5jZWxTZWFyY2g9ITAsdGhpcy5fY2xvc2UodCl9LF9jbG9zZTpmdW5jdGlvbih0KXt0aGlzLl9vZmYodGhpcy5kb2N1bWVudCwibW91c2Vkb3duIiksdGhpcy5tZW51LmVsZW1lbnQuaXMoIjp2aXNpYmxlIikmJih0aGlzLm1lbnUuZWxlbWVudC5oaWRlKCksdGhpcy5tZW51LmJsdXIoKSx0aGlzLmlzTmV3TWVudT0hMCx0aGlzLl90cmlnZ2VyKCJjbG9zZSIsdCkpfSxfY2hhbmdlOmZ1bmN0aW9uKHQpe3RoaXMucHJldmlvdXMhPT10aGlzLl92YWx1ZSgpJiZ0aGlzLl90cmlnZ2VyKCJjaGFuZ2UiLHQse2l0ZW06dGhpcy5zZWxlY3RlZEl0ZW19KX0sX25vcm1hbGl6ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5sZW5ndGgmJmVbMF0ubGFiZWwmJmVbMF0udmFsdWU/ZTp0Lm1hcChlLGZ1bmN0aW9uKGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZT97bGFiZWw6ZSx2YWx1ZTplfTp0LmV4dGVuZCh7fSxlLHtsYWJlbDplLmxhYmVsfHxlLnZhbHVlLHZhbHVlOmUudmFsdWV8fGUubGFiZWx9KX0pfSxfc3VnZ2VzdDpmdW5jdGlvbihlKXt2YXIgaT10aGlzLm1lbnUuZWxlbWVudC5lbXB0eSgpO3RoaXMuX3JlbmRlck1lbnUoaSxlKSx0aGlzLmlzTmV3TWVudT0hMCx0aGlzLm1lbnUucmVmcmVzaCgpLGkuc2hvdygpLHRoaXMuX3Jlc2l6ZU1lbnUoKSxpLnBvc2l0aW9uKHQuZXh0ZW5kKHtvZjp0aGlzLmVsZW1lbnR9LHRoaXMub3B0aW9ucy5wb3NpdGlvbikpLHRoaXMub3B0aW9ucy5hdXRvRm9jdXMmJnRoaXMubWVudS5uZXh0KCksdGhpcy5fb24odGhpcy5kb2N1bWVudCx7bW91c2Vkb3duOiJfY2xvc2VPbkNsaWNrT3V0c2lkZSJ9KX0sX3Jlc2l6ZU1lbnU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm1lbnUuZWxlbWVudDt0Lm91dGVyV2lkdGgoTWF0aC5tYXgodC53aWR0aCgiIikub3V0ZXJXaWR0aCgpKzEsdGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSkpfSxfcmVuZGVyTWVudTpmdW5jdGlvbihlLGkpe3ZhciBzPXRoaXM7dC5lYWNoKGksZnVuY3Rpb24odCxpKXtzLl9yZW5kZXJJdGVtRGF0YShlLGkpfSl9LF9yZW5kZXJJdGVtRGF0YTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9yZW5kZXJJdGVtKHQsZSkuZGF0YSgidWktYXV0b2NvbXBsZXRlLWl0ZW0iLGUpfSxfcmVuZGVySXRlbTpmdW5jdGlvbihlLGkpe3JldHVybiB0KCI8bGk+IikuYXBwZW5kKHQoIjxkaXY+IikudGV4dChpLmxhYmVsKSkuYXBwZW5kVG8oZSl9LF9tb3ZlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpP3RoaXMubWVudS5pc0ZpcnN0SXRlbSgpJiYvXnByZXZpb3VzLy50ZXN0KHQpfHx0aGlzLm1lbnUuaXNMYXN0SXRlbSgpJiYvXm5leHQvLnRlc3QodCk/KHRoaXMuaXNNdWx0aUxpbmV8fHRoaXMuX3ZhbHVlKHRoaXMudGVybSksdGhpcy5tZW51LmJsdXIoKSx2b2lkIDApOih0aGlzLm1lbnVbdF0oZSksdm9pZCAwKToodGhpcy5zZWFyY2gobnVsbCxlKSx2b2lkIDApfSx3aWRnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tZW51LmVsZW1lbnR9LF92YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlTWV0aG9kLmFwcGx5KHRoaXMuZWxlbWVudCxhcmd1bWVudHMpfSxfa2V5RXZlbnQ6ZnVuY3Rpb24odCxlKXsoIXRoaXMuaXNNdWx0aUxpbmV8fHRoaXMubWVudS5lbGVtZW50LmlzKCI6dmlzaWJsZSIpKSYmKHRoaXMuX21vdmUodCxlKSxlLnByZXZlbnREZWZhdWx0KCkpfSxfaXNDb250ZW50RWRpdGFibGU6ZnVuY3Rpb24odCl7aWYoIXQubGVuZ3RoKXJldHVybiExO3ZhciBlPXQucHJvcCgiY29udGVudEVkaXRhYmxlIik7cmV0dXJuImluaGVyaXQiPT09ZT90aGlzLl9pc0NvbnRlbnRFZGl0YWJsZSh0LnBhcmVudCgpKToidHJ1ZSI9PT1lfX0pLHQuZXh0ZW5kKHQudWkuYXV0b2NvbXBsZXRlLHtlc2NhcGVSZWdleDpmdW5jdGlvbih0KXtyZXR1cm4gdC5yZXBsYWNlKC9bXC1cW1xde30oKSorPy4sXFxcXiR8I1xzXS9nLCJcXCQmIil9LGZpbHRlcjpmdW5jdGlvbihlLGkpe3ZhciBzPVJlZ0V4cCh0LnVpLmF1dG9jb21wbGV0ZS5lc2NhcGVSZWdleChpKSwiaSIpO3JldHVybiB0LmdyZXAoZSxmdW5jdGlvbih0KXtyZXR1cm4gcy50ZXN0KHQubGFiZWx8fHQudmFsdWV8fHQpfSl9fSksdC53aWRnZXQoInVpLmF1dG9jb21wbGV0ZSIsdC51aS5hdXRvY29tcGxldGUse29wdGlvbnM6e21lc3NhZ2VzOntub1Jlc3VsdHM6Ik5vIHNlYXJjaCByZXN1bHRzLiIscmVzdWx0czpmdW5jdGlvbih0KXtyZXR1cm4gdCsodD4xPyIgcmVzdWx0cyBhcmUiOiIgcmVzdWx0IGlzIikrIiBhdmFpbGFibGUsIHVzZSB1cCBhbmQgZG93biBhcnJvdyBrZXlzIHRvIG5hdmlnYXRlLiJ9fX0sX19yZXNwb25zZTpmdW5jdGlvbihlKXt2YXIgaTt0aGlzLl9zdXBlckFwcGx5KGFyZ3VtZW50cyksdGhpcy5vcHRpb25zLmRpc2FibGVkfHx0aGlzLmNhbmNlbFNlYXJjaHx8KGk9ZSYmZS5sZW5ndGg/dGhpcy5vcHRpb25zLm1lc3NhZ2VzLnJlc3VsdHMoZS5sZW5ndGgpOnRoaXMub3B0aW9ucy5tZXNzYWdlcy5ub1Jlc3VsdHMsdGhpcy5saXZlUmVnaW9uLmNoaWxkcmVuKCkuaGlkZSgpLHQoIjxkaXY+IikudGV4dChpKS5hcHBlbmRUbyh0aGlzLmxpdmVSZWdpb24pKX19KSx0LnVpLmF1dG9jb21wbGV0ZTt2YXIgZz0vdWktY29ybmVyLShbYS16XSl7Miw2fS9nO3Qud2lkZ2V0KCJ1aS5jb250cm9sZ3JvdXAiLHt2ZXJzaW9uOiIxLjEyLjEiLGRlZmF1bHRFbGVtZW50OiI8ZGl2PiIsb3B0aW9uczp7ZGlyZWN0aW9uOiJob3Jpem9udGFsIixkaXNhYmxlZDpudWxsLG9ubHlWaXNpYmxlOiEwLGl0ZW1zOntidXR0b246ImlucHV0W3R5cGU9YnV0dG9uXSwgaW5wdXRbdHlwZT1zdWJtaXRdLCBpbnB1dFt0eXBlPXJlc2V0XSwgYnV0dG9uLCBhIixjb250cm9sZ3JvdXBMYWJlbDoiLnVpLWNvbnRyb2xncm91cC1sYWJlbCIsY2hlY2tib3hyYWRpbzoiaW5wdXRbdHlwZT0nY2hlY2tib3gnXSwgaW5wdXRbdHlwZT0ncmFkaW8nXSIsc2VsZWN0bWVudToic2VsZWN0IixzcGlubmVyOiIudWktc3Bpbm5lci1pbnB1dCJ9fSxfY3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5fZW5oYW5jZSgpfSxfZW5oYW5jZTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5hdHRyKCJyb2xlIiwidG9vbGJhciIpLHRoaXMucmVmcmVzaCgpfSxfZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuX2NhbGxDaGlsZE1ldGhvZCgiZGVzdHJveSIpLHRoaXMuY2hpbGRXaWRnZXRzLnJlbW92ZURhdGEoInVpLWNvbnRyb2xncm91cC1kYXRhIiksdGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoInJvbGUiKSx0aGlzLm9wdGlvbnMuaXRlbXMuY29udHJvbGdyb3VwTGFiZWwmJnRoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5pdGVtcy5jb250cm9sZ3JvdXBMYWJlbCkuZmluZCgiLnVpLWNvbnRyb2xncm91cC1sYWJlbC1jb250ZW50cyIpLmNvbnRlbnRzKCkudW53cmFwKCl9LF9pbml0V2lkZ2V0czpmdW5jdGlvbigpe3ZhciBlPXRoaXMsaT1bXTt0LmVhY2godGhpcy5vcHRpb25zLml0ZW1zLGZ1bmN0aW9uKHMsbil7dmFyIG8sYT17fTtyZXR1cm4gbj8iY29udHJvbGdyb3VwTGFiZWwiPT09cz8obz1lLmVsZW1lbnQuZmluZChuKSxvLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpO2UuY2hpbGRyZW4oIi51aS1jb250cm9sZ3JvdXAtbGFiZWwtY29udGVudHMiKS5sZW5ndGh8fGUuY29udGVudHMoKS53cmFwQWxsKCI8c3BhbiBjbGFzcz0ndWktY29udHJvbGdyb3VwLWxhYmVsLWNvbnRlbnRzJz48L3NwYW4+Iil9KSxlLl9hZGRDbGFzcyhvLG51bGwsInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1zdGF0ZS1kZWZhdWx0IiksaT1pLmNvbmNhdChvLmdldCgpKSx2b2lkIDApOih0LmZuW3NdJiYoYT1lWyJfIitzKyJPcHRpb25zIl0/ZVsiXyIrcysiT3B0aW9ucyJdKCJtaWRkbGUiKTp7Y2xhc3Nlczp7fX0sZS5lbGVtZW50LmZpbmQobikuZWFjaChmdW5jdGlvbigpe3ZhciBuPXQodGhpcyksbz1uW3NdKCJpbnN0YW5jZSIpLHI9dC53aWRnZXQuZXh0ZW5kKHt9LGEpO2lmKCJidXR0b24iIT09c3x8IW4ucGFyZW50KCIudWktc3Bpbm5lciIpLmxlbmd0aCl7b3x8KG89bltzXSgpW3NdKCJpbnN0YW5jZSIpKSxvJiYoci5jbGFzc2VzPWUuX3Jlc29sdmVDbGFzc2VzVmFsdWVzKHIuY2xhc3NlcyxvKSksbltzXShyKTt2YXIgaD1uW3NdKCJ3aWRnZXQiKTt0LmRhdGEoaFswXSwidWktY29udHJvbGdyb3VwLWRhdGEiLG8/bzpuW3NdKCJpbnN0YW5jZSIpKSxpLnB1c2goaFswXSl9fSkpLHZvaWQgMCk6dm9pZCAwfSksdGhpcy5jaGlsZFdpZGdldHM9dCh0LnVuaXF1ZShpKSksdGhpcy5fYWRkQ2xhc3ModGhpcy5jaGlsZFdpZGdldHMsInVpLWNvbnRyb2xncm91cC1pdGVtIil9LF9jYWxsQ2hpbGRNZXRob2Q6ZnVuY3Rpb24oZSl7dGhpcy5jaGlsZFdpZGdldHMuZWFjaChmdW5jdGlvbigpe3ZhciBpPXQodGhpcykscz1pLmRhdGEoInVpLWNvbnRyb2xncm91cC1kYXRhIik7cyYmc1tlXSYmc1tlXSgpfSl9LF91cGRhdGVDb3JuZXJDbGFzczpmdW5jdGlvbih0LGUpe3ZhciBpPSJ1aS1jb3JuZXItdG9wIHVpLWNvcm5lci1ib3R0b20gdWktY29ybmVyLWxlZnQgdWktY29ybmVyLXJpZ2h0IHVpLWNvcm5lci1hbGwiLHM9dGhpcy5fYnVpbGRTaW1wbGVPcHRpb25zKGUsImxhYmVsIikuY2xhc3Nlcy5sYWJlbDt0aGlzLl9yZW1vdmVDbGFzcyh0LG51bGwsaSksdGhpcy5fYWRkQ2xhc3ModCxudWxsLHMpfSxfYnVpbGRTaW1wbGVPcHRpb25zOmZ1bmN0aW9uKHQsZSl7dmFyIGk9InZlcnRpY2FsIj09PXRoaXMub3B0aW9ucy5kaXJlY3Rpb24scz17Y2xhc3Nlczp7fX07cmV0dXJuIHMuY2xhc3Nlc1tlXT17bWlkZGxlOiIiLGZpcnN0OiJ1aS1jb3JuZXItIisoaT8idG9wIjoibGVmdCIpLGxhc3Q6InVpLWNvcm5lci0iKyhpPyJib3R0b20iOiJyaWdodCIpLG9ubHk6InVpLWNvcm5lci1hbGwifVt0XSxzfSxfc3Bpbm5lck9wdGlvbnM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fYnVpbGRTaW1wbGVPcHRpb25zKHQsInVpLXNwaW5uZXIiKTtyZXR1cm4gZS5jbGFzc2VzWyJ1aS1zcGlubmVyLXVwIl09IiIsZS5jbGFzc2VzWyJ1aS1zcGlubmVyLWRvd24iXT0iIixlfSxfYnV0dG9uT3B0aW9uczpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fYnVpbGRTaW1wbGVPcHRpb25zKHQsInVpLWJ1dHRvbiIpfSxfY2hlY2tib3hyYWRpb09wdGlvbnM6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2J1aWxkU2ltcGxlT3B0aW9ucyh0LCJ1aS1jaGVja2JveHJhZGlvLWxhYmVsIil9LF9zZWxlY3RtZW51T3B0aW9uczpmdW5jdGlvbih0KXt2YXIgZT0idmVydGljYWwiPT09dGhpcy5vcHRpb25zLmRpcmVjdGlvbjtyZXR1cm57d2lkdGg6ZT8iYXV0byI6ITEsY2xhc3Nlczp7bWlkZGxlOnsidWktc2VsZWN0bWVudS1idXR0b24tb3BlbiI6IiIsInVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCI6IiJ9LGZpcnN0OnsidWktc2VsZWN0bWVudS1idXR0b24tb3BlbiI6InVpLWNvcm5lci0iKyhlPyJ0b3AiOiJ0bCIpLCJ1aS1zZWxlY3RtZW51LWJ1dHRvbi1jbG9zZWQiOiJ1aS1jb3JuZXItIisoZT8idG9wIjoibGVmdCIpfSxsYXN0OnsidWktc2VsZWN0bWVudS1idXR0b24tb3BlbiI6ZT8iIjoidWktY29ybmVyLXRyIiwidWktc2VsZWN0bWVudS1idXR0b24tY2xvc2VkIjoidWktY29ybmVyLSIrKGU/ImJvdHRvbSI6InJpZ2h0Iil9LG9ubHk6eyJ1aS1zZWxlY3RtZW51LWJ1dHRvbi1vcGVuIjoidWktY29ybmVyLXRvcCIsInVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCI6InVpLWNvcm5lci1hbGwifX1bdF19fSxfcmVzb2x2ZUNsYXNzZXNWYWx1ZXM6ZnVuY3Rpb24oZSxpKXt2YXIgcz17fTtyZXR1cm4gdC5lYWNoKGUsZnVuY3Rpb24obil7dmFyIG89aS5vcHRpb25zLmNsYXNzZXNbbl18fCIiO289dC50cmltKG8ucmVwbGFjZShnLCIiKSksc1tuXT0obysiICIrZVtuXSkucmVwbGFjZSgvXHMrL2csIiAiKX0pLHN9LF9zZXRPcHRpb246ZnVuY3Rpb24odCxlKXtyZXR1cm4iZGlyZWN0aW9uIj09PXQmJnRoaXMuX3JlbW92ZUNsYXNzKCJ1aS1jb250cm9sZ3JvdXAtIit0aGlzLm9wdGlvbnMuZGlyZWN0aW9uKSx0aGlzLl9zdXBlcih0LGUpLCJkaXNhYmxlZCI9PT10Pyh0aGlzLl9jYWxsQ2hpbGRNZXRob2QoZT8iZGlzYWJsZSI6ImVuYWJsZSIpLHZvaWQgMCk6KHRoaXMucmVmcmVzaCgpLHZvaWQgMCl9LHJlZnJlc2g6ZnVuY3Rpb24oKXt2YXIgZSxpPXRoaXM7dGhpcy5fYWRkQ2xhc3MoInVpLWNvbnRyb2xncm91cCB1aS1jb250cm9sZ3JvdXAtIit0aGlzLm9wdGlvbnMuZGlyZWN0aW9uKSwiaG9yaXpvbnRhbCI9PT10aGlzLm9wdGlvbnMuZGlyZWN0aW9uJiZ0aGlzLl9hZGRDbGFzcyhudWxsLCJ1aS1oZWxwZXItY2xlYXJmaXgiKSx0aGlzLl9pbml0V2lkZ2V0cygpLGU9dGhpcy5jaGlsZFdpZGdldHMsdGhpcy5vcHRpb25zLm9ubHlWaXNpYmxlJiYoZT1lLmZpbHRlcigiOnZpc2libGUiKSksZS5sZW5ndGgmJih0LmVhY2goWyJmaXJzdCIsImxhc3QiXSxmdW5jdGlvbih0LHMpe3ZhciBuPWVbc10oKS5kYXRhKCJ1aS1jb250cm9sZ3JvdXAtZGF0YSIpO2lmKG4mJmlbIl8iK24ud2lkZ2V0TmFtZSsiT3B0aW9ucyJdKXt2YXIgbz1pWyJfIituLndpZGdldE5hbWUrIk9wdGlvbnMiXSgxPT09ZS5sZW5ndGg/Im9ubHkiOnMpO28uY2xhc3Nlcz1pLl9yZXNvbHZlQ2xhc3Nlc1ZhbHVlcyhvLmNsYXNzZXMsbiksbi5lbGVtZW50W24ud2lkZ2V0TmFtZV0obyl9ZWxzZSBpLl91cGRhdGVDb3JuZXJDbGFzcyhlW3NdKCkscyl9KSx0aGlzLl9jYWxsQ2hpbGRNZXRob2QoInJlZnJlc2giKSl9fSksdC53aWRnZXQoInVpLmNoZWNrYm94cmFkaW8iLFt0LnVpLmZvcm1SZXNldE1peGluLHt2ZXJzaW9uOiIxLjEyLjEiLG9wdGlvbnM6e2Rpc2FibGVkOm51bGwsbGFiZWw6bnVsbCxpY29uOiEwLGNsYXNzZXM6eyJ1aS1jaGVja2JveHJhZGlvLWxhYmVsIjoidWktY29ybmVyLWFsbCIsInVpLWNoZWNrYm94cmFkaW8taWNvbiI6InVpLWNvcm5lci1hbGwifX0sX2dldENyZWF0ZU9wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgZSxpLHM9dGhpcyxuPXRoaXMuX3N1cGVyKCl8fHt9O3JldHVybiB0aGlzLl9yZWFkVHlwZSgpLGk9dGhpcy5lbGVtZW50LmxhYmVscygpLHRoaXMubGFiZWw9dChpW2kubGVuZ3RoLTFdKSx0aGlzLmxhYmVsLmxlbmd0aHx8dC5lcnJvcigiTm8gbGFiZWwgZm91bmQgZm9yIGNoZWNrYm94cmFkaW8gd2lkZ2V0IiksdGhpcy5vcmlnaW5hbExhYmVsPSIiLHRoaXMubGFiZWwuY29udGVudHMoKS5ub3QodGhpcy5lbGVtZW50WzBdKS5lYWNoKGZ1bmN0aW9uKCl7cy5vcmlnaW5hbExhYmVsKz0zPT09dGhpcy5ub2RlVHlwZT90KHRoaXMpLnRleHQoKTp0aGlzLm91dGVySFRNTH0pLHRoaXMub3JpZ2luYWxMYWJlbCYmKG4ubGFiZWw9dGhpcy5vcmlnaW5hbExhYmVsKSxlPXRoaXMuZWxlbWVudFswXS5kaXNhYmxlZCxudWxsIT1lJiYobi5kaXNhYmxlZD1lKSxufSxfY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50WzBdLmNoZWNrZWQ7dGhpcy5fYmluZEZvcm1SZXNldEhhbmRsZXIoKSxudWxsPT10aGlzLm9wdGlvbnMuZGlzYWJsZWQmJih0aGlzLm9wdGlvbnMuZGlzYWJsZWQ9dGhpcy5lbGVtZW50WzBdLmRpc2FibGVkKSx0aGlzLl9zZXRPcHRpb24oImRpc2FibGVkIix0aGlzLm9wdGlvbnMuZGlzYWJsZWQpLHRoaXMuX2FkZENsYXNzKCJ1aS1jaGVja2JveHJhZGlvIiwidWktaGVscGVyLWhpZGRlbi1hY2Nlc3NpYmxlIiksdGhpcy5fYWRkQ2xhc3ModGhpcy5sYWJlbCwidWktY2hlY2tib3hyYWRpby1sYWJlbCIsInVpLWJ1dHRvbiB1aS13aWRnZXQiKSwicmFkaW8iPT09dGhpcy50eXBlJiZ0aGlzLl9hZGRDbGFzcyh0aGlzLmxhYmVsLCJ1aS1jaGVja2JveHJhZGlvLXJhZGlvLWxhYmVsIiksdGhpcy5vcHRpb25zLmxhYmVsJiZ0aGlzLm9wdGlvbnMubGFiZWwhPT10aGlzLm9yaWdpbmFsTGFiZWw/dGhpcy5fdXBkYXRlTGFiZWwoKTp0aGlzLm9yaWdpbmFsTGFiZWwmJih0aGlzLm9wdGlvbnMubGFiZWw9dGhpcy5vcmlnaW5hbExhYmVsKSx0aGlzLl9lbmhhbmNlKCksdCYmKHRoaXMuX2FkZENsYXNzKHRoaXMubGFiZWwsInVpLWNoZWNrYm94cmFkaW8tY2hlY2tlZCIsInVpLXN0YXRlLWFjdGl2ZSIpLHRoaXMuaWNvbiYmdGhpcy5fYWRkQ2xhc3ModGhpcy5pY29uLG51bGwsInVpLXN0YXRlLWhvdmVyIikpLHRoaXMuX29uKHtjaGFuZ2U6Il90b2dnbGVDbGFzc2VzIixmb2N1czpmdW5jdGlvbigpe3RoaXMuX2FkZENsYXNzKHRoaXMubGFiZWwsbnVsbCwidWktc3RhdGUtZm9jdXMgdWktdmlzdWFsLWZvY3VzIil9LGJsdXI6ZnVuY3Rpb24oKXt0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLmxhYmVsLG51bGwsInVpLXN0YXRlLWZvY3VzIHVpLXZpc3VhbC1mb2N1cyIpfX0pfSxfcmVhZFR5cGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmVsZW1lbnRbMF0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTt0aGlzLnR5cGU9dGhpcy5lbGVtZW50WzBdLnR5cGUsImlucHV0Ij09PWUmJi9yYWRpb3xjaGVja2JveC8udGVzdCh0aGlzLnR5cGUpfHx0LmVycm9yKCJDYW4ndCBjcmVhdGUgY2hlY2tib3hyYWRpbyBvbiBlbGVtZW50Lm5vZGVOYW1lPSIrZSsiIGFuZCBlbGVtZW50LnR5cGU9Iit0aGlzLnR5cGUpfSxfZW5oYW5jZTpmdW5jdGlvbigpe3RoaXMuX3VwZGF0ZUljb24odGhpcy5lbGVtZW50WzBdLmNoZWNrZWQpfSx3aWRnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYWJlbH0sX2dldFJhZGlvR3JvdXA6ZnVuY3Rpb24oKXt2YXIgZSxpPXRoaXMuZWxlbWVudFswXS5uYW1lLHM9ImlucHV0W25hbWU9JyIrdC51aS5lc2NhcGVTZWxlY3RvcihpKSsiJ10iO3JldHVybiBpPyhlPXRoaXMuZm9ybS5sZW5ndGg/dCh0aGlzLmZvcm1bMF0uZWxlbWVudHMpLmZpbHRlcihzKTp0KHMpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAwPT09dCh0aGlzKS5mb3JtKCkubGVuZ3RofSksZS5ub3QodGhpcy5lbGVtZW50KSk6dChbXSl9LF90b2dnbGVDbGFzc2VzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5lbGVtZW50WzBdLmNoZWNrZWQ7dGhpcy5fdG9nZ2xlQ2xhc3ModGhpcy5sYWJlbCwidWktY2hlY2tib3hyYWRpby1jaGVja2VkIiwidWktc3RhdGUtYWN0aXZlIixlKSx0aGlzLm9wdGlvbnMuaWNvbiYmImNoZWNrYm94Ij09PXRoaXMudHlwZSYmdGhpcy5fdG9nZ2xlQ2xhc3ModGhpcy5pY29uLG51bGwsInVpLWljb24tY2hlY2sgdWktc3RhdGUtY2hlY2tlZCIsZSkuX3RvZ2dsZUNsYXNzKHRoaXMuaWNvbixudWxsLCJ1aS1pY29uLWJsYW5rIiwhZSksInJhZGlvIj09PXRoaXMudHlwZSYmdGhpcy5fZ2V0UmFkaW9Hcm91cCgpLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLmNoZWNrYm94cmFkaW8oImluc3RhbmNlIik7ZSYmZS5fcmVtb3ZlQ2xhc3MoZS5sYWJlbCwidWktY2hlY2tib3hyYWRpby1jaGVja2VkIiwidWktc3RhdGUtYWN0aXZlIil9KX0sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLl91bmJpbmRGb3JtUmVzZXRIYW5kbGVyKCksdGhpcy5pY29uJiYodGhpcy5pY29uLnJlbW92ZSgpLHRoaXMuaWNvblNwYWNlLnJlbW92ZSgpKX0sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3JldHVybiJsYWJlbCIhPT10fHxlPyh0aGlzLl9zdXBlcih0LGUpLCJkaXNhYmxlZCI9PT10Pyh0aGlzLl90b2dnbGVDbGFzcyh0aGlzLmxhYmVsLG51bGwsInVpLXN0YXRlLWRpc2FibGVkIixlKSx0aGlzLmVsZW1lbnRbMF0uZGlzYWJsZWQ9ZSx2b2lkIDApOih0aGlzLnJlZnJlc2goKSx2b2lkIDApKTp2b2lkIDB9LF91cGRhdGVJY29uOmZ1bmN0aW9uKGUpe3ZhciBpPSJ1aS1pY29uIHVpLWljb24tYmFja2dyb3VuZCAiO3RoaXMub3B0aW9ucy5pY29uPyh0aGlzLmljb258fCh0aGlzLmljb249dCgiPHNwYW4+IiksdGhpcy5pY29uU3BhY2U9dCgiPHNwYW4+IDwvc3Bhbj4iKSx0aGlzLl9hZGRDbGFzcyh0aGlzLmljb25TcGFjZSwidWktY2hlY2tib3hyYWRpby1pY29uLXNwYWNlIikpLCJjaGVja2JveCI9PT10aGlzLnR5cGU/KGkrPWU/InVpLWljb24tY2hlY2sgdWktc3RhdGUtY2hlY2tlZCI6InVpLWljb24tYmxhbmsiLHRoaXMuX3JlbW92ZUNsYXNzKHRoaXMuaWNvbixudWxsLGU/InVpLWljb24tYmxhbmsiOiJ1aS1pY29uLWNoZWNrIikpOmkrPSJ1aS1pY29uLWJsYW5rIix0aGlzLl9hZGRDbGFzcyh0aGlzLmljb24sInVpLWNoZWNrYm94cmFkaW8taWNvbiIsaSksZXx8dGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5pY29uLG51bGwsInVpLWljb24tY2hlY2sgdWktc3RhdGUtY2hlY2tlZCIpLHRoaXMuaWNvbi5wcmVwZW5kVG8odGhpcy5sYWJlbCkuYWZ0ZXIodGhpcy5pY29uU3BhY2UpKTp2b2lkIDAhPT10aGlzLmljb24mJih0aGlzLmljb24ucmVtb3ZlKCksdGhpcy5pY29uU3BhY2UucmVtb3ZlKCksZGVsZXRlIHRoaXMuaWNvbil9LF91cGRhdGVMYWJlbDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubGFiZWwuY29udGVudHMoKS5ub3QodGhpcy5lbGVtZW50WzBdKTt0aGlzLmljb24mJih0PXQubm90KHRoaXMuaWNvblswXSkpLHRoaXMuaWNvblNwYWNlJiYodD10Lm5vdCh0aGlzLmljb25TcGFjZVswXSkpLHQucmVtb3ZlKCksdGhpcy5sYWJlbC5hcHBlbmQodGhpcy5vcHRpb25zLmxhYmVsKX0scmVmcmVzaDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuZWxlbWVudFswXS5jaGVja2VkLGU9dGhpcy5lbGVtZW50WzBdLmRpc2FibGVkO3RoaXMuX3VwZGF0ZUljb24odCksdGhpcy5fdG9nZ2xlQ2xhc3ModGhpcy5sYWJlbCwidWktY2hlY2tib3hyYWRpby1jaGVja2VkIiwidWktc3RhdGUtYWN0aXZlIix0KSxudWxsIT09dGhpcy5vcHRpb25zLmxhYmVsJiZ0aGlzLl91cGRhdGVMYWJlbCgpLGUhPT10aGlzLm9wdGlvbnMuZGlzYWJsZWQmJnRoaXMuX3NldE9wdGlvbnMoe2Rpc2FibGVkOmV9KX19XSksdC51aS5jaGVja2JveHJhZGlvLHQud2lkZ2V0KCJ1aS5idXR0b24iLHt2ZXJzaW9uOiIxLjEyLjEiLGRlZmF1bHRFbGVtZW50OiI8YnV0dG9uPiIsb3B0aW9uczp7Y2xhc3Nlczp7InVpLWJ1dHRvbiI6InVpLWNvcm5lci1hbGwifSxkaXNhYmxlZDpudWxsLGljb246bnVsbCxpY29uUG9zaXRpb246ImJlZ2lubmluZyIsbGFiZWw6bnVsbCxzaG93TGFiZWw6ITB9LF9nZXRDcmVhdGVPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLl9zdXBlcigpfHx7fTtyZXR1cm4gdGhpcy5pc0lucHV0PXRoaXMuZWxlbWVudC5pcygiaW5wdXQiKSx0PXRoaXMuZWxlbWVudFswXS5kaXNhYmxlZCxudWxsIT10JiYoZS5kaXNhYmxlZD10KSx0aGlzLm9yaWdpbmFsTGFiZWw9dGhpcy5pc0lucHV0P3RoaXMuZWxlbWVudC52YWwoKTp0aGlzLmVsZW1lbnQuaHRtbCgpLHRoaXMub3JpZ2luYWxMYWJlbCYmKGUubGFiZWw9dGhpcy5vcmlnaW5hbExhYmVsKSxlfSxfY3JlYXRlOmZ1bmN0aW9uKCl7IXRoaXMub3B0aW9uLnNob3dMYWJlbCYhdGhpcy5vcHRpb25zLmljb24mJih0aGlzLm9wdGlvbnMuc2hvd0xhYmVsPSEwKSxudWxsPT10aGlzLm9wdGlvbnMuZGlzYWJsZWQmJih0aGlzLm9wdGlvbnMuZGlzYWJsZWQ9dGhpcy5lbGVtZW50WzBdLmRpc2FibGVkfHwhMSksdGhpcy5oYXNUaXRsZT0hIXRoaXMuZWxlbWVudC5hdHRyKCJ0aXRsZSIpLHRoaXMub3B0aW9ucy5sYWJlbCYmdGhpcy5vcHRpb25zLmxhYmVsIT09dGhpcy5vcmlnaW5hbExhYmVsJiYodGhpcy5pc0lucHV0P3RoaXMuZWxlbWVudC52YWwodGhpcy5vcHRpb25zLmxhYmVsKTp0aGlzLmVsZW1lbnQuaHRtbCh0aGlzLm9wdGlvbnMubGFiZWwpKSx0aGlzLl9hZGRDbGFzcygidWktYnV0dG9uIiwidWktd2lkZ2V0IiksdGhpcy5fc2V0T3B0aW9uKCJkaXNhYmxlZCIsdGhpcy5vcHRpb25zLmRpc2FibGVkKSx0aGlzLl9lbmhhbmNlKCksdGhpcy5lbGVtZW50LmlzKCJhIikmJnRoaXMuX29uKHtrZXl1cDpmdW5jdGlvbihlKXtlLmtleUNvZGU9PT10LnVpLmtleUNvZGUuU1BBQ0UmJihlLnByZXZlbnREZWZhdWx0KCksdGhpcy5lbGVtZW50WzBdLmNsaWNrP3RoaXMuZWxlbWVudFswXS5jbGljaygpOnRoaXMuZWxlbWVudC50cmlnZ2VyKCJjbGljayIpKX19KX0sX2VuaGFuY2U6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQuaXMoImJ1dHRvbiIpfHx0aGlzLmVsZW1lbnQuYXR0cigicm9sZSIsImJ1dHRvbiIpLHRoaXMub3B0aW9ucy5pY29uJiYodGhpcy5fdXBkYXRlSWNvbigiaWNvbiIsdGhpcy5vcHRpb25zLmljb24pLHRoaXMuX3VwZGF0ZVRvb2x0aXAoKSl9LF91cGRhdGVUb29sdGlwOmZ1bmN0aW9uKCl7dGhpcy50aXRsZT10aGlzLmVsZW1lbnQuYXR0cigidGl0bGUiKSx0aGlzLm9wdGlvbnMuc2hvd0xhYmVsfHx0aGlzLnRpdGxlfHx0aGlzLmVsZW1lbnQuYXR0cigidGl0bGUiLHRoaXMub3B0aW9ucy5sYWJlbCl9LF91cGRhdGVJY29uOmZ1bmN0aW9uKGUsaSl7dmFyIHM9Imljb25Qb3NpdGlvbiIhPT1lLG49cz90aGlzLm9wdGlvbnMuaWNvblBvc2l0aW9uOmksbz0idG9wIj09PW58fCJib3R0b20iPT09bjt0aGlzLmljb24/cyYmdGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5pY29uLG51bGwsdGhpcy5vcHRpb25zLmljb24pOih0aGlzLmljb249dCgiPHNwYW4+IiksdGhpcy5fYWRkQ2xhc3ModGhpcy5pY29uLCJ1aS1idXR0b24taWNvbiIsInVpLWljb24iKSx0aGlzLm9wdGlvbnMuc2hvd0xhYmVsfHx0aGlzLl9hZGRDbGFzcygidWktYnV0dG9uLWljb24tb25seSIpKSxzJiZ0aGlzLl9hZGRDbGFzcyh0aGlzLmljb24sbnVsbCxpKSx0aGlzLl9hdHRhY2hJY29uKG4pLG8/KHRoaXMuX2FkZENsYXNzKHRoaXMuaWNvbixudWxsLCJ1aS13aWRnZXQtaWNvbi1ibG9jayIpLHRoaXMuaWNvblNwYWNlJiZ0aGlzLmljb25TcGFjZS5yZW1vdmUoKSk6KHRoaXMuaWNvblNwYWNlfHwodGhpcy5pY29uU3BhY2U9dCgiPHNwYW4+IDwvc3Bhbj4iKSx0aGlzLl9hZGRDbGFzcyh0aGlzLmljb25TcGFjZSwidWktYnV0dG9uLWljb24tc3BhY2UiKSksdGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5pY29uLG51bGwsInVpLXdpZ2V0LWljb24tYmxvY2siKSx0aGlzLl9hdHRhY2hJY29uU3BhY2UobikpfSxfZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCJyb2xlIiksdGhpcy5pY29uJiZ0aGlzLmljb24ucmVtb3ZlKCksdGhpcy5pY29uU3BhY2UmJnRoaXMuaWNvblNwYWNlLnJlbW92ZSgpLHRoaXMuaGFzVGl0bGV8fHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyKCJ0aXRsZSIpfSxfYXR0YWNoSWNvblNwYWNlOmZ1bmN0aW9uKHQpe3RoaXMuaWNvblsvXig/OmVuZHxib3R0b20pLy50ZXN0KHQpPyJiZWZvcmUiOiJhZnRlciJdKHRoaXMuaWNvblNwYWNlKX0sX2F0dGFjaEljb246ZnVuY3Rpb24odCl7dGhpcy5lbGVtZW50Wy9eKD86ZW5kfGJvdHRvbSkvLnRlc3QodCk/ImFwcGVuZCI6InByZXBlbmQiXSh0aGlzLmljb24pfSxfc2V0T3B0aW9uczpmdW5jdGlvbih0KXt2YXIgZT12b2lkIDA9PT10LnNob3dMYWJlbD90aGlzLm9wdGlvbnMuc2hvd0xhYmVsOnQuc2hvd0xhYmVsLGk9dm9pZCAwPT09dC5pY29uP3RoaXMub3B0aW9ucy5pY29uOnQuaWNvbjtlfHxpfHwodC5zaG93TGFiZWw9ITApLHRoaXMuX3N1cGVyKHQpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKHQsZSl7Imljb24iPT09dCYmKGU/dGhpcy5fdXBkYXRlSWNvbih0LGUpOnRoaXMuaWNvbiYmKHRoaXMuaWNvbi5yZW1vdmUoKSx0aGlzLmljb25TcGFjZSYmdGhpcy5pY29uU3BhY2UucmVtb3ZlKCkpKSwiaWNvblBvc2l0aW9uIj09PXQmJnRoaXMuX3VwZGF0ZUljb24odCxlKSwic2hvd0xhYmVsIj09PXQmJih0aGlzLl90b2dnbGVDbGFzcygidWktYnV0dG9uLWljb24tb25seSIsbnVsbCwhZSksdGhpcy5fdXBkYXRlVG9vbHRpcCgpKSwibGFiZWwiPT09dCYmKHRoaXMuaXNJbnB1dD90aGlzLmVsZW1lbnQudmFsKGUpOih0aGlzLmVsZW1lbnQuaHRtbChlKSx0aGlzLmljb24mJih0aGlzLl9hdHRhY2hJY29uKHRoaXMub3B0aW9ucy5pY29uUG9zaXRpb24pLHRoaXMuX2F0dGFjaEljb25TcGFjZSh0aGlzLm9wdGlvbnMuaWNvblBvc2l0aW9uKSkpKSx0aGlzLl9zdXBlcih0LGUpLCJkaXNhYmxlZCI9PT10JiYodGhpcy5fdG9nZ2xlQ2xhc3MobnVsbCwidWktc3RhdGUtZGlzYWJsZWQiLGUpLHRoaXMuZWxlbWVudFswXS5kaXNhYmxlZD1lLGUmJnRoaXMuZWxlbWVudC5ibHVyKCkpfSxyZWZyZXNoOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5lbGVtZW50LmlzKCJpbnB1dCwgYnV0dG9uIik/dGhpcy5lbGVtZW50WzBdLmRpc2FibGVkOnRoaXMuZWxlbWVudC5oYXNDbGFzcygidWktYnV0dG9uLWRpc2FibGVkIik7dCE9PXRoaXMub3B0aW9ucy5kaXNhYmxlZCYmdGhpcy5fc2V0T3B0aW9ucyh7ZGlzYWJsZWQ6dH0pLHRoaXMuX3VwZGF0ZVRvb2x0aXAoKX19KSx0LnVpQmFja0NvbXBhdCE9PSExJiYodC53aWRnZXQoInVpLmJ1dHRvbiIsdC51aS5idXR0b24se29wdGlvbnM6e3RleHQ6ITAsaWNvbnM6e3ByaW1hcnk6bnVsbCxzZWNvbmRhcnk6bnVsbH19LF9jcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuc2hvd0xhYmVsJiYhdGhpcy5vcHRpb25zLnRleHQmJih0aGlzLm9wdGlvbnMuc2hvd0xhYmVsPXRoaXMub3B0aW9ucy50ZXh0KSwhdGhpcy5vcHRpb25zLnNob3dMYWJlbCYmdGhpcy5vcHRpb25zLnRleHQmJih0aGlzLm9wdGlvbnMudGV4dD10aGlzLm9wdGlvbnMuc2hvd0xhYmVsKSx0aGlzLm9wdGlvbnMuaWNvbnx8IXRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5JiYhdGhpcy5vcHRpb25zLmljb25zLnNlY29uZGFyeT90aGlzLm9wdGlvbnMuaWNvbiYmKHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5PXRoaXMub3B0aW9ucy5pY29uKTp0aGlzLm9wdGlvbnMuaWNvbnMucHJpbWFyeT90aGlzLm9wdGlvbnMuaWNvbj10aGlzLm9wdGlvbnMuaWNvbnMucHJpbWFyeToodGhpcy5vcHRpb25zLmljb249dGhpcy5vcHRpb25zLmljb25zLnNlY29uZGFyeSx0aGlzLm9wdGlvbnMuaWNvblBvc2l0aW9uPSJlbmQiKSx0aGlzLl9zdXBlcigpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInRleHQiPT09dD8odGhpcy5fc3VwZXIoInNob3dMYWJlbCIsZSksdm9pZCAwKTooInNob3dMYWJlbCI9PT10JiYodGhpcy5vcHRpb25zLnRleHQ9ZSksImljb24iPT09dCYmKHRoaXMub3B0aW9ucy5pY29ucy5wcmltYXJ5PWUpLCJpY29ucyI9PT10JiYoZS5wcmltYXJ5Pyh0aGlzLl9zdXBlcigiaWNvbiIsZS5wcmltYXJ5KSx0aGlzLl9zdXBlcigiaWNvblBvc2l0aW9uIiwiYmVnaW5uaW5nIikpOmUuc2Vjb25kYXJ5JiYodGhpcy5fc3VwZXIoImljb24iLGUuc2Vjb25kYXJ5KSx0aGlzLl9zdXBlcigiaWNvblBvc2l0aW9uIiwiZW5kIikpKSx0aGlzLl9zdXBlckFwcGx5KGFyZ3VtZW50cyksdm9pZCAwKX19KSx0LmZuLmJ1dHRvbj1mdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4hdGhpcy5sZW5ndGh8fHRoaXMubGVuZ3RoJiYiSU5QVVQiIT09dGhpc1swXS50YWdOYW1lfHx0aGlzLmxlbmd0aCYmIklOUFVUIj09PXRoaXNbMF0udGFnTmFtZSYmImNoZWNrYm94IiE9PXRoaXMuYXR0cigidHlwZSIpJiYicmFkaW8iIT09dGhpcy5hdHRyKCJ0eXBlIik/ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk6KHQudWkuY2hlY2tib3hyYWRpb3x8dC5lcnJvcigiQ2hlY2tib3hyYWRpbyB3aWRnZXQgbWlzc2luZyIpLDA9PT1hcmd1bWVudHMubGVuZ3RoP3RoaXMuY2hlY2tib3hyYWRpbyh7aWNvbjohMX0pOnRoaXMuY2hlY2tib3hyYWRpby5hcHBseSh0aGlzLGFyZ3VtZW50cykpfX0odC5mbi5idXR0b24pLHQuZm4uYnV0dG9uc2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHQudWkuY29udHJvbGdyb3VwfHx0LmVycm9yKCJDb250cm9sZ3JvdXAgd2lkZ2V0IG1pc3NpbmciKSwib3B0aW9uIj09PWFyZ3VtZW50c1swXSYmIml0ZW1zIj09PWFyZ3VtZW50c1sxXSYmYXJndW1lbnRzWzJdP3RoaXMuY29udHJvbGdyb3VwLmFwcGx5KHRoaXMsW2FyZ3VtZW50c1swXSwiaXRlbXMuYnV0dG9uIixhcmd1bWVudHNbMl1dKToib3B0aW9uIj09PWFyZ3VtZW50c1swXSYmIml0ZW1zIj09PWFyZ3VtZW50c1sxXT90aGlzLmNvbnRyb2xncm91cC5hcHBseSh0aGlzLFthcmd1bWVudHNbMF0sIml0ZW1zLmJ1dHRvbiJdKTooIm9iamVjdCI9PXR5cGVvZiBhcmd1bWVudHNbMF0mJmFyZ3VtZW50c1swXS5pdGVtcyYmKGFyZ3VtZW50c1swXS5pdGVtcz17YnV0dG9uOmFyZ3VtZW50c1swXS5pdGVtc30pLHRoaXMuY29udHJvbGdyb3VwLmFwcGx5KHRoaXMsYXJndW1lbnRzKSl9KSx0LnVpLmJ1dHRvbix0LmV4dGVuZCh0LnVpLHtkYXRlcGlja2VyOnt2ZXJzaW9uOiIxLjEyLjEifX0pO3ZhciBtO3QuZXh0ZW5kKHMucHJvdG90eXBlLHttYXJrZXJDbGFzc05hbWU6Imhhc0RhdGVwaWNrZXIiLG1heFJvd3M6NCxfd2lkZ2V0RGF0ZXBpY2tlcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmRwRGl2fSxzZXREZWZhdWx0czpmdW5jdGlvbih0KXtyZXR1cm4gYSh0aGlzLl9kZWZhdWx0cyx0fHx7fSksdGhpc30sX2F0dGFjaERhdGVwaWNrZXI6ZnVuY3Rpb24oZSxpKXt2YXIgcyxuLG87cz1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksbj0iZGl2Ij09PXN8fCJzcGFuIj09PXMsZS5pZHx8KHRoaXMudXVpZCs9MSxlLmlkPSJkcCIrdGhpcy51dWlkKSxvPXRoaXMuX25ld0luc3QodChlKSxuKSxvLnNldHRpbmdzPXQuZXh0ZW5kKHt9LGl8fHt9KSwiaW5wdXQiPT09cz90aGlzLl9jb25uZWN0RGF0ZXBpY2tlcihlLG8pOm4mJnRoaXMuX2lubGluZURhdGVwaWNrZXIoZSxvKX0sX25ld0luc3Q6ZnVuY3Rpb24oZSxpKXt2YXIgcz1lWzBdLmlkLnJlcGxhY2UoLyhbXkEtWmEtejAtOV9cLV0pL2csIlxcXFwkMSIpO3JldHVybntpZDpzLGlucHV0OmUsc2VsZWN0ZWREYXk6MCxzZWxlY3RlZE1vbnRoOjAsc2VsZWN0ZWRZZWFyOjAsZHJhd01vbnRoOjAsZHJhd1llYXI6MCxpbmxpbmU6aSxkcERpdjppP24odCgiPGRpdiBjbGFzcz0nIit0aGlzLl9pbmxpbmVDbGFzcysiIHVpLWRhdGVwaWNrZXIgdWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IHVpLWhlbHBlci1jbGVhcmZpeCB1aS1jb3JuZXItYWxsJz48L2Rpdj4iKSk6dGhpcy5kcERpdn19LF9jb25uZWN0RGF0ZXBpY2tlcjpmdW5jdGlvbihlLGkpe3ZhciBzPXQoZSk7aS5hcHBlbmQ9dChbXSksaS50cmlnZ2VyPXQoW10pLHMuaGFzQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpfHwodGhpcy5fYXR0YWNobWVudHMocyxpKSxzLmFkZENsYXNzKHRoaXMubWFya2VyQ2xhc3NOYW1lKS5vbigia2V5ZG93biIsdGhpcy5fZG9LZXlEb3duKS5vbigia2V5cHJlc3MiLHRoaXMuX2RvS2V5UHJlc3MpLm9uKCJrZXl1cCIsdGhpcy5fZG9LZXlVcCksdGhpcy5fYXV0b1NpemUoaSksdC5kYXRhKGUsImRhdGVwaWNrZXIiLGkpLGkuc2V0dGluZ3MuZGlzYWJsZWQmJnRoaXMuX2Rpc2FibGVEYXRlcGlja2VyKGUpKX0sX2F0dGFjaG1lbnRzOmZ1bmN0aW9uKGUsaSl7dmFyIHMsbixvLGE9dGhpcy5fZ2V0KGksImFwcGVuZFRleHQiKSxyPXRoaXMuX2dldChpLCJpc1JUTCIpO2kuYXBwZW5kJiZpLmFwcGVuZC5yZW1vdmUoKSxhJiYoaS5hcHBlbmQ9dCgiPHNwYW4gY2xhc3M9JyIrdGhpcy5fYXBwZW5kQ2xhc3MrIic+IithKyI8L3NwYW4+IiksZVtyPyJiZWZvcmUiOiJhZnRlciJdKGkuYXBwZW5kKSksZS5vZmYoImZvY3VzIix0aGlzLl9zaG93RGF0ZXBpY2tlciksaS50cmlnZ2VyJiZpLnRyaWdnZXIucmVtb3ZlKCkscz10aGlzLl9nZXQoaSwic2hvd09uIiksKCJmb2N1cyI9PT1zfHwiYm90aCI9PT1zKSYmZS5vbigiZm9jdXMiLHRoaXMuX3Nob3dEYXRlcGlja2VyKSwoImJ1dHRvbiI9PT1zfHwiYm90aCI9PT1zKSYmKG49dGhpcy5fZ2V0KGksImJ1dHRvblRleHQiKSxvPXRoaXMuX2dldChpLCJidXR0b25JbWFnZSIpLGkudHJpZ2dlcj10KHRoaXMuX2dldChpLCJidXR0b25JbWFnZU9ubHkiKT90KCI8aW1nLz4iKS5hZGRDbGFzcyh0aGlzLl90cmlnZ2VyQ2xhc3MpLmF0dHIoe3NyYzpvLGFsdDpuLHRpdGxlOm59KTp0KCI8YnV0dG9uIHR5cGU9J2J1dHRvbic+PC9idXR0b24+IikuYWRkQ2xhc3ModGhpcy5fdHJpZ2dlckNsYXNzKS5odG1sKG8/dCgiPGltZy8+IikuYXR0cih7c3JjOm8sYWx0Om4sdGl0bGU6bn0pOm4pKSxlW3I/ImJlZm9yZSI6ImFmdGVyIl0oaS50cmlnZ2VyKSxpLnRyaWdnZXIub24oImNsaWNrIixmdW5jdGlvbigpe3JldHVybiB0LmRhdGVwaWNrZXIuX2RhdGVwaWNrZXJTaG93aW5nJiZ0LmRhdGVwaWNrZXIuX2xhc3RJbnB1dD09PWVbMF0/dC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpOnQuZGF0ZXBpY2tlci5fZGF0ZXBpY2tlclNob3dpbmcmJnQuZGF0ZXBpY2tlci5fbGFzdElucHV0IT09ZVswXT8odC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpLHQuZGF0ZXBpY2tlci5fc2hvd0RhdGVwaWNrZXIoZVswXSkpOnQuZGF0ZXBpY2tlci5fc2hvd0RhdGVwaWNrZXIoZVswXSksITF9KSl9LF9hdXRvU2l6ZTpmdW5jdGlvbih0KXtpZih0aGlzLl9nZXQodCwiYXV0b1NpemUiKSYmIXQuaW5saW5lKXt2YXIgZSxpLHMsbixvPW5ldyBEYXRlKDIwMDksMTEsMjApLGE9dGhpcy5fZ2V0KHQsImRhdGVGb3JtYXQiKTthLm1hdGNoKC9bRE1dLykmJihlPWZ1bmN0aW9uKHQpe2ZvcihpPTAscz0wLG49MDt0Lmxlbmd0aD5uO24rKyl0W25dLmxlbmd0aD5pJiYoaT10W25dLmxlbmd0aCxzPW4pO3JldHVybiBzfSxvLnNldE1vbnRoKGUodGhpcy5fZ2V0KHQsYS5tYXRjaCgvTU0vKT8ibW9udGhOYW1lcyI6Im1vbnRoTmFtZXNTaG9ydCIpKSksby5zZXREYXRlKGUodGhpcy5fZ2V0KHQsYS5tYXRjaCgvREQvKT8iZGF5TmFtZXMiOiJkYXlOYW1lc1Nob3J0IikpKzIwLW8uZ2V0RGF5KCkpKSx0LmlucHV0LmF0dHIoInNpemUiLHRoaXMuX2Zvcm1hdERhdGUodCxvKS5sZW5ndGgpfX0sX2lubGluZURhdGVwaWNrZXI6ZnVuY3Rpb24oZSxpKXt2YXIgcz10KGUpO3MuaGFzQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpfHwocy5hZGRDbGFzcyh0aGlzLm1hcmtlckNsYXNzTmFtZSkuYXBwZW5kKGkuZHBEaXYpLHQuZGF0YShlLCJkYXRlcGlja2VyIixpKSx0aGlzLl9zZXREYXRlKGksdGhpcy5fZ2V0RGVmYXVsdERhdGUoaSksITApLHRoaXMuX3VwZGF0ZURhdGVwaWNrZXIoaSksdGhpcy5fdXBkYXRlQWx0ZXJuYXRlKGkpLGkuc2V0dGluZ3MuZGlzYWJsZWQmJnRoaXMuX2Rpc2FibGVEYXRlcGlja2VyKGUpLGkuZHBEaXYuY3NzKCJkaXNwbGF5IiwiYmxvY2siKSl9LF9kaWFsb2dEYXRlcGlja2VyOmZ1bmN0aW9uKGUsaSxzLG4sbyl7dmFyIHIsaCxsLGMsdSxkPXRoaXMuX2RpYWxvZ0luc3Q7cmV0dXJuIGR8fCh0aGlzLnV1aWQrPTEscj0iZHAiK3RoaXMudXVpZCx0aGlzLl9kaWFsb2dJbnB1dD10KCI8aW5wdXQgdHlwZT0ndGV4dCcgaWQ9JyIrcisiJyBzdHlsZT0ncG9zaXRpb246IGFic29sdXRlOyB0b3A6IC0xMDBweDsgd2lkdGg6IDBweDsnLz4iKSx0aGlzLl9kaWFsb2dJbnB1dC5vbigia2V5ZG93biIsdGhpcy5fZG9LZXlEb3duKSx0KCJib2R5IikuYXBwZW5kKHRoaXMuX2RpYWxvZ0lucHV0KSxkPXRoaXMuX2RpYWxvZ0luc3Q9dGhpcy5fbmV3SW5zdCh0aGlzLl9kaWFsb2dJbnB1dCwhMSksZC5zZXR0aW5ncz17fSx0LmRhdGEodGhpcy5fZGlhbG9nSW5wdXRbMF0sImRhdGVwaWNrZXIiLGQpKSxhKGQuc2V0dGluZ3Msbnx8e30pLGk9aSYmaS5jb25zdHJ1Y3Rvcj09PURhdGU/dGhpcy5fZm9ybWF0RGF0ZShkLGkpOmksdGhpcy5fZGlhbG9nSW5wdXQudmFsKGkpLHRoaXMuX3Bvcz1vP28ubGVuZ3RoP286W28ucGFnZVgsby5wYWdlWV06bnVsbCx0aGlzLl9wb3N8fChoPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCxsPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQsYz1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdHx8ZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0LHU9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcHx8ZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsdGhpcy5fcG9zPVtoLzItMTAwK2MsbC8yLTE1MCt1XSksdGhpcy5fZGlhbG9nSW5wdXQuY3NzKCJsZWZ0Iix0aGlzLl9wb3NbMF0rMjArInB4IikuY3NzKCJ0b3AiLHRoaXMuX3Bvc1sxXSsicHgiKSxkLnNldHRpbmdzLm9uU2VsZWN0PXMsdGhpcy5faW5EaWFsb2c9ITAsdGhpcy5kcERpdi5hZGRDbGFzcyh0aGlzLl9kaWFsb2dDbGFzcyksdGhpcy5fc2hvd0RhdGVwaWNrZXIodGhpcy5fZGlhbG9nSW5wdXRbMF0pLHQuYmxvY2tVSSYmdC5ibG9ja1VJKHRoaXMuZHBEaXYpLHQuZGF0YSh0aGlzLl9kaWFsb2dJbnB1dFswXSwiZGF0ZXBpY2tlciIsZCksdGhpc30sX2Rlc3Ryb3lEYXRlcGlja2VyOmZ1bmN0aW9uKGUpe3ZhciBpLHM9dChlKSxuPXQuZGF0YShlLCJkYXRlcGlja2VyIik7cy5oYXNDbGFzcyh0aGlzLm1hcmtlckNsYXNzTmFtZSkmJihpPWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSx0LnJlbW92ZURhdGEoZSwiZGF0ZXBpY2tlciIpLCJpbnB1dCI9PT1pPyhuLmFwcGVuZC5yZW1vdmUoKSxuLnRyaWdnZXIucmVtb3ZlKCkscy5yZW1vdmVDbGFzcyh0aGlzLm1hcmtlckNsYXNzTmFtZSkub2ZmKCJmb2N1cyIsdGhpcy5fc2hvd0RhdGVwaWNrZXIpLm9mZigia2V5ZG93biIsdGhpcy5fZG9LZXlEb3duKS5vZmYoImtleXByZXNzIix0aGlzLl9kb0tleVByZXNzKS5vZmYoImtleXVwIix0aGlzLl9kb0tleVVwKSk6KCJkaXYiPT09aXx8InNwYW4iPT09aSkmJnMucmVtb3ZlQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpLmVtcHR5KCksbT09PW4mJihtPW51bGwpKX0sX2VuYWJsZURhdGVwaWNrZXI6ZnVuY3Rpb24oZSl7dmFyIGkscyxuPXQoZSksbz10LmRhdGEoZSwiZGF0ZXBpY2tlciIpO24uaGFzQ2xhc3ModGhpcy5tYXJrZXJDbGFzc05hbWUpJiYoaT1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksImlucHV0Ij09PWk/KGUuZGlzYWJsZWQ9ITEsby50cmlnZ2VyLmZpbHRlcigiYnV0dG9uIikuZWFjaChmdW5jdGlvbigpe3RoaXMuZGlzYWJsZWQ9ITF9KS5lbmQoKS5maWx0ZXIoImltZyIpLmNzcyh7b3BhY2l0eToiMS4wIixjdXJzb3I6IiJ9KSk6KCJkaXYiPT09aXx8InNwYW4iPT09aSkmJihzPW4uY2hpbGRyZW4oIi4iK3RoaXMuX2lubGluZUNsYXNzKSxzLmNoaWxkcmVuKCkucmVtb3ZlQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIikscy5maW5kKCJzZWxlY3QudWktZGF0ZXBpY2tlci1tb250aCwgc2VsZWN0LnVpLWRhdGVwaWNrZXIteWVhciIpLnByb3AoImRpc2FibGVkIiwhMSkpLHRoaXMuX2Rpc2FibGVkSW5wdXRzPXQubWFwKHRoaXMuX2Rpc2FibGVkSW5wdXRzLGZ1bmN0aW9uKHQpe3JldHVybiB0PT09ZT9udWxsOnR9KSl9LF9kaXNhYmxlRGF0ZXBpY2tlcjpmdW5jdGlvbihlKXt2YXIgaSxzLG49dChlKSxvPXQuZGF0YShlLCJkYXRlcGlja2VyIik7bi5oYXNDbGFzcyh0aGlzLm1hcmtlckNsYXNzTmFtZSkmJihpPWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSwiaW5wdXQiPT09aT8oZS5kaXNhYmxlZD0hMCxvLnRyaWdnZXIuZmlsdGVyKCJidXR0b24iKS5lYWNoKGZ1bmN0aW9uKCl7dGhpcy5kaXNhYmxlZD0hMH0pLmVuZCgpLmZpbHRlcigiaW1nIikuY3NzKHtvcGFjaXR5OiIwLjUiLGN1cnNvcjoiZGVmYXVsdCJ9KSk6KCJkaXYiPT09aXx8InNwYW4iPT09aSkmJihzPW4uY2hpbGRyZW4oIi4iK3RoaXMuX2lubGluZUNsYXNzKSxzLmNoaWxkcmVuKCkuYWRkQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIikscy5maW5kKCJzZWxlY3QudWktZGF0ZXBpY2tlci1tb250aCwgc2VsZWN0LnVpLWRhdGVwaWNrZXIteWVhciIpLnByb3AoImRpc2FibGVkIiwhMCkpLHRoaXMuX2Rpc2FibGVkSW5wdXRzPXQubWFwKHRoaXMuX2Rpc2FibGVkSW5wdXRzLGZ1bmN0aW9uKHQpe3JldHVybiB0PT09ZT9udWxsOnR9KSx0aGlzLl9kaXNhYmxlZElucHV0c1t0aGlzLl9kaXNhYmxlZElucHV0cy5sZW5ndGhdPWUpfSxfaXNEaXNhYmxlZERhdGVwaWNrZXI6ZnVuY3Rpb24odCl7aWYoIXQpcmV0dXJuITE7Zm9yKHZhciBlPTA7dGhpcy5fZGlzYWJsZWRJbnB1dHMubGVuZ3RoPmU7ZSsrKWlmKHRoaXMuX2Rpc2FibGVkSW5wdXRzW2VdPT09dClyZXR1cm4hMDtyZXR1cm4hMX0sX2dldEluc3Q6ZnVuY3Rpb24oZSl7dHJ5e3JldHVybiB0LmRhdGEoZSwiZGF0ZXBpY2tlciIpfWNhdGNoKGkpe3Rocm93Ik1pc3NpbmcgaW5zdGFuY2UgZGF0YSBmb3IgdGhpcyBkYXRlcGlja2VyIn19LF9vcHRpb25EYXRlcGlja2VyOmZ1bmN0aW9uKGUsaSxzKXt2YXIgbixvLHIsaCxsPXRoaXMuX2dldEluc3QoZSk7cmV0dXJuIDI9PT1hcmd1bWVudHMubGVuZ3RoJiYic3RyaW5nIj09dHlwZW9mIGk/ImRlZmF1bHRzIj09PWk/dC5leHRlbmQoe30sdC5kYXRlcGlja2VyLl9kZWZhdWx0cyk6bD8iYWxsIj09PWk/dC5leHRlbmQoe30sbC5zZXR0aW5ncyk6dGhpcy5fZ2V0KGwsaSk6bnVsbDoobj1pfHx7fSwic3RyaW5nIj09dHlwZW9mIGkmJihuPXt9LG5baV09cyksbCYmKHRoaXMuX2N1ckluc3Q9PT1sJiZ0aGlzLl9oaWRlRGF0ZXBpY2tlcigpLG89dGhpcy5fZ2V0RGF0ZURhdGVwaWNrZXIoZSwhMCkscj10aGlzLl9nZXRNaW5NYXhEYXRlKGwsIm1pbiIpLGg9dGhpcy5fZ2V0TWluTWF4RGF0ZShsLCJtYXgiKSxhKGwuc2V0dGluZ3MsbiksbnVsbCE9PXImJnZvaWQgMCE9PW4uZGF0ZUZvcm1hdCYmdm9pZCAwPT09bi5taW5EYXRlJiYobC5zZXR0aW5ncy5taW5EYXRlPXRoaXMuX2Zvcm1hdERhdGUobCxyKSksbnVsbCE9PWgmJnZvaWQgMCE9PW4uZGF0ZUZvcm1hdCYmdm9pZCAwPT09bi5tYXhEYXRlJiYobC5zZXR0aW5ncy5tYXhEYXRlPXRoaXMuX2Zvcm1hdERhdGUobCxoKSksImRpc2FibGVkImluIG4mJihuLmRpc2FibGVkP3RoaXMuX2Rpc2FibGVEYXRlcGlja2VyKGUpOnRoaXMuX2VuYWJsZURhdGVwaWNrZXIoZSkpLHRoaXMuX2F0dGFjaG1lbnRzKHQoZSksbCksdGhpcy5fYXV0b1NpemUobCksdGhpcy5fc2V0RGF0ZShsLG8pLHRoaXMuX3VwZGF0ZUFsdGVybmF0ZShsKSx0aGlzLl91cGRhdGVEYXRlcGlja2VyKGwpKSx2b2lkIDApfSxfY2hhbmdlRGF0ZXBpY2tlcjpmdW5jdGlvbih0LGUsaSl7dGhpcy5fb3B0aW9uRGF0ZXBpY2tlcih0LGUsaSl9LF9yZWZyZXNoRGF0ZXBpY2tlcjpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9nZXRJbnN0KHQpO2UmJnRoaXMuX3VwZGF0ZURhdGVwaWNrZXIoZSl9LF9zZXREYXRlRGF0ZXBpY2tlcjpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2dldEluc3QodCk7aSYmKHRoaXMuX3NldERhdGUoaSxlKSx0aGlzLl91cGRhdGVEYXRlcGlja2VyKGkpLHRoaXMuX3VwZGF0ZUFsdGVybmF0ZShpKSl9LF9nZXREYXRlRGF0ZXBpY2tlcjpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX2dldEluc3QodCk7cmV0dXJuIGkmJiFpLmlubGluZSYmdGhpcy5fc2V0RGF0ZUZyb21GaWVsZChpLGUpLGk/dGhpcy5fZ2V0RGF0ZShpKTpudWxsfSxfZG9LZXlEb3duOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbixvPXQuZGF0ZXBpY2tlci5fZ2V0SW5zdChlLnRhcmdldCksYT0hMCxyPW8uZHBEaXYuaXMoIi51aS1kYXRlcGlja2VyLXJ0bCIpO2lmKG8uX2tleUV2ZW50PSEwLHQuZGF0ZXBpY2tlci5fZGF0ZXBpY2tlclNob3dpbmcpc3dpdGNoKGUua2V5Q29kZSl7Y2FzZSA5OnQuZGF0ZXBpY2tlci5faGlkZURhdGVwaWNrZXIoKSxhPSExO2JyZWFrO2Nhc2UgMTM6cmV0dXJuIG49dCgidGQuIit0LmRhdGVwaWNrZXIuX2RheU92ZXJDbGFzcysiOm5vdCguIit0LmRhdGVwaWNrZXIuX2N1cnJlbnRDbGFzcysiKSIsby5kcERpdiksblswXSYmdC5kYXRlcGlja2VyLl9zZWxlY3REYXkoZS50YXJnZXQsby5zZWxlY3RlZE1vbnRoLG8uc2VsZWN0ZWRZZWFyLG5bMF0pLGk9dC5kYXRlcGlja2VyLl9nZXQobywib25TZWxlY3QiKSxpPyhzPXQuZGF0ZXBpY2tlci5fZm9ybWF0RGF0ZShvKSxpLmFwcGx5KG8uaW5wdXQ/by5pbnB1dFswXTpudWxsLFtzLG9dKSk6dC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpLCExO2Nhc2UgMjc6dC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpO2JyZWFrO2Nhc2UgMzM6dC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKGUudGFyZ2V0LGUuY3RybEtleT8tdC5kYXRlcGlja2VyLl9nZXQobywic3RlcEJpZ01vbnRocyIpOi10LmRhdGVwaWNrZXIuX2dldChvLCJzdGVwTW9udGhzIiksIk0iKTticmVhaztjYXNlIDM0OnQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZShlLnRhcmdldCxlLmN0cmxLZXk/K3QuZGF0ZXBpY2tlci5fZ2V0KG8sInN0ZXBCaWdNb250aHMiKTordC5kYXRlcGlja2VyLl9nZXQobywic3RlcE1vbnRocyIpLCJNIik7YnJlYWs7Y2FzZSAzNTooZS5jdHJsS2V5fHxlLm1ldGFLZXkpJiZ0LmRhdGVwaWNrZXIuX2NsZWFyRGF0ZShlLnRhcmdldCksYT1lLmN0cmxLZXl8fGUubWV0YUtleTticmVhaztjYXNlIDM2OihlLmN0cmxLZXl8fGUubWV0YUtleSkmJnQuZGF0ZXBpY2tlci5fZ290b1RvZGF5KGUudGFyZ2V0KSxhPWUuY3RybEtleXx8ZS5tZXRhS2V5O2JyZWFrO2Nhc2UgMzc6KGUuY3RybEtleXx8ZS5tZXRhS2V5KSYmdC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKGUudGFyZ2V0LHI/MTotMSwiRCIpLGE9ZS5jdHJsS2V5fHxlLm1ldGFLZXksZS5vcmlnaW5hbEV2ZW50LmFsdEtleSYmdC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKGUudGFyZ2V0LGUuY3RybEtleT8tdC5kYXRlcGlja2VyLl9nZXQobywic3RlcEJpZ01vbnRocyIpOi10LmRhdGVwaWNrZXIuX2dldChvLCJzdGVwTW9udGhzIiksIk0iKTticmVhaztjYXNlIDM4OihlLmN0cmxLZXl8fGUubWV0YUtleSkmJnQuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZShlLnRhcmdldCwtNywiRCIpLGE9ZS5jdHJsS2V5fHxlLm1ldGFLZXk7YnJlYWs7Y2FzZSAzOTooZS5jdHJsS2V5fHxlLm1ldGFLZXkpJiZ0LmRhdGVwaWNrZXIuX2FkanVzdERhdGUoZS50YXJnZXQscj8tMToxLCJEIiksYT1lLmN0cmxLZXl8fGUubWV0YUtleSxlLm9yaWdpbmFsRXZlbnQuYWx0S2V5JiZ0LmRhdGVwaWNrZXIuX2FkanVzdERhdGUoZS50YXJnZXQsZS5jdHJsS2V5Pyt0LmRhdGVwaWNrZXIuX2dldChvLCJzdGVwQmlnTW9udGhzIik6K3QuZGF0ZXBpY2tlci5fZ2V0KG8sInN0ZXBNb250aHMiKSwiTSIpO2JyZWFrO2Nhc2UgNDA6KGUuY3RybEtleXx8ZS5tZXRhS2V5KSYmdC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKGUudGFyZ2V0LDcsIkQiKSxhPWUuY3RybEtleXx8ZS5tZXRhS2V5O2JyZWFrO2RlZmF1bHQ6YT0hMX1lbHNlIDM2PT09ZS5rZXlDb2RlJiZlLmN0cmxLZXk/dC5kYXRlcGlja2VyLl9zaG93RGF0ZXBpY2tlcih0aGlzKTphPSExO2EmJihlLnByZXZlbnREZWZhdWx0KCksZS5zdG9wUHJvcGFnYXRpb24oKSl9LF9kb0tleVByZXNzOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbj10LmRhdGVwaWNrZXIuX2dldEluc3QoZS50YXJnZXQpO3JldHVybiB0LmRhdGVwaWNrZXIuX2dldChuLCJjb25zdHJhaW5JbnB1dCIpPyhpPXQuZGF0ZXBpY2tlci5fcG9zc2libGVDaGFycyh0LmRhdGVwaWNrZXIuX2dldChuLCJkYXRlRm9ybWF0IikpLHM9U3RyaW5nLmZyb21DaGFyQ29kZShudWxsPT1lLmNoYXJDb2RlP2Uua2V5Q29kZTplLmNoYXJDb2RlKSxlLmN0cmxLZXl8fGUubWV0YUtleXx8IiAiPnN8fCFpfHxpLmluZGV4T2Yocyk+LTEpOnZvaWQgMH0sX2RvS2V5VXA6ZnVuY3Rpb24oZSl7dmFyIGkscz10LmRhdGVwaWNrZXIuX2dldEluc3QoZS50YXJnZXQpO2lmKHMuaW5wdXQudmFsKCkhPT1zLmxhc3RWYWwpdHJ5e2k9dC5kYXRlcGlja2VyLnBhcnNlRGF0ZSh0LmRhdGVwaWNrZXIuX2dldChzLCJkYXRlRm9ybWF0Iikscy5pbnB1dD9zLmlucHV0LnZhbCgpOm51bGwsdC5kYXRlcGlja2VyLl9nZXRGb3JtYXRDb25maWcocykpLGkmJih0LmRhdGVwaWNrZXIuX3NldERhdGVGcm9tRmllbGQocyksdC5kYXRlcGlja2VyLl91cGRhdGVBbHRlcm5hdGUocyksdC5kYXRlcGlja2VyLl91cGRhdGVEYXRlcGlja2VyKHMpKX1jYXRjaChuKXt9cmV0dXJuITB9LF9zaG93RGF0ZXBpY2tlcjpmdW5jdGlvbihlKXtpZihlPWUudGFyZ2V0fHxlLCJpbnB1dCIhPT1lLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkmJihlPXQoImlucHV0IixlLnBhcmVudE5vZGUpWzBdKSwhdC5kYXRlcGlja2VyLl9pc0Rpc2FibGVkRGF0ZXBpY2tlcihlKSYmdC5kYXRlcGlja2VyLl9sYXN0SW5wdXQhPT1lKXt2YXIgcyxuLG8scixoLGwsYztzPXQuZGF0ZXBpY2tlci5fZ2V0SW5zdChlKSx0LmRhdGVwaWNrZXIuX2N1ckluc3QmJnQuZGF0ZXBpY2tlci5fY3VySW5zdCE9PXMmJih0LmRhdGVwaWNrZXIuX2N1ckluc3QuZHBEaXYuc3RvcCghMCwhMCkscyYmdC5kYXRlcGlja2VyLl9kYXRlcGlja2VyU2hvd2luZyYmdC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcih0LmRhdGVwaWNrZXIuX2N1ckluc3QuaW5wdXRbMF0pKSxuPXQuZGF0ZXBpY2tlci5fZ2V0KHMsImJlZm9yZVNob3ciKSxvPW4/bi5hcHBseShlLFtlLHNdKTp7fSxvIT09ITEmJihhKHMuc2V0dGluZ3Msbykscy5sYXN0VmFsPW51bGwsdC5kYXRlcGlja2VyLl9sYXN0SW5wdXQ9ZSx0LmRhdGVwaWNrZXIuX3NldERhdGVGcm9tRmllbGQocyksdC5kYXRlcGlja2VyLl9pbkRpYWxvZyYmKGUudmFsdWU9IiIpLHQuZGF0ZXBpY2tlci5fcG9zfHwodC5kYXRlcGlja2VyLl9wb3M9dC5kYXRlcGlja2VyLl9maW5kUG9zKGUpLHQuZGF0ZXBpY2tlci5fcG9zWzFdKz1lLm9mZnNldEhlaWdodCkscj0hMSx0KGUpLnBhcmVudHMoKS5lYWNoKGZ1bmN0aW9uKCl7cmV0dXJuIHJ8PSJmaXhlZCI9PT10KHRoaXMpLmNzcygicG9zaXRpb24iKSwhcn0pLGg9e2xlZnQ6dC5kYXRlcGlja2VyLl9wb3NbMF0sdG9wOnQuZGF0ZXBpY2tlci5fcG9zWzFdfSx0LmRhdGVwaWNrZXIuX3Bvcz1udWxsLHMuZHBEaXYuZW1wdHkoKSxzLmRwRGl2LmNzcyh7cG9zaXRpb246ImFic29sdXRlIixkaXNwbGF5OiJibG9jayIsdG9wOiItMTAwMHB4In0pLHQuZGF0ZXBpY2tlci5fdXBkYXRlRGF0ZXBpY2tlcihzKSxoPXQuZGF0ZXBpY2tlci5fY2hlY2tPZmZzZXQocyxoLHIpLHMuZHBEaXYuY3NzKHtwb3NpdGlvbjp0LmRhdGVwaWNrZXIuX2luRGlhbG9nJiZ0LmJsb2NrVUk/InN0YXRpYyI6cj8iZml4ZWQiOiJhYnNvbHV0ZSIsZGlzcGxheToibm9uZSIsbGVmdDpoLmxlZnQrInB4Iix0b3A6aC50b3ArInB4In0pLHMuaW5saW5lfHwobD10LmRhdGVwaWNrZXIuX2dldChzLCJzaG93QW5pbSIpLGM9dC5kYXRlcGlja2VyLl9nZXQocywiZHVyYXRpb24iKSxzLmRwRGl2LmNzcygiei1pbmRleCIsaSh0KGUpKSsxKSx0LmRhdGVwaWNrZXIuX2RhdGVwaWNrZXJTaG93aW5nPSEwLHQuZWZmZWN0cyYmdC5lZmZlY3RzLmVmZmVjdFtsXT9zLmRwRGl2LnNob3cobCx0LmRhdGVwaWNrZXIuX2dldChzLCJzaG93T3B0aW9ucyIpLGMpOnMuZHBEaXZbbHx8InNob3ciXShsP2M6bnVsbCksdC5kYXRlcGlja2VyLl9zaG91bGRGb2N1c0lucHV0KHMpJiZzLmlucHV0LnRyaWdnZXIoImZvY3VzIiksdC5kYXRlcGlja2VyLl9jdXJJbnN0PXMpKQp9fSxfdXBkYXRlRGF0ZXBpY2tlcjpmdW5jdGlvbihlKXt0aGlzLm1heFJvd3M9NCxtPWUsZS5kcERpdi5lbXB0eSgpLmFwcGVuZCh0aGlzLl9nZW5lcmF0ZUhUTUwoZSkpLHRoaXMuX2F0dGFjaEhhbmRsZXJzKGUpO3ZhciBpLHM9dGhpcy5fZ2V0TnVtYmVyT2ZNb250aHMoZSksbj1zWzFdLGE9MTcscj1lLmRwRGl2LmZpbmQoIi4iK3RoaXMuX2RheU92ZXJDbGFzcysiIGEiKTtyLmxlbmd0aD4wJiZvLmFwcGx5KHIuZ2V0KDApKSxlLmRwRGl2LnJlbW92ZUNsYXNzKCJ1aS1kYXRlcGlja2VyLW11bHRpLTIgdWktZGF0ZXBpY2tlci1tdWx0aS0zIHVpLWRhdGVwaWNrZXItbXVsdGktNCIpLndpZHRoKCIiKSxuPjEmJmUuZHBEaXYuYWRkQ2xhc3MoInVpLWRhdGVwaWNrZXItbXVsdGktIituKS5jc3MoIndpZHRoIixhKm4rImVtIiksZS5kcERpdlsoMSE9PXNbMF18fDEhPT1zWzFdPyJhZGQiOiJyZW1vdmUiKSsiQ2xhc3MiXSgidWktZGF0ZXBpY2tlci1tdWx0aSIpLGUuZHBEaXZbKHRoaXMuX2dldChlLCJpc1JUTCIpPyJhZGQiOiJyZW1vdmUiKSsiQ2xhc3MiXSgidWktZGF0ZXBpY2tlci1ydGwiKSxlPT09dC5kYXRlcGlja2VyLl9jdXJJbnN0JiZ0LmRhdGVwaWNrZXIuX2RhdGVwaWNrZXJTaG93aW5nJiZ0LmRhdGVwaWNrZXIuX3Nob3VsZEZvY3VzSW5wdXQoZSkmJmUuaW5wdXQudHJpZ2dlcigiZm9jdXMiKSxlLnllYXJzaHRtbCYmKGk9ZS55ZWFyc2h0bWwsc2V0VGltZW91dChmdW5jdGlvbigpe2k9PT1lLnllYXJzaHRtbCYmZS55ZWFyc2h0bWwmJmUuZHBEaXYuZmluZCgic2VsZWN0LnVpLWRhdGVwaWNrZXIteWVhcjpmaXJzdCIpLnJlcGxhY2VXaXRoKGUueWVhcnNodG1sKSxpPWUueWVhcnNodG1sPW51bGx9LDApKX0sX3Nob3VsZEZvY3VzSW5wdXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHQuaW5wdXQmJnQuaW5wdXQuaXMoIjp2aXNpYmxlIikmJiF0LmlucHV0LmlzKCI6ZGlzYWJsZWQiKSYmIXQuaW5wdXQuaXMoIjpmb2N1cyIpfSxfY2hlY2tPZmZzZXQ6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuPWUuZHBEaXYub3V0ZXJXaWR0aCgpLG89ZS5kcERpdi5vdXRlckhlaWdodCgpLGE9ZS5pbnB1dD9lLmlucHV0Lm91dGVyV2lkdGgoKTowLHI9ZS5pbnB1dD9lLmlucHV0Lm91dGVySGVpZ2h0KCk6MCxoPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCsocz8wOnQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSksbD1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KyhzPzA6dChkb2N1bWVudCkuc2Nyb2xsVG9wKCkpO3JldHVybiBpLmxlZnQtPXRoaXMuX2dldChlLCJpc1JUTCIpP24tYTowLGkubGVmdC09cyYmaS5sZWZ0PT09ZS5pbnB1dC5vZmZzZXQoKS5sZWZ0P3QoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTowLGkudG9wLT1zJiZpLnRvcD09PWUuaW5wdXQub2Zmc2V0KCkudG9wK3I/dChkb2N1bWVudCkuc2Nyb2xsVG9wKCk6MCxpLmxlZnQtPU1hdGgubWluKGkubGVmdCxpLmxlZnQrbj5oJiZoPm4/TWF0aC5hYnMoaS5sZWZ0K24taCk6MCksaS50b3AtPU1hdGgubWluKGkudG9wLGkudG9wK28+bCYmbD5vP01hdGguYWJzKG8rcik6MCksaX0sX2ZpbmRQb3M6ZnVuY3Rpb24oZSl7Zm9yKHZhciBpLHM9dGhpcy5fZ2V0SW5zdChlKSxuPXRoaXMuX2dldChzLCJpc1JUTCIpO2UmJigiaGlkZGVuIj09PWUudHlwZXx8MSE9PWUubm9kZVR5cGV8fHQuZXhwci5maWx0ZXJzLmhpZGRlbihlKSk7KWU9ZVtuPyJwcmV2aW91c1NpYmxpbmciOiJuZXh0U2libGluZyJdO3JldHVybiBpPXQoZSkub2Zmc2V0KCksW2kubGVmdCxpLnRvcF19LF9oaWRlRGF0ZXBpY2tlcjpmdW5jdGlvbihlKXt2YXIgaSxzLG4sbyxhPXRoaXMuX2N1ckluc3Q7IWF8fGUmJmEhPT10LmRhdGEoZSwiZGF0ZXBpY2tlciIpfHx0aGlzLl9kYXRlcGlja2VyU2hvd2luZyYmKGk9dGhpcy5fZ2V0KGEsInNob3dBbmltIikscz10aGlzLl9nZXQoYSwiZHVyYXRpb24iKSxuPWZ1bmN0aW9uKCl7dC5kYXRlcGlja2VyLl90aWR5RGlhbG9nKGEpfSx0LmVmZmVjdHMmJih0LmVmZmVjdHMuZWZmZWN0W2ldfHx0LmVmZmVjdHNbaV0pP2EuZHBEaXYuaGlkZShpLHQuZGF0ZXBpY2tlci5fZ2V0KGEsInNob3dPcHRpb25zIikscyxuKTphLmRwRGl2WyJzbGlkZURvd24iPT09aT8ic2xpZGVVcCI6ImZhZGVJbiI9PT1pPyJmYWRlT3V0IjoiaGlkZSJdKGk/czpudWxsLG4pLGl8fG4oKSx0aGlzLl9kYXRlcGlja2VyU2hvd2luZz0hMSxvPXRoaXMuX2dldChhLCJvbkNsb3NlIiksbyYmby5hcHBseShhLmlucHV0P2EuaW5wdXRbMF06bnVsbCxbYS5pbnB1dD9hLmlucHV0LnZhbCgpOiIiLGFdKSx0aGlzLl9sYXN0SW5wdXQ9bnVsbCx0aGlzLl9pbkRpYWxvZyYmKHRoaXMuX2RpYWxvZ0lucHV0LmNzcyh7cG9zaXRpb246ImFic29sdXRlIixsZWZ0OiIwIix0b3A6Ii0xMDBweCJ9KSx0LmJsb2NrVUkmJih0LnVuYmxvY2tVSSgpLHQoImJvZHkiKS5hcHBlbmQodGhpcy5kcERpdikpKSx0aGlzLl9pbkRpYWxvZz0hMSl9LF90aWR5RGlhbG9nOmZ1bmN0aW9uKHQpe3QuZHBEaXYucmVtb3ZlQ2xhc3ModGhpcy5fZGlhbG9nQ2xhc3MpLm9mZigiLnVpLWRhdGVwaWNrZXItY2FsZW5kYXIiKX0sX2NoZWNrRXh0ZXJuYWxDbGljazpmdW5jdGlvbihlKXtpZih0LmRhdGVwaWNrZXIuX2N1ckluc3Qpe3ZhciBpPXQoZS50YXJnZXQpLHM9dC5kYXRlcGlja2VyLl9nZXRJbnN0KGlbMF0pOyhpWzBdLmlkIT09dC5kYXRlcGlja2VyLl9tYWluRGl2SWQmJjA9PT1pLnBhcmVudHMoIiMiK3QuZGF0ZXBpY2tlci5fbWFpbkRpdklkKS5sZW5ndGgmJiFpLmhhc0NsYXNzKHQuZGF0ZXBpY2tlci5tYXJrZXJDbGFzc05hbWUpJiYhaS5jbG9zZXN0KCIuIit0LmRhdGVwaWNrZXIuX3RyaWdnZXJDbGFzcykubGVuZ3RoJiZ0LmRhdGVwaWNrZXIuX2RhdGVwaWNrZXJTaG93aW5nJiYoIXQuZGF0ZXBpY2tlci5faW5EaWFsb2d8fCF0LmJsb2NrVUkpfHxpLmhhc0NsYXNzKHQuZGF0ZXBpY2tlci5tYXJrZXJDbGFzc05hbWUpJiZ0LmRhdGVwaWNrZXIuX2N1ckluc3QhPT1zKSYmdC5kYXRlcGlja2VyLl9oaWRlRGF0ZXBpY2tlcigpfX0sX2FkanVzdERhdGU6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuPXQoZSksbz10aGlzLl9nZXRJbnN0KG5bMF0pO3RoaXMuX2lzRGlzYWJsZWREYXRlcGlja2VyKG5bMF0pfHwodGhpcy5fYWRqdXN0SW5zdERhdGUobyxpKygiTSI9PT1zP3RoaXMuX2dldChvLCJzaG93Q3VycmVudEF0UG9zIik6MCkscyksdGhpcy5fdXBkYXRlRGF0ZXBpY2tlcihvKSl9LF9nb3RvVG9kYXk6ZnVuY3Rpb24oZSl7dmFyIGkscz10KGUpLG49dGhpcy5fZ2V0SW5zdChzWzBdKTt0aGlzLl9nZXQobiwiZ290b0N1cnJlbnQiKSYmbi5jdXJyZW50RGF5PyhuLnNlbGVjdGVkRGF5PW4uY3VycmVudERheSxuLmRyYXdNb250aD1uLnNlbGVjdGVkTW9udGg9bi5jdXJyZW50TW9udGgsbi5kcmF3WWVhcj1uLnNlbGVjdGVkWWVhcj1uLmN1cnJlbnRZZWFyKTooaT1uZXcgRGF0ZSxuLnNlbGVjdGVkRGF5PWkuZ2V0RGF0ZSgpLG4uZHJhd01vbnRoPW4uc2VsZWN0ZWRNb250aD1pLmdldE1vbnRoKCksbi5kcmF3WWVhcj1uLnNlbGVjdGVkWWVhcj1pLmdldEZ1bGxZZWFyKCkpLHRoaXMuX25vdGlmeUNoYW5nZShuKSx0aGlzLl9hZGp1c3REYXRlKHMpfSxfc2VsZWN0TW9udGhZZWFyOmZ1bmN0aW9uKGUsaSxzKXt2YXIgbj10KGUpLG89dGhpcy5fZ2V0SW5zdChuWzBdKTtvWyJzZWxlY3RlZCIrKCJNIj09PXM/Ik1vbnRoIjoiWWVhciIpXT1vWyJkcmF3IisoIk0iPT09cz8iTW9udGgiOiJZZWFyIildPXBhcnNlSW50KGkub3B0aW9uc1tpLnNlbGVjdGVkSW5kZXhdLnZhbHVlLDEwKSx0aGlzLl9ub3RpZnlDaGFuZ2UobyksdGhpcy5fYWRqdXN0RGF0ZShuKX0sX3NlbGVjdERheTpmdW5jdGlvbihlLGkscyxuKXt2YXIgbyxhPXQoZSk7dChuKS5oYXNDbGFzcyh0aGlzLl91bnNlbGVjdGFibGVDbGFzcyl8fHRoaXMuX2lzRGlzYWJsZWREYXRlcGlja2VyKGFbMF0pfHwobz10aGlzLl9nZXRJbnN0KGFbMF0pLG8uc2VsZWN0ZWREYXk9by5jdXJyZW50RGF5PXQoImEiLG4pLmh0bWwoKSxvLnNlbGVjdGVkTW9udGg9by5jdXJyZW50TW9udGg9aSxvLnNlbGVjdGVkWWVhcj1vLmN1cnJlbnRZZWFyPXMsdGhpcy5fc2VsZWN0RGF0ZShlLHRoaXMuX2Zvcm1hdERhdGUobyxvLmN1cnJlbnREYXksby5jdXJyZW50TW9udGgsby5jdXJyZW50WWVhcikpKX0sX2NsZWFyRGF0ZTpmdW5jdGlvbihlKXt2YXIgaT10KGUpO3RoaXMuX3NlbGVjdERhdGUoaSwiIil9LF9zZWxlY3REYXRlOmZ1bmN0aW9uKGUsaSl7dmFyIHMsbj10KGUpLG89dGhpcy5fZ2V0SW5zdChuWzBdKTtpPW51bGwhPWk/aTp0aGlzLl9mb3JtYXREYXRlKG8pLG8uaW5wdXQmJm8uaW5wdXQudmFsKGkpLHRoaXMuX3VwZGF0ZUFsdGVybmF0ZShvKSxzPXRoaXMuX2dldChvLCJvblNlbGVjdCIpLHM/cy5hcHBseShvLmlucHV0P28uaW5wdXRbMF06bnVsbCxbaSxvXSk6by5pbnB1dCYmby5pbnB1dC50cmlnZ2VyKCJjaGFuZ2UiKSxvLmlubGluZT90aGlzLl91cGRhdGVEYXRlcGlja2VyKG8pOih0aGlzLl9oaWRlRGF0ZXBpY2tlcigpLHRoaXMuX2xhc3RJbnB1dD1vLmlucHV0WzBdLCJvYmplY3QiIT10eXBlb2Ygby5pbnB1dFswXSYmby5pbnB1dC50cmlnZ2VyKCJmb2N1cyIpLHRoaXMuX2xhc3RJbnB1dD1udWxsKX0sX3VwZGF0ZUFsdGVybmF0ZTpmdW5jdGlvbihlKXt2YXIgaSxzLG4sbz10aGlzLl9nZXQoZSwiYWx0RmllbGQiKTtvJiYoaT10aGlzLl9nZXQoZSwiYWx0Rm9ybWF0Iil8fHRoaXMuX2dldChlLCJkYXRlRm9ybWF0Iikscz10aGlzLl9nZXREYXRlKGUpLG49dGhpcy5mb3JtYXREYXRlKGkscyx0aGlzLl9nZXRGb3JtYXRDb25maWcoZSkpLHQobykudmFsKG4pKX0sbm9XZWVrZW5kczpmdW5jdGlvbih0KXt2YXIgZT10LmdldERheSgpO3JldHVybltlPjAmJjY+ZSwiIl19LGlzbzg2MDFXZWVrOmZ1bmN0aW9uKHQpe3ZhciBlLGk9bmV3IERhdGUodC5nZXRUaW1lKCkpO3JldHVybiBpLnNldERhdGUoaS5nZXREYXRlKCkrNC0oaS5nZXREYXkoKXx8NykpLGU9aS5nZXRUaW1lKCksaS5zZXRNb250aCgwKSxpLnNldERhdGUoMSksTWF0aC5mbG9vcihNYXRoLnJvdW5kKChlLWkpLzg2NGU1KS83KSsxfSxwYXJzZURhdGU6ZnVuY3Rpb24oZSxpLHMpe2lmKG51bGw9PWV8fG51bGw9PWkpdGhyb3ciSW52YWxpZCBhcmd1bWVudHMiO2lmKGk9Im9iamVjdCI9PXR5cGVvZiBpPyIiK2k6aSsiIiwiIj09PWkpcmV0dXJuIG51bGw7dmFyIG4sbyxhLHIsaD0wLGw9KHM/cy5zaG9ydFllYXJDdXRvZmY6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLnNob3J0WWVhckN1dG9mZixjPSJzdHJpbmciIT10eXBlb2YgbD9sOihuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKSUxMDArcGFyc2VJbnQobCwxMCksdT0ocz9zLmRheU5hbWVzU2hvcnQ6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLmRheU5hbWVzU2hvcnQsZD0ocz9zLmRheU5hbWVzOm51bGwpfHx0aGlzLl9kZWZhdWx0cy5kYXlOYW1lcyxwPShzP3MubW9udGhOYW1lc1Nob3J0Om51bGwpfHx0aGlzLl9kZWZhdWx0cy5tb250aE5hbWVzU2hvcnQsZj0ocz9zLm1vbnRoTmFtZXM6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLm1vbnRoTmFtZXMsZz0tMSxtPS0xLF89LTEsdj0tMSxiPSExLHk9ZnVuY3Rpb24odCl7dmFyIGk9ZS5sZW5ndGg+bisxJiZlLmNoYXJBdChuKzEpPT09dDtyZXR1cm4gaSYmbisrLGl9LHc9ZnVuY3Rpb24odCl7dmFyIGU9eSh0KSxzPSJAIj09PXQ/MTQ6IiEiPT09dD8yMDoieSI9PT10JiZlPzQ6Im8iPT09dD8zOjIsbj0ieSI9PT10P3M6MSxvPVJlZ0V4cCgiXlxcZHsiK24rIiwiK3MrIn0iKSxhPWkuc3Vic3RyaW5nKGgpLm1hdGNoKG8pO2lmKCFhKXRocm93Ik1pc3NpbmcgbnVtYmVyIGF0IHBvc2l0aW9uICIraDtyZXR1cm4gaCs9YVswXS5sZW5ndGgscGFyc2VJbnQoYVswXSwxMCl9LGs9ZnVuY3Rpb24oZSxzLG4pe3ZhciBvPS0xLGE9dC5tYXAoeShlKT9uOnMsZnVuY3Rpb24odCxlKXtyZXR1cm5bW2UsdF1dfSkuc29ydChmdW5jdGlvbih0LGUpe3JldHVybi0odFsxXS5sZW5ndGgtZVsxXS5sZW5ndGgpfSk7aWYodC5lYWNoKGEsZnVuY3Rpb24odCxlKXt2YXIgcz1lWzFdO3JldHVybiBpLnN1YnN0cihoLHMubGVuZ3RoKS50b0xvd2VyQ2FzZSgpPT09cy50b0xvd2VyQ2FzZSgpPyhvPWVbMF0saCs9cy5sZW5ndGgsITEpOnZvaWQgMH0pLC0xIT09bylyZXR1cm4gbysxO3Rocm93IlVua25vd24gbmFtZSBhdCBwb3NpdGlvbiAiK2h9LHg9ZnVuY3Rpb24oKXtpZihpLmNoYXJBdChoKSE9PWUuY2hhckF0KG4pKXRocm93IlVuZXhwZWN0ZWQgbGl0ZXJhbCBhdCBwb3NpdGlvbiAiK2g7aCsrfTtmb3Iobj0wO2UubGVuZ3RoPm47bisrKWlmKGIpIiciIT09ZS5jaGFyQXQobil8fHkoIiciKT94KCk6Yj0hMTtlbHNlIHN3aXRjaChlLmNoYXJBdChuKSl7Y2FzZSJkIjpfPXcoImQiKTticmVhaztjYXNlIkQiOmsoIkQiLHUsZCk7YnJlYWs7Y2FzZSJvIjp2PXcoIm8iKTticmVhaztjYXNlIm0iOm09dygibSIpO2JyZWFrO2Nhc2UiTSI6bT1rKCJNIixwLGYpO2JyZWFrO2Nhc2UieSI6Zz13KCJ5Iik7YnJlYWs7Y2FzZSJAIjpyPW5ldyBEYXRlKHcoIkAiKSksZz1yLmdldEZ1bGxZZWFyKCksbT1yLmdldE1vbnRoKCkrMSxfPXIuZ2V0RGF0ZSgpO2JyZWFrO2Nhc2UiISI6cj1uZXcgRGF0ZSgodygiISIpLXRoaXMuX3RpY2tzVG8xOTcwKS8xZTQpLGc9ci5nZXRGdWxsWWVhcigpLG09ci5nZXRNb250aCgpKzEsXz1yLmdldERhdGUoKTticmVhaztjYXNlIiciOnkoIiciKT94KCk6Yj0hMDticmVhaztkZWZhdWx0OngoKX1pZihpLmxlbmd0aD5oJiYoYT1pLnN1YnN0cihoKSwhL15ccysvLnRlc3QoYSkpKXRocm93IkV4dHJhL3VucGFyc2VkIGNoYXJhY3RlcnMgZm91bmQgaW4gZGF0ZTogIithO2lmKC0xPT09Zz9nPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKToxMDA+ZyYmKGcrPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKS0obmV3IERhdGUpLmdldEZ1bGxZZWFyKCklMTAwKyhjPj1nPzA6LTEwMCkpLHY+LTEpZm9yKG09MSxfPXY7Oyl7aWYobz10aGlzLl9nZXREYXlzSW5Nb250aChnLG0tMSksbz49XylicmVhazttKyssXy09b31pZihyPXRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKGcsbS0xLF8pKSxyLmdldEZ1bGxZZWFyKCkhPT1nfHxyLmdldE1vbnRoKCkrMSE9PW18fHIuZ2V0RGF0ZSgpIT09Xyl0aHJvdyJJbnZhbGlkIGRhdGUiO3JldHVybiByfSxBVE9NOiJ5eS1tbS1kZCIsQ09PS0lFOiJELCBkZCBNIHl5IixJU09fODYwMToieXktbW0tZGQiLFJGQ184MjI6IkQsIGQgTSB5IixSRkNfODUwOiJERCwgZGQtTS15IixSRkNfMTAzNjoiRCwgZCBNIHkiLFJGQ18xMTIzOiJELCBkIE0geXkiLFJGQ18yODIyOiJELCBkIE0geXkiLFJTUzoiRCwgZCBNIHkiLFRJQ0tTOiIhIixUSU1FU1RBTVA6IkAiLFczQzoieXktbW0tZGQiLF90aWNrc1RvMTk3MDoxZTcqNjAqNjAqMjQqKDcxODY4NStNYXRoLmZsb29yKDQ5Mi41KS1NYXRoLmZsb29yKDE5LjcpK01hdGguZmxvb3IoNC45MjUpKSxmb3JtYXREYXRlOmZ1bmN0aW9uKHQsZSxpKXtpZighZSlyZXR1cm4iIjt2YXIgcyxuPShpP2kuZGF5TmFtZXNTaG9ydDpudWxsKXx8dGhpcy5fZGVmYXVsdHMuZGF5TmFtZXNTaG9ydCxvPShpP2kuZGF5TmFtZXM6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLmRheU5hbWVzLGE9KGk/aS5tb250aE5hbWVzU2hvcnQ6bnVsbCl8fHRoaXMuX2RlZmF1bHRzLm1vbnRoTmFtZXNTaG9ydCxyPShpP2kubW9udGhOYW1lczpudWxsKXx8dGhpcy5fZGVmYXVsdHMubW9udGhOYW1lcyxoPWZ1bmN0aW9uKGUpe3ZhciBpPXQubGVuZ3RoPnMrMSYmdC5jaGFyQXQocysxKT09PWU7cmV0dXJuIGkmJnMrKyxpfSxsPWZ1bmN0aW9uKHQsZSxpKXt2YXIgcz0iIitlO2lmKGgodCkpZm9yKDtpPnMubGVuZ3RoOylzPSIwIitzO3JldHVybiBzfSxjPWZ1bmN0aW9uKHQsZSxpLHMpe3JldHVybiBoKHQpP3NbZV06aVtlXX0sdT0iIixkPSExO2lmKGUpZm9yKHM9MDt0Lmxlbmd0aD5zO3MrKylpZihkKSInIiE9PXQuY2hhckF0KHMpfHxoKCInIik/dSs9dC5jaGFyQXQocyk6ZD0hMTtlbHNlIHN3aXRjaCh0LmNoYXJBdChzKSl7Y2FzZSJkIjp1Kz1sKCJkIixlLmdldERhdGUoKSwyKTticmVhaztjYXNlIkQiOnUrPWMoIkQiLGUuZ2V0RGF5KCksbixvKTticmVhaztjYXNlIm8iOnUrPWwoIm8iLE1hdGgucm91bmQoKG5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSxlLmdldE1vbnRoKCksZS5nZXREYXRlKCkpLmdldFRpbWUoKS1uZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksMCwwKS5nZXRUaW1lKCkpLzg2NGU1KSwzKTticmVhaztjYXNlIm0iOnUrPWwoIm0iLGUuZ2V0TW9udGgoKSsxLDIpO2JyZWFrO2Nhc2UiTSI6dSs9YygiTSIsZS5nZXRNb250aCgpLGEscik7YnJlYWs7Y2FzZSJ5Ijp1Kz1oKCJ5Iik/ZS5nZXRGdWxsWWVhcigpOigxMD5lLmdldEZ1bGxZZWFyKCklMTAwPyIwIjoiIikrZS5nZXRGdWxsWWVhcigpJTEwMDticmVhaztjYXNlIkAiOnUrPWUuZ2V0VGltZSgpO2JyZWFrO2Nhc2UiISI6dSs9MWU0KmUuZ2V0VGltZSgpK3RoaXMuX3RpY2tzVG8xOTcwO2JyZWFrO2Nhc2UiJyI6aCgiJyIpP3UrPSInIjpkPSEwO2JyZWFrO2RlZmF1bHQ6dSs9dC5jaGFyQXQocyl9cmV0dXJuIHV9LF9wb3NzaWJsZUNoYXJzOmZ1bmN0aW9uKHQpe3ZhciBlLGk9IiIscz0hMSxuPWZ1bmN0aW9uKGkpe3ZhciBzPXQubGVuZ3RoPmUrMSYmdC5jaGFyQXQoZSsxKT09PWk7cmV0dXJuIHMmJmUrKyxzfTtmb3IoZT0wO3QubGVuZ3RoPmU7ZSsrKWlmKHMpIiciIT09dC5jaGFyQXQoZSl8fG4oIiciKT9pKz10LmNoYXJBdChlKTpzPSExO2Vsc2Ugc3dpdGNoKHQuY2hhckF0KGUpKXtjYXNlImQiOmNhc2UibSI6Y2FzZSJ5IjpjYXNlIkAiOmkrPSIwMTIzNDU2Nzg5IjticmVhaztjYXNlIkQiOmNhc2UiTSI6cmV0dXJuIG51bGw7Y2FzZSInIjpuKCInIik/aSs9IiciOnM9ITA7YnJlYWs7ZGVmYXVsdDppKz10LmNoYXJBdChlKX1yZXR1cm4gaX0sX2dldDpmdW5jdGlvbih0LGUpe3JldHVybiB2b2lkIDAhPT10LnNldHRpbmdzW2VdP3Quc2V0dGluZ3NbZV06dGhpcy5fZGVmYXVsdHNbZV19LF9zZXREYXRlRnJvbUZpZWxkOmZ1bmN0aW9uKHQsZSl7aWYodC5pbnB1dC52YWwoKSE9PXQubGFzdFZhbCl7dmFyIGk9dGhpcy5fZ2V0KHQsImRhdGVGb3JtYXQiKSxzPXQubGFzdFZhbD10LmlucHV0P3QuaW5wdXQudmFsKCk6bnVsbCxuPXRoaXMuX2dldERlZmF1bHREYXRlKHQpLG89bixhPXRoaXMuX2dldEZvcm1hdENvbmZpZyh0KTt0cnl7bz10aGlzLnBhcnNlRGF0ZShpLHMsYSl8fG59Y2F0Y2gocil7cz1lPyIiOnN9dC5zZWxlY3RlZERheT1vLmdldERhdGUoKSx0LmRyYXdNb250aD10LnNlbGVjdGVkTW9udGg9by5nZXRNb250aCgpLHQuZHJhd1llYXI9dC5zZWxlY3RlZFllYXI9by5nZXRGdWxsWWVhcigpLHQuY3VycmVudERheT1zP28uZ2V0RGF0ZSgpOjAsdC5jdXJyZW50TW9udGg9cz9vLmdldE1vbnRoKCk6MCx0LmN1cnJlbnRZZWFyPXM/by5nZXRGdWxsWWVhcigpOjAsdGhpcy5fYWRqdXN0SW5zdERhdGUodCl9fSxfZ2V0RGVmYXVsdERhdGU6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3Jlc3RyaWN0TWluTWF4KHQsdGhpcy5fZGV0ZXJtaW5lRGF0ZSh0LHRoaXMuX2dldCh0LCJkZWZhdWx0RGF0ZSIpLG5ldyBEYXRlKSl9LF9kZXRlcm1pbmVEYXRlOmZ1bmN0aW9uKGUsaSxzKXt2YXIgbj1mdW5jdGlvbih0KXt2YXIgZT1uZXcgRGF0ZTtyZXR1cm4gZS5zZXREYXRlKGUuZ2V0RGF0ZSgpK3QpLGV9LG89ZnVuY3Rpb24oaSl7dHJ5e3JldHVybiB0LmRhdGVwaWNrZXIucGFyc2VEYXRlKHQuZGF0ZXBpY2tlci5fZ2V0KGUsImRhdGVGb3JtYXQiKSxpLHQuZGF0ZXBpY2tlci5fZ2V0Rm9ybWF0Q29uZmlnKGUpKX1jYXRjaChzKXt9Zm9yKHZhciBuPShpLnRvTG93ZXJDYXNlKCkubWF0Y2goL15jLyk/dC5kYXRlcGlja2VyLl9nZXREYXRlKGUpOm51bGwpfHxuZXcgRGF0ZSxvPW4uZ2V0RnVsbFllYXIoKSxhPW4uZ2V0TW9udGgoKSxyPW4uZ2V0RGF0ZSgpLGg9LyhbK1wtXT9bMC05XSspXHMqKGR8RHx3fFd8bXxNfHl8WSk/L2csbD1oLmV4ZWMoaSk7bDspe3N3aXRjaChsWzJdfHwiZCIpe2Nhc2UiZCI6Y2FzZSJEIjpyKz1wYXJzZUludChsWzFdLDEwKTticmVhaztjYXNlInciOmNhc2UiVyI6cis9NypwYXJzZUludChsWzFdLDEwKTticmVhaztjYXNlIm0iOmNhc2UiTSI6YSs9cGFyc2VJbnQobFsxXSwxMCkscj1NYXRoLm1pbihyLHQuZGF0ZXBpY2tlci5fZ2V0RGF5c0luTW9udGgobyxhKSk7YnJlYWs7Y2FzZSJ5IjpjYXNlIlkiOm8rPXBhcnNlSW50KGxbMV0sMTApLHI9TWF0aC5taW4ocix0LmRhdGVwaWNrZXIuX2dldERheXNJbk1vbnRoKG8sYSkpfWw9aC5leGVjKGkpfXJldHVybiBuZXcgRGF0ZShvLGEscil9LGE9bnVsbD09aXx8IiI9PT1pP3M6InN0cmluZyI9PXR5cGVvZiBpP28oaSk6Im51bWJlciI9PXR5cGVvZiBpP2lzTmFOKGkpP3M6bihpKTpuZXcgRGF0ZShpLmdldFRpbWUoKSk7cmV0dXJuIGE9YSYmIkludmFsaWQgRGF0ZSI9PSIiK2E/czphLGEmJihhLnNldEhvdXJzKDApLGEuc2V0TWludXRlcygwKSxhLnNldFNlY29uZHMoMCksYS5zZXRNaWxsaXNlY29uZHMoMCkpLHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KGEpfSxfZGF5bGlnaHRTYXZpbmdBZGp1c3Q6ZnVuY3Rpb24odCl7cmV0dXJuIHQ/KHQuc2V0SG91cnModC5nZXRIb3VycygpPjEyP3QuZ2V0SG91cnMoKSsyOjApLHQpOm51bGx9LF9zZXREYXRlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcz0hZSxuPXQuc2VsZWN0ZWRNb250aCxvPXQuc2VsZWN0ZWRZZWFyLGE9dGhpcy5fcmVzdHJpY3RNaW5NYXgodCx0aGlzLl9kZXRlcm1pbmVEYXRlKHQsZSxuZXcgRGF0ZSkpO3Quc2VsZWN0ZWREYXk9dC5jdXJyZW50RGF5PWEuZ2V0RGF0ZSgpLHQuZHJhd01vbnRoPXQuc2VsZWN0ZWRNb250aD10LmN1cnJlbnRNb250aD1hLmdldE1vbnRoKCksdC5kcmF3WWVhcj10LnNlbGVjdGVkWWVhcj10LmN1cnJlbnRZZWFyPWEuZ2V0RnVsbFllYXIoKSxuPT09dC5zZWxlY3RlZE1vbnRoJiZvPT09dC5zZWxlY3RlZFllYXJ8fGl8fHRoaXMuX25vdGlmeUNoYW5nZSh0KSx0aGlzLl9hZGp1c3RJbnN0RGF0ZSh0KSx0LmlucHV0JiZ0LmlucHV0LnZhbChzPyIiOnRoaXMuX2Zvcm1hdERhdGUodCkpfSxfZ2V0RGF0ZTpmdW5jdGlvbih0KXt2YXIgZT0hdC5jdXJyZW50WWVhcnx8dC5pbnB1dCYmIiI9PT10LmlucHV0LnZhbCgpP251bGw6dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUodC5jdXJyZW50WWVhcix0LmN1cnJlbnRNb250aCx0LmN1cnJlbnREYXkpKTtyZXR1cm4gZX0sX2F0dGFjaEhhbmRsZXJzOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX2dldChlLCJzdGVwTW9udGhzIikscz0iIyIrZS5pZC5yZXBsYWNlKC9cXFxcL2csIlxcIik7ZS5kcERpdi5maW5kKCJbZGF0YS1oYW5kbGVyXSIpLm1hcChmdW5jdGlvbigpe3ZhciBlPXtwcmV2OmZ1bmN0aW9uKCl7dC5kYXRlcGlja2VyLl9hZGp1c3REYXRlKHMsLWksIk0iKX0sbmV4dDpmdW5jdGlvbigpe3QuZGF0ZXBpY2tlci5fYWRqdXN0RGF0ZShzLCtpLCJNIil9LGhpZGU6ZnVuY3Rpb24oKXt0LmRhdGVwaWNrZXIuX2hpZGVEYXRlcGlja2VyKCl9LHRvZGF5OmZ1bmN0aW9uKCl7dC5kYXRlcGlja2VyLl9nb3RvVG9kYXkocyl9LHNlbGVjdERheTpmdW5jdGlvbigpe3JldHVybiB0LmRhdGVwaWNrZXIuX3NlbGVjdERheShzLCt0aGlzLmdldEF0dHJpYnV0ZSgiZGF0YS1tb250aCIpLCt0aGlzLmdldEF0dHJpYnV0ZSgiZGF0YS15ZWFyIiksdGhpcyksITF9LHNlbGVjdE1vbnRoOmZ1bmN0aW9uKCl7cmV0dXJuIHQuZGF0ZXBpY2tlci5fc2VsZWN0TW9udGhZZWFyKHMsdGhpcywiTSIpLCExfSxzZWxlY3RZZWFyOmZ1bmN0aW9uKCl7cmV0dXJuIHQuZGF0ZXBpY2tlci5fc2VsZWN0TW9udGhZZWFyKHMsdGhpcywiWSIpLCExfX07dCh0aGlzKS5vbih0aGlzLmdldEF0dHJpYnV0ZSgiZGF0YS1ldmVudCIpLGVbdGhpcy5nZXRBdHRyaWJ1dGUoImRhdGEtaGFuZGxlciIpXSl9KX0sX2dlbmVyYXRlSFRNTDpmdW5jdGlvbih0KXt2YXIgZSxpLHMsbixvLGEscixoLGwsYyx1LGQscCxmLGcsbSxfLHYsYix5LHcsayx4LEMsRCxJLFQsUCxNLFMsSCx6LE8sQSxOLFcsRSxGLEwsUj1uZXcgRGF0ZSxCPXRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKFIuZ2V0RnVsbFllYXIoKSxSLmdldE1vbnRoKCksUi5nZXREYXRlKCkpKSxZPXRoaXMuX2dldCh0LCJpc1JUTCIpLGo9dGhpcy5fZ2V0KHQsInNob3dCdXR0b25QYW5lbCIpLHE9dGhpcy5fZ2V0KHQsImhpZGVJZk5vUHJldk5leHQiKSxLPXRoaXMuX2dldCh0LCJuYXZpZ2F0aW9uQXNEYXRlRm9ybWF0IiksVT10aGlzLl9nZXROdW1iZXJPZk1vbnRocyh0KSxWPXRoaXMuX2dldCh0LCJzaG93Q3VycmVudEF0UG9zIiksJD10aGlzLl9nZXQodCwic3RlcE1vbnRocyIpLFg9MSE9PVVbMF18fDEhPT1VWzFdLEc9dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QodC5jdXJyZW50RGF5P25ldyBEYXRlKHQuY3VycmVudFllYXIsdC5jdXJyZW50TW9udGgsdC5jdXJyZW50RGF5KTpuZXcgRGF0ZSg5OTk5LDksOSkpLFE9dGhpcy5fZ2V0TWluTWF4RGF0ZSh0LCJtaW4iKSxKPXRoaXMuX2dldE1pbk1heERhdGUodCwibWF4IiksWj10LmRyYXdNb250aC1WLHRlPXQuZHJhd1llYXI7aWYoMD5aJiYoWis9MTIsdGUtLSksSilmb3IoZT10aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdChuZXcgRGF0ZShKLmdldEZ1bGxZZWFyKCksSi5nZXRNb250aCgpLVVbMF0qVVsxXSsxLEouZ2V0RGF0ZSgpKSksZT1RJiZRPmU/UTplO3RoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKHRlLFosMSkpPmU7KVotLSwwPlomJihaPTExLHRlLS0pO2Zvcih0LmRyYXdNb250aD1aLHQuZHJhd1llYXI9dGUsaT10aGlzLl9nZXQodCwicHJldlRleHQiKSxpPUs/dGhpcy5mb3JtYXREYXRlKGksdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUodGUsWi0kLDEpKSx0aGlzLl9nZXRGb3JtYXRDb25maWcodCkpOmkscz10aGlzLl9jYW5BZGp1c3RNb250aCh0LC0xLHRlLFopPyI8YSBjbGFzcz0ndWktZGF0ZXBpY2tlci1wcmV2IHVpLWNvcm5lci1hbGwnIGRhdGEtaGFuZGxlcj0ncHJldicgZGF0YS1ldmVudD0nY2xpY2snIHRpdGxlPSciK2krIic+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtIisoWT8iZSI6InciKSsiJz4iK2krIjwvc3Bhbj48L2E+IjpxPyIiOiI8YSBjbGFzcz0ndWktZGF0ZXBpY2tlci1wcmV2IHVpLWNvcm5lci1hbGwgdWktc3RhdGUtZGlzYWJsZWQnIHRpdGxlPSciK2krIic+PHNwYW4gY2xhc3M9J3VpLWljb24gdWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtIisoWT8iZSI6InciKSsiJz4iK2krIjwvc3Bhbj48L2E+IixuPXRoaXMuX2dldCh0LCJuZXh0VGV4dCIpLG49Sz90aGlzLmZvcm1hdERhdGUobix0aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdChuZXcgRGF0ZSh0ZSxaKyQsMSkpLHRoaXMuX2dldEZvcm1hdENvbmZpZyh0KSk6bixvPXRoaXMuX2NhbkFkanVzdE1vbnRoKHQsMSx0ZSxaKT8iPGEgY2xhc3M9J3VpLWRhdGVwaWNrZXItbmV4dCB1aS1jb3JuZXItYWxsJyBkYXRhLWhhbmRsZXI9J25leHQnIGRhdGEtZXZlbnQ9J2NsaWNrJyB0aXRsZT0nIituKyInPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLSIrKFk/InciOiJlIikrIic+IituKyI8L3NwYW4+PC9hPiI6cT8iIjoiPGEgY2xhc3M9J3VpLWRhdGVwaWNrZXItbmV4dCB1aS1jb3JuZXItYWxsIHVpLXN0YXRlLWRpc2FibGVkJyB0aXRsZT0nIituKyInPjxzcGFuIGNsYXNzPSd1aS1pY29uIHVpLWljb24tY2lyY2xlLXRyaWFuZ2xlLSIrKFk/InciOiJlIikrIic+IituKyI8L3NwYW4+PC9hPiIsYT10aGlzLl9nZXQodCwiY3VycmVudFRleHQiKSxyPXRoaXMuX2dldCh0LCJnb3RvQ3VycmVudCIpJiZ0LmN1cnJlbnREYXk/RzpCLGE9Sz90aGlzLmZvcm1hdERhdGUoYSxyLHRoaXMuX2dldEZvcm1hdENvbmZpZyh0KSk6YSxoPXQuaW5saW5lPyIiOiI8YnV0dG9uIHR5cGU9J2J1dHRvbicgY2xhc3M9J3VpLWRhdGVwaWNrZXItY2xvc2UgdWktc3RhdGUtZGVmYXVsdCB1aS1wcmlvcml0eS1wcmltYXJ5IHVpLWNvcm5lci1hbGwnIGRhdGEtaGFuZGxlcj0naGlkZScgZGF0YS1ldmVudD0nY2xpY2snPiIrdGhpcy5fZ2V0KHQsImNsb3NlVGV4dCIpKyI8L2J1dHRvbj4iLGw9aj8iPGRpdiBjbGFzcz0ndWktZGF0ZXBpY2tlci1idXR0b25wYW5lIHVpLXdpZGdldC1jb250ZW50Jz4iKyhZP2g6IiIpKyh0aGlzLl9pc0luUmFuZ2UodCxyKT8iPGJ1dHRvbiB0eXBlPSdidXR0b24nIGNsYXNzPSd1aS1kYXRlcGlja2VyLWN1cnJlbnQgdWktc3RhdGUtZGVmYXVsdCB1aS1wcmlvcml0eS1zZWNvbmRhcnkgdWktY29ybmVyLWFsbCcgZGF0YS1oYW5kbGVyPSd0b2RheScgZGF0YS1ldmVudD0nY2xpY2snPiIrYSsiPC9idXR0b24+IjoiIikrKFk/IiI6aCkrIjwvZGl2PiI6IiIsYz1wYXJzZUludCh0aGlzLl9nZXQodCwiZmlyc3REYXkiKSwxMCksYz1pc05hTihjKT8wOmMsdT10aGlzLl9nZXQodCwic2hvd1dlZWsiKSxkPXRoaXMuX2dldCh0LCJkYXlOYW1lcyIpLHA9dGhpcy5fZ2V0KHQsImRheU5hbWVzTWluIiksZj10aGlzLl9nZXQodCwibW9udGhOYW1lcyIpLGc9dGhpcy5fZ2V0KHQsIm1vbnRoTmFtZXNTaG9ydCIpLG09dGhpcy5fZ2V0KHQsImJlZm9yZVNob3dEYXkiKSxfPXRoaXMuX2dldCh0LCJzaG93T3RoZXJNb250aHMiKSx2PXRoaXMuX2dldCh0LCJzZWxlY3RPdGhlck1vbnRocyIpLGI9dGhpcy5fZ2V0RGVmYXVsdERhdGUodCkseT0iIixrPTA7VVswXT5rO2srKyl7Zm9yKHg9IiIsdGhpcy5tYXhSb3dzPTQsQz0wO1VbMV0+QztDKyspe2lmKEQ9dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUodGUsWix0LnNlbGVjdGVkRGF5KSksST0iIHVpLWNvcm5lci1hbGwiLFQ9IiIsWCl7aWYoVCs9IjxkaXYgY2xhc3M9J3VpLWRhdGVwaWNrZXItZ3JvdXAiLFVbMV0+MSlzd2l0Y2goQyl7Y2FzZSAwOlQrPSIgdWktZGF0ZXBpY2tlci1ncm91cC1maXJzdCIsST0iIHVpLWNvcm5lci0iKyhZPyJyaWdodCI6ImxlZnQiKTticmVhaztjYXNlIFVbMV0tMTpUKz0iIHVpLWRhdGVwaWNrZXItZ3JvdXAtbGFzdCIsST0iIHVpLWNvcm5lci0iKyhZPyJsZWZ0IjoicmlnaHQiKTticmVhaztkZWZhdWx0OlQrPSIgdWktZGF0ZXBpY2tlci1ncm91cC1taWRkbGUiLEk9IiJ9VCs9Iic+In1mb3IoVCs9IjxkaXYgY2xhc3M9J3VpLWRhdGVwaWNrZXItaGVhZGVyIHVpLXdpZGdldC1oZWFkZXIgdWktaGVscGVyLWNsZWFyZml4IitJKyInPiIrKC9hbGx8bGVmdC8udGVzdChJKSYmMD09PWs/WT9vOnM6IiIpKygvYWxsfHJpZ2h0Ly50ZXN0KEkpJiYwPT09az9ZP3M6bzoiIikrdGhpcy5fZ2VuZXJhdGVNb250aFllYXJIZWFkZXIodCxaLHRlLFEsSixrPjB8fEM+MCxmLGcpKyI8L2Rpdj48dGFibGUgY2xhc3M9J3VpLWRhdGVwaWNrZXItY2FsZW5kYXInPjx0aGVhZD4iKyI8dHI+IixQPXU/Ijx0aCBjbGFzcz0ndWktZGF0ZXBpY2tlci13ZWVrLWNvbCc+Iit0aGlzLl9nZXQodCwid2Vla0hlYWRlciIpKyI8L3RoPiI6IiIsdz0wOzc+dzt3KyspTT0odytjKSU3LFArPSI8dGggc2NvcGU9J2NvbCciKygodytjKzYpJTc+PTU/IiBjbGFzcz0ndWktZGF0ZXBpY2tlci13ZWVrLWVuZCciOiIiKSsiPiIrIjxzcGFuIHRpdGxlPSciK2RbTV0rIic+IitwW01dKyI8L3NwYW4+PC90aD4iO2ZvcihUKz1QKyI8L3RyPjwvdGhlYWQ+PHRib2R5PiIsUz10aGlzLl9nZXREYXlzSW5Nb250aCh0ZSxaKSx0ZT09PXQuc2VsZWN0ZWRZZWFyJiZaPT09dC5zZWxlY3RlZE1vbnRoJiYodC5zZWxlY3RlZERheT1NYXRoLm1pbih0LnNlbGVjdGVkRGF5LFMpKSxIPSh0aGlzLl9nZXRGaXJzdERheU9mTW9udGgodGUsWiktYys3KSU3LHo9TWF0aC5jZWlsKChIK1MpLzcpLE89WD90aGlzLm1heFJvd3M+ej90aGlzLm1heFJvd3M6ejp6LHRoaXMubWF4Um93cz1PLEE9dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUodGUsWiwxLUgpKSxOPTA7Tz5OO04rKyl7Zm9yKFQrPSI8dHI+IixXPXU/Ijx0ZCBjbGFzcz0ndWktZGF0ZXBpY2tlci13ZWVrLWNvbCc+Iit0aGlzLl9nZXQodCwiY2FsY3VsYXRlV2VlayIpKEEpKyI8L3RkPiI6IiIsdz0wOzc+dzt3KyspRT1tP20uYXBwbHkodC5pbnB1dD90LmlucHV0WzBdOm51bGwsW0FdKTpbITAsIiJdLEY9QS5nZXRNb250aCgpIT09WixMPUYmJiF2fHwhRVswXXx8USYmUT5BfHxKJiZBPkosVys9Ijx0ZCBjbGFzcz0nIisoKHcrYys2KSU3Pj01PyIgdWktZGF0ZXBpY2tlci13ZWVrLWVuZCI6IiIpKyhGPyIgdWktZGF0ZXBpY2tlci1vdGhlci1tb250aCI6IiIpKyhBLmdldFRpbWUoKT09PUQuZ2V0VGltZSgpJiZaPT09dC5zZWxlY3RlZE1vbnRoJiZ0Ll9rZXlFdmVudHx8Yi5nZXRUaW1lKCk9PT1BLmdldFRpbWUoKSYmYi5nZXRUaW1lKCk9PT1ELmdldFRpbWUoKT8iICIrdGhpcy5fZGF5T3ZlckNsYXNzOiIiKSsoTD8iICIrdGhpcy5fdW5zZWxlY3RhYmxlQ2xhc3MrIiB1aS1zdGF0ZS1kaXNhYmxlZCI6IiIpKyhGJiYhXz8iIjoiICIrRVsxXSsoQS5nZXRUaW1lKCk9PT1HLmdldFRpbWUoKT8iICIrdGhpcy5fY3VycmVudENsYXNzOiIiKSsoQS5nZXRUaW1lKCk9PT1CLmdldFRpbWUoKT8iIHVpLWRhdGVwaWNrZXItdG9kYXkiOiIiKSkrIiciKyhGJiYhX3x8IUVbMl0/IiI6IiB0aXRsZT0nIitFWzJdLnJlcGxhY2UoLycvZywiJiMzOTsiKSsiJyIpKyhMPyIiOiIgZGF0YS1oYW5kbGVyPSdzZWxlY3REYXknIGRhdGEtZXZlbnQ9J2NsaWNrJyBkYXRhLW1vbnRoPSciK0EuZ2V0TW9udGgoKSsiJyBkYXRhLXllYXI9JyIrQS5nZXRGdWxsWWVhcigpKyInIikrIj4iKyhGJiYhXz8iJiN4YTA7IjpMPyI8c3BhbiBjbGFzcz0ndWktc3RhdGUtZGVmYXVsdCc+IitBLmdldERhdGUoKSsiPC9zcGFuPiI6IjxhIGNsYXNzPSd1aS1zdGF0ZS1kZWZhdWx0IisoQS5nZXRUaW1lKCk9PT1CLmdldFRpbWUoKT8iIHVpLXN0YXRlLWhpZ2hsaWdodCI6IiIpKyhBLmdldFRpbWUoKT09PUcuZ2V0VGltZSgpPyIgdWktc3RhdGUtYWN0aXZlIjoiIikrKEY/IiB1aS1wcmlvcml0eS1zZWNvbmRhcnkiOiIiKSsiJyBocmVmPScjJz4iK0EuZ2V0RGF0ZSgpKyI8L2E+IikrIjwvdGQ+IixBLnNldERhdGUoQS5nZXREYXRlKCkrMSksQT10aGlzLl9kYXlsaWdodFNhdmluZ0FkanVzdChBKTtUKz1XKyI8L3RyPiJ9WisrLFo+MTEmJihaPTAsdGUrKyksVCs9IjwvdGJvZHk+PC90YWJsZT4iKyhYPyI8L2Rpdj4iKyhVWzBdPjAmJkM9PT1VWzFdLTE/IjxkaXYgY2xhc3M9J3VpLWRhdGVwaWNrZXItcm93LWJyZWFrJz48L2Rpdj4iOiIiKToiIikseCs9VH15Kz14fXJldHVybiB5Kz1sLHQuX2tleUV2ZW50PSExLHl9LF9nZW5lcmF0ZU1vbnRoWWVhckhlYWRlcjpmdW5jdGlvbih0LGUsaSxzLG4sbyxhLHIpe3ZhciBoLGwsYyx1LGQscCxmLGcsbT10aGlzLl9nZXQodCwiY2hhbmdlTW9udGgiKSxfPXRoaXMuX2dldCh0LCJjaGFuZ2VZZWFyIiksdj10aGlzLl9nZXQodCwic2hvd01vbnRoQWZ0ZXJZZWFyIiksYj0iPGRpdiBjbGFzcz0ndWktZGF0ZXBpY2tlci10aXRsZSc+Iix5PSIiO2lmKG98fCFtKXkrPSI8c3BhbiBjbGFzcz0ndWktZGF0ZXBpY2tlci1tb250aCc+IithW2VdKyI8L3NwYW4+IjtlbHNle2ZvcihoPXMmJnMuZ2V0RnVsbFllYXIoKT09PWksbD1uJiZuLmdldEZ1bGxZZWFyKCk9PT1pLHkrPSI8c2VsZWN0IGNsYXNzPSd1aS1kYXRlcGlja2VyLW1vbnRoJyBkYXRhLWhhbmRsZXI9J3NlbGVjdE1vbnRoJyBkYXRhLWV2ZW50PSdjaGFuZ2UnPiIsYz0wOzEyPmM7YysrKSghaHx8Yz49cy5nZXRNb250aCgpKSYmKCFsfHxuLmdldE1vbnRoKCk+PWMpJiYoeSs9IjxvcHRpb24gdmFsdWU9JyIrYysiJyIrKGM9PT1lPyIgc2VsZWN0ZWQ9J3NlbGVjdGVkJyI6IiIpKyI+IityW2NdKyI8L29wdGlvbj4iKTt5Kz0iPC9zZWxlY3Q+In1pZih2fHwoYis9eSsoIW8mJm0mJl8/IiI6IiYjeGEwOyIpKSwhdC55ZWFyc2h0bWwpaWYodC55ZWFyc2h0bWw9IiIsb3x8IV8pYis9IjxzcGFuIGNsYXNzPSd1aS1kYXRlcGlja2VyLXllYXInPiIraSsiPC9zcGFuPiI7ZWxzZXtmb3IodT10aGlzLl9nZXQodCwieWVhclJhbmdlIikuc3BsaXQoIjoiKSxkPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKSxwPWZ1bmN0aW9uKHQpe3ZhciBlPXQubWF0Y2goL2NbK1wtXS4qLyk/aStwYXJzZUludCh0LnN1YnN0cmluZygxKSwxMCk6dC5tYXRjaCgvWytcLV0uKi8pP2QrcGFyc2VJbnQodCwxMCk6cGFyc2VJbnQodCwxMCk7cmV0dXJuIGlzTmFOKGUpP2Q6ZX0sZj1wKHVbMF0pLGc9TWF0aC5tYXgoZixwKHVbMV18fCIiKSksZj1zP01hdGgubWF4KGYscy5nZXRGdWxsWWVhcigpKTpmLGc9bj9NYXRoLm1pbihnLG4uZ2V0RnVsbFllYXIoKSk6Zyx0LnllYXJzaHRtbCs9IjxzZWxlY3QgY2xhc3M9J3VpLWRhdGVwaWNrZXIteWVhcicgZGF0YS1oYW5kbGVyPSdzZWxlY3RZZWFyJyBkYXRhLWV2ZW50PSdjaGFuZ2UnPiI7Zz49ZjtmKyspdC55ZWFyc2h0bWwrPSI8b3B0aW9uIHZhbHVlPSciK2YrIiciKyhmPT09aT8iIHNlbGVjdGVkPSdzZWxlY3RlZCciOiIiKSsiPiIrZisiPC9vcHRpb24+Ijt0LnllYXJzaHRtbCs9Ijwvc2VsZWN0PiIsYis9dC55ZWFyc2h0bWwsdC55ZWFyc2h0bWw9bnVsbH1yZXR1cm4gYis9dGhpcy5fZ2V0KHQsInllYXJTdWZmaXgiKSx2JiYoYis9KCFvJiZtJiZfPyIiOiImI3hhMDsiKSt5KSxiKz0iPC9kaXY+In0sX2FkanVzdEluc3REYXRlOmZ1bmN0aW9uKHQsZSxpKXt2YXIgcz10LnNlbGVjdGVkWWVhcisoIlkiPT09aT9lOjApLG49dC5zZWxlY3RlZE1vbnRoKygiTSI9PT1pP2U6MCksbz1NYXRoLm1pbih0LnNlbGVjdGVkRGF5LHRoaXMuX2dldERheXNJbk1vbnRoKHMsbikpKygiRCI9PT1pP2U6MCksYT10aGlzLl9yZXN0cmljdE1pbk1heCh0LHRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKHMsbixvKSkpO3Quc2VsZWN0ZWREYXk9YS5nZXREYXRlKCksdC5kcmF3TW9udGg9dC5zZWxlY3RlZE1vbnRoPWEuZ2V0TW9udGgoKSx0LmRyYXdZZWFyPXQuc2VsZWN0ZWRZZWFyPWEuZ2V0RnVsbFllYXIoKSwoIk0iPT09aXx8IlkiPT09aSkmJnRoaXMuX25vdGlmeUNoYW5nZSh0KX0sX3Jlc3RyaWN0TWluTWF4OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fZ2V0TWluTWF4RGF0ZSh0LCJtaW4iKSxzPXRoaXMuX2dldE1pbk1heERhdGUodCwibWF4Iiksbj1pJiZpPmU/aTplO3JldHVybiBzJiZuPnM/czpufSxfbm90aWZ5Q2hhbmdlOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2dldCh0LCJvbkNoYW5nZU1vbnRoWWVhciIpO2UmJmUuYXBwbHkodC5pbnB1dD90LmlucHV0WzBdOm51bGwsW3Quc2VsZWN0ZWRZZWFyLHQuc2VsZWN0ZWRNb250aCsxLHRdKX0sX2dldE51bWJlck9mTW9udGhzOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2dldCh0LCJudW1iZXJPZk1vbnRocyIpO3JldHVybiBudWxsPT1lP1sxLDFdOiJudW1iZXIiPT10eXBlb2YgZT9bMSxlXTplfSxfZ2V0TWluTWF4RGF0ZTpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9kZXRlcm1pbmVEYXRlKHQsdGhpcy5fZ2V0KHQsZSsiRGF0ZSIpLG51bGwpfSxfZ2V0RGF5c0luTW9udGg6ZnVuY3Rpb24odCxlKXtyZXR1cm4gMzItdGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUodCxlLDMyKSkuZ2V0RGF0ZSgpfSxfZ2V0Rmlyc3REYXlPZk1vbnRoOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyBEYXRlKHQsZSwxKS5nZXREYXkoKX0sX2NhbkFkanVzdE1vbnRoOmZ1bmN0aW9uKHQsZSxpLHMpe3ZhciBuPXRoaXMuX2dldE51bWJlck9mTW9udGhzKHQpLG89dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUoaSxzKygwPmU/ZTpuWzBdKm5bMV0pLDEpKTtyZXR1cm4gMD5lJiZvLnNldERhdGUodGhpcy5fZ2V0RGF5c0luTW9udGgoby5nZXRGdWxsWWVhcigpLG8uZ2V0TW9udGgoKSkpLHRoaXMuX2lzSW5SYW5nZSh0LG8pfSxfaXNJblJhbmdlOmZ1bmN0aW9uKHQsZSl7dmFyIGkscyxuPXRoaXMuX2dldE1pbk1heERhdGUodCwibWluIiksbz10aGlzLl9nZXRNaW5NYXhEYXRlKHQsIm1heCIpLGE9bnVsbCxyPW51bGwsaD10aGlzLl9nZXQodCwieWVhclJhbmdlIik7cmV0dXJuIGgmJihpPWguc3BsaXQoIjoiKSxzPShuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKSxhPXBhcnNlSW50KGlbMF0sMTApLHI9cGFyc2VJbnQoaVsxXSwxMCksaVswXS5tYXRjaCgvWytcLV0uKi8pJiYoYSs9cyksaVsxXS5tYXRjaCgvWytcLV0uKi8pJiYocis9cykpLCghbnx8ZS5nZXRUaW1lKCk+PW4uZ2V0VGltZSgpKSYmKCFvfHxlLmdldFRpbWUoKTw9by5nZXRUaW1lKCkpJiYoIWF8fGUuZ2V0RnVsbFllYXIoKT49YSkmJighcnx8cj49ZS5nZXRGdWxsWWVhcigpKX0sX2dldEZvcm1hdENvbmZpZzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl9nZXQodCwic2hvcnRZZWFyQ3V0b2ZmIik7cmV0dXJuIGU9InN0cmluZyIhPXR5cGVvZiBlP2U6KG5ldyBEYXRlKS5nZXRGdWxsWWVhcigpJTEwMCtwYXJzZUludChlLDEwKSx7c2hvcnRZZWFyQ3V0b2ZmOmUsZGF5TmFtZXNTaG9ydDp0aGlzLl9nZXQodCwiZGF5TmFtZXNTaG9ydCIpLGRheU5hbWVzOnRoaXMuX2dldCh0LCJkYXlOYW1lcyIpLG1vbnRoTmFtZXNTaG9ydDp0aGlzLl9nZXQodCwibW9udGhOYW1lc1Nob3J0IiksbW9udGhOYW1lczp0aGlzLl9nZXQodCwibW9udGhOYW1lcyIpfX0sX2Zvcm1hdERhdGU6ZnVuY3Rpb24odCxlLGkscyl7ZXx8KHQuY3VycmVudERheT10LnNlbGVjdGVkRGF5LHQuY3VycmVudE1vbnRoPXQuc2VsZWN0ZWRNb250aCx0LmN1cnJlbnRZZWFyPXQuc2VsZWN0ZWRZZWFyKTt2YXIgbj1lPyJvYmplY3QiPT10eXBlb2YgZT9lOnRoaXMuX2RheWxpZ2h0U2F2aW5nQWRqdXN0KG5ldyBEYXRlKHMsaSxlKSk6dGhpcy5fZGF5bGlnaHRTYXZpbmdBZGp1c3QobmV3IERhdGUodC5jdXJyZW50WWVhcix0LmN1cnJlbnRNb250aCx0LmN1cnJlbnREYXkpKTtyZXR1cm4gdGhpcy5mb3JtYXREYXRlKHRoaXMuX2dldCh0LCJkYXRlRm9ybWF0Iiksbix0aGlzLl9nZXRGb3JtYXRDb25maWcodCkpfX0pLHQuZm4uZGF0ZXBpY2tlcj1mdW5jdGlvbihlKXtpZighdGhpcy5sZW5ndGgpcmV0dXJuIHRoaXM7dC5kYXRlcGlja2VyLmluaXRpYWxpemVkfHwodChkb2N1bWVudCkub24oIm1vdXNlZG93biIsdC5kYXRlcGlja2VyLl9jaGVja0V4dGVybmFsQ2xpY2spLHQuZGF0ZXBpY2tlci5pbml0aWFsaXplZD0hMCksMD09PXQoIiMiK3QuZGF0ZXBpY2tlci5fbWFpbkRpdklkKS5sZW5ndGgmJnQoImJvZHkiKS5hcHBlbmQodC5kYXRlcGlja2VyLmRwRGl2KTt2YXIgaT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBlfHwiaXNEaXNhYmxlZCIhPT1lJiYiZ2V0RGF0ZSIhPT1lJiYid2lkZ2V0IiE9PWU/Im9wdGlvbiI9PT1lJiYyPT09YXJndW1lbnRzLmxlbmd0aCYmInN0cmluZyI9PXR5cGVvZiBhcmd1bWVudHNbMV0/dC5kYXRlcGlja2VyWyJfIitlKyJEYXRlcGlja2VyIl0uYXBwbHkodC5kYXRlcGlja2VyLFt0aGlzWzBdXS5jb25jYXQoaSkpOnRoaXMuZWFjaChmdW5jdGlvbigpeyJzdHJpbmciPT10eXBlb2YgZT90LmRhdGVwaWNrZXJbIl8iK2UrIkRhdGVwaWNrZXIiXS5hcHBseSh0LmRhdGVwaWNrZXIsW3RoaXNdLmNvbmNhdChpKSk6dC5kYXRlcGlja2VyLl9hdHRhY2hEYXRlcGlja2VyKHRoaXMsZSl9KTp0LmRhdGVwaWNrZXJbIl8iK2UrIkRhdGVwaWNrZXIiXS5hcHBseSh0LmRhdGVwaWNrZXIsW3RoaXNbMF1dLmNvbmNhdChpKSl9LHQuZGF0ZXBpY2tlcj1uZXcgcyx0LmRhdGVwaWNrZXIuaW5pdGlhbGl6ZWQ9ITEsdC5kYXRlcGlja2VyLnV1aWQ9KG5ldyBEYXRlKS5nZXRUaW1lKCksdC5kYXRlcGlja2VyLnZlcnNpb249IjEuMTIuMSIsdC5kYXRlcGlja2VyLHQudWkuaWU9ISEvbXNpZSBbXHcuXSsvLmV4ZWMobmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTt2YXIgXz0hMTt0KGRvY3VtZW50KS5vbigibW91c2V1cCIsZnVuY3Rpb24oKXtfPSExfSksdC53aWRnZXQoInVpLm1vdXNlIix7dmVyc2lvbjoiMS4xMi4xIixvcHRpb25zOntjYW5jZWw6ImlucHV0LCB0ZXh0YXJlYSwgYnV0dG9uLCBzZWxlY3QsIG9wdGlvbiIsZGlzdGFuY2U6MSxkZWxheTowfSxfbW91c2VJbml0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0aGlzLmVsZW1lbnQub24oIm1vdXNlZG93bi4iK3RoaXMud2lkZ2V0TmFtZSxmdW5jdGlvbih0KXtyZXR1cm4gZS5fbW91c2VEb3duKHQpfSkub24oImNsaWNrLiIrdGhpcy53aWRnZXROYW1lLGZ1bmN0aW9uKGkpe3JldHVybiEwPT09dC5kYXRhKGkudGFyZ2V0LGUud2lkZ2V0TmFtZSsiLnByZXZlbnRDbGlja0V2ZW50Iik/KHQucmVtb3ZlRGF0YShpLnRhcmdldCxlLndpZGdldE5hbWUrIi5wcmV2ZW50Q2xpY2tFdmVudCIpLGkuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksITEpOnZvaWQgMH0pLHRoaXMuc3RhcnRlZD0hMX0sX21vdXNlRGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5vZmYoIi4iK3RoaXMud2lkZ2V0TmFtZSksdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUmJnRoaXMuZG9jdW1lbnQub2ZmKCJtb3VzZW1vdmUuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUpLm9mZigibW91c2V1cC4iK3RoaXMud2lkZ2V0TmFtZSx0aGlzLl9tb3VzZVVwRGVsZWdhdGUpfSxfbW91c2VEb3duOmZ1bmN0aW9uKGUpe2lmKCFfKXt0aGlzLl9tb3VzZU1vdmVkPSExLHRoaXMuX21vdXNlU3RhcnRlZCYmdGhpcy5fbW91c2VVcChlKSx0aGlzLl9tb3VzZURvd25FdmVudD1lO3ZhciBpPXRoaXMscz0xPT09ZS53aGljaCxuPSJzdHJpbmciPT10eXBlb2YgdGhpcy5vcHRpb25zLmNhbmNlbCYmZS50YXJnZXQubm9kZU5hbWU/dChlLnRhcmdldCkuY2xvc2VzdCh0aGlzLm9wdGlvbnMuY2FuY2VsKS5sZW5ndGg6ITE7cmV0dXJuIHMmJiFuJiZ0aGlzLl9tb3VzZUNhcHR1cmUoZSk/KHRoaXMubW91c2VEZWxheU1ldD0hdGhpcy5vcHRpb25zLmRlbGF5LHRoaXMubW91c2VEZWxheU1ldHx8KHRoaXMuX21vdXNlRGVsYXlUaW1lcj1zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aS5tb3VzZURlbGF5TWV0PSEwfSx0aGlzLm9wdGlvbnMuZGVsYXkpKSx0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGUpJiZ0aGlzLl9tb3VzZURlbGF5TWV0KGUpJiYodGhpcy5fbW91c2VTdGFydGVkPXRoaXMuX21vdXNlU3RhcnQoZSkhPT0hMSwhdGhpcy5fbW91c2VTdGFydGVkKT8oZS5wcmV2ZW50RGVmYXVsdCgpLCEwKTooITA9PT10LmRhdGEoZS50YXJnZXQsdGhpcy53aWRnZXROYW1lKyIucHJldmVudENsaWNrRXZlbnQiKSYmdC5yZW1vdmVEYXRhKGUudGFyZ2V0LHRoaXMud2lkZ2V0TmFtZSsiLnByZXZlbnRDbGlja0V2ZW50IiksdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGU9ZnVuY3Rpb24odCl7cmV0dXJuIGkuX21vdXNlTW92ZSh0KX0sdGhpcy5fbW91c2VVcERlbGVnYXRlPWZ1bmN0aW9uKHQpe3JldHVybiBpLl9tb3VzZVVwKHQpfSx0aGlzLmRvY3VtZW50Lm9uKCJtb3VzZW1vdmUuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VNb3ZlRGVsZWdhdGUpLm9uKCJtb3VzZXVwLiIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlVXBEZWxlZ2F0ZSksZS5wcmV2ZW50RGVmYXVsdCgpLF89ITAsITApKTohMH19LF9tb3VzZU1vdmU6ZnVuY3Rpb24oZSl7aWYodGhpcy5fbW91c2VNb3ZlZCl7aWYodC51aS5pZSYmKCFkb2N1bWVudC5kb2N1bWVudE1vZGV8fDk+ZG9jdW1lbnQuZG9jdW1lbnRNb2RlKSYmIWUuYnV0dG9uKXJldHVybiB0aGlzLl9tb3VzZVVwKGUpO2lmKCFlLndoaWNoKWlmKGUub3JpZ2luYWxFdmVudC5hbHRLZXl8fGUub3JpZ2luYWxFdmVudC5jdHJsS2V5fHxlLm9yaWdpbmFsRXZlbnQubWV0YUtleXx8ZS5vcmlnaW5hbEV2ZW50LnNoaWZ0S2V5KXRoaXMuaWdub3JlTWlzc2luZ1doaWNoPSEwO2Vsc2UgaWYoIXRoaXMuaWdub3JlTWlzc2luZ1doaWNoKXJldHVybiB0aGlzLl9tb3VzZVVwKGUpfXJldHVybihlLndoaWNofHxlLmJ1dHRvbikmJih0aGlzLl9tb3VzZU1vdmVkPSEwKSx0aGlzLl9tb3VzZVN0YXJ0ZWQ/KHRoaXMuX21vdXNlRHJhZyhlKSxlLnByZXZlbnREZWZhdWx0KCkpOih0aGlzLl9tb3VzZURpc3RhbmNlTWV0KGUpJiZ0aGlzLl9tb3VzZURlbGF5TWV0KGUpJiYodGhpcy5fbW91c2VTdGFydGVkPXRoaXMuX21vdXNlU3RhcnQodGhpcy5fbW91c2VEb3duRXZlbnQsZSkhPT0hMSx0aGlzLl9tb3VzZVN0YXJ0ZWQ/dGhpcy5fbW91c2VEcmFnKGUpOnRoaXMuX21vdXNlVXAoZSkpLCF0aGlzLl9tb3VzZVN0YXJ0ZWQpfSxfbW91c2VVcDpmdW5jdGlvbihlKXt0aGlzLmRvY3VtZW50Lm9mZigibW91c2Vtb3ZlLiIrdGhpcy53aWRnZXROYW1lLHRoaXMuX21vdXNlTW92ZURlbGVnYXRlKS5vZmYoIm1vdXNldXAuIit0aGlzLndpZGdldE5hbWUsdGhpcy5fbW91c2VVcERlbGVnYXRlKSx0aGlzLl9tb3VzZVN0YXJ0ZWQmJih0aGlzLl9tb3VzZVN0YXJ0ZWQ9ITEsZS50YXJnZXQ9PT10aGlzLl9tb3VzZURvd25FdmVudC50YXJnZXQmJnQuZGF0YShlLnRhcmdldCx0aGlzLndpZGdldE5hbWUrIi5wcmV2ZW50Q2xpY2tFdmVudCIsITApLHRoaXMuX21vdXNlU3RvcChlKSksdGhpcy5fbW91c2VEZWxheVRpbWVyJiYoY2xlYXJUaW1lb3V0KHRoaXMuX21vdXNlRGVsYXlUaW1lciksZGVsZXRlIHRoaXMuX21vdXNlRGVsYXlUaW1lciksdGhpcy5pZ25vcmVNaXNzaW5nV2hpY2g9ITEsXz0hMSxlLnByZXZlbnREZWZhdWx0KCl9LF9tb3VzZURpc3RhbmNlTWV0OmZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLm1heChNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWC10LnBhZ2VYKSxNYXRoLmFicyh0aGlzLl9tb3VzZURvd25FdmVudC5wYWdlWS10LnBhZ2VZKSk+PXRoaXMub3B0aW9ucy5kaXN0YW5jZX0sX21vdXNlRGVsYXlNZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tb3VzZURlbGF5TWV0fSxfbW91c2VTdGFydDpmdW5jdGlvbigpe30sX21vdXNlRHJhZzpmdW5jdGlvbigpe30sX21vdXNlU3RvcDpmdW5jdGlvbigpe30sX21vdXNlQ2FwdHVyZTpmdW5jdGlvbigpe3JldHVybiEwfX0pLHQudWkucGx1Z2luPXthZGQ6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuLG89dC51aVtlXS5wcm90b3R5cGU7Zm9yKG4gaW4gcylvLnBsdWdpbnNbbl09by5wbHVnaW5zW25dfHxbXSxvLnBsdWdpbnNbbl0ucHVzaChbaSxzW25dXSl9LGNhbGw6ZnVuY3Rpb24odCxlLGkscyl7dmFyIG4sbz10LnBsdWdpbnNbZV07aWYobyYmKHN8fHQuZWxlbWVudFswXS5wYXJlbnROb2RlJiYxMSE9PXQuZWxlbWVudFswXS5wYXJlbnROb2RlLm5vZGVUeXBlKSlmb3Iobj0wO28ubGVuZ3RoPm47bisrKXQub3B0aW9uc1tvW25dWzBdXSYmb1tuXVsxXS5hcHBseSh0LmVsZW1lbnQsaSl9fSx0LnVpLnNhZmVCbHVyPWZ1bmN0aW9uKGUpe2UmJiJib2R5IiE9PWUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSYmdChlKS50cmlnZ2VyKCJibHVyIil9LHQud2lkZ2V0KCJ1aS5kcmFnZ2FibGUiLHQudWkubW91c2Use3ZlcnNpb246IjEuMTIuMSIsd2lkZ2V0RXZlbnRQcmVmaXg6ImRyYWciLG9wdGlvbnM6e2FkZENsYXNzZXM6ITAsYXBwZW5kVG86InBhcmVudCIsYXhpczohMSxjb25uZWN0VG9Tb3J0YWJsZTohMSxjb250YWlubWVudDohMSxjdXJzb3I6ImF1dG8iLGN1cnNvckF0OiExLGdyaWQ6ITEsaGFuZGxlOiExLGhlbHBlcjoib3JpZ2luYWwiLGlmcmFtZUZpeDohMSxvcGFjaXR5OiExLHJlZnJlc2hQb3NpdGlvbnM6ITEscmV2ZXJ0OiExLHJldmVydER1cmF0aW9uOjUwMCxzY29wZToiZGVmYXVsdCIsc2Nyb2xsOiEwLHNjcm9sbFNlbnNpdGl2aXR5OjIwLHNjcm9sbFNwZWVkOjIwLHNuYXA6ITEsc25hcE1vZGU6ImJvdGgiLHNuYXBUb2xlcmFuY2U6MjAsc3RhY2s6ITEsekluZGV4OiExLGRyYWc6bnVsbCxzdGFydDpudWxsLHN0b3A6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpeyJvcmlnaW5hbCI9PT10aGlzLm9wdGlvbnMuaGVscGVyJiZ0aGlzLl9zZXRQb3NpdGlvblJlbGF0aXZlKCksdGhpcy5vcHRpb25zLmFkZENsYXNzZXMmJnRoaXMuX2FkZENsYXNzKCJ1aS1kcmFnZ2FibGUiKSx0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKSx0aGlzLl9tb3VzZUluaXQoKX0sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3RoaXMuX3N1cGVyKHQsZSksImhhbmRsZSI9PT10JiYodGhpcy5fcmVtb3ZlSGFuZGxlQ2xhc3NOYW1lKCksdGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCkpfSxfZGVzdHJveTpmdW5jdGlvbigpe3JldHVybih0aGlzLmhlbHBlcnx8dGhpcy5lbGVtZW50KS5pcygiLnVpLWRyYWdnYWJsZS1kcmFnZ2luZyIpPyh0aGlzLmRlc3Ryb3lPbkNsZWFyPSEwLHZvaWQgMCk6KHRoaXMuX3JlbW92ZUhhbmRsZUNsYXNzTmFtZSgpLHRoaXMuX21vdXNlRGVzdHJveSgpLHZvaWQgMCl9LF9tb3VzZUNhcHR1cmU6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5vcHRpb25zO3JldHVybiB0aGlzLmhlbHBlcnx8aS5kaXNhYmxlZHx8dChlLnRhcmdldCkuY2xvc2VzdCgiLnVpLXJlc2l6YWJsZS1oYW5kbGUiKS5sZW5ndGg+MD8hMToodGhpcy5oYW5kbGU9dGhpcy5fZ2V0SGFuZGxlKGUpLHRoaXMuaGFuZGxlPyh0aGlzLl9ibHVyQWN0aXZlRWxlbWVudChlKSx0aGlzLl9ibG9ja0ZyYW1lcyhpLmlmcmFtZUZpeD09PSEwPyJpZnJhbWUiOmkuaWZyYW1lRml4KSwhMCk6ITEpfSxfYmxvY2tGcmFtZXM6ZnVuY3Rpb24oZSl7dGhpcy5pZnJhbWVCbG9ja3M9dGhpcy5kb2N1bWVudC5maW5kKGUpLm1hcChmdW5jdGlvbigpe3ZhciBlPXQodGhpcyk7cmV0dXJuIHQoIjxkaXY+IikuY3NzKCJwb3NpdGlvbiIsImFic29sdXRlIikuYXBwZW5kVG8oZS5wYXJlbnQoKSkub3V0ZXJXaWR0aChlLm91dGVyV2lkdGgoKSkub3V0ZXJIZWlnaHQoZS5vdXRlckhlaWdodCgpKS5vZmZzZXQoZS5vZmZzZXQoKSlbMF19KX0sX3VuYmxvY2tGcmFtZXM6ZnVuY3Rpb24oKXt0aGlzLmlmcmFtZUJsb2NrcyYmKHRoaXMuaWZyYW1lQmxvY2tzLnJlbW92ZSgpLGRlbGV0ZSB0aGlzLmlmcmFtZUJsb2Nrcyl9LF9ibHVyQWN0aXZlRWxlbWVudDpmdW5jdGlvbihlKXt2YXIgaT10LnVpLnNhZmVBY3RpdmVFbGVtZW50KHRoaXMuZG9jdW1lbnRbMF0pLHM9dChlLnRhcmdldCk7cy5jbG9zZXN0KGkpLmxlbmd0aHx8dC51aS5zYWZlQmx1cihpKX0sX21vdXNlU3RhcnQ6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5vcHRpb25zO3JldHVybiB0aGlzLmhlbHBlcj10aGlzLl9jcmVhdGVIZWxwZXIoZSksdGhpcy5fYWRkQ2xhc3ModGhpcy5oZWxwZXIsInVpLWRyYWdnYWJsZS1kcmFnZ2luZyIpLHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKSx0LnVpLmRkbWFuYWdlciYmKHQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ9dGhpcyksdGhpcy5fY2FjaGVNYXJnaW5zKCksdGhpcy5jc3NQb3NpdGlvbj10aGlzLmhlbHBlci5jc3MoInBvc2l0aW9uIiksdGhpcy5zY3JvbGxQYXJlbnQ9dGhpcy5oZWxwZXIuc2Nyb2xsUGFyZW50KCEwKSx0aGlzLm9mZnNldFBhcmVudD10aGlzLmhlbHBlci5vZmZzZXRQYXJlbnQoKSx0aGlzLmhhc0ZpeGVkQW5jZXN0b3I9dGhpcy5oZWxwZXIucGFyZW50cygpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiJmaXhlZCI9PT10KHRoaXMpLmNzcygicG9zaXRpb24iKX0pLmxlbmd0aD4wLHRoaXMucG9zaXRpb25BYnM9dGhpcy5lbGVtZW50Lm9mZnNldCgpLHRoaXMuX3JlZnJlc2hPZmZzZXRzKGUpLHRoaXMub3JpZ2luYWxQb3NpdGlvbj10aGlzLnBvc2l0aW9uPXRoaXMuX2dlbmVyYXRlUG9zaXRpb24oZSwhMSksdGhpcy5vcmlnaW5hbFBhZ2VYPWUucGFnZVgsdGhpcy5vcmlnaW5hbFBhZ2VZPWUucGFnZVksaS5jdXJzb3JBdCYmdGhpcy5fYWRqdXN0T2Zmc2V0RnJvbUhlbHBlcihpLmN1cnNvckF0KSx0aGlzLl9zZXRDb250YWlubWVudCgpLHRoaXMuX3RyaWdnZXIoInN0YXJ0IixlKT09PSExPyh0aGlzLl9jbGVhcigpLCExKToodGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpLHQudWkuZGRtYW5hZ2VyJiYhaS5kcm9wQmVoYXZpb3VyJiZ0LnVpLmRkbWFuYWdlci5wcmVwYXJlT2Zmc2V0cyh0aGlzLGUpLHRoaXMuX21vdXNlRHJhZyhlLCEwKSx0LnVpLmRkbWFuYWdlciYmdC51aS5kZG1hbmFnZXIuZHJhZ1N0YXJ0KHRoaXMsZSksITApfSxfcmVmcmVzaE9mZnNldHM6ZnVuY3Rpb24odCl7dGhpcy5vZmZzZXQ9e3RvcDp0aGlzLnBvc2l0aW9uQWJzLnRvcC10aGlzLm1hcmdpbnMudG9wLGxlZnQ6dGhpcy5wb3NpdGlvbkFicy5sZWZ0LXRoaXMubWFyZ2lucy5sZWZ0LHNjcm9sbDohMSxwYXJlbnQ6dGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCkscmVsYXRpdmU6dGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKX0sdGhpcy5vZmZzZXQuY2xpY2s9e2xlZnQ6dC5wYWdlWC10aGlzLm9mZnNldC5sZWZ0LHRvcDp0LnBhZ2VZLXRoaXMub2Zmc2V0LnRvcH19LF9tb3VzZURyYWc6ZnVuY3Rpb24oZSxpKXtpZih0aGlzLmhhc0ZpeGVkQW5jZXN0b3ImJih0aGlzLm9mZnNldC5wYXJlbnQ9dGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCkpLHRoaXMucG9zaXRpb249dGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihlLCEwKSx0aGlzLnBvc2l0aW9uQWJzPXRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKCJhYnNvbHV0ZSIpLCFpKXt2YXIgcz10aGlzLl91aUhhc2goKTtpZih0aGlzLl90cmlnZ2VyKCJkcmFnIixlLHMpPT09ITEpcmV0dXJuIHRoaXMuX21vdXNlVXAobmV3IHQuRXZlbnQoIm1vdXNldXAiLGUpKSwhMTt0aGlzLnBvc2l0aW9uPXMucG9zaXRpb259cmV0dXJuIHRoaXMuaGVscGVyWzBdLnN0eWxlLmxlZnQ9dGhpcy5wb3NpdGlvbi5sZWZ0KyJweCIsdGhpcy5oZWxwZXJbMF0uc3R5bGUudG9wPXRoaXMucG9zaXRpb24udG9wKyJweCIsdC51aS5kZG1hbmFnZXImJnQudWkuZGRtYW5hZ2VyLmRyYWcodGhpcyxlKSwhMX0sX21vdXNlU3RvcDpmdW5jdGlvbihlKXt2YXIgaT10aGlzLHM9ITE7cmV0dXJuIHQudWkuZGRtYW5hZ2VyJiYhdGhpcy5vcHRpb25zLmRyb3BCZWhhdmlvdXImJihzPXQudWkuZGRtYW5hZ2VyLmRyb3AodGhpcyxlKSksdGhpcy5kcm9wcGVkJiYocz10aGlzLmRyb3BwZWQsdGhpcy5kcm9wcGVkPSExKSwiaW52YWxpZCI9PT10aGlzLm9wdGlvbnMucmV2ZXJ0JiYhc3x8InZhbGlkIj09PXRoaXMub3B0aW9ucy5yZXZlcnQmJnN8fHRoaXMub3B0aW9ucy5yZXZlcnQ9PT0hMHx8dC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5yZXZlcnQpJiZ0aGlzLm9wdGlvbnMucmV2ZXJ0LmNhbGwodGhpcy5lbGVtZW50LHMpP3QodGhpcy5oZWxwZXIpLmFuaW1hdGUodGhpcy5vcmlnaW5hbFBvc2l0aW9uLHBhcnNlSW50KHRoaXMub3B0aW9ucy5yZXZlcnREdXJhdGlvbiwxMCksZnVuY3Rpb24oKXtpLl90cmlnZ2VyKCJzdG9wIixlKSE9PSExJiZpLl9jbGVhcigpfSk6dGhpcy5fdHJpZ2dlcigic3RvcCIsZSkhPT0hMSYmdGhpcy5fY2xlYXIoKSwhMX0sX21vdXNlVXA6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX3VuYmxvY2tGcmFtZXMoKSx0LnVpLmRkbWFuYWdlciYmdC51aS5kZG1hbmFnZXIuZHJhZ1N0b3AodGhpcyxlKSx0aGlzLmhhbmRsZUVsZW1lbnQuaXMoZS50YXJnZXQpJiZ0aGlzLmVsZW1lbnQudHJpZ2dlcigiZm9jdXMiKSx0LnVpLm1vdXNlLnByb3RvdHlwZS5fbW91c2VVcC5jYWxsKHRoaXMsZSl9LGNhbmNlbDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhlbHBlci5pcygiLnVpLWRyYWdnYWJsZS1kcmFnZ2luZyIpP3RoaXMuX21vdXNlVXAobmV3IHQuRXZlbnQoIm1vdXNldXAiLHt0YXJnZXQ6dGhpcy5lbGVtZW50WzBdfSkpOnRoaXMuX2NsZWFyKCksdGhpc30sX2dldEhhbmRsZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5vcHRpb25zLmhhbmRsZT8hIXQoZS50YXJnZXQpLmNsb3Nlc3QodGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLmhhbmRsZSkpLmxlbmd0aDohMH0sX3NldEhhbmRsZUNsYXNzTmFtZTpmdW5jdGlvbigpe3RoaXMuaGFuZGxlRWxlbWVudD10aGlzLm9wdGlvbnMuaGFuZGxlP3RoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5oYW5kbGUpOnRoaXMuZWxlbWVudCx0aGlzLl9hZGRDbGFzcyh0aGlzLmhhbmRsZUVsZW1lbnQsInVpLWRyYWdnYWJsZS1oYW5kbGUiKX0sX3JlbW92ZUhhbmRsZUNsYXNzTmFtZTpmdW5jdGlvbigpe3RoaXMuX3JlbW92ZUNsYXNzKHRoaXMuaGFuZGxlRWxlbWVudCwidWktZHJhZ2dhYmxlLWhhbmRsZSIpfSxfY3JlYXRlSGVscGVyOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMub3B0aW9ucyxzPXQuaXNGdW5jdGlvbihpLmhlbHBlciksbj1zP3QoaS5oZWxwZXIuYXBwbHkodGhpcy5lbGVtZW50WzBdLFtlXSkpOiJjbG9uZSI9PT1pLmhlbHBlcj90aGlzLmVsZW1lbnQuY2xvbmUoKS5yZW1vdmVBdHRyKCJpZCIpOnRoaXMuZWxlbWVudDtyZXR1cm4gbi5wYXJlbnRzKCJib2R5IikubGVuZ3RofHxuLmFwcGVuZFRvKCJwYXJlbnQiPT09aS5hcHBlbmRUbz90aGlzLmVsZW1lbnRbMF0ucGFyZW50Tm9kZTppLmFwcGVuZFRvKSxzJiZuWzBdPT09dGhpcy5lbGVtZW50WzBdJiZ0aGlzLl9zZXRQb3NpdGlvblJlbGF0aXZlKCksblswXT09PXRoaXMuZWxlbWVudFswXXx8LyhmaXhlZHxhYnNvbHV0ZSkvLnRlc3Qobi5jc3MoInBvc2l0aW9uIikpfHxuLmNzcygicG9zaXRpb24iLCJhYnNvbHV0ZSIpLG59LF9zZXRQb3NpdGlvblJlbGF0aXZlOmZ1bmN0aW9uKCl7L14oPzpyfGF8ZikvLnRlc3QodGhpcy5lbGVtZW50LmNzcygicG9zaXRpb24iKSl8fCh0aGlzLmVsZW1lbnRbMF0uc3R5bGUucG9zaXRpb249InJlbGF0aXZlIil9LF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOmZ1bmN0aW9uKGUpeyJzdHJpbmciPT10eXBlb2YgZSYmKGU9ZS5zcGxpdCgiICIpKSx0LmlzQXJyYXkoZSkmJihlPXtsZWZ0OitlWzBdLHRvcDorZVsxXXx8MH0pLCJsZWZ0ImluIGUmJih0aGlzLm9mZnNldC5jbGljay5sZWZ0PWUubGVmdCt0aGlzLm1hcmdpbnMubGVmdCksInJpZ2h0ImluIGUmJih0aGlzLm9mZnNldC5jbGljay5sZWZ0PXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtZS5yaWdodCt0aGlzLm1hcmdpbnMubGVmdCksInRvcCJpbiBlJiYodGhpcy5vZmZzZXQuY2xpY2sudG9wPWUudG9wK3RoaXMubWFyZ2lucy50b3ApLCJib3R0b20iaW4gZSYmKHRoaXMub2Zmc2V0LmNsaWNrLnRvcD10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC1lLmJvdHRvbSt0aGlzLm1hcmdpbnMudG9wKX0sX2lzUm9vdE5vZGU6ZnVuY3Rpb24odCl7cmV0dXJuLyhodG1sfGJvZHkpL2kudGVzdCh0LnRhZ05hbWUpfHx0PT09dGhpcy5kb2N1bWVudFswXX0sX2dldFBhcmVudE9mZnNldDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub2Zmc2V0UGFyZW50Lm9mZnNldCgpLGk9dGhpcy5kb2N1bWVudFswXTtyZXR1cm4iYWJzb2x1dGUiPT09dGhpcy5jc3NQb3NpdGlvbiYmdGhpcy5zY3JvbGxQYXJlbnRbMF0hPT1pJiZ0LmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLHRoaXMub2Zmc2V0UGFyZW50WzBdKSYmKGUubGVmdCs9dGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpLGUudG9wKz10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSksdGhpcy5faXNSb290Tm9kZSh0aGlzLm9mZnNldFBhcmVudFswXSkmJihlPXt0b3A6MCxsZWZ0OjB9KSx7dG9wOmUudG9wKyhwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoImJvcmRlclRvcFdpZHRoIiksMTApfHwwKSxsZWZ0OmUubGVmdCsocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApfX0sX2dldFJlbGF0aXZlT2Zmc2V0OmZ1bmN0aW9uKCl7aWYoInJlbGF0aXZlIiE9PXRoaXMuY3NzUG9zaXRpb24pcmV0dXJue3RvcDowLGxlZnQ6MH07dmFyIHQ9dGhpcy5lbGVtZW50LnBvc2l0aW9uKCksZT10aGlzLl9pc1Jvb3ROb2RlKHRoaXMuc2Nyb2xsUGFyZW50WzBdKTtyZXR1cm57dG9wOnQudG9wLShwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoInRvcCIpLDEwKXx8MCkrKGU/MDp0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKSksbGVmdDp0LmxlZnQtKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcygibGVmdCIpLDEwKXx8MCkrKGU/MDp0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCkpfQp9LF9jYWNoZU1hcmdpbnM6ZnVuY3Rpb24oKXt0aGlzLm1hcmdpbnM9e2xlZnQ6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcygibWFyZ2luTGVmdCIpLDEwKXx8MCx0b3A6cGFyc2VJbnQodGhpcy5lbGVtZW50LmNzcygibWFyZ2luVG9wIiksMTApfHwwLHJpZ2h0OnBhcnNlSW50KHRoaXMuZWxlbWVudC5jc3MoIm1hcmdpblJpZ2h0IiksMTApfHwwLGJvdHRvbTpwYXJzZUludCh0aGlzLmVsZW1lbnQuY3NzKCJtYXJnaW5Cb3R0b20iKSwxMCl8fDB9fSxfY2FjaGVIZWxwZXJQcm9wb3J0aW9uczpmdW5jdGlvbigpe3RoaXMuaGVscGVyUHJvcG9ydGlvbnM9e3dpZHRoOnRoaXMuaGVscGVyLm91dGVyV2lkdGgoKSxoZWlnaHQ6dGhpcy5oZWxwZXIub3V0ZXJIZWlnaHQoKX19LF9zZXRDb250YWlubWVudDpmdW5jdGlvbigpe3ZhciBlLGkscyxuPXRoaXMub3B0aW9ucyxvPXRoaXMuZG9jdW1lbnRbMF07cmV0dXJuIHRoaXMucmVsYXRpdmVDb250YWluZXI9bnVsbCxuLmNvbnRhaW5tZW50PyJ3aW5kb3ciPT09bi5jb250YWlubWVudD8odGhpcy5jb250YWlubWVudD1bdCh3aW5kb3cpLnNjcm9sbExlZnQoKS10aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0LXRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0LHQod2luZG93KS5zY3JvbGxUb3AoKS10aGlzLm9mZnNldC5yZWxhdGl2ZS50b3AtdGhpcy5vZmZzZXQucGFyZW50LnRvcCx0KHdpbmRvdykuc2Nyb2xsTGVmdCgpK3Qod2luZG93KS53aWR0aCgpLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtdGhpcy5tYXJnaW5zLmxlZnQsdCh3aW5kb3cpLnNjcm9sbFRvcCgpKyh0KHdpbmRvdykuaGVpZ2h0KCl8fG8uYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodCktdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQtdGhpcy5tYXJnaW5zLnRvcF0sdm9pZCAwKToiZG9jdW1lbnQiPT09bi5jb250YWlubWVudD8odGhpcy5jb250YWlubWVudD1bMCwwLHQobykud2lkdGgoKS10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLXRoaXMubWFyZ2lucy5sZWZ0LCh0KG8pLmhlaWdodCgpfHxvLmJvZHkucGFyZW50Tm9kZS5zY3JvbGxIZWlnaHQpLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LXRoaXMubWFyZ2lucy50b3BdLHZvaWQgMCk6bi5jb250YWlubWVudC5jb25zdHJ1Y3Rvcj09PUFycmF5Pyh0aGlzLmNvbnRhaW5tZW50PW4uY29udGFpbm1lbnQsdm9pZCAwKTooInBhcmVudCI9PT1uLmNvbnRhaW5tZW50JiYobi5jb250YWlubWVudD10aGlzLmhlbHBlclswXS5wYXJlbnROb2RlKSxpPXQobi5jb250YWlubWVudCkscz1pWzBdLHMmJihlPS8oc2Nyb2xsfGF1dG8pLy50ZXN0KGkuY3NzKCJvdmVyZmxvdyIpKSx0aGlzLmNvbnRhaW5tZW50PVsocGFyc2VJbnQoaS5jc3MoImJvcmRlckxlZnRXaWR0aCIpLDEwKXx8MCkrKHBhcnNlSW50KGkuY3NzKCJwYWRkaW5nTGVmdCIpLDEwKXx8MCksKHBhcnNlSW50KGkuY3NzKCJib3JkZXJUb3BXaWR0aCIpLDEwKXx8MCkrKHBhcnNlSW50KGkuY3NzKCJwYWRkaW5nVG9wIiksMTApfHwwKSwoZT9NYXRoLm1heChzLnNjcm9sbFdpZHRoLHMub2Zmc2V0V2lkdGgpOnMub2Zmc2V0V2lkdGgpLShwYXJzZUludChpLmNzcygiYm9yZGVyUmlnaHRXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KGkuY3NzKCJwYWRkaW5nUmlnaHQiKSwxMCl8fDApLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtdGhpcy5tYXJnaW5zLmxlZnQtdGhpcy5tYXJnaW5zLnJpZ2h0LChlP01hdGgubWF4KHMuc2Nyb2xsSGVpZ2h0LHMub2Zmc2V0SGVpZ2h0KTpzLm9mZnNldEhlaWdodCktKHBhcnNlSW50KGkuY3NzKCJib3JkZXJCb3R0b21XaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KGkuY3NzKCJwYWRkaW5nQm90dG9tIiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wLXRoaXMubWFyZ2lucy5ib3R0b21dLHRoaXMucmVsYXRpdmVDb250YWluZXI9aSksdm9pZCAwKToodGhpcy5jb250YWlubWVudD1udWxsLHZvaWQgMCl9LF9jb252ZXJ0UG9zaXRpb25UbzpmdW5jdGlvbih0LGUpe2V8fChlPXRoaXMucG9zaXRpb24pO3ZhciBpPSJhYnNvbHV0ZSI9PT10PzE6LTEscz10aGlzLl9pc1Jvb3ROb2RlKHRoaXMuc2Nyb2xsUGFyZW50WzBdKTtyZXR1cm57dG9wOmUudG9wK3RoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCppK3RoaXMub2Zmc2V0LnBhcmVudC50b3AqaS0oImZpeGVkIj09PXRoaXMuY3NzUG9zaXRpb24/LXRoaXMub2Zmc2V0LnNjcm9sbC50b3A6cz8wOnRoaXMub2Zmc2V0LnNjcm9sbC50b3ApKmksbGVmdDplLmxlZnQrdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdCppK3RoaXMub2Zmc2V0LnBhcmVudC5sZWZ0KmktKCJmaXhlZCI9PT10aGlzLmNzc1Bvc2l0aW9uPy10aGlzLm9mZnNldC5zY3JvbGwubGVmdDpzPzA6dGhpcy5vZmZzZXQuc2Nyb2xsLmxlZnQpKml9fSxfZ2VuZXJhdGVQb3NpdGlvbjpmdW5jdGlvbih0LGUpe3ZhciBpLHMsbixvLGE9dGhpcy5vcHRpb25zLHI9dGhpcy5faXNSb290Tm9kZSh0aGlzLnNjcm9sbFBhcmVudFswXSksaD10LnBhZ2VYLGw9dC5wYWdlWTtyZXR1cm4gciYmdGhpcy5vZmZzZXQuc2Nyb2xsfHwodGhpcy5vZmZzZXQuc2Nyb2xsPXt0b3A6dGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCksbGVmdDp0aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCl9KSxlJiYodGhpcy5jb250YWlubWVudCYmKHRoaXMucmVsYXRpdmVDb250YWluZXI/KHM9dGhpcy5yZWxhdGl2ZUNvbnRhaW5lci5vZmZzZXQoKSxpPVt0aGlzLmNvbnRhaW5tZW50WzBdK3MubGVmdCx0aGlzLmNvbnRhaW5tZW50WzFdK3MudG9wLHRoaXMuY29udGFpbm1lbnRbMl0rcy5sZWZ0LHRoaXMuY29udGFpbm1lbnRbM10rcy50b3BdKTppPXRoaXMuY29udGFpbm1lbnQsdC5wYWdlWC10aGlzLm9mZnNldC5jbGljay5sZWZ0PGlbMF0mJihoPWlbMF0rdGhpcy5vZmZzZXQuY2xpY2subGVmdCksdC5wYWdlWS10aGlzLm9mZnNldC5jbGljay50b3A8aVsxXSYmKGw9aVsxXSt0aGlzLm9mZnNldC5jbGljay50b3ApLHQucGFnZVgtdGhpcy5vZmZzZXQuY2xpY2subGVmdD5pWzJdJiYoaD1pWzJdK3RoaXMub2Zmc2V0LmNsaWNrLmxlZnQpLHQucGFnZVktdGhpcy5vZmZzZXQuY2xpY2sudG9wPmlbM10mJihsPWlbM10rdGhpcy5vZmZzZXQuY2xpY2sudG9wKSksYS5ncmlkJiYobj1hLmdyaWRbMV0/dGhpcy5vcmlnaW5hbFBhZ2VZK01hdGgucm91bmQoKGwtdGhpcy5vcmlnaW5hbFBhZ2VZKS9hLmdyaWRbMV0pKmEuZ3JpZFsxXTp0aGlzLm9yaWdpbmFsUGFnZVksbD1pP24tdGhpcy5vZmZzZXQuY2xpY2sudG9wPj1pWzFdfHxuLXRoaXMub2Zmc2V0LmNsaWNrLnRvcD5pWzNdP246bi10aGlzLm9mZnNldC5jbGljay50b3A+PWlbMV0/bi1hLmdyaWRbMV06bithLmdyaWRbMV06bixvPWEuZ3JpZFswXT90aGlzLm9yaWdpbmFsUGFnZVgrTWF0aC5yb3VuZCgoaC10aGlzLm9yaWdpbmFsUGFnZVgpL2EuZ3JpZFswXSkqYS5ncmlkWzBdOnRoaXMub3JpZ2luYWxQYWdlWCxoPWk/by10aGlzLm9mZnNldC5jbGljay5sZWZ0Pj1pWzBdfHxvLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ+aVsyXT9vOm8tdGhpcy5vZmZzZXQuY2xpY2subGVmdD49aVswXT9vLWEuZ3JpZFswXTpvK2EuZ3JpZFswXTpvKSwieSI9PT1hLmF4aXMmJihoPXRoaXMub3JpZ2luYWxQYWdlWCksIngiPT09YS5heGlzJiYobD10aGlzLm9yaWdpbmFsUGFnZVkpKSx7dG9wOmwtdGhpcy5vZmZzZXQuY2xpY2sudG9wLXRoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcC10aGlzLm9mZnNldC5wYXJlbnQudG9wKygiZml4ZWQiPT09dGhpcy5jc3NQb3NpdGlvbj8tdGhpcy5vZmZzZXQuc2Nyb2xsLnRvcDpyPzA6dGhpcy5vZmZzZXQuc2Nyb2xsLnRvcCksbGVmdDpoLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQtdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCsoImZpeGVkIj09PXRoaXMuY3NzUG9zaXRpb24/LXRoaXMub2Zmc2V0LnNjcm9sbC5sZWZ0OnI/MDp0aGlzLm9mZnNldC5zY3JvbGwubGVmdCl9fSxfY2xlYXI6ZnVuY3Rpb24oKXt0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLmhlbHBlciwidWktZHJhZ2dhYmxlLWRyYWdnaW5nIiksdGhpcy5oZWxwZXJbMF09PT10aGlzLmVsZW1lbnRbMF18fHRoaXMuY2FuY2VsSGVscGVyUmVtb3ZhbHx8dGhpcy5oZWxwZXIucmVtb3ZlKCksdGhpcy5oZWxwZXI9bnVsbCx0aGlzLmNhbmNlbEhlbHBlclJlbW92YWw9ITEsdGhpcy5kZXN0cm95T25DbGVhciYmdGhpcy5kZXN0cm95KCl9LF90cmlnZ2VyOmZ1bmN0aW9uKGUsaSxzKXtyZXR1cm4gcz1zfHx0aGlzLl91aUhhc2goKSx0LnVpLnBsdWdpbi5jYWxsKHRoaXMsZSxbaSxzLHRoaXNdLCEwKSwvXihkcmFnfHN0YXJ0fHN0b3ApLy50ZXN0KGUpJiYodGhpcy5wb3NpdGlvbkFicz10aGlzLl9jb252ZXJ0UG9zaXRpb25UbygiYWJzb2x1dGUiKSxzLm9mZnNldD10aGlzLnBvc2l0aW9uQWJzKSx0LldpZGdldC5wcm90b3R5cGUuX3RyaWdnZXIuY2FsbCh0aGlzLGUsaSxzKX0scGx1Z2luczp7fSxfdWlIYXNoOmZ1bmN0aW9uKCl7cmV0dXJue2hlbHBlcjp0aGlzLmhlbHBlcixwb3NpdGlvbjp0aGlzLnBvc2l0aW9uLG9yaWdpbmFsUG9zaXRpb246dGhpcy5vcmlnaW5hbFBvc2l0aW9uLG9mZnNldDp0aGlzLnBvc2l0aW9uQWJzfX19KSx0LnVpLnBsdWdpbi5hZGQoImRyYWdnYWJsZSIsImNvbm5lY3RUb1NvcnRhYmxlIix7c3RhcnQ6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuPXQuZXh0ZW5kKHt9LGkse2l0ZW06cy5lbGVtZW50fSk7cy5zb3J0YWJsZXM9W10sdChzLm9wdGlvbnMuY29ubmVjdFRvU29ydGFibGUpLmVhY2goZnVuY3Rpb24oKXt2YXIgaT10KHRoaXMpLnNvcnRhYmxlKCJpbnN0YW5jZSIpO2kmJiFpLm9wdGlvbnMuZGlzYWJsZWQmJihzLnNvcnRhYmxlcy5wdXNoKGkpLGkucmVmcmVzaFBvc2l0aW9ucygpLGkuX3RyaWdnZXIoImFjdGl2YXRlIixlLG4pKX0pfSxzdG9wOmZ1bmN0aW9uKGUsaSxzKXt2YXIgbj10LmV4dGVuZCh7fSxpLHtpdGVtOnMuZWxlbWVudH0pO3MuY2FuY2VsSGVscGVyUmVtb3ZhbD0hMSx0LmVhY2gocy5zb3J0YWJsZXMsZnVuY3Rpb24oKXt2YXIgdD10aGlzO3QuaXNPdmVyPyh0LmlzT3Zlcj0wLHMuY2FuY2VsSGVscGVyUmVtb3ZhbD0hMCx0LmNhbmNlbEhlbHBlclJlbW92YWw9ITEsdC5fc3RvcmVkQ1NTPXtwb3NpdGlvbjp0LnBsYWNlaG9sZGVyLmNzcygicG9zaXRpb24iKSx0b3A6dC5wbGFjZWhvbGRlci5jc3MoInRvcCIpLGxlZnQ6dC5wbGFjZWhvbGRlci5jc3MoImxlZnQiKX0sdC5fbW91c2VTdG9wKGUpLHQub3B0aW9ucy5oZWxwZXI9dC5vcHRpb25zLl9oZWxwZXIpOih0LmNhbmNlbEhlbHBlclJlbW92YWw9ITAsdC5fdHJpZ2dlcigiZGVhY3RpdmF0ZSIsZSxuKSl9KX0sZHJhZzpmdW5jdGlvbihlLGkscyl7dC5lYWNoKHMuc29ydGFibGVzLGZ1bmN0aW9uKCl7dmFyIG49ITEsbz10aGlzO28ucG9zaXRpb25BYnM9cy5wb3NpdGlvbkFicyxvLmhlbHBlclByb3BvcnRpb25zPXMuaGVscGVyUHJvcG9ydGlvbnMsby5vZmZzZXQuY2xpY2s9cy5vZmZzZXQuY2xpY2ssby5faW50ZXJzZWN0c1dpdGgoby5jb250YWluZXJDYWNoZSkmJihuPSEwLHQuZWFjaChzLnNvcnRhYmxlcyxmdW5jdGlvbigpe3JldHVybiB0aGlzLnBvc2l0aW9uQWJzPXMucG9zaXRpb25BYnMsdGhpcy5oZWxwZXJQcm9wb3J0aW9ucz1zLmhlbHBlclByb3BvcnRpb25zLHRoaXMub2Zmc2V0LmNsaWNrPXMub2Zmc2V0LmNsaWNrLHRoaXMhPT1vJiZ0aGlzLl9pbnRlcnNlY3RzV2l0aCh0aGlzLmNvbnRhaW5lckNhY2hlKSYmdC5jb250YWlucyhvLmVsZW1lbnRbMF0sdGhpcy5lbGVtZW50WzBdKSYmKG49ITEpLG59KSksbj8oby5pc092ZXJ8fChvLmlzT3Zlcj0xLHMuX3BhcmVudD1pLmhlbHBlci5wYXJlbnQoKSxvLmN1cnJlbnRJdGVtPWkuaGVscGVyLmFwcGVuZFRvKG8uZWxlbWVudCkuZGF0YSgidWktc29ydGFibGUtaXRlbSIsITApLG8ub3B0aW9ucy5faGVscGVyPW8ub3B0aW9ucy5oZWxwZXIsby5vcHRpb25zLmhlbHBlcj1mdW5jdGlvbigpe3JldHVybiBpLmhlbHBlclswXX0sZS50YXJnZXQ9by5jdXJyZW50SXRlbVswXSxvLl9tb3VzZUNhcHR1cmUoZSwhMCksby5fbW91c2VTdGFydChlLCEwLCEwKSxvLm9mZnNldC5jbGljay50b3A9cy5vZmZzZXQuY2xpY2sudG9wLG8ub2Zmc2V0LmNsaWNrLmxlZnQ9cy5vZmZzZXQuY2xpY2subGVmdCxvLm9mZnNldC5wYXJlbnQubGVmdC09cy5vZmZzZXQucGFyZW50LmxlZnQtby5vZmZzZXQucGFyZW50LmxlZnQsby5vZmZzZXQucGFyZW50LnRvcC09cy5vZmZzZXQucGFyZW50LnRvcC1vLm9mZnNldC5wYXJlbnQudG9wLHMuX3RyaWdnZXIoInRvU29ydGFibGUiLGUpLHMuZHJvcHBlZD1vLmVsZW1lbnQsdC5lYWNoKHMuc29ydGFibGVzLGZ1bmN0aW9uKCl7dGhpcy5yZWZyZXNoUG9zaXRpb25zKCl9KSxzLmN1cnJlbnRJdGVtPXMuZWxlbWVudCxvLmZyb21PdXRzaWRlPXMpLG8uY3VycmVudEl0ZW0mJihvLl9tb3VzZURyYWcoZSksaS5wb3NpdGlvbj1vLnBvc2l0aW9uKSk6by5pc092ZXImJihvLmlzT3Zlcj0wLG8uY2FuY2VsSGVscGVyUmVtb3ZhbD0hMCxvLm9wdGlvbnMuX3JldmVydD1vLm9wdGlvbnMucmV2ZXJ0LG8ub3B0aW9ucy5yZXZlcnQ9ITEsby5fdHJpZ2dlcigib3V0IixlLG8uX3VpSGFzaChvKSksby5fbW91c2VTdG9wKGUsITApLG8ub3B0aW9ucy5yZXZlcnQ9by5vcHRpb25zLl9yZXZlcnQsby5vcHRpb25zLmhlbHBlcj1vLm9wdGlvbnMuX2hlbHBlcixvLnBsYWNlaG9sZGVyJiZvLnBsYWNlaG9sZGVyLnJlbW92ZSgpLGkuaGVscGVyLmFwcGVuZFRvKHMuX3BhcmVudCkscy5fcmVmcmVzaE9mZnNldHMoZSksaS5wb3NpdGlvbj1zLl9nZW5lcmF0ZVBvc2l0aW9uKGUsITApLHMuX3RyaWdnZXIoImZyb21Tb3J0YWJsZSIsZSkscy5kcm9wcGVkPSExLHQuZWFjaChzLnNvcnRhYmxlcyxmdW5jdGlvbigpe3RoaXMucmVmcmVzaFBvc2l0aW9ucygpfSkpfSl9fSksdC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJjdXJzb3IiLHtzdGFydDpmdW5jdGlvbihlLGkscyl7dmFyIG49dCgiYm9keSIpLG89cy5vcHRpb25zO24uY3NzKCJjdXJzb3IiKSYmKG8uX2N1cnNvcj1uLmNzcygiY3Vyc29yIikpLG4uY3NzKCJjdXJzb3IiLG8uY3Vyc29yKX0sc3RvcDpmdW5jdGlvbihlLGkscyl7dmFyIG49cy5vcHRpb25zO24uX2N1cnNvciYmdCgiYm9keSIpLmNzcygiY3Vyc29yIixuLl9jdXJzb3IpfX0pLHQudWkucGx1Z2luLmFkZCgiZHJhZ2dhYmxlIiwib3BhY2l0eSIse3N0YXJ0OmZ1bmN0aW9uKGUsaSxzKXt2YXIgbj10KGkuaGVscGVyKSxvPXMub3B0aW9ucztuLmNzcygib3BhY2l0eSIpJiYoby5fb3BhY2l0eT1uLmNzcygib3BhY2l0eSIpKSxuLmNzcygib3BhY2l0eSIsby5vcGFjaXR5KX0sc3RvcDpmdW5jdGlvbihlLGkscyl7dmFyIG49cy5vcHRpb25zO24uX29wYWNpdHkmJnQoaS5oZWxwZXIpLmNzcygib3BhY2l0eSIsbi5fb3BhY2l0eSl9fSksdC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJzY3JvbGwiLHtzdGFydDpmdW5jdGlvbih0LGUsaSl7aS5zY3JvbGxQYXJlbnROb3RIaWRkZW58fChpLnNjcm9sbFBhcmVudE5vdEhpZGRlbj1pLmhlbHBlci5zY3JvbGxQYXJlbnQoITEpKSxpLnNjcm9sbFBhcmVudE5vdEhpZGRlblswXSE9PWkuZG9jdW1lbnRbMF0mJiJIVE1MIiE9PWkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuWzBdLnRhZ05hbWUmJihpLm92ZXJmbG93T2Zmc2V0PWkuc2Nyb2xsUGFyZW50Tm90SGlkZGVuLm9mZnNldCgpKX0sZHJhZzpmdW5jdGlvbihlLGkscyl7dmFyIG49cy5vcHRpb25zLG89ITEsYT1zLnNjcm9sbFBhcmVudE5vdEhpZGRlblswXSxyPXMuZG9jdW1lbnRbMF07YSE9PXImJiJIVE1MIiE9PWEudGFnTmFtZT8obi5heGlzJiYieCI9PT1uLmF4aXN8fChzLm92ZXJmbG93T2Zmc2V0LnRvcCthLm9mZnNldEhlaWdodC1lLnBhZ2VZPG4uc2Nyb2xsU2Vuc2l0aXZpdHk/YS5zY3JvbGxUb3A9bz1hLnNjcm9sbFRvcCtuLnNjcm9sbFNwZWVkOmUucGFnZVktcy5vdmVyZmxvd09mZnNldC50b3A8bi5zY3JvbGxTZW5zaXRpdml0eSYmKGEuc2Nyb2xsVG9wPW89YS5zY3JvbGxUb3Atbi5zY3JvbGxTcGVlZCkpLG4uYXhpcyYmInkiPT09bi5heGlzfHwocy5vdmVyZmxvd09mZnNldC5sZWZ0K2Eub2Zmc2V0V2lkdGgtZS5wYWdlWDxuLnNjcm9sbFNlbnNpdGl2aXR5P2Euc2Nyb2xsTGVmdD1vPWEuc2Nyb2xsTGVmdCtuLnNjcm9sbFNwZWVkOmUucGFnZVgtcy5vdmVyZmxvd09mZnNldC5sZWZ0PG4uc2Nyb2xsU2Vuc2l0aXZpdHkmJihhLnNjcm9sbExlZnQ9bz1hLnNjcm9sbExlZnQtbi5zY3JvbGxTcGVlZCkpKToobi5heGlzJiYieCI9PT1uLmF4aXN8fChlLnBhZ2VZLXQocikuc2Nyb2xsVG9wKCk8bi5zY3JvbGxTZW5zaXRpdml0eT9vPXQocikuc2Nyb2xsVG9wKHQocikuc2Nyb2xsVG9wKCktbi5zY3JvbGxTcGVlZCk6dCh3aW5kb3cpLmhlaWdodCgpLShlLnBhZ2VZLXQocikuc2Nyb2xsVG9wKCkpPG4uc2Nyb2xsU2Vuc2l0aXZpdHkmJihvPXQocikuc2Nyb2xsVG9wKHQocikuc2Nyb2xsVG9wKCkrbi5zY3JvbGxTcGVlZCkpKSxuLmF4aXMmJiJ5Ij09PW4uYXhpc3x8KGUucGFnZVgtdChyKS5zY3JvbGxMZWZ0KCk8bi5zY3JvbGxTZW5zaXRpdml0eT9vPXQocikuc2Nyb2xsTGVmdCh0KHIpLnNjcm9sbExlZnQoKS1uLnNjcm9sbFNwZWVkKTp0KHdpbmRvdykud2lkdGgoKS0oZS5wYWdlWC10KHIpLnNjcm9sbExlZnQoKSk8bi5zY3JvbGxTZW5zaXRpdml0eSYmKG89dChyKS5zY3JvbGxMZWZ0KHQocikuc2Nyb2xsTGVmdCgpK24uc2Nyb2xsU3BlZWQpKSkpLG8hPT0hMSYmdC51aS5kZG1hbmFnZXImJiFuLmRyb3BCZWhhdmlvdXImJnQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHMsZSl9fSksdC51aS5wbHVnaW4uYWRkKCJkcmFnZ2FibGUiLCJzbmFwIix7c3RhcnQ6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuPXMub3B0aW9ucztzLnNuYXBFbGVtZW50cz1bXSx0KG4uc25hcC5jb25zdHJ1Y3RvciE9PVN0cmluZz9uLnNuYXAuaXRlbXN8fCI6ZGF0YSh1aS1kcmFnZ2FibGUpIjpuLnNuYXApLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLGk9ZS5vZmZzZXQoKTt0aGlzIT09cy5lbGVtZW50WzBdJiZzLnNuYXBFbGVtZW50cy5wdXNoKHtpdGVtOnRoaXMsd2lkdGg6ZS5vdXRlcldpZHRoKCksaGVpZ2h0OmUub3V0ZXJIZWlnaHQoKSx0b3A6aS50b3AsbGVmdDppLmxlZnR9KX0pfSxkcmFnOmZ1bmN0aW9uKGUsaSxzKXt2YXIgbixvLGEscixoLGwsYyx1LGQscCxmPXMub3B0aW9ucyxnPWYuc25hcFRvbGVyYW5jZSxtPWkub2Zmc2V0LmxlZnQsXz1tK3MuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsdj1pLm9mZnNldC50b3AsYj12K3MuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0O2ZvcihkPXMuc25hcEVsZW1lbnRzLmxlbmd0aC0xO2Q+PTA7ZC0tKWg9cy5zbmFwRWxlbWVudHNbZF0ubGVmdC1zLm1hcmdpbnMubGVmdCxsPWgrcy5zbmFwRWxlbWVudHNbZF0ud2lkdGgsYz1zLnNuYXBFbGVtZW50c1tkXS50b3Atcy5tYXJnaW5zLnRvcCx1PWMrcy5zbmFwRWxlbWVudHNbZF0uaGVpZ2h0LGgtZz5ffHxtPmwrZ3x8Yy1nPmJ8fHY+dStnfHwhdC5jb250YWlucyhzLnNuYXBFbGVtZW50c1tkXS5pdGVtLm93bmVyRG9jdW1lbnQscy5zbmFwRWxlbWVudHNbZF0uaXRlbSk/KHMuc25hcEVsZW1lbnRzW2RdLnNuYXBwaW5nJiZzLm9wdGlvbnMuc25hcC5yZWxlYXNlJiZzLm9wdGlvbnMuc25hcC5yZWxlYXNlLmNhbGwocy5lbGVtZW50LGUsdC5leHRlbmQocy5fdWlIYXNoKCkse3NuYXBJdGVtOnMuc25hcEVsZW1lbnRzW2RdLml0ZW19KSkscy5zbmFwRWxlbWVudHNbZF0uc25hcHBpbmc9ITEpOigiaW5uZXIiIT09Zi5zbmFwTW9kZSYmKG49Zz49TWF0aC5hYnMoYy1iKSxvPWc+PU1hdGguYWJzKHUtdiksYT1nPj1NYXRoLmFicyhoLV8pLHI9Zz49TWF0aC5hYnMobC1tKSxuJiYoaS5wb3NpdGlvbi50b3A9cy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOmMtcy5oZWxwZXJQcm9wb3J0aW9ucy5oZWlnaHQsbGVmdDowfSkudG9wKSxvJiYoaS5wb3NpdGlvbi50b3A9cy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOnUsbGVmdDowfSkudG9wKSxhJiYoaS5wb3NpdGlvbi5sZWZ0PXMuX2NvbnZlcnRQb3NpdGlvblRvKCJyZWxhdGl2ZSIse3RvcDowLGxlZnQ6aC1zLmhlbHBlclByb3BvcnRpb25zLndpZHRofSkubGVmdCksciYmKGkucG9zaXRpb24ubGVmdD1zLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6MCxsZWZ0Omx9KS5sZWZ0KSkscD1ufHxvfHxhfHxyLCJvdXRlciIhPT1mLnNuYXBNb2RlJiYobj1nPj1NYXRoLmFicyhjLXYpLG89Zz49TWF0aC5hYnModS1iKSxhPWc+PU1hdGguYWJzKGgtbSkscj1nPj1NYXRoLmFicyhsLV8pLG4mJihpLnBvc2l0aW9uLnRvcD1zLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6YyxsZWZ0OjB9KS50b3ApLG8mJihpLnBvc2l0aW9uLnRvcD1zLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6dS1zLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxsZWZ0OjB9KS50b3ApLGEmJihpLnBvc2l0aW9uLmxlZnQ9cy5fY29udmVydFBvc2l0aW9uVG8oInJlbGF0aXZlIix7dG9wOjAsbGVmdDpofSkubGVmdCksciYmKGkucG9zaXRpb24ubGVmdD1zLl9jb252ZXJ0UG9zaXRpb25UbygicmVsYXRpdmUiLHt0b3A6MCxsZWZ0Omwtcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aH0pLmxlZnQpKSwhcy5zbmFwRWxlbWVudHNbZF0uc25hcHBpbmcmJihufHxvfHxhfHxyfHxwKSYmcy5vcHRpb25zLnNuYXAuc25hcCYmcy5vcHRpb25zLnNuYXAuc25hcC5jYWxsKHMuZWxlbWVudCxlLHQuZXh0ZW5kKHMuX3VpSGFzaCgpLHtzbmFwSXRlbTpzLnNuYXBFbGVtZW50c1tkXS5pdGVtfSkpLHMuc25hcEVsZW1lbnRzW2RdLnNuYXBwaW5nPW58fG98fGF8fHJ8fHApfX0pLHQudWkucGx1Z2luLmFkZCgiZHJhZ2dhYmxlIiwic3RhY2siLHtzdGFydDpmdW5jdGlvbihlLGkscyl7dmFyIG4sbz1zLm9wdGlvbnMsYT10Lm1ha2VBcnJheSh0KG8uc3RhY2spKS5zb3J0KGZ1bmN0aW9uKGUsaSl7cmV0dXJuKHBhcnNlSW50KHQoZSkuY3NzKCJ6SW5kZXgiKSwxMCl8fDApLShwYXJzZUludCh0KGkpLmNzcygiekluZGV4IiksMTApfHwwKX0pO2EubGVuZ3RoJiYobj1wYXJzZUludCh0KGFbMF0pLmNzcygiekluZGV4IiksMTApfHwwLHQoYSkuZWFjaChmdW5jdGlvbihlKXt0KHRoaXMpLmNzcygiekluZGV4IixuK2UpfSksdGhpcy5jc3MoInpJbmRleCIsbithLmxlbmd0aCkpfX0pLHQudWkucGx1Z2luLmFkZCgiZHJhZ2dhYmxlIiwiekluZGV4Iix7c3RhcnQ6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuPXQoaS5oZWxwZXIpLG89cy5vcHRpb25zO24uY3NzKCJ6SW5kZXgiKSYmKG8uX3pJbmRleD1uLmNzcygiekluZGV4IikpLG4uY3NzKCJ6SW5kZXgiLG8uekluZGV4KX0sc3RvcDpmdW5jdGlvbihlLGkscyl7dmFyIG49cy5vcHRpb25zO24uX3pJbmRleCYmdChpLmhlbHBlcikuY3NzKCJ6SW5kZXgiLG4uX3pJbmRleCl9fSksdC51aS5kcmFnZ2FibGUsdC53aWRnZXQoInVpLnJlc2l6YWJsZSIsdC51aS5tb3VzZSx7dmVyc2lvbjoiMS4xMi4xIix3aWRnZXRFdmVudFByZWZpeDoicmVzaXplIixvcHRpb25zOnthbHNvUmVzaXplOiExLGFuaW1hdGU6ITEsYW5pbWF0ZUR1cmF0aW9uOiJzbG93IixhbmltYXRlRWFzaW5nOiJzd2luZyIsYXNwZWN0UmF0aW86ITEsYXV0b0hpZGU6ITEsY2xhc3Nlczp7InVpLXJlc2l6YWJsZS1zZSI6InVpLWljb24gdWktaWNvbi1ncmlwc21hbGwtZGlhZ29uYWwtc2UifSxjb250YWlubWVudDohMSxnaG9zdDohMSxncmlkOiExLGhhbmRsZXM6ImUscyxzZSIsaGVscGVyOiExLG1heEhlaWdodDpudWxsLG1heFdpZHRoOm51bGwsbWluSGVpZ2h0OjEwLG1pbldpZHRoOjEwLHpJbmRleDo5MCxyZXNpemU6bnVsbCxzdGFydDpudWxsLHN0b3A6bnVsbH0sX251bTpmdW5jdGlvbih0KXtyZXR1cm4gcGFyc2VGbG9hdCh0KXx8MH0sX2lzTnVtYmVyOmZ1bmN0aW9uKHQpe3JldHVybiFpc05hTihwYXJzZUZsb2F0KHQpKX0sX2hhc1Njcm9sbDpmdW5jdGlvbihlLGkpe2lmKCJoaWRkZW4iPT09dChlKS5jc3MoIm92ZXJmbG93IikpcmV0dXJuITE7dmFyIHM9aSYmImxlZnQiPT09aT8ic2Nyb2xsTGVmdCI6InNjcm9sbFRvcCIsbj0hMTtyZXR1cm4gZVtzXT4wPyEwOihlW3NdPTEsbj1lW3NdPjAsZVtzXT0wLG4pfSxfY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIGUsaT10aGlzLm9wdGlvbnMscz10aGlzO3RoaXMuX2FkZENsYXNzKCJ1aS1yZXNpemFibGUiKSx0LmV4dGVuZCh0aGlzLHtfYXNwZWN0UmF0aW86ISFpLmFzcGVjdFJhdGlvLGFzcGVjdFJhdGlvOmkuYXNwZWN0UmF0aW8sb3JpZ2luYWxFbGVtZW50OnRoaXMuZWxlbWVudCxfcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50czpbXSxfaGVscGVyOmkuaGVscGVyfHxpLmdob3N0fHxpLmFuaW1hdGU/aS5oZWxwZXJ8fCJ1aS1yZXNpemFibGUtaGVscGVyIjpudWxsfSksdGhpcy5lbGVtZW50WzBdLm5vZGVOYW1lLm1hdGNoKC9eKGNhbnZhc3x0ZXh0YXJlYXxpbnB1dHxzZWxlY3R8YnV0dG9ufGltZykkL2kpJiYodGhpcy5lbGVtZW50LndyYXAodCgiPGRpdiBjbGFzcz0ndWktd3JhcHBlcicgc3R5bGU9J292ZXJmbG93OiBoaWRkZW47Jz48L2Rpdj4iKS5jc3Moe3Bvc2l0aW9uOnRoaXMuZWxlbWVudC5jc3MoInBvc2l0aW9uIiksd2lkdGg6dGhpcy5lbGVtZW50Lm91dGVyV2lkdGgoKSxoZWlnaHQ6dGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCksdG9wOnRoaXMuZWxlbWVudC5jc3MoInRvcCIpLGxlZnQ6dGhpcy5lbGVtZW50LmNzcygibGVmdCIpfSkpLHRoaXMuZWxlbWVudD10aGlzLmVsZW1lbnQucGFyZW50KCkuZGF0YSgidWktcmVzaXphYmxlIix0aGlzLmVsZW1lbnQucmVzaXphYmxlKCJpbnN0YW5jZSIpKSx0aGlzLmVsZW1lbnRJc1dyYXBwZXI9ITAsZT17bWFyZ2luVG9wOnRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygibWFyZ2luVG9wIiksbWFyZ2luUmlnaHQ6dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJtYXJnaW5SaWdodCIpLG1hcmdpbkJvdHRvbTp0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoIm1hcmdpbkJvdHRvbSIpLG1hcmdpbkxlZnQ6dGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJtYXJnaW5MZWZ0Iil9LHRoaXMuZWxlbWVudC5jc3MoZSksdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJtYXJnaW4iLDApLHRoaXMub3JpZ2luYWxSZXNpemVTdHlsZT10aGlzLm9yaWdpbmFsRWxlbWVudC5jc3MoInJlc2l6ZSIpLHRoaXMub3JpZ2luYWxFbGVtZW50LmNzcygicmVzaXplIiwibm9uZSIpLHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHMucHVzaCh0aGlzLm9yaWdpbmFsRWxlbWVudC5jc3Moe3Bvc2l0aW9uOiJzdGF0aWMiLHpvb206MSxkaXNwbGF5OiJibG9jayJ9KSksdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKGUpLHRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplKCkpLHRoaXMuX3NldHVwSGFuZGxlcygpLGkuYXV0b0hpZGUmJnQodGhpcy5lbGVtZW50KS5vbigibW91c2VlbnRlciIsZnVuY3Rpb24oKXtpLmRpc2FibGVkfHwocy5fcmVtb3ZlQ2xhc3MoInVpLXJlc2l6YWJsZS1hdXRvaGlkZSIpLHMuX2hhbmRsZXMuc2hvdygpKX0pLm9uKCJtb3VzZWxlYXZlIixmdW5jdGlvbigpe2kuZGlzYWJsZWR8fHMucmVzaXppbmd8fChzLl9hZGRDbGFzcygidWktcmVzaXphYmxlLWF1dG9oaWRlIikscy5faGFuZGxlcy5oaWRlKCkpfSksdGhpcy5fbW91c2VJbml0KCl9LF9kZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5fbW91c2VEZXN0cm95KCk7dmFyIGUsaT1mdW5jdGlvbihlKXt0KGUpLnJlbW92ZURhdGEoInJlc2l6YWJsZSIpLnJlbW92ZURhdGEoInVpLXJlc2l6YWJsZSIpLm9mZigiLnJlc2l6YWJsZSIpLmZpbmQoIi51aS1yZXNpemFibGUtaGFuZGxlIikucmVtb3ZlKCl9O3JldHVybiB0aGlzLmVsZW1lbnRJc1dyYXBwZXImJihpKHRoaXMuZWxlbWVudCksZT10aGlzLmVsZW1lbnQsdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKHtwb3NpdGlvbjplLmNzcygicG9zaXRpb24iKSx3aWR0aDplLm91dGVyV2lkdGgoKSxoZWlnaHQ6ZS5vdXRlckhlaWdodCgpLHRvcDplLmNzcygidG9wIiksbGVmdDplLmNzcygibGVmdCIpfSkuaW5zZXJ0QWZ0ZXIoZSksZS5yZW1vdmUoKSksdGhpcy5vcmlnaW5hbEVsZW1lbnQuY3NzKCJyZXNpemUiLHRoaXMub3JpZ2luYWxSZXNpemVTdHlsZSksaSh0aGlzLm9yaWdpbmFsRWxlbWVudCksdGhpc30sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3N3aXRjaCh0aGlzLl9zdXBlcih0LGUpLHQpe2Nhc2UiaGFuZGxlcyI6dGhpcy5fcmVtb3ZlSGFuZGxlcygpLHRoaXMuX3NldHVwSGFuZGxlcygpO2JyZWFrO2RlZmF1bHQ6fX0sX3NldHVwSGFuZGxlczpmdW5jdGlvbigpe3ZhciBlLGkscyxuLG8sYT10aGlzLm9wdGlvbnMscj10aGlzO2lmKHRoaXMuaGFuZGxlcz1hLmhhbmRsZXN8fCh0KCIudWktcmVzaXphYmxlLWhhbmRsZSIsdGhpcy5lbGVtZW50KS5sZW5ndGg/e246Ii51aS1yZXNpemFibGUtbiIsZToiLnVpLXJlc2l6YWJsZS1lIixzOiIudWktcmVzaXphYmxlLXMiLHc6Ii51aS1yZXNpemFibGUtdyIsc2U6Ii51aS1yZXNpemFibGUtc2UiLHN3OiIudWktcmVzaXphYmxlLXN3IixuZToiLnVpLXJlc2l6YWJsZS1uZSIsbnc6Ii51aS1yZXNpemFibGUtbncifToiZSxzLHNlIiksdGhpcy5faGFuZGxlcz10KCksdGhpcy5oYW5kbGVzLmNvbnN0cnVjdG9yPT09U3RyaW5nKWZvcigiYWxsIj09PXRoaXMuaGFuZGxlcyYmKHRoaXMuaGFuZGxlcz0ibixlLHMsdyxzZSxzdyxuZSxudyIpLHM9dGhpcy5oYW5kbGVzLnNwbGl0KCIsIiksdGhpcy5oYW5kbGVzPXt9LGk9MDtzLmxlbmd0aD5pO2krKyllPXQudHJpbShzW2ldKSxuPSJ1aS1yZXNpemFibGUtIitlLG89dCgiPGRpdj4iKSx0aGlzLl9hZGRDbGFzcyhvLCJ1aS1yZXNpemFibGUtaGFuZGxlICIrbiksby5jc3Moe3pJbmRleDphLnpJbmRleH0pLHRoaXMuaGFuZGxlc1tlXT0iLnVpLXJlc2l6YWJsZS0iK2UsdGhpcy5lbGVtZW50LmFwcGVuZChvKTt0aGlzLl9yZW5kZXJBeGlzPWZ1bmN0aW9uKGUpe3ZhciBpLHMsbixvO2U9ZXx8dGhpcy5lbGVtZW50O2ZvcihpIGluIHRoaXMuaGFuZGxlcyl0aGlzLmhhbmRsZXNbaV0uY29uc3RydWN0b3I9PT1TdHJpbmc/dGhpcy5oYW5kbGVzW2ldPXRoaXMuZWxlbWVudC5jaGlsZHJlbih0aGlzLmhhbmRsZXNbaV0pLmZpcnN0KCkuc2hvdygpOih0aGlzLmhhbmRsZXNbaV0uanF1ZXJ5fHx0aGlzLmhhbmRsZXNbaV0ubm9kZVR5cGUpJiYodGhpcy5oYW5kbGVzW2ldPXQodGhpcy5oYW5kbGVzW2ldKSx0aGlzLl9vbih0aGlzLmhhbmRsZXNbaV0se21vdXNlZG93bjpyLl9tb3VzZURvd259KSksdGhpcy5lbGVtZW50SXNXcmFwcGVyJiZ0aGlzLm9yaWdpbmFsRWxlbWVudFswXS5ub2RlTmFtZS5tYXRjaCgvXih0ZXh0YXJlYXxpbnB1dHxzZWxlY3R8YnV0dG9uKSQvaSkmJihzPXQodGhpcy5oYW5kbGVzW2ldLHRoaXMuZWxlbWVudCksbz0vc3d8bmV8bnd8c2V8bnxzLy50ZXN0KGkpP3Mub3V0ZXJIZWlnaHQoKTpzLm91dGVyV2lkdGgoKSxuPVsicGFkZGluZyIsL25lfG53fG4vLnRlc3QoaSk/IlRvcCI6L3NlfHN3fHMvLnRlc3QoaSk/IkJvdHRvbSI6L15lJC8udGVzdChpKT8iUmlnaHQiOiJMZWZ0Il0uam9pbigiIiksZS5jc3MobixvKSx0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpKSx0aGlzLl9oYW5kbGVzPXRoaXMuX2hhbmRsZXMuYWRkKHRoaXMuaGFuZGxlc1tpXSl9LHRoaXMuX3JlbmRlckF4aXModGhpcy5lbGVtZW50KSx0aGlzLl9oYW5kbGVzPXRoaXMuX2hhbmRsZXMuYWRkKHRoaXMuZWxlbWVudC5maW5kKCIudWktcmVzaXphYmxlLWhhbmRsZSIpKSx0aGlzLl9oYW5kbGVzLmRpc2FibGVTZWxlY3Rpb24oKSx0aGlzLl9oYW5kbGVzLm9uKCJtb3VzZW92ZXIiLGZ1bmN0aW9uKCl7ci5yZXNpemluZ3x8KHRoaXMuY2xhc3NOYW1lJiYobz10aGlzLmNsYXNzTmFtZS5tYXRjaCgvdWktcmVzaXphYmxlLShzZXxzd3xuZXxud3xufGV8c3x3KS9pKSksci5heGlzPW8mJm9bMV0/b1sxXToic2UiKX0pLGEuYXV0b0hpZGUmJih0aGlzLl9oYW5kbGVzLmhpZGUoKSx0aGlzLl9hZGRDbGFzcygidWktcmVzaXphYmxlLWF1dG9oaWRlIikpfSxfcmVtb3ZlSGFuZGxlczpmdW5jdGlvbigpe3RoaXMuX2hhbmRsZXMucmVtb3ZlKCl9LF9tb3VzZUNhcHR1cmU6ZnVuY3Rpb24oZSl7dmFyIGkscyxuPSExO2ZvcihpIGluIHRoaXMuaGFuZGxlcylzPXQodGhpcy5oYW5kbGVzW2ldKVswXSwocz09PWUudGFyZ2V0fHx0LmNvbnRhaW5zKHMsZS50YXJnZXQpKSYmKG49ITApO3JldHVybiF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJm59LF9tb3VzZVN0YXJ0OmZ1bmN0aW9uKGUpe3ZhciBpLHMsbixvPXRoaXMub3B0aW9ucyxhPXRoaXMuZWxlbWVudDtyZXR1cm4gdGhpcy5yZXNpemluZz0hMCx0aGlzLl9yZW5kZXJQcm94eSgpLGk9dGhpcy5fbnVtKHRoaXMuaGVscGVyLmNzcygibGVmdCIpKSxzPXRoaXMuX251bSh0aGlzLmhlbHBlci5jc3MoInRvcCIpKSxvLmNvbnRhaW5tZW50JiYoaSs9dChvLmNvbnRhaW5tZW50KS5zY3JvbGxMZWZ0KCl8fDAscys9dChvLmNvbnRhaW5tZW50KS5zY3JvbGxUb3AoKXx8MCksdGhpcy5vZmZzZXQ9dGhpcy5oZWxwZXIub2Zmc2V0KCksdGhpcy5wb3NpdGlvbj17bGVmdDppLHRvcDpzfSx0aGlzLnNpemU9dGhpcy5faGVscGVyP3t3aWR0aDp0aGlzLmhlbHBlci53aWR0aCgpLGhlaWdodDp0aGlzLmhlbHBlci5oZWlnaHQoKX06e3dpZHRoOmEud2lkdGgoKSxoZWlnaHQ6YS5oZWlnaHQoKX0sdGhpcy5vcmlnaW5hbFNpemU9dGhpcy5faGVscGVyP3t3aWR0aDphLm91dGVyV2lkdGgoKSxoZWlnaHQ6YS5vdXRlckhlaWdodCgpfTp7d2lkdGg6YS53aWR0aCgpLGhlaWdodDphLmhlaWdodCgpfSx0aGlzLnNpemVEaWZmPXt3aWR0aDphLm91dGVyV2lkdGgoKS1hLndpZHRoKCksaGVpZ2h0OmEub3V0ZXJIZWlnaHQoKS1hLmhlaWdodCgpfSx0aGlzLm9yaWdpbmFsUG9zaXRpb249e2xlZnQ6aSx0b3A6c30sdGhpcy5vcmlnaW5hbE1vdXNlUG9zaXRpb249e2xlZnQ6ZS5wYWdlWCx0b3A6ZS5wYWdlWX0sdGhpcy5hc3BlY3RSYXRpbz0ibnVtYmVyIj09dHlwZW9mIG8uYXNwZWN0UmF0aW8/by5hc3BlY3RSYXRpbzp0aGlzLm9yaWdpbmFsU2l6ZS53aWR0aC90aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHR8fDEsbj10KCIudWktcmVzaXphYmxlLSIrdGhpcy5heGlzKS5jc3MoImN1cnNvciIpLHQoImJvZHkiKS5jc3MoImN1cnNvciIsImF1dG8iPT09bj90aGlzLmF4aXMrIi1yZXNpemUiOm4pLHRoaXMuX2FkZENsYXNzKCJ1aS1yZXNpemFibGUtcmVzaXppbmciKSx0aGlzLl9wcm9wYWdhdGUoInN0YXJ0IixlKSwhMH0sX21vdXNlRHJhZzpmdW5jdGlvbihlKXt2YXIgaSxzLG49dGhpcy5vcmlnaW5hbE1vdXNlUG9zaXRpb24sbz10aGlzLmF4aXMsYT1lLnBhZ2VYLW4ubGVmdHx8MCxyPWUucGFnZVktbi50b3B8fDAsaD10aGlzLl9jaGFuZ2Vbb107cmV0dXJuIHRoaXMuX3VwZGF0ZVByZXZQcm9wZXJ0aWVzKCksaD8oaT1oLmFwcGx5KHRoaXMsW2UsYSxyXSksdGhpcy5fdXBkYXRlVmlydHVhbEJvdW5kYXJpZXMoZS5zaGlmdEtleSksKHRoaXMuX2FzcGVjdFJhdGlvfHxlLnNoaWZ0S2V5KSYmKGk9dGhpcy5fdXBkYXRlUmF0aW8oaSxlKSksaT10aGlzLl9yZXNwZWN0U2l6ZShpLGUpLHRoaXMuX3VwZGF0ZUNhY2hlKGkpLHRoaXMuX3Byb3BhZ2F0ZSgicmVzaXplIixlKSxzPXRoaXMuX2FwcGx5Q2hhbmdlcygpLCF0aGlzLl9oZWxwZXImJnRoaXMuX3Byb3BvcnRpb25hbGx5UmVzaXplRWxlbWVudHMubGVuZ3RoJiZ0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpLHQuaXNFbXB0eU9iamVjdChzKXx8KHRoaXMuX3VwZGF0ZVByZXZQcm9wZXJ0aWVzKCksdGhpcy5fdHJpZ2dlcigicmVzaXplIixlLHRoaXMudWkoKSksdGhpcy5fYXBwbHlDaGFuZ2VzKCkpLCExKTohMX0sX21vdXNlU3RvcDpmdW5jdGlvbihlKXt0aGlzLnJlc2l6aW5nPSExO3ZhciBpLHMsbixvLGEscixoLGw9dGhpcy5vcHRpb25zLGM9dGhpcztyZXR1cm4gdGhpcy5faGVscGVyJiYoaT10aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzLHM9aS5sZW5ndGgmJi90ZXh0YXJlYS9pLnRlc3QoaVswXS5ub2RlTmFtZSksbj1zJiZ0aGlzLl9oYXNTY3JvbGwoaVswXSwibGVmdCIpPzA6Yy5zaXplRGlmZi5oZWlnaHQsbz1zPzA6Yy5zaXplRGlmZi53aWR0aCxhPXt3aWR0aDpjLmhlbHBlci53aWR0aCgpLW8saGVpZ2h0OmMuaGVscGVyLmhlaWdodCgpLW59LHI9cGFyc2VGbG9hdChjLmVsZW1lbnQuY3NzKCJsZWZ0IikpKyhjLnBvc2l0aW9uLmxlZnQtYy5vcmlnaW5hbFBvc2l0aW9uLmxlZnQpfHxudWxsLGg9cGFyc2VGbG9hdChjLmVsZW1lbnQuY3NzKCJ0b3AiKSkrKGMucG9zaXRpb24udG9wLWMub3JpZ2luYWxQb3NpdGlvbi50b3ApfHxudWxsLGwuYW5pbWF0ZXx8dGhpcy5lbGVtZW50LmNzcyh0LmV4dGVuZChhLHt0b3A6aCxsZWZ0OnJ9KSksYy5oZWxwZXIuaGVpZ2h0KGMuc2l6ZS5oZWlnaHQpLGMuaGVscGVyLndpZHRoKGMuc2l6ZS53aWR0aCksdGhpcy5faGVscGVyJiYhbC5hbmltYXRlJiZ0aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZSgpKSx0KCJib2R5IikuY3NzKCJjdXJzb3IiLCJhdXRvIiksdGhpcy5fcmVtb3ZlQ2xhc3MoInVpLXJlc2l6YWJsZS1yZXNpemluZyIpLHRoaXMuX3Byb3BhZ2F0ZSgic3RvcCIsZSksdGhpcy5faGVscGVyJiZ0aGlzLmhlbHBlci5yZW1vdmUoKSwhMX0sX3VwZGF0ZVByZXZQcm9wZXJ0aWVzOmZ1bmN0aW9uKCl7dGhpcy5wcmV2UG9zaXRpb249e3RvcDp0aGlzLnBvc2l0aW9uLnRvcCxsZWZ0OnRoaXMucG9zaXRpb24ubGVmdH0sdGhpcy5wcmV2U2l6ZT17d2lkdGg6dGhpcy5zaXplLndpZHRoLGhlaWdodDp0aGlzLnNpemUuaGVpZ2h0fX0sX2FwcGx5Q2hhbmdlczpmdW5jdGlvbigpe3ZhciB0PXt9O3JldHVybiB0aGlzLnBvc2l0aW9uLnRvcCE9PXRoaXMucHJldlBvc2l0aW9uLnRvcCYmKHQudG9wPXRoaXMucG9zaXRpb24udG9wKyJweCIpLHRoaXMucG9zaXRpb24ubGVmdCE9PXRoaXMucHJldlBvc2l0aW9uLmxlZnQmJih0LmxlZnQ9dGhpcy5wb3NpdGlvbi5sZWZ0KyJweCIpLHRoaXMuc2l6ZS53aWR0aCE9PXRoaXMucHJldlNpemUud2lkdGgmJih0LndpZHRoPXRoaXMuc2l6ZS53aWR0aCsicHgiKSx0aGlzLnNpemUuaGVpZ2h0IT09dGhpcy5wcmV2U2l6ZS5oZWlnaHQmJih0LmhlaWdodD10aGlzLnNpemUuaGVpZ2h0KyJweCIpLHRoaXMuaGVscGVyLmNzcyh0KSx0fSxfdXBkYXRlVmlydHVhbEJvdW5kYXJpZXM6ZnVuY3Rpb24odCl7dmFyIGUsaSxzLG4sbyxhPXRoaXMub3B0aW9ucztvPXttaW5XaWR0aDp0aGlzLl9pc051bWJlcihhLm1pbldpZHRoKT9hLm1pbldpZHRoOjAsbWF4V2lkdGg6dGhpcy5faXNOdW1iZXIoYS5tYXhXaWR0aCk/YS5tYXhXaWR0aDoxLzAsbWluSGVpZ2h0OnRoaXMuX2lzTnVtYmVyKGEubWluSGVpZ2h0KT9hLm1pbkhlaWdodDowLG1heEhlaWdodDp0aGlzLl9pc051bWJlcihhLm1heEhlaWdodCk/YS5tYXhIZWlnaHQ6MS8wfSwodGhpcy5fYXNwZWN0UmF0aW98fHQpJiYoZT1vLm1pbkhlaWdodCp0aGlzLmFzcGVjdFJhdGlvLHM9by5taW5XaWR0aC90aGlzLmFzcGVjdFJhdGlvLGk9by5tYXhIZWlnaHQqdGhpcy5hc3BlY3RSYXRpbyxuPW8ubWF4V2lkdGgvdGhpcy5hc3BlY3RSYXRpbyxlPm8ubWluV2lkdGgmJihvLm1pbldpZHRoPWUpLHM+by5taW5IZWlnaHQmJihvLm1pbkhlaWdodD1zKSxvLm1heFdpZHRoPmkmJihvLm1heFdpZHRoPWkpLG8ubWF4SGVpZ2h0Pm4mJihvLm1heEhlaWdodD1uKSksdGhpcy5fdkJvdW5kYXJpZXM9b30sX3VwZGF0ZUNhY2hlOmZ1bmN0aW9uKHQpe3RoaXMub2Zmc2V0PXRoaXMuaGVscGVyLm9mZnNldCgpLHRoaXMuX2lzTnVtYmVyKHQubGVmdCkmJih0aGlzLnBvc2l0aW9uLmxlZnQ9dC5sZWZ0KSx0aGlzLl9pc051bWJlcih0LnRvcCkmJih0aGlzLnBvc2l0aW9uLnRvcD10LnRvcCksdGhpcy5faXNOdW1iZXIodC5oZWlnaHQpJiYodGhpcy5zaXplLmhlaWdodD10LmhlaWdodCksdGhpcy5faXNOdW1iZXIodC53aWR0aCkmJih0aGlzLnNpemUud2lkdGg9dC53aWR0aCl9LF91cGRhdGVSYXRpbzpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnBvc2l0aW9uLGk9dGhpcy5zaXplLHM9dGhpcy5heGlzO3JldHVybiB0aGlzLl9pc051bWJlcih0LmhlaWdodCk/dC53aWR0aD10LmhlaWdodCp0aGlzLmFzcGVjdFJhdGlvOnRoaXMuX2lzTnVtYmVyKHQud2lkdGgpJiYodC5oZWlnaHQ9dC53aWR0aC90aGlzLmFzcGVjdFJhdGlvKSwic3ciPT09cyYmKHQubGVmdD1lLmxlZnQrKGkud2lkdGgtdC53aWR0aCksdC50b3A9bnVsbCksIm53Ij09PXMmJih0LnRvcD1lLnRvcCsoaS5oZWlnaHQtdC5oZWlnaHQpLHQubGVmdD1lLmxlZnQrKGkud2lkdGgtdC53aWR0aCkpLHR9LF9yZXNwZWN0U2l6ZTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLl92Qm91bmRhcmllcyxpPXRoaXMuYXhpcyxzPXRoaXMuX2lzTnVtYmVyKHQud2lkdGgpJiZlLm1heFdpZHRoJiZlLm1heFdpZHRoPHQud2lkdGgsbj10aGlzLl9pc051bWJlcih0LmhlaWdodCkmJmUubWF4SGVpZ2h0JiZlLm1heEhlaWdodDx0LmhlaWdodCxvPXRoaXMuX2lzTnVtYmVyKHQud2lkdGgpJiZlLm1pbldpZHRoJiZlLm1pbldpZHRoPnQud2lkdGgsYT10aGlzLl9pc051bWJlcih0LmhlaWdodCkmJmUubWluSGVpZ2h0JiZlLm1pbkhlaWdodD50LmhlaWdodCxyPXRoaXMub3JpZ2luYWxQb3NpdGlvbi5sZWZ0K3RoaXMub3JpZ2luYWxTaXplLndpZHRoLGg9dGhpcy5vcmlnaW5hbFBvc2l0aW9uLnRvcCt0aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHQsbD0vc3d8bnd8dy8udGVzdChpKSxjPS9ud3xuZXxuLy50ZXN0KGkpO3JldHVybiBvJiYodC53aWR0aD1lLm1pbldpZHRoKSxhJiYodC5oZWlnaHQ9ZS5taW5IZWlnaHQpLHMmJih0LndpZHRoPWUubWF4V2lkdGgpLG4mJih0LmhlaWdodD1lLm1heEhlaWdodCksbyYmbCYmKHQubGVmdD1yLWUubWluV2lkdGgpLHMmJmwmJih0LmxlZnQ9ci1lLm1heFdpZHRoKSxhJiZjJiYodC50b3A9aC1lLm1pbkhlaWdodCksbiYmYyYmKHQudG9wPWgtZS5tYXhIZWlnaHQpLHQud2lkdGh8fHQuaGVpZ2h0fHx0LmxlZnR8fCF0LnRvcD90LndpZHRofHx0LmhlaWdodHx8dC50b3B8fCF0LmxlZnR8fCh0LmxlZnQ9bnVsbCk6dC50b3A9bnVsbCx0fSxfZ2V0UGFkZGluZ1BsdXNCb3JkZXJEaW1lbnNpb25zOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZT0wLGk9W10scz1bdC5jc3MoImJvcmRlclRvcFdpZHRoIiksdC5jc3MoImJvcmRlclJpZ2h0V2lkdGgiKSx0LmNzcygiYm9yZGVyQm90dG9tV2lkdGgiKSx0LmNzcygiYm9yZGVyTGVmdFdpZHRoIildLG49W3QuY3NzKCJwYWRkaW5nVG9wIiksdC5jc3MoInBhZGRpbmdSaWdodCIpLHQuY3NzKCJwYWRkaW5nQm90dG9tIiksdC5jc3MoInBhZGRpbmdMZWZ0IildOzQ+ZTtlKyspaVtlXT1wYXJzZUZsb2F0KHNbZV0pfHwwLGlbZV0rPXBhcnNlRmxvYXQobltlXSl8fDA7cmV0dXJue2hlaWdodDppWzBdK2lbMl0sd2lkdGg6aVsxXStpWzNdfX0sX3Byb3BvcnRpb25hbGx5UmVzaXplOmZ1bmN0aW9uKCl7aWYodGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGgpZm9yKHZhciB0LGU9MCxpPXRoaXMuaGVscGVyfHx0aGlzLmVsZW1lbnQ7dGhpcy5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cy5sZW5ndGg+ZTtlKyspdD10aGlzLl9wcm9wb3J0aW9uYWxseVJlc2l6ZUVsZW1lbnRzW2VdLHRoaXMub3V0ZXJEaW1lbnNpb25zfHwodGhpcy5vdXRlckRpbWVuc2lvbnM9dGhpcy5fZ2V0UGFkZGluZ1BsdXNCb3JkZXJEaW1lbnNpb25zKHQpKSx0LmNzcyh7aGVpZ2h0OmkuaGVpZ2h0KCktdGhpcy5vdXRlckRpbWVuc2lvbnMuaGVpZ2h0fHwwLHdpZHRoOmkud2lkdGgoKS10aGlzLm91dGVyRGltZW5zaW9ucy53aWR0aHx8MH0pfSxfcmVuZGVyUHJveHk6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmVsZW1lbnQsaT10aGlzLm9wdGlvbnM7dGhpcy5lbGVtZW50T2Zmc2V0PWUub2Zmc2V0KCksdGhpcy5faGVscGVyPyh0aGlzLmhlbHBlcj10aGlzLmhlbHBlcnx8dCgiPGRpdiBzdHlsZT0nb3ZlcmZsb3c6aGlkZGVuOyc+PC9kaXY+IiksdGhpcy5fYWRkQ2xhc3ModGhpcy5oZWxwZXIsdGhpcy5faGVscGVyKSx0aGlzLmhlbHBlci5jc3Moe3dpZHRoOnRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpLHBvc2l0aW9uOiJhYnNvbHV0ZSIsbGVmdDp0aGlzLmVsZW1lbnRPZmZzZXQubGVmdCsicHgiLHRvcDp0aGlzLmVsZW1lbnRPZmZzZXQudG9wKyJweCIsekluZGV4OisraS56SW5kZXh9KSx0aGlzLmhlbHBlci5hcHBlbmRUbygiYm9keSIpLmRpc2FibGVTZWxlY3Rpb24oKSk6dGhpcy5oZWxwZXI9dGhpcy5lbGVtZW50fSxfY2hhbmdlOntlOmZ1bmN0aW9uKHQsZSl7cmV0dXJue3dpZHRoOnRoaXMub3JpZ2luYWxTaXplLndpZHRoK2V9fSx3OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5vcmlnaW5hbFNpemUscz10aGlzLm9yaWdpbmFsUG9zaXRpb247cmV0dXJue2xlZnQ6cy5sZWZ0K2Usd2lkdGg6aS53aWR0aC1lfX0sbjpmdW5jdGlvbih0LGUsaSl7dmFyIHM9dGhpcy5vcmlnaW5hbFNpemUsbj10aGlzLm9yaWdpbmFsUG9zaXRpb247cmV0dXJue3RvcDpuLnRvcCtpLGhlaWdodDpzLmhlaWdodC1pfX0sczpmdW5jdGlvbih0LGUsaSl7cmV0dXJue2hlaWdodDp0aGlzLm9yaWdpbmFsU2l6ZS5oZWlnaHQraX19LHNlOmZ1bmN0aW9uKGUsaSxzKXtyZXR1cm4gdC5leHRlbmQodGhpcy5fY2hhbmdlLnMuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2NoYW5nZS5lLmFwcGx5KHRoaXMsW2UsaSxzXSkpfSxzdzpmdW5jdGlvbihlLGkscyl7cmV0dXJuIHQuZXh0ZW5kKHRoaXMuX2NoYW5nZS5zLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLl9jaGFuZ2Uudy5hcHBseSh0aGlzLFtlLGksc10pKX0sbmU6ZnVuY3Rpb24oZSxpLHMpe3JldHVybiB0LmV4dGVuZCh0aGlzLl9jaGFuZ2Uubi5hcHBseSh0aGlzLGFyZ3VtZW50cyksdGhpcy5fY2hhbmdlLmUuYXBwbHkodGhpcyxbZSxpLHNdKSl9LG53OmZ1bmN0aW9uKGUsaSxzKXtyZXR1cm4gdC5leHRlbmQodGhpcy5fY2hhbmdlLm4uYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX2NoYW5nZS53LmFwcGx5KHRoaXMsW2UsaSxzXSkpfX0sX3Byb3BhZ2F0ZTpmdW5jdGlvbihlLGkpe3QudWkucGx1Z2luLmNhbGwodGhpcyxlLFtpLHRoaXMudWkoKV0pLCJyZXNpemUiIT09ZSYmdGhpcy5fdHJpZ2dlcihlLGksdGhpcy51aSgpKX0scGx1Z2luczp7fSx1aTpmdW5jdGlvbigpe3JldHVybntvcmlnaW5hbEVsZW1lbnQ6dGhpcy5vcmlnaW5hbEVsZW1lbnQsZWxlbWVudDp0aGlzLmVsZW1lbnQsaGVscGVyOnRoaXMuaGVscGVyLHBvc2l0aW9uOnRoaXMucG9zaXRpb24sc2l6ZTp0aGlzLnNpemUsb3JpZ2luYWxTaXplOnRoaXMub3JpZ2luYWxTaXplLG9yaWdpbmFsUG9zaXRpb246dGhpcy5vcmlnaW5hbFBvc2l0aW9ufX19KSx0LnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImFuaW1hdGUiLHtzdG9wOmZ1bmN0aW9uKGUpe3ZhciBpPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLHM9aS5vcHRpb25zLG49aS5fcHJvcG9ydGlvbmFsbHlSZXNpemVFbGVtZW50cyxvPW4ubGVuZ3RoJiYvdGV4dGFyZWEvaS50ZXN0KG5bMF0ubm9kZU5hbWUpLGE9byYmaS5faGFzU2Nyb2xsKG5bMF0sImxlZnQiKT8wOmkuc2l6ZURpZmYuaGVpZ2h0LHI9bz8wOmkuc2l6ZURpZmYud2lkdGgsaD17d2lkdGg6aS5zaXplLndpZHRoLXIsaGVpZ2h0Omkuc2l6ZS5oZWlnaHQtYX0sbD1wYXJzZUZsb2F0KGkuZWxlbWVudC5jc3MoImxlZnQiKSkrKGkucG9zaXRpb24ubGVmdC1pLm9yaWdpbmFsUG9zaXRpb24ubGVmdCl8fG51bGwsYz1wYXJzZUZsb2F0KGkuZWxlbWVudC5jc3MoInRvcCIpKSsoaS5wb3NpdGlvbi50b3AtaS5vcmlnaW5hbFBvc2l0aW9uLnRvcCl8fG51bGw7aS5lbGVtZW50LmFuaW1hdGUodC5leHRlbmQoaCxjJiZsP3t0b3A6YyxsZWZ0Omx9Ont9KSx7ZHVyYXRpb246cy5hbmltYXRlRHVyYXRpb24sZWFzaW5nOnMuYW5pbWF0ZUVhc2luZyxzdGVwOmZ1bmN0aW9uKCl7dmFyIHM9e3dpZHRoOnBhcnNlRmxvYXQoaS5lbGVtZW50LmNzcygid2lkdGgiKSksaGVpZ2h0OnBhcnNlRmxvYXQoaS5lbGVtZW50LmNzcygiaGVpZ2h0IikpLHRvcDpwYXJzZUZsb2F0KGkuZWxlbWVudC5jc3MoInRvcCIpKSxsZWZ0OnBhcnNlRmxvYXQoaS5lbGVtZW50LmNzcygibGVmdCIpKX07biYmbi5sZW5ndGgmJnQoblswXSkuY3NzKHt3aWR0aDpzLndpZHRoLGhlaWdodDpzLmhlaWdodH0pLGkuX3VwZGF0ZUNhY2hlKHMpLGkuX3Byb3BhZ2F0ZSgicmVzaXplIixlKX19KX19KSx0LnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImNvbnRhaW5tZW50Iix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgZSxpLHMsbixvLGEscixoPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLGw9aC5vcHRpb25zLGM9aC5lbGVtZW50LHU9bC5jb250YWlubWVudCxkPXUgaW5zdGFuY2VvZiB0P3UuZ2V0KDApOi9wYXJlbnQvLnRlc3QodSk/Yy5wYXJlbnQoKS5nZXQoMCk6dTtkJiYoaC5jb250YWluZXJFbGVtZW50PXQoZCksL2RvY3VtZW50Ly50ZXN0KHUpfHx1PT09ZG9jdW1lbnQ/KGguY29udGFpbmVyT2Zmc2V0PXtsZWZ0OjAsdG9wOjB9LGguY29udGFpbmVyUG9zaXRpb249e2xlZnQ6MCx0b3A6MH0saC5wYXJlbnREYXRhPXtlbGVtZW50OnQoZG9jdW1lbnQpLGxlZnQ6MCx0b3A6MCx3aWR0aDp0KGRvY3VtZW50KS53aWR0aCgpLGhlaWdodDp0KGRvY3VtZW50KS5oZWlnaHQoKXx8ZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodH0pOihlPXQoZCksaT1bXSx0KFsiVG9wIiwiUmlnaHQiLCJMZWZ0IiwiQm90dG9tIl0pLmVhY2goZnVuY3Rpb24odCxzKXtpW3RdPWguX251bShlLmNzcygicGFkZGluZyIrcykpfSksaC5jb250YWluZXJPZmZzZXQ9ZS5vZmZzZXQoKSxoLmNvbnRhaW5lclBvc2l0aW9uPWUucG9zaXRpb24oKSxoLmNvbnRhaW5lclNpemU9e2hlaWdodDplLmlubmVySGVpZ2h0KCktaVszXSx3aWR0aDplLmlubmVyV2lkdGgoKS1pWzFdfSxzPWguY29udGFpbmVyT2Zmc2V0LG49aC5jb250YWluZXJTaXplLmhlaWdodCxvPWguY29udGFpbmVyU2l6ZS53aWR0aCxhPWguX2hhc1Njcm9sbChkLCJsZWZ0Iik/ZC5zY3JvbGxXaWR0aDpvLHI9aC5faGFzU2Nyb2xsKGQpP2Quc2Nyb2xsSGVpZ2h0Om4saC5wYXJlbnREYXRhPXtlbGVtZW50OmQsbGVmdDpzLmxlZnQsdG9wOnMudG9wLHdpZHRoOmEsaGVpZ2h0OnJ9KSl9LHJlc2l6ZTpmdW5jdGlvbihlKXt2YXIgaSxzLG4sbyxhPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLHI9YS5vcHRpb25zLGg9YS5jb250YWluZXJPZmZzZXQsbD1hLnBvc2l0aW9uLGM9YS5fYXNwZWN0UmF0aW98fGUuc2hpZnRLZXksdT17dG9wOjAsbGVmdDowfSxkPWEuY29udGFpbmVyRWxlbWVudCxwPSEwO2RbMF0hPT1kb2N1bWVudCYmL3N0YXRpYy8udGVzdChkLmNzcygicG9zaXRpb24iKSkmJih1PWgpLGwubGVmdDwoYS5faGVscGVyP2gubGVmdDowKSYmKGEuc2l6ZS53aWR0aD1hLnNpemUud2lkdGgrKGEuX2hlbHBlcj9hLnBvc2l0aW9uLmxlZnQtaC5sZWZ0OmEucG9zaXRpb24ubGVmdC11LmxlZnQpLGMmJihhLnNpemUuaGVpZ2h0PWEuc2l6ZS53aWR0aC9hLmFzcGVjdFJhdGlvLHA9ITEpLGEucG9zaXRpb24ubGVmdD1yLmhlbHBlcj9oLmxlZnQ6MCksbC50b3A8KGEuX2hlbHBlcj9oLnRvcDowKSYmKGEuc2l6ZS5oZWlnaHQ9YS5zaXplLmhlaWdodCsoYS5faGVscGVyP2EucG9zaXRpb24udG9wLWgudG9wOmEucG9zaXRpb24udG9wKSxjJiYoYS5zaXplLndpZHRoPWEuc2l6ZS5oZWlnaHQqYS5hc3BlY3RSYXRpbyxwPSExKSxhLnBvc2l0aW9uLnRvcD1hLl9oZWxwZXI/aC50b3A6MCksbj1hLmNvbnRhaW5lckVsZW1lbnQuZ2V0KDApPT09YS5lbGVtZW50LnBhcmVudCgpLmdldCgwKSxvPS9yZWxhdGl2ZXxhYnNvbHV0ZS8udGVzdChhLmNvbnRhaW5lckVsZW1lbnQuY3NzKCJwb3NpdGlvbiIpKSxuJiZvPyhhLm9mZnNldC5sZWZ0PWEucGFyZW50RGF0YS5sZWZ0K2EucG9zaXRpb24ubGVmdCxhLm9mZnNldC50b3A9YS5wYXJlbnREYXRhLnRvcCthLnBvc2l0aW9uLnRvcCk6KGEub2Zmc2V0LmxlZnQ9YS5lbGVtZW50Lm9mZnNldCgpLmxlZnQsYS5vZmZzZXQudG9wPWEuZWxlbWVudC5vZmZzZXQoKS50b3ApLGk9TWF0aC5hYnMoYS5zaXplRGlmZi53aWR0aCsoYS5faGVscGVyP2Eub2Zmc2V0LmxlZnQtdS5sZWZ0OmEub2Zmc2V0LmxlZnQtaC5sZWZ0KSkscz1NYXRoLmFicyhhLnNpemVEaWZmLmhlaWdodCsoYS5faGVscGVyP2Eub2Zmc2V0LnRvcC11LnRvcDphLm9mZnNldC50b3AtaC50b3ApKSxpK2Euc2l6ZS53aWR0aD49YS5wYXJlbnREYXRhLndpZHRoJiYoYS5zaXplLndpZHRoPWEucGFyZW50RGF0YS53aWR0aC1pLGMmJihhLnNpemUuaGVpZ2h0PWEuc2l6ZS53aWR0aC9hLmFzcGVjdFJhdGlvLHA9ITEpKSxzK2Euc2l6ZS5oZWlnaHQ+PWEucGFyZW50RGF0YS5oZWlnaHQmJihhLnNpemUuaGVpZ2h0PWEucGFyZW50RGF0YS5oZWlnaHQtcyxjJiYoYS5zaXplLndpZHRoPWEuc2l6ZS5oZWlnaHQqYS5hc3BlY3RSYXRpbyxwPSExKSkscHx8KGEucG9zaXRpb24ubGVmdD1hLnByZXZQb3NpdGlvbi5sZWZ0LGEucG9zaXRpb24udG9wPWEucHJldlBvc2l0aW9uLnRvcCxhLnNpemUud2lkdGg9YS5wcmV2U2l6ZS53aWR0aCxhLnNpemUuaGVpZ2h0PWEucHJldlNpemUuaGVpZ2h0KX0sc3RvcDpmdW5jdGlvbigpe3ZhciBlPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLGk9ZS5vcHRpb25zLHM9ZS5jb250YWluZXJPZmZzZXQsbj1lLmNvbnRhaW5lclBvc2l0aW9uLG89ZS5jb250YWluZXJFbGVtZW50LGE9dChlLmhlbHBlcikscj1hLm9mZnNldCgpLGg9YS5vdXRlcldpZHRoKCktZS5zaXplRGlmZi53aWR0aCxsPWEub3V0ZXJIZWlnaHQoKS1lLnNpemVEaWZmLmhlaWdodDtlLl9oZWxwZXImJiFpLmFuaW1hdGUmJi9yZWxhdGl2ZS8udGVzdChvLmNzcygicG9zaXRpb24iKSkmJnQodGhpcykuY3NzKHtsZWZ0OnIubGVmdC1uLmxlZnQtcy5sZWZ0LHdpZHRoOmgsaGVpZ2h0Omx9KSxlLl9oZWxwZXImJiFpLmFuaW1hdGUmJi9zdGF0aWMvLnRlc3Qoby5jc3MoInBvc2l0aW9uIikpJiZ0KHRoaXMpLmNzcyh7bGVmdDpyLmxlZnQtbi5sZWZ0LXMubGVmdCx3aWR0aDpoLGhlaWdodDpsfSl9fSksdC51aS5wbHVnaW4uYWRkKCJyZXNpemFibGUiLCJhbHNvUmVzaXplIix7c3RhcnQ6ZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLnJlc2l6YWJsZSgiaW5zdGFuY2UiKSxpPWUub3B0aW9uczt0KGkuYWxzb1Jlc2l6ZSkuZWFjaChmdW5jdGlvbigpe3ZhciBlPXQodGhpcyk7ZS5kYXRhKCJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZSIse3dpZHRoOnBhcnNlRmxvYXQoZS53aWR0aCgpKSxoZWlnaHQ6cGFyc2VGbG9hdChlLmhlaWdodCgpKSxsZWZ0OnBhcnNlRmxvYXQoZS5jc3MoImxlZnQiKSksdG9wOnBhcnNlRmxvYXQoZS5jc3MoInRvcCIpKX0pfSl9LHJlc2l6ZTpmdW5jdGlvbihlLGkpe3ZhciBzPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLG49cy5vcHRpb25zLG89cy5vcmlnaW5hbFNpemUsYT1zLm9yaWdpbmFsUG9zaXRpb24scj17aGVpZ2h0OnMuc2l6ZS5oZWlnaHQtby5oZWlnaHR8fDAsd2lkdGg6cy5zaXplLndpZHRoLW8ud2lkdGh8fDAsdG9wOnMucG9zaXRpb24udG9wLWEudG9wfHwwLGxlZnQ6cy5wb3NpdGlvbi5sZWZ0LWEubGVmdHx8MH07dChuLmFsc29SZXNpemUpLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLHM9dCh0aGlzKS5kYXRhKCJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZSIpLG49e30sbz1lLnBhcmVudHMoaS5vcmlnaW5hbEVsZW1lbnRbMF0pLmxlbmd0aD9bIndpZHRoIiwiaGVpZ2h0Il06WyJ3aWR0aCIsImhlaWdodCIsInRvcCIsImxlZnQiXTt0LmVhY2gobyxmdW5jdGlvbih0LGUpe3ZhciBpPShzW2VdfHwwKSsocltlXXx8MCk7aSYmaT49MCYmKG5bZV09aXx8bnVsbCl9KSxlLmNzcyhuKX0pfSxzdG9wOmZ1bmN0aW9uKCl7dCh0aGlzKS5yZW1vdmVEYXRhKCJ1aS1yZXNpemFibGUtYWxzb3Jlc2l6ZSIpfX0pLHQudWkucGx1Z2luLmFkZCgicmVzaXphYmxlIiwiZ2hvc3QiLHtzdGFydDpmdW5jdGlvbigpe3ZhciBlPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLGk9ZS5zaXplO2UuZ2hvc3Q9ZS5vcmlnaW5hbEVsZW1lbnQuY2xvbmUoKSxlLmdob3N0LmNzcyh7b3BhY2l0eTouMjUsZGlzcGxheToiYmxvY2siLHBvc2l0aW9uOiJyZWxhdGl2ZSIsaGVpZ2h0OmkuaGVpZ2h0LHdpZHRoOmkud2lkdGgsbWFyZ2luOjAsbGVmdDowLHRvcDowfSksZS5fYWRkQ2xhc3MoZS5naG9zdCwidWktcmVzaXphYmxlLWdob3N0IiksdC51aUJhY2tDb21wYXQhPT0hMSYmInN0cmluZyI9PXR5cGVvZiBlLm9wdGlvbnMuZ2hvc3QmJmUuZ2hvc3QuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmdob3N0KSxlLmdob3N0LmFwcGVuZFRvKGUuaGVscGVyKX0scmVzaXplOmZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzKS5yZXNpemFibGUoImluc3RhbmNlIik7ZS5naG9zdCYmZS5naG9zdC5jc3Moe3Bvc2l0aW9uOiJyZWxhdGl2ZSIsaGVpZ2h0OmUuc2l6ZS5oZWlnaHQsd2lkdGg6ZS5zaXplLndpZHRofSl9LHN0b3A6ZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLnJlc2l6YWJsZSgiaW5zdGFuY2UiKTtlLmdob3N0JiZlLmhlbHBlciYmZS5oZWxwZXIuZ2V0KDApLnJlbW92ZUNoaWxkKGUuZ2hvc3QuZ2V0KDApKX19KSx0LnVpLnBsdWdpbi5hZGQoInJlc2l6YWJsZSIsImdyaWQiLHtyZXNpemU6ZnVuY3Rpb24oKXt2YXIgZSxpPXQodGhpcykucmVzaXphYmxlKCJpbnN0YW5jZSIpLHM9aS5vcHRpb25zLG49aS5zaXplLG89aS5vcmlnaW5hbFNpemUsYT1pLm9yaWdpbmFsUG9zaXRpb24scj1pLmF4aXMsaD0ibnVtYmVyIj09dHlwZW9mIHMuZ3JpZD9bcy5ncmlkLHMuZ3JpZF06cy5ncmlkLGw9aFswXXx8MSxjPWhbMV18fDEsdT1NYXRoLnJvdW5kKChuLndpZHRoLW8ud2lkdGgpL2wpKmwsZD1NYXRoLnJvdW5kKChuLmhlaWdodC1vLmhlaWdodCkvYykqYyxwPW8ud2lkdGgrdSxmPW8uaGVpZ2h0K2QsZz1zLm1heFdpZHRoJiZwPnMubWF4V2lkdGgsbT1zLm1heEhlaWdodCYmZj5zLm1heEhlaWdodCxfPXMubWluV2lkdGgmJnMubWluV2lkdGg+cCx2PXMubWluSGVpZ2h0JiZzLm1pbkhlaWdodD5mO3MuZ3JpZD1oLF8mJihwKz1sKSx2JiYoZis9YyksZyYmKHAtPWwpLG0mJihmLT1jKSwvXihzZXxzfGUpJC8udGVzdChyKT8oaS5zaXplLndpZHRoPXAsaS5zaXplLmhlaWdodD1mKTovXihuZSkkLy50ZXN0KHIpPyhpLnNpemUud2lkdGg9cCxpLnNpemUuaGVpZ2h0PWYsaS5wb3NpdGlvbi50b3A9YS50b3AtZCk6L14oc3cpJC8udGVzdChyKT8oaS5zaXplLndpZHRoPXAsaS5zaXplLmhlaWdodD1mLGkucG9zaXRpb24ubGVmdD1hLmxlZnQtdSk6KCgwPj1mLWN8fDA+PXAtbCkmJihlPWkuX2dldFBhZGRpbmdQbHVzQm9yZGVyRGltZW5zaW9ucyh0aGlzKSksZi1jPjA/KGkuc2l6ZS5oZWlnaHQ9ZixpLnBvc2l0aW9uLnRvcD1hLnRvcC1kKTooZj1jLWUuaGVpZ2h0LGkuc2l6ZS5oZWlnaHQ9ZixpLnBvc2l0aW9uLnRvcD1hLnRvcCtvLmhlaWdodC1mKSxwLWw+MD8oaS5zaXplLndpZHRoPXAsaS5wb3NpdGlvbi5sZWZ0PWEubGVmdC11KToocD1sLWUud2lkdGgsaS5zaXplLndpZHRoPXAsaS5wb3NpdGlvbi5sZWZ0PWEubGVmdCtvLndpZHRoLXApKX19KSx0LnVpLnJlc2l6YWJsZSx0LndpZGdldCgidWkuZGlhbG9nIix7dmVyc2lvbjoiMS4xMi4xIixvcHRpb25zOnthcHBlbmRUbzoiYm9keSIsYXV0b09wZW46ITAsYnV0dG9uczpbXSxjbGFzc2VzOnsidWktZGlhbG9nIjoidWktY29ybmVyLWFsbCIsInVpLWRpYWxvZy10aXRsZWJhciI6InVpLWNvcm5lci1hbGwifSxjbG9zZU9uRXNjYXBlOiEwLGNsb3NlVGV4dDoiQ2xvc2UiLGRyYWdnYWJsZTohMCxoaWRlOm51bGwsaGVpZ2h0OiJhdXRvIixtYXhIZWlnaHQ6bnVsbCxtYXhXaWR0aDpudWxsLG1pbkhlaWdodDoxNTAsbWluV2lkdGg6MTUwLG1vZGFsOiExLHBvc2l0aW9uOntteToiY2VudGVyIixhdDoiY2VudGVyIixvZjp3aW5kb3csY29sbGlzaW9uOiJmaXQiLHVzaW5nOmZ1bmN0aW9uKGUpe3ZhciBpPXQodGhpcykuY3NzKGUpLm9mZnNldCgpLnRvcDswPmkmJnQodGhpcykuY3NzKCJ0b3AiLGUudG9wLWkpfX0scmVzaXphYmxlOiEwLHNob3c6bnVsbCx0aXRsZTpudWxsLHdpZHRoOjMwMCxiZWZvcmVDbG9zZTpudWxsLGNsb3NlOm51bGwsZHJhZzpudWxsLGRyYWdTdGFydDpudWxsLGRyYWdTdG9wOm51bGwsZm9jdXM6bnVsbCxvcGVuOm51bGwscmVzaXplOm51bGwscmVzaXplU3RhcnQ6bnVsbCxyZXNpemVTdG9wOm51bGx9LHNpemVSZWxhdGVkT3B0aW9uczp7YnV0dG9uczohMCxoZWlnaHQ6ITAsbWF4SGVpZ2h0OiEwLG1heFdpZHRoOiEwLG1pbkhlaWdodDohMCxtaW5XaWR0aDohMCx3aWR0aDohMH0scmVzaXphYmxlUmVsYXRlZE9wdGlvbnM6e21heEhlaWdodDohMCxtYXhXaWR0aDohMCxtaW5IZWlnaHQ6ITAsbWluV2lkdGg6ITB9LF9jcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLm9yaWdpbmFsQ3NzPXtkaXNwbGF5OnRoaXMuZWxlbWVudFswXS5zdHlsZS5kaXNwbGF5LHdpZHRoOnRoaXMuZWxlbWVudFswXS5zdHlsZS53aWR0aCxtaW5IZWlnaHQ6dGhpcy5lbGVtZW50WzBdLnN0eWxlLm1pbkhlaWdodCxtYXhIZWlnaHQ6dGhpcy5lbGVtZW50WzBdLnN0eWxlLm1heEhlaWdodCxoZWlnaHQ6dGhpcy5lbGVtZW50WzBdLnN0eWxlLmhlaWdodH0sdGhpcy5vcmlnaW5hbFBvc2l0aW9uPXtwYXJlbnQ6dGhpcy5lbGVtZW50LnBhcmVudCgpLGluZGV4OnRoaXMuZWxlbWVudC5wYXJlbnQoKS5jaGlsZHJlbigpLmluZGV4KHRoaXMuZWxlbWVudCl9LHRoaXMub3JpZ2luYWxUaXRsZT10aGlzLmVsZW1lbnQuYXR0cigidGl0bGUiKSxudWxsPT10aGlzLm9wdGlvbnMudGl0bGUmJm51bGwhPXRoaXMub3JpZ2luYWxUaXRsZSYmKHRoaXMub3B0aW9ucy50aXRsZT10aGlzLm9yaWdpbmFsVGl0bGUpLHRoaXMub3B0aW9ucy5kaXNhYmxlZCYmKHRoaXMub3B0aW9ucy5kaXNhYmxlZD0hMSksdGhpcy5fY3JlYXRlV3JhcHBlcigpLHRoaXMuZWxlbWVudC5zaG93KCkucmVtb3ZlQXR0cigidGl0bGUiKS5hcHBlbmRUbyh0aGlzLnVpRGlhbG9nKSx0aGlzLl9hZGRDbGFzcygidWktZGlhbG9nLWNvbnRlbnQiLCJ1aS13aWRnZXQtY29udGVudCIpLHRoaXMuX2NyZWF0ZVRpdGxlYmFyKCksdGhpcy5fY3JlYXRlQnV0dG9uUGFuZSgpLHRoaXMub3B0aW9ucy5kcmFnZ2FibGUmJnQuZm4uZHJhZ2dhYmxlJiZ0aGlzLl9tYWtlRHJhZ2dhYmxlKCksdGhpcy5vcHRpb25zLnJlc2l6YWJsZSYmdC5mbi5yZXNpemFibGUmJnRoaXMuX21ha2VSZXNpemFibGUoKSx0aGlzLl9pc09wZW49ITEsdGhpcy5fdHJhY2tGb2N1cygpfSxfaW5pdDpmdW5jdGlvbigpe3RoaXMub3B0aW9ucy5hdXRvT3BlbiYmdGhpcy5vcGVuKCl9LF9hcHBlbmRUbzpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucy5hcHBlbmRUbztyZXR1cm4gZSYmKGUuanF1ZXJ5fHxlLm5vZGVUeXBlKT90KGUpOnRoaXMuZG9jdW1lbnQuZmluZChlfHwiYm9keSIpLmVxKDApfSxfZGVzdHJveTpmdW5jdGlvbigpe3ZhciB0LGU9dGhpcy5vcmlnaW5hbFBvc2l0aW9uO3RoaXMuX3VudHJhY2tJbnN0YW5jZSgpLHRoaXMuX2Rlc3Ryb3lPdmVybGF5KCksdGhpcy5lbGVtZW50LnJlbW92ZVVuaXF1ZUlkKCkuY3NzKHRoaXMub3JpZ2luYWxDc3MpLmRldGFjaCgpLHRoaXMudWlEaWFsb2cucmVtb3ZlKCksdGhpcy5vcmlnaW5hbFRpdGxlJiZ0aGlzLmVsZW1lbnQuYXR0cigidGl0bGUiLHRoaXMub3JpZ2luYWxUaXRsZSksdD1lLnBhcmVudC5jaGlsZHJlbigpLmVxKGUuaW5kZXgpLHQubGVuZ3RoJiZ0WzBdIT09dGhpcy5lbGVtZW50WzBdP3QuYmVmb3JlKHRoaXMuZWxlbWVudCk6ZS5wYXJlbnQuYXBwZW5kKHRoaXMuZWxlbWVudCl9LHdpZGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVpRGlhbG9nCn0sZGlzYWJsZTp0Lm5vb3AsZW5hYmxlOnQubm9vcCxjbG9zZTpmdW5jdGlvbihlKXt2YXIgaT10aGlzO3RoaXMuX2lzT3BlbiYmdGhpcy5fdHJpZ2dlcigiYmVmb3JlQ2xvc2UiLGUpIT09ITEmJih0aGlzLl9pc09wZW49ITEsdGhpcy5fZm9jdXNlZEVsZW1lbnQ9bnVsbCx0aGlzLl9kZXN0cm95T3ZlcmxheSgpLHRoaXMuX3VudHJhY2tJbnN0YW5jZSgpLHRoaXMub3BlbmVyLmZpbHRlcigiOmZvY3VzYWJsZSIpLnRyaWdnZXIoImZvY3VzIikubGVuZ3RofHx0LnVpLnNhZmVCbHVyKHQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSkpLHRoaXMuX2hpZGUodGhpcy51aURpYWxvZyx0aGlzLm9wdGlvbnMuaGlkZSxmdW5jdGlvbigpe2kuX3RyaWdnZXIoImNsb3NlIixlKX0pKX0saXNPcGVuOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzT3Blbn0sbW92ZVRvVG9wOmZ1bmN0aW9uKCl7dGhpcy5fbW92ZVRvVG9wKCl9LF9tb3ZlVG9Ub3A6ZnVuY3Rpb24oZSxpKXt2YXIgcz0hMSxuPXRoaXMudWlEaWFsb2cuc2libGluZ3MoIi51aS1mcm9udDp2aXNpYmxlIikubWFwKGZ1bmN0aW9uKCl7cmV0dXJuK3QodGhpcykuY3NzKCJ6LWluZGV4Iil9KS5nZXQoKSxvPU1hdGgubWF4LmFwcGx5KG51bGwsbik7cmV0dXJuIG8+PSt0aGlzLnVpRGlhbG9nLmNzcygiei1pbmRleCIpJiYodGhpcy51aURpYWxvZy5jc3MoInotaW5kZXgiLG8rMSkscz0hMCkscyYmIWkmJnRoaXMuX3RyaWdnZXIoImZvY3VzIixlKSxzfSxvcGVuOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcztyZXR1cm4gdGhpcy5faXNPcGVuPyh0aGlzLl9tb3ZlVG9Ub3AoKSYmdGhpcy5fZm9jdXNUYWJiYWJsZSgpLHZvaWQgMCk6KHRoaXMuX2lzT3Blbj0hMCx0aGlzLm9wZW5lcj10KHQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSkpLHRoaXMuX3NpemUoKSx0aGlzLl9wb3NpdGlvbigpLHRoaXMuX2NyZWF0ZU92ZXJsYXkoKSx0aGlzLl9tb3ZlVG9Ub3AobnVsbCwhMCksdGhpcy5vdmVybGF5JiZ0aGlzLm92ZXJsYXkuY3NzKCJ6LWluZGV4Iix0aGlzLnVpRGlhbG9nLmNzcygiei1pbmRleCIpLTEpLHRoaXMuX3Nob3codGhpcy51aURpYWxvZyx0aGlzLm9wdGlvbnMuc2hvdyxmdW5jdGlvbigpe2UuX2ZvY3VzVGFiYmFibGUoKSxlLl90cmlnZ2VyKCJmb2N1cyIpfSksdGhpcy5fbWFrZUZvY3VzVGFyZ2V0KCksdGhpcy5fdHJpZ2dlcigib3BlbiIpLHZvaWQgMCl9LF9mb2N1c1RhYmJhYmxlOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZm9jdXNlZEVsZW1lbnQ7dHx8KHQ9dGhpcy5lbGVtZW50LmZpbmQoIlthdXRvZm9jdXNdIikpLHQubGVuZ3RofHwodD10aGlzLmVsZW1lbnQuZmluZCgiOnRhYmJhYmxlIikpLHQubGVuZ3RofHwodD10aGlzLnVpRGlhbG9nQnV0dG9uUGFuZS5maW5kKCI6dGFiYmFibGUiKSksdC5sZW5ndGh8fCh0PXRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlLmZpbHRlcigiOnRhYmJhYmxlIikpLHQubGVuZ3RofHwodD10aGlzLnVpRGlhbG9nKSx0LmVxKDApLnRyaWdnZXIoImZvY3VzIil9LF9rZWVwRm9jdXM6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaSgpe3ZhciBlPXQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSksaT10aGlzLnVpRGlhbG9nWzBdPT09ZXx8dC5jb250YWlucyh0aGlzLnVpRGlhbG9nWzBdLGUpO2l8fHRoaXMuX2ZvY3VzVGFiYmFibGUoKX1lLnByZXZlbnREZWZhdWx0KCksaS5jYWxsKHRoaXMpLHRoaXMuX2RlbGF5KGkpfSxfY3JlYXRlV3JhcHBlcjpmdW5jdGlvbigpe3RoaXMudWlEaWFsb2c9dCgiPGRpdj4iKS5oaWRlKCkuYXR0cih7dGFiSW5kZXg6LTEscm9sZToiZGlhbG9nIn0pLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLHRoaXMuX2FkZENsYXNzKHRoaXMudWlEaWFsb2csInVpLWRpYWxvZyIsInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCB1aS1mcm9udCIpLHRoaXMuX29uKHRoaXMudWlEaWFsb2cse2tleWRvd246ZnVuY3Rpb24oZSl7aWYodGhpcy5vcHRpb25zLmNsb3NlT25Fc2NhcGUmJiFlLmlzRGVmYXVsdFByZXZlbnRlZCgpJiZlLmtleUNvZGUmJmUua2V5Q29kZT09PXQudWkua2V5Q29kZS5FU0NBUEUpcmV0dXJuIGUucHJldmVudERlZmF1bHQoKSx0aGlzLmNsb3NlKGUpLHZvaWQgMDtpZihlLmtleUNvZGU9PT10LnVpLmtleUNvZGUuVEFCJiYhZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7dmFyIGk9dGhpcy51aURpYWxvZy5maW5kKCI6dGFiYmFibGUiKSxzPWkuZmlsdGVyKCI6Zmlyc3QiKSxuPWkuZmlsdGVyKCI6bGFzdCIpO2UudGFyZ2V0IT09blswXSYmZS50YXJnZXQhPT10aGlzLnVpRGlhbG9nWzBdfHxlLnNoaWZ0S2V5P2UudGFyZ2V0IT09c1swXSYmZS50YXJnZXQhPT10aGlzLnVpRGlhbG9nWzBdfHwhZS5zaGlmdEtleXx8KHRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7bi50cmlnZ2VyKCJmb2N1cyIpfSksZS5wcmV2ZW50RGVmYXVsdCgpKToodGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtzLnRyaWdnZXIoImZvY3VzIil9KSxlLnByZXZlbnREZWZhdWx0KCkpfX0sbW91c2Vkb3duOmZ1bmN0aW9uKHQpe3RoaXMuX21vdmVUb1RvcCh0KSYmdGhpcy5fZm9jdXNUYWJiYWJsZSgpfX0pLHRoaXMuZWxlbWVudC5maW5kKCJbYXJpYS1kZXNjcmliZWRieV0iKS5sZW5ndGh8fHRoaXMudWlEaWFsb2cuYXR0cih7ImFyaWEtZGVzY3JpYmVkYnkiOnRoaXMuZWxlbWVudC51bmlxdWVJZCgpLmF0dHIoImlkIil9KX0sX2NyZWF0ZVRpdGxlYmFyOmZ1bmN0aW9uKCl7dmFyIGU7dGhpcy51aURpYWxvZ1RpdGxlYmFyPXQoIjxkaXY+IiksdGhpcy5fYWRkQ2xhc3ModGhpcy51aURpYWxvZ1RpdGxlYmFyLCJ1aS1kaWFsb2ctdGl0bGViYXIiLCJ1aS13aWRnZXQtaGVhZGVyIHVpLWhlbHBlci1jbGVhcmZpeCIpLHRoaXMuX29uKHRoaXMudWlEaWFsb2dUaXRsZWJhcix7bW91c2Vkb3duOmZ1bmN0aW9uKGUpe3QoZS50YXJnZXQpLmNsb3Nlc3QoIi51aS1kaWFsb2ctdGl0bGViYXItY2xvc2UiKXx8dGhpcy51aURpYWxvZy50cmlnZ2VyKCJmb2N1cyIpfX0pLHRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlPXQoIjxidXR0b24gdHlwZT0nYnV0dG9uJz48L2J1dHRvbj4iKS5idXR0b24oe2xhYmVsOnQoIjxhPiIpLnRleHQodGhpcy5vcHRpb25zLmNsb3NlVGV4dCkuaHRtbCgpLGljb246InVpLWljb24tY2xvc2V0aGljayIsc2hvd0xhYmVsOiExfSkuYXBwZW5kVG8odGhpcy51aURpYWxvZ1RpdGxlYmFyKSx0aGlzLl9hZGRDbGFzcyh0aGlzLnVpRGlhbG9nVGl0bGViYXJDbG9zZSwidWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIiksdGhpcy5fb24odGhpcy51aURpYWxvZ1RpdGxlYmFyQ2xvc2Use2NsaWNrOmZ1bmN0aW9uKHQpe3QucHJldmVudERlZmF1bHQoKSx0aGlzLmNsb3NlKHQpfX0pLGU9dCgiPHNwYW4+IikudW5pcXVlSWQoKS5wcmVwZW5kVG8odGhpcy51aURpYWxvZ1RpdGxlYmFyKSx0aGlzLl9hZGRDbGFzcyhlLCJ1aS1kaWFsb2ctdGl0bGUiKSx0aGlzLl90aXRsZShlKSx0aGlzLnVpRGlhbG9nVGl0bGViYXIucHJlcGVuZFRvKHRoaXMudWlEaWFsb2cpLHRoaXMudWlEaWFsb2cuYXR0cih7ImFyaWEtbGFiZWxsZWRieSI6ZS5hdHRyKCJpZCIpfSl9LF90aXRsZTpmdW5jdGlvbih0KXt0aGlzLm9wdGlvbnMudGl0bGU/dC50ZXh0KHRoaXMub3B0aW9ucy50aXRsZSk6dC5odG1sKCImIzE2MDsiKX0sX2NyZWF0ZUJ1dHRvblBhbmU6ZnVuY3Rpb24oKXt0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZT10KCI8ZGl2PiIpLHRoaXMuX2FkZENsYXNzKHRoaXMudWlEaWFsb2dCdXR0b25QYW5lLCJ1aS1kaWFsb2ctYnV0dG9ucGFuZSIsInVpLXdpZGdldC1jb250ZW50IHVpLWhlbHBlci1jbGVhcmZpeCIpLHRoaXMudWlCdXR0b25TZXQ9dCgiPGRpdj4iKS5hcHBlbmRUbyh0aGlzLnVpRGlhbG9nQnV0dG9uUGFuZSksdGhpcy5fYWRkQ2xhc3ModGhpcy51aUJ1dHRvblNldCwidWktZGlhbG9nLWJ1dHRvbnNldCIpLHRoaXMuX2NyZWF0ZUJ1dHRvbnMoKX0sX2NyZWF0ZUJ1dHRvbnM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLGk9dGhpcy5vcHRpb25zLmJ1dHRvbnM7cmV0dXJuIHRoaXMudWlEaWFsb2dCdXR0b25QYW5lLnJlbW92ZSgpLHRoaXMudWlCdXR0b25TZXQuZW1wdHkoKSx0LmlzRW1wdHlPYmplY3QoaSl8fHQuaXNBcnJheShpKSYmIWkubGVuZ3RoPyh0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLnVpRGlhbG9nLCJ1aS1kaWFsb2ctYnV0dG9ucyIpLHZvaWQgMCk6KHQuZWFjaChpLGZ1bmN0aW9uKGkscyl7dmFyIG4sbztzPXQuaXNGdW5jdGlvbihzKT97Y2xpY2s6cyx0ZXh0Oml9OnMscz10LmV4dGVuZCh7dHlwZToiYnV0dG9uIn0scyksbj1zLmNsaWNrLG89e2ljb246cy5pY29uLGljb25Qb3NpdGlvbjpzLmljb25Qb3NpdGlvbixzaG93TGFiZWw6cy5zaG93TGFiZWwsaWNvbnM6cy5pY29ucyx0ZXh0OnMudGV4dH0sZGVsZXRlIHMuY2xpY2ssZGVsZXRlIHMuaWNvbixkZWxldGUgcy5pY29uUG9zaXRpb24sZGVsZXRlIHMuc2hvd0xhYmVsLGRlbGV0ZSBzLmljb25zLCJib29sZWFuIj09dHlwZW9mIHMudGV4dCYmZGVsZXRlIHMudGV4dCx0KCI8YnV0dG9uPjwvYnV0dG9uPiIscykuYnV0dG9uKG8pLmFwcGVuZFRvKGUudWlCdXR0b25TZXQpLm9uKCJjbGljayIsZnVuY3Rpb24oKXtuLmFwcGx5KGUuZWxlbWVudFswXSxhcmd1bWVudHMpfSl9KSx0aGlzLl9hZGRDbGFzcyh0aGlzLnVpRGlhbG9nLCJ1aS1kaWFsb2ctYnV0dG9ucyIpLHRoaXMudWlEaWFsb2dCdXR0b25QYW5lLmFwcGVuZFRvKHRoaXMudWlEaWFsb2cpLHZvaWQgMCl9LF9tYWtlRHJhZ2dhYmxlOmZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0KXtyZXR1cm57cG9zaXRpb246dC5wb3NpdGlvbixvZmZzZXQ6dC5vZmZzZXR9fXZhciBpPXRoaXMscz10aGlzLm9wdGlvbnM7dGhpcy51aURpYWxvZy5kcmFnZ2FibGUoe2NhbmNlbDoiLnVpLWRpYWxvZy1jb250ZW50LCAudWktZGlhbG9nLXRpdGxlYmFyLWNsb3NlIixoYW5kbGU6Ii51aS1kaWFsb2ctdGl0bGViYXIiLGNvbnRhaW5tZW50OiJkb2N1bWVudCIsc3RhcnQ6ZnVuY3Rpb24ocyxuKXtpLl9hZGRDbGFzcyh0KHRoaXMpLCJ1aS1kaWFsb2ctZHJhZ2dpbmciKSxpLl9ibG9ja0ZyYW1lcygpLGkuX3RyaWdnZXIoImRyYWdTdGFydCIscyxlKG4pKX0sZHJhZzpmdW5jdGlvbih0LHMpe2kuX3RyaWdnZXIoImRyYWciLHQsZShzKSl9LHN0b3A6ZnVuY3Rpb24obixvKXt2YXIgYT1vLm9mZnNldC5sZWZ0LWkuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpLHI9by5vZmZzZXQudG9wLWkuZG9jdW1lbnQuc2Nyb2xsVG9wKCk7cy5wb3NpdGlvbj17bXk6ImxlZnQgdG9wIixhdDoibGVmdCIrKGE+PTA/IisiOiIiKSthKyIgIisidG9wIisocj49MD8iKyI6IiIpK3Isb2Y6aS53aW5kb3d9LGkuX3JlbW92ZUNsYXNzKHQodGhpcyksInVpLWRpYWxvZy1kcmFnZ2luZyIpLGkuX3VuYmxvY2tGcmFtZXMoKSxpLl90cmlnZ2VyKCJkcmFnU3RvcCIsbixlKG8pKX19KX0sX21ha2VSZXNpemFibGU6ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3JldHVybntvcmlnaW5hbFBvc2l0aW9uOnQub3JpZ2luYWxQb3NpdGlvbixvcmlnaW5hbFNpemU6dC5vcmlnaW5hbFNpemUscG9zaXRpb246dC5wb3NpdGlvbixzaXplOnQuc2l6ZX19dmFyIGk9dGhpcyxzPXRoaXMub3B0aW9ucyxuPXMucmVzaXphYmxlLG89dGhpcy51aURpYWxvZy5jc3MoInBvc2l0aW9uIiksYT0ic3RyaW5nIj09dHlwZW9mIG4/bjoibixlLHMsdyxzZSxzdyxuZSxudyI7dGhpcy51aURpYWxvZy5yZXNpemFibGUoe2NhbmNlbDoiLnVpLWRpYWxvZy1jb250ZW50Iixjb250YWlubWVudDoiZG9jdW1lbnQiLGFsc29SZXNpemU6dGhpcy5lbGVtZW50LG1heFdpZHRoOnMubWF4V2lkdGgsbWF4SGVpZ2h0OnMubWF4SGVpZ2h0LG1pbldpZHRoOnMubWluV2lkdGgsbWluSGVpZ2h0OnRoaXMuX21pbkhlaWdodCgpLGhhbmRsZXM6YSxzdGFydDpmdW5jdGlvbihzLG4pe2kuX2FkZENsYXNzKHQodGhpcyksInVpLWRpYWxvZy1yZXNpemluZyIpLGkuX2Jsb2NrRnJhbWVzKCksaS5fdHJpZ2dlcigicmVzaXplU3RhcnQiLHMsZShuKSl9LHJlc2l6ZTpmdW5jdGlvbih0LHMpe2kuX3RyaWdnZXIoInJlc2l6ZSIsdCxlKHMpKX0sc3RvcDpmdW5jdGlvbihuLG8pe3ZhciBhPWkudWlEaWFsb2cub2Zmc2V0KCkscj1hLmxlZnQtaS5kb2N1bWVudC5zY3JvbGxMZWZ0KCksaD1hLnRvcC1pLmRvY3VtZW50LnNjcm9sbFRvcCgpO3MuaGVpZ2h0PWkudWlEaWFsb2cuaGVpZ2h0KCkscy53aWR0aD1pLnVpRGlhbG9nLndpZHRoKCkscy5wb3NpdGlvbj17bXk6ImxlZnQgdG9wIixhdDoibGVmdCIrKHI+PTA/IisiOiIiKStyKyIgIisidG9wIisoaD49MD8iKyI6IiIpK2gsb2Y6aS53aW5kb3d9LGkuX3JlbW92ZUNsYXNzKHQodGhpcyksInVpLWRpYWxvZy1yZXNpemluZyIpLGkuX3VuYmxvY2tGcmFtZXMoKSxpLl90cmlnZ2VyKCJyZXNpemVTdG9wIixuLGUobykpfX0pLmNzcygicG9zaXRpb24iLG8pfSxfdHJhY2tGb2N1czpmdW5jdGlvbigpe3RoaXMuX29uKHRoaXMud2lkZ2V0KCkse2ZvY3VzaW46ZnVuY3Rpb24oZSl7dGhpcy5fbWFrZUZvY3VzVGFyZ2V0KCksdGhpcy5fZm9jdXNlZEVsZW1lbnQ9dChlLnRhcmdldCl9fSl9LF9tYWtlRm9jdXNUYXJnZXQ6ZnVuY3Rpb24oKXt0aGlzLl91bnRyYWNrSW5zdGFuY2UoKSx0aGlzLl90cmFja2luZ0luc3RhbmNlcygpLnVuc2hpZnQodGhpcyl9LF91bnRyYWNrSW5zdGFuY2U6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl90cmFja2luZ0luc3RhbmNlcygpLGk9dC5pbkFycmF5KHRoaXMsZSk7LTEhPT1pJiZlLnNwbGljZShpLDEpfSxfdHJhY2tpbmdJbnN0YW5jZXM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmRvY3VtZW50LmRhdGEoInVpLWRpYWxvZy1pbnN0YW5jZXMiKTtyZXR1cm4gdHx8KHQ9W10sdGhpcy5kb2N1bWVudC5kYXRhKCJ1aS1kaWFsb2ctaW5zdGFuY2VzIix0KSksdH0sX21pbkhlaWdodDpmdW5jdGlvbigpe3ZhciB0PXRoaXMub3B0aW9ucztyZXR1cm4iYXV0byI9PT10LmhlaWdodD90Lm1pbkhlaWdodDpNYXRoLm1pbih0Lm1pbkhlaWdodCx0LmhlaWdodCl9LF9wb3NpdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMudWlEaWFsb2cuaXMoIjp2aXNpYmxlIik7dHx8dGhpcy51aURpYWxvZy5zaG93KCksdGhpcy51aURpYWxvZy5wb3NpdGlvbih0aGlzLm9wdGlvbnMucG9zaXRpb24pLHR8fHRoaXMudWlEaWFsb2cuaGlkZSgpfSxfc2V0T3B0aW9uczpmdW5jdGlvbihlKXt2YXIgaT10aGlzLHM9ITEsbj17fTt0LmVhY2goZSxmdW5jdGlvbih0LGUpe2kuX3NldE9wdGlvbih0LGUpLHQgaW4gaS5zaXplUmVsYXRlZE9wdGlvbnMmJihzPSEwKSx0IGluIGkucmVzaXphYmxlUmVsYXRlZE9wdGlvbnMmJihuW3RdPWUpfSkscyYmKHRoaXMuX3NpemUoKSx0aGlzLl9wb3NpdGlvbigpKSx0aGlzLnVpRGlhbG9nLmlzKCI6ZGF0YSh1aS1yZXNpemFibGUpIikmJnRoaXMudWlEaWFsb2cucmVzaXphYmxlKCJvcHRpb24iLG4pfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKGUsaSl7dmFyIHMsbixvPXRoaXMudWlEaWFsb2c7ImRpc2FibGVkIiE9PWUmJih0aGlzLl9zdXBlcihlLGkpLCJhcHBlbmRUbyI9PT1lJiZ0aGlzLnVpRGlhbG9nLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLCJidXR0b25zIj09PWUmJnRoaXMuX2NyZWF0ZUJ1dHRvbnMoKSwiY2xvc2VUZXh0Ij09PWUmJnRoaXMudWlEaWFsb2dUaXRsZWJhckNsb3NlLmJ1dHRvbih7bGFiZWw6dCgiPGE+IikudGV4dCgiIit0aGlzLm9wdGlvbnMuY2xvc2VUZXh0KS5odG1sKCl9KSwiZHJhZ2dhYmxlIj09PWUmJihzPW8uaXMoIjpkYXRhKHVpLWRyYWdnYWJsZSkiKSxzJiYhaSYmby5kcmFnZ2FibGUoImRlc3Ryb3kiKSwhcyYmaSYmdGhpcy5fbWFrZURyYWdnYWJsZSgpKSwicG9zaXRpb24iPT09ZSYmdGhpcy5fcG9zaXRpb24oKSwicmVzaXphYmxlIj09PWUmJihuPW8uaXMoIjpkYXRhKHVpLXJlc2l6YWJsZSkiKSxuJiYhaSYmby5yZXNpemFibGUoImRlc3Ryb3kiKSxuJiYic3RyaW5nIj09dHlwZW9mIGkmJm8ucmVzaXphYmxlKCJvcHRpb24iLCJoYW5kbGVzIixpKSxufHxpPT09ITF8fHRoaXMuX21ha2VSZXNpemFibGUoKSksInRpdGxlIj09PWUmJnRoaXMuX3RpdGxlKHRoaXMudWlEaWFsb2dUaXRsZWJhci5maW5kKCIudWktZGlhbG9nLXRpdGxlIikpKX0sX3NpemU6ZnVuY3Rpb24oKXt2YXIgdCxlLGkscz10aGlzLm9wdGlvbnM7dGhpcy5lbGVtZW50LnNob3coKS5jc3Moe3dpZHRoOiJhdXRvIixtaW5IZWlnaHQ6MCxtYXhIZWlnaHQ6Im5vbmUiLGhlaWdodDowfSkscy5taW5XaWR0aD5zLndpZHRoJiYocy53aWR0aD1zLm1pbldpZHRoKSx0PXRoaXMudWlEaWFsb2cuY3NzKHtoZWlnaHQ6ImF1dG8iLHdpZHRoOnMud2lkdGh9KS5vdXRlckhlaWdodCgpLGU9TWF0aC5tYXgoMCxzLm1pbkhlaWdodC10KSxpPSJudW1iZXIiPT10eXBlb2Ygcy5tYXhIZWlnaHQ/TWF0aC5tYXgoMCxzLm1heEhlaWdodC10KToibm9uZSIsImF1dG8iPT09cy5oZWlnaHQ/dGhpcy5lbGVtZW50LmNzcyh7bWluSGVpZ2h0OmUsbWF4SGVpZ2h0OmksaGVpZ2h0OiJhdXRvIn0pOnRoaXMuZWxlbWVudC5oZWlnaHQoTWF0aC5tYXgoMCxzLmhlaWdodC10KSksdGhpcy51aURpYWxvZy5pcygiOmRhdGEodWktcmVzaXphYmxlKSIpJiZ0aGlzLnVpRGlhbG9nLnJlc2l6YWJsZSgib3B0aW9uIiwibWluSGVpZ2h0Iix0aGlzLl9taW5IZWlnaHQoKSl9LF9ibG9ja0ZyYW1lczpmdW5jdGlvbigpe3RoaXMuaWZyYW1lQmxvY2tzPXRoaXMuZG9jdW1lbnQuZmluZCgiaWZyYW1lIikubWFwKGZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzKTtyZXR1cm4gdCgiPGRpdj4iKS5jc3Moe3Bvc2l0aW9uOiJhYnNvbHV0ZSIsd2lkdGg6ZS5vdXRlcldpZHRoKCksaGVpZ2h0OmUub3V0ZXJIZWlnaHQoKX0pLmFwcGVuZFRvKGUucGFyZW50KCkpLm9mZnNldChlLm9mZnNldCgpKVswXX0pfSxfdW5ibG9ja0ZyYW1lczpmdW5jdGlvbigpe3RoaXMuaWZyYW1lQmxvY2tzJiYodGhpcy5pZnJhbWVCbG9ja3MucmVtb3ZlKCksZGVsZXRlIHRoaXMuaWZyYW1lQmxvY2tzKX0sX2FsbG93SW50ZXJhY3Rpb246ZnVuY3Rpb24oZSl7cmV0dXJuIHQoZS50YXJnZXQpLmNsb3Nlc3QoIi51aS1kaWFsb2ciKS5sZW5ndGg/ITA6ISF0KGUudGFyZ2V0KS5jbG9zZXN0KCIudWktZGF0ZXBpY2tlciIpLmxlbmd0aH0sX2NyZWF0ZU92ZXJsYXk6ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMubW9kYWwpe3ZhciBlPSEwO3RoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7ZT0hMX0pLHRoaXMuZG9jdW1lbnQuZGF0YSgidWktZGlhbG9nLW92ZXJsYXlzIil8fHRoaXMuX29uKHRoaXMuZG9jdW1lbnQse2ZvY3VzaW46ZnVuY3Rpb24odCl7ZXx8dGhpcy5fYWxsb3dJbnRlcmFjdGlvbih0KXx8KHQucHJldmVudERlZmF1bHQoKSx0aGlzLl90cmFja2luZ0luc3RhbmNlcygpWzBdLl9mb2N1c1RhYmJhYmxlKCkpfX0pLHRoaXMub3ZlcmxheT10KCI8ZGl2PiIpLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLHRoaXMuX2FkZENsYXNzKHRoaXMub3ZlcmxheSxudWxsLCJ1aS13aWRnZXQtb3ZlcmxheSB1aS1mcm9udCIpLHRoaXMuX29uKHRoaXMub3ZlcmxheSx7bW91c2Vkb3duOiJfa2VlcEZvY3VzIn0pLHRoaXMuZG9jdW1lbnQuZGF0YSgidWktZGlhbG9nLW92ZXJsYXlzIiwodGhpcy5kb2N1bWVudC5kYXRhKCJ1aS1kaWFsb2ctb3ZlcmxheXMiKXx8MCkrMSl9fSxfZGVzdHJveU92ZXJsYXk6ZnVuY3Rpb24oKXtpZih0aGlzLm9wdGlvbnMubW9kYWwmJnRoaXMub3ZlcmxheSl7dmFyIHQ9dGhpcy5kb2N1bWVudC5kYXRhKCJ1aS1kaWFsb2ctb3ZlcmxheXMiKS0xO3Q/dGhpcy5kb2N1bWVudC5kYXRhKCJ1aS1kaWFsb2ctb3ZlcmxheXMiLHQpOih0aGlzLl9vZmYodGhpcy5kb2N1bWVudCwiZm9jdXNpbiIpLHRoaXMuZG9jdW1lbnQucmVtb3ZlRGF0YSgidWktZGlhbG9nLW92ZXJsYXlzIikpLHRoaXMub3ZlcmxheS5yZW1vdmUoKSx0aGlzLm92ZXJsYXk9bnVsbH19fSksdC51aUJhY2tDb21wYXQhPT0hMSYmdC53aWRnZXQoInVpLmRpYWxvZyIsdC51aS5kaWFsb2cse29wdGlvbnM6e2RpYWxvZ0NsYXNzOiIifSxfY3JlYXRlV3JhcHBlcjpmdW5jdGlvbigpe3RoaXMuX3N1cGVyKCksdGhpcy51aURpYWxvZy5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuZGlhbG9nQ2xhc3MpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKHQsZSl7ImRpYWxvZ0NsYXNzIj09PXQmJnRoaXMudWlEaWFsb2cucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmRpYWxvZ0NsYXNzKS5hZGRDbGFzcyhlKSx0aGlzLl9zdXBlckFwcGx5KGFyZ3VtZW50cyl9fSksdC51aS5kaWFsb2csdC53aWRnZXQoInVpLmRyb3BwYWJsZSIse3ZlcnNpb246IjEuMTIuMSIsd2lkZ2V0RXZlbnRQcmVmaXg6ImRyb3AiLG9wdGlvbnM6e2FjY2VwdDoiKiIsYWRkQ2xhc3NlczohMCxncmVlZHk6ITEsc2NvcGU6ImRlZmF1bHQiLHRvbGVyYW5jZToiaW50ZXJzZWN0IixhY3RpdmF0ZTpudWxsLGRlYWN0aXZhdGU6bnVsbCxkcm9wOm51bGwsb3V0Om51bGwsb3ZlcjpudWxsfSxfY3JlYXRlOmZ1bmN0aW9uKCl7dmFyIGUsaT10aGlzLm9wdGlvbnMscz1pLmFjY2VwdDt0aGlzLmlzb3Zlcj0hMSx0aGlzLmlzb3V0PSEwLHRoaXMuYWNjZXB0PXQuaXNGdW5jdGlvbihzKT9zOmZ1bmN0aW9uKHQpe3JldHVybiB0LmlzKHMpfSx0aGlzLnByb3BvcnRpb25zPWZ1bmN0aW9uKCl7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg/KGU9YXJndW1lbnRzWzBdLHZvaWQgMCk6ZT9lOmU9e3dpZHRoOnRoaXMuZWxlbWVudFswXS5vZmZzZXRXaWR0aCxoZWlnaHQ6dGhpcy5lbGVtZW50WzBdLm9mZnNldEhlaWdodH19LHRoaXMuX2FkZFRvTWFuYWdlcihpLnNjb3BlKSxpLmFkZENsYXNzZXMmJnRoaXMuX2FkZENsYXNzKCJ1aS1kcm9wcGFibGUiKX0sX2FkZFRvTWFuYWdlcjpmdW5jdGlvbihlKXt0LnVpLmRkbWFuYWdlci5kcm9wcGFibGVzW2VdPXQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbZV18fFtdLHQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbZV0ucHVzaCh0aGlzKX0sX3NwbGljZTpmdW5jdGlvbih0KXtmb3IodmFyIGU9MDt0Lmxlbmd0aD5lO2UrKyl0W2VdPT09dGhpcyYmdC5zcGxpY2UoZSwxKX0sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXt2YXIgZT10LnVpLmRkbWFuYWdlci5kcm9wcGFibGVzW3RoaXMub3B0aW9ucy5zY29wZV07dGhpcy5fc3BsaWNlKGUpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKGUsaSl7aWYoImFjY2VwdCI9PT1lKXRoaXMuYWNjZXB0PXQuaXNGdW5jdGlvbihpKT9pOmZ1bmN0aW9uKHQpe3JldHVybiB0LmlzKGkpfTtlbHNlIGlmKCJzY29wZSI9PT1lKXt2YXIgcz10LnVpLmRkbWFuYWdlci5kcm9wcGFibGVzW3RoaXMub3B0aW9ucy5zY29wZV07dGhpcy5fc3BsaWNlKHMpLHRoaXMuX2FkZFRvTWFuYWdlcihpKX10aGlzLl9zdXBlcihlLGkpfSxfYWN0aXZhdGU6ZnVuY3Rpb24oZSl7dmFyIGk9dC51aS5kZG1hbmFnZXIuY3VycmVudDt0aGlzLl9hZGRBY3RpdmVDbGFzcygpLGkmJnRoaXMuX3RyaWdnZXIoImFjdGl2YXRlIixlLHRoaXMudWkoaSkpfSxfZGVhY3RpdmF0ZTpmdW5jdGlvbihlKXt2YXIgaT10LnVpLmRkbWFuYWdlci5jdXJyZW50O3RoaXMuX3JlbW92ZUFjdGl2ZUNsYXNzKCksaSYmdGhpcy5fdHJpZ2dlcigiZGVhY3RpdmF0ZSIsZSx0aGlzLnVpKGkpKX0sX292ZXI6ZnVuY3Rpb24oZSl7dmFyIGk9dC51aS5kZG1hbmFnZXIuY3VycmVudDtpJiYoaS5jdXJyZW50SXRlbXx8aS5lbGVtZW50KVswXSE9PXRoaXMuZWxlbWVudFswXSYmdGhpcy5hY2NlcHQuY2FsbCh0aGlzLmVsZW1lbnRbMF0saS5jdXJyZW50SXRlbXx8aS5lbGVtZW50KSYmKHRoaXMuX2FkZEhvdmVyQ2xhc3MoKSx0aGlzLl90cmlnZ2VyKCJvdmVyIixlLHRoaXMudWkoaSkpKX0sX291dDpmdW5jdGlvbihlKXt2YXIgaT10LnVpLmRkbWFuYWdlci5jdXJyZW50O2kmJihpLmN1cnJlbnRJdGVtfHxpLmVsZW1lbnQpWzBdIT09dGhpcy5lbGVtZW50WzBdJiZ0aGlzLmFjY2VwdC5jYWxsKHRoaXMuZWxlbWVudFswXSxpLmN1cnJlbnRJdGVtfHxpLmVsZW1lbnQpJiYodGhpcy5fcmVtb3ZlSG92ZXJDbGFzcygpLHRoaXMuX3RyaWdnZXIoIm91dCIsZSx0aGlzLnVpKGkpKSl9LF9kcm9wOmZ1bmN0aW9uKGUsaSl7dmFyIHM9aXx8dC51aS5kZG1hbmFnZXIuY3VycmVudCxuPSExO3JldHVybiBzJiYocy5jdXJyZW50SXRlbXx8cy5lbGVtZW50KVswXSE9PXRoaXMuZWxlbWVudFswXT8odGhpcy5lbGVtZW50LmZpbmQoIjpkYXRhKHVpLWRyb3BwYWJsZSkiKS5ub3QoIi51aS1kcmFnZ2FibGUtZHJhZ2dpbmciKS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGk9dCh0aGlzKS5kcm9wcGFibGUoImluc3RhbmNlIik7cmV0dXJuIGkub3B0aW9ucy5ncmVlZHkmJiFpLm9wdGlvbnMuZGlzYWJsZWQmJmkub3B0aW9ucy5zY29wZT09PXMub3B0aW9ucy5zY29wZSYmaS5hY2NlcHQuY2FsbChpLmVsZW1lbnRbMF0scy5jdXJyZW50SXRlbXx8cy5lbGVtZW50KSYmdihzLHQuZXh0ZW5kKGkse29mZnNldDppLmVsZW1lbnQub2Zmc2V0KCl9KSxpLm9wdGlvbnMudG9sZXJhbmNlLGUpPyhuPSEwLCExKTp2b2lkIDB9KSxuPyExOnRoaXMuYWNjZXB0LmNhbGwodGhpcy5lbGVtZW50WzBdLHMuY3VycmVudEl0ZW18fHMuZWxlbWVudCk/KHRoaXMuX3JlbW92ZUFjdGl2ZUNsYXNzKCksdGhpcy5fcmVtb3ZlSG92ZXJDbGFzcygpLHRoaXMuX3RyaWdnZXIoImRyb3AiLGUsdGhpcy51aShzKSksdGhpcy5lbGVtZW50KTohMSk6ITF9LHVpOmZ1bmN0aW9uKHQpe3JldHVybntkcmFnZ2FibGU6dC5jdXJyZW50SXRlbXx8dC5lbGVtZW50LGhlbHBlcjp0LmhlbHBlcixwb3NpdGlvbjp0LnBvc2l0aW9uLG9mZnNldDp0LnBvc2l0aW9uQWJzfX0sX2FkZEhvdmVyQ2xhc3M6ZnVuY3Rpb24oKXt0aGlzLl9hZGRDbGFzcygidWktZHJvcHBhYmxlLWhvdmVyIil9LF9yZW1vdmVIb3ZlckNsYXNzOmZ1bmN0aW9uKCl7dGhpcy5fcmVtb3ZlQ2xhc3MoInVpLWRyb3BwYWJsZS1ob3ZlciIpfSxfYWRkQWN0aXZlQ2xhc3M6ZnVuY3Rpb24oKXt0aGlzLl9hZGRDbGFzcygidWktZHJvcHBhYmxlLWFjdGl2ZSIpfSxfcmVtb3ZlQWN0aXZlQ2xhc3M6ZnVuY3Rpb24oKXt0aGlzLl9yZW1vdmVDbGFzcygidWktZHJvcHBhYmxlLWFjdGl2ZSIpfX0pO3ZhciB2PXQudWkuaW50ZXJzZWN0PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gdCh0LGUsaSl7cmV0dXJuIHQ+PWUmJmUraT50fXJldHVybiBmdW5jdGlvbihlLGkscyxuKXtpZighaS5vZmZzZXQpcmV0dXJuITE7dmFyIG89KGUucG9zaXRpb25BYnN8fGUucG9zaXRpb24uYWJzb2x1dGUpLmxlZnQrZS5tYXJnaW5zLmxlZnQsYT0oZS5wb3NpdGlvbkFic3x8ZS5wb3NpdGlvbi5hYnNvbHV0ZSkudG9wK2UubWFyZ2lucy50b3Ascj1vK2UuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgsaD1hK2UuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LGw9aS5vZmZzZXQubGVmdCxjPWkub2Zmc2V0LnRvcCx1PWwraS5wcm9wb3J0aW9ucygpLndpZHRoLGQ9YytpLnByb3BvcnRpb25zKCkuaGVpZ2h0O3N3aXRjaChzKXtjYXNlImZpdCI6cmV0dXJuIG8+PWwmJnU+PXImJmE+PWMmJmQ+PWg7Y2FzZSJpbnRlcnNlY3QiOnJldHVybiBvK2UuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgvMj5sJiZ1PnItZS5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC8yJiZhK2UuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LzI+YyYmZD5oLWUuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LzI7Y2FzZSJwb2ludGVyIjpyZXR1cm4gdChuLnBhZ2VZLGMsaS5wcm9wb3J0aW9ucygpLmhlaWdodCkmJnQobi5wYWdlWCxsLGkucHJvcG9ydGlvbnMoKS53aWR0aCk7Y2FzZSJ0b3VjaCI6cmV0dXJuKGE+PWMmJmQ+PWF8fGg+PWMmJmQ+PWh8fGM+YSYmaD5kKSYmKG8+PWwmJnU+PW98fHI+PWwmJnU+PXJ8fGw+byYmcj51KTtkZWZhdWx0OnJldHVybiExfX19KCk7dC51aS5kZG1hbmFnZXI9e2N1cnJlbnQ6bnVsbCxkcm9wcGFibGVzOnsiZGVmYXVsdCI6W119LHByZXBhcmVPZmZzZXRzOmZ1bmN0aW9uKGUsaSl7dmFyIHMsbixvPXQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbZS5vcHRpb25zLnNjb3BlXXx8W10sYT1pP2kudHlwZTpudWxsLHI9KGUuY3VycmVudEl0ZW18fGUuZWxlbWVudCkuZmluZCgiOmRhdGEodWktZHJvcHBhYmxlKSIpLmFkZEJhY2soKTt0OmZvcihzPTA7by5sZW5ndGg+cztzKyspaWYoIShvW3NdLm9wdGlvbnMuZGlzYWJsZWR8fGUmJiFvW3NdLmFjY2VwdC5jYWxsKG9bc10uZWxlbWVudFswXSxlLmN1cnJlbnRJdGVtfHxlLmVsZW1lbnQpKSl7Zm9yKG49MDtyLmxlbmd0aD5uO24rKylpZihyW25dPT09b1tzXS5lbGVtZW50WzBdKXtvW3NdLnByb3BvcnRpb25zKCkuaGVpZ2h0PTA7Y29udGludWUgdH1vW3NdLnZpc2libGU9Im5vbmUiIT09b1tzXS5lbGVtZW50LmNzcygiZGlzcGxheSIpLG9bc10udmlzaWJsZSYmKCJtb3VzZWRvd24iPT09YSYmb1tzXS5fYWN0aXZhdGUuY2FsbChvW3NdLGkpLG9bc10ub2Zmc2V0PW9bc10uZWxlbWVudC5vZmZzZXQoKSxvW3NdLnByb3BvcnRpb25zKHt3aWR0aDpvW3NdLmVsZW1lbnRbMF0ub2Zmc2V0V2lkdGgsaGVpZ2h0Om9bc10uZWxlbWVudFswXS5vZmZzZXRIZWlnaHR9KSl9fSxkcm9wOmZ1bmN0aW9uKGUsaSl7dmFyIHM9ITE7cmV0dXJuIHQuZWFjaCgodC51aS5kZG1hbmFnZXIuZHJvcHBhYmxlc1tlLm9wdGlvbnMuc2NvcGVdfHxbXSkuc2xpY2UoKSxmdW5jdGlvbigpe3RoaXMub3B0aW9ucyYmKCF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJnRoaXMudmlzaWJsZSYmdihlLHRoaXMsdGhpcy5vcHRpb25zLnRvbGVyYW5jZSxpKSYmKHM9dGhpcy5fZHJvcC5jYWxsKHRoaXMsaSl8fHMpLCF0aGlzLm9wdGlvbnMuZGlzYWJsZWQmJnRoaXMudmlzaWJsZSYmdGhpcy5hY2NlcHQuY2FsbCh0aGlzLmVsZW1lbnRbMF0sZS5jdXJyZW50SXRlbXx8ZS5lbGVtZW50KSYmKHRoaXMuaXNvdXQ9ITAsdGhpcy5pc292ZXI9ITEsdGhpcy5fZGVhY3RpdmF0ZS5jYWxsKHRoaXMsaSkpKX0pLHN9LGRyYWdTdGFydDpmdW5jdGlvbihlLGkpe2UuZWxlbWVudC5wYXJlbnRzVW50aWwoImJvZHkiKS5vbigic2Nyb2xsLmRyb3BwYWJsZSIsZnVuY3Rpb24oKXtlLm9wdGlvbnMucmVmcmVzaFBvc2l0aW9uc3x8dC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHMoZSxpKX0pfSxkcmFnOmZ1bmN0aW9uKGUsaSl7ZS5vcHRpb25zLnJlZnJlc2hQb3NpdGlvbnMmJnQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKGUsaSksdC5lYWNoKHQudWkuZGRtYW5hZ2VyLmRyb3BwYWJsZXNbZS5vcHRpb25zLnNjb3BlXXx8W10sZnVuY3Rpb24oKXtpZighdGhpcy5vcHRpb25zLmRpc2FibGVkJiYhdGhpcy5ncmVlZHlDaGlsZCYmdGhpcy52aXNpYmxlKXt2YXIgcyxuLG8sYT12KGUsdGhpcyx0aGlzLm9wdGlvbnMudG9sZXJhbmNlLGkpLHI9IWEmJnRoaXMuaXNvdmVyPyJpc291dCI6YSYmIXRoaXMuaXNvdmVyPyJpc292ZXIiOm51bGw7ciYmKHRoaXMub3B0aW9ucy5ncmVlZHkmJihuPXRoaXMub3B0aW9ucy5zY29wZSxvPXRoaXMuZWxlbWVudC5wYXJlbnRzKCI6ZGF0YSh1aS1kcm9wcGFibGUpIikuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHQodGhpcykuZHJvcHBhYmxlKCJpbnN0YW5jZSIpLm9wdGlvbnMuc2NvcGU9PT1ufSksby5sZW5ndGgmJihzPXQob1swXSkuZHJvcHBhYmxlKCJpbnN0YW5jZSIpLHMuZ3JlZWR5Q2hpbGQ9Imlzb3ZlciI9PT1yKSkscyYmImlzb3ZlciI9PT1yJiYocy5pc292ZXI9ITEscy5pc291dD0hMCxzLl9vdXQuY2FsbChzLGkpKSx0aGlzW3JdPSEwLHRoaXNbImlzb3V0Ij09PXI/Imlzb3ZlciI6Imlzb3V0Il09ITEsdGhpc1siaXNvdmVyIj09PXI/Il9vdmVyIjoiX291dCJdLmNhbGwodGhpcyxpKSxzJiYiaXNvdXQiPT09ciYmKHMuaXNvdXQ9ITEscy5pc292ZXI9ITAscy5fb3Zlci5jYWxsKHMsaSkpKX19KX0sZHJhZ1N0b3A6ZnVuY3Rpb24oZSxpKXtlLmVsZW1lbnQucGFyZW50c1VudGlsKCJib2R5Iikub2ZmKCJzY3JvbGwuZHJvcHBhYmxlIiksZS5vcHRpb25zLnJlZnJlc2hQb3NpdGlvbnN8fHQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKGUsaSl9fSx0LnVpQmFja0NvbXBhdCE9PSExJiZ0LndpZGdldCgidWkuZHJvcHBhYmxlIix0LnVpLmRyb3BwYWJsZSx7b3B0aW9uczp7aG92ZXJDbGFzczohMSxhY3RpdmVDbGFzczohMX0sX2FkZEFjdGl2ZUNsYXNzOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIoKSx0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MmJnRoaXMuZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYWN0aXZlQ2xhc3MpfSxfcmVtb3ZlQWN0aXZlQ2xhc3M6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlcigpLHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcyYmdGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hY3RpdmVDbGFzcyl9LF9hZGRIb3ZlckNsYXNzOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXIoKSx0aGlzLm9wdGlvbnMuaG92ZXJDbGFzcyYmdGhpcy5lbGVtZW50LmFkZENsYXNzKHRoaXMub3B0aW9ucy5ob3ZlckNsYXNzKX0sX3JlbW92ZUhvdmVyQ2xhc3M6ZnVuY3Rpb24oKXt0aGlzLl9zdXBlcigpLHRoaXMub3B0aW9ucy5ob3ZlckNsYXNzJiZ0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmhvdmVyQ2xhc3MpfX0pLHQudWkuZHJvcHBhYmxlLHQud2lkZ2V0KCJ1aS5wcm9ncmVzc2JhciIse3ZlcnNpb246IjEuMTIuMSIsb3B0aW9uczp7Y2xhc3Nlczp7InVpLXByb2dyZXNzYmFyIjoidWktY29ybmVyLWFsbCIsInVpLXByb2dyZXNzYmFyLXZhbHVlIjoidWktY29ybmVyLWxlZnQiLCJ1aS1wcm9ncmVzc2Jhci1jb21wbGV0ZSI6InVpLWNvcm5lci1yaWdodCJ9LG1heDoxMDAsdmFsdWU6MCxjaGFuZ2U6bnVsbCxjb21wbGV0ZTpudWxsfSxtaW46MCxfY3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5vbGRWYWx1ZT10aGlzLm9wdGlvbnMudmFsdWU9dGhpcy5fY29uc3RyYWluZWRWYWx1ZSgpLHRoaXMuZWxlbWVudC5hdHRyKHtyb2xlOiJwcm9ncmVzc2JhciIsImFyaWEtdmFsdWVtaW4iOnRoaXMubWlufSksdGhpcy5fYWRkQ2xhc3MoInVpLXByb2dyZXNzYmFyIiwidWktd2lkZ2V0IHVpLXdpZGdldC1jb250ZW50IiksdGhpcy52YWx1ZURpdj10KCI8ZGl2PiIpLmFwcGVuZFRvKHRoaXMuZWxlbWVudCksdGhpcy5fYWRkQ2xhc3ModGhpcy52YWx1ZURpdiwidWktcHJvZ3Jlc3NiYXItdmFsdWUiLCJ1aS13aWRnZXQtaGVhZGVyIiksdGhpcy5fcmVmcmVzaFZhbHVlKCl9LF9kZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LnJlbW92ZUF0dHIoInJvbGUgYXJpYS12YWx1ZW1pbiBhcmlhLXZhbHVlbWF4IGFyaWEtdmFsdWVub3ciKSx0aGlzLnZhbHVlRGl2LnJlbW92ZSgpfSx2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdm9pZCAwPT09dD90aGlzLm9wdGlvbnMudmFsdWU6KHRoaXMub3B0aW9ucy52YWx1ZT10aGlzLl9jb25zdHJhaW5lZFZhbHVlKHQpLHRoaXMuX3JlZnJlc2hWYWx1ZSgpLHZvaWQgMCl9LF9jb25zdHJhaW5lZFZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10JiYodD10aGlzLm9wdGlvbnMudmFsdWUpLHRoaXMuaW5kZXRlcm1pbmF0ZT10PT09ITEsIm51bWJlciIhPXR5cGVvZiB0JiYodD0wKSx0aGlzLmluZGV0ZXJtaW5hdGU/ITE6TWF0aC5taW4odGhpcy5vcHRpb25zLm1heCxNYXRoLm1heCh0aGlzLm1pbix0KSl9LF9zZXRPcHRpb25zOmZ1bmN0aW9uKHQpe3ZhciBlPXQudmFsdWU7ZGVsZXRlIHQudmFsdWUsdGhpcy5fc3VwZXIodCksdGhpcy5vcHRpb25zLnZhbHVlPXRoaXMuX2NvbnN0cmFpbmVkVmFsdWUoZSksdGhpcy5fcmVmcmVzaFZhbHVlKCl9LF9zZXRPcHRpb246ZnVuY3Rpb24odCxlKXsibWF4Ij09PXQmJihlPU1hdGgubWF4KHRoaXMubWluLGUpKSx0aGlzLl9zdXBlcih0LGUpfSxfc2V0T3B0aW9uRGlzYWJsZWQ6ZnVuY3Rpb24odCl7dGhpcy5fc3VwZXIodCksdGhpcy5lbGVtZW50LmF0dHIoImFyaWEtZGlzYWJsZWQiLHQpLHRoaXMuX3RvZ2dsZUNsYXNzKG51bGwsInVpLXN0YXRlLWRpc2FibGVkIiwhIXQpfSxfcGVyY2VudGFnZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluZGV0ZXJtaW5hdGU/MTAwOjEwMCoodGhpcy5vcHRpb25zLnZhbHVlLXRoaXMubWluKS8odGhpcy5vcHRpb25zLm1heC10aGlzLm1pbil9LF9yZWZyZXNoVmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9wdGlvbnMudmFsdWUsaT10aGlzLl9wZXJjZW50YWdlKCk7dGhpcy52YWx1ZURpdi50b2dnbGUodGhpcy5pbmRldGVybWluYXRlfHxlPnRoaXMubWluKS53aWR0aChpLnRvRml4ZWQoMCkrIiUiKSx0aGlzLl90b2dnbGVDbGFzcyh0aGlzLnZhbHVlRGl2LCJ1aS1wcm9ncmVzc2Jhci1jb21wbGV0ZSIsbnVsbCxlPT09dGhpcy5vcHRpb25zLm1heCkuX3RvZ2dsZUNsYXNzKCJ1aS1wcm9ncmVzc2Jhci1pbmRldGVybWluYXRlIixudWxsLHRoaXMuaW5kZXRlcm1pbmF0ZSksdGhpcy5pbmRldGVybWluYXRlPyh0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cigiYXJpYS12YWx1ZW5vdyIpLHRoaXMub3ZlcmxheURpdnx8KHRoaXMub3ZlcmxheURpdj10KCI8ZGl2PiIpLmFwcGVuZFRvKHRoaXMudmFsdWVEaXYpLHRoaXMuX2FkZENsYXNzKHRoaXMub3ZlcmxheURpdiwidWktcHJvZ3Jlc3NiYXItb3ZlcmxheSIpKSk6KHRoaXMuZWxlbWVudC5hdHRyKHsiYXJpYS12YWx1ZW1heCI6dGhpcy5vcHRpb25zLm1heCwiYXJpYS12YWx1ZW5vdyI6ZX0pLHRoaXMub3ZlcmxheURpdiYmKHRoaXMub3ZlcmxheURpdi5yZW1vdmUoKSx0aGlzLm92ZXJsYXlEaXY9bnVsbCkpLHRoaXMub2xkVmFsdWUhPT1lJiYodGhpcy5vbGRWYWx1ZT1lLHRoaXMuX3RyaWdnZXIoImNoYW5nZSIpKSxlPT09dGhpcy5vcHRpb25zLm1heCYmdGhpcy5fdHJpZ2dlcigiY29tcGxldGUiKX19KSx0LndpZGdldCgidWkuc2VsZWN0YWJsZSIsdC51aS5tb3VzZSx7dmVyc2lvbjoiMS4xMi4xIixvcHRpb25zOnthcHBlbmRUbzoiYm9keSIsYXV0b1JlZnJlc2g6ITAsZGlzdGFuY2U6MCxmaWx0ZXI6IioiLHRvbGVyYW5jZToidG91Y2giLHNlbGVjdGVkOm51bGwsc2VsZWN0aW5nOm51bGwsc3RhcnQ6bnVsbCxzdG9wOm51bGwsdW5zZWxlY3RlZDpudWxsLHVuc2VsZWN0aW5nOm51bGx9LF9jcmVhdGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMuX2FkZENsYXNzKCJ1aS1zZWxlY3RhYmxlIiksdGhpcy5kcmFnZ2VkPSExLHRoaXMucmVmcmVzaD1mdW5jdGlvbigpe2UuZWxlbWVudFBvcz10KGUuZWxlbWVudFswXSkub2Zmc2V0KCksZS5zZWxlY3RlZXM9dChlLm9wdGlvbnMuZmlsdGVyLGUuZWxlbWVudFswXSksZS5fYWRkQ2xhc3MoZS5zZWxlY3RlZXMsInVpLXNlbGVjdGVlIiksZS5zZWxlY3RlZXMuZWFjaChmdW5jdGlvbigpe3ZhciBpPXQodGhpcykscz1pLm9mZnNldCgpLG49e2xlZnQ6cy5sZWZ0LWUuZWxlbWVudFBvcy5sZWZ0LHRvcDpzLnRvcC1lLmVsZW1lbnRQb3MudG9wfTt0LmRhdGEodGhpcywic2VsZWN0YWJsZS1pdGVtIix7ZWxlbWVudDp0aGlzLCRlbGVtZW50OmksbGVmdDpuLmxlZnQsdG9wOm4udG9wLHJpZ2h0Om4ubGVmdCtpLm91dGVyV2lkdGgoKSxib3R0b206bi50b3AraS5vdXRlckhlaWdodCgpLHN0YXJ0c2VsZWN0ZWQ6ITEsc2VsZWN0ZWQ6aS5oYXNDbGFzcygidWktc2VsZWN0ZWQiKSxzZWxlY3Rpbmc6aS5oYXNDbGFzcygidWktc2VsZWN0aW5nIiksdW5zZWxlY3Rpbmc6aS5oYXNDbGFzcygidWktdW5zZWxlY3RpbmciKX0pfSl9LHRoaXMucmVmcmVzaCgpLHRoaXMuX21vdXNlSW5pdCgpLHRoaXMuaGVscGVyPXQoIjxkaXY+IiksdGhpcy5fYWRkQ2xhc3ModGhpcy5oZWxwZXIsInVpLXNlbGVjdGFibGUtaGVscGVyIil9LF9kZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5zZWxlY3RlZXMucmVtb3ZlRGF0YSgic2VsZWN0YWJsZS1pdGVtIiksdGhpcy5fbW91c2VEZXN0cm95KCl9LF9tb3VzZVN0YXJ0OmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMscz10aGlzLm9wdGlvbnM7dGhpcy5vcG9zPVtlLnBhZ2VYLGUucGFnZVldLHRoaXMuZWxlbWVudFBvcz10KHRoaXMuZWxlbWVudFswXSkub2Zmc2V0KCksdGhpcy5vcHRpb25zLmRpc2FibGVkfHwodGhpcy5zZWxlY3RlZXM9dChzLmZpbHRlcix0aGlzLmVsZW1lbnRbMF0pLHRoaXMuX3RyaWdnZXIoInN0YXJ0IixlKSx0KHMuYXBwZW5kVG8pLmFwcGVuZCh0aGlzLmhlbHBlciksdGhpcy5oZWxwZXIuY3NzKHtsZWZ0OmUucGFnZVgsdG9wOmUucGFnZVksd2lkdGg6MCxoZWlnaHQ6MH0pLHMuYXV0b1JlZnJlc2gmJnRoaXMucmVmcmVzaCgpLHRoaXMuc2VsZWN0ZWVzLmZpbHRlcigiLnVpLXNlbGVjdGVkIikuZWFjaChmdW5jdGlvbigpe3ZhciBzPXQuZGF0YSh0aGlzLCJzZWxlY3RhYmxlLWl0ZW0iKTtzLnN0YXJ0c2VsZWN0ZWQ9ITAsZS5tZXRhS2V5fHxlLmN0cmxLZXl8fChpLl9yZW1vdmVDbGFzcyhzLiRlbGVtZW50LCJ1aS1zZWxlY3RlZCIpLHMuc2VsZWN0ZWQ9ITEsaS5fYWRkQ2xhc3Mocy4kZWxlbWVudCwidWktdW5zZWxlY3RpbmciKSxzLnVuc2VsZWN0aW5nPSEwLGkuX3RyaWdnZXIoInVuc2VsZWN0aW5nIixlLHt1bnNlbGVjdGluZzpzLmVsZW1lbnR9KSl9KSx0KGUudGFyZ2V0KS5wYXJlbnRzKCkuYWRkQmFjaygpLmVhY2goZnVuY3Rpb24oKXt2YXIgcyxuPXQuZGF0YSh0aGlzLCJzZWxlY3RhYmxlLWl0ZW0iKTtyZXR1cm4gbj8ocz0hZS5tZXRhS2V5JiYhZS5jdHJsS2V5fHwhbi4kZWxlbWVudC5oYXNDbGFzcygidWktc2VsZWN0ZWQiKSxpLl9yZW1vdmVDbGFzcyhuLiRlbGVtZW50LHM/InVpLXVuc2VsZWN0aW5nIjoidWktc2VsZWN0ZWQiKS5fYWRkQ2xhc3Mobi4kZWxlbWVudCxzPyJ1aS1zZWxlY3RpbmciOiJ1aS11bnNlbGVjdGluZyIpLG4udW5zZWxlY3Rpbmc9IXMsbi5zZWxlY3Rpbmc9cyxuLnNlbGVjdGVkPXMscz9pLl90cmlnZ2VyKCJzZWxlY3RpbmciLGUse3NlbGVjdGluZzpuLmVsZW1lbnR9KTppLl90cmlnZ2VyKCJ1bnNlbGVjdGluZyIsZSx7dW5zZWxlY3Rpbmc6bi5lbGVtZW50fSksITEpOnZvaWQgMH0pKX0sX21vdXNlRHJhZzpmdW5jdGlvbihlKXtpZih0aGlzLmRyYWdnZWQ9ITAsIXRoaXMub3B0aW9ucy5kaXNhYmxlZCl7dmFyIGkscz10aGlzLG49dGhpcy5vcHRpb25zLG89dGhpcy5vcG9zWzBdLGE9dGhpcy5vcG9zWzFdLHI9ZS5wYWdlWCxoPWUucGFnZVk7cmV0dXJuIG8+ciYmKGk9cixyPW8sbz1pKSxhPmgmJihpPWgsaD1hLGE9aSksdGhpcy5oZWxwZXIuY3NzKHtsZWZ0Om8sdG9wOmEsd2lkdGg6ci1vLGhlaWdodDpoLWF9KSx0aGlzLnNlbGVjdGVlcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGk9dC5kYXRhKHRoaXMsInNlbGVjdGFibGUtaXRlbSIpLGw9ITEsYz17fTtpJiZpLmVsZW1lbnQhPT1zLmVsZW1lbnRbMF0mJihjLmxlZnQ9aS5sZWZ0K3MuZWxlbWVudFBvcy5sZWZ0LGMucmlnaHQ9aS5yaWdodCtzLmVsZW1lbnRQb3MubGVmdCxjLnRvcD1pLnRvcCtzLmVsZW1lbnRQb3MudG9wLGMuYm90dG9tPWkuYm90dG9tK3MuZWxlbWVudFBvcy50b3AsInRvdWNoIj09PW4udG9sZXJhbmNlP2w9IShjLmxlZnQ+cnx8bz5jLnJpZ2h0fHxjLnRvcD5ofHxhPmMuYm90dG9tKToiZml0Ij09PW4udG9sZXJhbmNlJiYobD1jLmxlZnQ+byYmcj5jLnJpZ2h0JiZjLnRvcD5hJiZoPmMuYm90dG9tKSxsPyhpLnNlbGVjdGVkJiYocy5fcmVtb3ZlQ2xhc3MoaS4kZWxlbWVudCwidWktc2VsZWN0ZWQiKSxpLnNlbGVjdGVkPSExKSxpLnVuc2VsZWN0aW5nJiYocy5fcmVtb3ZlQ2xhc3MoaS4kZWxlbWVudCwidWktdW5zZWxlY3RpbmciKSxpLnVuc2VsZWN0aW5nPSExKSxpLnNlbGVjdGluZ3x8KHMuX2FkZENsYXNzKGkuJGVsZW1lbnQsInVpLXNlbGVjdGluZyIpLGkuc2VsZWN0aW5nPSEwLHMuX3RyaWdnZXIoInNlbGVjdGluZyIsZSx7c2VsZWN0aW5nOmkuZWxlbWVudH0pKSk6KGkuc2VsZWN0aW5nJiYoKGUubWV0YUtleXx8ZS5jdHJsS2V5KSYmaS5zdGFydHNlbGVjdGVkPyhzLl9yZW1vdmVDbGFzcyhpLiRlbGVtZW50LCJ1aS1zZWxlY3RpbmciKSxpLnNlbGVjdGluZz0hMSxzLl9hZGRDbGFzcyhpLiRlbGVtZW50LCJ1aS1zZWxlY3RlZCIpLGkuc2VsZWN0ZWQ9ITApOihzLl9yZW1vdmVDbGFzcyhpLiRlbGVtZW50LCJ1aS1zZWxlY3RpbmciKSxpLnNlbGVjdGluZz0hMSxpLnN0YXJ0c2VsZWN0ZWQmJihzLl9hZGRDbGFzcyhpLiRlbGVtZW50LCJ1aS11bnNlbGVjdGluZyIpLGkudW5zZWxlY3Rpbmc9ITApLHMuX3RyaWdnZXIoInVuc2VsZWN0aW5nIixlLHt1bnNlbGVjdGluZzppLmVsZW1lbnR9KSkpLGkuc2VsZWN0ZWQmJihlLm1ldGFLZXl8fGUuY3RybEtleXx8aS5zdGFydHNlbGVjdGVkfHwocy5fcmVtb3ZlQ2xhc3MoaS4kZWxlbWVudCwidWktc2VsZWN0ZWQiKSxpLnNlbGVjdGVkPSExLHMuX2FkZENsYXNzKGkuJGVsZW1lbnQsInVpLXVuc2VsZWN0aW5nIiksaS51bnNlbGVjdGluZz0hMCxzLl90cmlnZ2VyKCJ1bnNlbGVjdGluZyIsZSx7dW5zZWxlY3Rpbmc6aS5lbGVtZW50fSkpKSkpfSksITF9fSxfbW91c2VTdG9wOmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXM7cmV0dXJuIHRoaXMuZHJhZ2dlZD0hMSx0KCIudWktdW5zZWxlY3RpbmciLHRoaXMuZWxlbWVudFswXSkuZWFjaChmdW5jdGlvbigpe3ZhciBzPXQuZGF0YSh0aGlzLCJzZWxlY3RhYmxlLWl0ZW0iKTtpLl9yZW1vdmVDbGFzcyhzLiRlbGVtZW50LCJ1aS11bnNlbGVjdGluZyIpLHMudW5zZWxlY3Rpbmc9ITEscy5zdGFydHNlbGVjdGVkPSExLGkuX3RyaWdnZXIoInVuc2VsZWN0ZWQiLGUse3Vuc2VsZWN0ZWQ6cy5lbGVtZW50fSl9KSx0KCIudWktc2VsZWN0aW5nIix0aGlzLmVsZW1lbnRbMF0pLmVhY2goZnVuY3Rpb24oKXt2YXIgcz10LmRhdGEodGhpcywic2VsZWN0YWJsZS1pdGVtIik7aS5fcmVtb3ZlQ2xhc3Mocy4kZWxlbWVudCwidWktc2VsZWN0aW5nIikuX2FkZENsYXNzKHMuJGVsZW1lbnQsInVpLXNlbGVjdGVkIikscy5zZWxlY3Rpbmc9ITEscy5zZWxlY3RlZD0hMCxzLnN0YXJ0c2VsZWN0ZWQ9ITAsaS5fdHJpZ2dlcigic2VsZWN0ZWQiLGUse3NlbGVjdGVkOnMuZWxlbWVudH0pfSksdGhpcy5fdHJpZ2dlcigic3RvcCIsZSksdGhpcy5oZWxwZXIucmVtb3ZlKCksITF9fSksdC53aWRnZXQoInVpLnNlbGVjdG1lbnUiLFt0LnVpLmZvcm1SZXNldE1peGluLHt2ZXJzaW9uOiIxLjEyLjEiLGRlZmF1bHRFbGVtZW50OiI8c2VsZWN0PiIsb3B0aW9uczp7YXBwZW5kVG86bnVsbCxjbGFzc2VzOnsidWktc2VsZWN0bWVudS1idXR0b24tb3BlbiI6InVpLWNvcm5lci10b3AiLCJ1aS1zZWxlY3RtZW51LWJ1dHRvbi1jbG9zZWQiOiJ1aS1jb3JuZXItYWxsIn0sZGlzYWJsZWQ6bnVsbCxpY29uczp7YnV0dG9uOiJ1aS1pY29uLXRyaWFuZ2xlLTEtcyJ9LHBvc2l0aW9uOntteToibGVmdCB0b3AiLGF0OiJsZWZ0IGJvdHRvbSIsY29sbGlzaW9uOiJub25lIn0sd2lkdGg6ITEsY2hhbmdlOm51bGwsY2xvc2U6bnVsbCxmb2N1czpudWxsLG9wZW46bnVsbCxzZWxlY3Q6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuZWxlbWVudC51bmlxdWVJZCgpLmF0dHIoImlkIik7dGhpcy5pZHM9e2VsZW1lbnQ6ZSxidXR0b246ZSsiLWJ1dHRvbiIsbWVudTplKyItbWVudSJ9LHRoaXMuX2RyYXdCdXR0b24oKSx0aGlzLl9kcmF3TWVudSgpLHRoaXMuX2JpbmRGb3JtUmVzZXRIYW5kbGVyKCksdGhpcy5fcmVuZGVyZWQ9ITEsdGhpcy5tZW51SXRlbXM9dCgpfSxfZHJhd0J1dHRvbjpmdW5jdGlvbigpe3ZhciBlLGk9dGhpcyxzPXRoaXMuX3BhcnNlT3B0aW9uKHRoaXMuZWxlbWVudC5maW5kKCJvcHRpb246c2VsZWN0ZWQiKSx0aGlzLmVsZW1lbnRbMF0uc2VsZWN0ZWRJbmRleCk7dGhpcy5sYWJlbHM9dGhpcy5lbGVtZW50LmxhYmVscygpLmF0dHIoImZvciIsdGhpcy5pZHMuYnV0dG9uKSx0aGlzLl9vbih0aGlzLmxhYmVscyx7Y2xpY2s6ZnVuY3Rpb24odCl7dGhpcy5idXR0b24uZm9jdXMoKSx0LnByZXZlbnREZWZhdWx0KCl9fSksdGhpcy5lbGVtZW50LmhpZGUoKSx0aGlzLmJ1dHRvbj10KCI8c3Bhbj4iLHt0YWJpbmRleDp0aGlzLm9wdGlvbnMuZGlzYWJsZWQ/LTE6MCxpZDp0aGlzLmlkcy5idXR0b24scm9sZToiY29tYm9ib3giLCJhcmlhLWV4cGFuZGVkIjoiZmFsc2UiLCJhcmlhLWF1dG9jb21wbGV0ZSI6Imxpc3QiLCJhcmlhLW93bnMiOnRoaXMuaWRzLm1lbnUsImFyaWEtaGFzcG9wdXAiOiJ0cnVlIix0aXRsZTp0aGlzLmVsZW1lbnQuYXR0cigidGl0bGUiKX0pLmluc2VydEFmdGVyKHRoaXMuZWxlbWVudCksdGhpcy5fYWRkQ2xhc3ModGhpcy5idXR0b24sInVpLXNlbGVjdG1lbnUtYnV0dG9uIHVpLXNlbGVjdG1lbnUtYnV0dG9uLWNsb3NlZCIsInVpLWJ1dHRvbiB1aS13aWRnZXQiKSxlPXQoIjxzcGFuPiIpLmFwcGVuZFRvKHRoaXMuYnV0dG9uKSx0aGlzLl9hZGRDbGFzcyhlLCJ1aS1zZWxlY3RtZW51LWljb24iLCJ1aS1pY29uICIrdGhpcy5vcHRpb25zLmljb25zLmJ1dHRvbiksdGhpcy5idXR0b25JdGVtPXRoaXMuX3JlbmRlckJ1dHRvbkl0ZW0ocykuYXBwZW5kVG8odGhpcy5idXR0b24pLHRoaXMub3B0aW9ucy53aWR0aCE9PSExJiZ0aGlzLl9yZXNpemVCdXR0b24oKSx0aGlzLl9vbih0aGlzLmJ1dHRvbix0aGlzLl9idXR0b25FdmVudHMpLHRoaXMuYnV0dG9uLm9uZSgiZm9jdXNpbiIsZnVuY3Rpb24oKXtpLl9yZW5kZXJlZHx8aS5fcmVmcmVzaE1lbnUoKX0pfSxfZHJhd01lbnU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3RoaXMubWVudT10KCI8dWw+Iix7ImFyaWEtaGlkZGVuIjoidHJ1ZSIsImFyaWEtbGFiZWxsZWRieSI6dGhpcy5pZHMuYnV0dG9uLGlkOnRoaXMuaWRzLm1lbnV9KSx0aGlzLm1lbnVXcmFwPXQoIjxkaXY+IikuYXBwZW5kKHRoaXMubWVudSksdGhpcy5fYWRkQ2xhc3ModGhpcy5tZW51V3JhcCwidWktc2VsZWN0bWVudS1tZW51IiwidWktZnJvbnQiKSx0aGlzLm1lbnVXcmFwLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLHRoaXMubWVudUluc3RhbmNlPXRoaXMubWVudS5tZW51KHtjbGFzc2VzOnsidWktbWVudSI6InVpLWNvcm5lci1ib3R0b20ifSxyb2xlOiJsaXN0Ym94IixzZWxlY3Q6ZnVuY3Rpb24odCxpKXt0LnByZXZlbnREZWZhdWx0KCksZS5fc2V0U2VsZWN0aW9uKCksZS5fc2VsZWN0KGkuaXRlbS5kYXRhKCJ1aS1zZWxlY3RtZW51LWl0ZW0iKSx0KX0sZm9jdXM6ZnVuY3Rpb24odCxpKXt2YXIgcz1pLml0ZW0uZGF0YSgidWktc2VsZWN0bWVudS1pdGVtIik7bnVsbCE9ZS5mb2N1c0luZGV4JiZzLmluZGV4IT09ZS5mb2N1c0luZGV4JiYoZS5fdHJpZ2dlcigiZm9jdXMiLHQse2l0ZW06c30pLGUuaXNPcGVufHxlLl9zZWxlY3Qocyx0KSksZS5mb2N1c0luZGV4PXMuaW5kZXgsZS5idXR0b24uYXR0cigiYXJpYS1hY3RpdmVkZXNjZW5kYW50IixlLm1lbnVJdGVtcy5lcShzLmluZGV4KS5hdHRyKCJpZCIpKX19KS5tZW51KCJpbnN0YW5jZSIpLHRoaXMubWVudUluc3RhbmNlLl9vZmYodGhpcy5tZW51LCJtb3VzZWxlYXZlIiksdGhpcy5tZW51SW5zdGFuY2UuX2Nsb3NlT25Eb2N1bWVudENsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuITF9LHRoaXMubWVudUluc3RhbmNlLl9pc0RpdmlkZXI9ZnVuY3Rpb24oKXtyZXR1cm4hMX19LHJlZnJlc2g6ZnVuY3Rpb24oKXt0aGlzLl9yZWZyZXNoTWVudSgpLHRoaXMuYnV0dG9uSXRlbS5yZXBsYWNlV2l0aCh0aGlzLmJ1dHRvbkl0ZW09dGhpcy5fcmVuZGVyQnV0dG9uSXRlbSh0aGlzLl9nZXRTZWxlY3RlZEl0ZW0oKS5kYXRhKCJ1aS1zZWxlY3RtZW51LWl0ZW0iKXx8e30pKSxudWxsPT09dGhpcy5vcHRpb25zLndpZHRoJiZ0aGlzLl9yZXNpemVCdXR0b24oKX0sX3JlZnJlc2hNZW51OmZ1bmN0aW9uKCl7dmFyIHQsZT10aGlzLmVsZW1lbnQuZmluZCgib3B0aW9uIik7dGhpcy5tZW51LmVtcHR5KCksdGhpcy5fcGFyc2VPcHRpb25zKGUpLHRoaXMuX3JlbmRlck1lbnUodGhpcy5tZW51LHRoaXMuaXRlbXMpLHRoaXMubWVudUluc3RhbmNlLnJlZnJlc2goKSx0aGlzLm1lbnVJdGVtcz10aGlzLm1lbnUuZmluZCgibGkiKS5ub3QoIi51aS1zZWxlY3RtZW51LW9wdGdyb3VwIikuZmluZCgiLnVpLW1lbnUtaXRlbS13cmFwcGVyIiksdGhpcy5fcmVuZGVyZWQ9ITAsZS5sZW5ndGgmJih0PXRoaXMuX2dldFNlbGVjdGVkSXRlbSgpLHRoaXMubWVudUluc3RhbmNlLmZvY3VzKG51bGwsdCksdGhpcy5fc2V0QXJpYSh0LmRhdGEoInVpLXNlbGVjdG1lbnUtaXRlbSIpKSx0aGlzLl9zZXRPcHRpb24oImRpc2FibGVkIix0aGlzLmVsZW1lbnQucHJvcCgiZGlzYWJsZWQiKSkpfSxvcGVuOmZ1bmN0aW9uKHQpe3RoaXMub3B0aW9ucy5kaXNhYmxlZHx8KHRoaXMuX3JlbmRlcmVkPyh0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLm1lbnUuZmluZCgiLnVpLXN0YXRlLWFjdGl2ZSIpLG51bGwsInVpLXN0YXRlLWFjdGl2ZSIpLHRoaXMubWVudUluc3RhbmNlLmZvY3VzKG51bGwsdGhpcy5fZ2V0U2VsZWN0ZWRJdGVtKCkpKTp0aGlzLl9yZWZyZXNoTWVudSgpLHRoaXMubWVudUl0ZW1zLmxlbmd0aCYmKHRoaXMuaXNPcGVuPSEwLHRoaXMuX3RvZ2dsZUF0dHIoKSx0aGlzLl9yZXNpemVNZW51KCksdGhpcy5fcG9zaXRpb24oKSx0aGlzLl9vbih0aGlzLmRvY3VtZW50LHRoaXMuX2RvY3VtZW50Q2xpY2spLHRoaXMuX3RyaWdnZXIoIm9wZW4iLHQpKSl9LF9wb3NpdGlvbjpmdW5jdGlvbigpe3RoaXMubWVudVdyYXAucG9zaXRpb24odC5leHRlbmQoe29mOnRoaXMuYnV0dG9ufSx0aGlzLm9wdGlvbnMucG9zaXRpb24pKX0sY2xvc2U6ZnVuY3Rpb24odCl7dGhpcy5pc09wZW4mJih0aGlzLmlzT3Blbj0hMSx0aGlzLl90b2dnbGVBdHRyKCksdGhpcy5yYW5nZT1udWxsLHRoaXMuX29mZih0aGlzLmRvY3VtZW50KSx0aGlzLl90cmlnZ2VyKCJjbG9zZSIsdCkpfSx3aWRnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5idXR0b259LG1lbnVXaWRnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tZW51fSxfcmVuZGVyQnV0dG9uSXRlbTpmdW5jdGlvbihlKXt2YXIgaT10KCI8c3Bhbj4iKTtyZXR1cm4gdGhpcy5fc2V0VGV4dChpLGUubGFiZWwpLHRoaXMuX2FkZENsYXNzKGksInVpLXNlbGVjdG1lbnUtdGV4dCIpLGl9LF9yZW5kZXJNZW51OmZ1bmN0aW9uKGUsaSl7dmFyIHM9dGhpcyxuPSIiO3QuZWFjaChpLGZ1bmN0aW9uKGksbyl7dmFyIGE7by5vcHRncm91cCE9PW4mJihhPXQoIjxsaT4iLHt0ZXh0Om8ub3B0Z3JvdXB9KSxzLl9hZGRDbGFzcyhhLCJ1aS1zZWxlY3RtZW51LW9wdGdyb3VwIiwidWktbWVudS1kaXZpZGVyIisoby5lbGVtZW50LnBhcmVudCgib3B0Z3JvdXAiKS5wcm9wKCJkaXNhYmxlZCIpPyIgdWktc3RhdGUtZGlzYWJsZWQiOiIiKSksYS5hcHBlbmRUbyhlKSxuPW8ub3B0Z3JvdXApLHMuX3JlbmRlckl0ZW1EYXRhKGUsbyl9KX0sX3JlbmRlckl0ZW1EYXRhOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMuX3JlbmRlckl0ZW0odCxlKS5kYXRhKCJ1aS1zZWxlY3RtZW51LWl0ZW0iLGUpfSxfcmVuZGVySXRlbTpmdW5jdGlvbihlLGkpe3ZhciBzPXQoIjxsaT4iKSxuPXQoIjxkaXY+Iix7dGl0bGU6aS5lbGVtZW50LmF0dHIoInRpdGxlIil9KTtyZXR1cm4gaS5kaXNhYmxlZCYmdGhpcy5fYWRkQ2xhc3MocyxudWxsLCJ1aS1zdGF0ZS1kaXNhYmxlZCIpLHRoaXMuX3NldFRleHQobixpLmxhYmVsKSxzLmFwcGVuZChuKS5hcHBlbmRUbyhlKX0sX3NldFRleHQ6ZnVuY3Rpb24odCxlKXtlP3QudGV4dChlKTp0Lmh0bWwoIiYjMTYwOyIpfSxfbW92ZTpmdW5jdGlvbih0LGUpe3ZhciBpLHMsbj0iLnVpLW1lbnUtaXRlbSI7dGhpcy5pc09wZW4/aT10aGlzLm1lbnVJdGVtcy5lcSh0aGlzLmZvY3VzSW5kZXgpLnBhcmVudCgibGkiKTooaT10aGlzLm1lbnVJdGVtcy5lcSh0aGlzLmVsZW1lbnRbMF0uc2VsZWN0ZWRJbmRleCkucGFyZW50KCJsaSIpLG4rPSI6bm90KC51aS1zdGF0ZS1kaXNhYmxlZCkiKSxzPSJmaXJzdCI9PT10fHwibGFzdCI9PT10P2lbImZpcnN0Ij09PXQ/InByZXZBbGwiOiJuZXh0QWxsIl0obikuZXEoLTEpOmlbdCsiQWxsIl0obikuZXEoMCkscy5sZW5ndGgmJnRoaXMubWVudUluc3RhbmNlLmZvY3VzKGUscyl9LF9nZXRTZWxlY3RlZEl0ZW06ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tZW51SXRlbXMuZXEodGhpcy5lbGVtZW50WzBdLnNlbGVjdGVkSW5kZXgpLnBhcmVudCgibGkiKX0sX3RvZ2dsZTpmdW5jdGlvbih0KXt0aGlzW3RoaXMuaXNPcGVuPyJjbG9zZSI6Im9wZW4iXSh0KX0sX3NldFNlbGVjdGlvbjpmdW5jdGlvbigpe3ZhciB0O3RoaXMucmFuZ2UmJih3aW5kb3cuZ2V0U2VsZWN0aW9uPyh0PXdpbmRvdy5nZXRTZWxlY3Rpb24oKSx0LnJlbW92ZUFsbFJhbmdlcygpLHQuYWRkUmFuZ2UodGhpcy5yYW5nZSkpOnRoaXMucmFuZ2Uuc2VsZWN0KCksdGhpcy5idXR0b24uZm9jdXMoKSl9LF9kb2N1bWVudENsaWNrOnttb3VzZWRvd246ZnVuY3Rpb24oZSl7dGhpcy5pc09wZW4mJih0KGUudGFyZ2V0KS5jbG9zZXN0KCIudWktc2VsZWN0bWVudS1tZW51LCAjIit0LnVpLmVzY2FwZVNlbGVjdG9yKHRoaXMuaWRzLmJ1dHRvbikpLmxlbmd0aHx8dGhpcy5jbG9zZShlKSl9fSxfYnV0dG9uRXZlbnRzOnttb3VzZWRvd246ZnVuY3Rpb24oKXt2YXIgdDt3aW5kb3cuZ2V0U2VsZWN0aW9uPyh0PXdpbmRvdy5nZXRTZWxlY3Rpb24oKSx0LnJhbmdlQ291bnQmJih0aGlzLnJhbmdlPXQuZ2V0UmFuZ2VBdCgwKSkpOnRoaXMucmFuZ2U9ZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCl9LGNsaWNrOmZ1bmN0aW9uKHQpe3RoaXMuX3NldFNlbGVjdGlvbigpLHRoaXMuX3RvZ2dsZSh0KX0sa2V5ZG93bjpmdW5jdGlvbihlKXt2YXIgaT0hMDtzd2l0Y2goZS5rZXlDb2RlKXtjYXNlIHQudWkua2V5Q29kZS5UQUI6Y2FzZSB0LnVpLmtleUNvZGUuRVNDQVBFOnRoaXMuY2xvc2UoZSksaT0hMTticmVhaztjYXNlIHQudWkua2V5Q29kZS5FTlRFUjp0aGlzLmlzT3BlbiYmdGhpcy5fc2VsZWN0Rm9jdXNlZEl0ZW0oZSk7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuVVA6ZS5hbHRLZXk/dGhpcy5fdG9nZ2xlKGUpOnRoaXMuX21vdmUoInByZXYiLGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLkRPV046ZS5hbHRLZXk/dGhpcy5fdG9nZ2xlKGUpOnRoaXMuX21vdmUoIm5leHQiLGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLlNQQUNFOnRoaXMuaXNPcGVuP3RoaXMuX3NlbGVjdEZvY3VzZWRJdGVtKGUpOnRoaXMuX3RvZ2dsZShlKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5MRUZUOnRoaXMuX21vdmUoInByZXYiLGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLlJJR0hUOnRoaXMuX21vdmUoIm5leHQiLGUpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLkhPTUU6Y2FzZSB0LnVpLmtleUNvZGUuUEFHRV9VUDp0aGlzLl9tb3ZlKCJmaXJzdCIsZSk7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuRU5EOmNhc2UgdC51aS5rZXlDb2RlLlBBR0VfRE9XTjp0aGlzLl9tb3ZlKCJsYXN0IixlKTticmVhaztkZWZhdWx0OnRoaXMubWVudS50cmlnZ2VyKGUpLGk9ITF9aSYmZS5wcmV2ZW50RGVmYXVsdCgpfX0sX3NlbGVjdEZvY3VzZWRJdGVtOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMubWVudUl0ZW1zLmVxKHRoaXMuZm9jdXNJbmRleCkucGFyZW50KCJsaSIpO2UuaGFzQ2xhc3MoInVpLXN0YXRlLWRpc2FibGVkIil8fHRoaXMuX3NlbGVjdChlLmRhdGEoInVpLXNlbGVjdG1lbnUtaXRlbSIpLHQpfSxfc2VsZWN0OmZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5lbGVtZW50WzBdLnNlbGVjdGVkSW5kZXg7dGhpcy5lbGVtZW50WzBdLnNlbGVjdGVkSW5kZXg9dC5pbmRleCx0aGlzLmJ1dHRvbkl0ZW0ucmVwbGFjZVdpdGgodGhpcy5idXR0b25JdGVtPXRoaXMuX3JlbmRlckJ1dHRvbkl0ZW0odCkpLHRoaXMuX3NldEFyaWEodCksdGhpcy5fdHJpZ2dlcigic2VsZWN0IixlLHtpdGVtOnR9KSx0LmluZGV4IT09aSYmdGhpcy5fdHJpZ2dlcigiY2hhbmdlIixlLHtpdGVtOnR9KSx0aGlzLmNsb3NlKGUpfSxfc2V0QXJpYTpmdW5jdGlvbih0KXt2YXIgZT10aGlzLm1lbnVJdGVtcy5lcSh0LmluZGV4KS5hdHRyKCJpZCIpO3RoaXMuYnV0dG9uLmF0dHIoeyJhcmlhLWxhYmVsbGVkYnkiOmUsImFyaWEtYWN0aXZlZGVzY2VuZGFudCI6ZX0pLHRoaXMubWVudS5hdHRyKCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnQiLGUpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKHQsZSl7aWYoImljb25zIj09PXQpe3ZhciBpPXRoaXMuYnV0dG9uLmZpbmQoInNwYW4udWktaWNvbiIpO3RoaXMuX3JlbW92ZUNsYXNzKGksbnVsbCx0aGlzLm9wdGlvbnMuaWNvbnMuYnV0dG9uKS5fYWRkQ2xhc3MoaSxudWxsLGUuYnV0dG9uKX10aGlzLl9zdXBlcih0LGUpLCJhcHBlbmRUbyI9PT10JiZ0aGlzLm1lbnVXcmFwLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKCkpLCJ3aWR0aCI9PT10JiZ0aGlzLl9yZXNpemVCdXR0b24oKX0sX3NldE9wdGlvbkRpc2FibGVkOmZ1bmN0aW9uKHQpe3RoaXMuX3N1cGVyKHQpLHRoaXMubWVudUluc3RhbmNlLm9wdGlvbigiZGlzYWJsZWQiLHQpLHRoaXMuYnV0dG9uLmF0dHIoImFyaWEtZGlzYWJsZWQiLHQpLHRoaXMuX3RvZ2dsZUNsYXNzKHRoaXMuYnV0dG9uLG51bGwsInVpLXN0YXRlLWRpc2FibGVkIix0KSx0aGlzLmVsZW1lbnQucHJvcCgiZGlzYWJsZWQiLHQpLHQ/KHRoaXMuYnV0dG9uLmF0dHIoInRhYmluZGV4IiwtMSksdGhpcy5jbG9zZSgpKTp0aGlzLmJ1dHRvbi5hdHRyKCJ0YWJpbmRleCIsMCl9LF9hcHBlbmRUbzpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3B0aW9ucy5hcHBlbmRUbztyZXR1cm4gZSYmKGU9ZS5qcXVlcnl8fGUubm9kZVR5cGU/dChlKTp0aGlzLmRvY3VtZW50LmZpbmQoZSkuZXEoMCkpLGUmJmVbMF18fChlPXRoaXMuZWxlbWVudC5jbG9zZXN0KCIudWktZnJvbnQsIGRpYWxvZyIpKSxlLmxlbmd0aHx8KGU9dGhpcy5kb2N1bWVudFswXS5ib2R5KSxlfSxfdG9nZ2xlQXR0cjpmdW5jdGlvbigpe3RoaXMuYnV0dG9uLmF0dHIoImFyaWEtZXhwYW5kZWQiLHRoaXMuaXNPcGVuKSx0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLmJ1dHRvbiwidWktc2VsZWN0bWVudS1idXR0b24tIisodGhpcy5pc09wZW4/ImNsb3NlZCI6Im9wZW4iKSkuX2FkZENsYXNzKHRoaXMuYnV0dG9uLCJ1aS1zZWxlY3RtZW51LWJ1dHRvbi0iKyh0aGlzLmlzT3Blbj8ib3BlbiI6ImNsb3NlZCIpKS5fdG9nZ2xlQ2xhc3ModGhpcy5tZW51V3JhcCwidWktc2VsZWN0bWVudS1vcGVuIixudWxsLHRoaXMuaXNPcGVuKSx0aGlzLm1lbnUuYXR0cigiYXJpYS1oaWRkZW4iLCF0aGlzLmlzT3Blbil9LF9yZXNpemVCdXR0b246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMud2lkdGg7cmV0dXJuIHQ9PT0hMT8odGhpcy5idXR0b24uY3NzKCJ3aWR0aCIsIiIpLHZvaWQgMCk6KG51bGw9PT10JiYodD10aGlzLmVsZW1lbnQuc2hvdygpLm91dGVyV2lkdGgoKSx0aGlzLmVsZW1lbnQuaGlkZSgpKSx0aGlzLmJ1dHRvbi5vdXRlcldpZHRoKHQpLHZvaWQgMCl9LF9yZXNpemVNZW51OmZ1bmN0aW9uKCl7dGhpcy5tZW51Lm91dGVyV2lkdGgoTWF0aC5tYXgodGhpcy5idXR0b24ub3V0ZXJXaWR0aCgpLHRoaXMubWVudS53aWR0aCgiIikub3V0ZXJXaWR0aCgpKzEpKX0sX2dldENyZWF0ZU9wdGlvbnM6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9zdXBlcigpO3JldHVybiB0LmRpc2FibGVkPXRoaXMuZWxlbWVudC5wcm9wKCJkaXNhYmxlZCIpLHR9LF9wYXJzZU9wdGlvbnM6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcyxzPVtdO2UuZWFjaChmdW5jdGlvbihlLG4pe3MucHVzaChpLl9wYXJzZU9wdGlvbih0KG4pLGUpKX0pLHRoaXMuaXRlbXM9c30sX3BhcnNlT3B0aW9uOmZ1bmN0aW9uKHQsZSl7dmFyIGk9dC5wYXJlbnQoIm9wdGdyb3VwIik7cmV0dXJue2VsZW1lbnQ6dCxpbmRleDplLHZhbHVlOnQudmFsKCksbGFiZWw6dC50ZXh0KCksb3B0Z3JvdXA6aS5hdHRyKCJsYWJlbCIpfHwiIixkaXNhYmxlZDppLnByb3AoImRpc2FibGVkIil8fHQucHJvcCgiZGlzYWJsZWQiKX19LF9kZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5fdW5iaW5kRm9ybVJlc2V0SGFuZGxlcigpLHRoaXMubWVudVdyYXAucmVtb3ZlKCksdGhpcy5idXR0b24ucmVtb3ZlKCksdGhpcy5lbGVtZW50LnNob3coKSx0aGlzLmVsZW1lbnQucmVtb3ZlVW5pcXVlSWQoKSx0aGlzLmxhYmVscy5hdHRyKCJmb3IiLHRoaXMuaWRzLmVsZW1lbnQpfX1dKSx0LndpZGdldCgidWkuc2xpZGVyIix0LnVpLm1vdXNlLHt2ZXJzaW9uOiIxLjEyLjEiLHdpZGdldEV2ZW50UHJlZml4OiJzbGlkZSIsb3B0aW9uczp7YW5pbWF0ZTohMSxjbGFzc2VzOnsidWktc2xpZGVyIjoidWktY29ybmVyLWFsbCIsInVpLXNsaWRlci1oYW5kbGUiOiJ1aS1jb3JuZXItYWxsIiwidWktc2xpZGVyLXJhbmdlIjoidWktY29ybmVyLWFsbCB1aS13aWRnZXQtaGVhZGVyIn0sZGlzdGFuY2U6MCxtYXg6MTAwLG1pbjowLG9yaWVudGF0aW9uOiJob3Jpem9udGFsIixyYW5nZTohMSxzdGVwOjEsdmFsdWU6MCx2YWx1ZXM6bnVsbCxjaGFuZ2U6bnVsbCxzbGlkZTpudWxsLHN0YXJ0Om51bGwsc3RvcDpudWxsfSxudW1QYWdlczo1LF9jcmVhdGU6ZnVuY3Rpb24oKXt0aGlzLl9rZXlTbGlkaW5nPSExLHRoaXMuX21vdXNlU2xpZGluZz0hMSx0aGlzLl9hbmltYXRlT2ZmPSEwLHRoaXMuX2hhbmRsZUluZGV4PW51bGwsdGhpcy5fZGV0ZWN0T3JpZW50YXRpb24oKSx0aGlzLl9tb3VzZUluaXQoKSx0aGlzLl9jYWxjdWxhdGVOZXdNYXgoKSx0aGlzLl9hZGRDbGFzcygidWktc2xpZGVyIHVpLXNsaWRlci0iK3RoaXMub3JpZW50YXRpb24sInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCIpLHRoaXMuX3JlZnJlc2goKSx0aGlzLl9hbmltYXRlT2ZmPSExCn0sX3JlZnJlc2g6ZnVuY3Rpb24oKXt0aGlzLl9jcmVhdGVSYW5nZSgpLHRoaXMuX2NyZWF0ZUhhbmRsZXMoKSx0aGlzLl9zZXR1cEV2ZW50cygpLHRoaXMuX3JlZnJlc2hWYWx1ZSgpfSxfY3JlYXRlSGFuZGxlczpmdW5jdGlvbigpe3ZhciBlLGkscz10aGlzLm9wdGlvbnMsbj10aGlzLmVsZW1lbnQuZmluZCgiLnVpLXNsaWRlci1oYW5kbGUiKSxvPSI8c3BhbiB0YWJpbmRleD0nMCc+PC9zcGFuPiIsYT1bXTtmb3IoaT1zLnZhbHVlcyYmcy52YWx1ZXMubGVuZ3RofHwxLG4ubGVuZ3RoPmkmJihuLnNsaWNlKGkpLnJlbW92ZSgpLG49bi5zbGljZSgwLGkpKSxlPW4ubGVuZ3RoO2k+ZTtlKyspYS5wdXNoKG8pO3RoaXMuaGFuZGxlcz1uLmFkZCh0KGEuam9pbigiIikpLmFwcGVuZFRvKHRoaXMuZWxlbWVudCkpLHRoaXMuX2FkZENsYXNzKHRoaXMuaGFuZGxlcywidWktc2xpZGVyLWhhbmRsZSIsInVpLXN0YXRlLWRlZmF1bHQiKSx0aGlzLmhhbmRsZT10aGlzLmhhbmRsZXMuZXEoMCksdGhpcy5oYW5kbGVzLmVhY2goZnVuY3Rpb24oZSl7dCh0aGlzKS5kYXRhKCJ1aS1zbGlkZXItaGFuZGxlLWluZGV4IixlKS5hdHRyKCJ0YWJJbmRleCIsMCl9KX0sX2NyZWF0ZVJhbmdlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zO2UucmFuZ2U/KGUucmFuZ2U9PT0hMCYmKGUudmFsdWVzP2UudmFsdWVzLmxlbmd0aCYmMiE9PWUudmFsdWVzLmxlbmd0aD9lLnZhbHVlcz1bZS52YWx1ZXNbMF0sZS52YWx1ZXNbMF1dOnQuaXNBcnJheShlLnZhbHVlcykmJihlLnZhbHVlcz1lLnZhbHVlcy5zbGljZSgwKSk6ZS52YWx1ZXM9W3RoaXMuX3ZhbHVlTWluKCksdGhpcy5fdmFsdWVNaW4oKV0pLHRoaXMucmFuZ2UmJnRoaXMucmFuZ2UubGVuZ3RoPyh0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLnJhbmdlLCJ1aS1zbGlkZXItcmFuZ2UtbWluIHVpLXNsaWRlci1yYW5nZS1tYXgiKSx0aGlzLnJhbmdlLmNzcyh7bGVmdDoiIixib3R0b206IiJ9KSk6KHRoaXMucmFuZ2U9dCgiPGRpdj4iKS5hcHBlbmRUbyh0aGlzLmVsZW1lbnQpLHRoaXMuX2FkZENsYXNzKHRoaXMucmFuZ2UsInVpLXNsaWRlci1yYW5nZSIpKSwoIm1pbiI9PT1lLnJhbmdlfHwibWF4Ij09PWUucmFuZ2UpJiZ0aGlzLl9hZGRDbGFzcyh0aGlzLnJhbmdlLCJ1aS1zbGlkZXItcmFuZ2UtIitlLnJhbmdlKSk6KHRoaXMucmFuZ2UmJnRoaXMucmFuZ2UucmVtb3ZlKCksdGhpcy5yYW5nZT1udWxsKX0sX3NldHVwRXZlbnRzOmZ1bmN0aW9uKCl7dGhpcy5fb2ZmKHRoaXMuaGFuZGxlcyksdGhpcy5fb24odGhpcy5oYW5kbGVzLHRoaXMuX2hhbmRsZUV2ZW50cyksdGhpcy5faG92ZXJhYmxlKHRoaXMuaGFuZGxlcyksdGhpcy5fZm9jdXNhYmxlKHRoaXMuaGFuZGxlcyl9LF9kZXN0cm95OmZ1bmN0aW9uKCl7dGhpcy5oYW5kbGVzLnJlbW92ZSgpLHRoaXMucmFuZ2UmJnRoaXMucmFuZ2UucmVtb3ZlKCksdGhpcy5fbW91c2VEZXN0cm95KCl9LF9tb3VzZUNhcHR1cmU6ZnVuY3Rpb24oZSl7dmFyIGkscyxuLG8sYSxyLGgsbCxjPXRoaXMsdT10aGlzLm9wdGlvbnM7cmV0dXJuIHUuZGlzYWJsZWQ/ITE6KHRoaXMuZWxlbWVudFNpemU9e3dpZHRoOnRoaXMuZWxlbWVudC5vdXRlcldpZHRoKCksaGVpZ2h0OnRoaXMuZWxlbWVudC5vdXRlckhlaWdodCgpfSx0aGlzLmVsZW1lbnRPZmZzZXQ9dGhpcy5lbGVtZW50Lm9mZnNldCgpLGk9e3g6ZS5wYWdlWCx5OmUucGFnZVl9LHM9dGhpcy5fbm9ybVZhbHVlRnJvbU1vdXNlKGkpLG49dGhpcy5fdmFsdWVNYXgoKS10aGlzLl92YWx1ZU1pbigpKzEsdGhpcy5oYW5kbGVzLmVhY2goZnVuY3Rpb24oZSl7dmFyIGk9TWF0aC5hYnMocy1jLnZhbHVlcyhlKSk7KG4+aXx8bj09PWkmJihlPT09Yy5fbGFzdENoYW5nZWRWYWx1ZXx8Yy52YWx1ZXMoZSk9PT11Lm1pbikpJiYobj1pLG89dCh0aGlzKSxhPWUpfSkscj10aGlzLl9zdGFydChlLGEpLHI9PT0hMT8hMToodGhpcy5fbW91c2VTbGlkaW5nPSEwLHRoaXMuX2hhbmRsZUluZGV4PWEsdGhpcy5fYWRkQ2xhc3MobyxudWxsLCJ1aS1zdGF0ZS1hY3RpdmUiKSxvLnRyaWdnZXIoImZvY3VzIiksaD1vLm9mZnNldCgpLGw9IXQoZS50YXJnZXQpLnBhcmVudHMoKS5hZGRCYWNrKCkuaXMoIi51aS1zbGlkZXItaGFuZGxlIiksdGhpcy5fY2xpY2tPZmZzZXQ9bD97bGVmdDowLHRvcDowfTp7bGVmdDplLnBhZ2VYLWgubGVmdC1vLndpZHRoKCkvMix0b3A6ZS5wYWdlWS1oLnRvcC1vLmhlaWdodCgpLzItKHBhcnNlSW50KG8uY3NzKCJib3JkZXJUb3BXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KG8uY3NzKCJib3JkZXJCb3R0b21XaWR0aCIpLDEwKXx8MCkrKHBhcnNlSW50KG8uY3NzKCJtYXJnaW5Ub3AiKSwxMCl8fDApfSx0aGlzLmhhbmRsZXMuaGFzQ2xhc3MoInVpLXN0YXRlLWhvdmVyIil8fHRoaXMuX3NsaWRlKGUsYSxzKSx0aGlzLl9hbmltYXRlT2ZmPSEwLCEwKSl9LF9tb3VzZVN0YXJ0OmZ1bmN0aW9uKCl7cmV0dXJuITB9LF9tb3VzZURyYWc6ZnVuY3Rpb24odCl7dmFyIGU9e3g6dC5wYWdlWCx5OnQucGFnZVl9LGk9dGhpcy5fbm9ybVZhbHVlRnJvbU1vdXNlKGUpO3JldHVybiB0aGlzLl9zbGlkZSh0LHRoaXMuX2hhbmRsZUluZGV4LGkpLCExfSxfbW91c2VTdG9wOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9yZW1vdmVDbGFzcyh0aGlzLmhhbmRsZXMsbnVsbCwidWktc3RhdGUtYWN0aXZlIiksdGhpcy5fbW91c2VTbGlkaW5nPSExLHRoaXMuX3N0b3AodCx0aGlzLl9oYW5kbGVJbmRleCksdGhpcy5fY2hhbmdlKHQsdGhpcy5faGFuZGxlSW5kZXgpLHRoaXMuX2hhbmRsZUluZGV4PW51bGwsdGhpcy5fY2xpY2tPZmZzZXQ9bnVsbCx0aGlzLl9hbmltYXRlT2ZmPSExLCExfSxfZGV0ZWN0T3JpZW50YXRpb246ZnVuY3Rpb24oKXt0aGlzLm9yaWVudGF0aW9uPSJ2ZXJ0aWNhbCI9PT10aGlzLm9wdGlvbnMub3JpZW50YXRpb24/InZlcnRpY2FsIjoiaG9yaXpvbnRhbCJ9LF9ub3JtVmFsdWVGcm9tTW91c2U6ZnVuY3Rpb24odCl7dmFyIGUsaSxzLG4sbztyZXR1cm4iaG9yaXpvbnRhbCI9PT10aGlzLm9yaWVudGF0aW9uPyhlPXRoaXMuZWxlbWVudFNpemUud2lkdGgsaT10LngtdGhpcy5lbGVtZW50T2Zmc2V0LmxlZnQtKHRoaXMuX2NsaWNrT2Zmc2V0P3RoaXMuX2NsaWNrT2Zmc2V0LmxlZnQ6MCkpOihlPXRoaXMuZWxlbWVudFNpemUuaGVpZ2h0LGk9dC55LXRoaXMuZWxlbWVudE9mZnNldC50b3AtKHRoaXMuX2NsaWNrT2Zmc2V0P3RoaXMuX2NsaWNrT2Zmc2V0LnRvcDowKSkscz1pL2Uscz4xJiYocz0xKSwwPnMmJihzPTApLCJ2ZXJ0aWNhbCI9PT10aGlzLm9yaWVudGF0aW9uJiYocz0xLXMpLG49dGhpcy5fdmFsdWVNYXgoKS10aGlzLl92YWx1ZU1pbigpLG89dGhpcy5fdmFsdWVNaW4oKStzKm4sdGhpcy5fdHJpbUFsaWduVmFsdWUobyl9LF91aUhhc2g6ZnVuY3Rpb24odCxlLGkpe3ZhciBzPXtoYW5kbGU6dGhpcy5oYW5kbGVzW3RdLGhhbmRsZUluZGV4OnQsdmFsdWU6dm9pZCAwIT09ZT9lOnRoaXMudmFsdWUoKX07cmV0dXJuIHRoaXMuX2hhc011bHRpcGxlVmFsdWVzKCkmJihzLnZhbHVlPXZvaWQgMCE9PWU/ZTp0aGlzLnZhbHVlcyh0KSxzLnZhbHVlcz1pfHx0aGlzLnZhbHVlcygpKSxzfSxfaGFzTXVsdGlwbGVWYWx1ZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zLnZhbHVlcyYmdGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGh9LF9zdGFydDpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl90cmlnZ2VyKCJzdGFydCIsdCx0aGlzLl91aUhhc2goZSkpfSxfc2xpZGU6ZnVuY3Rpb24odCxlLGkpe3ZhciBzLG4sbz10aGlzLnZhbHVlKCksYT10aGlzLnZhbHVlcygpO3RoaXMuX2hhc011bHRpcGxlVmFsdWVzKCkmJihuPXRoaXMudmFsdWVzKGU/MDoxKSxvPXRoaXMudmFsdWVzKGUpLDI9PT10aGlzLm9wdGlvbnMudmFsdWVzLmxlbmd0aCYmdGhpcy5vcHRpb25zLnJhbmdlPT09ITAmJihpPTA9PT1lP01hdGgubWluKG4saSk6TWF0aC5tYXgobixpKSksYVtlXT1pKSxpIT09byYmKHM9dGhpcy5fdHJpZ2dlcigic2xpZGUiLHQsdGhpcy5fdWlIYXNoKGUsaSxhKSkscyE9PSExJiYodGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKT90aGlzLnZhbHVlcyhlLGkpOnRoaXMudmFsdWUoaSkpKX0sX3N0b3A6ZnVuY3Rpb24odCxlKXt0aGlzLl90cmlnZ2VyKCJzdG9wIix0LHRoaXMuX3VpSGFzaChlKSl9LF9jaGFuZ2U6ZnVuY3Rpb24odCxlKXt0aGlzLl9rZXlTbGlkaW5nfHx0aGlzLl9tb3VzZVNsaWRpbmd8fCh0aGlzLl9sYXN0Q2hhbmdlZFZhbHVlPWUsdGhpcy5fdHJpZ2dlcigiY2hhbmdlIix0LHRoaXMuX3VpSGFzaChlKSkpfSx2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8odGhpcy5vcHRpb25zLnZhbHVlPXRoaXMuX3RyaW1BbGlnblZhbHVlKHQpLHRoaXMuX3JlZnJlc2hWYWx1ZSgpLHRoaXMuX2NoYW5nZShudWxsLDApLHZvaWQgMCk6dGhpcy5fdmFsdWUoKX0sdmFsdWVzOmZ1bmN0aW9uKGUsaSl7dmFyIHMsbixvO2lmKGFyZ3VtZW50cy5sZW5ndGg+MSlyZXR1cm4gdGhpcy5vcHRpb25zLnZhbHVlc1tlXT10aGlzLl90cmltQWxpZ25WYWx1ZShpKSx0aGlzLl9yZWZyZXNoVmFsdWUoKSx0aGlzLl9jaGFuZ2UobnVsbCxlKSx2b2lkIDA7aWYoIWFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHRoaXMuX3ZhbHVlcygpO2lmKCF0LmlzQXJyYXkoYXJndW1lbnRzWzBdKSlyZXR1cm4gdGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKT90aGlzLl92YWx1ZXMoZSk6dGhpcy52YWx1ZSgpO2ZvcihzPXRoaXMub3B0aW9ucy52YWx1ZXMsbj1hcmd1bWVudHNbMF0sbz0wO3MubGVuZ3RoPm87bys9MSlzW29dPXRoaXMuX3RyaW1BbGlnblZhbHVlKG5bb10pLHRoaXMuX2NoYW5nZShudWxsLG8pO3RoaXMuX3JlZnJlc2hWYWx1ZSgpfSxfc2V0T3B0aW9uOmZ1bmN0aW9uKGUsaSl7dmFyIHMsbj0wO3N3aXRjaCgicmFuZ2UiPT09ZSYmdGhpcy5vcHRpb25zLnJhbmdlPT09ITAmJigibWluIj09PWk/KHRoaXMub3B0aW9ucy52YWx1ZT10aGlzLl92YWx1ZXMoMCksdGhpcy5vcHRpb25zLnZhbHVlcz1udWxsKToibWF4Ij09PWkmJih0aGlzLm9wdGlvbnMudmFsdWU9dGhpcy5fdmFsdWVzKHRoaXMub3B0aW9ucy52YWx1ZXMubGVuZ3RoLTEpLHRoaXMub3B0aW9ucy52YWx1ZXM9bnVsbCkpLHQuaXNBcnJheSh0aGlzLm9wdGlvbnMudmFsdWVzKSYmKG49dGhpcy5vcHRpb25zLnZhbHVlcy5sZW5ndGgpLHRoaXMuX3N1cGVyKGUsaSksZSl7Y2FzZSJvcmllbnRhdGlvbiI6dGhpcy5fZGV0ZWN0T3JpZW50YXRpb24oKSx0aGlzLl9yZW1vdmVDbGFzcygidWktc2xpZGVyLWhvcml6b250YWwgdWktc2xpZGVyLXZlcnRpY2FsIikuX2FkZENsYXNzKCJ1aS1zbGlkZXItIit0aGlzLm9yaWVudGF0aW9uKSx0aGlzLl9yZWZyZXNoVmFsdWUoKSx0aGlzLm9wdGlvbnMucmFuZ2UmJnRoaXMuX3JlZnJlc2hSYW5nZShpKSx0aGlzLmhhbmRsZXMuY3NzKCJob3Jpem9udGFsIj09PWk/ImJvdHRvbSI6ImxlZnQiLCIiKTticmVhaztjYXNlInZhbHVlIjp0aGlzLl9hbmltYXRlT2ZmPSEwLHRoaXMuX3JlZnJlc2hWYWx1ZSgpLHRoaXMuX2NoYW5nZShudWxsLDApLHRoaXMuX2FuaW1hdGVPZmY9ITE7YnJlYWs7Y2FzZSJ2YWx1ZXMiOmZvcih0aGlzLl9hbmltYXRlT2ZmPSEwLHRoaXMuX3JlZnJlc2hWYWx1ZSgpLHM9bi0xO3M+PTA7cy0tKXRoaXMuX2NoYW5nZShudWxsLHMpO3RoaXMuX2FuaW1hdGVPZmY9ITE7YnJlYWs7Y2FzZSJzdGVwIjpjYXNlIm1pbiI6Y2FzZSJtYXgiOnRoaXMuX2FuaW1hdGVPZmY9ITAsdGhpcy5fY2FsY3VsYXRlTmV3TWF4KCksdGhpcy5fcmVmcmVzaFZhbHVlKCksdGhpcy5fYW5pbWF0ZU9mZj0hMTticmVhaztjYXNlInJhbmdlIjp0aGlzLl9hbmltYXRlT2ZmPSEwLHRoaXMuX3JlZnJlc2goKSx0aGlzLl9hbmltYXRlT2ZmPSExfX0sX3NldE9wdGlvbkRpc2FibGVkOmZ1bmN0aW9uKHQpe3RoaXMuX3N1cGVyKHQpLHRoaXMuX3RvZ2dsZUNsYXNzKG51bGwsInVpLXN0YXRlLWRpc2FibGVkIiwhIXQpfSxfdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMudmFsdWU7cmV0dXJuIHQ9dGhpcy5fdHJpbUFsaWduVmFsdWUodCl9LF92YWx1ZXM6ZnVuY3Rpb24odCl7dmFyIGUsaSxzO2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGU9dGhpcy5vcHRpb25zLnZhbHVlc1t0XSxlPXRoaXMuX3RyaW1BbGlnblZhbHVlKGUpO2lmKHRoaXMuX2hhc011bHRpcGxlVmFsdWVzKCkpe2ZvcihpPXRoaXMub3B0aW9ucy52YWx1ZXMuc2xpY2UoKSxzPTA7aS5sZW5ndGg+cztzKz0xKWlbc109dGhpcy5fdHJpbUFsaWduVmFsdWUoaVtzXSk7cmV0dXJuIGl9cmV0dXJuW119LF90cmltQWxpZ25WYWx1ZTpmdW5jdGlvbih0KXtpZih0aGlzLl92YWx1ZU1pbigpPj10KXJldHVybiB0aGlzLl92YWx1ZU1pbigpO2lmKHQ+PXRoaXMuX3ZhbHVlTWF4KCkpcmV0dXJuIHRoaXMuX3ZhbHVlTWF4KCk7dmFyIGU9dGhpcy5vcHRpb25zLnN0ZXA+MD90aGlzLm9wdGlvbnMuc3RlcDoxLGk9KHQtdGhpcy5fdmFsdWVNaW4oKSklZSxzPXQtaTtyZXR1cm4gMipNYXRoLmFicyhpKT49ZSYmKHMrPWk+MD9lOi1lKSxwYXJzZUZsb2F0KHMudG9GaXhlZCg1KSl9LF9jYWxjdWxhdGVOZXdNYXg6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnMubWF4LGU9dGhpcy5fdmFsdWVNaW4oKSxpPXRoaXMub3B0aW9ucy5zdGVwLHM9TWF0aC5yb3VuZCgodC1lKS9pKSppO3Q9cytlLHQ+dGhpcy5vcHRpb25zLm1heCYmKHQtPWkpLHRoaXMubWF4PXBhcnNlRmxvYXQodC50b0ZpeGVkKHRoaXMuX3ByZWNpc2lvbigpKSl9LF9wcmVjaXNpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9wcmVjaXNpb25PZih0aGlzLm9wdGlvbnMuc3RlcCk7cmV0dXJuIG51bGwhPT10aGlzLm9wdGlvbnMubWluJiYodD1NYXRoLm1heCh0LHRoaXMuX3ByZWNpc2lvbk9mKHRoaXMub3B0aW9ucy5taW4pKSksdH0sX3ByZWNpc2lvbk9mOmZ1bmN0aW9uKHQpe3ZhciBlPSIiK3QsaT1lLmluZGV4T2YoIi4iKTtyZXR1cm4tMT09PWk/MDplLmxlbmd0aC1pLTF9LF92YWx1ZU1pbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLm9wdGlvbnMubWlufSxfdmFsdWVNYXg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXh9LF9yZWZyZXNoUmFuZ2U6ZnVuY3Rpb24odCl7InZlcnRpY2FsIj09PXQmJnRoaXMucmFuZ2UuY3NzKHt3aWR0aDoiIixsZWZ0OiIifSksImhvcml6b250YWwiPT09dCYmdGhpcy5yYW5nZS5jc3Moe2hlaWdodDoiIixib3R0b206IiJ9KX0sX3JlZnJlc2hWYWx1ZTpmdW5jdGlvbigpe3ZhciBlLGkscyxuLG8sYT10aGlzLm9wdGlvbnMucmFuZ2Uscj10aGlzLm9wdGlvbnMsaD10aGlzLGw9dGhpcy5fYW5pbWF0ZU9mZj8hMTpyLmFuaW1hdGUsYz17fTt0aGlzLl9oYXNNdWx0aXBsZVZhbHVlcygpP3RoaXMuaGFuZGxlcy5lYWNoKGZ1bmN0aW9uKHMpe2k9MTAwKigoaC52YWx1ZXMocyktaC5fdmFsdWVNaW4oKSkvKGguX3ZhbHVlTWF4KCktaC5fdmFsdWVNaW4oKSkpLGNbImhvcml6b250YWwiPT09aC5vcmllbnRhdGlvbj8ibGVmdCI6ImJvdHRvbSJdPWkrIiUiLHQodGhpcykuc3RvcCgxLDEpW2w/ImFuaW1hdGUiOiJjc3MiXShjLHIuYW5pbWF0ZSksaC5vcHRpb25zLnJhbmdlPT09ITAmJigiaG9yaXpvbnRhbCI9PT1oLm9yaWVudGF0aW9uPygwPT09cyYmaC5yYW5nZS5zdG9wKDEsMSlbbD8iYW5pbWF0ZSI6ImNzcyJdKHtsZWZ0OmkrIiUifSxyLmFuaW1hdGUpLDE9PT1zJiZoLnJhbmdlW2w/ImFuaW1hdGUiOiJjc3MiXSh7d2lkdGg6aS1lKyIlIn0se3F1ZXVlOiExLGR1cmF0aW9uOnIuYW5pbWF0ZX0pKTooMD09PXMmJmgucmFuZ2Uuc3RvcCgxLDEpW2w/ImFuaW1hdGUiOiJjc3MiXSh7Ym90dG9tOmkrIiUifSxyLmFuaW1hdGUpLDE9PT1zJiZoLnJhbmdlW2w/ImFuaW1hdGUiOiJjc3MiXSh7aGVpZ2h0OmktZSsiJSJ9LHtxdWV1ZTohMSxkdXJhdGlvbjpyLmFuaW1hdGV9KSkpLGU9aX0pOihzPXRoaXMudmFsdWUoKSxuPXRoaXMuX3ZhbHVlTWluKCksbz10aGlzLl92YWx1ZU1heCgpLGk9byE9PW4/MTAwKigocy1uKS8oby1uKSk6MCxjWyJob3Jpem9udGFsIj09PXRoaXMub3JpZW50YXRpb24/ImxlZnQiOiJib3R0b20iXT1pKyIlIix0aGlzLmhhbmRsZS5zdG9wKDEsMSlbbD8iYW5pbWF0ZSI6ImNzcyJdKGMsci5hbmltYXRlKSwibWluIj09PWEmJiJob3Jpem9udGFsIj09PXRoaXMub3JpZW50YXRpb24mJnRoaXMucmFuZ2Uuc3RvcCgxLDEpW2w/ImFuaW1hdGUiOiJjc3MiXSh7d2lkdGg6aSsiJSJ9LHIuYW5pbWF0ZSksIm1heCI9PT1hJiYiaG9yaXpvbnRhbCI9PT10aGlzLm9yaWVudGF0aW9uJiZ0aGlzLnJhbmdlLnN0b3AoMSwxKVtsPyJhbmltYXRlIjoiY3NzIl0oe3dpZHRoOjEwMC1pKyIlIn0sci5hbmltYXRlKSwibWluIj09PWEmJiJ2ZXJ0aWNhbCI9PT10aGlzLm9yaWVudGF0aW9uJiZ0aGlzLnJhbmdlLnN0b3AoMSwxKVtsPyJhbmltYXRlIjoiY3NzIl0oe2hlaWdodDppKyIlIn0sci5hbmltYXRlKSwibWF4Ij09PWEmJiJ2ZXJ0aWNhbCI9PT10aGlzLm9yaWVudGF0aW9uJiZ0aGlzLnJhbmdlLnN0b3AoMSwxKVtsPyJhbmltYXRlIjoiY3NzIl0oe2hlaWdodDoxMDAtaSsiJSJ9LHIuYW5pbWF0ZSkpfSxfaGFuZGxlRXZlbnRzOntrZXlkb3duOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbixvLGE9dChlLnRhcmdldCkuZGF0YSgidWktc2xpZGVyLWhhbmRsZS1pbmRleCIpO3N3aXRjaChlLmtleUNvZGUpe2Nhc2UgdC51aS5rZXlDb2RlLkhPTUU6Y2FzZSB0LnVpLmtleUNvZGUuRU5EOmNhc2UgdC51aS5rZXlDb2RlLlBBR0VfVVA6Y2FzZSB0LnVpLmtleUNvZGUuUEFHRV9ET1dOOmNhc2UgdC51aS5rZXlDb2RlLlVQOmNhc2UgdC51aS5rZXlDb2RlLlJJR0hUOmNhc2UgdC51aS5rZXlDb2RlLkRPV046Y2FzZSB0LnVpLmtleUNvZGUuTEVGVDppZihlLnByZXZlbnREZWZhdWx0KCksIXRoaXMuX2tleVNsaWRpbmcmJih0aGlzLl9rZXlTbGlkaW5nPSEwLHRoaXMuX2FkZENsYXNzKHQoZS50YXJnZXQpLG51bGwsInVpLXN0YXRlLWFjdGl2ZSIpLGk9dGhpcy5fc3RhcnQoZSxhKSxpPT09ITEpKXJldHVybn1zd2l0Y2gobz10aGlzLm9wdGlvbnMuc3RlcCxzPW49dGhpcy5faGFzTXVsdGlwbGVWYWx1ZXMoKT90aGlzLnZhbHVlcyhhKTp0aGlzLnZhbHVlKCksZS5rZXlDb2RlKXtjYXNlIHQudWkua2V5Q29kZS5IT01FOm49dGhpcy5fdmFsdWVNaW4oKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5FTkQ6bj10aGlzLl92YWx1ZU1heCgpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLlBBR0VfVVA6bj10aGlzLl90cmltQWxpZ25WYWx1ZShzKyh0aGlzLl92YWx1ZU1heCgpLXRoaXMuX3ZhbHVlTWluKCkpL3RoaXMubnVtUGFnZXMpO2JyZWFrO2Nhc2UgdC51aS5rZXlDb2RlLlBBR0VfRE9XTjpuPXRoaXMuX3RyaW1BbGlnblZhbHVlKHMtKHRoaXMuX3ZhbHVlTWF4KCktdGhpcy5fdmFsdWVNaW4oKSkvdGhpcy5udW1QYWdlcyk7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuVVA6Y2FzZSB0LnVpLmtleUNvZGUuUklHSFQ6aWYocz09PXRoaXMuX3ZhbHVlTWF4KCkpcmV0dXJuO249dGhpcy5fdHJpbUFsaWduVmFsdWUocytvKTticmVhaztjYXNlIHQudWkua2V5Q29kZS5ET1dOOmNhc2UgdC51aS5rZXlDb2RlLkxFRlQ6aWYocz09PXRoaXMuX3ZhbHVlTWluKCkpcmV0dXJuO249dGhpcy5fdHJpbUFsaWduVmFsdWUocy1vKX10aGlzLl9zbGlkZShlLGEsbil9LGtleXVwOmZ1bmN0aW9uKGUpe3ZhciBpPXQoZS50YXJnZXQpLmRhdGEoInVpLXNsaWRlci1oYW5kbGUtaW5kZXgiKTt0aGlzLl9rZXlTbGlkaW5nJiYodGhpcy5fa2V5U2xpZGluZz0hMSx0aGlzLl9zdG9wKGUsaSksdGhpcy5fY2hhbmdlKGUsaSksdGhpcy5fcmVtb3ZlQ2xhc3ModChlLnRhcmdldCksbnVsbCwidWktc3RhdGUtYWN0aXZlIikpfX19KSx0LndpZGdldCgidWkuc29ydGFibGUiLHQudWkubW91c2Use3ZlcnNpb246IjEuMTIuMSIsd2lkZ2V0RXZlbnRQcmVmaXg6InNvcnQiLHJlYWR5OiExLG9wdGlvbnM6e2FwcGVuZFRvOiJwYXJlbnQiLGF4aXM6ITEsY29ubmVjdFdpdGg6ITEsY29udGFpbm1lbnQ6ITEsY3Vyc29yOiJhdXRvIixjdXJzb3JBdDohMSxkcm9wT25FbXB0eTohMCxmb3JjZVBsYWNlaG9sZGVyU2l6ZTohMSxmb3JjZUhlbHBlclNpemU6ITEsZ3JpZDohMSxoYW5kbGU6ITEsaGVscGVyOiJvcmlnaW5hbCIsaXRlbXM6Ij4gKiIsb3BhY2l0eTohMSxwbGFjZWhvbGRlcjohMSxyZXZlcnQ6ITEsc2Nyb2xsOiEwLHNjcm9sbFNlbnNpdGl2aXR5OjIwLHNjcm9sbFNwZWVkOjIwLHNjb3BlOiJkZWZhdWx0Iix0b2xlcmFuY2U6ImludGVyc2VjdCIsekluZGV4OjFlMyxhY3RpdmF0ZTpudWxsLGJlZm9yZVN0b3A6bnVsbCxjaGFuZ2U6bnVsbCxkZWFjdGl2YXRlOm51bGwsb3V0Om51bGwsb3ZlcjpudWxsLHJlY2VpdmU6bnVsbCxyZW1vdmU6bnVsbCxzb3J0Om51bGwsc3RhcnQ6bnVsbCxzdG9wOm51bGwsdXBkYXRlOm51bGx9LF9pc092ZXJBeGlzOmZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gdD49ZSYmZStpPnR9LF9pc0Zsb2F0aW5nOmZ1bmN0aW9uKHQpe3JldHVybi9sZWZ0fHJpZ2h0Ly50ZXN0KHQuY3NzKCJmbG9hdCIpKXx8L2lubGluZXx0YWJsZS1jZWxsLy50ZXN0KHQuY3NzKCJkaXNwbGF5IikpfSxfY3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5jb250YWluZXJDYWNoZT17fSx0aGlzLl9hZGRDbGFzcygidWktc29ydGFibGUiKSx0aGlzLnJlZnJlc2goKSx0aGlzLm9mZnNldD10aGlzLmVsZW1lbnQub2Zmc2V0KCksdGhpcy5fbW91c2VJbml0KCksdGhpcy5fc2V0SGFuZGxlQ2xhc3NOYW1lKCksdGhpcy5yZWFkeT0hMH0sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3RoaXMuX3N1cGVyKHQsZSksImhhbmRsZSI9PT10JiZ0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKX0sX3NldEhhbmRsZUNsYXNzTmFtZTpmdW5jdGlvbigpe3ZhciBlPXRoaXM7dGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5lbGVtZW50LmZpbmQoIi51aS1zb3J0YWJsZS1oYW5kbGUiKSwidWktc29ydGFibGUtaGFuZGxlIiksdC5lYWNoKHRoaXMuaXRlbXMsZnVuY3Rpb24oKXtlLl9hZGRDbGFzcyh0aGlzLmluc3RhbmNlLm9wdGlvbnMuaGFuZGxlP3RoaXMuaXRlbS5maW5kKHRoaXMuaW5zdGFuY2Uub3B0aW9ucy5oYW5kbGUpOnRoaXMuaXRlbSwidWktc29ydGFibGUtaGFuZGxlIil9KX0sX2Rlc3Ryb3k6ZnVuY3Rpb24oKXt0aGlzLl9tb3VzZURlc3Ryb3koKTtmb3IodmFyIHQ9dGhpcy5pdGVtcy5sZW5ndGgtMTt0Pj0wO3QtLSl0aGlzLml0ZW1zW3RdLml0ZW0ucmVtb3ZlRGF0YSh0aGlzLndpZGdldE5hbWUrIi1pdGVtIik7cmV0dXJuIHRoaXN9LF9tb3VzZUNhcHR1cmU6ZnVuY3Rpb24oZSxpKXt2YXIgcz1udWxsLG49ITEsbz10aGlzO3JldHVybiB0aGlzLnJldmVydGluZz8hMTp0aGlzLm9wdGlvbnMuZGlzYWJsZWR8fCJzdGF0aWMiPT09dGhpcy5vcHRpb25zLnR5cGU/ITE6KHRoaXMuX3JlZnJlc2hJdGVtcyhlKSx0KGUudGFyZ2V0KS5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpe3JldHVybiB0LmRhdGEodGhpcyxvLndpZGdldE5hbWUrIi1pdGVtIik9PT1vPyhzPXQodGhpcyksITEpOnZvaWQgMH0pLHQuZGF0YShlLnRhcmdldCxvLndpZGdldE5hbWUrIi1pdGVtIik9PT1vJiYocz10KGUudGFyZ2V0KSkscz8hdGhpcy5vcHRpb25zLmhhbmRsZXx8aXx8KHQodGhpcy5vcHRpb25zLmhhbmRsZSxzKS5maW5kKCIqIikuYWRkQmFjaygpLmVhY2goZnVuY3Rpb24oKXt0aGlzPT09ZS50YXJnZXQmJihuPSEwKX0pLG4pPyh0aGlzLmN1cnJlbnRJdGVtPXMsdGhpcy5fcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXMoKSwhMCk6ITE6ITEpfSxfbW91c2VTdGFydDpmdW5jdGlvbihlLGkscyl7dmFyIG4sbyxhPXRoaXMub3B0aW9ucztpZih0aGlzLmN1cnJlbnRDb250YWluZXI9dGhpcyx0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKSx0aGlzLmhlbHBlcj10aGlzLl9jcmVhdGVIZWxwZXIoZSksdGhpcy5fY2FjaGVIZWxwZXJQcm9wb3J0aW9ucygpLHRoaXMuX2NhY2hlTWFyZ2lucygpLHRoaXMuc2Nyb2xsUGFyZW50PXRoaXMuaGVscGVyLnNjcm9sbFBhcmVudCgpLHRoaXMub2Zmc2V0PXRoaXMuY3VycmVudEl0ZW0ub2Zmc2V0KCksdGhpcy5vZmZzZXQ9e3RvcDp0aGlzLm9mZnNldC50b3AtdGhpcy5tYXJnaW5zLnRvcCxsZWZ0OnRoaXMub2Zmc2V0LmxlZnQtdGhpcy5tYXJnaW5zLmxlZnR9LHQuZXh0ZW5kKHRoaXMub2Zmc2V0LHtjbGljazp7bGVmdDplLnBhZ2VYLXRoaXMub2Zmc2V0LmxlZnQsdG9wOmUucGFnZVktdGhpcy5vZmZzZXQudG9wfSxwYXJlbnQ6dGhpcy5fZ2V0UGFyZW50T2Zmc2V0KCkscmVsYXRpdmU6dGhpcy5fZ2V0UmVsYXRpdmVPZmZzZXQoKX0pLHRoaXMuaGVscGVyLmNzcygicG9zaXRpb24iLCJhYnNvbHV0ZSIpLHRoaXMuY3NzUG9zaXRpb249dGhpcy5oZWxwZXIuY3NzKCJwb3NpdGlvbiIpLHRoaXMub3JpZ2luYWxQb3NpdGlvbj10aGlzLl9nZW5lcmF0ZVBvc2l0aW9uKGUpLHRoaXMub3JpZ2luYWxQYWdlWD1lLnBhZ2VYLHRoaXMub3JpZ2luYWxQYWdlWT1lLnBhZ2VZLGEuY3Vyc29yQXQmJnRoaXMuX2FkanVzdE9mZnNldEZyb21IZWxwZXIoYS5jdXJzb3JBdCksdGhpcy5kb21Qb3NpdGlvbj17cHJldjp0aGlzLmN1cnJlbnRJdGVtLnByZXYoKVswXSxwYXJlbnQ6dGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKVswXX0sdGhpcy5oZWxwZXJbMF0hPT10aGlzLmN1cnJlbnRJdGVtWzBdJiZ0aGlzLmN1cnJlbnRJdGVtLmhpZGUoKSx0aGlzLl9jcmVhdGVQbGFjZWhvbGRlcigpLGEuY29udGFpbm1lbnQmJnRoaXMuX3NldENvbnRhaW5tZW50KCksYS5jdXJzb3ImJiJhdXRvIiE9PWEuY3Vyc29yJiYobz10aGlzLmRvY3VtZW50LmZpbmQoImJvZHkiKSx0aGlzLnN0b3JlZEN1cnNvcj1vLmNzcygiY3Vyc29yIiksby5jc3MoImN1cnNvciIsYS5jdXJzb3IpLHRoaXMuc3RvcmVkU3R5bGVzaGVldD10KCI8c3R5bGU+KnsgY3Vyc29yOiAiK2EuY3Vyc29yKyIgIWltcG9ydGFudDsgfTwvc3R5bGU+IikuYXBwZW5kVG8obykpLGEub3BhY2l0eSYmKHRoaXMuaGVscGVyLmNzcygib3BhY2l0eSIpJiYodGhpcy5fc3RvcmVkT3BhY2l0eT10aGlzLmhlbHBlci5jc3MoIm9wYWNpdHkiKSksdGhpcy5oZWxwZXIuY3NzKCJvcGFjaXR5IixhLm9wYWNpdHkpKSxhLnpJbmRleCYmKHRoaXMuaGVscGVyLmNzcygiekluZGV4IikmJih0aGlzLl9zdG9yZWRaSW5kZXg9dGhpcy5oZWxwZXIuY3NzKCJ6SW5kZXgiKSksdGhpcy5oZWxwZXIuY3NzKCJ6SW5kZXgiLGEuekluZGV4KSksdGhpcy5zY3JvbGxQYXJlbnRbMF0hPT10aGlzLmRvY3VtZW50WzBdJiYiSFRNTCIhPT10aGlzLnNjcm9sbFBhcmVudFswXS50YWdOYW1lJiYodGhpcy5vdmVyZmxvd09mZnNldD10aGlzLnNjcm9sbFBhcmVudC5vZmZzZXQoKSksdGhpcy5fdHJpZ2dlcigic3RhcnQiLGUsdGhpcy5fdWlIYXNoKCkpLHRoaXMuX3ByZXNlcnZlSGVscGVyUHJvcG9ydGlvbnN8fHRoaXMuX2NhY2hlSGVscGVyUHJvcG9ydGlvbnMoKSwhcylmb3Iobj10aGlzLmNvbnRhaW5lcnMubGVuZ3RoLTE7bj49MDtuLS0pdGhpcy5jb250YWluZXJzW25dLl90cmlnZ2VyKCJhY3RpdmF0ZSIsZSx0aGlzLl91aUhhc2godGhpcykpO3JldHVybiB0LnVpLmRkbWFuYWdlciYmKHQudWkuZGRtYW5hZ2VyLmN1cnJlbnQ9dGhpcyksdC51aS5kZG1hbmFnZXImJiFhLmRyb3BCZWhhdmlvdXImJnQudWkuZGRtYW5hZ2VyLnByZXBhcmVPZmZzZXRzKHRoaXMsZSksdGhpcy5kcmFnZ2luZz0hMCx0aGlzLl9hZGRDbGFzcyh0aGlzLmhlbHBlciwidWktc29ydGFibGUtaGVscGVyIiksdGhpcy5fbW91c2VEcmFnKGUpLCEwfSxfbW91c2VEcmFnOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbixvLGE9dGhpcy5vcHRpb25zLHI9ITE7Zm9yKHRoaXMucG9zaXRpb249dGhpcy5fZ2VuZXJhdGVQb3NpdGlvbihlKSx0aGlzLnBvc2l0aW9uQWJzPXRoaXMuX2NvbnZlcnRQb3NpdGlvblRvKCJhYnNvbHV0ZSIpLHRoaXMubGFzdFBvc2l0aW9uQWJzfHwodGhpcy5sYXN0UG9zaXRpb25BYnM9dGhpcy5wb3NpdGlvbkFicyksdGhpcy5vcHRpb25zLnNjcm9sbCYmKHRoaXMuc2Nyb2xsUGFyZW50WzBdIT09dGhpcy5kb2N1bWVudFswXSYmIkhUTUwiIT09dGhpcy5zY3JvbGxQYXJlbnRbMF0udGFnTmFtZT8odGhpcy5vdmVyZmxvd09mZnNldC50b3ArdGhpcy5zY3JvbGxQYXJlbnRbMF0ub2Zmc2V0SGVpZ2h0LWUucGFnZVk8YS5zY3JvbGxTZW5zaXRpdml0eT90aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3A9cj10aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3ArYS5zY3JvbGxTcGVlZDplLnBhZ2VZLXRoaXMub3ZlcmZsb3dPZmZzZXQudG9wPGEuc2Nyb2xsU2Vuc2l0aXZpdHkmJih0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3A9cj10aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxUb3AtYS5zY3JvbGxTcGVlZCksdGhpcy5vdmVyZmxvd09mZnNldC5sZWZ0K3RoaXMuc2Nyb2xsUGFyZW50WzBdLm9mZnNldFdpZHRoLWUucGFnZVg8YS5zY3JvbGxTZW5zaXRpdml0eT90aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0PXI9dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdCthLnNjcm9sbFNwZWVkOmUucGFnZVgtdGhpcy5vdmVyZmxvd09mZnNldC5sZWZ0PGEuc2Nyb2xsU2Vuc2l0aXZpdHkmJih0aGlzLnNjcm9sbFBhcmVudFswXS5zY3JvbGxMZWZ0PXI9dGhpcy5zY3JvbGxQYXJlbnRbMF0uc2Nyb2xsTGVmdC1hLnNjcm9sbFNwZWVkKSk6KGUucGFnZVktdGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKTxhLnNjcm9sbFNlbnNpdGl2aXR5P3I9dGhpcy5kb2N1bWVudC5zY3JvbGxUb3AodGhpcy5kb2N1bWVudC5zY3JvbGxUb3AoKS1hLnNjcm9sbFNwZWVkKTp0aGlzLndpbmRvdy5oZWlnaHQoKS0oZS5wYWdlWS10aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpKTxhLnNjcm9sbFNlbnNpdGl2aXR5JiYocj10aGlzLmRvY3VtZW50LnNjcm9sbFRvcCh0aGlzLmRvY3VtZW50LnNjcm9sbFRvcCgpK2Euc2Nyb2xsU3BlZWQpKSxlLnBhZ2VYLXRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpPGEuc2Nyb2xsU2Vuc2l0aXZpdHk/cj10aGlzLmRvY3VtZW50LnNjcm9sbExlZnQodGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KCktYS5zY3JvbGxTcGVlZCk6dGhpcy53aW5kb3cud2lkdGgoKS0oZS5wYWdlWC10aGlzLmRvY3VtZW50LnNjcm9sbExlZnQoKSk8YS5zY3JvbGxTZW5zaXRpdml0eSYmKHI9dGhpcy5kb2N1bWVudC5zY3JvbGxMZWZ0KHRoaXMuZG9jdW1lbnQuc2Nyb2xsTGVmdCgpK2Euc2Nyb2xsU3BlZWQpKSksciE9PSExJiZ0LnVpLmRkbWFuYWdlciYmIWEuZHJvcEJlaGF2aW91ciYmdC51aS5kZG1hbmFnZXIucHJlcGFyZU9mZnNldHModGhpcyxlKSksdGhpcy5wb3NpdGlvbkFicz10aGlzLl9jb252ZXJ0UG9zaXRpb25UbygiYWJzb2x1dGUiKSx0aGlzLm9wdGlvbnMuYXhpcyYmInkiPT09dGhpcy5vcHRpb25zLmF4aXN8fCh0aGlzLmhlbHBlclswXS5zdHlsZS5sZWZ0PXRoaXMucG9zaXRpb24ubGVmdCsicHgiKSx0aGlzLm9wdGlvbnMuYXhpcyYmIngiPT09dGhpcy5vcHRpb25zLmF4aXN8fCh0aGlzLmhlbHBlclswXS5zdHlsZS50b3A9dGhpcy5wb3NpdGlvbi50b3ArInB4IiksaT10aGlzLml0ZW1zLmxlbmd0aC0xO2k+PTA7aS0tKWlmKHM9dGhpcy5pdGVtc1tpXSxuPXMuaXRlbVswXSxvPXRoaXMuX2ludGVyc2VjdHNXaXRoUG9pbnRlcihzKSxvJiZzLmluc3RhbmNlPT09dGhpcy5jdXJyZW50Q29udGFpbmVyJiZuIT09dGhpcy5jdXJyZW50SXRlbVswXSYmdGhpcy5wbGFjZWhvbGRlclsxPT09bz8ibmV4dCI6InByZXYiXSgpWzBdIT09biYmIXQuY29udGFpbnModGhpcy5wbGFjZWhvbGRlclswXSxuKSYmKCJzZW1pLWR5bmFtaWMiPT09dGhpcy5vcHRpb25zLnR5cGU/IXQuY29udGFpbnModGhpcy5lbGVtZW50WzBdLG4pOiEwKSl7aWYodGhpcy5kaXJlY3Rpb249MT09PW8/ImRvd24iOiJ1cCIsInBvaW50ZXIiIT09dGhpcy5vcHRpb25zLnRvbGVyYW5jZSYmIXRoaXMuX2ludGVyc2VjdHNXaXRoU2lkZXMocykpYnJlYWs7dGhpcy5fcmVhcnJhbmdlKGUscyksdGhpcy5fdHJpZ2dlcigiY2hhbmdlIixlLHRoaXMuX3VpSGFzaCgpKTticmVha31yZXR1cm4gdGhpcy5fY29udGFjdENvbnRhaW5lcnMoZSksdC51aS5kZG1hbmFnZXImJnQudWkuZGRtYW5hZ2VyLmRyYWcodGhpcyxlKSx0aGlzLl90cmlnZ2VyKCJzb3J0IixlLHRoaXMuX3VpSGFzaCgpKSx0aGlzLmxhc3RQb3NpdGlvbkFicz10aGlzLnBvc2l0aW9uQWJzLCExfSxfbW91c2VTdG9wOmZ1bmN0aW9uKGUsaSl7aWYoZSl7aWYodC51aS5kZG1hbmFnZXImJiF0aGlzLm9wdGlvbnMuZHJvcEJlaGF2aW91ciYmdC51aS5kZG1hbmFnZXIuZHJvcCh0aGlzLGUpLHRoaXMub3B0aW9ucy5yZXZlcnQpe3ZhciBzPXRoaXMsbj10aGlzLnBsYWNlaG9sZGVyLm9mZnNldCgpLG89dGhpcy5vcHRpb25zLmF4aXMsYT17fTtvJiYieCIhPT1vfHwoYS5sZWZ0PW4ubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdC10aGlzLm1hcmdpbnMubGVmdCsodGhpcy5vZmZzZXRQYXJlbnRbMF09PT10aGlzLmRvY3VtZW50WzBdLmJvZHk/MDp0aGlzLm9mZnNldFBhcmVudFswXS5zY3JvbGxMZWZ0KSksbyYmInkiIT09b3x8KGEudG9wPW4udG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3AtdGhpcy5tYXJnaW5zLnRvcCsodGhpcy5vZmZzZXRQYXJlbnRbMF09PT10aGlzLmRvY3VtZW50WzBdLmJvZHk/MDp0aGlzLm9mZnNldFBhcmVudFswXS5zY3JvbGxUb3ApKSx0aGlzLnJldmVydGluZz0hMCx0KHRoaXMuaGVscGVyKS5hbmltYXRlKGEscGFyc2VJbnQodGhpcy5vcHRpb25zLnJldmVydCwxMCl8fDUwMCxmdW5jdGlvbigpe3MuX2NsZWFyKGUpfSl9ZWxzZSB0aGlzLl9jbGVhcihlLGkpO3JldHVybiExfX0sY2FuY2VsOmZ1bmN0aW9uKCl7aWYodGhpcy5kcmFnZ2luZyl7dGhpcy5fbW91c2VVcChuZXcgdC5FdmVudCgibW91c2V1cCIse3RhcmdldDpudWxsfSkpLCJvcmlnaW5hbCI9PT10aGlzLm9wdGlvbnMuaGVscGVyPyh0aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLHRoaXMuX3JlbW92ZUNsYXNzKHRoaXMuY3VycmVudEl0ZW0sInVpLXNvcnRhYmxlLWhlbHBlciIpKTp0aGlzLmN1cnJlbnRJdGVtLnNob3coKTtmb3IodmFyIGU9dGhpcy5jb250YWluZXJzLmxlbmd0aC0xO2U+PTA7ZS0tKXRoaXMuY29udGFpbmVyc1tlXS5fdHJpZ2dlcigiZGVhY3RpdmF0ZSIsbnVsbCx0aGlzLl91aUhhc2godGhpcykpLHRoaXMuY29udGFpbmVyc1tlXS5jb250YWluZXJDYWNoZS5vdmVyJiYodGhpcy5jb250YWluZXJzW2VdLl90cmlnZ2VyKCJvdXQiLG51bGwsdGhpcy5fdWlIYXNoKHRoaXMpKSx0aGlzLmNvbnRhaW5lcnNbZV0uY29udGFpbmVyQ2FjaGUub3Zlcj0wKX1yZXR1cm4gdGhpcy5wbGFjZWhvbGRlciYmKHRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZSYmdGhpcy5wbGFjZWhvbGRlclswXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXJbMF0pLCJvcmlnaW5hbCIhPT10aGlzLm9wdGlvbnMuaGVscGVyJiZ0aGlzLmhlbHBlciYmdGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZSYmdGhpcy5oZWxwZXIucmVtb3ZlKCksdC5leHRlbmQodGhpcyx7aGVscGVyOm51bGwsZHJhZ2dpbmc6ITEscmV2ZXJ0aW5nOiExLF9ub0ZpbmFsU29ydDpudWxsfSksdGhpcy5kb21Qb3NpdGlvbi5wcmV2P3QodGhpcy5kb21Qb3NpdGlvbi5wcmV2KS5hZnRlcih0aGlzLmN1cnJlbnRJdGVtKTp0KHRoaXMuZG9tUG9zaXRpb24ucGFyZW50KS5wcmVwZW5kKHRoaXMuY3VycmVudEl0ZW0pKSx0aGlzfSxzZXJpYWxpemU6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5fZ2V0SXRlbXNBc2pRdWVyeShlJiZlLmNvbm5lY3RlZCkscz1bXTtyZXR1cm4gZT1lfHx7fSx0KGkpLmVhY2goZnVuY3Rpb24oKXt2YXIgaT0odChlLml0ZW18fHRoaXMpLmF0dHIoZS5hdHRyaWJ1dGV8fCJpZCIpfHwiIikubWF0Y2goZS5leHByZXNzaW9ufHwvKC4rKVtcLT1fXSguKykvKTtpJiZzLnB1c2goKGUua2V5fHxpWzFdKyJbXSIpKyI9IisoZS5rZXkmJmUuZXhwcmVzc2lvbj9pWzFdOmlbMl0pKX0pLCFzLmxlbmd0aCYmZS5rZXkmJnMucHVzaChlLmtleSsiPSIpLHMuam9pbigiJiIpfSx0b0FycmF5OmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMuX2dldEl0ZW1zQXNqUXVlcnkoZSYmZS5jb25uZWN0ZWQpLHM9W107cmV0dXJuIGU9ZXx8e30saS5lYWNoKGZ1bmN0aW9uKCl7cy5wdXNoKHQoZS5pdGVtfHx0aGlzKS5hdHRyKGUuYXR0cmlidXRlfHwiaWQiKXx8IiIpfSksc30sX2ludGVyc2VjdHNXaXRoOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMucG9zaXRpb25BYnMubGVmdCxpPWUrdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aCxzPXRoaXMucG9zaXRpb25BYnMudG9wLG49cyt0aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodCxvPXQubGVmdCxhPW8rdC53aWR0aCxyPXQudG9wLGg9cit0LmhlaWdodCxsPXRoaXMub2Zmc2V0LmNsaWNrLnRvcCxjPXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQsdT0ieCI9PT10aGlzLm9wdGlvbnMuYXhpc3x8cytsPnImJmg+cytsLGQ9InkiPT09dGhpcy5vcHRpb25zLmF4aXN8fGUrYz5vJiZhPmUrYyxwPXUmJmQ7cmV0dXJuInBvaW50ZXIiPT09dGhpcy5vcHRpb25zLnRvbGVyYW5jZXx8dGhpcy5vcHRpb25zLmZvcmNlUG9pbnRlckZvckNvbnRhaW5lcnN8fCJwb2ludGVyIiE9PXRoaXMub3B0aW9ucy50b2xlcmFuY2UmJnRoaXMuaGVscGVyUHJvcG9ydGlvbnNbdGhpcy5mbG9hdGluZz8id2lkdGgiOiJoZWlnaHQiXT50W3RoaXMuZmxvYXRpbmc/IndpZHRoIjoiaGVpZ2h0Il0/cDplK3RoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgvMj5vJiZhPmktdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC8yJiZzK3RoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LzI+ciYmaD5uLXRoaXMuaGVscGVyUHJvcG9ydGlvbnMuaGVpZ2h0LzJ9LF9pbnRlcnNlY3RzV2l0aFBvaW50ZXI6ZnVuY3Rpb24odCl7dmFyIGUsaSxzPSJ4Ij09PXRoaXMub3B0aW9ucy5heGlzfHx0aGlzLl9pc092ZXJBeGlzKHRoaXMucG9zaXRpb25BYnMudG9wK3RoaXMub2Zmc2V0LmNsaWNrLnRvcCx0LnRvcCx0LmhlaWdodCksbj0ieSI9PT10aGlzLm9wdGlvbnMuYXhpc3x8dGhpcy5faXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLmxlZnQrdGhpcy5vZmZzZXQuY2xpY2subGVmdCx0LmxlZnQsdC53aWR0aCksbz1zJiZuO3JldHVybiBvPyhlPXRoaXMuX2dldERyYWdWZXJ0aWNhbERpcmVjdGlvbigpLGk9dGhpcy5fZ2V0RHJhZ0hvcml6b250YWxEaXJlY3Rpb24oKSx0aGlzLmZsb2F0aW5nPyJyaWdodCI9PT1pfHwiZG93biI9PT1lPzI6MTplJiYoImRvd24iPT09ZT8yOjEpKTohMX0sX2ludGVyc2VjdHNXaXRoU2lkZXM6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5faXNPdmVyQXhpcyh0aGlzLnBvc2l0aW9uQWJzLnRvcCt0aGlzLm9mZnNldC5jbGljay50b3AsdC50b3ArdC5oZWlnaHQvMix0LmhlaWdodCksaT10aGlzLl9pc092ZXJBeGlzKHRoaXMucG9zaXRpb25BYnMubGVmdCt0aGlzLm9mZnNldC5jbGljay5sZWZ0LHQubGVmdCt0LndpZHRoLzIsdC53aWR0aCkscz10aGlzLl9nZXREcmFnVmVydGljYWxEaXJlY3Rpb24oKSxuPXRoaXMuX2dldERyYWdIb3Jpem9udGFsRGlyZWN0aW9uKCk7cmV0dXJuIHRoaXMuZmxvYXRpbmcmJm4/InJpZ2h0Ij09PW4mJml8fCJsZWZ0Ij09PW4mJiFpOnMmJigiZG93biI9PT1zJiZlfHwidXAiPT09cyYmIWUpfSxfZ2V0RHJhZ1ZlcnRpY2FsRGlyZWN0aW9uOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5wb3NpdGlvbkFicy50b3AtdGhpcy5sYXN0UG9zaXRpb25BYnMudG9wO3JldHVybiAwIT09dCYmKHQ+MD8iZG93biI6InVwIil9LF9nZXREcmFnSG9yaXpvbnRhbERpcmVjdGlvbjpmdW5jdGlvbigpe3ZhciB0PXRoaXMucG9zaXRpb25BYnMubGVmdC10aGlzLmxhc3RQb3NpdGlvbkFicy5sZWZ0O3JldHVybiAwIT09dCYmKHQ+MD8icmlnaHQiOiJsZWZ0Iil9LHJlZnJlc2g6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3JlZnJlc2hJdGVtcyh0KSx0aGlzLl9zZXRIYW5kbGVDbGFzc05hbWUoKSx0aGlzLnJlZnJlc2hQb3NpdGlvbnMoKSx0aGlzfSxfY29ubmVjdFdpdGg6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLm9wdGlvbnM7cmV0dXJuIHQuY29ubmVjdFdpdGguY29uc3RydWN0b3I9PT1TdHJpbmc/W3QuY29ubmVjdFdpdGhdOnQuY29ubmVjdFdpdGh9LF9nZXRJdGVtc0FzalF1ZXJ5OmZ1bmN0aW9uKGUpe2Z1bmN0aW9uIGkoKXtyLnB1c2godGhpcyl9dmFyIHMsbixvLGEscj1bXSxoPVtdLGw9dGhpcy5fY29ubmVjdFdpdGgoKTtpZihsJiZlKWZvcihzPWwubGVuZ3RoLTE7cz49MDtzLS0pZm9yKG89dChsW3NdLHRoaXMuZG9jdW1lbnRbMF0pLG49by5sZW5ndGgtMTtuPj0wO24tLSlhPXQuZGF0YShvW25dLHRoaXMud2lkZ2V0RnVsbE5hbWUpLGEmJmEhPT10aGlzJiYhYS5vcHRpb25zLmRpc2FibGVkJiZoLnB1c2goW3QuaXNGdW5jdGlvbihhLm9wdGlvbnMuaXRlbXMpP2Eub3B0aW9ucy5pdGVtcy5jYWxsKGEuZWxlbWVudCk6dChhLm9wdGlvbnMuaXRlbXMsYS5lbGVtZW50KS5ub3QoIi51aS1zb3J0YWJsZS1oZWxwZXIiKS5ub3QoIi51aS1zb3J0YWJsZS1wbGFjZWhvbGRlciIpLGFdKTtmb3IoaC5wdXNoKFt0LmlzRnVuY3Rpb24odGhpcy5vcHRpb25zLml0ZW1zKT90aGlzLm9wdGlvbnMuaXRlbXMuY2FsbCh0aGlzLmVsZW1lbnQsbnVsbCx7b3B0aW9uczp0aGlzLm9wdGlvbnMsaXRlbTp0aGlzLmN1cnJlbnRJdGVtfSk6dCh0aGlzLm9wdGlvbnMuaXRlbXMsdGhpcy5lbGVtZW50KS5ub3QoIi51aS1zb3J0YWJsZS1oZWxwZXIiKS5ub3QoIi51aS1zb3J0YWJsZS1wbGFjZWhvbGRlciIpLHRoaXNdKSxzPWgubGVuZ3RoLTE7cz49MDtzLS0paFtzXVswXS5lYWNoKGkpO3JldHVybiB0KHIpfSxfcmVtb3ZlQ3VycmVudHNGcm9tSXRlbXM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLmN1cnJlbnRJdGVtLmZpbmQoIjpkYXRhKCIrdGhpcy53aWRnZXROYW1lKyItaXRlbSkiKTt0aGlzLml0ZW1zPXQuZ3JlcCh0aGlzLml0ZW1zLGZ1bmN0aW9uKHQpe2Zvcih2YXIgaT0wO2UubGVuZ3RoPmk7aSsrKWlmKGVbaV09PT10Lml0ZW1bMF0pcmV0dXJuITE7cmV0dXJuITB9KX0sX3JlZnJlc2hJdGVtczpmdW5jdGlvbihlKXt0aGlzLml0ZW1zPVtdLHRoaXMuY29udGFpbmVycz1bdGhpc107dmFyIGkscyxuLG8sYSxyLGgsbCxjPXRoaXMuaXRlbXMsdT1bW3QuaXNGdW5jdGlvbih0aGlzLm9wdGlvbnMuaXRlbXMpP3RoaXMub3B0aW9ucy5pdGVtcy5jYWxsKHRoaXMuZWxlbWVudFswXSxlLHtpdGVtOnRoaXMuY3VycmVudEl0ZW19KTp0KHRoaXMub3B0aW9ucy5pdGVtcyx0aGlzLmVsZW1lbnQpLHRoaXNdXSxkPXRoaXMuX2Nvbm5lY3RXaXRoKCk7aWYoZCYmdGhpcy5yZWFkeSlmb3IoaT1kLmxlbmd0aC0xO2k+PTA7aS0tKWZvcihuPXQoZFtpXSx0aGlzLmRvY3VtZW50WzBdKSxzPW4ubGVuZ3RoLTE7cz49MDtzLS0pbz10LmRhdGEobltzXSx0aGlzLndpZGdldEZ1bGxOYW1lKSxvJiZvIT09dGhpcyYmIW8ub3B0aW9ucy5kaXNhYmxlZCYmKHUucHVzaChbdC5pc0Z1bmN0aW9uKG8ub3B0aW9ucy5pdGVtcyk/by5vcHRpb25zLml0ZW1zLmNhbGwoby5lbGVtZW50WzBdLGUse2l0ZW06dGhpcy5jdXJyZW50SXRlbX0pOnQoby5vcHRpb25zLml0ZW1zLG8uZWxlbWVudCksb10pLHRoaXMuY29udGFpbmVycy5wdXNoKG8pKTtmb3IoaT11Lmxlbmd0aC0xO2k+PTA7aS0tKWZvcihhPXVbaV1bMV0scj11W2ldWzBdLHM9MCxsPXIubGVuZ3RoO2w+cztzKyspaD10KHJbc10pLGguZGF0YSh0aGlzLndpZGdldE5hbWUrIi1pdGVtIixhKSxjLnB1c2goe2l0ZW06aCxpbnN0YW5jZTphLHdpZHRoOjAsaGVpZ2h0OjAsbGVmdDowLHRvcDowfSl9LHJlZnJlc2hQb3NpdGlvbnM6ZnVuY3Rpb24oZSl7dGhpcy5mbG9hdGluZz10aGlzLml0ZW1zLmxlbmd0aD8ieCI9PT10aGlzLm9wdGlvbnMuYXhpc3x8dGhpcy5faXNGbG9hdGluZyh0aGlzLml0ZW1zWzBdLml0ZW0pOiExLHRoaXMub2Zmc2V0UGFyZW50JiZ0aGlzLmhlbHBlciYmKHRoaXMub2Zmc2V0LnBhcmVudD10aGlzLl9nZXRQYXJlbnRPZmZzZXQoKSk7dmFyIGkscyxuLG87Zm9yKGk9dGhpcy5pdGVtcy5sZW5ndGgtMTtpPj0wO2ktLSlzPXRoaXMuaXRlbXNbaV0scy5pbnN0YW5jZSE9PXRoaXMuY3VycmVudENvbnRhaW5lciYmdGhpcy5jdXJyZW50Q29udGFpbmVyJiZzLml0ZW1bMF0hPT10aGlzLmN1cnJlbnRJdGVtWzBdfHwobj10aGlzLm9wdGlvbnMudG9sZXJhbmNlRWxlbWVudD90KHRoaXMub3B0aW9ucy50b2xlcmFuY2VFbGVtZW50LHMuaXRlbSk6cy5pdGVtLGV8fChzLndpZHRoPW4ub3V0ZXJXaWR0aCgpLHMuaGVpZ2h0PW4ub3V0ZXJIZWlnaHQoKSksbz1uLm9mZnNldCgpLHMubGVmdD1vLmxlZnQscy50b3A9by50b3ApO2lmKHRoaXMub3B0aW9ucy5jdXN0b20mJnRoaXMub3B0aW9ucy5jdXN0b20ucmVmcmVzaENvbnRhaW5lcnMpdGhpcy5vcHRpb25zLmN1c3RvbS5yZWZyZXNoQ29udGFpbmVycy5jYWxsKHRoaXMpO2Vsc2UgZm9yKGk9dGhpcy5jb250YWluZXJzLmxlbmd0aC0xO2k+PTA7aS0tKW89dGhpcy5jb250YWluZXJzW2ldLmVsZW1lbnQub2Zmc2V0KCksdGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLmxlZnQ9by5sZWZ0LHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS50b3A9by50b3AsdGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLndpZHRoPXRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50Lm91dGVyV2lkdGgoKSx0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUuaGVpZ2h0PXRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50Lm91dGVySGVpZ2h0KCk7cmV0dXJuIHRoaXN9LF9jcmVhdGVQbGFjZWhvbGRlcjpmdW5jdGlvbihlKXtlPWV8fHRoaXM7dmFyIGkscz1lLm9wdGlvbnM7cy5wbGFjZWhvbGRlciYmcy5wbGFjZWhvbGRlci5jb25zdHJ1Y3RvciE9PVN0cmluZ3x8KGk9cy5wbGFjZWhvbGRlcixzLnBsYWNlaG9sZGVyPXtlbGVtZW50OmZ1bmN0aW9uKCl7dmFyIHM9ZS5jdXJyZW50SXRlbVswXS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLG49dCgiPCIrcysiPiIsZS5kb2N1bWVudFswXSk7cmV0dXJuIGUuX2FkZENsYXNzKG4sInVpLXNvcnRhYmxlLXBsYWNlaG9sZGVyIixpfHxlLmN1cnJlbnRJdGVtWzBdLmNsYXNzTmFtZSkuX3JlbW92ZUNsYXNzKG4sInVpLXNvcnRhYmxlLWhlbHBlciIpLCJ0Ym9keSI9PT1zP2UuX2NyZWF0ZVRyUGxhY2Vob2xkZXIoZS5jdXJyZW50SXRlbS5maW5kKCJ0ciIpLmVxKDApLHQoIjx0cj4iLGUuZG9jdW1lbnRbMF0pLmFwcGVuZFRvKG4pKToidHIiPT09cz9lLl9jcmVhdGVUclBsYWNlaG9sZGVyKGUuY3VycmVudEl0ZW0sbik6ImltZyI9PT1zJiZuLmF0dHIoInNyYyIsZS5jdXJyZW50SXRlbS5hdHRyKCJzcmMiKSksaXx8bi5jc3MoInZpc2liaWxpdHkiLCJoaWRkZW4iKSxufSx1cGRhdGU6ZnVuY3Rpb24odCxuKXsoIWl8fHMuZm9yY2VQbGFjZWhvbGRlclNpemUpJiYobi5oZWlnaHQoKXx8bi5oZWlnaHQoZS5jdXJyZW50SXRlbS5pbm5lckhlaWdodCgpLXBhcnNlSW50KGUuY3VycmVudEl0ZW0uY3NzKCJwYWRkaW5nVG9wIil8fDAsMTApLXBhcnNlSW50KGUuY3VycmVudEl0ZW0uY3NzKCJwYWRkaW5nQm90dG9tIil8fDAsMTApKSxuLndpZHRoKCl8fG4ud2lkdGgoZS5jdXJyZW50SXRlbS5pbm5lcldpZHRoKCktcGFyc2VJbnQoZS5jdXJyZW50SXRlbS5jc3MoInBhZGRpbmdMZWZ0Iil8fDAsMTApLXBhcnNlSW50KGUuY3VycmVudEl0ZW0uY3NzKCJwYWRkaW5nUmlnaHQiKXx8MCwxMCkpKX19KSxlLnBsYWNlaG9sZGVyPXQocy5wbGFjZWhvbGRlci5lbGVtZW50LmNhbGwoZS5lbGVtZW50LGUuY3VycmVudEl0ZW0pKSxlLmN1cnJlbnRJdGVtLmFmdGVyKGUucGxhY2Vob2xkZXIpLHMucGxhY2Vob2xkZXIudXBkYXRlKGUsZS5wbGFjZWhvbGRlcil9LF9jcmVhdGVUclBsYWNlaG9sZGVyOmZ1bmN0aW9uKGUsaSl7dmFyIHM9dGhpcztlLmNoaWxkcmVuKCkuZWFjaChmdW5jdGlvbigpe3QoIjx0ZD4mIzE2MDs8L3RkPiIscy5kb2N1bWVudFswXSkuYXR0cigiY29sc3BhbiIsdCh0aGlzKS5hdHRyKCJjb2xzcGFuIil8fDEpLmFwcGVuZFRvKGkpfSl9LF9jb250YWN0Q29udGFpbmVyczpmdW5jdGlvbihlKXt2YXIgaSxzLG4sbyxhLHIsaCxsLGMsdSxkPW51bGwscD1udWxsO2ZvcihpPXRoaXMuY29udGFpbmVycy5sZW5ndGgtMTtpPj0wO2ktLSlpZighdC5jb250YWlucyh0aGlzLmN1cnJlbnRJdGVtWzBdLHRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50WzBdKSlpZih0aGlzLl9pbnRlcnNlY3RzV2l0aCh0aGlzLmNvbnRhaW5lcnNbaV0uY29udGFpbmVyQ2FjaGUpKXtpZihkJiZ0LmNvbnRhaW5zKHRoaXMuY29udGFpbmVyc1tpXS5lbGVtZW50WzBdLGQuZWxlbWVudFswXSkpY29udGludWU7ZD10aGlzLmNvbnRhaW5lcnNbaV0scD1pfWVsc2UgdGhpcy5jb250YWluZXJzW2ldLmNvbnRhaW5lckNhY2hlLm92ZXImJih0aGlzLmNvbnRhaW5lcnNbaV0uX3RyaWdnZXIoIm91dCIsZSx0aGlzLl91aUhhc2godGhpcykpLHRoaXMuY29udGFpbmVyc1tpXS5jb250YWluZXJDYWNoZS5vdmVyPTApO2lmKGQpaWYoMT09PXRoaXMuY29udGFpbmVycy5sZW5ndGgpdGhpcy5jb250YWluZXJzW3BdLmNvbnRhaW5lckNhY2hlLm92ZXJ8fCh0aGlzLmNvbnRhaW5lcnNbcF0uX3RyaWdnZXIoIm92ZXIiLGUsdGhpcy5fdWlIYXNoKHRoaXMpKSx0aGlzLmNvbnRhaW5lcnNbcF0uY29udGFpbmVyQ2FjaGUub3Zlcj0xKTtlbHNle2ZvcihuPTFlNCxvPW51bGwsYz1kLmZsb2F0aW5nfHx0aGlzLl9pc0Zsb2F0aW5nKHRoaXMuY3VycmVudEl0ZW0pLGE9Yz8ibGVmdCI6InRvcCIscj1jPyJ3aWR0aCI6ImhlaWdodCIsdT1jPyJwYWdlWCI6InBhZ2VZIixzPXRoaXMuaXRlbXMubGVuZ3RoLTE7cz49MDtzLS0pdC5jb250YWlucyh0aGlzLmNvbnRhaW5lcnNbcF0uZWxlbWVudFswXSx0aGlzLml0ZW1zW3NdLml0ZW1bMF0pJiZ0aGlzLml0ZW1zW3NdLml0ZW1bMF0hPT10aGlzLmN1cnJlbnRJdGVtWzBdJiYoaD10aGlzLml0ZW1zW3NdLml0ZW0ub2Zmc2V0KClbYV0sbD0hMSxlW3VdLWg+dGhpcy5pdGVtc1tzXVtyXS8yJiYobD0hMCksbj5NYXRoLmFicyhlW3VdLWgpJiYobj1NYXRoLmFicyhlW3VdLWgpLG89dGhpcy5pdGVtc1tzXSx0aGlzLmRpcmVjdGlvbj1sPyJ1cCI6ImRvd24iKSk7aWYoIW8mJiF0aGlzLm9wdGlvbnMuZHJvcE9uRW1wdHkpcmV0dXJuO2lmKHRoaXMuY3VycmVudENvbnRhaW5lcj09PXRoaXMuY29udGFpbmVyc1twXSlyZXR1cm4gdGhpcy5jdXJyZW50Q29udGFpbmVyLmNvbnRhaW5lckNhY2hlLm92ZXJ8fCh0aGlzLmNvbnRhaW5lcnNbcF0uX3RyaWdnZXIoIm92ZXIiLGUsdGhpcy5fdWlIYXNoKCkpLHRoaXMuY3VycmVudENvbnRhaW5lci5jb250YWluZXJDYWNoZS5vdmVyPTEpLHZvaWQgMDtvP3RoaXMuX3JlYXJyYW5nZShlLG8sbnVsbCwhMCk6dGhpcy5fcmVhcnJhbmdlKGUsbnVsbCx0aGlzLmNvbnRhaW5lcnNbcF0uZWxlbWVudCwhMCksdGhpcy5fdHJpZ2dlcigiY2hhbmdlIixlLHRoaXMuX3VpSGFzaCgpKSx0aGlzLmNvbnRhaW5lcnNbcF0uX3RyaWdnZXIoImNoYW5nZSIsZSx0aGlzLl91aUhhc2godGhpcykpLHRoaXMuY3VycmVudENvbnRhaW5lcj10aGlzLmNvbnRhaW5lcnNbcF0sdGhpcy5vcHRpb25zLnBsYWNlaG9sZGVyLnVwZGF0ZSh0aGlzLmN1cnJlbnRDb250YWluZXIsdGhpcy5wbGFjZWhvbGRlciksdGhpcy5jb250YWluZXJzW3BdLl90cmlnZ2VyKCJvdmVyIixlLHRoaXMuX3VpSGFzaCh0aGlzKSksdGhpcy5jb250YWluZXJzW3BdLmNvbnRhaW5lckNhY2hlLm92ZXI9MX19LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5vcHRpb25zLHM9dC5pc0Z1bmN0aW9uKGkuaGVscGVyKT90KGkuaGVscGVyLmFwcGx5KHRoaXMuZWxlbWVudFswXSxbZSx0aGlzLmN1cnJlbnRJdGVtXSkpOiJjbG9uZSI9PT1pLmhlbHBlcj90aGlzLmN1cnJlbnRJdGVtLmNsb25lKCk6dGhpcy5jdXJyZW50SXRlbTtyZXR1cm4gcy5wYXJlbnRzKCJib2R5IikubGVuZ3RofHx0KCJwYXJlbnQiIT09aS5hcHBlbmRUbz9pLmFwcGVuZFRvOnRoaXMuY3VycmVudEl0ZW1bMF0ucGFyZW50Tm9kZSlbMF0uYXBwZW5kQ2hpbGQoc1swXSksc1swXT09PXRoaXMuY3VycmVudEl0ZW1bMF0mJih0aGlzLl9zdG9yZWRDU1M9e3dpZHRoOnRoaXMuY3VycmVudEl0ZW1bMF0uc3R5bGUud2lkdGgsaGVpZ2h0OnRoaXMuY3VycmVudEl0ZW1bMF0uc3R5bGUuaGVpZ2h0LHBvc2l0aW9uOnRoaXMuY3VycmVudEl0ZW0uY3NzKCJwb3NpdGlvbiIpLHRvcDp0aGlzLmN1cnJlbnRJdGVtLmNzcygidG9wIiksbGVmdDp0aGlzLmN1cnJlbnRJdGVtLmNzcygibGVmdCIpfSksKCFzWzBdLnN0eWxlLndpZHRofHxpLmZvcmNlSGVscGVyU2l6ZSkmJnMud2lkdGgodGhpcy5jdXJyZW50SXRlbS53aWR0aCgpKSwoIXNbMF0uc3R5bGUuaGVpZ2h0fHxpLmZvcmNlSGVscGVyU2l6ZSkmJnMuaGVpZ2h0KHRoaXMuY3VycmVudEl0ZW0uaGVpZ2h0KCkpLHN9LF9hZGp1c3RPZmZzZXRGcm9tSGVscGVyOmZ1bmN0aW9uKGUpeyJzdHJpbmciPT10eXBlb2YgZSYmKGU9ZS5zcGxpdCgiICIpKSx0LmlzQXJyYXkoZSkmJihlPXtsZWZ0OitlWzBdLHRvcDorZVsxXXx8MH0pLCJsZWZ0ImluIGUmJih0aGlzLm9mZnNldC5jbGljay5sZWZ0PWUubGVmdCt0aGlzLm1hcmdpbnMubGVmdCksInJpZ2h0ImluIGUmJih0aGlzLm9mZnNldC5jbGljay5sZWZ0PXRoaXMuaGVscGVyUHJvcG9ydGlvbnMud2lkdGgtZS5yaWdodCt0aGlzLm1hcmdpbnMubGVmdCksInRvcCJpbiBlJiYodGhpcy5vZmZzZXQuY2xpY2sudG9wPWUudG9wK3RoaXMubWFyZ2lucy50b3ApLCJib3R0b20iaW4gZSYmKHRoaXMub2Zmc2V0LmNsaWNrLnRvcD10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC1lLmJvdHRvbSt0aGlzLm1hcmdpbnMudG9wKX0sX2dldFBhcmVudE9mZnNldDpmdW5jdGlvbigpe3RoaXMub2Zmc2V0UGFyZW50PXRoaXMuaGVscGVyLm9mZnNldFBhcmVudCgpO3ZhciBlPXRoaXMub2Zmc2V0UGFyZW50Lm9mZnNldCgpO3JldHVybiJhYnNvbHV0ZSI9PT10aGlzLmNzc1Bvc2l0aW9uJiZ0aGlzLnNjcm9sbFBhcmVudFswXSE9PXRoaXMuZG9jdW1lbnRbMF0mJnQuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sdGhpcy5vZmZzZXRQYXJlbnRbMF0pJiYoZS5sZWZ0Kz10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxMZWZ0KCksZS50b3ArPXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpKSwodGhpcy5vZmZzZXRQYXJlbnRbMF09PT10aGlzLmRvY3VtZW50WzBdLmJvZHl8fHRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUmJiJodG1sIj09PXRoaXMub2Zmc2V0UGFyZW50WzBdLnRhZ05hbWUudG9Mb3dlckNhc2UoKSYmdC51aS5pZSkmJihlPXt0b3A6MCxsZWZ0OjB9KSx7dG9wOmUudG9wKyhwYXJzZUludCh0aGlzLm9mZnNldFBhcmVudC5jc3MoImJvcmRlclRvcFdpZHRoIiksMTApfHwwKSxsZWZ0OmUubGVmdCsocGFyc2VJbnQodGhpcy5vZmZzZXRQYXJlbnQuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApfX0sX2dldFJlbGF0aXZlT2Zmc2V0OmZ1bmN0aW9uKCl7aWYoInJlbGF0aXZlIj09PXRoaXMuY3NzUG9zaXRpb24pe3ZhciB0PXRoaXMuY3VycmVudEl0ZW0ucG9zaXRpb24oKTtyZXR1cm57dG9wOnQudG9wLShwYXJzZUludCh0aGlzLmhlbHBlci5jc3MoInRvcCIpLDEwKXx8MCkrdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsVG9wKCksbGVmdDp0LmxlZnQtKHBhcnNlSW50KHRoaXMuaGVscGVyLmNzcygibGVmdCIpLDEwKXx8MCkrdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpfX1yZXR1cm57dG9wOjAsbGVmdDowfX0sX2NhY2hlTWFyZ2luczpmdW5jdGlvbigpe3RoaXMubWFyZ2lucz17bGVmdDpwYXJzZUludCh0aGlzLmN1cnJlbnRJdGVtLmNzcygibWFyZ2luTGVmdCIpLDEwKXx8MCx0b3A6cGFyc2VJbnQodGhpcy5jdXJyZW50SXRlbS5jc3MoIm1hcmdpblRvcCIpLDEwKXx8MH19LF9jYWNoZUhlbHBlclByb3BvcnRpb25zOmZ1bmN0aW9uKCl7dGhpcy5oZWxwZXJQcm9wb3J0aW9ucz17d2lkdGg6dGhpcy5oZWxwZXIub3V0ZXJXaWR0aCgpLGhlaWdodDp0aGlzLmhlbHBlci5vdXRlckhlaWdodCgpfX0sX3NldENvbnRhaW5tZW50OmZ1bmN0aW9uKCl7dmFyIGUsaSxzLG49dGhpcy5vcHRpb25zOyJwYXJlbnQiPT09bi5jb250YWlubWVudCYmKG4uY29udGFpbm1lbnQ9dGhpcy5oZWxwZXJbMF0ucGFyZW50Tm9kZSksKCJkb2N1bWVudCI9PT1uLmNvbnRhaW5tZW50fHwid2luZG93Ij09PW4uY29udGFpbm1lbnQpJiYodGhpcy5jb250YWlubWVudD1bMC10aGlzLm9mZnNldC5yZWxhdGl2ZS5sZWZ0LXRoaXMub2Zmc2V0LnBhcmVudC5sZWZ0LDAtdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3AsImRvY3VtZW50Ij09PW4uY29udGFpbm1lbnQ/dGhpcy5kb2N1bWVudC53aWR0aCgpOnRoaXMud2luZG93LndpZHRoKCktdGhpcy5oZWxwZXJQcm9wb3J0aW9ucy53aWR0aC10aGlzLm1hcmdpbnMubGVmdCwoImRvY3VtZW50Ij09PW4uY29udGFpbm1lbnQ/dGhpcy5kb2N1bWVudC5oZWlnaHQoKXx8ZG9jdW1lbnQuYm9keS5wYXJlbnROb2RlLnNjcm9sbEhlaWdodDp0aGlzLndpbmRvdy5oZWlnaHQoKXx8dGhpcy5kb2N1bWVudFswXS5ib2R5LnBhcmVudE5vZGUuc2Nyb2xsSGVpZ2h0KS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXSksL14oZG9jdW1lbnR8d2luZG93fHBhcmVudCkkLy50ZXN0KG4uY29udGFpbm1lbnQpfHwoZT10KG4uY29udGFpbm1lbnQpWzBdLGk9dChuLmNvbnRhaW5tZW50KS5vZmZzZXQoKSxzPSJoaWRkZW4iIT09dChlKS5jc3MoIm92ZXJmbG93IiksdGhpcy5jb250YWlubWVudD1baS5sZWZ0KyhwYXJzZUludCh0KGUpLmNzcygiYm9yZGVyTGVmdFdpZHRoIiksMTApfHwwKSsocGFyc2VJbnQodChlKS5jc3MoInBhZGRpbmdMZWZ0IiksMTApfHwwKS10aGlzLm1hcmdpbnMubGVmdCxpLnRvcCsocGFyc2VJbnQodChlKS5jc3MoImJvcmRlclRvcFdpZHRoIiksMTApfHwwKSsocGFyc2VJbnQodChlKS5jc3MoInBhZGRpbmdUb3AiKSwxMCl8fDApLXRoaXMubWFyZ2lucy50b3AsaS5sZWZ0KyhzP01hdGgubWF4KGUuc2Nyb2xsV2lkdGgsZS5vZmZzZXRXaWR0aCk6ZS5vZmZzZXRXaWR0aCktKHBhcnNlSW50KHQoZSkuY3NzKCJib3JkZXJMZWZ0V2lkdGgiKSwxMCl8fDApLShwYXJzZUludCh0KGUpLmNzcygicGFkZGluZ1JpZ2h0IiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLndpZHRoLXRoaXMubWFyZ2lucy5sZWZ0LGkudG9wKyhzP01hdGgubWF4KGUuc2Nyb2xsSGVpZ2h0LGUub2Zmc2V0SGVpZ2h0KTplLm9mZnNldEhlaWdodCktKHBhcnNlSW50KHQoZSkuY3NzKCJib3JkZXJUb3BXaWR0aCIpLDEwKXx8MCktKHBhcnNlSW50KHQoZSkuY3NzKCJwYWRkaW5nQm90dG9tIiksMTApfHwwKS10aGlzLmhlbHBlclByb3BvcnRpb25zLmhlaWdodC10aGlzLm1hcmdpbnMudG9wXSl9LF9jb252ZXJ0UG9zaXRpb25UbzpmdW5jdGlvbihlLGkpe2l8fChpPXRoaXMucG9zaXRpb24pO3ZhciBzPSJhYnNvbHV0ZSI9PT1lPzE6LTEsbj0iYWJzb2x1dGUiIT09dGhpcy5jc3NQb3NpdGlvbnx8dGhpcy5zY3JvbGxQYXJlbnRbMF0hPT10aGlzLmRvY3VtZW50WzBdJiZ0LmNvbnRhaW5zKHRoaXMuc2Nyb2xsUGFyZW50WzBdLHRoaXMub2Zmc2V0UGFyZW50WzBdKT90aGlzLnNjcm9sbFBhcmVudDp0aGlzLm9mZnNldFBhcmVudCxvPS8oaHRtbHxib2R5KS9pLnRlc3QoblswXS50YWdOYW1lKTtyZXR1cm57dG9wOmkudG9wK3RoaXMub2Zmc2V0LnJlbGF0aXZlLnRvcCpzK3RoaXMub2Zmc2V0LnBhcmVudC50b3Aqcy0oImZpeGVkIj09PXRoaXMuY3NzUG9zaXRpb24/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbFRvcCgpOm8/MDpuLnNjcm9sbFRvcCgpKSpzLGxlZnQ6aS5sZWZ0K3RoaXMub2Zmc2V0LnJlbGF0aXZlLmxlZnQqcyt0aGlzLm9mZnNldC5wYXJlbnQubGVmdCpzLSgiZml4ZWQiPT09dGhpcy5jc3NQb3NpdGlvbj8tdGhpcy5zY3JvbGxQYXJlbnQuc2Nyb2xsTGVmdCgpOm8/MDpuLnNjcm9sbExlZnQoKSkqc319LF9nZW5lcmF0ZVBvc2l0aW9uOmZ1bmN0aW9uKGUpe3ZhciBpLHMsbj10aGlzLm9wdGlvbnMsbz1lLnBhZ2VYLGE9ZS5wYWdlWSxyPSJhYnNvbHV0ZSIhPT10aGlzLmNzc1Bvc2l0aW9ufHx0aGlzLnNjcm9sbFBhcmVudFswXSE9PXRoaXMuZG9jdW1lbnRbMF0mJnQuY29udGFpbnModGhpcy5zY3JvbGxQYXJlbnRbMF0sdGhpcy5vZmZzZXRQYXJlbnRbMF0pP3RoaXMuc2Nyb2xsUGFyZW50OnRoaXMub2Zmc2V0UGFyZW50LGg9LyhodG1sfGJvZHkpL2kudGVzdChyWzBdLnRhZ05hbWUpO3JldHVybiJyZWxhdGl2ZSIhPT10aGlzLmNzc1Bvc2l0aW9ufHx0aGlzLnNjcm9sbFBhcmVudFswXSE9PXRoaXMuZG9jdW1lbnRbMF0mJnRoaXMuc2Nyb2xsUGFyZW50WzBdIT09dGhpcy5vZmZzZXRQYXJlbnRbMF18fCh0aGlzLm9mZnNldC5yZWxhdGl2ZT10aGlzLl9nZXRSZWxhdGl2ZU9mZnNldCgpKSx0aGlzLm9yaWdpbmFsUG9zaXRpb24mJih0aGlzLmNvbnRhaW5tZW50JiYoZS5wYWdlWC10aGlzLm9mZnNldC5jbGljay5sZWZ0PHRoaXMuY29udGFpbm1lbnRbMF0mJihvPXRoaXMuY29udGFpbm1lbnRbMF0rdGhpcy5vZmZzZXQuY2xpY2subGVmdCksZS5wYWdlWS10aGlzLm9mZnNldC5jbGljay50b3A8dGhpcy5jb250YWlubWVudFsxXSYmKGE9dGhpcy5jb250YWlubWVudFsxXSt0aGlzLm9mZnNldC5jbGljay50b3ApLGUucGFnZVgtdGhpcy5vZmZzZXQuY2xpY2subGVmdD50aGlzLmNvbnRhaW5tZW50WzJdJiYobz10aGlzLmNvbnRhaW5tZW50WzJdK3RoaXMub2Zmc2V0LmNsaWNrLmxlZnQpLGUucGFnZVktdGhpcy5vZmZzZXQuY2xpY2sudG9wPnRoaXMuY29udGFpbm1lbnRbM10mJihhPXRoaXMuY29udGFpbm1lbnRbM10rdGhpcy5vZmZzZXQuY2xpY2sudG9wKSksbi5ncmlkJiYoaT10aGlzLm9yaWdpbmFsUGFnZVkrTWF0aC5yb3VuZCgoYS10aGlzLm9yaWdpbmFsUGFnZVkpL24uZ3JpZFsxXSkqbi5ncmlkWzFdLGE9dGhpcy5jb250YWlubWVudD9pLXRoaXMub2Zmc2V0LmNsaWNrLnRvcD49dGhpcy5jb250YWlubWVudFsxXSYmaS10aGlzLm9mZnNldC5jbGljay50b3A8PXRoaXMuY29udGFpbm1lbnRbM10/aTppLXRoaXMub2Zmc2V0LmNsaWNrLnRvcD49dGhpcy5jb250YWlubWVudFsxXT9pLW4uZ3JpZFsxXTppK24uZ3JpZFsxXTppLHM9dGhpcy5vcmlnaW5hbFBhZ2VYK01hdGgucm91bmQoKG8tdGhpcy5vcmlnaW5hbFBhZ2VYKS9uLmdyaWRbMF0pKm4uZ3JpZFswXSxvPXRoaXMuY29udGFpbm1lbnQ/cy10aGlzLm9mZnNldC5jbGljay5sZWZ0Pj10aGlzLmNvbnRhaW5tZW50WzBdJiZzLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ8PXRoaXMuY29udGFpbm1lbnRbMl0/czpzLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQ+PXRoaXMuY29udGFpbm1lbnRbMF0/cy1uLmdyaWRbMF06cytuLmdyaWRbMF06cykpLHt0b3A6YS10aGlzLm9mZnNldC5jbGljay50b3AtdGhpcy5vZmZzZXQucmVsYXRpdmUudG9wLXRoaXMub2Zmc2V0LnBhcmVudC50b3ArKCJmaXhlZCI9PT10aGlzLmNzc1Bvc2l0aW9uPy10aGlzLnNjcm9sbFBhcmVudC5zY3JvbGxUb3AoKTpoPzA6ci5zY3JvbGxUb3AoKSksbGVmdDpvLXRoaXMub2Zmc2V0LmNsaWNrLmxlZnQtdGhpcy5vZmZzZXQucmVsYXRpdmUubGVmdC10aGlzLm9mZnNldC5wYXJlbnQubGVmdCsoImZpeGVkIj09PXRoaXMuY3NzUG9zaXRpb24/LXRoaXMuc2Nyb2xsUGFyZW50LnNjcm9sbExlZnQoKTpoPzA6ci5zY3JvbGxMZWZ0KCkpfX0sX3JlYXJyYW5nZTpmdW5jdGlvbih0LGUsaSxzKXtpP2lbMF0uYXBwZW5kQ2hpbGQodGhpcy5wbGFjZWhvbGRlclswXSk6ZS5pdGVtWzBdLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMucGxhY2Vob2xkZXJbMF0sImRvd24iPT09dGhpcy5kaXJlY3Rpb24/ZS5pdGVtWzBdOmUuaXRlbVswXS5uZXh0U2libGluZyksdGhpcy5jb3VudGVyPXRoaXMuY291bnRlcj8rK3RoaXMuY291bnRlcjoxO3ZhciBuPXRoaXMuY291bnRlcjsKdGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtuPT09dGhpcy5jb3VudGVyJiZ0aGlzLnJlZnJlc2hQb3NpdGlvbnMoIXMpfSl9LF9jbGVhcjpmdW5jdGlvbih0LGUpe2Z1bmN0aW9uIGkodCxlLGkpe3JldHVybiBmdW5jdGlvbihzKXtpLl90cmlnZ2VyKHQscyxlLl91aUhhc2goZSkpfX10aGlzLnJldmVydGluZz0hMTt2YXIgcyxuPVtdO2lmKCF0aGlzLl9ub0ZpbmFsU29ydCYmdGhpcy5jdXJyZW50SXRlbS5wYXJlbnQoKS5sZW5ndGgmJnRoaXMucGxhY2Vob2xkZXIuYmVmb3JlKHRoaXMuY3VycmVudEl0ZW0pLHRoaXMuX25vRmluYWxTb3J0PW51bGwsdGhpcy5oZWxwZXJbMF09PT10aGlzLmN1cnJlbnRJdGVtWzBdKXtmb3IocyBpbiB0aGlzLl9zdG9yZWRDU1MpKCJhdXRvIj09PXRoaXMuX3N0b3JlZENTU1tzXXx8InN0YXRpYyI9PT10aGlzLl9zdG9yZWRDU1Nbc10pJiYodGhpcy5fc3RvcmVkQ1NTW3NdPSIiKTt0aGlzLmN1cnJlbnRJdGVtLmNzcyh0aGlzLl9zdG9yZWRDU1MpLHRoaXMuX3JlbW92ZUNsYXNzKHRoaXMuY3VycmVudEl0ZW0sInVpLXNvcnRhYmxlLWhlbHBlciIpfWVsc2UgdGhpcy5jdXJyZW50SXRlbS5zaG93KCk7Zm9yKHRoaXMuZnJvbU91dHNpZGUmJiFlJiZuLnB1c2goZnVuY3Rpb24odCl7dGhpcy5fdHJpZ2dlcigicmVjZWl2ZSIsdCx0aGlzLl91aUhhc2godGhpcy5mcm9tT3V0c2lkZSkpfSksIXRoaXMuZnJvbU91dHNpZGUmJnRoaXMuZG9tUG9zaXRpb24ucHJldj09PXRoaXMuY3VycmVudEl0ZW0ucHJldigpLm5vdCgiLnVpLXNvcnRhYmxlLWhlbHBlciIpWzBdJiZ0aGlzLmRvbVBvc2l0aW9uLnBhcmVudD09PXRoaXMuY3VycmVudEl0ZW0ucGFyZW50KClbMF18fGV8fG4ucHVzaChmdW5jdGlvbih0KXt0aGlzLl90cmlnZ2VyKCJ1cGRhdGUiLHQsdGhpcy5fdWlIYXNoKCkpfSksdGhpcyE9PXRoaXMuY3VycmVudENvbnRhaW5lciYmKGV8fChuLnB1c2goZnVuY3Rpb24odCl7dGhpcy5fdHJpZ2dlcigicmVtb3ZlIix0LHRoaXMuX3VpSGFzaCgpKX0pLG4ucHVzaChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7dC5fdHJpZ2dlcigicmVjZWl2ZSIsZSx0aGlzLl91aUhhc2godGhpcykpfX0uY2FsbCh0aGlzLHRoaXMuY3VycmVudENvbnRhaW5lcikpLG4ucHVzaChmdW5jdGlvbih0KXtyZXR1cm4gZnVuY3Rpb24oZSl7dC5fdHJpZ2dlcigidXBkYXRlIixlLHRoaXMuX3VpSGFzaCh0aGlzKSl9fS5jYWxsKHRoaXMsdGhpcy5jdXJyZW50Q29udGFpbmVyKSkpKSxzPXRoaXMuY29udGFpbmVycy5sZW5ndGgtMTtzPj0wO3MtLSllfHxuLnB1c2goaSgiZGVhY3RpdmF0ZSIsdGhpcyx0aGlzLmNvbnRhaW5lcnNbc10pKSx0aGlzLmNvbnRhaW5lcnNbc10uY29udGFpbmVyQ2FjaGUub3ZlciYmKG4ucHVzaChpKCJvdXQiLHRoaXMsdGhpcy5jb250YWluZXJzW3NdKSksdGhpcy5jb250YWluZXJzW3NdLmNvbnRhaW5lckNhY2hlLm92ZXI9MCk7aWYodGhpcy5zdG9yZWRDdXJzb3ImJih0aGlzLmRvY3VtZW50LmZpbmQoImJvZHkiKS5jc3MoImN1cnNvciIsdGhpcy5zdG9yZWRDdXJzb3IpLHRoaXMuc3RvcmVkU3R5bGVzaGVldC5yZW1vdmUoKSksdGhpcy5fc3RvcmVkT3BhY2l0eSYmdGhpcy5oZWxwZXIuY3NzKCJvcGFjaXR5Iix0aGlzLl9zdG9yZWRPcGFjaXR5KSx0aGlzLl9zdG9yZWRaSW5kZXgmJnRoaXMuaGVscGVyLmNzcygiekluZGV4IiwiYXV0byI9PT10aGlzLl9zdG9yZWRaSW5kZXg/IiI6dGhpcy5fc3RvcmVkWkluZGV4KSx0aGlzLmRyYWdnaW5nPSExLGV8fHRoaXMuX3RyaWdnZXIoImJlZm9yZVN0b3AiLHQsdGhpcy5fdWlIYXNoKCkpLHRoaXMucGxhY2Vob2xkZXJbMF0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnBsYWNlaG9sZGVyWzBdKSx0aGlzLmNhbmNlbEhlbHBlclJlbW92YWx8fCh0aGlzLmhlbHBlclswXSE9PXRoaXMuY3VycmVudEl0ZW1bMF0mJnRoaXMuaGVscGVyLnJlbW92ZSgpLHRoaXMuaGVscGVyPW51bGwpLCFlKXtmb3Iocz0wO24ubGVuZ3RoPnM7cysrKW5bc10uY2FsbCh0aGlzLHQpO3RoaXMuX3RyaWdnZXIoInN0b3AiLHQsdGhpcy5fdWlIYXNoKCkpfXJldHVybiB0aGlzLmZyb21PdXRzaWRlPSExLCF0aGlzLmNhbmNlbEhlbHBlclJlbW92YWx9LF90cmlnZ2VyOmZ1bmN0aW9uKCl7dC5XaWRnZXQucHJvdG90eXBlLl90cmlnZ2VyLmFwcGx5KHRoaXMsYXJndW1lbnRzKT09PSExJiZ0aGlzLmNhbmNlbCgpfSxfdWlIYXNoOmZ1bmN0aW9uKGUpe3ZhciBpPWV8fHRoaXM7cmV0dXJue2hlbHBlcjppLmhlbHBlcixwbGFjZWhvbGRlcjppLnBsYWNlaG9sZGVyfHx0KFtdKSxwb3NpdGlvbjppLnBvc2l0aW9uLG9yaWdpbmFsUG9zaXRpb246aS5vcmlnaW5hbFBvc2l0aW9uLG9mZnNldDppLnBvc2l0aW9uQWJzLGl0ZW06aS5jdXJyZW50SXRlbSxzZW5kZXI6ZT9lLmVsZW1lbnQ6bnVsbH19fSksdC53aWRnZXQoInVpLnNwaW5uZXIiLHt2ZXJzaW9uOiIxLjEyLjEiLGRlZmF1bHRFbGVtZW50OiI8aW5wdXQ+Iix3aWRnZXRFdmVudFByZWZpeDoic3BpbiIsb3B0aW9uczp7Y2xhc3Nlczp7InVpLXNwaW5uZXIiOiJ1aS1jb3JuZXItYWxsIiwidWktc3Bpbm5lci1kb3duIjoidWktY29ybmVyLWJyIiwidWktc3Bpbm5lci11cCI6InVpLWNvcm5lci10ciJ9LGN1bHR1cmU6bnVsbCxpY29uczp7ZG93bjoidWktaWNvbi10cmlhbmdsZS0xLXMiLHVwOiJ1aS1pY29uLXRyaWFuZ2xlLTEtbiJ9LGluY3JlbWVudGFsOiEwLG1heDpudWxsLG1pbjpudWxsLG51bWJlckZvcm1hdDpudWxsLHBhZ2U6MTAsc3RlcDoxLGNoYW5nZTpudWxsLHNwaW46bnVsbCxzdGFydDpudWxsLHN0b3A6bnVsbH0sX2NyZWF0ZTpmdW5jdGlvbigpe3RoaXMuX3NldE9wdGlvbigibWF4Iix0aGlzLm9wdGlvbnMubWF4KSx0aGlzLl9zZXRPcHRpb24oIm1pbiIsdGhpcy5vcHRpb25zLm1pbiksdGhpcy5fc2V0T3B0aW9uKCJzdGVwIix0aGlzLm9wdGlvbnMuc3RlcCksIiIhPT10aGlzLnZhbHVlKCkmJnRoaXMuX3ZhbHVlKHRoaXMuZWxlbWVudC52YWwoKSwhMCksdGhpcy5fZHJhdygpLHRoaXMuX29uKHRoaXMuX2V2ZW50cyksdGhpcy5fcmVmcmVzaCgpLHRoaXMuX29uKHRoaXMud2luZG93LHtiZWZvcmV1bmxvYWQ6ZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cigiYXV0b2NvbXBsZXRlIil9fSl9LF9nZXRDcmVhdGVPcHRpb25zOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fc3VwZXIoKSxpPXRoaXMuZWxlbWVudDtyZXR1cm4gdC5lYWNoKFsibWluIiwibWF4Iiwic3RlcCJdLGZ1bmN0aW9uKHQscyl7dmFyIG49aS5hdHRyKHMpO251bGwhPW4mJm4ubGVuZ3RoJiYoZVtzXT1uKX0pLGV9LF9ldmVudHM6e2tleWRvd246ZnVuY3Rpb24odCl7dGhpcy5fc3RhcnQodCkmJnRoaXMuX2tleWRvd24odCkmJnQucHJldmVudERlZmF1bHQoKX0sa2V5dXA6Il9zdG9wIixmb2N1czpmdW5jdGlvbigpe3RoaXMucHJldmlvdXM9dGhpcy5lbGVtZW50LnZhbCgpfSxibHVyOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmNhbmNlbEJsdXI/KGRlbGV0ZSB0aGlzLmNhbmNlbEJsdXIsdm9pZCAwKToodGhpcy5fc3RvcCgpLHRoaXMuX3JlZnJlc2goKSx0aGlzLnByZXZpb3VzIT09dGhpcy5lbGVtZW50LnZhbCgpJiZ0aGlzLl90cmlnZ2VyKCJjaGFuZ2UiLHQpLHZvaWQgMCl9LG1vdXNld2hlZWw6ZnVuY3Rpb24odCxlKXtpZihlKXtpZighdGhpcy5zcGlubmluZyYmIXRoaXMuX3N0YXJ0KHQpKXJldHVybiExO3RoaXMuX3NwaW4oKGU+MD8xOi0xKSp0aGlzLm9wdGlvbnMuc3RlcCx0KSxjbGVhclRpbWVvdXQodGhpcy5tb3VzZXdoZWVsVGltZXIpLHRoaXMubW91c2V3aGVlbFRpbWVyPXRoaXMuX2RlbGF5KGZ1bmN0aW9uKCl7dGhpcy5zcGlubmluZyYmdGhpcy5fc3RvcCh0KX0sMTAwKSx0LnByZXZlbnREZWZhdWx0KCl9fSwibW91c2Vkb3duIC51aS1zcGlubmVyLWJ1dHRvbiI6ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gaSgpe3ZhciBlPXRoaXMuZWxlbWVudFswXT09PXQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSk7ZXx8KHRoaXMuZWxlbWVudC50cmlnZ2VyKCJmb2N1cyIpLHRoaXMucHJldmlvdXM9cyx0aGlzLl9kZWxheShmdW5jdGlvbigpe3RoaXMucHJldmlvdXM9c30pKX12YXIgcztzPXRoaXMuZWxlbWVudFswXT09PXQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSk/dGhpcy5wcmV2aW91czp0aGlzLmVsZW1lbnQudmFsKCksZS5wcmV2ZW50RGVmYXVsdCgpLGkuY2FsbCh0aGlzKSx0aGlzLmNhbmNlbEJsdXI9ITAsdGhpcy5fZGVsYXkoZnVuY3Rpb24oKXtkZWxldGUgdGhpcy5jYW5jZWxCbHVyLGkuY2FsbCh0aGlzKX0pLHRoaXMuX3N0YXJ0KGUpIT09ITEmJnRoaXMuX3JlcGVhdChudWxsLHQoZS5jdXJyZW50VGFyZ2V0KS5oYXNDbGFzcygidWktc3Bpbm5lci11cCIpPzE6LTEsZSl9LCJtb3VzZXVwIC51aS1zcGlubmVyLWJ1dHRvbiI6Il9zdG9wIiwibW91c2VlbnRlciAudWktc3Bpbm5lci1idXR0b24iOmZ1bmN0aW9uKGUpe3JldHVybiB0KGUuY3VycmVudFRhcmdldCkuaGFzQ2xhc3MoInVpLXN0YXRlLWFjdGl2ZSIpP3RoaXMuX3N0YXJ0KGUpPT09ITE/ITE6KHRoaXMuX3JlcGVhdChudWxsLHQoZS5jdXJyZW50VGFyZ2V0KS5oYXNDbGFzcygidWktc3Bpbm5lci11cCIpPzE6LTEsZSksdm9pZCAwKTp2b2lkIDB9LCJtb3VzZWxlYXZlIC51aS1zcGlubmVyLWJ1dHRvbiI6Il9zdG9wIn0sX2VuaGFuY2U6ZnVuY3Rpb24oKXt0aGlzLnVpU3Bpbm5lcj10aGlzLmVsZW1lbnQuYXR0cigiYXV0b2NvbXBsZXRlIiwib2ZmIikud3JhcCgiPHNwYW4+IikucGFyZW50KCkuYXBwZW5kKCI8YT48L2E+PGE+PC9hPiIpfSxfZHJhdzpmdW5jdGlvbigpe3RoaXMuX2VuaGFuY2UoKSx0aGlzLl9hZGRDbGFzcyh0aGlzLnVpU3Bpbm5lciwidWktc3Bpbm5lciIsInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCIpLHRoaXMuX2FkZENsYXNzKCJ1aS1zcGlubmVyLWlucHV0IiksdGhpcy5lbGVtZW50LmF0dHIoInJvbGUiLCJzcGluYnV0dG9uIiksdGhpcy5idXR0b25zPXRoaXMudWlTcGlubmVyLmNoaWxkcmVuKCJhIikuYXR0cigidGFiSW5kZXgiLC0xKS5hdHRyKCJhcmlhLWhpZGRlbiIsITApLmJ1dHRvbih7Y2xhc3Nlczp7InVpLWJ1dHRvbiI6IiJ9fSksdGhpcy5fcmVtb3ZlQ2xhc3ModGhpcy5idXR0b25zLCJ1aS1jb3JuZXItYWxsIiksdGhpcy5fYWRkQ2xhc3ModGhpcy5idXR0b25zLmZpcnN0KCksInVpLXNwaW5uZXItYnV0dG9uIHVpLXNwaW5uZXItdXAiKSx0aGlzLl9hZGRDbGFzcyh0aGlzLmJ1dHRvbnMubGFzdCgpLCJ1aS1zcGlubmVyLWJ1dHRvbiB1aS1zcGlubmVyLWRvd24iKSx0aGlzLmJ1dHRvbnMuZmlyc3QoKS5idXR0b24oe2ljb246dGhpcy5vcHRpb25zLmljb25zLnVwLHNob3dMYWJlbDohMX0pLHRoaXMuYnV0dG9ucy5sYXN0KCkuYnV0dG9uKHtpY29uOnRoaXMub3B0aW9ucy5pY29ucy5kb3duLHNob3dMYWJlbDohMX0pLHRoaXMuYnV0dG9ucy5oZWlnaHQoKT5NYXRoLmNlaWwoLjUqdGhpcy51aVNwaW5uZXIuaGVpZ2h0KCkpJiZ0aGlzLnVpU3Bpbm5lci5oZWlnaHQoKT4wJiZ0aGlzLnVpU3Bpbm5lci5oZWlnaHQodGhpcy51aVNwaW5uZXIuaGVpZ2h0KCkpfSxfa2V5ZG93bjpmdW5jdGlvbihlKXt2YXIgaT10aGlzLm9wdGlvbnMscz10LnVpLmtleUNvZGU7c3dpdGNoKGUua2V5Q29kZSl7Y2FzZSBzLlVQOnJldHVybiB0aGlzLl9yZXBlYXQobnVsbCwxLGUpLCEwO2Nhc2Ugcy5ET1dOOnJldHVybiB0aGlzLl9yZXBlYXQobnVsbCwtMSxlKSwhMDtjYXNlIHMuUEFHRV9VUDpyZXR1cm4gdGhpcy5fcmVwZWF0KG51bGwsaS5wYWdlLGUpLCEwO2Nhc2Ugcy5QQUdFX0RPV046cmV0dXJuIHRoaXMuX3JlcGVhdChudWxsLC1pLnBhZ2UsZSksITB9cmV0dXJuITF9LF9zdGFydDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5zcGlubmluZ3x8dGhpcy5fdHJpZ2dlcigic3RhcnQiLHQpIT09ITE/KHRoaXMuY291bnRlcnx8KHRoaXMuY291bnRlcj0xKSx0aGlzLnNwaW5uaW5nPSEwLCEwKTohMX0sX3JlcGVhdDpmdW5jdGlvbih0LGUsaSl7dD10fHw1MDAsY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpLHRoaXMudGltZXI9dGhpcy5fZGVsYXkoZnVuY3Rpb24oKXt0aGlzLl9yZXBlYXQoNDAsZSxpKX0sdCksdGhpcy5fc3BpbihlKnRoaXMub3B0aW9ucy5zdGVwLGkpfSxfc3BpbjpmdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMudmFsdWUoKXx8MDt0aGlzLmNvdW50ZXJ8fCh0aGlzLmNvdW50ZXI9MSksaT10aGlzLl9hZGp1c3RWYWx1ZShpK3QqdGhpcy5faW5jcmVtZW50KHRoaXMuY291bnRlcikpLHRoaXMuc3Bpbm5pbmcmJnRoaXMuX3RyaWdnZXIoInNwaW4iLGUse3ZhbHVlOml9KT09PSExfHwodGhpcy5fdmFsdWUoaSksdGhpcy5jb3VudGVyKyspfSxfaW5jcmVtZW50OmZ1bmN0aW9uKGUpe3ZhciBpPXRoaXMub3B0aW9ucy5pbmNyZW1lbnRhbDtyZXR1cm4gaT90LmlzRnVuY3Rpb24oaSk/aShlKTpNYXRoLmZsb29yKGUqZSplLzVlNC1lKmUvNTAwKzE3KmUvMjAwKzEpOjF9LF9wcmVjaXNpb246ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9wcmVjaXNpb25PZih0aGlzLm9wdGlvbnMuc3RlcCk7cmV0dXJuIG51bGwhPT10aGlzLm9wdGlvbnMubWluJiYodD1NYXRoLm1heCh0LHRoaXMuX3ByZWNpc2lvbk9mKHRoaXMub3B0aW9ucy5taW4pKSksdH0sX3ByZWNpc2lvbk9mOmZ1bmN0aW9uKHQpe3ZhciBlPSIiK3QsaT1lLmluZGV4T2YoIi4iKTtyZXR1cm4tMT09PWk/MDplLmxlbmd0aC1pLTF9LF9hZGp1c3RWYWx1ZTpmdW5jdGlvbih0KXt2YXIgZSxpLHM9dGhpcy5vcHRpb25zO3JldHVybiBlPW51bGwhPT1zLm1pbj9zLm1pbjowLGk9dC1lLGk9TWF0aC5yb3VuZChpL3Muc3RlcCkqcy5zdGVwLHQ9ZStpLHQ9cGFyc2VGbG9hdCh0LnRvRml4ZWQodGhpcy5fcHJlY2lzaW9uKCkpKSxudWxsIT09cy5tYXgmJnQ+cy5tYXg/cy5tYXg6bnVsbCE9PXMubWluJiZzLm1pbj50P3MubWluOnR9LF9zdG9wOmZ1bmN0aW9uKHQpe3RoaXMuc3Bpbm5pbmcmJihjbGVhclRpbWVvdXQodGhpcy50aW1lciksY2xlYXJUaW1lb3V0KHRoaXMubW91c2V3aGVlbFRpbWVyKSx0aGlzLmNvdW50ZXI9MCx0aGlzLnNwaW5uaW5nPSExLHRoaXMuX3RyaWdnZXIoInN0b3AiLHQpKX0sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3ZhciBpLHMsbjtyZXR1cm4iY3VsdHVyZSI9PT10fHwibnVtYmVyRm9ybWF0Ij09PXQ/KGk9dGhpcy5fcGFyc2UodGhpcy5lbGVtZW50LnZhbCgpKSx0aGlzLm9wdGlvbnNbdF09ZSx0aGlzLmVsZW1lbnQudmFsKHRoaXMuX2Zvcm1hdChpKSksdm9pZCAwKTooKCJtYXgiPT09dHx8Im1pbiI9PT10fHwic3RlcCI9PT10KSYmInN0cmluZyI9PXR5cGVvZiBlJiYoZT10aGlzLl9wYXJzZShlKSksImljb25zIj09PXQmJihzPXRoaXMuYnV0dG9ucy5maXJzdCgpLmZpbmQoIi51aS1pY29uIiksdGhpcy5fcmVtb3ZlQ2xhc3MocyxudWxsLHRoaXMub3B0aW9ucy5pY29ucy51cCksdGhpcy5fYWRkQ2xhc3MocyxudWxsLGUudXApLG49dGhpcy5idXR0b25zLmxhc3QoKS5maW5kKCIudWktaWNvbiIpLHRoaXMuX3JlbW92ZUNsYXNzKG4sbnVsbCx0aGlzLm9wdGlvbnMuaWNvbnMuZG93biksdGhpcy5fYWRkQ2xhc3MobixudWxsLGUuZG93bikpLHRoaXMuX3N1cGVyKHQsZSksdm9pZCAwKX0sX3NldE9wdGlvbkRpc2FibGVkOmZ1bmN0aW9uKHQpe3RoaXMuX3N1cGVyKHQpLHRoaXMuX3RvZ2dsZUNsYXNzKHRoaXMudWlTcGlubmVyLG51bGwsInVpLXN0YXRlLWRpc2FibGVkIiwhIXQpLHRoaXMuZWxlbWVudC5wcm9wKCJkaXNhYmxlZCIsISF0KSx0aGlzLmJ1dHRvbnMuYnV0dG9uKHQ/ImRpc2FibGUiOiJlbmFibGUiKX0sX3NldE9wdGlvbnM6cihmdW5jdGlvbih0KXt0aGlzLl9zdXBlcih0KX0pLF9wYXJzZTpmdW5jdGlvbih0KXtyZXR1cm4ic3RyaW5nIj09dHlwZW9mIHQmJiIiIT09dCYmKHQ9d2luZG93Lkdsb2JhbGl6ZSYmdGhpcy5vcHRpb25zLm51bWJlckZvcm1hdD9HbG9iYWxpemUucGFyc2VGbG9hdCh0LDEwLHRoaXMub3B0aW9ucy5jdWx0dXJlKTordCksIiI9PT10fHxpc05hTih0KT9udWxsOnR9LF9mb3JtYXQ6ZnVuY3Rpb24odCl7cmV0dXJuIiI9PT10PyIiOndpbmRvdy5HbG9iYWxpemUmJnRoaXMub3B0aW9ucy5udW1iZXJGb3JtYXQ/R2xvYmFsaXplLmZvcm1hdCh0LHRoaXMub3B0aW9ucy5udW1iZXJGb3JtYXQsdGhpcy5vcHRpb25zLmN1bHR1cmUpOnR9LF9yZWZyZXNoOmZ1bmN0aW9uKCl7dGhpcy5lbGVtZW50LmF0dHIoeyJhcmlhLXZhbHVlbWluIjp0aGlzLm9wdGlvbnMubWluLCJhcmlhLXZhbHVlbWF4Ijp0aGlzLm9wdGlvbnMubWF4LCJhcmlhLXZhbHVlbm93Ijp0aGlzLl9wYXJzZSh0aGlzLmVsZW1lbnQudmFsKCkpfSl9LGlzVmFsaWQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLnZhbHVlKCk7cmV0dXJuIG51bGw9PT10PyExOnQ9PT10aGlzLl9hZGp1c3RWYWx1ZSh0KX0sX3ZhbHVlOmZ1bmN0aW9uKHQsZSl7dmFyIGk7IiIhPT10JiYoaT10aGlzLl9wYXJzZSh0KSxudWxsIT09aSYmKGV8fChpPXRoaXMuX2FkanVzdFZhbHVlKGkpKSx0PXRoaXMuX2Zvcm1hdChpKSkpLHRoaXMuZWxlbWVudC52YWwodCksdGhpcy5fcmVmcmVzaCgpfSxfZGVzdHJveTpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5wcm9wKCJkaXNhYmxlZCIsITEpLnJlbW92ZUF0dHIoImF1dG9jb21wbGV0ZSByb2xlIGFyaWEtdmFsdWVtaW4gYXJpYS12YWx1ZW1heCBhcmlhLXZhbHVlbm93IiksdGhpcy51aVNwaW5uZXIucmVwbGFjZVdpdGgodGhpcy5lbGVtZW50KX0sc3RlcFVwOnIoZnVuY3Rpb24odCl7dGhpcy5fc3RlcFVwKHQpfSksX3N0ZXBVcDpmdW5jdGlvbih0KXt0aGlzLl9zdGFydCgpJiYodGhpcy5fc3BpbigodHx8MSkqdGhpcy5vcHRpb25zLnN0ZXApLHRoaXMuX3N0b3AoKSl9LHN0ZXBEb3duOnIoZnVuY3Rpb24odCl7dGhpcy5fc3RlcERvd24odCl9KSxfc3RlcERvd246ZnVuY3Rpb24odCl7dGhpcy5fc3RhcnQoKSYmKHRoaXMuX3NwaW4oKHR8fDEpKi10aGlzLm9wdGlvbnMuc3RlcCksdGhpcy5fc3RvcCgpKX0scGFnZVVwOnIoZnVuY3Rpb24odCl7dGhpcy5fc3RlcFVwKCh0fHwxKSp0aGlzLm9wdGlvbnMucGFnZSl9KSxwYWdlRG93bjpyKGZ1bmN0aW9uKHQpe3RoaXMuX3N0ZXBEb3duKCh0fHwxKSp0aGlzLm9wdGlvbnMucGFnZSl9KSx2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8ocih0aGlzLl92YWx1ZSkuY2FsbCh0aGlzLHQpLHZvaWQgMCk6dGhpcy5fcGFyc2UodGhpcy5lbGVtZW50LnZhbCgpKX0sd2lkZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudWlTcGlubmVyfX0pLHQudWlCYWNrQ29tcGF0IT09ITEmJnQud2lkZ2V0KCJ1aS5zcGlubmVyIix0LnVpLnNwaW5uZXIse19lbmhhbmNlOmZ1bmN0aW9uKCl7dGhpcy51aVNwaW5uZXI9dGhpcy5lbGVtZW50LmF0dHIoImF1dG9jb21wbGV0ZSIsIm9mZiIpLndyYXAodGhpcy5fdWlTcGlubmVySHRtbCgpKS5wYXJlbnQoKS5hcHBlbmQodGhpcy5fYnV0dG9uSHRtbCgpKX0sX3VpU3Bpbm5lckh0bWw6ZnVuY3Rpb24oKXtyZXR1cm4iPHNwYW4+In0sX2J1dHRvbkh0bWw6ZnVuY3Rpb24oKXtyZXR1cm4iPGE+PC9hPjxhPjwvYT4ifX0pLHQudWkuc3Bpbm5lcix0LndpZGdldCgidWkudGFicyIse3ZlcnNpb246IjEuMTIuMSIsZGVsYXk6MzAwLG9wdGlvbnM6e2FjdGl2ZTpudWxsLGNsYXNzZXM6eyJ1aS10YWJzIjoidWktY29ybmVyLWFsbCIsInVpLXRhYnMtbmF2IjoidWktY29ybmVyLWFsbCIsInVpLXRhYnMtcGFuZWwiOiJ1aS1jb3JuZXItYm90dG9tIiwidWktdGFicy10YWIiOiJ1aS1jb3JuZXItdG9wIn0sY29sbGFwc2libGU6ITEsZXZlbnQ6ImNsaWNrIixoZWlnaHRTdHlsZToiY29udGVudCIsaGlkZTpudWxsLHNob3c6bnVsbCxhY3RpdmF0ZTpudWxsLGJlZm9yZUFjdGl2YXRlOm51bGwsYmVmb3JlTG9hZDpudWxsLGxvYWQ6bnVsbH0sX2lzTG9jYWw6ZnVuY3Rpb24oKXt2YXIgdD0vIy4qJC87cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciBpLHM7aT1lLmhyZWYucmVwbGFjZSh0LCIiKSxzPWxvY2F0aW9uLmhyZWYucmVwbGFjZSh0LCIiKTt0cnl7aT1kZWNvZGVVUklDb21wb25lbnQoaSl9Y2F0Y2gobil7fXRyeXtzPWRlY29kZVVSSUNvbXBvbmVudChzKX1jYXRjaChuKXt9cmV0dXJuIGUuaGFzaC5sZW5ndGg+MSYmaT09PXN9fSgpLF9jcmVhdGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLGk9dGhpcy5vcHRpb25zO3RoaXMucnVubmluZz0hMSx0aGlzLl9hZGRDbGFzcygidWktdGFicyIsInVpLXdpZGdldCB1aS13aWRnZXQtY29udGVudCIpLHRoaXMuX3RvZ2dsZUNsYXNzKCJ1aS10YWJzLWNvbGxhcHNpYmxlIixudWxsLGkuY29sbGFwc2libGUpLHRoaXMuX3Byb2Nlc3NUYWJzKCksaS5hY3RpdmU9dGhpcy5faW5pdGlhbEFjdGl2ZSgpLHQuaXNBcnJheShpLmRpc2FibGVkKSYmKGkuZGlzYWJsZWQ9dC51bmlxdWUoaS5kaXNhYmxlZC5jb25jYXQodC5tYXAodGhpcy50YWJzLmZpbHRlcigiLnVpLXN0YXRlLWRpc2FibGVkIiksZnVuY3Rpb24odCl7cmV0dXJuIGUudGFicy5pbmRleCh0KX0pKSkuc29ydCgpKSx0aGlzLmFjdGl2ZT10aGlzLm9wdGlvbnMuYWN0aXZlIT09ITEmJnRoaXMuYW5jaG9ycy5sZW5ndGg/dGhpcy5fZmluZEFjdGl2ZShpLmFjdGl2ZSk6dCgpLHRoaXMuX3JlZnJlc2goKSx0aGlzLmFjdGl2ZS5sZW5ndGgmJnRoaXMubG9hZChpLmFjdGl2ZSl9LF9pbml0aWFsQWN0aXZlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLmFjdGl2ZSxpPXRoaXMub3B0aW9ucy5jb2xsYXBzaWJsZSxzPWxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpO3JldHVybiBudWxsPT09ZSYmKHMmJnRoaXMudGFicy5lYWNoKGZ1bmN0aW9uKGksbil7cmV0dXJuIHQobikuYXR0cigiYXJpYS1jb250cm9scyIpPT09cz8oZT1pLCExKTp2b2lkIDB9KSxudWxsPT09ZSYmKGU9dGhpcy50YWJzLmluZGV4KHRoaXMudGFicy5maWx0ZXIoIi51aS10YWJzLWFjdGl2ZSIpKSksKG51bGw9PT1lfHwtMT09PWUpJiYoZT10aGlzLnRhYnMubGVuZ3RoPzA6ITEpKSxlIT09ITEmJihlPXRoaXMudGFicy5pbmRleCh0aGlzLnRhYnMuZXEoZSkpLC0xPT09ZSYmKGU9aT8hMTowKSksIWkmJmU9PT0hMSYmdGhpcy5hbmNob3JzLmxlbmd0aCYmKGU9MCksZX0sX2dldENyZWF0ZUV2ZW50RGF0YTpmdW5jdGlvbigpe3JldHVybnt0YWI6dGhpcy5hY3RpdmUscGFuZWw6dGhpcy5hY3RpdmUubGVuZ3RoP3RoaXMuX2dldFBhbmVsRm9yVGFiKHRoaXMuYWN0aXZlKTp0KCl9fSxfdGFiS2V5ZG93bjpmdW5jdGlvbihlKXt2YXIgaT10KHQudWkuc2FmZUFjdGl2ZUVsZW1lbnQodGhpcy5kb2N1bWVudFswXSkpLmNsb3Nlc3QoImxpIikscz10aGlzLnRhYnMuaW5kZXgoaSksbj0hMDtpZighdGhpcy5faGFuZGxlUGFnZU5hdihlKSl7c3dpdGNoKGUua2V5Q29kZSl7Y2FzZSB0LnVpLmtleUNvZGUuUklHSFQ6Y2FzZSB0LnVpLmtleUNvZGUuRE9XTjpzKys7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuVVA6Y2FzZSB0LnVpLmtleUNvZGUuTEVGVDpuPSExLHMtLTticmVhaztjYXNlIHQudWkua2V5Q29kZS5FTkQ6cz10aGlzLmFuY2hvcnMubGVuZ3RoLTE7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuSE9NRTpzPTA7YnJlYWs7Y2FzZSB0LnVpLmtleUNvZGUuU1BBQ0U6cmV0dXJuIGUucHJldmVudERlZmF1bHQoKSxjbGVhclRpbWVvdXQodGhpcy5hY3RpdmF0aW5nKSx0aGlzLl9hY3RpdmF0ZShzKSx2b2lkIDA7Y2FzZSB0LnVpLmtleUNvZGUuRU5URVI6cmV0dXJuIGUucHJldmVudERlZmF1bHQoKSxjbGVhclRpbWVvdXQodGhpcy5hY3RpdmF0aW5nKSx0aGlzLl9hY3RpdmF0ZShzPT09dGhpcy5vcHRpb25zLmFjdGl2ZT8hMTpzKSx2b2lkIDA7ZGVmYXVsdDpyZXR1cm59ZS5wcmV2ZW50RGVmYXVsdCgpLGNsZWFyVGltZW91dCh0aGlzLmFjdGl2YXRpbmcpLHM9dGhpcy5fZm9jdXNOZXh0VGFiKHMsbiksZS5jdHJsS2V5fHxlLm1ldGFLZXl8fChpLmF0dHIoImFyaWEtc2VsZWN0ZWQiLCJmYWxzZSIpLHRoaXMudGFicy5lcShzKS5hdHRyKCJhcmlhLXNlbGVjdGVkIiwidHJ1ZSIpLHRoaXMuYWN0aXZhdGluZz10aGlzLl9kZWxheShmdW5jdGlvbigpe3RoaXMub3B0aW9uKCJhY3RpdmUiLHMpfSx0aGlzLmRlbGF5KSl9fSxfcGFuZWxLZXlkb3duOmZ1bmN0aW9uKGUpe3RoaXMuX2hhbmRsZVBhZ2VOYXYoZSl8fGUuY3RybEtleSYmZS5rZXlDb2RlPT09dC51aS5rZXlDb2RlLlVQJiYoZS5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuYWN0aXZlLnRyaWdnZXIoImZvY3VzIikpfSxfaGFuZGxlUGFnZU5hdjpmdW5jdGlvbihlKXtyZXR1cm4gZS5hbHRLZXkmJmUua2V5Q29kZT09PXQudWkua2V5Q29kZS5QQUdFX1VQPyh0aGlzLl9hY3RpdmF0ZSh0aGlzLl9mb2N1c05leHRUYWIodGhpcy5vcHRpb25zLmFjdGl2ZS0xLCExKSksITApOmUuYWx0S2V5JiZlLmtleUNvZGU9PT10LnVpLmtleUNvZGUuUEFHRV9ET1dOPyh0aGlzLl9hY3RpdmF0ZSh0aGlzLl9mb2N1c05leHRUYWIodGhpcy5vcHRpb25zLmFjdGl2ZSsxLCEwKSksITApOnZvaWQgMH0sX2ZpbmROZXh0VGFiOmZ1bmN0aW9uKGUsaSl7ZnVuY3Rpb24gcygpe3JldHVybiBlPm4mJihlPTApLDA+ZSYmKGU9biksZX1mb3IodmFyIG49dGhpcy50YWJzLmxlbmd0aC0xOy0xIT09dC5pbkFycmF5KHMoKSx0aGlzLm9wdGlvbnMuZGlzYWJsZWQpOyllPWk/ZSsxOmUtMTtyZXR1cm4gZX0sX2ZvY3VzTmV4dFRhYjpmdW5jdGlvbih0LGUpe3JldHVybiB0PXRoaXMuX2ZpbmROZXh0VGFiKHQsZSksdGhpcy50YWJzLmVxKHQpLnRyaWdnZXIoImZvY3VzIiksdH0sX3NldE9wdGlvbjpmdW5jdGlvbih0LGUpe3JldHVybiJhY3RpdmUiPT09dD8odGhpcy5fYWN0aXZhdGUoZSksdm9pZCAwKToodGhpcy5fc3VwZXIodCxlKSwiY29sbGFwc2libGUiPT09dCYmKHRoaXMuX3RvZ2dsZUNsYXNzKCJ1aS10YWJzLWNvbGxhcHNpYmxlIixudWxsLGUpLGV8fHRoaXMub3B0aW9ucy5hY3RpdmUhPT0hMXx8dGhpcy5fYWN0aXZhdGUoMCkpLCJldmVudCI9PT10JiZ0aGlzLl9zZXR1cEV2ZW50cyhlKSwiaGVpZ2h0U3R5bGUiPT09dCYmdGhpcy5fc2V0dXBIZWlnaHRTdHlsZShlKSx2b2lkIDApfSxfc2FuaXRpemVTZWxlY3RvcjpmdW5jdGlvbih0KXtyZXR1cm4gdD90LnJlcGxhY2UoL1shIiQlJicoKSorLC5cLzo7PD0+P0BcW1xdXF5ge3x9fl0vZywiXFwkJiIpOiIifSxyZWZyZXNoOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcHRpb25zLGk9dGhpcy50YWJsaXN0LmNoaWxkcmVuKCI6aGFzKGFbaHJlZl0pIik7ZS5kaXNhYmxlZD10Lm1hcChpLmZpbHRlcigiLnVpLXN0YXRlLWRpc2FibGVkIiksZnVuY3Rpb24odCl7cmV0dXJuIGkuaW5kZXgodCl9KSx0aGlzLl9wcm9jZXNzVGFicygpLGUuYWN0aXZlIT09ITEmJnRoaXMuYW5jaG9ycy5sZW5ndGg/dGhpcy5hY3RpdmUubGVuZ3RoJiYhdC5jb250YWlucyh0aGlzLnRhYmxpc3RbMF0sdGhpcy5hY3RpdmVbMF0pP3RoaXMudGFicy5sZW5ndGg9PT1lLmRpc2FibGVkLmxlbmd0aD8oZS5hY3RpdmU9ITEsdGhpcy5hY3RpdmU9dCgpKTp0aGlzLl9hY3RpdmF0ZSh0aGlzLl9maW5kTmV4dFRhYihNYXRoLm1heCgwLGUuYWN0aXZlLTEpLCExKSk6ZS5hY3RpdmU9dGhpcy50YWJzLmluZGV4KHRoaXMuYWN0aXZlKTooZS5hY3RpdmU9ITEsdGhpcy5hY3RpdmU9dCgpKSx0aGlzLl9yZWZyZXNoKCl9LF9yZWZyZXNoOmZ1bmN0aW9uKCl7dGhpcy5fc2V0T3B0aW9uRGlzYWJsZWQodGhpcy5vcHRpb25zLmRpc2FibGVkKSx0aGlzLl9zZXR1cEV2ZW50cyh0aGlzLm9wdGlvbnMuZXZlbnQpLHRoaXMuX3NldHVwSGVpZ2h0U3R5bGUodGhpcy5vcHRpb25zLmhlaWdodFN0eWxlKSx0aGlzLnRhYnMubm90KHRoaXMuYWN0aXZlKS5hdHRyKHsiYXJpYS1zZWxlY3RlZCI6ImZhbHNlIiwiYXJpYS1leHBhbmRlZCI6ImZhbHNlIix0YWJJbmRleDotMX0pLHRoaXMucGFuZWxzLm5vdCh0aGlzLl9nZXRQYW5lbEZvclRhYih0aGlzLmFjdGl2ZSkpLmhpZGUoKS5hdHRyKHsiYXJpYS1oaWRkZW4iOiJ0cnVlIn0pLHRoaXMuYWN0aXZlLmxlbmd0aD8odGhpcy5hY3RpdmUuYXR0cih7ImFyaWEtc2VsZWN0ZWQiOiJ0cnVlIiwiYXJpYS1leHBhbmRlZCI6InRydWUiLHRhYkluZGV4OjB9KSx0aGlzLl9hZGRDbGFzcyh0aGlzLmFjdGl2ZSwidWktdGFicy1hY3RpdmUiLCJ1aS1zdGF0ZS1hY3RpdmUiKSx0aGlzLl9nZXRQYW5lbEZvclRhYih0aGlzLmFjdGl2ZSkuc2hvdygpLmF0dHIoeyJhcmlhLWhpZGRlbiI6ImZhbHNlIn0pKTp0aGlzLnRhYnMuZXEoMCkuYXR0cigidGFiSW5kZXgiLDApfSxfcHJvY2Vzc1RhYnM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLGk9dGhpcy50YWJzLHM9dGhpcy5hbmNob3JzLG49dGhpcy5wYW5lbHM7dGhpcy50YWJsaXN0PXRoaXMuX2dldExpc3QoKS5hdHRyKCJyb2xlIiwidGFibGlzdCIpLHRoaXMuX2FkZENsYXNzKHRoaXMudGFibGlzdCwidWktdGFicy1uYXYiLCJ1aS1oZWxwZXItcmVzZXQgdWktaGVscGVyLWNsZWFyZml4IHVpLXdpZGdldC1oZWFkZXIiKSx0aGlzLnRhYmxpc3Qub24oIm1vdXNlZG93biIrdGhpcy5ldmVudE5hbWVzcGFjZSwiPiBsaSIsZnVuY3Rpb24oZSl7dCh0aGlzKS5pcygiLnVpLXN0YXRlLWRpc2FibGVkIikmJmUucHJldmVudERlZmF1bHQoKX0pLm9uKCJmb2N1cyIrdGhpcy5ldmVudE5hbWVzcGFjZSwiLnVpLXRhYnMtYW5jaG9yIixmdW5jdGlvbigpe3QodGhpcykuY2xvc2VzdCgibGkiKS5pcygiLnVpLXN0YXRlLWRpc2FibGVkIikmJnRoaXMuYmx1cigpfSksdGhpcy50YWJzPXRoaXMudGFibGlzdC5maW5kKCI+IGxpOmhhcyhhW2hyZWZdKSIpLmF0dHIoe3JvbGU6InRhYiIsdGFiSW5kZXg6LTF9KSx0aGlzLl9hZGRDbGFzcyh0aGlzLnRhYnMsInVpLXRhYnMtdGFiIiwidWktc3RhdGUtZGVmYXVsdCIpLHRoaXMuYW5jaG9ycz10aGlzLnRhYnMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIHQoImEiLHRoaXMpWzBdfSkuYXR0cih7cm9sZToicHJlc2VudGF0aW9uIix0YWJJbmRleDotMX0pLHRoaXMuX2FkZENsYXNzKHRoaXMuYW5jaG9ycywidWktdGFicy1hbmNob3IiKSx0aGlzLnBhbmVscz10KCksdGhpcy5hbmNob3JzLmVhY2goZnVuY3Rpb24oaSxzKXt2YXIgbixvLGEscj10KHMpLnVuaXF1ZUlkKCkuYXR0cigiaWQiKSxoPXQocykuY2xvc2VzdCgibGkiKSxsPWguYXR0cigiYXJpYS1jb250cm9scyIpO2UuX2lzTG9jYWwocyk/KG49cy5oYXNoLGE9bi5zdWJzdHJpbmcoMSksbz1lLmVsZW1lbnQuZmluZChlLl9zYW5pdGl6ZVNlbGVjdG9yKG4pKSk6KGE9aC5hdHRyKCJhcmlhLWNvbnRyb2xzIil8fHQoe30pLnVuaXF1ZUlkKClbMF0uaWQsbj0iIyIrYSxvPWUuZWxlbWVudC5maW5kKG4pLG8ubGVuZ3RofHwobz1lLl9jcmVhdGVQYW5lbChhKSxvLmluc2VydEFmdGVyKGUucGFuZWxzW2ktMV18fGUudGFibGlzdCkpLG8uYXR0cigiYXJpYS1saXZlIiwicG9saXRlIikpLG8ubGVuZ3RoJiYoZS5wYW5lbHM9ZS5wYW5lbHMuYWRkKG8pKSxsJiZoLmRhdGEoInVpLXRhYnMtYXJpYS1jb250cm9scyIsbCksaC5hdHRyKHsiYXJpYS1jb250cm9scyI6YSwiYXJpYS1sYWJlbGxlZGJ5IjpyfSksby5hdHRyKCJhcmlhLWxhYmVsbGVkYnkiLHIpfSksdGhpcy5wYW5lbHMuYXR0cigicm9sZSIsInRhYnBhbmVsIiksdGhpcy5fYWRkQ2xhc3ModGhpcy5wYW5lbHMsInVpLXRhYnMtcGFuZWwiLCJ1aS13aWRnZXQtY29udGVudCIpLGkmJih0aGlzLl9vZmYoaS5ub3QodGhpcy50YWJzKSksdGhpcy5fb2ZmKHMubm90KHRoaXMuYW5jaG9ycykpLHRoaXMuX29mZihuLm5vdCh0aGlzLnBhbmVscykpKX0sX2dldExpc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50YWJsaXN0fHx0aGlzLmVsZW1lbnQuZmluZCgib2wsIHVsIikuZXEoMCl9LF9jcmVhdGVQYW5lbDpmdW5jdGlvbihlKXtyZXR1cm4gdCgiPGRpdj4iKS5hdHRyKCJpZCIsZSkuZGF0YSgidWktdGFicy1kZXN0cm95IiwhMCl9LF9zZXRPcHRpb25EaXNhYmxlZDpmdW5jdGlvbihlKXt2YXIgaSxzLG47Zm9yKHQuaXNBcnJheShlKSYmKGUubGVuZ3RoP2UubGVuZ3RoPT09dGhpcy5hbmNob3JzLmxlbmd0aCYmKGU9ITApOmU9ITEpLG49MDtzPXRoaXMudGFic1tuXTtuKyspaT10KHMpLGU9PT0hMHx8LTEhPT10LmluQXJyYXkobixlKT8oaS5hdHRyKCJhcmlhLWRpc2FibGVkIiwidHJ1ZSIpLHRoaXMuX2FkZENsYXNzKGksbnVsbCwidWktc3RhdGUtZGlzYWJsZWQiKSk6KGkucmVtb3ZlQXR0cigiYXJpYS1kaXNhYmxlZCIpLHRoaXMuX3JlbW92ZUNsYXNzKGksbnVsbCwidWktc3RhdGUtZGlzYWJsZWQiKSk7dGhpcy5vcHRpb25zLmRpc2FibGVkPWUsdGhpcy5fdG9nZ2xlQ2xhc3ModGhpcy53aWRnZXQoKSx0aGlzLndpZGdldEZ1bGxOYW1lKyItZGlzYWJsZWQiLG51bGwsZT09PSEwKX0sX3NldHVwRXZlbnRzOmZ1bmN0aW9uKGUpe3ZhciBpPXt9O2UmJnQuZWFjaChlLnNwbGl0KCIgIiksZnVuY3Rpb24odCxlKXtpW2VdPSJfZXZlbnRIYW5kbGVyIn0pLHRoaXMuX29mZih0aGlzLmFuY2hvcnMuYWRkKHRoaXMudGFicykuYWRkKHRoaXMucGFuZWxzKSksdGhpcy5fb24oITAsdGhpcy5hbmNob3JzLHtjbGljazpmdW5jdGlvbih0KXt0LnByZXZlbnREZWZhdWx0KCl9fSksdGhpcy5fb24odGhpcy5hbmNob3JzLGkpLHRoaXMuX29uKHRoaXMudGFicyx7a2V5ZG93bjoiX3RhYktleWRvd24ifSksdGhpcy5fb24odGhpcy5wYW5lbHMse2tleWRvd246Il9wYW5lbEtleWRvd24ifSksdGhpcy5fZm9jdXNhYmxlKHRoaXMudGFicyksdGhpcy5faG92ZXJhYmxlKHRoaXMudGFicyl9LF9zZXR1cEhlaWdodFN0eWxlOmZ1bmN0aW9uKGUpe3ZhciBpLHM9dGhpcy5lbGVtZW50LnBhcmVudCgpOyJmaWxsIj09PWU/KGk9cy5oZWlnaHQoKSxpLT10aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKS10aGlzLmVsZW1lbnQuaGVpZ2h0KCksdGhpcy5lbGVtZW50LnNpYmxpbmdzKCI6dmlzaWJsZSIpLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLHM9ZS5jc3MoInBvc2l0aW9uIik7ImFic29sdXRlIiE9PXMmJiJmaXhlZCIhPT1zJiYoaS09ZS5vdXRlckhlaWdodCghMCkpfSksdGhpcy5lbGVtZW50LmNoaWxkcmVuKCkubm90KHRoaXMucGFuZWxzKS5lYWNoKGZ1bmN0aW9uKCl7aS09dCh0aGlzKS5vdXRlckhlaWdodCghMCl9KSx0aGlzLnBhbmVscy5lYWNoKGZ1bmN0aW9uKCl7dCh0aGlzKS5oZWlnaHQoTWF0aC5tYXgoMCxpLXQodGhpcykuaW5uZXJIZWlnaHQoKSt0KHRoaXMpLmhlaWdodCgpKSl9KS5jc3MoIm92ZXJmbG93IiwiYXV0byIpKToiYXV0byI9PT1lJiYoaT0wLHRoaXMucGFuZWxzLmVhY2goZnVuY3Rpb24oKXtpPU1hdGgubWF4KGksdCh0aGlzKS5oZWlnaHQoIiIpLmhlaWdodCgpKX0pLmhlaWdodChpKSl9LF9ldmVudEhhbmRsZXI6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5vcHRpb25zLHM9dGhpcy5hY3RpdmUsbj10KGUuY3VycmVudFRhcmdldCksbz1uLmNsb3Nlc3QoImxpIiksYT1vWzBdPT09c1swXSxyPWEmJmkuY29sbGFwc2libGUsaD1yP3QoKTp0aGlzLl9nZXRQYW5lbEZvclRhYihvKSxsPXMubGVuZ3RoP3RoaXMuX2dldFBhbmVsRm9yVGFiKHMpOnQoKSxjPXtvbGRUYWI6cyxvbGRQYW5lbDpsLG5ld1RhYjpyP3QoKTpvLG5ld1BhbmVsOmh9O2UucHJldmVudERlZmF1bHQoKSxvLmhhc0NsYXNzKCJ1aS1zdGF0ZS1kaXNhYmxlZCIpfHxvLmhhc0NsYXNzKCJ1aS10YWJzLWxvYWRpbmciKXx8dGhpcy5ydW5uaW5nfHxhJiYhaS5jb2xsYXBzaWJsZXx8dGhpcy5fdHJpZ2dlcigiYmVmb3JlQWN0aXZhdGUiLGUsYyk9PT0hMXx8KGkuYWN0aXZlPXI/ITE6dGhpcy50YWJzLmluZGV4KG8pLHRoaXMuYWN0aXZlPWE/dCgpOm8sdGhpcy54aHImJnRoaXMueGhyLmFib3J0KCksbC5sZW5ndGh8fGgubGVuZ3RofHx0LmVycm9yKCJqUXVlcnkgVUkgVGFiczogTWlzbWF0Y2hpbmcgZnJhZ21lbnQgaWRlbnRpZmllci4iKSxoLmxlbmd0aCYmdGhpcy5sb2FkKHRoaXMudGFicy5pbmRleChvKSxlKSx0aGlzLl90b2dnbGUoZSxjKSl9LF90b2dnbGU6ZnVuY3Rpb24oZSxpKXtmdW5jdGlvbiBzKCl7by5ydW5uaW5nPSExLG8uX3RyaWdnZXIoImFjdGl2YXRlIixlLGkpfWZ1bmN0aW9uIG4oKXtvLl9hZGRDbGFzcyhpLm5ld1RhYi5jbG9zZXN0KCJsaSIpLCJ1aS10YWJzLWFjdGl2ZSIsInVpLXN0YXRlLWFjdGl2ZSIpLGEubGVuZ3RoJiZvLm9wdGlvbnMuc2hvdz9vLl9zaG93KGEsby5vcHRpb25zLnNob3cscyk6KGEuc2hvdygpLHMoKSl9dmFyIG89dGhpcyxhPWkubmV3UGFuZWwscj1pLm9sZFBhbmVsO3RoaXMucnVubmluZz0hMCxyLmxlbmd0aCYmdGhpcy5vcHRpb25zLmhpZGU/dGhpcy5faGlkZShyLHRoaXMub3B0aW9ucy5oaWRlLGZ1bmN0aW9uKCl7by5fcmVtb3ZlQ2xhc3MoaS5vbGRUYWIuY2xvc2VzdCgibGkiKSwidWktdGFicy1hY3RpdmUiLCJ1aS1zdGF0ZS1hY3RpdmUiKSxuKCl9KToodGhpcy5fcmVtb3ZlQ2xhc3MoaS5vbGRUYWIuY2xvc2VzdCgibGkiKSwidWktdGFicy1hY3RpdmUiLCJ1aS1zdGF0ZS1hY3RpdmUiKSxyLmhpZGUoKSxuKCkpLHIuYXR0cigiYXJpYS1oaWRkZW4iLCJ0cnVlIiksaS5vbGRUYWIuYXR0cih7ImFyaWEtc2VsZWN0ZWQiOiJmYWxzZSIsImFyaWEtZXhwYW5kZWQiOiJmYWxzZSJ9KSxhLmxlbmd0aCYmci5sZW5ndGg/aS5vbGRUYWIuYXR0cigidGFiSW5kZXgiLC0xKTphLmxlbmd0aCYmdGhpcy50YWJzLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAwPT09dCh0aGlzKS5hdHRyKCJ0YWJJbmRleCIpfSkuYXR0cigidGFiSW5kZXgiLC0xKSxhLmF0dHIoImFyaWEtaGlkZGVuIiwiZmFsc2UiKSxpLm5ld1RhYi5hdHRyKHsiYXJpYS1zZWxlY3RlZCI6InRydWUiLCJhcmlhLWV4cGFuZGVkIjoidHJ1ZSIsdGFiSW5kZXg6MH0pfSxfYWN0aXZhdGU6ZnVuY3Rpb24oZSl7dmFyIGkscz10aGlzLl9maW5kQWN0aXZlKGUpO3NbMF0hPT10aGlzLmFjdGl2ZVswXSYmKHMubGVuZ3RofHwocz10aGlzLmFjdGl2ZSksaT1zLmZpbmQoIi51aS10YWJzLWFuY2hvciIpWzBdLHRoaXMuX2V2ZW50SGFuZGxlcih7dGFyZ2V0OmksY3VycmVudFRhcmdldDppLHByZXZlbnREZWZhdWx0OnQubm9vcH0pKX0sX2ZpbmRBY3RpdmU6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT0hMT90KCk6dGhpcy50YWJzLmVxKGUpfSxfZ2V0SW5kZXg6ZnVuY3Rpb24oZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiBlJiYoZT10aGlzLmFuY2hvcnMuaW5kZXgodGhpcy5hbmNob3JzLmZpbHRlcigiW2hyZWYkPSciK3QudWkuZXNjYXBlU2VsZWN0b3IoZSkrIiddIikpKSxlfSxfZGVzdHJveTpmdW5jdGlvbigpe3RoaXMueGhyJiZ0aGlzLnhoci5hYm9ydCgpLHRoaXMudGFibGlzdC5yZW1vdmVBdHRyKCJyb2xlIikub2ZmKHRoaXMuZXZlbnROYW1lc3BhY2UpLHRoaXMuYW5jaG9ycy5yZW1vdmVBdHRyKCJyb2xlIHRhYkluZGV4IikucmVtb3ZlVW5pcXVlSWQoKSx0aGlzLnRhYnMuYWRkKHRoaXMucGFuZWxzKS5lYWNoKGZ1bmN0aW9uKCl7dC5kYXRhKHRoaXMsInVpLXRhYnMtZGVzdHJveSIpP3QodGhpcykucmVtb3ZlKCk6dCh0aGlzKS5yZW1vdmVBdHRyKCJyb2xlIHRhYkluZGV4IGFyaWEtbGl2ZSBhcmlhLWJ1c3kgYXJpYS1zZWxlY3RlZCBhcmlhLWxhYmVsbGVkYnkgYXJpYS1oaWRkZW4gYXJpYS1leHBhbmRlZCIpfSksdGhpcy50YWJzLmVhY2goZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLGk9ZS5kYXRhKCJ1aS10YWJzLWFyaWEtY29udHJvbHMiKTtpP2UuYXR0cigiYXJpYS1jb250cm9scyIsaSkucmVtb3ZlRGF0YSgidWktdGFicy1hcmlhLWNvbnRyb2xzIik6ZS5yZW1vdmVBdHRyKCJhcmlhLWNvbnRyb2xzIil9KSx0aGlzLnBhbmVscy5zaG93KCksImNvbnRlbnQiIT09dGhpcy5vcHRpb25zLmhlaWdodFN0eWxlJiZ0aGlzLnBhbmVscy5jc3MoImhlaWdodCIsIiIpfSxlbmFibGU6ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcy5vcHRpb25zLmRpc2FibGVkO2khPT0hMSYmKHZvaWQgMD09PWU/aT0hMTooZT10aGlzLl9nZXRJbmRleChlKSxpPXQuaXNBcnJheShpKT90Lm1hcChpLGZ1bmN0aW9uKHQpe3JldHVybiB0IT09ZT90Om51bGx9KTp0Lm1hcCh0aGlzLnRhYnMsZnVuY3Rpb24odCxpKXtyZXR1cm4gaSE9PWU/aTpudWxsfSkpLHRoaXMuX3NldE9wdGlvbkRpc2FibGVkKGkpKX0sZGlzYWJsZTpmdW5jdGlvbihlKXt2YXIgaT10aGlzLm9wdGlvbnMuZGlzYWJsZWQ7aWYoaSE9PSEwKXtpZih2b2lkIDA9PT1lKWk9ITA7ZWxzZXtpZihlPXRoaXMuX2dldEluZGV4KGUpLC0xIT09dC5pbkFycmF5KGUsaSkpcmV0dXJuO2k9dC5pc0FycmF5KGkpP3QubWVyZ2UoW2VdLGkpLnNvcnQoKTpbZV19dGhpcy5fc2V0T3B0aW9uRGlzYWJsZWQoaSl9fSxsb2FkOmZ1bmN0aW9uKGUsaSl7ZT10aGlzLl9nZXRJbmRleChlKTt2YXIgcz10aGlzLG49dGhpcy50YWJzLmVxKGUpLG89bi5maW5kKCIudWktdGFicy1hbmNob3IiKSxhPXRoaXMuX2dldFBhbmVsRm9yVGFiKG4pLHI9e3RhYjpuLHBhbmVsOmF9LGg9ZnVuY3Rpb24odCxlKXsiYWJvcnQiPT09ZSYmcy5wYW5lbHMuc3RvcCghMSwhMCkscy5fcmVtb3ZlQ2xhc3MobiwidWktdGFicy1sb2FkaW5nIiksYS5yZW1vdmVBdHRyKCJhcmlhLWJ1c3kiKSx0PT09cy54aHImJmRlbGV0ZSBzLnhocn07dGhpcy5faXNMb2NhbChvWzBdKXx8KHRoaXMueGhyPXQuYWpheCh0aGlzLl9hamF4U2V0dGluZ3MobyxpLHIpKSx0aGlzLnhociYmImNhbmNlbGVkIiE9PXRoaXMueGhyLnN0YXR1c1RleHQmJih0aGlzLl9hZGRDbGFzcyhuLCJ1aS10YWJzLWxvYWRpbmciKSxhLmF0dHIoImFyaWEtYnVzeSIsInRydWUiKSx0aGlzLnhoci5kb25lKGZ1bmN0aW9uKHQsZSxuKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YS5odG1sKHQpLHMuX3RyaWdnZXIoImxvYWQiLGksciksaChuLGUpfSwxKX0pLmZhaWwoZnVuY3Rpb24odCxlKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7aCh0LGUpfSwxKX0pKSl9LF9hamF4U2V0dGluZ3M6ZnVuY3Rpb24oZSxpLHMpe3ZhciBuPXRoaXM7cmV0dXJue3VybDplLmF0dHIoImhyZWYiKS5yZXBsYWNlKC8jLiokLywiIiksYmVmb3JlU2VuZDpmdW5jdGlvbihlLG8pe3JldHVybiBuLl90cmlnZ2VyKCJiZWZvcmVMb2FkIixpLHQuZXh0ZW5kKHtqcVhIUjplLGFqYXhTZXR0aW5nczpvfSxzKSl9fX0sX2dldFBhbmVsRm9yVGFiOmZ1bmN0aW9uKGUpe3ZhciBpPXQoZSkuYXR0cigiYXJpYS1jb250cm9scyIpO3JldHVybiB0aGlzLmVsZW1lbnQuZmluZCh0aGlzLl9zYW5pdGl6ZVNlbGVjdG9yKCIjIitpKSl9fSksdC51aUJhY2tDb21wYXQhPT0hMSYmdC53aWRnZXQoInVpLnRhYnMiLHQudWkudGFicyx7X3Byb2Nlc3NUYWJzOmZ1bmN0aW9uKCl7dGhpcy5fc3VwZXJBcHBseShhcmd1bWVudHMpLHRoaXMuX2FkZENsYXNzKHRoaXMudGFicywidWktdGFiIil9fSksdC51aS50YWJzLHQud2lkZ2V0KCJ1aS50b29sdGlwIix7dmVyc2lvbjoiMS4xMi4xIixvcHRpb25zOntjbGFzc2VzOnsidWktdG9vbHRpcCI6InVpLWNvcm5lci1hbGwgdWktd2lkZ2V0LXNoYWRvdyJ9LGNvbnRlbnQ6ZnVuY3Rpb24oKXt2YXIgZT10KHRoaXMpLmF0dHIoInRpdGxlIil8fCIiO3JldHVybiB0KCI8YT4iKS50ZXh0KGUpLmh0bWwoKX0saGlkZTohMCxpdGVtczoiW3RpdGxlXTpub3QoW2Rpc2FibGVkXSkiLHBvc2l0aW9uOntteToibGVmdCB0b3ArMTUiLGF0OiJsZWZ0IGJvdHRvbSIsY29sbGlzaW9uOiJmbGlwZml0IGZsaXAifSxzaG93OiEwLHRyYWNrOiExLGNsb3NlOm51bGwsb3BlbjpudWxsfSxfYWRkRGVzY3JpYmVkQnk6ZnVuY3Rpb24oZSxpKXt2YXIgcz0oZS5hdHRyKCJhcmlhLWRlc2NyaWJlZGJ5Iil8fCIiKS5zcGxpdCgvXHMrLyk7cy5wdXNoKGkpLGUuZGF0YSgidWktdG9vbHRpcC1pZCIsaSkuYXR0cigiYXJpYS1kZXNjcmliZWRieSIsdC50cmltKHMuam9pbigiICIpKSl9LF9yZW1vdmVEZXNjcmliZWRCeTpmdW5jdGlvbihlKXt2YXIgaT1lLmRhdGEoInVpLXRvb2x0aXAtaWQiKSxzPShlLmF0dHIoImFyaWEtZGVzY3JpYmVkYnkiKXx8IiIpLnNwbGl0KC9ccysvKSxuPXQuaW5BcnJheShpLHMpOy0xIT09biYmcy5zcGxpY2UobiwxKSxlLnJlbW92ZURhdGEoInVpLXRvb2x0aXAtaWQiKSxzPXQudHJpbShzLmpvaW4oIiAiKSkscz9lLmF0dHIoImFyaWEtZGVzY3JpYmVkYnkiLHMpOmUucmVtb3ZlQXR0cigiYXJpYS1kZXNjcmliZWRieSIpfSxfY3JlYXRlOmZ1bmN0aW9uKCl7dGhpcy5fb24oe21vdXNlb3Zlcjoib3BlbiIsZm9jdXNpbjoib3BlbiJ9KSx0aGlzLnRvb2x0aXBzPXt9LHRoaXMucGFyZW50cz17fSx0aGlzLmxpdmVSZWdpb249dCgiPGRpdj4iKS5hdHRyKHtyb2xlOiJsb2ciLCJhcmlhLWxpdmUiOiJhc3NlcnRpdmUiLCJhcmlhLXJlbGV2YW50IjoiYWRkaXRpb25zIn0pLmFwcGVuZFRvKHRoaXMuZG9jdW1lbnRbMF0uYm9keSksdGhpcy5fYWRkQ2xhc3ModGhpcy5saXZlUmVnaW9uLG51bGwsInVpLWhlbHBlci1oaWRkZW4tYWNjZXNzaWJsZSIpLHRoaXMuZGlzYWJsZWRUaXRsZXM9dChbXSl9LF9zZXRPcHRpb246ZnVuY3Rpb24oZSxpKXt2YXIgcz10aGlzO3RoaXMuX3N1cGVyKGUsaSksImNvbnRlbnQiPT09ZSYmdC5lYWNoKHRoaXMudG9vbHRpcHMsZnVuY3Rpb24odCxlKXtzLl91cGRhdGVDb250ZW50KGUuZWxlbWVudCl9KX0sX3NldE9wdGlvbkRpc2FibGVkOmZ1bmN0aW9uKHQpe3RoaXNbdD8iX2Rpc2FibGUiOiJfZW5hYmxlIl0oKX0sX2Rpc2FibGU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzO3QuZWFjaCh0aGlzLnRvb2x0aXBzLGZ1bmN0aW9uKGkscyl7dmFyIG49dC5FdmVudCgiYmx1ciIpO24udGFyZ2V0PW4uY3VycmVudFRhcmdldD1zLmVsZW1lbnRbMF0sZS5jbG9zZShuLCEwKX0pLHRoaXMuZGlzYWJsZWRUaXRsZXM9dGhpcy5kaXNhYmxlZFRpdGxlcy5hZGQodGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLml0ZW1zKS5hZGRCYWNrKCkuZmlsdGVyKGZ1bmN0aW9uKCl7dmFyIGU9dCh0aGlzKTtyZXR1cm4gZS5pcygiW3RpdGxlXSIpP2UuZGF0YSgidWktdG9vbHRpcC10aXRsZSIsZS5hdHRyKCJ0aXRsZSIpKS5yZW1vdmVBdHRyKCJ0aXRsZSIpOnZvaWQgMH0pKX0sX2VuYWJsZTpmdW5jdGlvbigpe3RoaXMuZGlzYWJsZWRUaXRsZXMuZWFjaChmdW5jdGlvbigpe3ZhciBlPXQodGhpcyk7ZS5kYXRhKCJ1aS10b29sdGlwLXRpdGxlIikmJmUuYXR0cigidGl0bGUiLGUuZGF0YSgidWktdG9vbHRpcC10aXRsZSIpKX0pLHRoaXMuZGlzYWJsZWRUaXRsZXM9dChbXSl9LG9wZW46ZnVuY3Rpb24oZSl7dmFyIGk9dGhpcyxzPXQoZT9lLnRhcmdldDp0aGlzLmVsZW1lbnQpLmNsb3Nlc3QodGhpcy5vcHRpb25zLml0ZW1zKTtzLmxlbmd0aCYmIXMuZGF0YSgidWktdG9vbHRpcC1pZCIpJiYocy5hdHRyKCJ0aXRsZSIpJiZzLmRhdGEoInVpLXRvb2x0aXAtdGl0bGUiLHMuYXR0cigidGl0bGUiKSkscy5kYXRhKCJ1aS10b29sdGlwLW9wZW4iLCEwKSxlJiYibW91c2VvdmVyIj09PWUudHlwZSYmcy5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpe3ZhciBlLHM9dCh0aGlzKTtzLmRhdGEoInVpLXRvb2x0aXAtb3BlbiIpJiYoZT10LkV2ZW50KCJibHVyIiksZS50YXJnZXQ9ZS5jdXJyZW50VGFyZ2V0PXRoaXMsaS5jbG9zZShlLCEwKSkscy5hdHRyKCJ0aXRsZSIpJiYocy51bmlxdWVJZCgpLGkucGFyZW50c1t0aGlzLmlkXT17ZWxlbWVudDp0aGlzLHRpdGxlOnMuYXR0cigidGl0bGUiKX0scy5hdHRyKCJ0aXRsZSIsIiIpKX0pLHRoaXMuX3JlZ2lzdGVyQ2xvc2VIYW5kbGVycyhlLHMpLHRoaXMuX3VwZGF0ZUNvbnRlbnQocyxlKSl9LF91cGRhdGVDb250ZW50OmZ1bmN0aW9uKHQsZSl7dmFyIGkscz10aGlzLm9wdGlvbnMuY29udGVudCxuPXRoaXMsbz1lP2UudHlwZTpudWxsO3JldHVybiJzdHJpbmciPT10eXBlb2Ygc3x8cy5ub2RlVHlwZXx8cy5qcXVlcnk/dGhpcy5fb3BlbihlLHQscyk6KGk9cy5jYWxsKHRbMF0sZnVuY3Rpb24oaSl7bi5fZGVsYXkoZnVuY3Rpb24oKXt0LmRhdGEoInVpLXRvb2x0aXAtb3BlbiIpJiYoZSYmKGUudHlwZT1vKSx0aGlzLl9vcGVuKGUsdCxpKSl9KX0pLGkmJnRoaXMuX29wZW4oZSx0LGkpLHZvaWQgMCl9LF9vcGVuOmZ1bmN0aW9uKGUsaSxzKXtmdW5jdGlvbiBuKHQpe2wub2Y9dCxhLmlzKCI6aGlkZGVuIil8fGEucG9zaXRpb24obCl9dmFyIG8sYSxyLGgsbD10LmV4dGVuZCh7fSx0aGlzLm9wdGlvbnMucG9zaXRpb24pO2lmKHMpe2lmKG89dGhpcy5fZmluZChpKSlyZXR1cm4gby50b29sdGlwLmZpbmQoIi51aS10b29sdGlwLWNvbnRlbnQiKS5odG1sKHMpLHZvaWQgMDtpLmlzKCJbdGl0bGVdIikmJihlJiYibW91c2VvdmVyIj09PWUudHlwZT9pLmF0dHIoInRpdGxlIiwiIik6aS5yZW1vdmVBdHRyKCJ0aXRsZSIpKSxvPXRoaXMuX3Rvb2x0aXAoaSksYT1vLnRvb2x0aXAsdGhpcy5fYWRkRGVzY3JpYmVkQnkoaSxhLmF0dHIoImlkIikpLGEuZmluZCgiLnVpLXRvb2x0aXAtY29udGVudCIpLmh0bWwocyksdGhpcy5saXZlUmVnaW9uLmNoaWxkcmVuKCkuaGlkZSgpLGg9dCgiPGRpdj4iKS5odG1sKGEuZmluZCgiLnVpLXRvb2x0aXAtY29udGVudCIpLmh0bWwoKSksaC5yZW1vdmVBdHRyKCJuYW1lIikuZmluZCgiW25hbWVdIikucmVtb3ZlQXR0cigibmFtZSIpLGgucmVtb3ZlQXR0cigiaWQiKS5maW5kKCJbaWRdIikucmVtb3ZlQXR0cigiaWQiKSxoLmFwcGVuZFRvKHRoaXMubGl2ZVJlZ2lvbiksdGhpcy5vcHRpb25zLnRyYWNrJiZlJiYvXm1vdXNlLy50ZXN0KGUudHlwZSk/KHRoaXMuX29uKHRoaXMuZG9jdW1lbnQse21vdXNlbW92ZTpufSksbihlKSk6YS5wb3NpdGlvbih0LmV4dGVuZCh7b2Y6aX0sdGhpcy5vcHRpb25zLnBvc2l0aW9uKSksYS5oaWRlKCksdGhpcy5fc2hvdyhhLHRoaXMub3B0aW9ucy5zaG93KSx0aGlzLm9wdGlvbnMudHJhY2smJnRoaXMub3B0aW9ucy5zaG93JiZ0aGlzLm9wdGlvbnMuc2hvdy5kZWxheSYmKHI9dGhpcy5kZWxheWVkU2hvdz1zZXRJbnRlcnZhbChmdW5jdGlvbigpe2EuaXMoIjp2aXNpYmxlIikmJihuKGwub2YpLGNsZWFySW50ZXJ2YWwocikpfSx0LmZ4LmludGVydmFsKSksdGhpcy5fdHJpZ2dlcigib3BlbiIsZSx7dG9vbHRpcDphfSl9fSxfcmVnaXN0ZXJDbG9zZUhhbmRsZXJzOmZ1bmN0aW9uKGUsaSl7dmFyIHM9e2tleXVwOmZ1bmN0aW9uKGUpe2lmKGUua2V5Q29kZT09PXQudWkua2V5Q29kZS5FU0NBUEUpe3ZhciBzPXQuRXZlbnQoZSk7cy5jdXJyZW50VGFyZ2V0PWlbMF0sdGhpcy5jbG9zZShzLCEwKX19fTtpWzBdIT09dGhpcy5lbGVtZW50WzBdJiYocy5yZW1vdmU9ZnVuY3Rpb24oKXt0aGlzLl9yZW1vdmVUb29sdGlwKHRoaXMuX2ZpbmQoaSkudG9vbHRpcCl9KSxlJiYibW91c2VvdmVyIiE9PWUudHlwZXx8KHMubW91c2VsZWF2ZT0iY2xvc2UiKSxlJiYiZm9jdXNpbiIhPT1lLnR5cGV8fChzLmZvY3Vzb3V0PSJjbG9zZSIpLHRoaXMuX29uKCEwLGkscyl9LGNsb3NlOmZ1bmN0aW9uKGUpe3ZhciBpLHM9dGhpcyxuPXQoZT9lLmN1cnJlbnRUYXJnZXQ6dGhpcy5lbGVtZW50KSxvPXRoaXMuX2ZpbmQobik7cmV0dXJuIG8/KGk9by50b29sdGlwLG8uY2xvc2luZ3x8KGNsZWFySW50ZXJ2YWwodGhpcy5kZWxheWVkU2hvdyksbi5kYXRhKCJ1aS10b29sdGlwLXRpdGxlIikmJiFuLmF0dHIoInRpdGxlIikmJm4uYXR0cigidGl0bGUiLG4uZGF0YSgidWktdG9vbHRpcC10aXRsZSIpKSx0aGlzLl9yZW1vdmVEZXNjcmliZWRCeShuKSxvLmhpZGluZz0hMCxpLnN0b3AoITApLHRoaXMuX2hpZGUoaSx0aGlzLm9wdGlvbnMuaGlkZSxmdW5jdGlvbigpe3MuX3JlbW92ZVRvb2x0aXAodCh0aGlzKSl9KSxuLnJlbW92ZURhdGEoInVpLXRvb2x0aXAtb3BlbiIpLHRoaXMuX29mZihuLCJtb3VzZWxlYXZlIGZvY3Vzb3V0IGtleXVwIiksblswXSE9PXRoaXMuZWxlbWVudFswXSYmdGhpcy5fb2ZmKG4sInJlbW92ZSIpLHRoaXMuX29mZih0aGlzLmRvY3VtZW50LCJtb3VzZW1vdmUiKSxlJiYibW91c2VsZWF2ZSI9PT1lLnR5cGUmJnQuZWFjaCh0aGlzLnBhcmVudHMsZnVuY3Rpb24oZSxpKXt0KGkuZWxlbWVudCkuYXR0cigidGl0bGUiLGkudGl0bGUpLGRlbGV0ZSBzLnBhcmVudHNbZV19KSxvLmNsb3Npbmc9ITAsdGhpcy5fdHJpZ2dlcigiY2xvc2UiLGUse3Rvb2x0aXA6aX0pLG8uaGlkaW5nfHwoby5jbG9zaW5nPSExKSksdm9pZCAwKToobi5yZW1vdmVEYXRhKCJ1aS10b29sdGlwLW9wZW4iKSx2b2lkIDApfSxfdG9vbHRpcDpmdW5jdGlvbihlKXt2YXIgaT10KCI8ZGl2PiIpLmF0dHIoInJvbGUiLCJ0b29sdGlwIikscz10KCI8ZGl2PiIpLmFwcGVuZFRvKGkpLG49aS51bmlxdWVJZCgpLmF0dHIoImlkIik7cmV0dXJuIHRoaXMuX2FkZENsYXNzKHMsInVpLXRvb2x0aXAtY29udGVudCIpLHRoaXMuX2FkZENsYXNzKGksInVpLXRvb2x0aXAiLCJ1aS13aWRnZXQgdWktd2lkZ2V0LWNvbnRlbnQiKSxpLmFwcGVuZFRvKHRoaXMuX2FwcGVuZFRvKGUpKSx0aGlzLnRvb2x0aXBzW25dPXtlbGVtZW50OmUsdG9vbHRpcDppfX0sX2ZpbmQ6ZnVuY3Rpb24odCl7dmFyIGU9dC5kYXRhKCJ1aS10b29sdGlwLWlkIik7cmV0dXJuIGU/dGhpcy50b29sdGlwc1tlXTpudWxsfSxfcmVtb3ZlVG9vbHRpcDpmdW5jdGlvbih0KXt0LnJlbW92ZSgpLGRlbGV0ZSB0aGlzLnRvb2x0aXBzW3QuYXR0cigiaWQiKV19LF9hcHBlbmRUbzpmdW5jdGlvbih0KXt2YXIgZT10LmNsb3Nlc3QoIi51aS1mcm9udCwgZGlhbG9nIik7cmV0dXJuIGUubGVuZ3RofHwoZT10aGlzLmRvY3VtZW50WzBdLmJvZHkpLGV9LF9kZXN0cm95OmZ1bmN0aW9uKCl7dmFyIGU9dGhpczt0LmVhY2godGhpcy50b29sdGlwcyxmdW5jdGlvbihpLHMpe3ZhciBuPXQuRXZlbnQoImJsdXIiKSxvPXMuZWxlbWVudDtuLnRhcmdldD1uLmN1cnJlbnRUYXJnZXQ9b1swXSxlLmNsb3NlKG4sITApLHQoIiMiK2kpLnJlbW92ZSgpLG8uZGF0YSgidWktdG9vbHRpcC10aXRsZSIpJiYoby5hdHRyKCJ0aXRsZSIpfHxvLmF0dHIoInRpdGxlIixvLmRhdGEoInVpLXRvb2x0aXAtdGl0bGUiKSksby5yZW1vdmVEYXRhKCJ1aS10b29sdGlwLXRpdGxlIikpfSksdGhpcy5saXZlUmVnaW9uLnJlbW92ZSgpfX0pLHQudWlCYWNrQ29tcGF0IT09ITEmJnQud2lkZ2V0KCJ1aS50b29sdGlwIix0LnVpLnRvb2x0aXAse29wdGlvbnM6e3Rvb2x0aXBDbGFzczpudWxsfSxfdG9vbHRpcDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX3N1cGVyQXBwbHkoYXJndW1lbnRzKTtyZXR1cm4gdGhpcy5vcHRpb25zLnRvb2x0aXBDbGFzcyYmdC50b29sdGlwLmFkZENsYXNzKHRoaXMub3B0aW9ucy50b29sdGlwQ2xhc3MpLHR9fSksdC51aS50b29sdGlwfSk7"},{"meta":{"name":"all.js","url":"https://api.stackexchange.com/js/2.0/all.js","ts":1609797271098,"mimetype":"text/javascript"},"source":"d2luZG93LlNFPWZ1bmN0aW9uKGUpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiB0KGUsdCl7dmFyIHI9ZVt0XTtpZighcil0aHJvdyB0KyIgcmVxdWlyZWQiO3JldHVybiByfWZ1bmN0aW9uIHIoZSl7aWYoIWUpdGhyb3cgZzt2YXIgcj10KGUsImNsaWVudElkIiksbz10KGUsImNoYW5uZWxVcmwiKSxuPXQoZSwiY29tcGxldGUiKSxkPXdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCx3PWQuc3Vic3RyaW5nKDAsZC5sZW5ndGgtMSksdT0oZCsiLy8iK3dpbmRvdy5sb2NhdGlvbi5ob3N0KS50b0xvd2VyQ2FzZSgpO2lmKGM9dChlLCJrZXkiKSxpPXIsYT1vLDAhPT1hLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih1KSl0aHJvdyJjaGFubmVsVXJsIG11c3QgYmUgdW5kZXIgdGhlIGN1cnJlbnQgZG9tYWluIjtzPWgrIi9vYXV0aC9kaWFsb2c/cmVkaXJlY3RfdXJpPSIrbChoKyIvb2F1dGgvbG9naW5fc3VjY2Vzcz9hc3Npc3RlZD0iK3IrIiZwcm90b2NvbD0iK3crIiZwcm94eT0iK2woYSkpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtuKHsidmVyc2lvbiI6IjM3NjAwIn0pfSl9ZnVuY3Rpb24gbyh0LHIsbyxuKXtmb3IodmFyIGkscz0ic2VjIit1KyssYT1tLGQ9ZnVuY3Rpb24oYSl7cmV0dXJuIHdpbmRvd1tzXT1lLGkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpKSxhLmVycm9yX2lkPyhuKHsiZXJyb3JOYW1lIjphLmVycm9yX25hbWUsImVycm9yTWVzc2FnZSI6YS5lcnJvcl9tZXNzYWdlfSksdm9pZCAwKToobyh7ImFjY2Vzc1Rva2VuIjp0LCJleHBpcmF0aW9uRGF0ZSI6ciwibmV0d29ya1VzZXJzIjphLml0ZW1zfSksdm9pZCAwKX07d2luZG93W3NdfHx3LmdldEVsZW1lbnRCeUlkKHMpOylzPSJzZWMiK3UrKzt3aW5kb3dbc109ZCxhKz0iP3BhZ2VzaXplPTEwMCZhY2Nlc3NfdG9rZW49IitsKHQpKyIma2V5PSIrbChjKSsiJmNhbGxiYWNrPSIrbChzKSxpPXcuY3JlYXRlRWxlbWVudCgic2NyaXB0IiksaS50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiLGkuc3JjPWEsaS5pZD1zLHcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXS5hcHBlbmRDaGlsZChpKX1mdW5jdGlvbiBuKGUpe2lmKCFlKXRocm93IGc7dmFyIHIsbixhLGMsdyxtPXQoZSwic3VjY2VzcyIpLGY9ZS5zY29wZSx2PSIiLGs9dSsrLHg9cysiJmNsaWVudF9pZD0iK2krIiZzdGF0ZT0iK2sseT1lLmVycm9yO2lmKGYmJiJbb2JqZWN0IEFycmF5XSIhPT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZikpdGhyb3cic2NvcGUgbXVzdCBiZSBhbiBBcnJheSI7ZiYmKHY9Zi5qb2luKCIgIikpLHYubGVuZ3RoPjAmJih4Kz0iJnNjb3BlPSIrbCh2KSksYz1mdW5jdGlvbih0KXtpZih0Lm9yaWdpbj09PWgmJnQuc291cmNlPT09YSl7dmFyIG4saSxzLGQsdz10LmRhdGEuc3Vic3RyaW5nKDEpLnNwbGl0KCImIiksbD17fTtmb3Iocz0wO3M8dy5sZW5ndGg7cysrKWQ9d1tzXS5zcGxpdCgiPSIpLGxbZFswXV09ZFsxXTtpZigrbC5zdGF0ZT09PWspcmV0dXJuIHImJndpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJtZXNzYWdlIixjKSxhLmNsb3NlKCksKGk9bC5hY2Nlc3NfdG9rZW4pPyhuPWwuZXhwaXJlcyxuJiYobj1uZXcgRGF0ZSgobmV3IERhdGUpLmdldFRpbWUoKSsxZTMqbikpLGUubmV0d29ya1VzZXJzP28oaSxuLG0seSk6bSh7ImFjY2Vzc1Rva2VuIjppLCJleHBpcmF0aW9uRGF0ZSI6bn0pLHZvaWQgMCk6KHkmJnkoeyJlcnJvck5hbWUiOmwuZXJyb3IsImVycm9yTWVzc2FnZSI6bC5lcnJvcl9kZXNjcmlwdGlvbn0pLHZvaWQgMCl9fSwhd2luZG93LnBvc3RNZXNzYWdlfHwhd2luZG93LmFkZEV2ZW50TGlzdGVuZXJ8fCgvTVNJRSAoXGQrXC5cZCspLy5leGVjKGQpfHxbXSlbMV08PTk/KG49ZnVuY3Rpb24oKXtpZihhKXtpZihhLmNsb3NlZClyZXR1cm4gY2xlYXJJbnRlcnZhbCh3KSx2b2lkIDA7dmFyIGU9YS5mcmFtZXNbInNlLWFwaS1mcmFtZSJdO2UmJihjbGVhckludGVydmFsKHcpLGMoeyJvcmlnaW4iOmgsInNvdXJjZSI6YSwiZGF0YSI6ZS5sb2NhdGlvbi5oYXNofSkpfX0sdz1zZXRJbnRlcnZhbChuLDUwKSk6KHI9ITAsd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLGMpKSxhPXdpbmRvdy5vcGVuKHgscCwid2lkdGg9NjYwLGhlaWdodD00ODAiKX12YXIgaSxzLGEsYyxkPXdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LHc9d2luZG93LmRvY3VtZW50LGw9d2luZG93LmVuY29kZVVSSUNvbXBvbmVudCx1PTEscD0ic2V3Iit1KyssaD0iaHR0cHM6Ly9zdGFja2V4Y2hhbmdlLmNvbSIsbT0iaHR0cHM6Ly9hcGkuc3RhY2tleGNoYW5nZS5jb20vMi4wL21lL2Fzc29jaWF0ZWQiLGc9Im11c3QgcGFzcyBhbiBvYmplY3QiO3JldHVybnsiYXV0aGVudGljYXRlIjpuLCJpbml0IjpyfX0oKTs="},{"meta":{"name":"jquery.timeago.min.js","url":"https://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.5.3/jquery.timeago.min.js","ts":1609797270313,"mimetype":"text/javascript"},"source":"IWZ1bmN0aW9uKHQpeyJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsianF1ZXJ5Il0sdCk6dCgib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmIm9iamVjdCI9PXR5cGVvZiBtb2R1bGUuZXhwb3J0cz9yZXF1aXJlKCJqcXVlcnkiKTpqUXVlcnkpfShmdW5jdGlvbih0KXtmdW5jdGlvbiBlKCl7dmFyIGU9ci5zZXR0aW5ncztpZihlLmF1dG9EaXNwb3NlJiYhdC5jb250YWlucyhkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsdGhpcykpcmV0dXJuIHQodGhpcykudGltZWFnbygiZGlzcG9zZSIpLHRoaXM7dmFyIG89aSh0aGlzKTtyZXR1cm4gaXNOYU4oby5kYXRldGltZSl8fCgwPT1lLmN1dG9mZnx8TWF0aC5hYnMobihvLmRhdGV0aW1lKSk8ZS5jdXRvZmY/dCh0aGlzKS50ZXh0KGEoby5kYXRldGltZSkpOnQodGhpcykuYXR0cigidGl0bGUiKS5sZW5ndGg+MCYmdCh0aGlzKS50ZXh0KHQodGhpcykuYXR0cigidGl0bGUiKSkpLHRoaXN9ZnVuY3Rpb24gaShlKXtpZihlPXQoZSksIWUuZGF0YSgidGltZWFnbyIpKXtlLmRhdGEoInRpbWVhZ28iLHtkYXRldGltZTpyLmRhdGV0aW1lKGUpfSk7dmFyIGk9dC50cmltKGUudGV4dCgpKTtyLnNldHRpbmdzLmxvY2FsZVRpdGxlP2UuYXR0cigidGl0bGUiLGUuZGF0YSgidGltZWFnbyIpLmRhdGV0aW1lLnRvTG9jYWxlU3RyaW5nKCkpOiEoaS5sZW5ndGg+MCl8fHIuaXNUaW1lKGUpJiZlLmF0dHIoInRpdGxlIil8fGUuYXR0cigidGl0bGUiLGkpfXJldHVybiBlLmRhdGEoInRpbWVhZ28iKX1mdW5jdGlvbiBhKHQpe3JldHVybiByLmluV29yZHMobih0KSl9ZnVuY3Rpb24gbih0KXtyZXR1cm4obmV3IERhdGUpLmdldFRpbWUoKS10LmdldFRpbWUoKX10LnRpbWVhZ289ZnVuY3Rpb24oZSl7cmV0dXJuIGEoZSBpbnN0YW5jZW9mIERhdGU/ZToic3RyaW5nIj09dHlwZW9mIGU/dC50aW1lYWdvLnBhcnNlKGUpOiJudW1iZXIiPT10eXBlb2YgZT9uZXcgRGF0ZShlKTp0LnRpbWVhZ28uZGF0ZXRpbWUoZSkpfTt2YXIgcj10LnRpbWVhZ287dC5leHRlbmQodC50aW1lYWdvLHtzZXR0aW5nczp7cmVmcmVzaE1pbGxpczo2ZTQsYWxsb3dQYXN0OiEwLGFsbG93RnV0dXJlOiExLGxvY2FsZVRpdGxlOiExLGN1dG9mZjowLGF1dG9EaXNwb3NlOiEwLHN0cmluZ3M6e3ByZWZpeEFnbzpudWxsLHByZWZpeEZyb21Ob3c6bnVsbCxzdWZmaXhBZ286ImFnbyIsc3VmZml4RnJvbU5vdzoiZnJvbSBub3ciLGluUGFzdDoiYW55IG1vbWVudCBub3ciLHNlY29uZHM6Imxlc3MgdGhhbiBhIG1pbnV0ZSIsbWludXRlOiJhYm91dCBhIG1pbnV0ZSIsbWludXRlczoiJWQgbWludXRlcyIsaG91cjoiYWJvdXQgYW4gaG91ciIsaG91cnM6ImFib3V0ICVkIGhvdXJzIixkYXk6ImEgZGF5IixkYXlzOiIlZCBkYXlzIixtb250aDoiYWJvdXQgYSBtb250aCIsbW9udGhzOiIlZCBtb250aHMiLHllYXI6ImFib3V0IGEgeWVhciIseWVhcnM6IiVkIHllYXJzIix3b3JkU2VwYXJhdG9yOiIgIixudW1iZXJzOltdfX0saW5Xb3JkczpmdW5jdGlvbihlKXtmdW5jdGlvbiBpKGksbil7dmFyIHI9dC5pc0Z1bmN0aW9uKGkpP2kobixlKTppLG89YS5udW1iZXJzJiZhLm51bWJlcnNbbl18fG47cmV0dXJuIHIucmVwbGFjZSgvJWQvaSxvKX1pZighdGhpcy5zZXR0aW5ncy5hbGxvd1Bhc3QmJiF0aGlzLnNldHRpbmdzLmFsbG93RnV0dXJlKXRocm93InRpbWVhZ28gYWxsb3dQYXN0IGFuZCBhbGxvd0Z1dHVyZSBzZXR0aW5ncyBjYW4gbm90IGJvdGggYmUgc2V0IHRvIGZhbHNlLiI7dmFyIGE9dGhpcy5zZXR0aW5ncy5zdHJpbmdzLG49YS5wcmVmaXhBZ28scj1hLnN1ZmZpeEFnbztpZih0aGlzLnNldHRpbmdzLmFsbG93RnV0dXJlJiYwPmUmJihuPWEucHJlZml4RnJvbU5vdyxyPWEuc3VmZml4RnJvbU5vdyksIXRoaXMuc2V0dGluZ3MuYWxsb3dQYXN0JiZlPj0wKXJldHVybiB0aGlzLnNldHRpbmdzLnN0cmluZ3MuaW5QYXN0O3ZhciBvPU1hdGguYWJzKGUpLzFlMyxzPW8vNjAsdT1zLzYwLG09dS8yNCxsPW0vMzY1LGQ9NDU+byYmaShhLnNlY29uZHMsTWF0aC5yb3VuZChvKSl8fDkwPm8mJmkoYS5taW51dGUsMSl8fDQ1PnMmJmkoYS5taW51dGVzLE1hdGgucm91bmQocykpfHw5MD5zJiZpKGEuaG91ciwxKXx8MjQ+dSYmaShhLmhvdXJzLE1hdGgucm91bmQodSkpfHw0Mj51JiZpKGEuZGF5LDEpfHwzMD5tJiZpKGEuZGF5cyxNYXRoLnJvdW5kKG0pKXx8NDU+bSYmaShhLm1vbnRoLDEpfHwzNjU+bSYmaShhLm1vbnRocyxNYXRoLnJvdW5kKG0vMzApKXx8MS41PmwmJmkoYS55ZWFyLDEpfHxpKGEueWVhcnMsTWF0aC5yb3VuZChsKSksaD1hLndvcmRTZXBhcmF0b3J8fCIiO3JldHVybiB2b2lkIDA9PT1hLndvcmRTZXBhcmF0b3ImJihoPSIgIiksdC50cmltKFtuLGQscl0uam9pbihoKSl9LHBhcnNlOmZ1bmN0aW9uKGUpe3ZhciBpPXQudHJpbShlKTtyZXR1cm4gaT1pLnJlcGxhY2UoL1wuXGQrLywiIiksaT1pLnJlcGxhY2UoLy0vLCIvIikucmVwbGFjZSgvLS8sIi8iKSxpPWkucmVwbGFjZSgvVC8sIiAiKS5yZXBsYWNlKC9aLywiIFVUQyIpLGk9aS5yZXBsYWNlKC8oW1wrXC1dXGRcZClcOj8oXGRcZCkvLCIgJDEkMiIpLGk9aS5yZXBsYWNlKC8oW1wrXC1dXGRcZCkkLywiICQxMDAiKSxuZXcgRGF0ZShpKX0sZGF0ZXRpbWU6ZnVuY3Rpb24oZSl7dmFyIGk9ci5pc1RpbWUoZSk/dChlKS5hdHRyKCJkYXRldGltZSIpOnQoZSkuYXR0cigidGl0bGUiKTtyZXR1cm4gci5wYXJzZShpKX0saXNUaW1lOmZ1bmN0aW9uKGUpe3JldHVybiJ0aW1lIj09PXQoZSkuZ2V0KDApLnRhZ05hbWUudG9Mb3dlckNhc2UoKX19KTt2YXIgbz17aW5pdDpmdW5jdGlvbigpe3ZhciBpPXQucHJveHkoZSx0aGlzKTtpKCk7dmFyIGE9ci5zZXR0aW5nczthLnJlZnJlc2hNaWxsaXM+MCYmKHRoaXMuX3RpbWVhZ29JbnRlcnZhbD1zZXRJbnRlcnZhbChpLGEucmVmcmVzaE1pbGxpcykpfSx1cGRhdGU6ZnVuY3Rpb24oaSl7dmFyIGE9aSBpbnN0YW5jZW9mIERhdGU/aTpyLnBhcnNlKGkpO3QodGhpcykuZGF0YSgidGltZWFnbyIse2RhdGV0aW1lOmF9KSxyLnNldHRpbmdzLmxvY2FsZVRpdGxlJiZ0KHRoaXMpLmF0dHIoInRpdGxlIixhLnRvTG9jYWxlU3RyaW5nKCkpLGUuYXBwbHkodGhpcyl9LHVwZGF0ZUZyb21ET006ZnVuY3Rpb24oKXt0KHRoaXMpLmRhdGEoInRpbWVhZ28iLHtkYXRldGltZTpyLnBhcnNlKHIuaXNUaW1lKHRoaXMpP3QodGhpcykuYXR0cigiZGF0ZXRpbWUiKTp0KHRoaXMpLmF0dHIoInRpdGxlIikpfSksZS5hcHBseSh0aGlzKX0sZGlzcG9zZTpmdW5jdGlvbigpe3RoaXMuX3RpbWVhZ29JbnRlcnZhbCYmKHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX3RpbWVhZ29JbnRlcnZhbCksdGhpcy5fdGltZWFnb0ludGVydmFsPW51bGwpfX07dC5mbi50aW1lYWdvPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dD9vW3RdOm8uaW5pdDtpZighaSl0aHJvdyBuZXcgRXJyb3IoIlVua25vd24gZnVuY3Rpb24gbmFtZSAnIit0KyInIGZvciB0aW1lYWdvIik7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2kuY2FsbCh0aGlzLGUpfSksdGhpc30sZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYWJiciIpLGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRpbWUiKX0pOwovLyMgc291cmNlTWFwcGluZ1VSTD1qcXVlcnkudGltZWFnby5taW4uanMubWFw"},{"meta":{"name":"sox.common.js","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.common.js","ts":1609797270614,"mimetype":"text/javascript"},"source":"KGZ1bmN0aW9uKHNveCwgJCkgewogICd1c2Ugc3RyaWN0JzsKICBjb25zdCBTT1hfU0VUVElOR1MgPSAnU09YU0VUVElOR1MnOwogIGNvbnN0IGNvbW1vbkluZm8gPSBKU09OLnBhcnNlKEdNX2dldFJlc291cmNlVGV4dCgnY29tbW9uJykpOwogIGNvbnN0IGxhc3RWZXJzaW9uSW5zdGFsbGVkID0gR01fZ2V0VmFsdWUoJ1NPWC1sYXN0VmVyc2lvbkluc3RhbGxlZCcpOwoKICBzb3guaW5mbyA9IHsKICAgIHZlcnNpb246ICh0eXBlb2YgR01faW5mbyAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9pbmZvLnNjcmlwdC52ZXJzaW9uIDogJ3Vua25vd24nKSwKICAgIGhhbmRsZXI6ICh0eXBlb2YgR01faW5mbyAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9pbmZvLnNjcmlwdEhhbmRsZXIgOiAndW5rbm93bicpLAogICAgYXBpa2V5OiAnbEwxUzFqcjJtKkRSd092WE1QcDI2ZygoJywKICAgIGRlYnVnZ2luZzogR01fZ2V0VmFsdWUoJ1NPWC1kZWJ1ZycsIGZhbHNlKSwKICAgIGxhc3RWZXJzaW9uSW5zdGFsbGVkOiBsYXN0VmVyc2lvbkluc3RhbGxlZCwKICB9OwoKICBzb3guTkVXX1RPUEJBUiA9IGxvY2F0aW9uLmhyZWYuaW5kZXhPZignYXJlYTUxJykgPT09IC0xOwoKICBzb3guZGVidWcgPSBmdW5jdGlvbigpIHsKICAgIGlmICghc294LmluZm8uZGVidWdnaW5nKSByZXR1cm47CiAgICBmb3IgKGxldCBhcmcgPSAwOyBhcmcgPCBhcmd1bWVudHMubGVuZ3RoOyArK2FyZykgewogICAgICBjb25zb2xlLmRlYnVnKCdTT1g6JywgYXJndW1lbnRzW2FyZ10pOwogICAgfQogIH07CgogIHNveC5sb2cgPSBmdW5jdGlvbigpIHsKICAgIGZvciAobGV0IGFyZyA9IDA7IGFyZyA8IGFyZ3VtZW50cy5sZW5ndGg7ICsrYXJnKSB7CiAgICAgIGNvbnNvbGUubG9nKCdTT1g6JywgYXJndW1lbnRzW2FyZ10pOwogICAgfQogIH07CgogIHNveC53YXJuID0gZnVuY3Rpb24oKSB7CiAgICBmb3IgKGxldCBhcmcgPSAwOyBhcmcgPCBhcmd1bWVudHMubGVuZ3RoOyArK2FyZykgewogICAgICBjb25zb2xlLndhcm4oJ1NPWDonLCBhcmd1bWVudHNbYXJnXSk7CiAgICB9CiAgfTsKCiAgc294LmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICBmb3IgKGxldCBhcmcgPSAwOyBhcmcgPCBhcmd1bWVudHMubGVuZ3RoOyArK2FyZykgewogICAgICBjb25zb2xlLmVycm9yKCdTT1g6JywgYXJndW1lbnRzW2FyZ10pOwogICAgfQogIH07CgogIHNveC5sb2dpbmZvID0gZnVuY3Rpb24oKSB7CiAgICBmb3IgKGxldCBhcmcgPSAwOyBhcmcgPCBhcmd1bWVudHMubGVuZ3RoOyArK2FyZykgewogICAgICBjb25zb2xlLmluZm8oJ1NPWDonLCBhcmd1bWVudHNbYXJnXSk7CiAgICB9CiAgfTsKCiAgbGV0IENoYXQ7CiAgbGV0IFN0YWNrOwogIGlmIChsb2NhdGlvbi5ocmVmLmluZGV4T2YoJ2dpdGh1Yi5jb20nKSA9PT0gLTEpIHsgLy9uZWVkIHRoaXMgc28gaXQgd29ya3Mgb24gRkYgLS0gQ1NQIGJsb2NrcyB3aW5kb3cuZXZhbCgpIGl0IHNlZW1zCiAgICBDaGF0ID0gKHR5cGVvZiB3aW5kb3cuQ0hBVCA9PT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cuZXZhbCgndHlwZW9mIENIQVQgIT0gXCd1bmRlZmluZWRcJyA/IENIQVQgOiB1bmRlZmluZWQnKSA6IENIQVQpOwogICAgU3RhY2sgPSAodHlwZW9mIENoYXQgPT09ICd1bmRlZmluZWQnID8gKHR5cGVvZiBTdGFja0V4Y2hhbmdlID09PSAndW5kZWZpbmVkJyA/IHdpbmRvdy5ldmFsKCdpZiAodHlwZW9mIFN0YWNrRXhjaGFuZ2UgIT0gInVuZGVmaW5lZCIpIFN0YWNrRXhjaGFuZ2UnKSA6IChTdGFja0V4Y2hhbmdlIHx8IHdpbmRvdy5TdGFja0V4Y2hhbmdlKSkgOiB1bmRlZmluZWQpOwogIH0KCiAgc294LlN0YWNrID0gU3RhY2s7CgogIHNveC5leGlzdHMgPSBmdW5jdGlvbihwYXRoKSB7CiAgICBpZiAoIVN0YWNrKSByZXR1cm4gZmFsc2U7CiAgICBjb25zdCB0b0NoZWNrID0gcGF0aC5zcGxpdCgnLicpOwoKICAgIGxldCBjb250ID0gdHJ1ZTsKICAgIGxldCBvID0gU3RhY2s7CiAgICBsZXQgaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgdG9DaGVjay5sZW5ndGg7IGkrKykgewogICAgICBpZiAoIWNvbnQpIHJldHVybiBmYWxzZTsKICAgICAgaWYgKCEodG9DaGVja1tpXSBpbiBvKSkgY29udCA9IGZhbHNlOwogICAgICBvID0gb1t0b0NoZWNrW2ldXTsKICAgIH0KICAgIHJldHVybiBjb250OwogIH07CgogIHNveC5yZWFkeSA9IGZ1bmN0aW9uKGZ1bmMpIHsKICAgICQoKCkgPT4gewogICAgICBpZiAoU3RhY2spIHsKICAgICAgICBpZiAoU3RhY2sucmVhZHkpIHsKICAgICAgICAgIFN0YWNrLnJlYWR5KGZ1bmMoKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGZ1bmMoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZnVuYygpOwogICAgICB9CiAgICB9KTsKICB9OwoKICBzb3guc2V0dGluZ3MgPSB7CiAgICBhdmFpbGFibGU6IEdNX2dldFZhbHVlKFNPWF9TRVRUSU5HUywgLTEpICE9IC0xLAogICAgbG9hZDogZnVuY3Rpb24oKSB7CiAgICAgIGNvbnN0IHNldHRpbmdzID0gR01fZ2V0VmFsdWUoU09YX1NFVFRJTkdTKTsKICAgICAgcmV0dXJuIHNldHRpbmdzID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBKU09OLnBhcnNlKHNldHRpbmdzKTsKICAgIH0sCiAgICBzYXZlOiBmdW5jdGlvbihzZXR0aW5ncykgewogICAgICBHTV9zZXRWYWx1ZShTT1hfU0VUVElOR1MsIHR5cGVvZiBzZXR0aW5ncyA9PT0gJ3N0cmluZycgPyBzZXR0aW5ncyA6IEpTT04uc3RyaW5naWZ5KHNldHRpbmdzKSk7IC8vaWYgaW1wb3J0aW5nLCBpdCB3aWxsIGFscmVhZHkgYmUgYSBzdHJpbmcgc28gZG9uJ3Qgc3RyaW5naWZ5IHRoZSBzdHJpbmchCiAgICB9LAogICAgcmVzZXQ6IGZ1bmN0aW9uKCkgewogICAgICBjb25zdCBrZXlzID0gR01fbGlzdFZhbHVlcygpOwogICAgICBzb3guZGVidWcoa2V5cyk7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGtleSA9IGtleXNbaV07CiAgICAgICAgR01fZGVsZXRlVmFsdWUoa2V5KTsKICAgICAgfQogICAgfSwKICAgIGdldCBhY2Nlc3NUb2tlbigpIHsKICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBHTV9nZXRWYWx1ZSgnU09YLWFjY2Vzc1Rva2VuJywgZmFsc2UpOwogICAgICByZXR1cm4gKGFjY2Vzc1Rva2VuID09IC0yID8gZmFsc2UgOiBhY2Nlc3NUb2tlbik7IC8vaWYgdGhlIHVzZXIgd2FzIGFscmVhZHkgYXNrZWQgb25jZSwgdGhlIHZhbHVlIGlzIHNldCB0byAtMiwgc28gbWFrZSBzdXJlIHRoaXMgaXMgcmV0dXJuZWQgYXMgZmFsc2UKICAgIH0sCiAgICB3cml0ZVRvQ29uc29sZTogZnVuY3Rpb24oaGlkZUFjY2Vzc1Rva2VuKSB7CiAgICAgIHNveC5sb2dpbmZvKCdsb2dnaW5nIHNveCBzdG9yZWQgdmFsdWVzIC0tLSAnKTsKICAgICAgY29uc3Qga2V5cyA9IEdNX2xpc3RWYWx1ZXMoKTsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qga2V5ID0ga2V5c1tpXTsKICAgICAgICBpZiAoaGlkZUFjY2Vzc1Rva2VuICYmIGtleSA9PSAnU09YLWFjY2Vzc1Rva2VuJykgewogICAgICAgICAgc294LmxvZ2luZm8oJ2FjY2VzcyB0b2tlbiBzZXQnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc294LmxvZ2luZm8oa2V5LCBHTV9nZXRWYWx1ZShrZXkpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgfTsKCiAgZnVuY3Rpb24gdGhyb3R0bGUoZm4sIGNvdW50TWF4LCB0aW1lKSB7CiAgICBsZXQgY291bnRlciA9IDA7CgogICAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICBjb3VudGVyID0gMDsKICAgIH0sIHRpbWUpOwoKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgaWYgKGNvdW50ZXIgPCBjb3VudE1heCkgewogICAgICAgIGNvdW50ZXIrKzsKICAgICAgICBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9OwogIH0KCiAgc294LnNwcml0ZXMgPSB7CiAgICBnZXRTdmc6IGZ1bmN0aW9uIChuYW1lLCB0b29sdGlwLCBjc3MpIHsKICAgICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTsKICAgICAgY29uc3QgdXNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICd1c2UnKTsKICAgICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3RpdGxlJyk7CgogICAgICBpZiAodG9vbHRpcCkgewogICAgICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgdG9vbHRpcCk7CiAgICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSB0b29sdGlwOwogICAgICAgIHN2Zy5hcHBlbmRDaGlsZCh0aXRsZSk7CiAgICAgIH0KCiAgICAgIHVzZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsICd4bGluazpocmVmJywgYCNzb3hfJHtuYW1lfWApOwogICAgICBzdmcuYXBwZW5kQ2hpbGQodXNlKTsKCiAgICAgIGlmIChjc3MpICQoc3ZnKS5jc3MoY3NzKTsKICAgICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3NveC1zcHJpdGUnKTsKICAgICAgc3ZnLmNsYXNzTGlzdC5hZGQoYHNveC1zcHJpdGUtJHtuYW1lfWApOwogICAgICByZXR1cm4gJChzdmcpOwogICAgfSwKICB9OwoKICBzb3guaGVscGVycyA9IHsKICAgIGdldEZyb21BUEk6IGZ1bmN0aW9uIChkZXRhaWxzLCBjYWxsYmFjaykgewogICAgICBsZXQgewogICAgICAgIGlkcywKICAgICAgICB1c2VDYWNoZSA9IHRydWUsCiAgICAgIH0gPSBkZXRhaWxzOwoKICAgICAgY29uc3QgewogICAgICAgIGVuZHBvaW50LAogICAgICAgIGNoaWxkRW5kcG9pbnQsCiAgICAgICAgc29ydCA9ICdjcmVhdGlvbicsCiAgICAgICAgb3JkZXIgPSAnZGVzYycsCiAgICAgICAgc2l0ZW5hbWUsCiAgICAgICAgZmlsdGVyLAogICAgICAgIGxpbWl0LAogICAgICAgIHBhZ2UsCiAgICAgICAgZmVhdHVyZUlkLAogICAgICAgIGNhY2hlRHVyYXRpb24gPSAzLCAvLyBNaW51dGVzIHRvIGNhY2hlIGRhdGEgZm9yCiAgICAgIH0gPSBkZXRhaWxzOwogICAgICBjb25zdCBiYXNlVVJMID0gJ2h0dHBzOi8vYXBpLnN0YWNrZXhjaGFuZ2UuY29tLzIuMi8nOwogICAgICBjb25zdCBxdWVyeVBhcmFtcyA9IFtdOwoKICAgICAgLy8gQ2FjaGUgY2FuIG9ubHkgYmUgdXNlZCBpZiB0aGUgZmVhdHVyZUlkIGFuZCBJRHMgKGFzIGFuIGFycmF5KSBoYXZlIGJlZW4gcHJvdmlkZWQKICAgICAgdXNlQ2FjaGUgPSBmZWF0dXJlSWQgJiYgdXNlQ2FjaGUgJiYgQXJyYXkuaXNBcnJheShpZHMpOwogICAgICBjb25zdCBhcGlDYWNoZSA9IEpTT04ucGFyc2UoR01fZ2V0VmFsdWUoJ1NPWC1hcGlDYWNoZScsICd7fScpKTsKCiAgICAgIGlmICghKGZlYXR1cmVJZCBpbiBhcGlDYWNoZSkpIGFwaUNhY2hlW2ZlYXR1cmVJZF0gPSB7fTsKICAgICAgY29uc3QgZmVhdHVyZUNhY2hlID0gYXBpQ2FjaGVbZmVhdHVyZUlkXTsKCiAgICAgIGlmICghKGVuZHBvaW50IGluIGZlYXR1cmVDYWNoZSkpIGZlYXR1cmVDYWNoZVtlbmRwb2ludF0gPSBbXTsKICAgICAgY29uc3QgZW5kcG9pbnRDYWNoZSA9IGZlYXR1cmVDYWNoZVtlbmRwb2ludF07CgogICAgICBjb25zdCBlbmRwb2ludFRvSWRGaWVsZE5hbWVzID0gewogICAgICAgICdxdWVzdGlvbnMnOiAncXVlc3Rpb25faWQnLAogICAgICAgICdhbnN3ZXJzJzogJ2Fuc3dlcl9pZCcsCiAgICAgICAgJ3VzZXJzJzogJ3VzZXJfaWQnLAogICAgICAgICdjb21tZW50cyc6ICdjb21tZW50X2lkJywKICAgICAgfTsKCiAgICAgIGlmIChmaWx0ZXIpIHF1ZXJ5UGFyYW1zLnB1c2goYGZpbHRlcj0ke2ZpbHRlcn1gKTsKICAgICAgaWYgKG9yZGVyKSBxdWVyeVBhcmFtcy5wdXNoKGBvcmRlcj0ke29yZGVyfWApOwogICAgICBpZiAobGltaXQpIHF1ZXJ5UGFyYW1zLnB1c2goYHBhZ2VzaXplPSR7bGltaXR9YCk7CiAgICAgIGlmIChwYWdlKSBxdWVyeVBhcmFtcy5wdXNoKGBwYWdlPSR7cGFnZX1gKTsKICAgICAgcXVlcnlQYXJhbXMucHVzaChgc29ydD0ke3NvcnR9YCk7CiAgICAgIHF1ZXJ5UGFyYW1zLnB1c2goYHNpdGU9JHtzaXRlbmFtZX1gKTsKICAgICAgcXVlcnlQYXJhbXMucHVzaChga2V5PSR7c294LmluZm8uYXBpa2V5fWApOwogICAgICBxdWVyeVBhcmFtcy5wdXNoKGBhY2Nlc3NfdG9rZW49JHtzb3guc2V0dGluZ3MuYWNjZXNzVG9rZW59YCk7CiAgICAgIGNvbnN0IHF1ZXJ5U3RyaW5nID0gcXVlcnlQYXJhbXMuam9pbignJicpOwoKICAgICAgbGV0IGZpbmFsSXRlbXMgPSBbXTsKICAgICAgaWYgKHVzZUNhY2hlKSB7CiAgICAgICAgLy8gQ291bnQgYmFja3dhcmRzIHNvIHNwbGljaW5nIGRvZXNuJ3QgY2hhbmdlIGluZGljZXMKICAgICAgICBmb3IgKGxldCBpID0gaWRzLmxlbmd0aDsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIGNvbnN0IGNhY2hlZEl0ZW1JbmRleCA9IGVuZHBvaW50Q2FjaGUuZmluZEluZGV4KGl0ZW0gPT4gewogICAgICAgICAgICBjb25zdCBpZEZpZWxkTmFtZSA9IGVuZHBvaW50VG9JZEZpZWxkTmFtZXNbZW5kcG9pbnRdOwogICAgICAgICAgICByZXR1cm4gaXRlbVtpZEZpZWxkTmFtZV0gPT09ICtpZHNbaV07CiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBDYWNoZSByZXN1bHRzIGZvciBtYXguIGNhY2hlRHVyYWN0aW9uIG1pbnV0ZXMgKGNvbnZlcnQgdG8gbWlsbGlzZWNvbmRzKQogICAgICAgICAgY29uc3QgZWFybGllc3RSZXF1ZXN0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gKDYwICogY2FjaGVEdXJhdGlvbiAqIDEwMDApOwogICAgICAgICAgaWYgKGNhY2hlZEl0ZW1JbmRleCAhPT0gLTEpIHsKICAgICAgICAgICAgY29uc3QgY2FjaGVkSXRlbSA9IGVuZHBvaW50Q2FjaGVbY2FjaGVkSXRlbUluZGV4XTsKICAgICAgICAgICAgaWYgKGNhY2hlZEl0ZW0uc294X3JlcXVlc3RfdGltZSA+PSBlYXJsaWVzdFJlcXVlc3RUaW1lKSB7CiAgICAgICAgICAgICAgLy8gSWYgd2UgaGF2ZSBhIGNhY2hlZCBpdGVtIGZvciB0aGlzIElELCBkZWxldGUgaXQgZnJvbSBgaWRzYCBzbyB3ZSBkb24ndCByZXF1ZXN0IHRoZSBBUEkgZm9yIGl0CiAgICAgICAgICAgICAgc294LmRlYnVnKGBBUEk6IFske2ZlYXR1cmVJZH06LyR7ZW5kcG9pbnR9LyR7aWRzW2ldfV0gVXNpbmcgY2FjaGVkIEFQSSBpdGVtYCk7CiAgICAgICAgICAgICAgZmluYWxJdGVtcy5wdXNoKGNhY2hlZEl0ZW0pOwogICAgICAgICAgICAgIGlkcy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gVGhlIGNhY2hlZCBpdGVtIGlzIG5vdyBzdGFsZSAodG9vIG9sZCk7IGRlbGV0ZSBpdAogICAgICAgICAgICAgIHNveC5kZWJ1ZyhgQVBJOiBbJHtmZWF0dXJlSWR9Oi8ke2VuZHBvaW50fS8ke2lkc1tpXX1dIERlbGV0aW5nIHN0YWxlIGNhY2hlZCBpdGVtYCk7CiAgICAgICAgICAgICAgZW5kcG9pbnRDYWNoZS5zcGxpY2UoY2FjaGVkSXRlbUluZGV4LCAxKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8gSURzIGFyZSBvcHRpb25hbCBmb3IgZW5kcG9pbnRzIGxpa2UgL3F1ZXN0aW9ucwogICAgICBpZiAoaWRzICYmIEFycmF5LmlzQXJyYXkoaWRzKSkgewogICAgICAgIGlmIChpZHMubGVuZ3RoKSB7CiAgICAgICAgICBpZHMgPSBpZHMuam9pbignOycpOwogICAgICAgIH0gZWxzZSBpZiAodXNlQ2FjaGUpIHsKICAgICAgICAgIC8vIFRoZSBjYWNoZSBoYWQgZGV0YWlscyBmb3IgYWxsIElEczsgbm8gbmVlZCB0byByZXF1ZXN0IEFQSSBhdCBhbGwKICAgICAgICAgIHNveC5kZWJ1ZyhgQVBJOiBbJHtmZWF0dXJlSWR9Oi8ke2VuZHBvaW50fV0gQVBJIENhY2hlIGhhZCBkZXRhaWxzIGZvciBhbGwgcmVxdWVzdGVkIElEcywgc2tpcHBpbmcgQVBJIHJlcXVlc3RgKTsKICAgICAgICAgIEdNX3NldFZhbHVlKCdTT1gtYXBpQ2FjaGUnLCBKU09OLnN0cmluZ2lmeShhcGlDYWNoZSkpOwogICAgICAgICAgc294LmRlYnVnKCdBUEk6IFNhdmluZyBuZXcgY2FjaGUnLCBhcGlDYWNoZSk7CiAgICAgICAgICBjYWxsYmFjayhmaW5hbEl0ZW1zKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IGlkUGF0aCA9IGlkcyA/IGAvJHtpZHN9YCA6ICcnOwogICAgICBsZXQgcXVlcnlVUkw7CiAgICAgIGlmIChjaGlsZEVuZHBvaW50KSB7CiAgICAgICAgLy8gZS5nLiAvcG9zdHMve2lkc30vcmV2aXNpb25zCiAgICAgICAgcXVlcnlVUkwgPSBgJHtiYXNlVVJMfSR7ZW5kcG9pbnR9JHtpZFBhdGh9LyR7Y2hpbGRFbmRwb2ludH0/JHtxdWVyeVN0cmluZ31gOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIGUuZy4gL3F1ZXN0aW9ucy97aWRzfQogICAgICAgIHF1ZXJ5VVJMID0gYCR7YmFzZVVSTH0ke2VuZHBvaW50fSR7aWRQYXRofT8ke3F1ZXJ5U3RyaW5nfWA7CiAgICAgIH0KICAgICAgc294LmRlYnVnKGBBUEk6IFNlbmRpbmcgcmVxdWVzdCB0byBVUkw6ICcke3F1ZXJ5VVJMfSdgKTsKCiAgICAgICQuYWpheCh7CiAgICAgICAgdHlwZTogJ2dldCcsCiAgICAgICAgdXJsOiBxdWVyeVVSTCwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkKSB7CiAgICAgICAgICBpZiAoZC5iYWNrb2ZmKSB7CiAgICAgICAgICAgIHNveC5lcnJvcignU09YIEVycm9yOiBCQUNLT0ZGOiAnICsgZC5iYWNrb2ZmKTsKICAgICAgICAgIH0gZWxzZSBpZiAoZC5lcnJvcl9pZCA9PSA1MDIpIHsKICAgICAgICAgICAgc294LmVycm9yKCdUSFJPVFRMRSBWSU9MQVRJT04nLCBkKTsKICAgICAgICAgIH0gZWxzZSBpZiAoZC5lcnJvcl9pZCA9PSA0MDMpIHsKICAgICAgICAgICAgc294Lndhcm4oJ0FjY2VzcyB0b2tlbiBpbnZhbGlkISBPcGVuaW5nIHdpbmRvdyB0byBnZXQgbmV3IG9uZScpOwogICAgICAgICAgICB3aW5kb3cub3BlbignaHR0cHM6Ly9zdGFja2V4Y2hhbmdlLmNvbS9vYXV0aC9kaWFsb2c/Y2xpZW50X2lkPTcxMzgmc2NvcGU9bm9fZXhwaXJ5JnJlZGlyZWN0X3VyaT1odHRwOi8vc29zY3JpcHRlZC5naXRodWIuaW8vc294LycpOwogICAgICAgICAgICBhbGVydCgnWW91ciBhY2Nlc3MgdG9rZW4gaXMgbm8gbG9uZ2VyIHZhbGlkLiBBIHdpbmRvdyBoYXMgYmVlbiBvcGVuZWQgdG8gcmVxdWVzdCBhIG5ldyBvbmUuJyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAodXNlQ2FjaGUpIHsKICAgICAgICAgICAgICBkLml0ZW1zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBpdGVtLnNveF9yZXF1ZXN0X3RpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgIGZpbmFsSXRlbXMucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgIGVuZHBvaW50Q2FjaGUucHVzaChpdGVtKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBHTV9zZXRWYWx1ZSgnU09YLWFwaUNhY2hlJywgSlNPTi5zdHJpbmdpZnkoYXBpQ2FjaGUpKTsKICAgICAgICAgICAgICBzb3guZGVidWcoJ0FQSTogc2F2aW5nIG5ldyBjYWNoZScsIGFwaUNhY2hlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBmaW5hbEl0ZW1zID0gZC5pdGVtczsKICAgICAgICAgICAgfQogICAgICAgICAgICBjYWxsYmFjayhmaW5hbEl0ZW1zKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGVycm9yOiBmdW5jdGlvbihhLCBiLCBjKSB7CiAgICAgICAgICBzb3guZXJyb3IoJ1NPWCBFcnJvcjogJyArIGIgKyAnICcgKyBjKTsKICAgICAgICB9LAogICAgICB9KTsKICAgIH0sCiAgICBvYnNlcnZlOiBmdW5jdGlvbiAodGFyZ2V0cywgZWxlbWVudHMsIGNhbGxiYWNrKSB7CiAgICAgIHNveC5kZWJ1ZyhgT0JTRVJWRTogJyR7ZWxlbWVudHN9JyBvbiB0YXJnZXQocylgLCB0YXJnZXRzKTsKICAgICAgaWYgKCF0YXJnZXRzIHx8IChBcnJheS5pc0FycmF5KHRhcmdldHMpICYmICF0YXJnZXRzLmxlbmd0aCkpIHJldHVybjsKCiAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIodGhyb3R0bGUobXV0YXRpb25zID0+IHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG11dGF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgbXV0YXRpb24gPSBtdXRhdGlvbnNbaV07CiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBtdXRhdGlvbi50YXJnZXQ7CiAgICAgICAgICBjb25zdCBhZGRlZE5vZGVzID0gbXV0YXRpb24uYWRkZWROb2RlczsKCiAgICAgICAgICBpZiAoYWRkZWROb2RlcykgewogICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGFkZGVkTm9kZXMubGVuZ3RoOyBuKyspIHsKICAgICAgICAgICAgICBpZiAoJChhZGRlZE5vZGVzW25dKS5maW5kKGVsZW1lbnRzKS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHNveC5kZWJ1ZygnZmlyZTogbm9kZTogJywgYWRkZWROb2Rlc1tuXSk7CiAgICAgICAgICAgICAgICBjYWxsYmFjayh0YXJnZXQpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmICgkKHRhcmdldCkuaXMoZWxlbWVudHMpKSB7IC8vVE9ETzogbWF5YmUgYWRkIE9SIHRvIGZpbmQgc3ViZWxlbWVudHMgZm9yIGNoaWxkTGlzdCBldmVudHM/CiAgICAgICAgICAgIGNhbGxiYWNrKHRhcmdldCk7CiAgICAgICAgICAgIHNveC5kZWJ1ZygnZmlyZTogdGFyZ2V0OiAnLCB0YXJnZXQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCAxNTAwKSk7CgogICAgICBpZiAoQXJyYXkuaXNBcnJheSh0YXJnZXRzKSkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGFyZ2V0c1tpXTsKICAgICAgICAgIGlmICghdGFyZ2V0KSBjb250aW51ZTsKCiAgICAgICAgICBvYnNlcnZlci5vYnNlcnZlKHRhcmdldCwgewogICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLAogICAgICAgICAgICBjaGlsZExpc3Q6IHRydWUsCiAgICAgICAgICAgIGNoYXJhY3RlckRhdGE6IHRydWUsCiAgICAgICAgICAgIHN1YnRyZWU6IHRydWUsCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZSh0YXJnZXRzLCB7CiAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLAogICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwKICAgICAgICAgIHN1YnRyZWU6IHRydWUsCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBuZXdFbGVtZW50OiBmdW5jdGlvbih0eXBlLCBlbGVtZW50RGV0YWlscykgewogICAgICBjb25zdCBleHRyYXMgPSB7fTsKICAgICAgY29uc3QgYWxsb3dlZCA9IFsndGV4dCcsICdjaGVja2JveCcsICdyYWRpbycsICd0ZXh0YXJlYScsICdzcGFuJ107CgogICAgICBpZiAoYWxsb3dlZC5pbmRleE9mKHR5cGUpICE9IC0xKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gJ3RleHQnKSB7CiAgICAgICAgICB0eXBlID0gJ2lucHV0JzsKICAgICAgICAgIGV4dHJhcy50eXBlID0gJ2lucHV0JzsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ2NoZWNrYm94JykgewogICAgICAgICAgdHlwZSA9ICdpbnB1dCc7CiAgICAgICAgICBleHRyYXMudHlwZSA9ICdjaGVja2JveCc7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdyYWRpbycpIHsKICAgICAgICAgIHR5cGUgPSAnaW5wdXQnOwogICAgICAgICAgZXh0cmFzLnR5cGUgPSAncmFkaW8nOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAndGV4dGFyZWEnKSB7CiAgICAgICAgICBpZiAoIWVsZW1lbnREZXRhaWxzLnRleHQpIHsKICAgICAgICAgICAgZWxlbWVudERldGFpbHMudGV4dCA9IGVsZW1lbnREZXRhaWxzLnZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJC5lYWNoKGVsZW1lbnREZXRhaWxzLCAoaywgdikgPT4gewogICAgICAgICAgZXh0cmFzW2tdID0gdjsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gJCgnPCcgKyB0eXBlICsgJy8+JywgZXh0cmFzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBnZXRJREZyb21BbmNob3I6IGZ1bmN0aW9uKGFuY2hvcikgewogICAgICByZXR1cm4gYW5jaG9yLmhyZWYgPyBzb3guaGVscGVycy5nZXRJREZyb21MaW5rKGFuY2hvci5ocmVmKSA6IG51bGw7CiAgICB9LAogICAgZ2V0U2l0ZU5hbWVGcm9tQW5jaG9yOiBmdW5jdGlvbihhbmNob3IpIHsKICAgICAgcmV0dXJuIGFuY2hvci5ocmVmID8gc294LmhlbHBlcnMuZ2V0U2l0ZU5hbWVGcm9tTGluayhhbmNob3IuaHJlZikgOiBudWxsOwogICAgfSwKICAgIC8vIGFuc3dlciBJRCwgcXVlc3Rpb24gSUQsIHVzZXIgSUQsIGNvbW1lbnQgSUQgKCJwb3N0cy9jb21tZW50cy9JRCIgTk9UICJjb21tZW50MTU0NV81NTY2IikKICAgIGdldElERnJvbUxpbms6IGZ1bmN0aW9uKGxpbmspIHsKICAgICAgLy8gdGVzdCBjYXNlczogaHR0cHM6Ly9yZWdleDEwMS5jb20vci82UDlzRFgvMgogICAgICBjb25zdCBpZE1hdGNoID0gbGluay5tYXRjaCgvXC8oXGQrKS8pOwogICAgICByZXR1cm4gaWRNYXRjaCA/ICtpZE1hdGNoWzFdIDogbnVsbDsKICAgIH0sCiAgICBnZXRTaXRlTmFtZUZyb21MaW5rOiBmdW5jdGlvbihsaW5rKSB7CiAgICAgIGNvbnN0IHNpdGVSZWdleCA9IC8oKCguKylcLik/KCgoc3RhY2tleGNoYW5nZXxzdGFja292ZXJmbG93fHN1cGVydXNlcnxzZXJ2ZXJmYXVsdHxhc2t1YnVudHV8c3RhY2thcHBzKSkoPz1cLmNvbSkpfG1hdGhvdmVyZmxvd1wubmV0KS87CiAgICAgIGNvbnN0IHNpdGVNYXRjaCA9IGxpbmsucmVwbGFjZSgvaHR0cHM/OlwvXC8vLCAnJykubWF0Y2goc2l0ZVJlZ2V4KTsKICAgICAgcmV0dXJuIHNpdGVNYXRjaCA/IHNpdGVNYXRjaFsxXSA6IG51bGw7CiAgICB9LAogICAgY3JlYXRlTW9kYWw6IGZ1bmN0aW9uIChwYXJhbXMpIHsKICAgICAgY29uc3QgJGRpYWxvZyA9ICQoJzxhc2lkZS8+JywgewogICAgICAgICdjbGFzcyc6ICdzLW1vZGFsIGpzLW1vZGFsLW92ZXJsYXkganMtbW9kYWwtY2xvc2UganMtc3RhY2tzLW1hbmFnZWQtcG9wdXAganMtZmFkZXMtd2l0aC1hcmlhLWhpZGRlbiBzb3gtY3VzdG9tLWRpYWxvZycsCiAgICAgICAgJ3JvbGUnOiAnZGlhbG9nJywKICAgICAgICAnYXJpYS1oaWRkZW4nOiBmYWxzZSwKICAgICAgfSk7CiAgICAgIGlmIChwYXJhbXMuY3NzKSAkZGlhbG9nLmNzcyhwYXJhbXMuY3NzKTsKICAgICAgaWYgKHBhcmFtcy5pZCkgJGRpYWxvZy5hdHRyKCdpZCcsIHBhcmFtcy5pZCk7CiAgICAgIGNvbnN0ICRkaWFsb2dJbm5lckNvbnRhaW5lciA9ICQoJzxkaXYvPicsIHsKICAgICAgICAnY2xhc3MnOiAncy1tb2RhbC0tZGlhbG9nIGpzLW1vZGFsLWRpYWxvZyAnLAogICAgICAgICdzdHlsZSc6ICdtaW4td2lkdGg6IDU2OHB4OycsLy8gdG9wOiAyMjcuNzM2cHg7IGxlZnQ6IDMxMi42NTNweDsnLAogICAgICB9KTsKICAgICAgaWYgKHBhcmFtcy5jc3MpICRkaWFsb2dJbm5lckNvbnRhaW5lci5jc3MocGFyYW1zLmNzcyk7CiAgICAgIGNvbnN0ICRoZWFkZXIgPSAkKCc8aDEvPicsIHsKICAgICAgICAnY2xhc3MnOiAncy1tb2RhbC0taGVhZGVyIGZzLWhlYWRsaW5lMSBmdy1ib2xkIG1yNDgganMtZmlyc3QtdGFiYmFibGUgc294LWN1c3RvbS1kaWFsb2ctaGVhZGVyJywKICAgICAgICAnaHRtbCc6IHBhcmFtcy5oZWFkZXIsCiAgICAgIH0pOwogICAgICBjb25zdCAkbWFpbkNvbnRlbnQgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgJ2NsYXNzJzogJ3MtbW9kYWwtLWJvZHkgc294LWN1c3RvbS1kaWFsb2ctY29udGVudCcsCiAgICAgIH0pOwogICAgICBpZiAocGFyYW1zLmh0bWwpICRtYWluQ29udGVudC5odG1sKHBhcmFtcy5odG1sKTsKICAgICAgY29uc3QgJGNsb3NlQnV0dG9uID0gJCgnPGJ1dHRvbi8+JywgewogICAgICAgICdjbGFzcyc6ICdzLW1vZGFsLS1jbG9zZSBzLWJ0biBzLWJ0bl9fbXV0ZWQganMtbW9kYWwtY2xvc2UganMtbGFzdC10YWJiYWJsZScsCiAgICAgICAgJ2NsaWNrJzogKCkgPT4gJCgnLnNveC1jdXN0b20tZGlhbG9nJykucmVtb3ZlKCksCiAgICAgIH0pLmFwcGVuZCgkKCc8c3ZnIGFyaWEtaGlkZGVuPSJ0cnVlIiBjbGFzcz0ic3ZnLWljb24gbTAgaWNvbkNsZWFyU20iIHdpZHRoPSIxNCIgaGVpZ2h0PSIxNCIgdmlld0JveD0iMCAwIDE0IDE0Ij48cGF0aCBkPSJNMTIgMy40MUwxMC41OSAyIDcgNS41OSAzLjQxIDIgMiAzLjQxIDUuNTkgNyAyIDEwLjU5IDMuNDEgMTIgNyA4LjQxIDEwLjU5IDEyIDEyIDEwLjU5IDguNDEgN3oiPjwvcGF0aD48L3N2Zz4nKSk7CgogICAgICAkZGlhbG9nSW5uZXJDb250YWluZXIuYXBwZW5kKCRoZWFkZXIpLmFwcGVuZCgkbWFpbkNvbnRlbnQpLmFwcGVuZCgkY2xvc2VCdXR0b24pOwogICAgICAkZGlhbG9nLmFwcGVuZCgkZGlhbG9nSW5uZXJDb250YWluZXIpOwoKICAgICAgcmV0dXJuICRkaWFsb2c7CiAgICB9LAogICAgYWRkQnV0dG9uVG9IZWxwTWVudTogZnVuY3Rpb24gKHBhcmFtcykgewogICAgICBjb25zdCAkbGkgPSAkKCc8bGkvPicpOwogICAgICBjb25zdCAkYSA9ICQoJzxhLz4nLCB7CiAgICAgICAgJ2hyZWYnOiAnamF2YXNjcmlwdDp2b2lkKDApJywKICAgICAgICAnaWQnOiBwYXJhbXMuaWQsCiAgICAgICAgJ3RleHQnOiBgU09YOiAke3BhcmFtcy5saW5rVGV4dH1gLAogICAgICB9KTsKICAgICAgY29uc3QgJHNwYW4gPSAkKCc8c3Bhbi8+JywgewogICAgICAgICdjbGFzcyc6ICdpdGVtLXN1bW1hcnknLAogICAgICAgICd0ZXh0JzogcGFyYW1zLnN1bW1hcnksCiAgICAgIH0pOwogICAgICAkbGkub24oJ2NsaWNrJywgcGFyYW1zLmNsaWNrKTsKICAgICAgJGxpLmFwcGVuZCgkYS5hcHBlbmQoJHNwYW4pKTsKICAgICAgJCgnLnRvcGJhci1kaWFsb2cuaGVscC1kaWFsb2cuanMtaGVscC1kaWFsb2cgPiAubW9kYWwtY29udGVudCB1bCcpLmFwcGVuZCgkbGkpOwogICAgfSwKICAgIHN1cnJvdW5kU2VsZWN0ZWRUZXh0OiBmdW5jdGlvbih0ZXh0YXJlYSwgc3RhcnQsIGVuZCkgewogICAgICAvLyBzYW1lIHdyYXBwZXIgY29kZSBvbiBlaXRoZXIgc2lkZSAoYCQuLi4kYCkKICAgICAgaWYgKHR5cGVvZiBlbmQgPT09ICd1bmRlZmluZWQnKSBlbmQgPSBzdGFydDsKCiAgICAgIC8qLS0tIEV4cGVjdGVkIGJlaGF2aW9yOgogICAgICAgIFdoZW4gdGhlcmUgaXMgc29tZSB0ZXh0IHNlbGVjdGVkOiAodW53cmFwIGl0IGlmIGFscmVhZHkgd3JhcHBlZCkKICAgICAgICAiXXRleHRbIiAgICAgICAgIC0tPiAiKipddGV4dFsqKiIKICAgICAgICAiKipddGV4dFsqKiIgICAgIC0tPiAiXXRleHRbIgogICAgICAgICJdKip0ZXh0KipbIiAgICAgLS0+ICIqKl0qKnRleHQqKlsqKiIKICAgICAgICAiKipdKip0ZXh0KipbKioiIC0tPiAiXSoqdGV4dCoqWyIKICAgICAgICBXaGVuIHRoZXJlIGlzIG5vIHRleHQgc2VsZWN0ZWQ6CiAgICAgICAgIl1bIiAgICAgICAgICAgICAtLT4gIioqcGxhY2Vob2xkZXIgdGV4dCoqIgogICAgICAgICIqKl1bKioiICAgICAgICAgLS0+ICIiCiAgICAgICAgTm90ZSB0aGF0IGBdYCBhbmQgYFtgIGRlbm90ZSB0aGUgc2VsZWN0ZWQgdGV4dCBoZXJlLgogICAgKi8KCiAgICAgIGNvbnN0IHNlbFMgPSB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCA8IHRleHRhcmVhLnNlbGVjdGlvbkVuZCA/IHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0IDogdGV4dGFyZWEuc2VsZWN0aW9uRW5kOwogICAgICBjb25zdCBzZWxFID0gdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPiB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPyB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCA6IHRleHRhcmVhLnNlbGVjdGlvbkVuZDsKICAgICAgY29uc3QgdmFsdWUgPSB0ZXh0YXJlYS52YWx1ZTsKICAgICAgY29uc3Qgc3RhcnRMZW4gPSBzdGFydC5sZW5ndGg7CiAgICAgIGNvbnN0IGVuZExlbiA9IGVuZC5sZW5ndGg7CgogICAgICBsZXQgdmFsQmVmb3JlID0gdmFsdWUuc3Vic3RyaW5nKDAsIHNlbFMpOwogICAgICBsZXQgdmFsTWlkID0gdmFsdWUuc3Vic3RyaW5nKHNlbFMsIHNlbEUpOwogICAgICBsZXQgdmFsQWZ0ZXIgPSB2YWx1ZS5zdWJzdHJpbmcoc2VsRSk7CiAgICAgIGxldCBnZW5lcmF0ZWRXcmFwcGVyOwoKICAgICAgLy8gaGFuZGxlIHRyYWlsaW5nIHNwYWNlcwogICAgICBjb25zdCB0cmltbWVkU2VsZWN0aW9uID0gdmFsTWlkLm1hdGNoKC9eKFxzKikoXFM/KD86LnxcbnxccikqXFMpKFxzKikkLykgfHwgWycnLCAnJywgJycsICcnXTsKCiAgICAgIC8vIGRldGVybWluZSBpZiB0ZXh0IGlzIGN1cnJlbnRseSB3cmFwcGVkCiAgICAgIGlmICh2YWxCZWZvcmUuZW5kc1dpdGgoc3RhcnQpICYmIHZhbEFmdGVyLnN0YXJ0c1dpdGgoZW5kKSkgewogICAgICAgIHRleHRhcmVhLnZhbHVlID0gdmFsQmVmb3JlLnN1YnN0cmluZygwLCB2YWxCZWZvcmUubGVuZ3RoIC0gc3RhcnRMZW4pICsgdmFsTWlkICsgdmFsQWZ0ZXIuc3Vic3RyaW5nKGVuZExlbik7CiAgICAgICAgdGV4dGFyZWEuc2VsZWN0aW9uU3RhcnQgPSB2YWxCZWZvcmUubGVuZ3RoIC0gc3RhcnRMZW47CiAgICAgICAgdGV4dGFyZWEuc2VsZWN0aW9uRW5kID0gKHZhbEJlZm9yZSArIHZhbE1pZCkubGVuZ3RoIC0gc3RhcnRMZW47CiAgICAgICAgdGV4dGFyZWEuZm9jdXMoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YWxCZWZvcmUgKz0gdHJpbW1lZFNlbGVjdGlvblsxXTsKICAgICAgICB2YWxBZnRlciA9IHRyaW1tZWRTZWxlY3Rpb25bM10gKyB2YWxBZnRlcjsKICAgICAgICB2YWxNaWQgPSB0cmltbWVkU2VsZWN0aW9uWzJdOwoKICAgICAgICBnZW5lcmF0ZWRXcmFwcGVyID0gc3RhcnQgKyB2YWxNaWQgKyBlbmQ7CgogICAgICAgIHRleHRhcmVhLnZhbHVlID0gdmFsQmVmb3JlICsgZ2VuZXJhdGVkV3JhcHBlciArIHZhbEFmdGVyOwogICAgICAgIHRleHRhcmVhLnNlbGVjdGlvblN0YXJ0ID0gdmFsQmVmb3JlLmxlbmd0aCArIHN0YXJ0Lmxlbmd0aDsKICAgICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25FbmQgPSAodmFsQmVmb3JlICsgZ2VuZXJhdGVkV3JhcHBlcikubGVuZ3RoIC0gZW5kLmxlbmd0aDsKICAgICAgICB0ZXh0YXJlYS5mb2N1cygpOwogICAgICB9CgogICAgICBzb3guU3RhY2suTWFya2Rvd25FZGl0b3IucmVmcmVzaEFsbFByZXZpZXdzKCk7CiAgICB9LAogIH07CgogIHNveC5zaXRlID0gewogICAgdHlwZXM6IHsKICAgICAgbWFpbjogJ21haW4nLAogICAgICBtZXRhOiAnbWV0YScsCiAgICAgIGNoYXQ6ICdjaGF0JywKICAgICAgYmV0YTogJ2JldGEnLAogICAgfSwKICAgIGlkOiAoc294LmV4aXN0cygnb3B0aW9ucy5zaXRlLmlkJykgPyBTdGFjay5vcHRpb25zLnNpdGUuaWQgOiB1bmRlZmluZWQpLAogICAgY3VycmVudEFwaVBhcmFtZXRlcjogc294LmhlbHBlcnMuZ2V0U2l0ZU5hbWVGcm9tTGluayhsb2NhdGlvbi5ocmVmKSwKICAgIGdldCBuYW1lKCkgewogICAgICBpZiAoQ2hhdCkgewogICAgICAgIHJldHVybiAkKCcjZm9vdGVyLWxvZ28gYScpLmF0dHIoJ3RpdGxlJyk7CiAgICAgIH0gZWxzZSB7IC8vdXNpbmcgU3RhY2tFeGNoYW5nZSBvYmplY3QgZG9lc24ndCBnaXZlIGNvcnJlY3QgbmFtZSAoZWcuIGBCaW9sb2d5YCBpcyBjYWxsZWQgYEJpb2xvZ3kgU3RhY2sgRXhjaGFuZ2VgIGluIHRoZSBvYmplY3QpCiAgICAgICAgcmV0dXJuICQoJy5qcy10b3BiYXItZGlhbG9nLWNvcnJhbCAubW9kYWwtY29udGVudC5jdXJyZW50LXNpdGUtY29udGFpbmVyIC5jdXJyZW50LXNpdGUtbGluayBkaXYnKS5hdHRyKCd0aXRsZScpOwogICAgICB9CiAgICB9LAoKICAgIGdldCB0eXBlKCkgewogICAgICBpZiAoQ2hhdCkgewogICAgICAgIHJldHVybiB0aGlzLnR5cGVzLmNoYXQ7CiAgICAgIH0gZWxzZSBpZiAoU3RhY2spIHsKICAgICAgICBpZiAoc294LmV4aXN0cygnb3B0aW9ucy5zaXRlJykgJiYgU3RhY2sub3B0aW9ucy5zaXRlLmlzTWV0YVNpdGUpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnR5cGVzLm1ldGE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGNoZWNrIGlmIHNpdGUgaXMgaW4gYmV0YSBvciBncmFkdWF0ZWQKICAgICAgICAgIGlmICgkKCcuYmV0YS10aXRsZScpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMudHlwZXMuYmV0YTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnR5cGVzLm1haW47CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfSwKICAgIGdldCBpY29uKCkgewogICAgICByZXR1cm4gJ2Zhdmljb24tJyArICQoJy5jdXJyZW50LXNpdGUgYTpub3QoW2hyZWYqPVwnbWV0YVwnXSkgLnNpdGUtaWNvbicpLmF0dHIoJ2NsYXNzJykuc3BsaXQoJ2Zhdmljb24tJylbMV07CiAgICB9LAogICAgdXJsOiBsb2NhdGlvbi5ob3N0bmFtZSwgLy9lLmcuICJtZXRhLnN0YWNrZXhjaGFuZ2UuY29tIgogICAgaHJlZjogbG9jYXRpb24uaHJlZiwgLy9lLmcuICJodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcXVlc3Rpb25zL2JsYWgvYmxhaCIKICB9OwoKICBzb3gubG9jYXRpb24gPSB7CiAgICAvLyBsb2NhdGlvbiBoZWxwZXJzCiAgICBvbjogZnVuY3Rpb24obG9jYXRpb24pIHsKICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YobG9jYXRpb24pID4gLTEgPyB0cnVlIDogZmFsc2U7CiAgICB9LAogICAgZ2V0IG9uVXNlclByb2ZpbGUoKSB7CiAgICAgIHJldHVybiB0aGlzLm9uKCcvdXNlcnMvJyk7CiAgICB9LAogICAgZ2V0IG9uUXVlc3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLm9uKCcvcXVlc3Rpb25zLycpOwogICAgfSwKICAgIG1hdGNoV2l0aFBhdHRlcm46IGZ1bmN0aW9uKHBhdHRlcm4sIHVybFRvTWF0Y2hXaXRoKSB7IC8vY29tbWVudGVkIHZlcnNpb24gQCBodHRwczovL2pzZmlkZGxlLm5ldC9zaHViMDEvdDkwa3gyZHYvCiAgICAgIGlmIChwYXR0ZXJuID09ICdTRTEuMCcpIHsgLy9TRS5jb20gJiYgQXJlYTUxLlNFLmNvbSBzcGVjaWFsIGNoZWNraW5nCiAgICAgICAgaWYgKHVybFRvTWF0Y2hXaXRoKSB7CiAgICAgICAgICBpZiAodXJsVG9NYXRjaFdpdGgubWF0Y2goL2h0dHBzPzpcL1wvc3RhY2tleGNoYW5nZVwuY29tXC8/LykgfHwgKHNveC5sb2NhdGlvbi5tYXRjaFdpdGhQYXR0ZXJuKCcqOi8vYXJlYTUxLnN0YWNrZXhjaGFuZ2UuY29tLyonKSAmJiBzb3guc2l0ZS5ocmVmLmluZGV4T2YoJy5tZXRhLicpID09PSAtMSkpIHJldHVybiB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAobG9jYXRpb24uaHJlZi5tYXRjaCgvaHR0cHM/OlwvXC9zdGFja2V4Y2hhbmdlXC5jb21cLz8vKSB8fCAoc294LmxvY2F0aW9uLm1hdGNoV2l0aFBhdHRlcm4oJyo6Ly9hcmVhNTEuc3RhY2tleGNoYW5nZS5jb20vKicpICYmIHNveC5zaXRlLmhyZWYuaW5kZXhPZignLm1ldGEuJykgPT09IC0xKSkgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBsZXQgY3VycmVudFNpdGVTY2hlbWU7IGxldCBjdXJyZW50U2l0ZUhvc3Q7IGxldCBjdXJyZW50U2l0ZVBhdGg7CiAgICAgIGlmICh1cmxUb01hdGNoV2l0aCkgewogICAgICAgIGNvbnN0IHNwbGl0ID0gdXJsVG9NYXRjaFdpdGguc3BsaXQoJy8nKTsKICAgICAgICBjdXJyZW50U2l0ZVNjaGVtZSA9IHNwbGl0WzBdOwogICAgICAgIGN1cnJlbnRTaXRlSG9zdCA9IHNwbGl0WzJdOwogICAgICAgIGN1cnJlbnRTaXRlUGF0aCA9ICcvJyArIHNwbGl0LnNsaWNlKC0oc3BsaXQubGVuZ3RoIC0gMykpLmpvaW4oJy8nKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjdXJyZW50U2l0ZVNjaGVtZSA9IGxvY2F0aW9uLnByb3RvY29sOwogICAgICAgIGN1cnJlbnRTaXRlSG9zdCA9IGxvY2F0aW9uLmhvc3RuYW1lOwogICAgICAgIGN1cnJlbnRTaXRlUGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICB9CgogICAgICBjb25zdCBtYXRjaFNwbGl0ID0gcGF0dGVybi5zcGxpdCgnLycpOwogICAgICBsZXQgbWF0Y2hTY2hlbWUgPSBtYXRjaFNwbGl0WzBdOwogICAgICBsZXQgbWF0Y2hIb3N0ID0gbWF0Y2hTcGxpdFsyXTsKICAgICAgbGV0IG1hdGNoUGF0aCA9IG1hdGNoU3BsaXQuc2xpY2UoLShtYXRjaFNwbGl0Lmxlbmd0aCAtIDMpKS5qb2luKCcvJyk7CgogICAgICBtYXRjaFNjaGVtZSA9IG1hdGNoU2NoZW1lLnJlcGxhY2UoL1wqL2csICcuKicpOwogICAgICBtYXRjaEhvc3QgPSBtYXRjaEhvc3QucmVwbGFjZSgvXC4vZywgJ1xcLicpLnJlcGxhY2UoL1wqXFxcLi9nLCAnLiouPycpLnJlcGxhY2UoL1xcXC5cKi9nLCAnLionKS5yZXBsYWNlKC9cKiQvZywgJy4qJyk7CiAgICAgIG1hdGNoUGF0aCA9ICdeLycgKyBtYXRjaFBhdGgucmVwbGFjZSgvXC8vZywgJ1xcLycpLnJlcGxhY2UoL1wqL2csICcuKicpOwoKICAgICAgaWYgKGN1cnJlbnRTaXRlU2NoZW1lLm1hdGNoKG5ldyBSZWdFeHAobWF0Y2hTY2hlbWUpKSAmJiBjdXJyZW50U2l0ZUhvc3QubWF0Y2gobmV3IFJlZ0V4cChtYXRjaEhvc3QpKSAmJiBjdXJyZW50U2l0ZVBhdGgubWF0Y2gobmV3IFJlZ0V4cChtYXRjaFBhdGgpKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgfTsKCiAgc294LnVzZXIgPSB7CiAgICBnZXQgaWQoKSB7CiAgICAgIGlmIChzb3guc2l0ZS50eXBlID09IHNveC5zaXRlLnR5cGVzLmNoYXQpIHsKICAgICAgICByZXR1cm4gQ2hhdCA/IENoYXQuUm9vbVVzZXJzLmN1cnJlbnQoKS5pZCA6IHVuZGVmaW5lZDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gc294LmV4aXN0cygnb3B0aW9ucy51c2VyLnVzZXJJZCcpID8gU3RhY2sub3B0aW9ucy51c2VyLnVzZXJJZCA6IHVuZGVmaW5lZDsKICAgICAgfQogICAgfSwKICAgIGdldCByZXAoKSB7CiAgICAgIGlmIChzb3guc2l0ZS50eXBlID09IHNveC5zaXRlLnR5cGVzLmNoYXQpIHsKICAgICAgICByZXR1cm4gQ2hhdC5Sb29tVXNlcnMuY3VycmVudCgpLnJlcHV0YXRpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHNveC5leGlzdHMoJ29wdGlvbnMudXNlci5yZXAnKSA/IFN0YWNrLm9wdGlvbnMudXNlci5yZXAgOiB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0sCiAgICBnZXQgbmFtZSgpIHsKICAgICAgaWYgKHNveC5zaXRlLnR5cGUgPT0gc294LnNpdGUudHlwZXMuY2hhdCkgewogICAgICAgIHJldHVybiBDaGF0LlJvb21Vc2Vycy5jdXJyZW50KCkubmFtZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCAkdW5hbWUgPSAkKCcudG9wLWJhciBkaXYuZ3JhdmF0YXItd3JhcHBlci0yNCcpOyAvL3VzZWQgdG8gYmUgJCgnYm9keSA+IGRpdi50b3BiYXIgPiBkaXYgPiBkaXYudG9wYmFyLWxpbmtzID4gYSA+IGRpdi5ncmF2YXRhci13cmFwcGVyLTI0Jyk7CiAgICAgICAgcmV0dXJuICgkdW5hbWUubGVuZ3RoID8gJHVuYW1lLmF0dHIoJ3RpdGxlJykgOiBmYWxzZSk7CiAgICAgIH0KICAgIH0sCiAgICBnZXQgbG9nZ2VkSW4oKSB7CiAgICAgIHJldHVybiBzb3guZXhpc3RzKCdvcHRpb25zLnVzZXIuaXNSZWdpc3RlcmVkJykgPyBTdGFjay5vcHRpb25zLnVzZXIuaXNSZWdpc3RlcmVkIDogdW5kZWZpbmVkOwogICAgfSwKICAgIGhhc1ByaXZpbGVnZTogZnVuY3Rpb24ocHJpdmlsZWdlKSB7CiAgICAgIGlmICh0aGlzLmxvZ2dlZEluKSB7CiAgICAgICAgY29uc3QgcmVwID0gKHNveC5zaXRlLnR5cGUgPT0gJ2JldGEnID8gY29tbW9uSW5mby5wcml2aWxlZ2VzLmJldGFbcHJpdmlsZWdlXSA6IGNvbW1vbkluZm8ucHJpdmlsZWdlcy5ncmFkdWF0ZWRbcHJpdmlsZWdlXSk7CiAgICAgICAgcmV0dXJuIHRoaXMucmVwID4gcmVwOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgfTsKCn0pKHdpbmRvdy5zb3ggPSB3aW5kb3cuc294IHx8IHt9LCBqUXVlcnkpOwo="},{"meta":{"name":"sox.github.js","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.github.js","ts":1609797270672,"mimetype":"text/javascript"},"source":"KGZ1bmN0aW9uKHNveCwgJCkgewogICd1c2Ugc3RyaWN0JzsKCiAgc294LmdpdGh1YiA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKHZlcnNpb24sIGhhbmRsZXIpIHsKICAgICAgLy8gYXV0by1pbmplY3QgdmVyc2lvbiBudW1iZXIgYW5kIGVudmlyb25tZW50IGluZm9ybWF0aW9uIGludG8gR2l0SHViIGlzc3VlcwogICAgICBmdW5jdGlvbiBpbmplY3QoKSB7CiAgICAgICAgaWYgKCFzb3gubG9jYXRpb24ub24oJ2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gnKSB8fCBsb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCdmZWF0dXJlX3JlcXVlc3QnKSkgcmV0dXJuOwogICAgICAgIGNvbnN0ICRpc3N1ZSA9ICQoJyNpc3N1ZV9ib2R5Jyk7CiAgICAgICAgaWYgKCRpc3N1ZS5sZW5ndGgpIHsKICAgICAgICAgICRpc3N1ZS5wcm9wKCdkaXNhYmxlZCcsICd0cnVlJyk7CiAgICAgICAgICBjb25zdCBlbnZpcm9ubWVudFRleHQgPSBgCioqRW52aXJvbm1lbnQqKgpTT1ggdmVyc2lvbjogJHt2ZXJzaW9ufQpQbGF0Zm9ybTogJHtoYW5kbGVyfQpgOwoKICAgICAgICAgIGxldCBpc3N1ZVRleHQgPSAkaXNzdWUudGV4dCgpOwogICAgICAgICAgaXNzdWVUZXh0ID0gaXNzdWVUZXh0LnJlcGxhY2UoJyoqRW52aXJvbm1lbnQqKicsIGVudmlyb25tZW50VGV4dCk7IC8vaW5qZWN0IGVudmlyb25tZW50IGRldGFpbHMKICAgICAgICAgIGlzc3VlVGV4dCArPSAnXG4tLS1cblxuIyMjIEZlYXR1cmVzIEVuYWJsZWQgXG5cbiAgICAnICsgSlNPTi5zdHJpbmdpZnkoc294LnNldHRpbmdzLmxvYWQoKSk7CiAgICAgICAgICAkKCcjaXNzdWVfYm9keScpLmRlbGF5KDUwMCkudGV4dChpc3N1ZVRleHQpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7CiAgICAgICAgfQogICAgICB9CgogICAgICAkKGRvY3VtZW50KS5vbigncGpheDpjb21wbGV0ZScsIGluamVjdCk7CiAgICAgIGluamVjdCgpOwogICAgfSwKICB9Owp9KSh3aW5kb3cuc294ID0gd2luZG93LnNveCB8fCB7fSwgalF1ZXJ5KTsK"},{"meta":{"name":"sox.dialog.js","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.dialog.js","ts":1609797270580,"mimetype":"text/javascript"},"source":"KGZ1bmN0aW9uKHNveCwgJCkgewogICd1c2Ugc3RyaWN0JzsKCiAgc294LmRpYWxvZyA9IHsKICAgIGluaXQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgaWYgKCEkKCcudG9wLWJhcicpLmxlbmd0aCkgcmV0dXJuOwogICAgICBzb3guZGVidWcoJ2luaXRpYWxpemluZyBTT1ggZGlhbG9nJyk7CgogICAgICBjb25zdCB2ZXJzaW9uID0gb3B0aW9ucy52ZXJzaW9uOwogICAgICBjb25zdCBmZWF0dXJlcyA9IG9wdGlvbnMuZmVhdHVyZXM7CiAgICAgIGNvbnN0IHNldHRpbmdzID0gb3B0aW9ucy5zZXR0aW5nczsKICAgICAgY29uc3QgbGFzdFZlcnNpb25JbnN0YWxsZWQgPSBvcHRpb25zLmxhc3RWZXJzaW9uSW5zdGFsbGVkOwogICAgICBjb25zdCBodG1sID0gR01fZ2V0UmVzb3VyY2VUZXh0KCdkaWFsb2cnKTsKICAgICAgY29uc3QgJHNveFNldHRpbmdzRGlhbG9nID0gJChodG1sKTsKICAgICAgY29uc3QgJHNveFNldHRpbmdzRGlhbG9nRmVhdHVyZXMgPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnI3NveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZXMnKTsKICAgICAgY29uc3QgJHNveFNldHRpbmdzRGlhbG9nVmVyc2lvbiA9ICRzb3hTZXR0aW5nc0RpYWxvZy5maW5kKCcjc294LXNldHRpbmdzLWRpYWxvZy12ZXJzaW9uJyk7CiAgICAgIGNvbnN0ICRzb3hTZXR0aW5nc1NhdmUgPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnI3NveC1zZXR0aW5ncy1kaWFsb2ctc2F2ZScpOwogICAgICBjb25zdCAkc294U2V0dGluZ3NSZXNldCA9ICRzb3hTZXR0aW5nc0RpYWxvZy5maW5kKCcjc294LXNldHRpbmdzLWRpYWxvZy1yZXNldCcpOwogICAgICBjb25zdCAkc294U2V0dGluZ3NEZWJ1Z2dpbmcgPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnI3NveC1zZXR0aW5ncy1kaWFsb2ctZGVidWdnaW5nJyk7CiAgICAgIGNvbnN0ICRzb3hTZXR0aW5nc05ld0FjY2Vzc1Rva2VuQnV0dG9uID0gJHNveFNldHRpbmdzRGlhbG9nLmZpbmQoJyNzb3gtc2V0dGluZ3MtZGlhbG9nLWFjY2Vzcy10b2tlbicpOwogICAgICBjb25zdCAkc294U2V0dGluZ3NUb2dnbGUgPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnI3NveC1zZXR0aW5ncy1kaWFsb2ctY2hlY2stdG9nZ2xlJyk7CiAgICAgIGNvbnN0ICRzb3hTZXR0aW5nc0Nsb3NlID0gJHNveFNldHRpbmdzRGlhbG9nLmZpbmQoJyNzb3gtc2V0dGluZ3MtZGlhbG9nLWNsb3NlJyk7CiAgICAgIGNvbnN0ICRzZWFyY2hCb3ggPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnI3NlYXJjaCcpOwogICAgICBjb25zdCAkaW1wb3J0U2V0dGluZ3NCdXR0b24gPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnI3NveC1zZXR0aW5ncy1pbXBvcnQnKTsKICAgICAgY29uc3QgJGV4cG9ydFNldHRpbmdzQnV0dG9uID0gJHNveFNldHRpbmdzRGlhbG9nLmZpbmQoJyNzb3gtc2V0dGluZ3MtZXhwb3J0Jyk7CiAgICAgIGNvbnN0ICRmZWF0dXJlUGFja0J1dHRvbnMgPSAkc294U2V0dGluZ3NEaWFsb2cuZmluZCgnLnNveC1zZXR0aW5ncy1kaWFsb2ctZmVhdHVyZS1wYWNrJyk7CgogICAgICAvLyBBcnJheSBvZiBIVE1MIHN0cmluZ3MgdGhhdCB3aWxsIGJlIGRpc3BsYXllZCBhcyBgbGlgIGl0ZW1zIGlmIHRoZSB1c2VyIGhhcyBpbnN0YWxsZWQgYSBuZXcgdmVyc2lvbi4KICAgICAgY29uc3QgY2hhbmdlcyA9IFsKICAgICAgICAnRml4IGJ1Z3MgaW4gdmFyaW91cyBmZWF0dXJlcyAodGhhbmtzIEBkb3VibGUtYmVlcCBmb3IgbWFueSBvZiB0aGVzZSEpJywKICAgICAgICAnQWRkIGZlYXR1cmUgdG8gY29weSBtYXJrZG93biBmb3IgY29tbWVudHMnLAogICAgICAgICdBZGQgZmVhdHVyZSB0byBhZGQgc2Nyb2xsaW5nIHRvIHJvb20gbGlzdCBpbiB1c2VyY2FyZHMgaW4gY2hhdCcsCiAgICAgICAgJ09ubHkgcnVuIFNPWCBvbiBIVFRQUycsCiAgICAgICAgJ0RlcHJlY2F0ZSAiYWRkIHRpbWVsaW5lIGJ1dHRvbiIgZmVhdHVyZSAobm93IG5hdGl2ZWx5IGltcGxlbWVudGVkISknLAogICAgICAgICdEZXByZWNhdGUgInNob3cgcXVlc3Rpb24gc3RhdGUgaW4gc3VnZ2VzdGVkIGVkaXQgcmV2aWV3IHF1ZXVlIiAobm93IG5hdGl2ZSEpJwogICAgICBdOwoKICAgICAgZnVuY3Rpb24gYWRkQ2F0ZWdvcnkobmFtZSkgewogICAgICAgIGNvbnN0ICRkaXYgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgICAnY2xhc3MnOiAnaGVhZGVyIGNhdGVnb3J5JywKICAgICAgICAgICdpZCc6ICdoZWFkZXItZm9yLScgKyBuYW1lLAogICAgICAgIH0pOwoKICAgICAgICBjb25zdCAkaDMgPSAkKCc8aDMvPicsIHsKICAgICAgICAgIHRleHQ6IG5hbWUudG9Mb3dlckNhc2UoKSwKICAgICAgICB9KTsKCiAgICAgICAgY29uc3QgJGNvbnRlbnQgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgICBpZDogbmFtZSwKICAgICAgICAgICdjbGFzcyc6ICdtb2RhbC1jb250ZW50IGZlYXR1cmVzJywKICAgICAgICB9KTsKICAgICAgICAkZGl2LmFwcGVuZCgkaDMpOwoKICAgICAgICBpZiAoISRzb3hTZXR0aW5nc0RpYWxvZ0ZlYXR1cmVzLmZpbmQoJ2RpdiNoZWFkZXItZm9yLScgKyBuYW1lKS5sZW5ndGgpIHsKICAgICAgICAgICRzb3hTZXR0aW5nc0RpYWxvZ0ZlYXR1cmVzLmFwcGVuZCgkZGl2KTsKICAgICAgICAgICRkaXYuYWZ0ZXIoJGNvbnRlbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gYWRkRmVhdHVyZShjYXRlZ29yeSwgbmFtZSwgZGVzY3JpcHRpb24sIGZlYXR1cmVTZXR0aW5ncywgZXh0ZW5kZWREZXNjcmlwdGlvbiwgbWV0YUxpbmssIGZlYXR1cmVQYWNrcywgdXNlc0FwaSkgewogICAgICAgIGNvbnN0IGJsb2NrRmVhdHVyZVNlbGVjdGlvbiA9IHVzZXNBcGkgJiYgIXNveC5zZXR0aW5ncy5hY2Nlc3NUb2tlbjsKCiAgICAgICAgY29uc3QgJGRpdiA9ICQoJzxkaXYvPicsIHsKICAgICAgICAgICdjbGFzcyc6ICdzb3gtZmVhdHVyZSAnICsgKGZlYXR1cmVQYWNrcy5sZW5ndGggPyBmZWF0dXJlUGFja3Muam9pbignICcpIDogJycpICsgKGJsb2NrRmVhdHVyZVNlbGVjdGlvbiA/ICcgZGlzYWJsZWQtZmVhdHVyZScgOiAnJyksCiAgICAgICAgICAndGl0bGUnOiBibG9ja0ZlYXR1cmVTZWxlY3Rpb24gPyAnWW91IG11c3QgZ2V0IGFuIGFjY2VzcyB0b2tlbiB0byBlbmFibGUgdGhpcyBmZWF0dXJlIChjbGljayB0aGUga2V5IGJ1dHRvbiBhdCB0aGUgYm90dG9tIG9mIHRoZSBTT1ggZGlhbG9nKScgOiAnJywKICAgICAgICB9KTsKCiAgICAgICAgY29uc3QgJGluZm8gPSBzb3guc3ByaXRlcy5nZXRTdmcoJ2luZm8nKS5ob3ZlcihmdW5jdGlvbigpIHsKICAgICAgICAgIGlmIChleHRlbmRlZERlc2NyaXB0aW9uICYmICEkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5zb3gtZmVhdHVyZS1pbmZvJykubGVuZ3RoKSB7CiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuYXBwZW5kKCQoJzxkaXYvPicsIHsKICAgICAgICAgICAgICAnY2xhc3MnOiAnc294LWZlYXR1cmUtaW5mbycsCiAgICAgICAgICAgICAgJ2h0bWwnOiBleHRlbmRlZERlc2NyaXB0aW9uICsgKG1ldGFMaW5rID8gJyA8YSBocmVmPSInICsgbWV0YUxpbmsgKyAnIj5bbWV0YV08L2E+JyA6ICcnKSwKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBjb25zdCAkbGFiZWwgPSAkKCc8bGFiZWwvPicpOwogICAgICAgIGNvbnN0ICRpbnB1dCA9ICQoJzxpbnB1dC8+JywgewogICAgICAgICAgaWQ6IG5hbWUsCiAgICAgICAgICAnY2xhc3MnOiAncy1jaGVja2JveCcsCiAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLAogICAgICAgIH0pLnByb3AoJ2Rpc2FibGVkJywgYmxvY2tGZWF0dXJlU2VsZWN0aW9uKTsKCiAgICAgICAgJGRpdi5vbignbW91c2VsZWF2ZScsIGZ1bmN0aW9uKCkgewogICAgICAgICAgJCh0aGlzKS5maW5kKCcuc294LWZlYXR1cmUtaW5mbycpLnJlbW92ZSgpOwogICAgICAgIH0pLmFwcGVuZCgkbGFiZWwpLmFwcGVuZChleHRlbmRlZERlc2NyaXB0aW9uID8gJGluZm8gOiAnJyk7CiAgICAgICAgJGxhYmVsLmFwcGVuZCgkaW5wdXQpOwogICAgICAgICRpbnB1dC5hZnRlcihkZXNjcmlwdGlvbik7CiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nRmVhdHVyZXMuZmluZCgnIycgKyBjYXRlZ29yeSkuYXBwZW5kKCRkaXYpOwoKICAgICAgICBpZiAoZmVhdHVyZVNldHRpbmdzKSB7CiAgICAgICAgICBjb25zdCAkc2V0dGluZ3NEaXYgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgICAgIGlkOiAnZmVhdHVyZS1zZXR0aW5ncy0nICsgbmFtZSwKICAgICAgICAgICAgJ2NsYXNzJzogJ3NveC1mZWF0dXJlLXNldHRpbmdzJywKICAgICAgICAgICAgc3R5bGU6ICdkaXNwbGF5OiBub25lOyBtYXJnaW4tdG9wOiA1cHg7JywKICAgICAgICAgIH0pOwoKICAgICAgICAgIGNvbnN0ICRzZXR0aW5nc1RvZ2dsZSA9IHNveC5zcHJpdGVzLmdldFN2Zygnd3JlbmNoJywgJ0VkaXQgdGhpcyBmZWF0dXJlXCdzIHNldHRpbmdzJykuY2xpY2soZSA9PiB7CiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy9kb24ndCB1bmNoZWNrIHRoZSBjaGVja2JveAoKICAgICAgICAgICAgY29uc3QgJHNldHRpbmdzUGFuZWwgPSAkKCcjZmVhdHVyZS1zZXR0aW5ncy0nICsgbmFtZSk7CgogICAgICAgICAgICBpZiAoJHNldHRpbmdzUGFuZWwuaXMoJzp2aXNpYmxlJykpIHsKICAgICAgICAgICAgICAkc2V0dGluZ3NQYW5lbC5mYWRlT3V0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgJHNldHRpbmdzUGFuZWwuZmFkZUluKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICAgIGNvbnN0IG9wdGlvbmFsU2V0dGluZ3MgPSBHTV9nZXRWYWx1ZSgnU09YLScgKyBuYW1lICsgJy1zZXR0aW5ncycsIC0xKTsKCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZlYXR1cmVTZXR0aW5ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb25zdCBjdXJyZW50U2V0dGluZyA9IGZlYXR1cmVTZXR0aW5nc1tpXTsKICAgICAgICAgICAgJHNldHRpbmdzRGl2CiAgICAgICAgICAgICAgLmFwcGVuZChzb3guaGVscGVycy5uZXdFbGVtZW50KGN1cnJlbnRTZXR0aW5nLnR5cGUsIHsgLy91c2UgbmV3RWxlbWVudCBoZWxwZXIgc28gdGhlIHR5cGUgY2FuIGJlIHRoaW5ncyBsaWtlICdjaGVja2JveCcgb3IgJ3JhZGlvJwogICAgICAgICAgICAgICAgaWQ6IGN1cnJlbnRTZXR0aW5nLmlkLAogICAgICAgICAgICAgICAgJ2NsYXNzJzogY3VycmVudFNldHRpbmcudHlwZSA9PT0gJ3RleHRhcmVhJyA/ICdmZWF0dXJlU2V0dGluZyBzLWlucHV0JyA6ICdmZWF0dXJlU2V0dGluZyBzLWNoZWNrYm94JywKICAgICAgICAgICAgICAgICdzdHlsZSc6ICdtYXJnaW4tcmlnaHQ6IDVweCcsCiAgICAgICAgICAgICAgICAnY2hlY2tlZCc6IChjdXJyZW50U2V0dGluZy50eXBlID09PSAnY2hlY2tib3gnID8gSlNPTi5wYXJzZShvcHRpb25hbFNldHRpbmdzKVtjdXJyZW50U2V0dGluZy5pZF0gOiBmYWxzZSksCiAgICAgICAgICAgICAgICB2YWx1ZTogKG9wdGlvbmFsU2V0dGluZ3MgPT09IC0xID8gJycgOiBKU09OLnBhcnNlKG9wdGlvbmFsU2V0dGluZ3MpW2N1cnJlbnRTZXR0aW5nLmlkXSksCiAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgLmFwcGVuZChjdXJyZW50U2V0dGluZy5kZXNjKQogICAgICAgICAgICAgIC5hcHBlbmQoJzxicj4nKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCAkc2F2ZUZlYXR1cmVTZXR0aW5ncyA9ICQoJzxhLz4nLCB7CiAgICAgICAgICAgIGlkOiAnc2F2ZVNldHRpbmdzLScgKyBuYW1lLAogICAgICAgICAgICAnY2xhc3MnOiAnYWN0aW9uIHMtYnRuIHMtYnRuX19zZWNvbmRhcnkgcy1idG5fX3NtJywKICAgICAgICAgICAgdGV4dDogJ1NhdmUgU2V0dGluZ3MnLAogICAgICAgICAgICBjbGljazogZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsgLy9kb24ndCB1bmNoZWNrIHRoZSBjaGVja2JveAogICAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzVG9TYXZlID0ge307CiAgICAgICAgICAgICAgJCgnLnNveC1mZWF0dXJlLmRpc2FibGVkLWZlYXR1cmUgaW5wdXRbdHlwZT0iY2hlY2tib3giXScpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7IC8vdW5jaGVjayBhbnkgZmVhdHVyZXMgdGhhdCBzb21laG93IHdlcmUgY2hlY2tlZCAodGhleSBzaG91bGRuJ3QgYmUgYWJsZSB0byB0aHJvdWdoIHRoZSBVSSkgYnV0IHNob3VsZCBiZSBkaXNhYmxlZCAodXNlciBkb2Vzbid0IGhhdmUgYWNjZXNzIHRva2VuKQogICAgICAgICAgICAgICQodGhpcykucGFyZW50KCkuZmluZCgnLmZlYXR1cmVTZXR0aW5nJykuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHNldHRpbmdzVG9TYXZlWyQodGhpcykuYXR0cignaWQnKV0gPSAoJCh0aGlzKS5pcygnOmNoZWNrYm94JykgPyAkKHRoaXMpLmlzKCc6Y2hlY2tlZCcpIDogJCh0aGlzKS52YWwoKSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgR01fc2V0VmFsdWUoJ1NPWC0nICsgbmFtZSArICctc2V0dGluZ3MnLCBKU09OLnN0cmluZ2lmeShzZXR0aW5nc1RvU2F2ZSkpOwogICAgICAgICAgICAgIHNveC5zZXR0aW5ncy53cml0ZVRvQ29uc29sZSh0cnVlKTsKICAgICAgICAgICAgICBhbGVydCgnU2F2ZWQhJyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKCiAgICAgICAgICAkc2V0dGluZ3NEaXYuYXBwZW5kKCRzYXZlRmVhdHVyZVNldHRpbmdzKTsKCiAgICAgICAgICBjb25zdCAkZmVhdHVyZSA9ICRzb3hTZXR0aW5nc0RpYWxvZ0ZlYXR1cmVzLmZpbmQoJ2lucHV0IycgKyBuYW1lKS5wYXJlbnQoKTsKICAgICAgICAgICRmZWF0dXJlLmFwcGVuZCgkc2V0dGluZ3NUb2dnbGUpOwoKICAgICAgICAgIGlmICgkZGl2LmhhcygnLnNveC1zcHJpdGUtaW5mbycpLmxlbmd0aCkgewogICAgICAgICAgICAkaW5mby5hZnRlcigkc2V0dGluZ3NEaXYpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJGZlYXR1cmUuYXBwZW5kKCRzZXR0aW5nc0Rpdik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyBkaXNwbGF5IHNveCB2ZXJzaW9uIG51bWJlciBpbiB0aGUgZGlhbG9nCiAgICAgIGlmICh2ZXJzaW9uICE9ICd1bmtub3duJyAmJiB2ZXJzaW9uICE9PSBudWxsKSB7CiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nVmVyc2lvbi50ZXh0KCcgdicgKyAodmVyc2lvbiA/IHZlcnNpb24udG9Mb3dlckNhc2UoKSA6ICcnKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nVmVyc2lvbi50ZXh0KCcnKTsKICAgICAgfQoKICAgICAgaWYgKHZlcnNpb24gIT09IGxhc3RWZXJzaW9uSW5zdGFsbGVkKSB7CiAgICAgICAgR01fc2V0VmFsdWUoJ1NPWC1sYXN0VmVyc2lvbkluc3RhbGxlZCcsIHZlcnNpb24pOwogICAgICAgIGNvbnN0ICRuZXdWZXJzaW9uRGV0YWlsc0NvbnRhaW5lciA9ICQoJzxkaXYvPicsIHsKICAgICAgICAgICdjbGFzcyc6ICdzb3gtbmV3LXZlcnNpb24tZGV0YWlscycsCiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0ICRuZXdWZXJzaW9uSGVhZGVyID0gJCgnPGRpdi8+JywgewogICAgICAgICAgJ2NsYXNzJzogJ2hlYWRlciBjYXRlZ29yeScsCiAgICAgICAgICAnaHRtbCc6ICc8aDM+bmV3IGluIHRoaXMgdmVyc2lvbjwvaDM+JywKICAgICAgICB9KTsKCiAgICAgICAgY29uc3QgJGNoYW5nZXMgPSAkKCc8dWwvPicpOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYW5nZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICRjaGFuZ2VzLmFwcGVuZCgkKCc8bGkvPicsIHsKICAgICAgICAgICAgJ2h0bWwnOiBjaGFuZ2VzW2ldLCAvL3RoaXMgYXJyYXkgaXMgZGVmaW5lZCBuZWFyIHRoZSB0b3Agb2YgdGhlIGZpbGUKICAgICAgICAgICAgJ2NsYXNzJzogJ3NveC1uZXctdmVyc2lvbi1pdGVtJywKICAgICAgICAgIH0pKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0ICRuZXdWZXJzaW9uSW5mb0NvbnRhaW5lciA9ICQoJzxkaXYvPicsIHsKICAgICAgICAgICdjbGFzcyc6ICdtb2RhbC1jb250ZW50JywKICAgICAgICAgICdodG1sJzogJGNoYW5nZXMsCiAgICAgICAgfSk7CgogICAgICAgICRzb3hTZXR0aW5nc0RpYWxvZ0ZlYXR1cmVzLmFwcGVuZCgkbmV3VmVyc2lvbkRldGFpbHNDb250YWluZXIuYXBwZW5kKCRuZXdWZXJzaW9uSGVhZGVyKS5hcHBlbmQoJG5ld1ZlcnNpb25JbmZvQ29udGFpbmVyKSk7CiAgICAgIH0KCiAgICAgIGlmIChzb3guaW5mby5kZWJ1Z2dpbmcpICRzb3hTZXR0aW5nc0RlYnVnZ2luZy50ZXh0KCdEaXNhYmxlIGRlYnVnZ2luZycpOwoKICAgICAgLy8gd2lyZSB1cCBldmVudCBoYW5kbGVycwogICAgICAkc294U2V0dGluZ3NDbG9zZS5vbignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nLmhpZGUoKTsKICAgICAgfSk7CgogICAgICAkc294U2V0dGluZ3NSZXNldC5vbignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZXNldCBTT1g/JykpIHsKICAgICAgICAgIHNveC5zZXR0aW5ncy5yZXNldCgpOwogICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7IC8vIHJlbG9hZCBwYWdlIHRvIHJlZmxlY3QgY2hhbmdlZCBzZXR0aW5ncwogICAgICAgIH0KICAgICAgfSk7CgogICAgICAkc294U2V0dGluZ3NEZWJ1Z2dpbmcub24oJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IHNveC5pbmZvLmRlYnVnZ2luZzsKICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnRTdGF0ZSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIEdNX3NldFZhbHVlKCdTT1gtZGVidWcnLCB0cnVlKTsKICAgICAgICAgICRzb3hTZXR0aW5nc0RlYnVnZ2luZy50ZXh0KCdEaXNhYmxlIGRlYnVnZ2luZycpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBHTV9zZXRWYWx1ZSgnU09YLWRlYnVnJywgIWN1cnJlbnRTdGF0ZSk7CiAgICAgICAgICAkc294U2V0dGluZ3NEZWJ1Z2dpbmcudGV4dChjdXJyZW50U3RhdGUgPyAnRW5hYmxlIGRlYnVnZ2luZycgOiAnRGlzYWJsZSBkZWJ1Z2dpbmcnKTsKICAgICAgICB9CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0pOwoKICAgICAgJHNveFNldHRpbmdzTmV3QWNjZXNzVG9rZW5CdXR0b24ub24oJ2NsaWNrJywgKCkgPT4gewogICAgICAgIHdpbmRvdy5vcGVuKCdodHRwczovL3N0YWNrZXhjaGFuZ2UuY29tL29hdXRoL2RpYWxvZz9jbGllbnRfaWQ9NzEzOCZzY29wZT1ub19leHBpcnkmcmVkaXJlY3RfdXJpPWh0dHA6Ly9zb3NjcmlwdGVkLmdpdGh1Yi5pby9zb3gvJyk7CiAgICAgICAgc294LmxvZ2luZm8oJ1RvIGdldCBhIG5ldyBhY2Nlc3MgdG9rZW4sIHBsZWFzZSBnbyB0byB0aGUgZm9sbG93aW5nIFVSTCcsICdodHRwczovL3N0YWNrZXhjaGFuZ2UuY29tL29hdXRoL2RpYWxvZz9jbGllbnRfaWQ9NzEzOCZzY29wZT1ub19leHBpcnkmcmVkaXJlY3RfdXJpPWh0dHA6Ly9zb3NjcmlwdGVkLmdpdGh1Yi5pby9zb3gvJyk7CiAgICAgIH0pOwoKICAgICAgJHNveFNldHRpbmdzVG9nZ2xlLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0ICRpY29uID0gJCh0aGlzKS5maW5kKCdpJyk7CgogICAgICAgIGNvbnN0IGNoZWNrZWQgPSAkaWNvbi5oYXNDbGFzcygnZmFzJyk7CgogICAgICAgIGlmIChjaGVja2VkKSB7CiAgICAgICAgICAkaWNvbi5yZW1vdmVDbGFzcygnZmFzJykuYWRkQ2xhc3MoJ2ZhcicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkaWNvbi5yZW1vdmVDbGFzcygnZmFyJykuYWRkQ2xhc3MoJ2ZhcycpOwogICAgICAgIH0KCiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nRmVhdHVyZXMuZmluZCgnaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgIWNoZWNrZWQpOwogICAgICB9KTsKCiAgICAgICRzb3hTZXR0aW5nc1NhdmUub24oJ2NsaWNrJywgKCkgPT4gewogICAgICAgIGNvbnN0IHNldHRpbmdzID0gW107CiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nRmVhdHVyZXMuZmluZCgnaW5wdXRbdHlwZT1jaGVja2JveF06Y2hlY2tlZCcpLm5vdCgnLmZlYXR1cmVTZXR0aW5nJykuZWFjaChmdW5jdGlvbigpIHsgLy9OT1QgdGhlIHBlci1mZWF0dXJlIGZlYXR1cmVTZXR0aW5nIGNoZWNrYm94ZXMsIGJlY2F1c2UgdGhleSBhcmUgc2F2ZWQgaW4gVEhFSVIgT1dOIHNldHRpbmcgb2JqZWN0IQogICAgICAgICAgY29uc3QgeCA9ICQodGhpcykuY2xvc2VzdCgnLm1vZGFsLWNvbnRlbnQnKS5hdHRyKCdpZCcpICsgJy0nICsgJCh0aGlzKS5hdHRyKCdpZCcpOwogICAgICAgICAgc2V0dGluZ3MucHVzaCh4KTsgLy9BZGQgdGhlIGZ1bmN0aW9uJ3MgSUQgKGFsc28gdGhlIGNoZWNrYm94J3MgSUQpIHRvIHRoZSBhcnJheQogICAgICAgIH0pOwoKICAgICAgICBzb3guc2V0dGluZ3Muc2F2ZShzZXR0aW5ncyk7CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7IC8vIHJlbG9hZCBwYWdlIHRvIHJlZmxlY3QgY2hhbmdlZCBzZXR0aW5ncwogICAgICB9KTsKCiAgICAgICRpbXBvcnRTZXR0aW5nc0J1dHRvbi5vbignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgY29uc3Qgc2V0dGluZ3NUb0ltcG9ydCA9IHdpbmRvdy5wcm9tcHQoJ1BsZWFzZSBwYXN0ZSB0aGUgc2V0dGluZ3MgZXhhY3RseSBhcyB0aGV5IHdlcmUgZ2l2ZW4gdG8geW91Jyk7CiAgICAgICAgaWYgKCFzZXR0aW5nc1RvSW1wb3J0KSByZXR1cm47CiAgICAgICAgc294LnNldHRpbmdzLnNhdmUoc2V0dGluZ3NUb0ltcG9ydCk7CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0pOwoKICAgICAgJGV4cG9ydFNldHRpbmdzQnV0dG9uLm9uKCdjbGljaycsICgpID0+IHsKICAgICAgICB3aW5kb3cucHJvbXB0KCdZb3VyIHNldHRpbmdzIGFyZSBiZWxvdy4gUHJlc3MgQ3RybC9DbWQgKyBDIHRvIGNvcHkuJywgSlNPTi5zdHJpbmdpZnkoc294LnNldHRpbmdzLmxvYWQoKSkpOwogICAgICB9KTsKCiAgICAgICRzZWFyY2hCb3gub24oJ2tleXVwIGtleWRvd24nLCBmdW5jdGlvbigpIHsgLy9zZWFyY2ggYm94CiAgICAgICAgaWYgKCQodGhpcykudmFsKCkgIT09ICcnKSB7CiAgICAgICAgICBjb25zdCBzZWFyY2hRdWVyeSA9ICQodGhpcykudmFsKCk7CiAgICAgICAgICAkKCcuc294LW5ldy12ZXJzaW9uLWRldGFpbHMnKS5oaWRlKCk7CiAgICAgICAgICAkKCcjc294LXNldHRpbmdzLWRpYWxvZyAuc294LWZlYXR1cmUnKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoJCh0aGlzKS5maW5kKCdsYWJlbCcpLnRleHQoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoUXVlcnkpID09IC0xKSB7CiAgICAgICAgICAgICAgJCh0aGlzKS5oaWRlKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgJCh0aGlzKS5zaG93KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkKCcuY2F0ZWdvcnksIC5mZWF0dXJlcywgI3NveC1zZXR0aW5ncy1kaWFsb2cgLnNveC1mZWF0dXJlLCAuc294LW5ldy12ZXJzaW9uLWRldGFpbHMnKS5mYWRlSW4oKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgJGZlYXR1cmVQYWNrQnV0dG9ucy5jbGljayhmdW5jdGlvbigpIHsKICAgICAgICAkKCcjc294LXNldHRpbmdzLWRpYWxvZyAuc294LWZlYXR1cmUnKS5yZW1vdmVDbGFzcygnZmVhdHVyZS1mYWRlLW91dCcpOwogICAgICAgIGlmICgkKHRoaXMpLmlzKCcuY2xlYXItZmVhdHVyZS1wYWNrLXNlbGVjdGlvbicpKSByZXR1cm47CiAgICAgICAgJCgnI3NveC1zZXR0aW5ncy1kaWFsb2cgLnNveC1mZWF0dXJlJykubm90KCcuJyArICQodGhpcykuYXR0cignZGF0YS1mZWF0dXJlLXBhY2staWQnKSkuYWRkQ2xhc3MoJ2ZlYXR1cmUtZmFkZS1vdXQnKTsKICAgICAgfSk7CgogICAgICAvLyBjcmVhdGUgc294IHNldHRpbmdzIGJ1dHRvbgogICAgICBjb25zdCAkc294U2V0dGluZ3NCdXR0b24gPSAkKCc8YS8+JywgewogICAgICAgIGlkOiAnc294U2V0dGluZ3NCdXR0b24nLAogICAgICAgICdjbGFzcyc6ICdzb3gtc2V0dGluZ3MtYnV0dG9uIC1saW5rJywKICAgICAgICB0aXRsZTogJ0NoYW5nZSBTT1ggc2V0dGluZ3MnLAogICAgICAgIGhyZWY6ICcjJywKICAgICAgICBjbGljazogZnVuY3Rpb24oZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgJCgnI3NveC1zZXR0aW5ncy1kaWFsb2cnKS50b2dnbGUoKTsKICAgICAgICAgIGlmICgkc294U2V0dGluZ3NEaWFsb2cuaXMoJzp2aXNpYmxlJykpIHsKICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygndG9wYmFyLWljb24tb24nKTsKICAgICAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nLmZpbmQoJyNzZWFyY2gnKS5mb2N1cygpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygndG9wYmFyLWljb24tb24nKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICB9KTsKCiAgICAgIC8vIFZlcnkgYmFzaWMgJ2RhcmsgdGhlbWUnIHN1cHBvcnQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzQwNgogICAgICAvLyBOb3Qgc3VyZSB3aGF0IHRoZSBiZXN0IHdheSB0byBkZXRlY3QgZGFyayBtb2RlIGlzOyB0aGUgZm9sbG93aW5nIGp1c3QgY2hlY2tzIHRvCiAgICAgIC8vIHNlZSBpZiA8Ym9keT4ncyB0ZXh0IGNvbG9yIGlzICNjY2MgKGdyZXkvcmdiKDIwNCwyMDQsMjA0KSkuIE1pZ2h0IG5lZWQgY2hhbmdpbmcKICAgICAgLy8gaW4gZnV0dXJlCiAgICAgIGlmICgkKCdib2R5JykuY3NzKCdjb2xvcicpID09PSAncmdiKDIwNCwgMjA0LCAyMDQpJykgewogICAgICAgIHNveC5kZWJ1ZygnRGFyayBtb2RlIGRldGVjdGVkLCB0d2Vha2luZyBTT1ggQ1NTJyk7CiAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nLmFkZENsYXNzKCdkYXJrLW1vZGUnKTsKICAgICAgfQoKICAgICAgY29uc3QgJGljb24gPSBzb3guc3ByaXRlcy5nZXRTdmcoJ3NldHRpbmdzJywgJ0NoYW5nZSB5b3VyIFNPWCBzZXR0aW5ncycsIHsKICAgICAgICBmaWxsOiAkKCcudG9wLWJhciAuLXNlY29uZGFyeSAuLWxpbmsnKS5jc3MoJ2NvbG9yJyksCiAgICAgICAgd2lkdGg6ICcyNXB4JywKICAgICAgICBoZWlnaHQ6ICcyNXB4JywKICAgICAgfSk7CgogICAgICAvL2Nsb3NlIGRpYWxvZyBpZiBjbGlja2VkIG91dHNpZGUgaXQKICAgICAgJChkb2N1bWVudCkuY2xpY2soZSA9PiB7IC8vY2xvc2UgZGlhbG9nIGlmIGNsaWNrZWQgb3V0c2lkZSBpdAogICAgICAgIGNvbnN0ICR0YXJnZXQgPSAkKGUudGFyZ2V0KTsKICAgICAgICBjb25zdCBpc1RvZ2dsZSA9ICR0YXJnZXQuaXMoJyNzb3hTZXR0aW5nc0J1dHRvbiwgI3NveC1zZXR0aW5ncy1kaWFsb2cnKTsKICAgICAgICBjb25zdCBpc0NoaWxkID0gJHRhcmdldC5wYXJlbnRzKCcjc294U2V0dGluZ3NCdXR0b24sICNzb3gtc2V0dGluZ3MtZGlhbG9nJykuaXMoJyNzb3hTZXR0aW5nc0J1dHRvbiwgI3NveC1zZXR0aW5ncy1kaWFsb2cnKTsKCiAgICAgICAgaWYgKCFpc1RvZ2dsZSAmJiAhaXNDaGlsZCkgewogICAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nLmhpZGUoKTsKICAgICAgICAgICRzb3hTZXR0aW5nc0J1dHRvbi5yZW1vdmVDbGFzcygndG9wYmFyLWljb24tb24nKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy9jbG9zZSBkaWFsb2cgaWYgb25lIG9mIHRoZSBsaW5rcyBvbiB0aGUgdG9wYmFyIGlzIGNsaWNrZWQKICAgICAgJCgnLnRvcGJhci1pY29uLCAuLWxpbmsnKS5ub3QoJy5zb3gtc2V0dGluZ3MtYnV0dG9uJykuY2xpY2soKCkgPT4gewogICAgICAgICRzb3hTZXR0aW5nc0RpYWxvZy5oaWRlKCk7CiAgICAgICAgJHNveFNldHRpbmdzQnV0dG9uLnJlbW92ZUNsYXNzKCd0b3BiYXItaWNvbi1vbicpOwogICAgICB9KTsKCiAgICAgIC8vIGxvYWQgZmVhdHVyZXMgaW50byBkaWFsb2cKICAgICAgc294LmRlYnVnKCdpbmplY3RpbmcgZmVhdHVyZXMgaW50byBkaWFsb2cnKTsKICAgICAgZm9yIChjb25zdCBjYXRlZ29yeSBpbiBmZWF0dXJlcy5jYXRlZ29yaWVzKSB7CiAgICAgICAgYWRkQ2F0ZWdvcnkoY2F0ZWdvcnkpOwogICAgICAgIGZvciAoY29uc3QgZmVhdHVyZSBpbiBmZWF0dXJlcy5jYXRlZ29yaWVzW2NhdGVnb3J5XSkgewogICAgICAgICAgY29uc3QgY3VycmVudEZlYXR1cmUgPSBmZWF0dXJlcy5jYXRlZ29yaWVzW2NhdGVnb3J5XVtmZWF0dXJlXTsKICAgICAgICAgIGFkZEZlYXR1cmUoCiAgICAgICAgICAgIGNhdGVnb3J5LAogICAgICAgICAgICBjdXJyZW50RmVhdHVyZS5uYW1lLAogICAgICAgICAgICBjdXJyZW50RmVhdHVyZS5kZXNjLAogICAgICAgICAgICAoY3VycmVudEZlYXR1cmUuc2V0dGluZ3MgPyBjdXJyZW50RmVhdHVyZS5zZXR0aW5ncyA6IGZhbHNlKSwgLy9hZGQgdGhlIHNldHRpbmdzIHBhbmVsIGZvciB0aGlzIGZlYXV0cmUgaWYgaW5kaWNhdGVkIGluIHRoZSBKU09OCiAgICAgICAgICAgIChjdXJyZW50RmVhdHVyZS5leHRlbmRlZF9kZXNjcmlwdGlvbiA/IGN1cnJlbnRGZWF0dXJlLmV4dGVuZGVkX2Rlc2NyaXB0aW9uIDogZmFsc2UpLCAvL2FkZCB0aGUgZXh0cmEgZGVzY3JpcHRpb24gb24gaG92ZXIgaWYgdGhlIGZlYXR1cmUgaGFzIHRoZSBleHRlbmRlZCBkZXNjcmlwdGlvbgogICAgICAgICAgICAoY3VycmVudEZlYXR1cmUubWV0YSA/IGN1cnJlbnRGZWF0dXJlLm1ldGEgOiBmYWxzZSksIC8vYWRkIHRoZSBtZXRhIGxpbmsgdG8gdGhlIGV4dHJhIGRlc2NyaXB0aW9uIG9uIGhvdmVyCiAgICAgICAgICAgIChjdXJyZW50RmVhdHVyZS5mZWF0dXJlX3BhY2tzID8gY3VycmVudEZlYXR1cmUuZmVhdHVyZV9wYWNrcyA6IFtdKSwKICAgICAgICAgICAgKGN1cnJlbnRGZWF0dXJlLnVzZXNBcGkgPyBjdXJyZW50RmVhdHVyZS51c2VzQXBpIDogZmFsc2UpCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHNldHRpbmdzKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZXR0aW5ncy5sZW5ndGg7ICsraSkgewogICAgICAgICAgJHNveFNldHRpbmdzRGlhbG9nRmVhdHVyZXMuZmluZCgnIycgKyBzZXR0aW5nc1tpXS5zcGxpdCgnLScpWzFdKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgeyAvLyBubyBzZXR0aW5ncyBmb3VuZCwgbWFyayBhbGwgaW5wdXRzIGFzIGNoZWNrZWQgYW5kIGRpc3BsYXkgc2V0dGluZ3MgZGlhbG9nCiAgICAgICAgLy9ub3RlOiB0aGUgLm5vdCgpIGlzIHRvIG1ha2Ugc3VyZSBhbnkgZGlzYWJsZWQgZmVhdHVyZXMgKHVzZXIgZG9lc24ndCBoYXZlIGFjY2VzcyB0b2tlbikgYXJlbid0IHNlbGVjdGVkIGJ5IGRlZmF1bHQKICAgICAgICAkc294U2V0dGluZ3NEaWFsb2dGZWF0dXJlcy5maW5kKCdpbnB1dCcpLm5vdCgnLnNveC1mZWF0dXJlLmRpc2FibGVkLWZlYXR1cmUgaW5wdXQnKS5wcm9wKCdjaGVja2VkJywgdHJ1ZSk7CiAgICAgICAgJHNveFNldHRpbmdzQnV0dG9uLmFkZENsYXNzKCd0b3BiYXItaWNvbi1vbicpOwogICAgICAgICRzb3hTZXR0aW5nc0RpYWxvZy5zaG93KCk7CiAgICAgIH0KCiAgICAgIC8vIGFkZCBkaWFsb2cgdG8gY29ycmFsIGFuZCBzb3ggYnV0dG9uIHRvIHRvcGJhcgogICAgICAkc294U2V0dGluZ3NCdXR0b24uYXBwZW5kKCRpY29uKTsKICAgICAgLy8gVGhlIGZvbGxvd2luZyBjaGVjayBpcyBiZWNhdXNlIFNPIGRvZXNuJ3QgaGF2ZSBpbmJveCwgYWNoaWV2ZW1lbnRzIGhlbHAgY2VudHJlIGFuZCBzaXRlIHN3aXRjaGVyIGl0ZW1zCiAgICAgIGlmICgkKCcuaW5ib3gtYnV0dG9uLWl0ZW0nKS5sZW5ndGgpIHsKICAgICAgICAkKCcuaW5ib3gtYnV0dG9uLWl0ZW0nKS5iZWZvcmUoJCgnPGxpLz4nKS5hZGRDbGFzcygnLWl0ZW0nKS5hcHBlbmQoJHNveFNldHRpbmdzQnV0dG9uKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJCgnLmpzLXNlYXJjaGJhci10cmlnZ2VyJykuYWZ0ZXIoJCgnPGxpLz4nKS5hZGRDbGFzcygnLWl0ZW0nKS5hcHBlbmQoJHNveFNldHRpbmdzQnV0dG9uKSk7CiAgICAgIH0KCiAgICAgICRzb3hTZXR0aW5nc0RpYWxvZy5jc3MoewogICAgICAgICd0b3AnOiAkKCcudG9wLWJhcicpLmhlaWdodCgpLAogICAgICAgICdyaWdodCc6ICQoJy4tY29udGFpbmVyJykub3V0ZXJXaWR0aCgpIC0gJCgnI3NveFNldHRpbmdzQnV0dG9uJykucGFyZW50KCkucG9zaXRpb24oKS5sZWZ0IC0gJCgnI3NveFNldHRpbmdzQnV0dG9uJykub3V0ZXJXaWR0aCgpLAogICAgICB9KTsKCiAgICAgIC8vb25seSBhZGQgZGlhbG9nIGlmIGJ1dHRvbiB3YXMgYWRkZWQgc3VjY2Vzc2Z1bGx5CiAgICAgIGlmICgkKCcjc294U2V0dGluZ3NCdXR0b24nKS5sZW5ndGgpICQoJy5qcy10b3BiYXItZGlhbG9nLWNvcnJhbCcpLmFwcGVuZCgkc294U2V0dGluZ3NEaWFsb2cpOwogICAgfSwKICB9Owp9KSh3aW5kb3cuc294ID0gd2luZG93LnNveCB8fCB7fSwgalF1ZXJ5KTsK"},{"meta":{"name":"sox.features.js","url":"https://github.com/soscripted/sox/raw/v2.7.0/sox.features.js","ts":1609797270702,"mimetype":"text/javascript"},"source":"KGZ1bmN0aW9uKHNveCwgJCkgewogICd1c2Ugc3RyaWN0JzsKCiAgc294LmZlYXR1cmVzID0geyAvL1NPWCBmdW5jdGlvbnMgbXVzdCBnbyBpbiBoZXJlCiAgICBtb3ZlQm91bnR5OiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBtb3ZpbmcgYm91bnR5IHRvIHRoZSB0b3AKCiAgICAgICQoJy5ib3VudHktbm90aWZpY2F0aW9uJykuaW5zZXJ0QWZ0ZXIoJy5xdWVzdGlvbiAuZnctd3JhcCcpOwogICAgICAkKCcuYm91bnR5LWxpbmsuYm91bnR5JykuY2xvc2VzdCgndWwnKS5pbnNlcnRBZnRlcignLnF1ZXN0aW9uIC5mdy13cmFwJyk7CiAgICB9LAoKICAgIGRyYWdCb3VudHk6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogTWFrZXMgdGhlIGJvdW50eSB3aW5kb3cgZHJhZ2dhYmxlCgogICAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVlc3Rpb24nKTsKICAgICAgc294LmhlbHBlcnMub2JzZXJ2ZSh0YXJnZXQsICcjc3RhcnQtYm91bnR5LXBvcHVwJywgKCkgPT4gewogICAgICAgICQoJyNzdGFydC1ib3VudHktcG9wdXAnKS5kcmFnZ2FibGUoewogICAgICAgICAgZHJhZzogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICQodGhpcykuY3NzKHsKICAgICAgICAgICAgICAnd2lkdGgnOiAnYXV0bycsCiAgICAgICAgICAgICAgJ2hlaWdodCc6ICdhdXRvJywKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9LAogICAgICAgIH0pLmNzcygnY3Vyc29yJywgJ21vdmUnKTsKICAgICAgfSk7CiAgICB9LAoKICAgIHJlbmFtZUNoYXQ6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogUmVuYW1lcyBDaGF0IHRhYnMgdG8gcHJlcGVuZCAnQ2hhdCcgYmVmb3JlIHRoZSByb29tIG5hbWUKCiAgICAgIGlmIChzb3guc2l0ZS50eXBlID09PSAnY2hhdCcpIHsKICAgICAgICBjb25zdCBtYXRjaCA9IGRvY3VtZW50LnRpdGxlLm1hdGNoKC9eKFwoXGQqXCo/XCkgKT8oLiogXHwgW158XSopJC8pOwogICAgICAgIGRvY3VtZW50LnRpdGxlID0gKG1hdGNoWzFdIHx8ICcnKSArICdDaGF0IC0gJyArIG1hdGNoWzJdOwogICAgICB9CiAgICB9LAoKICAgIG1hcmtFbXBsb3llZXM6IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFkZHMgdGhlIFN0YWNrIEV4Y2hhbmdlIGxvZ28gbmV4dCB0byB1c2VycyB0aGF0ICpBUkUqIFN0YWNrIEV4Y2hhbmdlIGVtcGxveWVlcwoKICAgICAgY29uc3QgJGljb24gPSAnPHN2ZyBzdHlsZT0iY29sb3I6JyArICQoJy5tb2QtZmxhaXInKS5jc3MoJ2NvbG9yJykgKyAnIiBhcmlhLWhpZGRlbj0idHJ1ZSIgY2xhc3M9InNveC1tYXJrRW1wbG95ZWVzLWxvZ28gc294LXNwcml0ZSBzdmctaWNvbiBpY29uU3RhY2tFeGNoYW5nZSIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiB2aWV3Qm94PSIwIDAgMTggMTgiPjxwYXRoIGQ9Ik0xNSAxSDNhMiAyIDAgMCAwLTIgMnYyaDE2VjNhMiAyIDAgMCAwLTItMnpNMSAxM2MwIDEuMS45IDIgMiAyaDh2M2wzLTNoMWEyIDIgMCAwIDAgMi0ydi0ySDF2MnptMTYtN0gxdjRoMTZWNnoiPjwvcGF0aD48L3N2Zz4nOwogICAgICBjb25zdCBsb2dvU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgbG9nb1NwYW4uY2xhc3NOYW1lID0gJ3NveC1tYXJrRW1wbG95ZWVzJzsKICAgICAgbG9nb1NwYW4udGl0bGUgPSAnZW1wbG95ZWUgKGFkZGVkIGJ5IFNPWCknOwogICAgICBsb2dvU3Bhbi5pbm5lckhUTUwgPSAkaWNvbjsKCiAgICAgIGZ1bmN0aW9uIGdldElkcygpIHsKICAgICAgICBjb25zdCBhbmNob3JzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EuY29tbWVudC11c2VyLCAudXNlci1kZXRhaWxzIGEsIC5xdWVzdGlvbi1zdW1tYXJ5IC5zdGFydGVkIGEnKV0uZmlsdGVyKGVsID0+IHsKICAgICAgICAgIHJldHVybiAhWy4uLmVsLmNoaWxkcmVuXS5maWx0ZXIoZWwgPT4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdzb3gtbWFya0VtcGxveWVlcycpKS5sZW5ndGggJiYgZWwuaHJlZiAmJiBlbC5ocmVmLm1hdGNoKC9cL3VzZXJzXC9cZCsvKTsKICAgICAgICB9KTsKICAgICAgICBjb25zdCBpZHMgPSBbLi4ubmV3IFNldChhbmNob3JzLm1hcChlbCA9PiBlbC5ocmVmLm1hdGNoKC8oXGQrKS8pWzBdKSldOwogICAgICAgIHNveC5kZWJ1ZygnbWFya0VtcGxveWVlcyB1c2VyIElEcycsIGlkcyk7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5jZWlsKGlkcy5sZW5ndGggLyAxMDApOyBpKyspIHsKICAgICAgICAgIGFwaUNhbGwoaSArIDEsIGlkcy5zbGljZShpICogMTAwLCAoaSAqIDEwMCkgKyAxMDApLCBhbmNob3JzKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFwaUNhbGwocGFnZSwgaWRzLCBhbmNob3JzKSB7CiAgICAgICAgc294LmhlbHBlcnMuZ2V0RnJvbUFQSSh7CiAgICAgICAgICBlbmRwb2ludDogJ3VzZXJzJywKICAgICAgICAgIGlkcywKICAgICAgICAgIHNpdGVuYW1lOiBzb3guc2l0ZS51cmwsCiAgICAgICAgICBmaWx0ZXI6ICchKk14SmNzdjkxVGN6NnlSSCcsCiAgICAgICAgICBsaW1pdDogMTAwLAogICAgICAgICAgcGFnZSwKICAgICAgICAgIGZlYXR1cmVJZDogJ21hcmtFbXBsb3llZXMnLAogICAgICAgICAgY2FjaGVEdXJhdGlvbjogNjAgKiAyNCwgLy8gQ2FjaGUgZm9yIDI0IGhvdXJzIChpbiBtaW51dGVzKQogICAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICAgIHNveC5kZWJ1ZygnbWFya0VtcGxveWVlcyByZXR1cm5lZCBkYXRhJywgaXRlbXMpOwogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoIWl0ZW1zW2ldLmlzX2VtcGxveWVlKSBjb250aW51ZTsKICAgICAgICAgICAgY29uc3QgdXNlcklkID0gaXRlbXNbaV0udXNlcl9pZDsKICAgICAgICAgICAgYW5jaG9ycy5maWx0ZXIoZWwgPT4gZWwuaHJlZi5jb250YWlucyhgL3VzZXJzLyR7dXNlcklkfS9gKSkuZm9yRWFjaChlbCA9PiB7CiAgICAgICAgICAgICAgZWwuYXBwZW5kQ2hpbGQobG9nb1NwYW4uY2xvbmVOb2RlKHRydWUpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGdldElkcygpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1jb21tZW50JywgZ2V0SWRzKTsKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctcmV2aWV3LXBvc3QtYXBwZWFyZWQnLCBnZXRJZHMpOwogICAgfSwKCiAgICBjb3B5Q29tbWVudHNMaW5rOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFkZHMgdGhlICdzaG93IHggbW9yZSBjb21tZW50cycgbGluayBiZWZvcmUgdGhlIGNvbW1uZW50cwogICAgICAvLyBUZXN0IG9uIGUuZy4gaHR0cHM6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL3F1ZXN0aW9ucy8xMjU0MzkvCgogICAgICBmdW5jdGlvbiBjb3B5TGlua3MoKSB7CiAgICAgICAgJCgnLmpzLXNob3ctbGluaycpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAoISQodGhpcykucGFyZW50KCkucHJldigpLmZpbmQoJy5jb21tZW50LXRleHQnKS5sZW5ndGgpIHJldHVybjsgLy8gaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8xOTYKCiAgICAgICAgICBjb25zdCAkZXhpc3RpbmdDbG9uZWRCdG4gPSAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJy5zb3gtY29weUNvbW1lbnRzTGlua0Nsb25lJyk7CiAgICAgICAgICBpZiAoJGV4aXN0aW5nQ2xvbmVkQnRuLmxlbmd0aCkgewogICAgICAgICAgICBpZiAoJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCcuanMtc2hvdy1saW5rLmNvbW1lbnRzLWxpbms6dmlzaWJsZScpLmxlbmd0aCAhPT0gMikgewogICAgICAgICAgICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgY2xvbmVkIHRoZSBidXR0b24sIHdlIHdvdWxkIGV4cGVjdCAyIG9mIHRoZSBidXR0b25zIHRvIG5vdyBleGlzdAogICAgICAgICAgICAgIC8vIElmIG5vdywgZGVsZXRlIHRoZSBjbG9uZSBhcyB0aGUgY29tbWVudHMgaGF2ZSBhbHJlYWR5IGJlZW4gZXhwYW5kZWQgKGRpcmVjdCBsaW5rIHRvIGRlZXAgY29tbWVudCkKICAgICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8zNzkjaXNzdWVjb21tZW50LTQ2MDA2OTg3NgogICAgICAgICAgICAgICRleGlzdGluZ0Nsb25lZEJ0bi5yZW1vdmUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBEb24ndCBhZGQgYWdhaW4gaWYgd2UndmUgYWxyZWFkeSBjbG9uZWQgdGhlIGJ1dHRvbgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgJGJ0blRvQWRkID0gJCh0aGlzKS5jbG9uZSgpOwogICAgICAgICAgJGJ0blRvQWRkLmFkZENsYXNzKCdzb3gtY29weUNvbW1lbnRzTGlua0Nsb25lJyk7CiAgICAgICAgICAkYnRuVG9BZGQub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICQodGhpcykuaGlkZSgpOwogICAgICAgICAgfSk7CgogICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wcmVwZW5kKCRidG5Ub0FkZCk7CgogICAgICAgICAgJCh0aGlzKS5jbGljaygoKSA9PiB7CiAgICAgICAgICAgICRidG5Ub0FkZC5oaWRlKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5qcy1hZGQtbGluaycsIGZ1bmN0aW9uKCkgeyAvL2h0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMjM5CiAgICAgICAgICBjb25zdCBjb21tZW50UGFyZW50ID0gKCQodGhpcykucGFyZW50cygnLmFuc3dlcicpLmxlbmd0aCA/ICcuYW5zd2VyJyA6ICcucXVlc3Rpb24nKTsKICAgICAgICAgICQodGhpcykuY2xvc2VzdChjb21tZW50UGFyZW50KS5maW5kKCcuanMtc2hvdy1saW5rLmNvbW1lbnRzLWxpbmsnKS5oaWRlKCk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGNvcHlMaW5rcygpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1jb21tZW50JywgY29weUxpbmtzKTsKICAgIH0sCgogICAgaGlnaGxpZ2h0UXVlc3Rpb25zOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBoaWdobGlnaHRpbmcgb25seSB0aGUgdGFncyBvZiBmYXZvcml0ZSBxdWVzdGlvbnMKCiAgICAgIGZ1bmN0aW9uIGhpZ2hsaWdodCgpIHsKICAgICAgICBjb25zdCBpbnRlcmVzdGluZ1F1ZXN0aW9ucyA9IFsuLi5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0YWdnZWQtaW50ZXJlc3RpbmcnKV07CiAgICAgICAgY29uc3QgcXVlc3Rpb25zTGVuZ3RoID0gaW50ZXJlc3RpbmdRdWVzdGlvbnMubGVuZ3RoOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcXVlc3Rpb25zTGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHF1ZXN0aW9uID0gaW50ZXJlc3RpbmdRdWVzdGlvbnNbaV07CiAgICAgICAgICBxdWVzdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCd0YWdnZWQtaW50ZXJlc3RpbmcnKTsKICAgICAgICAgIHF1ZXN0aW9uLmNsYXNzTGlzdC5hZGQoJ3NveC10YWdnZWQtaW50ZXJlc3RpbmcnKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGxldCBjb2xvcjsKICAgICAgaWYgKHNveC5sb2NhdGlvbi5vbignc3VwZXJ1c2VyLmNvbScpKSB7CiAgICAgICAgY29sb3IgPSAnIzAwYTFjOSc7CiAgICAgIH0gZWxzZSBpZiAoc294LmxvY2F0aW9uLm9uKCdzdGFja292ZXJmbG93LmNvbScpKSB7CiAgICAgICAgY29sb3IgPSAnI2Y2OWM1NSc7CiAgICAgIH0gZWxzZSBpZiAoc294LmxvY2F0aW9uLm9uKCdzZXJ2ZXJmYXVsdC5jb20nKSkgewogICAgICAgIGNvbG9yID0gJyNFQTI5MkMnOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGV4aXN0aW5nUG9zdFRhZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwb3N0LXRhZycpOwogICAgICAgIGlmIChleGlzdGluZ1Bvc3RUYWdzLmxlbmd0aCkgewogICAgICAgICAgY29sb3IgPSBleGlzdGluZ1Bvc3RUYWdzWzBdLnN0eWxlLmNvbG9yOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBEZWZhdWx0IGNvbG91ciBpZiB3ZSBjYW4ndCBmaW5kIG9uZSBvbiB0aGUgcGFnZSBhbHJlYWR5CiAgICAgICAgICBjb2xvciA9ICcjMzk3MzlkJzsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgc3R5bGUudHlwZSA9ICd0ZXh0L2Nzcyc7CiAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGAuc294LXRhZ2dlZC1pbnRlcmVzdGluZzpiZWZvcmV7IGJhY2tncm91bmQ6ICR7Y29sb3J9IH1gKSk7CiAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpOwoKICAgICAgaGlnaGxpZ2h0KCk7CgogICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncXVlc3Rpb24tc3VtbWFyeScpLmxlbmd0aCkgewogICAgICAgIGNvbnN0IHRhcmdldE1haW5QYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3F1ZXN0aW9uLW1pbmktbGlzdCcpOwogICAgICAgIGNvbnN0IHRhcmdldFF1ZXN0aW9uc1BhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVlc3Rpb25zJyk7CiAgICAgICAgc294LmhlbHBlcnMub2JzZXJ2ZShbdGFyZ2V0TWFpblBhZ2UsIHRhcmdldFF1ZXN0aW9uc1BhZ2VdLCAnLnF1ZXN0aW9uLXN1bW1hcnknLCBoaWdobGlnaHQpOwogICAgICB9CiAgICB9LAoKICAgIGRpc3BsYXlOYW1lOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBkaXNwbGF5aW5nIHVzZXJuYW1lIG5leHQgdG8gYXZhdGFyIG9uIHRvcGJhcgoKICAgICAgY29uc3QgbmFtZSA9IHNveC51c2VyLm5hbWU7CiAgICAgIGNvbnN0ICRzcGFuID0gJCgnPHNwYW4vPicsIHsKICAgICAgICBjbGFzczogJ3JlcHV0YXRpb24gbGlua3MtY29udGFpbmVyJywKICAgICAgICBzdHlsZTogJCgnLnRvcC1iYXInKS5jc3MoJ2JhY2tncm91bmQtY29sb3InKSA9PSAncmdiKDI1MCwgMjUwLCAyNTEpJyA/ICdjb2xvcjogIzUzNWE2MDsgcGFkZGluZy1yaWdodDogMTJweDsgZm9udC1zaXplOiAxM3B4OycgOiAnY29sb3I6IHdoaXRlOyBwYWRkaW5nLXJpZ2h0OiAxMnB4OyBmb250LXNpemU6IDEzcHg7JywKICAgICAgICB0aXRsZTogbmFtZSwKICAgICAgICB0ZXh0OiBuYW1lLAogICAgICB9KTsKICAgICAgJHNwYW4uaW5zZXJ0QmVmb3JlKCcudG9wLWJhciAuZ3JhdmF0YXItd3JhcHBlci0yNCcpOwogICAgfSwKCiAgICBjb2xvckFuc3dlcmVyOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBoaWdobGlnaHRpbmcgdGhlIG5hbWVzIG9mIGFuc3dlcmVycyBvbiBjb21tZW50cwoKICAgICAgZnVuY3Rpb24gY29sb3IoKSB7CiAgICAgICAgY29uc3QgYW5zd2VyQ2VsbHMgPSBbLi4uZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYW5zd2VyY2VsbCcpXTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFuc3dlckNlbGxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBjZWxsID0gYW5zd2VyQ2VsbHNbaV07CiAgICAgICAgICBjb25zdCBhbnN3ZXJlciA9IGNlbGwucXVlcnlTZWxlY3RvcignLnBvc3Qtc2lnbmF0dXJlOm50aC1sYXN0LW9mLXR5cGUoMSkgYScpOwogICAgICAgICAgaWYgKCFhbnN3ZXJlcikgY29udGludWU7CiAgICAgICAgICBjb25zdCBhbnN3ZXJlcklEID0gYW5zd2VyZXIuaHJlZi5tYXRjaCgvXGQrLylbMF07CiAgICAgICAgICBjb25zdCBjb21tZW50VXNlcnMgPSAkKGNlbGwpLm5leHQoKS5maW5kKCcuY29tbWVudHMgLmNvbW1lbnQtdXNlcicpOwoKICAgICAgICAgIGNvbW1lbnRVc2Vycy5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoIXRoaXMuaHJlZikgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmICh0aGlzLmhyZWYuY29udGFpbnMoYHVzZXJzLyR7YW5zd2VyZXJJRH1gKSkgdGhpcy5jbGFzc0xpc3QuYWRkKCdzb3gtYW5zd2VyZXInKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29sb3IoKTsKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctY29tbWVudCcsIGNvbG9yKTsKICAgIH0sCgogICAga2JkQW5kQnVsbGV0czogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIGJ1dHRvbnMgdG8gdGhlIG1hcmtkb3duIHRvb2xiYXIgdG8gc3Vycm91bmQgc2VsZWN0ZWQgdGVzdCB3aXRoIEtCRCBvciBjb252ZXJ0IHNlbGVjdGlvbiBpbnRvIGEgbWFya2Rvd24gbGlzdAoKICAgICAgZnVuY3Rpb24gcmVwbGFjZVNlbGVjdGVkVGV4dChub2RlLCBuZXdUZXh0KSB7CiAgICAgICAgY29uc3Qgc1MgPSBub2RlLnNlbGVjdGlvblN0YXJ0OwogICAgICAgIGNvbnN0IHNFID0gbm9kZS5zZWxlY3Rpb25FbmQ7CiAgICAgICAgY29uc3QgdmFsID0gbm9kZS52YWx1ZTsKICAgICAgICBjb25zdCB2YWxCZWZvcmUgPSB2YWwuc3Vic3RyaW5nKDAsIHNTKTsKICAgICAgICBjb25zdCB2YWxBZnRlciA9IHZhbC5zdWJzdHJpbmcoc0UpOwoKICAgICAgICAvLyBzaXR1YXRpb24gY29udHJhcnkgdG8gb3VyIGV4cGVjdGF0aW9uCiAgICAgICAgaWYgKHNTID09PSBzRSkgcmV0dXJuOwoKICAgICAgICBub2RlLnZhbHVlID0gdmFsQmVmb3JlICsgbmV3VGV4dCArIHZhbEFmdGVyOwogICAgICAgIG5vZGUuc2VsZWN0aW9uU3RhcnQgPSBub2RlLnNlbGVjdGlvbkVuZCA9IHNTICsgbmV3VGV4dC5sZW5ndGg7CgogICAgICAgIHNveC5TdGFjay5NYXJrZG93bkVkaXRvci5yZWZyZXNoQWxsUHJldmlld3MoKTsKICAgICAgICBub2RlLmZvY3VzKCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGdldFNlbGVjdGlvbihub2RlKSB7CiAgICAgICAgcmV0dXJuIG5vZGUudmFsdWUuc3Vic3RyaW5nKG5vZGUuc2VsZWN0aW9uU3RhcnQsIG5vZGUuc2VsZWN0aW9uRW5kKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYWRkQnVsbGV0cyhub2RlKSB7CiAgICAgICAgY29uc3QgbGlzdCA9ICctICcgKyBnZXRTZWxlY3Rpb24obm9kZSkuc3BsaXQoJ1xuJykuam9pbignXG4tICcpOwogICAgICAgIHJlcGxhY2VTZWxlY3RlZFRleHQobm9kZSwgbGlzdCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZEtiZChub2RlKSB7CiAgICAgICAgc294LmhlbHBlcnMuc3Vycm91bmRTZWxlY3RlZFRleHQobm9kZSwgJzxrYmQ+JywgJzwva2JkPicpOwogICAgICAgIG5vZGUuZm9jdXMoKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZ2V0VGV4dGFyZWEoYnV0dG9uKSB7CiAgICAgICAgLy8gbGkgLT4gdWwgLT4gI3dtZC1idXR0b24tYmFyIC0+IC53bWQtY29udGFpbmVyCiAgICAgICAgcmV0dXJuIGJ1dHRvbi5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYScpOwogICAgICB9CgogICAgICBjb25zdCBrYmRCdG4gPSAnPGxpIGNsYXNzPSJ3bWQtYnV0dG9uIHdtZC1rYmQtYnV0dG9uLXNveCIgdGl0bGU9InN1cnJvdW5kIHNlbGVjdGVkIHRleHQgd2l0aCA8a2JkPiB0YWdzIj48c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTpub25lOyI+a2JkPC9zcGFuPjwvbGk+JzsKICAgICAgY29uc3QgbGlzdEJ0biA9ICc8bGkgY2xhc3M9IndtZC1idXR0b24gd21kLWJ1bGxldC1idXR0b24tc294IiB0aXRsZT0iYWRkIGRhc2hlcyAoXCctXCcpIGJlZm9yZSBldmVyeSBsaW5lIHRvIG1ha2UgYSBidWxsZXQgbGlzdCI+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtaW1hZ2U6bm9uZTsiPiYjeDI1Y2Y7PC9zcGFuPjwvbGk+JzsKCiAgICAgIGZ1bmN0aW9uIGxvb3BBbmRBZGRIYW5kbGVycygpIHsKICAgICAgICBjb25zdCByZWRvQnV0dG9ucyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbaWRePSJ3bWQtcmVkby1idXR0b24iXScpXTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlZG9CdXR0b25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBidXR0b24gPSByZWRvQnV0dG9uc1tpXTsKICAgICAgICAgIGlmICghYnV0dG9uLmRhdGFzZXQua2JkQWRkZWQpIHsKICAgICAgICAgICAgLy8gQ29tcGF0YWJpbGl0eSB3aXRoIGh0dHBzOi8vc3RhY2thcHBzLmNvbS9xLzMzNDEgYXMgcmVxdWVzdGVkIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMzYxCiAgICAgICAgICAgIC8vIFRoZSBTT1gga2JkIGJ1dHRvbiBpc24ndCBhZGRlZCBpZiB0aGF0IHNjcmlwdCBpcyBpbnN0YWxsZWQKICAgICAgICAgICAgaWYgKGJ1dHRvbi5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy50bUFkZGVkLndtZC1rYmQtYnV0dG9uJykpIHsKICAgICAgICAgICAgICBidXR0b24uaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmVuZCcsIGxpc3RCdG4pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGJ1dHRvbi5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyZW5kJywga2JkQnRuICsgbGlzdEJ0bik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnV0dG9uLmRhdGFzZXQua2JkQWRkZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1lZGl0LXdpbmRvdycsIGxvb3BBbmRBZGRIYW5kbGVycyk7CgogICAgICBsb29wQW5kQWRkSGFuZGxlcnMoKTsKCiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBldmVudCA9PiB7CiAgICAgICAgY29uc3Qga0MgPSBldmVudC5rZXlDb2RlOwogICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldDsKCiAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQudGFnTmFtZSA9PT0gJ1RFWFRBUkVBJyAmJiBldmVudC5hbHRLZXkpIHsKICAgICAgICAgIGlmIChrQyA9PT0gNzYpIGFkZEJ1bGxldHModGFyZ2V0KTsgLy8gbAogICAgICAgICAgZWxzZSBpZiAoa0MgPT09IDc1KSBhZGRLYmQodGFyZ2V0KTsgLy8gawogICAgICAgIH0KICAgICAgfSk7CgogICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLndtZC1rYmQtYnV0dG9uLXNveCwgLndtZC1idWxsZXQtYnV0dG9uLXNveCcsIGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0IHRleHRhcmVhID0gZ2V0VGV4dGFyZWEodGhpcyk7CgogICAgICAgIGlmICh0aGlzLmNsYXNzTGlzdC5jb250YWlucygnd21kLWtiZC1idXR0b24tc294JykpIGFkZEtiZCh0ZXh0YXJlYSk7CiAgICAgICAgZWxzZSBhZGRCdWxsZXRzKHRleHRhcmVhKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGVkaXRDb21tZW50OiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBhZGRpbmcgY2hlY2tib3hlcyB3aGVuIGVkaXRpbmcgdG8gYWRkIHByZS1kZWZpbmVkIGVkaXQgcmVhc29ucwoKICAgICAgY29uc3QgREVGQVVMVF9PUFRJT05TID0gWwogICAgICAgIHsgJ2Zvcm1hdHRpbmcnOiAnaW1wcm92ZWQgZm9ybWF0dGluZycgfSwKICAgICAgICB7ICdzcGVsbGluZyc6ICdjb3JyZWN0ZWQgc3BlbGxpbmcnIH0sCiAgICAgICAgeyAnZ3JhbW1hcic6ICdmaXhlZCBncmFtbWFyJyB9LAogICAgICAgIHsgJ2dyZWV0aW5ncyc6ICdyZW1vdmVkIHRoYW5rcy9ncmVldGluZ3MnIH0sCiAgICAgICAgeyAncmV0YWcnOiAnaW1wcm92ZWQgdXNhZ2Ugb2YgdGFncycgfSwKICAgICAgICB7ICd0aXRsZSc6ICdpbXByb3ZlZCB0aXRsZScgfSwKICAgICAgXTsKCiAgICAgIGZ1bmN0aW9uIHRvTG9jYWxlU2VudGVuY2VDYXNlKHN0cikgewogICAgICAgIHJldHVybiBzdHIuc3Vic3RyKDAsIDEpLnRvTG9jYWxlVXBwZXJDYXNlKCkgKyBzdHIuc3Vic3RyKDEpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjb252ZXJ0T3B0aW9uc1RvTmV3Rm9ybWF0KG9wdGlvbnMpIHsKICAgICAgICAvLyBTdG9yYWdlIGZvcm1hdCB3YXMgY2hhbmdlZCAwMy0wMi0xOQogICAgICAgIC8vIE9sZCBzdG9yYWdlIGZvcm1hdCB3YXMgYW4gYXJyYXkgb2YgYXJyYXlzOiBbW25hbWUsIHRleHRdLCBbbmFtZSwgdGV4dF0sIC4uLl0KICAgICAgICAvLyBUaGlzIGNvbnZlcnRzIGl0IHRvIGFuIG9iamVjdCAobGlrZSBERUZBVUxUX09QVElPTlMgYWJvdmUpCiAgICAgICAgY29uc3QgbmV3T3B0aW9ucyA9IFtdOwogICAgICAgIG9wdGlvbnMuZm9yRWFjaChvcHQgPT4gewogICAgICAgICAgbmV3T3B0aW9ucy5wdXNoKHsKICAgICAgICAgICAgW29wdFswXV06IG9wdFsxXSwKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBuZXdPcHRpb25zOwogICAgICB9CgogICAgICBmdW5jdGlvbiBzYXZlT3B0aW9ucyhvcHRpb25zKSB7CiAgICAgICAgR01fc2V0VmFsdWUoJ2VkaXRSZWFzb25zJywgSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBnZXRPcHRpb25zKCkgewogICAgICAgIGxldCBvcHRpb25zID0gR01fZ2V0VmFsdWUoJ2VkaXRSZWFzb25zJywgLTEpOwogICAgICAgIGlmIChvcHRpb25zID09PSAtMSkgewogICAgICAgICAgb3B0aW9ucyA9IERFRkFVTFRfT1BUSU9OUzsKICAgICAgICAgIHNhdmVPcHRpb25zKG9wdGlvbnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBvcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zKTsKICAgICAgICB9CiAgICAgICAgLy8gSWYgb3B0aW9ucyBhcmUgYmVpbmcgc3RvcmVkIGluIHRoZSBvbGQgZm9ybWF0LCBjb252ZXJ0IHRoZW0gdG8gdGhlIG5ldwogICAgICAgIGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnNbMF0pKSB7CiAgICAgICAgICBvcHRpb25zID0gY29udmVydE9wdGlvbnNUb05ld0Zvcm1hdChvcHRpb25zKTsKICAgICAgICAgIHNhdmVPcHRpb25zKG9wdGlvbnMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZE9wdGlvbnNUb0RpYWxvZygpIHsKICAgICAgICAkKCcjY3VycmVudFZhbHVlcycpLmh0bWwoJyAnKTsKICAgICAgICBjb25zdCBvcHRpb25zID0gZ2V0T3B0aW9ucygpOwogICAgICAgIG9wdGlvbnMuZm9yRWFjaChvcHQgPT4gewogICAgICAgICAgY29uc3QgW1tuYW1lLCB0ZXh0XV0gPSBPYmplY3QuZW50cmllcyhvcHQpOwogICAgICAgICAgJCgnI2N1cnJlbnRWYWx1ZXMnKS5hcHBlbmQoYAogICAgICAgICAgPGRpdj4KICAgICAgICAgICAgPHNlY3Rpb24+JHtuYW1lfTwvc2VjdGlvbj4mbmJzcDs8aT48c2VjdGlvbj4ke3RleHR9PC9zZWN0aW9uPjwvaT4KICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZ3JpZC0tY2VsbCBzLWJ0biBzb3gtZWRpdENvbW1lbnQtZWRpdERpYWxvZ0J1dHRvbiIgZGF0YS1uYW1lPSIke25hbWV9Ij5FZGl0PC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9ImdyaWQtLWNlbGwgcy1idG4gcy1idG5fX2RhbmdlciBzb3gtZWRpdENvbW1lbnQtZGVsZXRlRGlhbG9nQnV0dG9uIiBkYXRhLW5hbWU9IiR7bmFtZX0iPkRlbGV0ZTwvYnV0dG9uPgogICAgICAgICAgPC9kaXY+YCk7CiAgICAgICAgfSk7CiAgICAgICAgYWRkQ2hlY2tib3hlcygpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjcmVhdGVEaWFsb2dFZGl0UmVhc29ucygpIHsKICAgICAgICBjb25zdCAkc2V0dGluZ3NEaWFsb2cgPSBzb3guaGVscGVycy5jcmVhdGVNb2RhbCh7CiAgICAgICAgICAnaGVhZGVyJzogJ1NPWDogVmlldy9SZW1vdmUgRWRpdCBSZWFzb25zJywKICAgICAgICAgICdpZCc6ICdkaWFsb2dFZGl0UmVhc29ucycsCiAgICAgICAgICAnY3NzJzogewogICAgICAgICAgICAnbWluLSB3aWR0aCc6ICc1MCUnLAogICAgICAgICAgfSwKICAgICAgICAgICdodG1sJzogYDxkaXYgaWQ9ImN1cnJlbnRWYWx1ZXMiIGNsYXNzPSJzb3gtZWRpdENvbW1lbnQtY3VycmVudFZhbHVlcyI+PC9kaXY+CiAgICAgICAgICAgICAgICAgIDxiciAvPgogICAgICAgICAgICAgICAgICA8aDMgc3R5bGU9ImNvbG9yOiB2YXIoLS1mYy1kYXJrKSI+QWRkIGEgY3VzdG9tIHJlYXNvbjwvaDM+CiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQgZ3M0IGdzeSBmZC1jb2x1bW4iIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUiPgogICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ3JpZC0tY2VsbCIgc3R5bGU9ImZsb2F0OiBsZWZ0Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9ImQtYmxvY2sgcy1sYWJlbCIgc3R5bGU9InBhZGRpbmctdG9wOiA1cHgiPkRpc3BsYXkgcmVhc29uOiA8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJncmlkIHBzLXJlbGF0aXZlIiBzdHlsZT0icGFkZGluZy1sZWZ0OiA1cHgiPgogICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0icy1pbnB1dCIgdHlwZT0idGV4dCIgc3R5bGU9IndpZHRoOiA0MCUgIWltcG9ydGFudCIgaWQ9ImRpc3BsYXlSZWFzb24iPgogICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJncmlkIGdzNCBnc3kgZmQtY29sdW1uIiBzdHlsZT0iZGlzcGxheTogaW5saW5lIj4KICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQtLWNlbGwiIHN0eWxlPSJmbG9hdDogbGVmdCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSJkLWJsb2NrIHMtbGFiZWwiIHN0eWxlPSJwYWRkaW5nLXRvcDogNXB4Ij5BY3R1YWwgcmVhc29uOiA8L2xhYmVsPgogICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJncmlkIHBzLXJlbGF0aXZlIiBzdHlsZT0icGFkZGluZy1sZWZ0OiA1cHgiPgogICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0icy1pbnB1dCIgdHlwZT0idGV4dCIgc3R5bGU9IndpZHRoOiA0MCUgIWltcG9ydGFudCIgaWQ9ImFjdHVhbFJlYXNvbiI+CiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0icy1idG4gcy1idG5fX3ByaW1hcnkiIHR5cGU9ImJ1dHRvbiIgaWQ9InN1Ym1pdFVwZGF0ZSIgdmFsdWU9IlN1Ym1pdCI+CiAgICAgICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz0icy1idG4gcy1idG5fX3ByaW1hcnkiIHR5cGU9ImJ1dHRvbiIgaWQ9InJlc2V0RWRpdFJlYXNvbnMiIHN0eWxlPSJmbG9hdDpyaWdodDsiIHZhbHVlPSJSZXNldCI+YCwKICAgICAgICB9KTsKCiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJyNyZXNldEVkaXRSZWFzb25zJywgKCkgPT4geyAvL21hbnVhbCByZXNldAogICAgICAgICAgaWYgKGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZXNldCB0aGUgc2V0dGluZ3MgdG8gdGhlIGRlZmF1bHQgb25lcz8gVGhlIHBhZ2Ugd2lsbCBiZSByZWZyZXNoZWQgYWZ0ZXJ3YXJkcycpKSB7CiAgICAgICAgICAgIHNhdmVPcHRpb25zKERFRkFVTFRfT1BUSU9OUyk7CiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAkKCdib2R5JykuYXBwZW5kKCRzZXR0aW5nc0RpYWxvZyk7CiAgICAgICAgJCgnI2RpYWxvZ0VkaXRSZWFzb25zJykuc2hvdyg1MDApOwogICAgICB9CgogICAgICBmdW5jdGlvbiBhZGRDaGVja2JveGVzKCkgewogICAgICAgIGNvbnN0ICRlZGl0Q29tbWVudEZpZWxkID0gJCgnaW5wdXRbaWRePSJlZGl0LWNvbW1lbnQiXScpOyAvL05PVEU6IGlucHV0IHNwZWNpZmNhbGx5IG5lZWRlZCwgZHVlIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMzYzCiAgICAgICAgaWYgKCEkZWRpdENvbW1lbnRGaWVsZC5sZW5ndGgpIHJldHVybjsgLy9odHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzI0NgoKICAgICAgICAkKCcjcmVhc29ucycpLnJlbW92ZSgpOyAvL3JlbW92ZSB0aGUgZGl2IGNvbnRhaW5pbmcgZXZlcnl0aGluZywgd2UncmUgZ29pbmcgdG8gYWRkL3JlbW92ZSBzdHVmZiBub3c6CiAgICAgICAgaWYgKC9cL2VkaXQvLnRlc3Qoc294LnNpdGUuaHJlZikgfHwgJCgnW2NsYXNzXj0iaW5saW5lLWVkaXRvciJdJykubGVuZ3RoIHx8ICQoJy5lZGl0LWNvbW1lbnQnKS5sZW5ndGgpIHsKICAgICAgICAgICRlZGl0Q29tbWVudEZpZWxkLmFmdGVyKCc8ZGl2IGlkPSJyZWFzb25zIiBzdHlsZT0iZmxvYXQ6bGVmdDtjbGVhcjpib3RoIj48L2Rpdj4nKTsKICAgICAgICAgIGNvbnN0ICRyZWFzb25zID0gJCgnI3JlYXNvbnMnKTsKCiAgICAgICAgICBjb25zdCBvcHRpb25zID0gZ2V0T3B0aW9ucygpOwogICAgICAgICAgb3B0aW9ucy5mb3JFYWNoKG9wdCA9PiB7CiAgICAgICAgICAgIGNvbnN0IFtbbmFtZSwgdGV4dF1dID0gT2JqZWN0LmVudHJpZXMob3B0KTsKICAgICAgICAgICAgJHJlYXNvbnMuYXBwZW5kKGAKICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9InNveC1lZGl0Q29tbWVudC1yZWFzb24iPjxpbnB1dCBjbGFzcz0icy1jaGVja2JveCIgdHlwZT0iY2hlY2tib3giIHZhbHVlPSIke3RleHR9IjwvaW5wdXQ+JHtuYW1lfTwvbGFiZWw+Jm5ic3A7CiAgICAgICAgICAgIGApOwogICAgICAgICAgfSk7CgogICAgICAgICAgJHJlYXNvbnMuZmluZCgnaW5wdXRbdHlwZT0iY2hlY2tib3giXScpLmNoYW5nZShmdW5jdGlvbigpIHsKICAgICAgICAgICAgY29uc3QgcmVhc29uX3ZhbHVlID0gJCh0aGlzKS52YWwoKTsKICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tlZCkgeyAvL0FkZCBpdCB0byB0aGUgc3VtbWFyeQogICAgICAgICAgICAgIGlmICgkZWRpdENvbW1lbnRGaWVsZC52YWwoKSkgewogICAgICAgICAgICAgICAgJGVkaXRDb21tZW50RmllbGQudmFsKCRlZGl0Q29tbWVudEZpZWxkLnZhbCgpICsgJzsgJyArIHJlYXNvbl92YWx1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRlZGl0Q29tbWVudEZpZWxkLnZhbCh0b0xvY2FsZVNlbnRlbmNlQ2FzZShyZWFzb25fdmFsdWUpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY29uc3QgbmV3RWRpdENvbW1lbnQgPSAkZWRpdENvbW1lbnRGaWVsZC52YWwoKTsgLy9SZW1vdmUgdGhlIGxhc3Qgc3BhY2UgYW5kIGxhc3Qgc2VtaWNvbG9uCiAgICAgICAgICAgICAgJGVkaXRDb21tZW50RmllbGQudmFsKG5ld0VkaXRDb21tZW50KS5mb2N1cygpOwogICAgICAgICAgICB9IGVsc2UgeyAvL1JlbW92ZSBpdCBmcm9tIHRoZSBzdW1tYXJ5CiAgICAgICAgICAgICAgJGVkaXRDb21tZW50RmllbGQudmFsKCRlZGl0Q29tbWVudEZpZWxkLnZhbCgpLnJlcGxhY2UoJzsgJyArIHJlYXNvbl92YWx1ZSwgJycpKTsgLy9mb3IgbWlkZGxlIGFuZCBlbmQgdmFsdWVzCiAgICAgICAgICAgICAgJGVkaXRDb21tZW50RmllbGQudmFsKCRlZGl0Q29tbWVudEZpZWxkLnZhbCgpLnJlcGxhY2UobmV3IFJlZ0V4cChyZWFzb25fdmFsdWUgKyAnOz8gPycsICdpJyksICcnKSk7IC8vZm9yIHN0YXJ0IHZhbHVlcwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZGlhbG9nRWRpdFJlYXNvbnMgLnNveC1lZGl0Q29tbWVudC1kZWxldGVEaWFsb2dCdXR0b24nLCBmdW5jdGlvbiAoKSB7IC8vQ2xpY2sgaGFuZGxlciB0byBkZWxldGUgYW4gb3B0aW9uCiAgICAgICAgY29uc3Qgb3B0aW9uVG9EZWxldGUgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtbmFtZScpOwogICAgICAgIGNvbnN0IG9wdGlvbnMgPSBnZXRPcHRpb25zKCk7CiAgICAgICAgY29uc3QgaW5kZXggPSBvcHRpb25zLmZpbmRJbmRleChvcHQgPT4gb3B0W29wdGlvblRvRGVsZXRlXSk7CiAgICAgICAgb3B0aW9ucy5zcGxpY2UoaW5kZXgsIDEpOyAvL2FjdHVhbGx5IGRlbGV0ZSBpdAogICAgICAgIHNhdmVPcHRpb25zKG9wdGlvbnMpOwogICAgICAgIGFkZE9wdGlvbnNUb0RpYWxvZygpOyAvL2Rpc3BsYXkgdGhlIGl0ZW1zIGFnYWluICh1cGRhdGUgdGhlbSkKICAgICAgfSk7CgogICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnI2RpYWxvZ0VkaXRSZWFzb25zIC5zb3gtZWRpdENvbW1lbnQtZWRpdERpYWxvZ0J1dHRvbicsIGZ1bmN0aW9uICgpIHsgLy9DbGljayBoYW5kbGVyIHRvIGVkaXQgYW4gb3B0aW9uCiAgICAgICAgY29uc3Qgb3B0aW9uVG9FZGl0ID0gJCh0aGlzKS5hdHRyKCdkYXRhLW5hbWUnKTsKICAgICAgICBjb25zdCBvcHRpb25zID0gZ2V0T3B0aW9ucygpOwogICAgICAgIGNvbnN0IGluZGV4ID0gb3B0aW9ucy5maW5kSW5kZXgob3B0ID0+IG9wdFtvcHRpb25Ub0VkaXRdKTsKCiAgICAgICAgJCh0aGlzKS5odG1sKCdTYXZlJykuYWRkQ2xhc3MoJ3NveC1lZGl0Q29tbWVudC1zYXZlRGlhbG9nQnV0dG9uJykucGFyZW50KCkuZmluZCgnc2VjdGlvbicpLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsIHRydWUpLmNzcygnYm9yZGVyJywgJzFweCBzb2xpZCB2YXIoLS1ibGFjay0yMDApJyk7CiAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zb3gtZWRpdENvbW1lbnQtc2F2ZURpYWxvZ0J1dHRvbicsIGZ1bmN0aW9uKCkgewogICAgICAgICAgJCh0aGlzKS5odG1sKCdFZGl0JykucmVtb3ZlQ2xhc3MoJ3NveC1lZGl0Q29tbWVudC1zYXZlRGlhbG9nQnV0dG9uJykucGFyZW50KCkuZmluZCgnc2VjdGlvbicpLmF0dHIoJ2NvbnRlbnRlZGl0YWJsZScsIGZhbHNlKS5jc3MoJ2JvcmRlcicsICdub25lJyk7CiAgICAgICAgICBjb25zdCBuZXdOYW1lID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCdzZWN0aW9uJykuZmlyc3QoKS5odG1sKCk7CiAgICAgICAgICBjb25zdCBuZXdUZXh0ID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCdzZWN0aW9uJykuZXEoMSkuaHRtbCgpOwoKICAgICAgICAgIG9wdGlvbnNbaW5kZXhdID0geyBbbmV3TmFtZV06IG5ld1RleHQgfTsKICAgICAgICAgIHNhdmVPcHRpb25zKG9wdGlvbnMpOwogICAgICAgICAgYWRkT3B0aW9uc1RvRGlhbG9nKCk7IC8vZGlzcGxheSB0aGUgaXRlbXMgYWdhaW4gKHVwZGF0ZSB0aGVtKQogICAgICAgIH0pOwogICAgICB9KTsKCiAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZGlhbG9nRWRpdFJlYXNvbnMgI3N1Ym1pdFVwZGF0ZScsICgpID0+IHsgLy9DbGljayBoYW5kbGVyIHRvIHVwZGF0ZSB0aGUgYXJyYXkgd2l0aCBjdXN0b20gdmFsdWUKICAgICAgICBjb25zdCBuYW1lID0gJCgnI2Rpc3BsYXlSZWFzb24nKS52YWwoKTsKICAgICAgICBjb25zdCB0ZXh0ID0gJCgnI2FjdHVhbFJlYXNvbicpLnZhbCgpOwoKICAgICAgICBpZiAoIW5hbWUgfHwgIXRleHQpIHsKICAgICAgICAgIGFsZXJ0KCdQbGVhc2UgZW50ZXIgc29tZXRoaW5nIGluIGJvdGggdGhlIHRleHRib3hlcyEnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3Qgb3B0aW9uVG9BZGQgPSB7IFtuYW1lXTogdGV4dCB9OwogICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGdldE9wdGlvbnMoKTsKICAgICAgICAgIG9wdGlvbnMucHVzaChvcHRpb25Ub0FkZCk7CiAgICAgICAgICBzYXZlT3B0aW9ucyhvcHRpb25zKTsKCiAgICAgICAgICBhZGRPcHRpb25zVG9EaWFsb2coKTsgLy9kaXNwbGF5IHRoZSBpdGVtcyBhZ2FpbiAodXBkYXRlIHRoZW0pCiAgICAgICAgICAkKCcjZGlzcGxheVJlYXNvbiwgI2FjdHVhbFJlYXNvbicpLnZhbCgnJyk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vQWRkIHRoZSBidXR0b24gdG8gdXBkYXRlIGFuZCB2aWV3IHRoZSB2YWx1ZXMgaW4gdGhlIGhlbHAgbWVudToKICAgICAgc294LmhlbHBlcnMuYWRkQnV0dG9uVG9IZWxwTWVudSh7CiAgICAgICAgJ2lkJzogJ2VkaXRSZWFzb25zTGluaycsCiAgICAgICAgJ2xpbmtUZXh0JzogJ0VkaXQgUmVhc29ucycsCiAgICAgICAgJ3N1bW1hcnknOiAnRWRpdCB5b3VyIHBlcnNvbmFsIGVkaXQgcmVhc29ucyAoZWRpdCBzdW1tYXJ5IGNoZWNrYm94ZXMpJywKICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjcmVhdGVEaWFsb2dFZGl0UmVhc29ucygpOyAvL1Nob3cgdGhlIGRpYWxvZyB0byB2aWV3IGFuZCB1cGRhdGUgdmFsdWVzCiAgICAgICAgICBhZGRPcHRpb25zVG9EaWFsb2coKTsKICAgICAgICB9LAogICAgICB9KTsKCiAgICAgIGFkZENoZWNrYm94ZXMoKTsKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1lZGl0LXdpbmRvdycsIGFkZENoZWNrYm94ZXMpOwogICAgfSwKCiAgICBzaGFyZUxpbmtzUHJpdmFjeTogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBSZW1vdmUgeW91ciB1c2VyIElEIGZyb20gdGhlICdzaGFyZScgbGluawoKICAgICAgJCgnLmpzLXNoYXJlLWxpbmsnKS5lYWNoKChpLCBlbCkgPT4gewogICAgICAgIGVsLmhyZWYgPSBlbC5ocmVmLm1hdGNoKC9cLyhxfGEpXC9bMC05XSsvKVswXTsKICAgICAgfSkuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgIC8vIFJlbW92ZSB0aGUgJ2luY2x1ZGVzIHlvdXIgdXNlciBpZCcgc3RyaW5nLCBkbyBpdCBvbiBjbGljayBiZWNhdXNlCiAgICAgICAgLy8gU0UncyBjb2RlIHNlZW1zIHRvIHJlLWFkZCB0aGUgZWxlbWVudCB3aGVuIHRoZSBzaGFyZSB0aXAgaXMgc2hvd24KICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5qcy1zdWJ0aXRsZScpLnJlbW92ZSgpOwogICAgICB9KTsKICAgIH0sCgogICAgc2hhcmVMaW5rc01hcmtkb3duOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBjaGFuZ2luZyB0aGUgJ3NoYXJlJyBidXR0b24gbGluayB0byB0aGUgZm9ybWF0IFtuYW1lXShsaW5rKQoKICAgICAgY29uc3QgdGl0bGUgPSAkKCcuZnMtaGVhZGxpbmUxLmZsMScpLnRleHQoKS5yZXBsYWNlKC9cWyhvblxzaG9sZHxkdXBsaWNhdGUpXF0vZywgJygkMSknKTsgLy8gaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8yMjYsIGh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMjkyCiAgICAgICQoJy5qcy1zaGFyZS1saW5rJykuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnN0ICRpbnB1dEVsID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCcuanMtaW5wdXQnKTsKCiAgICAgICAgLy8gVE9ETzogaXMgdGhlcmUgYSB3YXkgdG8gZG8gdGhpcyB3aXRob3V0IGEgaGFja3kgc2V0VGltZW91dD8KICAgICAgICAvLyBTZWVtcyBsaWtlIFNFIGhhcyBzb21lIEpTIHRoYXQgcG9wdWxhdGVzIHRoZSBpbnB1dCBmaWVsZCB3aGljaCBvdmVyd3JpdGVzCiAgICAgICAgLy8gYW55dGhpbmcgd2UgZG8gdW5sZXNzIHRoZXJlJ3MgYSBzZXRUaW1lb3V0CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAvLyAkKHRoaXMpLmF0dHIoJ2hyZWYnKSBpcyByZWxhdGl2ZSwgc28gbWFrZSBpdCBhYnNvbHV0ZQogICAgICAgICAgY29uc3QgaHJlZiA9IG5ldyBVUkwoJCh0aGlzKS5hdHRyKCdocmVmJyksIHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5ocmVmOwogICAgICAgICAgY29uc3QgdGV4dFRvQ29weSA9IGBbJHt0aXRsZX1dKCR7aHJlZn0pYDsKICAgICAgICAgICRpbnB1dEVsLnZhbCh0ZXh0VG9Db3B5KTsKICAgICAgICAgICRpbnB1dEVsLnNlbGVjdCgpOwogICAgICAgICAgR01fc2V0Q2xpcGJvYXJkKHRleHRUb0NvcHkpOyAvLyBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzE3NwogICAgICAgIH0sIDApOwogICAgICB9KTsKICAgIH0sCgogICAgY29tbWVudFNob3J0Y3V0czogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIHN1cHBvcnQgaW4gY29tbWVudHMgZm9yIEN0cmwrSyxJLEIgdG8gYWRkIGNvZGUgYmFja3RpY2tzLCBpdGFsaWNpc2UsIGJvbGRlbiBzZWxlY3Rpb24KCiAgICAgICQoJy5jb21tZW50cycpLm9uKCdrZXlkb3duJywgJ3RleHRhcmVhJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zdCBlbCA9ICQodGhpcykuZ2V0KDApOwoKICAgICAgICBpZiAoZS53aGljaCA9PSA3NSAmJiBlLmN0cmxLZXkpIHsgLy8gQ3RybCtrIChjb2RlIGJhY2t0aWNrcykKICAgICAgICAgIHNveC5oZWxwZXJzLnN1cnJvdW5kU2VsZWN0ZWRUZXh0KGVsLCAnYCcsICdgJyk7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKGUud2hpY2ggPT0gNzMgJiYgZS5jdHJsS2V5KSB7IC8vIEN0cmwraSAoaXRhbGljaXplKQogICAgICAgICAgc294LmhlbHBlcnMuc3Vycm91bmRTZWxlY3RlZFRleHQoZWwsICcqJywgJyonKTsKICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiAoZS53aGljaCA9PSA2NiAmJiBlLmN0cmxLZXkpIHsgLy8gQ3RybCtiIChib2xkZW4pCiAgICAgICAgICBzb3guaGVscGVycy5zdXJyb3VuZFNlbGVjdGVkVGV4dChlbCwgJyoqJywgJyoqJyk7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIHVuc3BvaWw6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGFkZGluZyBhIGJ1dHRvbiB0byByZXZlYWwgYWxsIHNwb2lsZXJzIGluIGEgcG9zdAoKICAgICAgJCgnI2Fuc3dlcnMgZGl2W2lkKj0iYW5zd2VyIl0sIGRpdltpZCo9InF1ZXN0aW9uIl0nKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5zcG9pbGVyJykubGVuZ3RoKSB7CiAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5wb3N0LW1lbnUnKS5hcHBlbmQoJzxzcGFuIGNsYXNzPSJsc2VwIj58PC9zcGFuPjxhIGlkPSJzaG93U3BvaWxlci0nICsgJCh0aGlzKS5hdHRyKCdpZCcpICsgJyIgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIj51bnNwb2lsPC9zcGFuPicpOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgICQoJ2FbaWQqPSJzaG93U3BvaWxlciJdJykuY2xpY2soZnVuY3Rpb24oKSB7CiAgICAgICAgY29uc3QgeCA9ICQodGhpcykuYXR0cignaWQnKS5zcGxpdCgvLSguKyk/LylbMV07CiAgICAgICAgJCgnIycgKyB4ICsgJyAuc3BvaWxlcicpLnJlbW92ZUNsYXNzKCdzcG9pbGVyJyk7CiAgICAgIH0pOwogICAgfSwKCiAgICBzcG9pbGVyVGlwOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBhZGRpbmcgc29tZSB0ZXh0IHRvIHNwb2lsZXJzIHRvIHRlbGwgcGVvcGxlIHRvIGhvdmVyIG92ZXIgaXQKCiAgICAgIGZ1bmN0aW9uIGFkZFNwb2lsZXJUaXAoKSB7CiAgICAgICAgY29uc3QgJHNwb2lsZXIgPSAkKCcuc3BvaWxlcicpOwoKICAgICAgICAkc3BvaWxlci5wcmVwZW5kKCc8ZGl2IGNsYXNzPSJpc1Nwb2lsZXIiPmhvdmVyIHRvIHNob3cgc3BvaWxlcjxkaXY+Jyk7CiAgICAgICAgJHNwb2lsZXIuaG92ZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5pc1Nwb2lsZXInKS5oaWRlKDUwMCk7CiAgICAgICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5pc1Nwb2lsZXInKS5zaG93KDUwMCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgYWRkU3BvaWxlclRpcCgpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZFNwb2lsZXJUaXApOwogICAgfSwKCiAgICBjb21tZW50UmVwbGllczogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIHJlcGx5IGxpbmtzIHRvIGNvbW1lbnRzCgogICAgICBpZiAoIXNveC51c2VyLmxvZ2dlZEluKSByZXR1cm47CgogICAgICBmdW5jdGlvbiBhZGRSZXBseUxpbmtzKCkgewogICAgICAgICQoJy5jb21tZW50JykuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoISQodGhpcykuZmluZCgnLnNveFJlcGx5TGluaycpLmxlbmd0aCkgeyAvL2lmIHRoZSBsaW5rIGRvZXNuJ3QgYWxyZWFkeSBleGlzdAogICAgICAgICAgICBpZiAoc294LnVzZXIubmFtZSAhPT0gJCh0aGlzKS5maW5kKCcuY29tbWVudC10ZXh0IGEuY29tbWVudC11c2VyJykudGV4dCgpKSB7IC8vbWFrZSBzdXJlIHRoZSBsaW5rIGlzIG5vdCBhZGRlZCB0byB5b3VyIG93biBjb21tZW50cwogICAgICAgICAgICAgICQodGhpcykuZmluZCgnLmNvbW1lbnQtdGV4dCcpLmNzcygnb3ZlcmZsb3cteCcsICdoaWRkZW4nKTsKICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5jb21tZW50LXRleHQgLmNvbW1lbnQtYm9keScpLmFwcGVuZCgnPHNwYW4gY2xhc3M9InNveFJlcGx5TGluayIgdGl0bGU9InJlcGx5IHRvIHRoaXMgdXNlciIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAtN3B4Ij4mY3JhcnI7PC9zcGFuPicpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdzcGFuLnNveFJlcGx5TGluaycsIGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0IHBhcmVudERpdiA9ICQodGhpcykuY2xvc2VzdCgnLnBvc3QtbGF5b3V0Jyk7CiAgICAgICAgY29uc3QgdGV4dFRvQWRkID0gJ0AnICsgJCh0aGlzKS5wYXJlbnQoKS5maW5kKCdhLmNvbW1lbnQtdXNlcicpLnRleHQoKS5yZXBsYWNlKC9ccy9nLCAnJykucmVwbGFjZSgv4pmmLywgJycpOyAvL2VnLiBAVVNFUk5BTUUKICAgICAgICBpZiAoIXBhcmVudERpdi5maW5kKCd0ZXh0YXJlYScpLmxlbmd0aCkgcGFyZW50RGl2LmZpbmQoJ2EuanMtYWRkLWxpbmsnKVswXS5jbGljaygpOyAvL3Nob3cgdGhlIHRleHRhcmVhLCBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMDU1OTY4MC8KCiAgICAgICAgY29uc3QgJHRleHRhcmVhID0gcGFyZW50RGl2LmZpbmQoJ3RleHRhcmVhJyk7CiAgICAgICAgaWYgKCR0ZXh0YXJlYS52YWwoKS5tYXRjaCgvQFteXHNdKy8pKSB7IC8vaWYgYSBwaW5nIGhhcyBhbHJlYWR5IGJlZW4gYWRkZWQKICAgICAgICAgICR0ZXh0YXJlYS52YWwoJHRleHRhcmVhLnZhbCgpLnJlcGxhY2UoL0BbXlxzXSsvLCB0ZXh0VG9BZGQpKTsgLy9yZXBsYWNlIHRoZSBAbmFtZSB3aXRoIHRoZSBuZXcgQG5hbWUKICAgICAgICB9IGVsc2UgewogICAgICAgICAgJHRleHRhcmVhLnZhbCgkdGV4dGFyZWEudmFsKCkgKyB0ZXh0VG9BZGQgKyAnICcpOyAvL2FkZCB0aGUgQG5hbWUKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgYWRkUmVwbHlMaW5rcygpOwoKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctY29tbWVudCcsIGFkZFJlcGx5TGlua3MpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZFJlcGx5TGlua3MpOwogICAgfSwKCiAgICBwYXJzZUNyb3NzU2l0ZUxpbmtzOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBjb252ZXJ0aW5nIGNyb3NzLXNpdGUgbGlua3MgdG8gdGhlaXIgdGl0bGVzCgogICAgICBmdW5jdGlvbiBleHBhbmRMaW5rcygpIHsKICAgICAgICBjb25zdCBpc1F1ZXN0aW9uTGluayA9IC9cLyhxfHF1ZXN0aW9ucylcLy87CiAgICAgICAgY29uc3QgRklMVEVSX1FVRVNUSU9OX1RJVExFID0gJyEpNUlXLTVRdWZEa1hBQ3hxX01UOGFZa1pSaG05JzsKCiAgICAgICAgJCgnLnBvc3QtdGV4dCBhOm5vdCguZXhwYW5kLXBvc3Qtc294KSwgLmNvbW1lbnQtY29weSBhOm5vdCguZXhwYW5kLXBvc3Qtc294KScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zdCBocmVmID0gdGhpcy5ocmVmLnJlcGxhY2UoL2h0dHBzPzpcL1wvLywgJycpLnJlcGxhY2UoL3d3d1wuLywgJycpOwogICAgICAgICAgaWYgKCFocmVmKSByZXR1cm47CgogICAgICAgICAgY29uc3Qgc2l0ZW5hbWUgPSBzb3guaGVscGVycy5nZXRTaXRlTmFtZUZyb21MaW5rKGhyZWYpOwogICAgICAgICAgY29uc3QgcXVlc3Rpb25JRCA9IHNveC5oZWxwZXJzLmdldElERnJvbUxpbmsoaHJlZik7CgogICAgICAgICAgLy8gaWYgaXQgaXMgYSBiYXJlIGxpbmsgaXMgdG8gYSBxdWVzdGlvbiBvbiBhIFNFIHNpdGUKICAgICAgICAgIGlmIChxdWVzdGlvbklEICYmIHNpdGVuYW1lICYmIGlzUXVlc3Rpb25MaW5rLnRlc3QoaHJlZikgJiYgdGhpcy5pbm5lclRleHQucmVwbGFjZSgvaHR0cHM/OlwvXC8vLCAnJykucmVwbGFjZSgvd3d3XC4vLCAnJykgPT09IGhyZWYpIHsKICAgICAgICAgICAgc294LmhlbHBlcnMuZ2V0RnJvbUFQSSh7CiAgICAgICAgICAgICAgZW5kcG9pbnQ6ICdxdWVzdGlvbnMnLAogICAgICAgICAgICAgIGlkczogcXVlc3Rpb25JRCwKICAgICAgICAgICAgICBzaXRlbmFtZSwKICAgICAgICAgICAgICBmaWx0ZXI6IEZJTFRFUl9RVUVTVElPTl9USVRMRSwKICAgICAgICAgICAgICBmZWF0dXJlSWQ6ICdwYXJzZUNyb3NzU2l0ZUxpbmtzJywKICAgICAgICAgICAgICBjYWNoZUR1cmF0aW9uOiAxMCwgLy8gQ2FjaGUgZm9yIDEwIG1pbnV0ZXMKICAgICAgICAgICAgfSwgaXRlbXMgPT4gewogICAgICAgICAgICAgIHRoaXMuaW5uZXJIVE1MID0gaXRlbXNbMF0udGl0bGU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CgogICAgICBleHBhbmRMaW5rcygpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGV4cGFuZExpbmtzKTsKICAgIH0sCgogICAgY29uZmlybU5hdmlnYXRlQXdheTogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIGEgJ2FyZSB5b3UgdXJlIHlvdSB3YW50IHRvIGdvIGF3YXknIGNvbmZpcm1hdGlvbiBvbiBwYWdlcyB3aGVyZSB5b3UgaGF2ZSBzdGFydGVkIHdyaXRpbmcgc29tZXRoaW5nCgogICAgICAkKHdpbmRvdykuYmluZCgnYmVmb3JldW5sb2FkJywgKCkgPT4gewogICAgICAgIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnQtZm9ybSB0ZXh0YXJlYScpOwogICAgICAgIGlmICh0ZXh0YXJlYSAmJiB0ZXh0YXJlYS52YWx1ZSkgewogICAgICAgICAgcmV0dXJuICdEbyB5b3UgcmVhbGx5IHdhbnQgdG8gbmF2aWdhdGUgYXdheT8gQW55dGhpbmcgeW91IGhhdmUgd3JpdHRlbiB3aWxsIGJlIGxvc3QhJzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9KTsKICAgIH0sCgogICAgc29ydEJ5Qm91bnR5QW1vdW50OiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBhZGRpbmcgc29tZSBidXR0b25zIHRvIHNvcnQgYm91bnR5J3MgYnkgc2l6ZQoKICAgICAgLy8gRG8gbm90aGluZyB1bmxlc3MgdGhlcmUgaXMgYXQgbGVhc3Qgb25lIGJvdW50eSBvbiB0aGUgcGFnZQogICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2JvdW50eS1pbmRpY2F0b3InKS5sZW5ndGgpIHJldHVybjsKCiAgICAgIFsuLi5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdxdWVzdGlvbi1zdW1tYXJ5JyldLmZvckVhY2goc3VtbWFyeSA9PiB7CiAgICAgICAgY29uc3QgaW5kaWNhdG9yID0gc3VtbWFyeS5xdWVyeVNlbGVjdG9yKCcuYm91bnR5LWluZGljYXRvcicpOwogICAgICAgIGNvbnN0IGJvdW50eUFtb3VudCA9IGluZGljYXRvciA/IGluZGljYXRvci5pbm5lclRleHQucmVwbGFjZSgnKycsICcnKSA6IHVuZGVmaW5lZDsKICAgICAgICBpZiAoYm91bnR5QW1vdW50KSB7CiAgICAgICAgICBzdW1tYXJ5LnNldEF0dHJpYnV0ZSgnZGF0YS1ib3VudHlhbW91bnQnLCBib3VudHlBbW91bnQpOwogICAgICAgICAgc3VtbWFyeS5jbGFzc0xpc3QuYWRkKCdoYXNCb3VudHknKTsgLy8gQWRkIGEgJ2JvdW50eWFtb3VudCcgYXR0cmlidXRlIHRvIGFsbCB0aGUgcXVlc3Rpb25zCiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIEhvbWVwYWdlL3F1ZXN0aW9ucyB0YWIKICAgICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxdWVzdGlvbi1taW5pLWxpc3QnKSB8fCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVlc3Rpb25zJyk7CgogICAgICAvLyBGaWx0ZXIgYnV0dG9uczoKICAgICAgJCgnLnN1YmhlYWRlcicpLmFmdGVyKCc8c3Bhbj5zb3J0IGJ5IGJvdW50eSBhbW91bnQ6Jm5ic3A7Jm5ic3A7Jm5ic3A7PC9zcGFuPjxzcGFuIGlkPSJsYXJnZXN0Rmlyc3QiPmxhcmdlc3QgZmlyc3QmbmJzcDsmbmJzcDs8L3NwYW4+PHNwYW4gaWQ9InNtYWxsZXN0Rmlyc3QiPnNtYWxsZXN0IGZpcnN0PC9zcGFuPicpOwoKICAgICAgLy8gVGhhbmtzOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNDE2MDUyOS8zNTQxODgxCiAgICAgICQoJyNsYXJnZXN0Rmlyc3QnKS5jc3MoJ2N1cnNvcicsICdwb2ludGVyJykub24oJ2NsaWNrJywgKCkgPT4geyAvLyBMYXJnZXN0IGZpcnN0CiAgICAgICAgWy4uLndyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnLnF1ZXN0aW9uLXN1bW1hcnkuaGFzQm91bnR5JyldLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICAgIHJldHVybiArYi5nZXRBdHRyaWJ1dGUoJ2RhdGEtYm91bnR5YW1vdW50JykgLSArYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtYm91bnR5YW1vdW50Jyk7CiAgICAgICAgfSkucHJlcGVuZFRvKCQod3JhcHBlcikpOwogICAgICB9KTsKCiAgICAgICQoJyNzbWFsbGVzdEZpcnN0JykuY3NzKCdjdXJzb3InLCAncG9pbnRlcicpLm9uKCdjbGljaycsICgpID0+IHsgLy8gU21hbGxlc3QgZmlyc3QKICAgICAgICBbLi4ud3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCcucXVlc3Rpb24tc3VtbWFyeS5oYXNCb3VudHknKV0uc29ydCgoYSwgYikgPT4gewogICAgICAgICAgcmV0dXJuICthLmdldEF0dHJpYnV0ZSgnZGF0YS1ib3VudHlhbW91bnQnKSAtICtiLmdldEF0dHJpYnV0ZSgnZGF0YS1ib3VudHlhbW91bnQnKTsKICAgICAgICB9KS5wcmVwZW5kVG8oJCh3cmFwcGVyKSk7CiAgICAgIH0pOwogICAgfSwKCiAgICBpc1F1ZXN0aW9uSG90OiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBhZGRpbmcgc29tZSB0ZXh0IHRvIHF1ZXN0aW9ucyB0aGF0IGFyZSBpbiB0aGUgaG90IG5ldHdvcmsgcXVlc3Rpb25zIGxpc3QKCiAgICAgIGZ1bmN0aW9uIGdldEhvdERpdihjbGFzc05hbWUpIHsKICAgICAgICByZXR1cm4gJCgnPGRpdi8+JywgewogICAgICAgICAgdGl0bGU6ICdTT1g6IHRoaXMgaXMgYSBob3QgbmV0d29yayBxdWVzdGlvbiEnLAogICAgICAgICAgJ2NsYXNzJzogYHNveC1ob3QgJHtjbGFzc05hbWUgfHwgJyd9YCwKICAgICAgICB9KS5hcHBlbmQoc294LnNwcml0ZXMuZ2V0U3ZnKCdob3QnKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZEhvdFRleHQoKSB7CiAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NveC1ob3QnKS5sZW5ndGgpIHJldHVybjsKICAgICAgICAkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxdWVzdGlvbi1oZWFkZXInKSkucHJlcGVuZChnZXRIb3REaXYoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpdGVuYW1lID0gc294LnNpdGUuY3VycmVudEFwaVBhcmFtZXRlcjsKCiAgICAgIGlmIChzb3gubG9jYXRpb24ub24oJy9xdWVzdGlvbnMnKSkgewogICAgICAgIGNvbnN0IHBvc3RJZCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpWzJdOwogICAgICAgIGFwaUNhbGwocG9zdElkLCBzaXRlbmFtZSk7CiAgICAgIH0gZWxzZSBpZiAoJCgnLnF1ZXN0aW9uLXN1bW1hcnknKS5sZW5ndGgpIHsKICAgICAgICAkKCcucXVlc3Rpb24tc3VtbWFyeScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAvLyBDaGVjayBpZiAucXVlc3Rpb24tc3VtbWFyeSBoYXMgYW4gaWQgYXR0cmlidXRlIC0gU08gVGVhbXMgcG9zdHMgKGF0IHRoZSB0b3Agb2YgdGhlIHBhZ2UsIGlmIGFueSkgZG9uJ3QhCiAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCdpZCcpKSB7CiAgICAgICAgICAgIHZhciBwb3N0SUQgPSAkKHRoaXMpLmF0dHIoJ2lkJykuc3BsaXQoJy0nKVsyXTsKICAgICAgICAgICAgYXBpQ2FsbChwb3N0SUQsIHNpdGVuYW1lLCB0aGlzKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYXBpQ2FsbChwb3N0SUQsIHNpdGVuYW1lLCBlbCkgewogICAgICAgIHNveC5oZWxwZXJzLmdldEZyb21BUEkoewogICAgICAgICAgZW5kcG9pbnQ6ICdwb3N0cycsCiAgICAgICAgICBjaGlsZEVuZHBvaW50OiAncmV2aXNpb25zJywKICAgICAgICAgIHNpdGVuYW1lOiBzaXRlbmFtZSwKICAgICAgICAgIGZpbHRlcjogJyE1UkMtKTlfYXczbWcqaSkzKnZVaFUzV2ZsJywKICAgICAgICAgIGlkczogcG9zdElELAogICAgICAgICAgZmVhdHVyZUlkOiAnaXNRdWVzdGlvbkhvdCcsCiAgICAgICAgICBjYWNoZUR1cmF0aW9uOiA2MCAqIDgsIC8vIENhY2hlIGZvciA4IGhvdXJzCiAgICAgICAgfSwgcmVzdWx0cyA9PiB7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gcmVzdWx0c1tpXTsKICAgICAgICAgICAgaWYgKCFyZXN1bHQuY29tbWVudCAvLyB0aGVyZSdzIG5vIGNvbW1lbnQsIHBvc3Qgd2FzIGNyZWF0ZWQKICAgICAgICAgICAgICB8fCByZXN1bHQuY29tbWVudC5pbmNsdWRlcygnPGI+UG9zdCBDbG9zZWQ8L2I+IGFzICZxdW90OycpIC8vIHBvc3QgaXMgY2xvc2VkCiAgICAgICAgICAgICAgfHwgcmVzdWx0LmNvbW1lbnQuaW5jbHVkZXMoJzxiPlJlbW92ZWQgZnJvbSBIb3QgTmV0d29yayBRdWVzdGlvbnM8L2I+IGJ5JykgLy8gcG9zdCBoYXMgYmVlbiByZW1vdmVkIGZyb20gSE5RCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAocmVzdWx0LmNvbW1lbnQgPT09ICc8Yj5CZWNhbWUgSG90IE5ldHdvcmsgUXVlc3Rpb248L2I+ICcgLy8gcXVlc3Rpb24gaXMgSE5RCiAgICAgICAgICAgICAgJiYgbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwIC0gcmVzdWx0LmNyZWF0aW9uX2RhdGUgPD0gMjU5MjAwIC8vIHF1ZXN0aW9uIGlzIDMgZGF5cyBvbGQKICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgc294LmxvY2F0aW9uLm9uKCcvcXVlc3Rpb25zJykgPyBhZGRIb3RUZXh0KCkgOiAkKGVsKS5maW5kKCcuc3VtbWFyeSBoMycpLnByZXBlbmQoZ2V0SG90RGl2KCdxdWVzdGlvbi1saXN0JykpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCgogICAgbG9jYWxUaW1lc3RhbXBzOiBmdW5jdGlvbihzZXR0aW5ncykgewogICAgICAvLyBEZXNjcmlwdGlvbjogR2V0cyBsb2NhbCB0aW1lc3RhbXAKCiAgICAgICQoJ3NwYW4ucmVsYXRpdmV0aW1lOmNvbnRhaW5zKGF0KSwgc3Bhbi5yZWxhdGl2ZXRpbWUtY2xlYW46Y29udGFpbnMoYXQpJykuZWFjaCh1cGRhdGVUUyk7CgogICAgICBmdW5jdGlvbiB1cGRhdGVUUygpIHsKICAgICAgICBjb25zdCB1dGNUaW1lc3RhbXAgPSAkKHRoaXMpLmF0dHIoJ3RpdGxlJyk7CiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHV0Y1RpbWVzdGFtcC5tYXRjaCgvXihbXGRdezR9KS0oW1xkXXsyfSktKFtcZF17Mn0pIChbXGRdezJ9KTooW1xkXXsyfSk6KFtcZF17Mn0pID8oPzpafFVUQ3xHTVQoPzpbKy1dMDA6PzAwKSkkLyk7CiAgICAgICAgY29uc3QgbW9udGhOYW1lcyA9IFsnSmFuJywgJ0ZlYicsICdNYXInLCAnQXByJywgJ01heScsICdKdW4nLCAnSnVsJywgJ0F1ZycsICdTZXAnLCAnT2N0JywgJ05vdicsICdEZWMnXTsKCiAgICAgICAgaWYgKCFtYXRjaGVzKSByZXR1cm47CgogICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgKICAgICAgICAgIERhdGUuVVRDKAogICAgICAgICAgICBwYXJzZUludChtYXRjaGVzWzFdLCAxMCksCiAgICAgICAgICAgIHBhcnNlSW50KG1hdGNoZXNbMl0sIDEwKSAtIDEsCiAgICAgICAgICAgIHBhcnNlSW50KG1hdGNoZXNbM10sIDEwKSwKICAgICAgICAgICAgcGFyc2VJbnQobWF0Y2hlc1s0XSwgMTApLAogICAgICAgICAgICBwYXJzZUludChtYXRjaGVzWzVdLCAxMCksCiAgICAgICAgICAgIHBhcnNlSW50KG1hdGNoZXNbNl0sIDEwKQogICAgICAgICAgKQogICAgICAgICk7CgogICAgICAgIGNvbnN0IG1vbnRoID0gbW9udGhOYW1lc1tkYXRlLmdldE1vbnRoKCldOwogICAgICAgIGNvbnN0IG1pbnV0ZSA9IChkYXRlLmdldE1pbnV0ZXMoKSA8IDEwID8gJzAnIDogJycpICsgZGF0ZS5nZXRNaW51dGVzKCk7CiAgICAgICAgY29uc3QgeWVhciA9ICgoZGF0ZS5nZXRGdWxsWWVhcigpIC0gMjAwMCkgPCAxMCA/ICcwJyA6ICcnKSArIChkYXRlLmdldEZ1bGxZZWFyKCkgLSAyMDAwKTsKCiAgICAgICAgbGV0IGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7CiAgICAgICAgbGV0IGRheVRpbWUgPSAnJzsKCiAgICAgICAgaWYgKHNldHRpbmdzLnR3ZWx2ZUhvdXJzKSB7CiAgICAgICAgICBkYXlUaW1lID0gJ2FtJzsKCiAgICAgICAgICBpZiAoZGF0ZS5nZXRIb3VycygpID49IDEyKSB7CiAgICAgICAgICAgIGRheVRpbWUgPSAncG0nOwogICAgICAgICAgICBob3VyIC09IDEyOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChob3VyID09PSAwKQogICAgICAgICAgICBob3VyICs9IDEyOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgbmV3VGltZXN0YW1wID0gKG5ldyBEYXRlKCkpLmdldEZ1bGxZZWFyKCkgPT0gZGF0ZS5nZXRGdWxsWWVhcigpID8gbW9udGggKyAnICcgKyBkYXRlLmdldERhdGUoKSArICcgYXQgJyArIGhvdXIgKyAnOicgKyBtaW51dGUgKyBkYXlUaW1lIDogbW9udGggKyAnICcgKyBkYXRlLmdldERhdGUoKSArICcgXCcnICsgeWVhciArICcgYXQgJyArIGhvdXIgKyAnOicgKyBtaW51dGUgKyBkYXlUaW1lOwoKICAgICAgICAkKHRoaXMpLnRleHQobmV3VGltZXN0YW1wKTsKICAgICAgfQogICAgfSwKCiAgICBhdXRvU2hvd0NvbW1lbnRJbWFnZXM6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGF1dG8taW5saW5pbmcgYW55IGxpbmtzIHRvIGltZ3VyIGltYWdlcyBpbiBjb21tZW50cwoKICAgICAgZnVuY3Rpb24gc2hvd0ltYWdlcygpIHsKICAgICAgICAkKCcuY29tbWVudCAuY29tbWVudC10ZXh0IC5jb21tZW50LWNvcHkgYScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zdCBocmVmID0gdGhpcy5ocmVmOwogICAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5wYXJlbnROb2RlOwoKICAgICAgICAgIGlmIChwYXJlbnQgJiYgaHJlZiAmJiAoL2koXC5zdGFjayk/XC5pbWd1clwuY29tLy50ZXN0KGhyZWYpKSkgewogICAgICAgICAgICBpZiAoIXBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbWdbc3JjPSInICsgaHJlZiArICciXScpLmxlbmd0aCkgewogICAgICAgICAgICAgIC8vRE8gTk9UIFVTRSBpbm5lckhUTUwgLS0gaXQgKnJlbW92ZXMqIHRoZSBvbGQgRE9NIGFuZCBpbnNlcnRzIGEgbmV3IG9uZSAoaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzIzNTM5MTUwKSwgbWVhbmluZyBpdCB3b24ndCB3b3JrIGZvciBtdWx0aXBsZSBpbWd1ciBsaW5rcyBpbiB0aGUgc2FtZSBjb21tZW50CiAgICAgICAgICAgICAgLy9odHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzM2MAogICAgICAgICAgICAgICQocGFyZW50KS5hcHBlbmQoJzxhIGhyZWY9IicgKyBocmVmICsgJyI+PGltZyBjbGFzcz0ic294LWF1dG9TaG93Q29tbWVudEltYWdlcy1pbWFnZSIgc3JjPSInICsgaHJlZiArICciIHN0eWxlPSJtYXgtd2lkdGg6MTAwJSI+PC9hPicpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHNldFRpbWVvdXQoc2hvd0ltYWdlcywgMjAwMCk7IC8vc2V0VGltZW91dCBuZWVkZWQgYmVjYXVzZSBGRiByZWZ1c2VzIHRvIGxvYWQgdGhlIGZlYXR1cmUgb24gcGFnZSBsb2FkIGFuZCBkb2VzIGl0IGJlZm9yZSBzbyB0aGUgY29tbWVudCBpc24ndCBkZXRlY3RlZC4KCiAgICAgICQoZG9jdW1lbnQpLm9uKCdzb3gtbmV3LWNvbW1lbnQnLCBzaG93SW1hZ2VzKTsKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctcmV2aWV3LXBvc3QtYXBwZWFyZWQnLCBzaG93SW1hZ2VzKTsKICAgIH0sCgogICAgc2hvd0NvbW1lbnRTY29yZXM6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGFkZGluZyBhIGJ1dHRvbiBvbiB5b3VyIHByb2ZpbGUgY29tbWVudCBoaXN0b3J5IHBhZ2VzIHRvIHNob3cgeW91ciBjb21tZW50J3Mgc2NvcmVzCgogICAgICBjb25zdCBzaXRlbmFtZSA9IHNveC5zaXRlLmN1cnJlbnRBcGlQYXJhbWV0ZXI7CiAgICAgIGNvbnN0IFdISVRFU1BBQ0VTID0gJyZuYnNwOyZuYnNwOyZuYnNwOyc7CiAgICAgIGNvbnN0IENPTU1FTlRfU0NPUkVfRklMVEVSID0gJyEpNUlXLTVRdWZEa1hBQ3hxX01UOGJoWUQ5Yi5tJzsKCiAgICAgIGZ1bmN0aW9uIGFkZExhYmVsc0FuZEhhbmRsZXJzKCkgewogICAgICAgICQoJy5oaXN0b3J5LXRhYmxlIHRkIGIgYVtocmVmKj0iI2NvbW1lbnQiXScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAoISQodGhpcykucGFyZW50KCkuZmluZCgnLnNob3dDb21tZW50U2NvcmUnKS5sZW5ndGgpIHsKICAgICAgICAgICAgY29uc3QgaWQgPSArdGhpcy5ocmVmLm1hdGNoKC9jb21tZW50KFxkKylfLylbMV07CgogICAgICAgICAgICAkKHRoaXMpLmFmdGVyKCc8c3BhbiBjbGFzcz0ic2hvd0NvbW1lbnRTY29yZSIgaWQ9IicgKyBpZCArICciPicgKyBXSElURVNQQUNFUyArICdzaG93IGNvbW1lbnQgc2NvcmU8L3NwYW4+Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgICQoJy5zaG93Q29tbWVudFNjb3JlJykuY3NzKCdjdXJzb3InLCAncG9pbnRlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgc294LmhlbHBlcnMuZ2V0RnJvbUFQSSh7CiAgICAgICAgICAgIGVuZHBvaW50OiAnY29tbWVudHMnLAogICAgICAgICAgICBpZHM6IHRoaXMuaWQsCiAgICAgICAgICAgIHNpdGVuYW1lLAogICAgICAgICAgICBmaWx0ZXI6IENPTU1FTlRfU0NPUkVfRklMVEVSLAogICAgICAgICAgICB1c2VDYWNoZTogZmFsc2UsIC8vIFNpbmdsZSBJRCwgc28gbm8gcG9pbnQKICAgICAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICAgICAgdGhpcy5pbm5lckhUTUwgPSBXSElURVNQQUNFUyArIGl0ZW1zWzBdLnNjb3JlOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGFkZExhYmVsc0FuZEhhbmRsZXJzKCk7CiAgICAgIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluYmFyLWZ1bGwnKTsKICAgICAgaWYgKHRhcmdldCkgc294LmhlbHBlcnMub2JzZXJ2ZSh0YXJnZXQsICcuaGlzdG9yeS10YWJsZScsIGFkZExhYmVsc0FuZEhhbmRsZXJzKTsKICAgIH0sCgogICAgYW5zd2VyVGFnc1NlYXJjaDogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIHRhZ3MgdG8gYW5zd2VycyBpbiBzZWFyY2gKCiAgICAgIGZ1bmN0aW9uIGdldFF1ZXN0aW9uSURGcm9tQW5zd2VyRElWKGFuc3dlckRJVikgewogICAgICAgIHJldHVybiBzb3guaGVscGVycy5nZXRJREZyb21BbmNob3IoYW5zd2VyRElWLnF1ZXJ5U2VsZWN0b3IoJy5yZXN1bHQtbGluayBhJykpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBhZGRDbGFzc1RvSW5zZXJ0ZWRUYWcodGFnTGluaykgewogICAgICAgIGlmICgvc3RhdHVzLS8udGVzdCh0YWdMaW5rLmlubmVyVGV4dCkpIHsKICAgICAgICAgIHRhZ0xpbmsuY2xhc3NMaXN0LmFkZCgnbW9kZXJhdG9yLXRhZycpOwogICAgICAgIH0gZWxzZSBpZiAoL1xiKGRpc2N1c3Npb258ZmVhdHVyZS1yZXF1ZXN0fHN1cHBvcnR8YnVnKVxiLy50ZXN0KHRhZ0xpbmsuaW5uZXJUZXh0KSkgewogICAgICAgICAgdGFnTGluay5jbGFzc0xpc3QuYWRkKCdyZXF1aXJlZC10YWcnKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHRhZ3NGb3JRdWVzdGlvbklEcyA9IHt9OwogICAgICBjb25zdCBRVUVTVElPTl9UQUdTX0ZJTFRFUiA9ICchKThhRFQ4T3B3cS12ZG84JzsKICAgICAgY29uc3QgcXVlc3Rpb25JRHMgPSBbXTsKCiAgICAgIGNvbnN0IGFuc3dlcnMgPSBbLi4uZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncXVlc3Rpb24tc3VtbWFyeScpXS5maWx0ZXIocSA9PiAvYW5zd2VyLWlkLy50ZXN0KHEuaWQpKTsKCiAgICAgIC8vIEdldCBjb3JyZXNwb25kaW5nIHF1ZXN0aW9uJ3MgSUQgZm9yIGVhY2ggYW5zd2VyCiAgICAgIGFuc3dlcnMuZm9yRWFjaChhbnN3ZXIgPT4gewogICAgICAgIGNvbnN0IHF1ZXN0aW9uSUQgPSBnZXRRdWVzdGlvbklERnJvbUFuc3dlckRJVihhbnN3ZXIpOwogICAgICAgIC8vIENhY2hlIHZhbHVlIGZvciBsYXRlciByZWZlcmVuY2UKICAgICAgICBhbnN3ZXIuZGF0YXNldC5xdWVzdGlvbmlkID0gcXVlc3Rpb25JRDsKICAgICAgICBxdWVzdGlvbklEcy5wdXNoKHF1ZXN0aW9uSUQpOwogICAgICB9KTsKCiAgICAgIHNveC5oZWxwZXJzLmdldEZyb21BUEkoewogICAgICAgIGVuZHBvaW50OiAncXVlc3Rpb25zJywKICAgICAgICBpZHM6IHF1ZXN0aW9uSURzLAogICAgICAgIHNpdGVuYW1lOiBzb3guc2l0ZS5jdXJyZW50QXBpUGFyYW1ldGVyLAogICAgICAgIGZpbHRlcjogUVVFU1RJT05fVEFHU19GSUxURVIsCiAgICAgICAgbGltaXQ6IDYwLAogICAgICAgIHNvcnQ6ICdjcmVhdGlvbicsCiAgICAgICAgZmVhdHVyZUlkOiAnYW5zd2VyVGFnc1NlYXJjaCcsCiAgICAgICAgY2FjaGVEdXJhdGlvbjogMTAsIC8vIENhY2hlIGZvciAxMCBtaW51dGVzCiAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICBjb25zdCBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtc0xlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCBpdGVtID0gaXRlbXNbaV07CiAgICAgICAgICB0YWdzRm9yUXVlc3Rpb25JRHNbaXRlbS5xdWVzdGlvbl9pZF0gPSBpdGVtLnRhZ3M7CiAgICAgICAgfQoKICAgICAgICBhbnN3ZXJzLmZvckVhY2goYW5zd2VyID0+IHsKICAgICAgICAgIGNvbnN0IGlkID0gK2Fuc3dlci5kYXRhc2V0LnF1ZXN0aW9uaWQ7CiAgICAgICAgICBjb25zdCB0YWdzRm9yVGhpc1F1ZXN0aW9uID0gdGFnc0ZvclF1ZXN0aW9uSURzW2lkXTsKCiAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHRhZ3NGb3JUaGlzUXVlc3Rpb24ubGVuZ3RoOyB4KyspIHsKICAgICAgICAgICAgY29uc3QgY3VyclRhZyA9IHRhZ3NGb3JUaGlzUXVlc3Rpb25beF07CiAgICAgICAgICAgIGNvbnN0ICRpbnNlcnRlZFRhZyA9ICQoYW5zd2VyLnF1ZXJ5U2VsZWN0b3IoJy5zdW1tYXJ5IC50YWdzJykpLmFwcGVuZCgnPGEgaHJlZj0iL3F1ZXN0aW9ucy90YWdnZWQvJyArIGN1cnJUYWcgKyAnIiBjbGFzcz0icG9zdC10YWciPicgKyBjdXJyVGFnICsgJzwvYT4nKTsKICAgICAgICAgICAgYWRkQ2xhc3NUb0luc2VydGVkVGFnKCRpbnNlcnRlZFRhZyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKCiAgICBzdGlja3lWb3RlQnV0dG9uczogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgbWFraW5nIHRoZSB2b3RlIGJ1dHRvbnMgc3RpY2sgdG8gdGhlIHNjcmVlbiBhcyB5b3Ugc2Nyb2xsIHRocm91Z2ggYSBwb3N0CiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zaHU4L1NFX09wdGlvbmFsRmVhdHVyZXMvcHVsbC8xNDoKICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NodTgvU3RhY2stT3ZlcmZsb3ctT3B0aW9uYWwtRmVhdHVyZXMvaXNzdWVzLzI4OiBUaGFua3MgQFNub3JpbmdGcm9nIGZvciBmaXhpbmcgdGhpcyEKCiAgICAgIC8vIC52b3RlY2VsbCBpcyBuZWNlc3Nhcnk7IGUuZy4sIHRoZSBudW1iZXIgb2Ygdm90ZXMgb2YgcXVlc3Rpb25zIG9uIHRoZSBRdWVzdGlvbnMgbGlzdCBmb3IgYSBzaXRlIHVzZXMgdGhlIC52b3RlIGNsYXNzIHRvbwogICAgICAkKCcudm90ZWNlbGwnKS5hZGRDbGFzcygnc294LXN0aWNreVZvdGVCdXR0b25zJyk7CiAgICAgICQoJy52b3RlY2VsbCA+IC5qcy12b3RpbmctY29udGFpbmVyJykuY3NzKCd0b3AnLAogICAgICAgIHBhcnNlSW50KCQoJy5jb250YWluZXInKS5jc3MoJ21hcmdpbi10b3AnKSwgMTApICsgcGFyc2VJbnQoJCgnYm9keScpLmNzcygncGFkZGluZy10b3AnKSwgMTApLCAvLyBTZWVtcyBsaWtlIG1vc3Qgc2l0ZXMgdXNlIG1hcmdpbi10b3Agb24gdGhlIGNvbnRhaW5lciwgYnV0IE1ldGEgYW5kIFNPIHVzZSBwYWRkaW5nIG9uIHRoZSBib2R5CiAgICAgICk7CiAgICB9LAoKICAgIHRpdGxlRWRpdERpZmY6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIHNob3dpbmcgdGhlIG5ldyB2ZXJzaW9uIG9mIGEgdGl0bGUgaW4gYSBkaWZmIHNlcGFyYXRlbHkgcmF0aGVyIHRoYW4gbG9hZHMgb2YgY3Jvc3Npbmcgb3V0cyBpbiByZWQgYW5kIGFkZGl0aW9ucyBpbiBncmVlbgogICAgICAvLyBFeGFtcGxlIFVSTCB0byB0ZXN0IG9uOiBodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vcmV2aWV3L3N1Z2dlc3RlZC1lZGl0cy82NTQwMwoKICAgICAgZnVuY3Rpb24gZ2V0U3ByaXRlKHN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHNveC5zcHJpdGVzLmdldFN2ZyhgdG9nZ2xlXyR7c3RhdGV9YCwgJ3RvZ2dsZSBTT1ggYmV0dGVyIHRpdGxlIGRpZmYnKS5hZGRDbGFzcygnc294LWJldHRlci10aXRsZS10b2dnbGUnKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYmV0dGVyVGl0bGUoKSB7CiAgICAgICAgc294LmRlYnVnKCd0aXRsZUVkaXREaWZmOiBydW5uaW5nIGJldHRlclRpdGxlJyk7CiAgICAgICAgY29uc3QgJHF1ZXN0aW9uSHlwZXJsaW5rT3JpZ2luYWwgPSAkKCcuc3VtbWFyeSBoMiAucXVlc3Rpb24taHlwZXJsaW5rJyk7CiAgICAgICAgY29uc3QgJHF1ZXN0aW9uSHlwZXJsaW5rID0gJHF1ZXN0aW9uSHlwZXJsaW5rT3JpZ2luYWwuY2xvbmUoKTsKICAgICAgICBjb25zdCAkcXVlc3Rpb25IeXBlcmxpbmtUd28gPSAkcXVlc3Rpb25IeXBlcmxpbmtPcmlnaW5hbC5jbG9uZSgpOwoKICAgICAgICBjb25zdCBsaW5rID0gJHF1ZXN0aW9uSHlwZXJsaW5rT3JpZ2luYWwuYXR0cignaHJlZicpOwogICAgICAgIGNvbnN0IGFkZGVkID0gKCRxdWVzdGlvbkh5cGVybGlua1R3by5maW5kKCcuZGlmZi1kZWxldGUnKS5yZW1vdmUoKS5lbmQoKS50ZXh0KCkpOwogICAgICAgIGNvbnN0IHJlbW92ZWQgPSAoJHF1ZXN0aW9uSHlwZXJsaW5rLmZpbmQoJy5kaWZmLWFkZCcpLnJlbW92ZSgpLmVuZCgpLnRleHQoKSk7CgogICAgICAgIGlmICgkcXVlc3Rpb25IeXBlcmxpbmtPcmlnaW5hbC5maW5kKCcuZGlmZi1kZWxldGUsIC5kaWZmLWFkZCcpLmxlbmd0aCAmJiAhKCQoJy5zb3gtYmV0dGVyLXRpdGxlJykubGVuZ3RoKSkgewogICAgICAgICAgaWYgKCEkKCcuc294LWJldHRlci10aXRsZS10b2dnbGUnKS5sZW5ndGgpIHsKICAgICAgICAgICAgJCgnLnN1bW1hcnkgaDIgLnF1ZXN0aW9uLWh5cGVybGluaycpLmJlZm9yZShnZXRTcHJpdGUoJ29mZicpKTsKICAgICAgICAgIH0KICAgICAgICAgICRxdWVzdGlvbkh5cGVybGlua09yaWdpbmFsLmFkZENsYXNzKCdzb3gtb3JpZ2luYWwtdGl0bGUtZGlmZicpLmhpZGUoKTsKICAgICAgICAgICRxdWVzdGlvbkh5cGVybGlua09yaWdpbmFsLmFmdGVyKCc8YSBocmVmPSInICsgbGluayArICciIGNsYXNzPSJxdWVzdGlvbi1oeXBlcmxpbmsgc294LWJldHRlci10aXRsZSI+PHNwYW4gY2xhc3M9ImRpZmYtZGVsZXRlIj4nICsgcmVtb3ZlZCArICc8L3NwYW4+PHNwYW4gY2xhc3M9ImRpZmYtYWRkIj4nICsgYWRkZWQgKyAnPC9zcGFuPjwvYT4nKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMTY2I2lzc3VlY29tbWVudC0yNjk5MjUwNTkKICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5zb3gtYmV0dGVyLXRpdGxlLXRvZ2dsZScsIGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0ICRzb3hPcmlnaW5hbFRpdGxlRGlmZiA9ICQoJy5zb3gtb3JpZ2luYWwtdGl0bGUtZGlmZicpOwogICAgICAgIGlmICgkc294T3JpZ2luYWxUaXRsZURpZmYuaXMoJzp2aXNpYmxlJykpIHsKICAgICAgICAgICQodGhpcykucmVwbGFjZVdpdGgoZ2V0U3ByaXRlKCdvbicpKTsKICAgICAgICAgICRzb3hPcmlnaW5hbFRpdGxlRGlmZi5oaWRlKCk7CiAgICAgICAgICAkKCcuc294LWJldHRlci10aXRsZScpLnNob3coKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgJCh0aGlzKS5yZXBsYWNlV2l0aChnZXRTcHJpdGUoJ29mZicpKTsKICAgICAgICAgICRzb3hPcmlnaW5hbFRpdGxlRGlmZi5zaG93KCk7CiAgICAgICAgICAkKCcuc294LWJldHRlci10aXRsZScpLmhpZGUoKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgYmV0dGVyVGl0bGUoKTsKICAgICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlldy1jb250ZW50Jyk7CiAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUodGFyZ2V0LCAnLnJldmlldy1zdGF0dXMsIC5yZXZpZXctY29udGVudCwgLnN1Z2dlc3RlZC1lZGl0LCAucG9zdC1pZCcsIGJldHRlclRpdGxlKTsKICAgIH0sCgogICAgbWV0YUNoYXRCbG9nU3RhY2tFeGNoYW5nZUJ1dHRvbjogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIGJ1dHRvbnMgbmV4dCB0byBzaXRlcyB1bmRlciB0aGUgU3RhY2tFeGNoYW5nZSBidXR0b24gdGhhdCBsZWFkIHRvIHRoYXQgc2l0ZSdzIG1ldGEgYW5kIGNoYXQKCiAgICAgICQoZG9jdW1lbnQpLm9uKCdtb3VzZWVudGVyJywgJyN5b3VyLWNvbW11bml0aWVzLXNlY3Rpb24gPiB1bCA+IGxpID4gYScsIGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0IGhyZWYgPSB0aGlzLmhyZWYucmVwbGFjZSgvaHR0cHM/OlwvXC8vLCAnJyk7CiAgICAgICAgbGV0IGxpbms7CiAgICAgICAgbGV0IGNoYXRMaW5rID0gJ2h0dHBzOi8vY2hhdC5zdGFja2V4Y2hhbmdlLmNvbT90YWI9c2l0ZSZob3N0PScgKyBocmVmLnJlcGxhY2UoL1wvLiovLCAnJyk7CgogICAgICAgIGlmIChocmVmID09PSAnbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS8nKSB7IC8vTWV0YSBTRSdzIGNoYXQgbGluayBpcyBhIGJpdCBkaWZmZXJlbnQKICAgICAgICAgIGNoYXRMaW5rID0gJ2h0dHBzOi8vY2hhdC5tZXRhLnN0YWNrZXhjaGFuZ2UuY29tJzsKICAgICAgICB9IGVsc2UgaWYgKGhyZWYuaW5kZXhPZignbWV0YScpID4gLTEpIHsgLy9Gb3IgdGhlIHVzdWFsIG1ldGEgc2l0ZXMKICAgICAgICAgIGxpbmsgPSAnaHR0cHM6Ly8nICsgaHJlZi5zcGxpdCgnbWV0YS4nKS5zaGlmdCgpICsgaHJlZi5zcGxpdCgnbWV0YS4nKS5wb3AoKTsKICAgICAgICAgIGNoYXRMaW5rID0gJ2h0dHBzOi8vY2hhdC5zdGFja2V4Y2hhbmdlLmNvbT90YWI9c2l0ZSZob3N0PScgKyBocmVmLnNwbGl0KCdtZXRhLicpLnNoaWZ0KCkgKyBocmVmLnNwbGl0KCdtZXRhLicpLnBvcCgpLnNwbGl0KCcvJykuc2hpZnQoKTsgLy9XZSBkb24ndCBuZWVkICJtZXRhLiIgaW4gdGhlIGNoYXQgbGlua3MKICAgICAgICB9IGVsc2UgaWYgKGhyZWYuaW5kZXhPZignLnN0YWNrZXhjaGFuZ2UuY29tJykgPiAtMSB8fCBocmVmLmluZGV4T2YoJy5zdGFja292ZXJmbG93LmNvbScpID4gLTEpIHsgLy9Gb3IgdGhlIG1ham9yaXR5IG9mIFNFIHNpdGVzLCBhbmQgb3RoZXIgbGFuZ3VhZ2VzIG9mIFNPCiAgICAgICAgICBsaW5rID0gJ2h0dHBzOi8vJyArIGhyZWYuc3BsaXQoJy4nKS5zaGlmdCgpICsgJy5tZXRhJyArIGhyZWYuc3BsaXQoaHJlZi5zcGxpdCgnLicpLnNoaWZ0KCkpLnBvcCgpOwogICAgICAgIH0gZWxzZSBpZiAoaHJlZi5pbmRleE9mKCdzdGFja2FwcHMnKSA9PSAtMSkgeyAvL0ZvciBzaXRlcyB0aGF0IGhhdmUgdW5pcXVlIFVSTHMsIGUuZy4gc2VydmVyZmF1bHQuY29tIChleGNlcHQgU3RhY2tBcHBzLCB3aGljaCBoYXMgbm8gbWV0YSkKICAgICAgICAgIGxpbmsgPSAnaHR0cHM6Ly9tZXRhLicgKyBocmVmOwogICAgICAgIH0KCiAgICAgICAgaWYgKGhyZWYuaW5kZXhPZignc3RhY2tvdmVyZmxvdy5jb20nKSA+IC0xICYmICFocmVmLm1hdGNoKC8ocHR8cnV8ZXN8amF8Lm1ldGEpL2kpKSB7IC8vRW5nbGlzaCBTdGFjayBPdmVyZmxvdyBoYXMgYSB1bmlxdWUgY2hhdCBsaW5rCiAgICAgICAgICBjaGF0TGluayA9ICdodHRwczovL2NoYXQuc3RhY2tvdmVyZmxvdy5jb20nOwogICAgICAgIH0KCiAgICAgICAgLy9BbGwgc2l0ZXMgaGF2ZSBlaXRoZXIgYSBjaGF0IGxpbmsgb3IgbWV0YSBsaW5rCiAgICAgICAgJCh0aGlzKS5maW5kKCcucmVwLXNjb3JlJykuc3RvcCh0cnVlKS5kZWxheSgxMzUpLmZhZGVPdXQoMjApOwogICAgICAgICQodGhpcykuYXBwZW5kKCc8ZGl2IGNsYXNzPSJyZWxhdGVkLWxpbmtzIiBzdHlsZT0iZmxvYXQ6IHJpZ2h0OyBkaXNwbGF5OiBub25lOyI+JyArCiAgICAgICAgICAgICAgICAgICAgKGxpbmsgPwogICAgICAgICAgICAgICAgICAgICAgKGhyZWYuaW5kZXhPZignbWV0YScpID4gLTEgPyAnPGEgaHJlZj0iJyArIGxpbmsgKyAnIj5tYWluPC9hPicgOiAnPGEgaHJlZj0iJyArIGxpbmsgKyAnIj5tZXRhPC9hPicpIDoKICAgICAgICAgICAgICAgICAgICAgICcnKSArCiAgICAgICAgICAgICAgICAgICAgKGNoYXRMaW5rID8gJzxhIGhyZWY9IicgKyBjaGF0TGluayArICciPmNoYXQ8L2E+JyA6ICcnKSArCiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicpOwogICAgICAgICQodGhpcykuZmluZCgnLnJlbGF0ZWQtbGlua3MnKS5kZWxheSgxMzUpLmNzcygnb3BhY2l0eScsIDApLmFuaW1hdGUoewogICAgICAgICAgb3BhY2l0eTogMSwKICAgICAgICAgIHdpZHRoOiAndG9nZ2xlJywKICAgICAgICB9LCAyMDApOwoKICAgICAgfSkub24oJ21vdXNlbGVhdmUnLCAnI3lvdXItY29tbXVuaXRpZXMtc2VjdGlvbiA+IHVsID4gbGkgPiBhJywgZnVuY3Rpb24oKSB7CiAgICAgICAgJCh0aGlzKS5maW5kKCcucmVwLXNjb3JlJykuc3RvcCh0cnVlKS5mYWRlSW4oMTEwKTsKICAgICAgICAkKHRoaXMpLmZpbmQoJy5yZWxhdGVkLWxpbmtzJykucmVtb3ZlKCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBtZXRhTmV3UXVlc3Rpb25BbGVydDogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBGb3IgYWRkaW5nIGEgZmFrZSBtb2QgZGlhbW9uZCB0aGF0IG5vdGlmaWVzIHlvdSBpZiB0aGVyZSBoYXMgYmVlbiBhIG5ldyBwb3N0IHBvc3RlZCBvbiB0aGUgY3VycmVudCBzaXRlJ3MgbWV0YQoKICAgICAgLy9EbyBub3QgcnVuIG9uIG1ldGEsIGNoYXQsIG9yIHNpdGVzIHdpdGhvdXQgYSBtZXRhCiAgICAgIGlmICgoc294LnNpdGUudHlwZSAhPSAnbWFpbicgJiYgc294LnNpdGUudHlwZSAhPSAnYmV0YScpIHx8ICEkKCcucmVsYXRlZC1zaXRlJykubGVuZ3RoKSByZXR1cm47CgogICAgICBjb25zdCBORVdRVUVTVElPTlMgPSAnbWV0YU5ld1F1ZXN0aW9uQWxlcnQtbGFzdFF1ZXN0aW9ucyc7CiAgICAgIGNvbnN0IGZhdmljb24gPSBzb3guc2l0ZS5pY29uOwogICAgICBjb25zdCBzaXRlbmFtZSA9IHNveC5zaXRlLmN1cnJlbnRBcGlQYXJhbWV0ZXI7CgogICAgICAvLyBJZiBpdCBpcyBhIHNwZWNpYWwgc2l0ZSwgYWRkICdtZXRhJyBiZWZvcmUgaXQsIGlmIG5vdCwgcmVwbGFjZSB0aGUgJ3N0YWNrZXhjaGFuZ2UnIGZyb20gdGhlIFVSTCB3aXRoICdtZXRhJy4KICAgICAgaWYgKHNpdGVuYW1lLm1hdGNoKC9zdGFja292ZXJmbG93fHN1cGVydXNlcnxzZXJ2ZXJmYXVsdHxhc2t1YnVudHV8c3RhY2thcHBzfG1hdGhvdmVyZmxvdy8pKSB7CiAgICAgICAgdmFyIG1ldGFOYW1lID0gJ21ldGEuJyArIHNpdGVuYW1lOwogICAgICB9IGVsc2UgewogICAgICAgIG1ldGFOYW1lID0gc2l0ZW5hbWUucmVwbGFjZSgnc3RhY2tleGNoYW5nZScsJ21ldGEnKTsKICAgICAgfQoKICAgICAgY29uc3QgRklMVEVSX1FVRVNUSU9OX1RJVExFX0xJTksgPSAnIUJITUliemUwRVEqdmVkOEx5b082ck5rMjVxR0VTeSc7CiAgICAgIGNvbnN0ICRkaWFsb2cgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgaWQ6ICdtZXRhTmV3UXVlc3Rpb25BbGVydERpYWxvZycsCiAgICAgICAgJ2NsYXNzJzogJ3RvcGJhci1kaWFsb2cgZG5vIG5ldy10b3BiYXInLAogICAgICB9KTsKICAgICAgY29uc3QgJGhlYWRlciA9ICQoJzxkaXYvPicsIHsKICAgICAgICAnY2xhc3MnOiAnaGVhZGVyJywKICAgICAgfSkuYXBwZW5kKCQoJzxoMy8+JykuYXBwZW5kKCQoJzxhLz4nLCB7CiAgICAgICAgdGV4dDogJ25ldyBtZXRhIHBvc3RzJywKICAgICAgICBocmVmOiBgLy9tZXRhLiR7c294LnNpdGUudXJsfWAsCiAgICAgICAgc3R5bGU6ICdjb2xvcjogIzAwNzdjYycsCiAgICAgIH0pKSk7CiAgICAgIGNvbnN0ICRjb250ZW50ID0gJCgnPGRpdi8+JywgewogICAgICAgICdjbGFzcyc6ICdtb2RhbC1jb250ZW50JywKICAgICAgfSk7CiAgICAgIGNvbnN0ICRxdWVzdGlvbnMgPSAkKCc8dWwvPicsIHsKICAgICAgICBpZDogJ21ldGFOZXdRdWVzdGlvbkFsZXJ0RGlhbG9nTGlzdCcsCiAgICAgICAgJ2NsYXNzJzogJ2pzLWl0ZW1zIGl0ZW1zJywKICAgICAgfSk7CiAgICAgIGNvbnN0ICRkaWFtb25kID0gJCgnPGEvPicsIHsKICAgICAgICBpZDogJ21ldGFOZXdRdWVzdGlvbkFsZXJ0QnV0dG9uJywKICAgICAgICBocmVmOiAnIycsCiAgICAgICAgJ2NsYXNzJzogJy1saW5rJywKICAgICAgICB0aXRsZTogJ01vZGVyYXRvciBpbmJveCAocmVjZW50IG1ldGEgcXVlc3Rpb25zKScsCiAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICRkaWFtb25kLnRvZ2dsZUNsYXNzKCd0b3BiYXItaWNvbi1vbicpOwogICAgICAgICAgJGRpYWxvZy50b2dnbGUoKTsKICAgICAgICB9LAogICAgICB9KS5hcHBlbmQoJCgnPHN2Zy8+JywgeyAvL1VwZGF0ZWQgd2l0aCB0aGUgbmV3IG1vZCBkaWFtb25kIGljb24KICAgICAgICAnYXJpYS1oaWRkZW4nOiB0cnVlLAogICAgICAgIGNsYXNzOiAnc3ZnLWljb24nLAogICAgICAgIHZpZXdCb3g6ICcwIDAgMTggMTgnLAogICAgICAgIHdpZHRoOiAxOCwKICAgICAgICBoZWlnaHQ6IDE4LAogICAgICB9KS5hcHBlbmQoJCgnPHBhdGgvPicsIHsKICAgICAgICBkOiAnTTguNC43OGMuMzMtLjQzLjg3LS40MyAxLjMgMGw1LjggNy40NGMuMzMuNDMuMzMgMS4xMyAwIDEuNTZsLTUuOCA3LjQ0Yy0uMzMuNDMtLjg3LjQzLTEuMiAwTDIuNiA5Ljc4YTEuMzQgMS4zNCAwIDAgMSAwLTAuMTU2TDguNC43OHonLAogICAgICB9KSkpOwogICAgICBsZXQgbGFzdFF1ZXN0aW9ucyA9IHt9OwoKICAgICAgJGRpYW1vbmQuaHRtbCgkZGlhbW9uZC5odG1sKCkpOyAvL1JlbG9hZHMgdGhlIGRpYW1vbmQgaWNvbiwgd2hpY2ggaXMgbmVjZXNzYXJ5IHdoZW4gYWRkaW5nIGFuIFNWRyB1c2luZyBqUXVlcnkuCgogICAgICAkZGlhbG9nLmFwcGVuZCgkaGVhZGVyKS5hcHBlbmQoJGNvbnRlbnQuYXBwZW5kKCRxdWVzdGlvbnMpKTsKICAgICAgJCgnLi1zZWNvbmRhcnkgPiAuLWl0ZW06bm90KDpoYXMoLm15LXByb2ZpbGUpKTplcSgxKScpLmJlZm9yZSgkKCc8bGkvPicpLmFkZENsYXNzKCctaXRlbScpLmFwcGVuZCgkZGlhbW9uZCkpOwoKICAgICAgJGRpYWxvZy5jc3MoewogICAgICAgICd0b3AnOiAkKCcudG9wLWJhcicpLmhlaWdodCgpLAogICAgICAgICdyaWdodCc6ICQoJy4tY29udGFpbmVyJykub3V0ZXJXaWR0aCgpIC0gJGRpYW1vbmQucGFyZW50KCkucG9zaXRpb24oKS5sZWZ0IC0gJGRpYW1vbmQub3V0ZXJXaWR0aCgpLAogICAgICB9KTsKCiAgICAgIGlmICgkKCcjbWV0YU5ld1F1ZXN0aW9uQWxlcnRCdXR0b24nKS5sZW5ndGgpICQoJy5qcy10b3BiYXItZGlhbG9nLWNvcnJhbCcpLmFwcGVuZCgkZGlhbG9nKTsKCiAgICAgICQoZG9jdW1lbnQpLm1vdXNldXAoZSA9PiB7CiAgICAgICAgaWYgKCEkZGlhbG9nLmlzKGUudGFyZ2V0KSAmJgogICAgICAgICAgICAgICAgICAgICRkaWFsb2cuaGFzKGUudGFyZ2V0KS5sZW5ndGggPT09IDAgJiYKICAgICAgICAgICAgICAgICAgICAhJChlLnRhcmdldCkuaXMoJyNtZXRhTmV3UXVlc3Rpb25BbGVydEJ1dHRvbiwgc3ZnLCBwYXRoJykpIHsKICAgICAgICAgICRkaWFsb2cuaGlkZSgpOwogICAgICAgICAgJGRpYW1vbmQucmVtb3ZlQ2xhc3MoJ3RvcGJhci1pY29uLW9uJyk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmIChHTV9nZXRWYWx1ZShORVdRVUVTVElPTlMsIC0xKSA9PSAtMSkgewogICAgICAgIEdNX3NldFZhbHVlKE5FV1FVRVNUSU9OUywgSlNPTi5zdHJpbmdpZnkobGFzdFF1ZXN0aW9ucykpOwogICAgICB9IGVsc2UgewogICAgICAgIGxhc3RRdWVzdGlvbnMgPSBKU09OLnBhcnNlKEdNX2dldFZhbHVlKE5FV1FVRVNUSU9OUykpOwogICAgICB9CgogICAgICBzb3guaGVscGVycy5nZXRGcm9tQVBJKHsKICAgICAgICBlbmRwb2ludDogJ3F1ZXN0aW9ucycsCiAgICAgICAgc2l0ZW5hbWU6IG1ldGFOYW1lLAogICAgICAgIGZpbHRlcjogRklMVEVSX1FVRVNUSU9OX1RJVExFX0xJTkssCiAgICAgICAgc29ydDogJ2FjdGl2aXR5JywKICAgICAgICBsaW1pdDogNSwKICAgICAgICBmZWF0dXJlSWQ6ICdtZXRhTmV3UXVlc3Rpb25BbGVydCcsCiAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICBjb25zdCBsYXRlc3RRdWVzdGlvbiA9IGl0ZW1zWzBdLnRpdGxlOwoKICAgICAgICAvLyBNYWtlIGRpYW1vbmQgYmx1ZSBpZiB0aGVyZSdzIGEgbmV3IHF1ZXN0aW9uCiAgICAgICAgaWYgKGxhdGVzdFF1ZXN0aW9uICE9IGxhc3RRdWVzdGlvbnNbbWV0YU5hbWVdKSB7CiAgICAgICAgICAkZGlhbW9uZC5jc3MoJ2NvbG9yJywgJyMwMDc3Y2MnKTsKICAgICAgICB9CgogICAgICAgIGxldCBzZWVuID0gZmFsc2U7CiAgICAgICAgLy8gUmVnYXJkbGVzcyBvZiBpZiB0aGVyZSdzIGEgbmV3IHF1ZXN0aW9uLCBzaG93IHRoZSBsYXRlc3QgNQogICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBpdGVtcy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgY29uc3QgdGl0bGUgPSBpdGVtc1tpXS50aXRsZTsKICAgICAgICAgIGNvbnN0IGxpbmsgPSBpdGVtc1tpXS5saW5rOwogICAgICAgICAgLy8gSWYgb25lJ3MgYmVlbiBzZWVuLCB0aGUgb2xkZXIgcXVlc3Rpb25zIG11c3QgYWxzbyBoYXZlIGJlZW4gc2VlbgogICAgICAgICAgaWYgKHRpdGxlID09PSBsYXN0UXVlc3Rpb25zW21ldGFOYW1lXSkgc2VlbiA9IHRydWU7CiAgICAgICAgICBhZGRRdWVzdGlvbih0aXRsZSwgbGluaywgc2Vlbik7CiAgICAgICAgfQoKICAgICAgICBsYXN0UXVlc3Rpb25zW21ldGFOYW1lXSA9IGxhdGVzdFF1ZXN0aW9uOwoKICAgICAgICAkZGlhbW9uZC5jbGljaygoKSA9PiB7CiAgICAgICAgICBHTV9zZXRWYWx1ZShORVdRVUVTVElPTlMsIEpTT04uc3RyaW5naWZ5KGxhc3RRdWVzdGlvbnMpKTsKICAgICAgICB9KTsKICAgICAgfSk7CgogICAgICBmdW5jdGlvbiBhZGRRdWVzdGlvbih0aXRsZSwgbGluaywgc2VlbikgewogICAgICAgIGNvbnN0ICRsaSA9ICQoJzxsaS8+Jyk7CiAgICAgICAgY29uc3QgJGxpbmsgPSAkKCc8YS8+JywgewogICAgICAgICAgaHJlZjogbGluaywKICAgICAgICAgIHN0eWxlOiAnZGlzcGxheTogZmxleCcsCiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgJGljb24gPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgICAnY2xhc3MnOiAnc2l0ZS1pY29uIGZhdmljb24gJyArIGZhdmljb24sCiAgICAgICAgICBzdHlsZTogJ21hcmdpbi1yaWdodDogM3B4JywKICAgICAgICB9KTsKICAgICAgICBjb25zdCAkbWVzc2FnZSA9ICQoJzxkaXYvPicsIHsKICAgICAgICAgICdjbGFzcyc6ICdtZXNzYWdlLXRleHQnLAogICAgICAgIH0pLmFwcGVuZCgkKCc8aDQvPicsIHsKICAgICAgICAgIGh0bWw6IHRpdGxlLAogICAgICAgICAgc3R5bGU6IGBmb250LXdlaWdodDogJHtzZWVuID8gJ25vcm1hbCcgOiAnYm9sZCd9YCwKICAgICAgICB9KSk7CgogICAgICAgICRsaW5rLmFwcGVuZCgkaWNvbikuYXBwZW5kKCRtZXNzYWdlKS5hcHBlbmRUbygkbGkpOwogICAgICAgICRxdWVzdGlvbnMuYXBwZW5kKCRsaSk7CiAgICAgIH0KICAgIH0sCgogICAgYmV0dGVyQ1NTOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBhZGRpbmcgdGhlIGJldHRlciBDU1MgZm9yIHRoZSB2b3RpbmcgYnV0dG9ucyBhbmQgZmF2b3VyaXRlIGJ1dHRvbgoKICAgICAgZnVuY3Rpb24gYWRkQ1NTKCkgewogICAgICAgICQoJy5qcy12b3RlLXVwLWJ0biwgLmpzLXZvdGUtZG93bi1idG4sIC5qcy1mYXZvcml0ZS1idG4nKS5hZGRDbGFzcygnc294LWJldHRlci1jc3MnKTsKICAgICAgICAkKCdoZWFkJykuYXBwZW5kKCc8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9naC9zaHU4L1NFLUFuc3dlcnNfc2NyaXB0c0BtYXN0ZXIvY29vbE1hdGVyaWFsRGVzaWduQ3NzLmNzcyIgdHlwZT0idGV4dC9jc3MiIC8+Jyk7CiAgICAgICAgJCgnI2htZW51cycpLmNzcygnLXdlYmtpdC10cmFuc2Zvcm0nLCAndHJhbnNsYXRlWigwKScpOwogICAgICB9CiAgICAgIGFkZENTUygpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZENTUyk7CiAgICB9LAoKICAgIHN0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQ6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGFkZGluZyBjb29sZXIgc2lnbnMgdGhhdCBhIHF1ZXN0aW9ucyBoYXMgYmVlbiBjbG9zZWQvbWlncmF0ZWQvcHV0IG9uIGhvZC9pcyBhIGR1cGUKCiAgICAgIC8vIEZvciB1c2UgaW4gZGF0YXNldCwgdXNlZCBmb3IgaGlkZUNlcnRhaW5RdWVzdGlvbnMgZmVhdHVyZSBjb21wYXRhYmlsaXR5CiAgICAgIGNvbnN0IFFVRVNUSU9OX1NUQVRFX0tFWSA9ICdzb3hRdWVzdGlvblN0YXRlJzsKICAgICAgY29uc3QgRklMVEVSX1FVRVNUSU9OX0NMT1NVUkVfTk9USUNFID0gJyEpRWkpM0sqaXJEdkZBKWw5MkxsZDN6RDlNdTlLTVE1OS1iZ3BWdzdEOW5ndjV6RXQzJzsKICAgICAgY29uc3QgTk9USUNFX1JFR0VYID0gL1xbKGR1cGxpY2F0ZXxjbG9zZWR8bWlncmF0ZWR8b24gaG9sZClcXSQvOwoKICAgICAgZnVuY3Rpb24gYWRkTGFiZWxzKCkgewogICAgICAgIGNvbnN0IHF1ZXN0aW9ucyA9IFtdOwogICAgICAgIGNvbnN0IHF1ZXN0aW9uU3VtbWFyaWVzID0gWy4uLmRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3F1ZXN0aW9uLXN1bW1hcnknKV07CiAgICAgICAgcXVlc3Rpb25TdW1tYXJpZXMuZm9yRWFjaChxdWVzdGlvbiA9PiB7CiAgICAgICAgICAvLyBEb24ndCBydW4gaWYgdGFnIGhhcyBhbHJlYWR5IGJlZW4gYWRkZWQgdG8gcXVlc3Rpb24KICAgICAgICAgIGlmIChxdWVzdGlvbi5kYXRhc2V0W1FVRVNUSU9OX1NUQVRFX0tFWV0pIHJldHVybjsKCiAgICAgICAgICBjb25zdCBhbmNob3IgPSBxdWVzdGlvbi5xdWVyeVNlbGVjdG9yKCcuc3VtbWFyeSBoMyBhJyk7CiAgICAgICAgICBjb25zdCBpZCA9IHNveC5oZWxwZXJzLmdldElERnJvbUFuY2hvcihhbmNob3IpOwogICAgICAgICAgY29uc3QgdGV4dCA9IGFuY2hvci5pbm5lclRleHQudHJpbSgpOwoKICAgICAgICAgIGNvbnN0IG5vdGljZU1hdGNoID0gdGV4dC5tYXRjaChOT1RJQ0VfUkVHRVgpOwogICAgICAgICAgY29uc3Qgbm90aWNlTmFtZSA9IG5vdGljZU1hdGNoICYmIG5vdGljZU1hdGNoWzFdOwoKICAgICAgICAgIC8vIERvbid0IHJ1biBpZiB0aGUgcXVlc3Rpb24gaXMgc3RpbGwgb3BlbgogICAgICAgICAgaWYgKCFub3RpY2VOYW1lKSByZXR1cm47CiAgICAgICAgICBxdWVzdGlvbnMucHVzaCh7IGVsZW1lbnQ6IHF1ZXN0aW9uLCBub3RpY2VOYW1lLCB0ZXh0LCBhbmNob3IsIGlkIH0pOwogICAgICAgIH0pOwogICAgICAgIHNveC5kZWJ1Zygnc3RhbmRPdXREdXBlQ2xvc2VNaWdyYXRlZCBxdWVzdGlvbnMgdG8gcmVxdWVzdCBBUEkgZm9yJywgcXVlc3Rpb25zKTsKCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8xODEKICAgICAgICAkKCcucXVlc3Rpb24tc3VtbWFyeSAuYW5zd2VyLWh5cGVybGluaywgLnF1ZXN0aW9uLXN1bW1hcnkgLnF1ZXN0aW9uLWh5cGVybGluaywgLnF1ZXN0aW9uLXN1bW1hcnkgLnJlc3VsdC1saW5rIGEnKS5jc3MoJ2Rpc3BsYXknLCAnaW5saW5lJyk7CiAgICAgICAgJCgnLnN1bW1hcnkgaDMnKS5jc3MoJ2xpbmUtaGVpZ2h0JywgJzEuMmVtJyk7IC8vIEZpeGVzIGxpbmUgaGVpZ2h0IG9uICJRdWVzdGlvbnMiIHBhZ2UKCiAgICAgICAgc294LmhlbHBlcnMuZ2V0RnJvbUFQSSh7CiAgICAgICAgICBlbmRwb2ludDogJ3F1ZXN0aW9ucycsCiAgICAgICAgICBpZHM6IHF1ZXN0aW9ucy5tYXAocSA9PiBxLmlkKSwKICAgICAgICAgIHNpdGVuYW1lOiBzb3guc2l0ZS5jdXJyZW50QXBpUGFyYW1ldGVyLAogICAgICAgICAgZmlsdGVyOiBGSUxURVJfUVVFU1RJT05fQ0xPU1VSRV9OT1RJQ0UsCiAgICAgICAgICBmZWF0dXJlSWQ6ICdzdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkJywKICAgICAgICAgIGNhY2hlRHVyYXRpb246IDEwLCAvLyBDYWNoZSBmb3IgMTAgbWludXRlcwogICAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICAgIHF1ZXN0aW9ucy5mb3JFYWNoKHF1ZXN0aW9uID0+IHsKICAgICAgICAgICAgc294LmRlYnVnKCdzdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkIGFkZGluZyBkZXRhaWxzIGZvciBxdWVzdGlvbicsIHF1ZXN0aW9uKTsKICAgICAgICAgICAgcXVlc3Rpb24uYW5jaG9yLmlubmVyVGV4dCA9IHF1ZXN0aW9uLnRleHQucmVwbGFjZShOT1RJQ0VfUkVHRVgsICcnKTsKICAgICAgICAgICAgcXVlc3Rpb24uZWxlbWVudC5kYXRhc2V0W1FVRVNUSU9OX1NUQVRFX0tFWV0gPSBxdWVzdGlvbi5ub3RpY2VOYW1lOwoKICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25EZXRhaWxzID0gaXRlbXMuZmluZChkID0+IGQucXVlc3Rpb25faWQgPT09IHF1ZXN0aW9uLmlkKTsKICAgICAgICAgICAgaWYgKCFxdWVzdGlvbkRldGFpbHMpIHJldHVybjsKCiAgICAgICAgICAgIHN3aXRjaCAocXVlc3Rpb24ubm90aWNlTmFtZSkgewogICAgICAgICAgICBjYXNlICdkdXBsaWNhdGUnOiB7CiAgICAgICAgICAgICAgY29uc3QgcXVlc3Rpb25JZCA9IHF1ZXN0aW9uRGV0YWlscy5jbG9zZWRfZGV0YWlscy5vcmlnaW5hbF9xdWVzdGlvbnNbMF0ucXVlc3Rpb25faWQ7CgogICAgICAgICAgICAgIC8vIFN0eWxpbmcgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMTgxCiAgICAgICAgICAgICAgLy8gTk9URTogdGhlIGBkYXRhLXNlYXJjaHNlc3Npb25gIGF0dHJpYnV0ZSBpcyB0byB3b3JrYXJvdW5kIGEgd2VpcmQgbGluZSBvZiBjb2RlIGluIFNFICpzZWFyY2gqIHBhZ2VzLAogICAgICAgICAgICAgIC8vIHdoaWNoIGNoYW5nZXMgdGhlIGBocmVmYCBvZiBhbmNob3JzIGluIGluIGAucmVzdWx0LWxpbmtgIGNvbnRhaW5lcnMgdG8gYGRhdGEtc2VhcmNoc2Vzc2lvbmAKICAgICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L3B1bGwvMzQ4I2lzc3VlY29tbWVudC00MDQyNDUwNTYKICAgICAgICAgICAgICAkKHF1ZXN0aW9uLmFuY2hvcikuYWZ0ZXIoJyZuYnNwOzxhIGRhdGEtc2VhcmNoc2Vzc2lvbj1cJy9xdWVzdGlvbnMvJyArIHF1ZXN0aW9uSWQgKyAnXCcgc3R5bGU9XCdkaXNwbGF5OiBpbmxpbmVcJyBocmVmPVwnaHR0cHM6Ly8nICsgc294LnNpdGUudXJsICsgJy9xLycgKyBxdWVzdGlvbklkICsgJ1wnPjxzcGFuIGNsYXNzPVwnc3RhbmRPdXREdXBlQ2xvc2VNaWdyYXRlZC1kdXBsaWNhdGVcJyB0aXRsZT1cJ2NsaWNrIHRvIHZpc2l0IGR1cGxpY2F0ZVwnPiZuYnNwO2R1cGxpY2F0ZSZuYnNwOzwvc3Bhbj48L2E+Jyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAnY2xvc2VkJzoKICAgICAgICAgICAgY2FzZSAnb24gaG9sZCc6IHsKICAgICAgICAgICAgICBjb25zdCBkZXRhaWxzID0gcXVlc3Rpb25EZXRhaWxzLmNsb3NlZF9kZXRhaWxzOwogICAgICAgICAgICAgIGNvbnN0IHVzZXJzID0gZGV0YWlscy5ieV91c2Vycy5yZWR1Y2UoKHN0ciwgdXNlcikgPT4gc3RyICsgJywgJyArIHVzZXIuZGlzcGxheV9uYW1lLCAnJykuc3Vic3RyKDIpOwogICAgICAgICAgICAgIGNvbnN0IGNsb3N1cmVEYXRlID0gbmV3IERhdGUocXVlc3Rpb25EZXRhaWxzLmNsb3NlZF9kYXRlICogMTAwMCk7CiAgICAgICAgICAgICAgY29uc3QgdGltZXN0YW1wID0gY2xvc3VyZURhdGUudG9Mb2NhbGVTdHJpbmcoKTsKICAgICAgICAgICAgICBjb25zdCBjbG9zZU5vdGljZSA9IChkZXRhaWxzLm9uX2hvbGQgPyAncHV0IG9uIGhvbGQnIDogJ2Nsb3NlZCcpICsgJyBhcyAnOwogICAgICAgICAgICAgIGNvbnN0IGNsb3NlVGV4dCA9IGRldGFpbHMub25faG9sZCA/ICdvbiBob2xkJyA6ICdjbG9zZWQnOwogICAgICAgICAgICAgIGNvbnN0IGNzc0NsYXNzID0gZGV0YWlscy5vbl9ob2xkID8gJ29uaG9sZCcgOiAnY2xvc2VkJzsKCiAgICAgICAgICAgICAgJChxdWVzdGlvbi5hbmNob3IpLmFmdGVyKCcmbmJzcDs8c3BhbiBjbGFzcz0ic3RhbmRPdXREdXBlQ2xvc2VNaWdyYXRlZC0nICsgY3NzQ2xhc3MgKyAnIiB0aXRsZT0iJyArIGNsb3NlTm90aWNlICsgZGV0YWlscy5yZWFzb24gKyAnIGJ5ICcgKyB1c2VycyArICcgb24gJyArIHRpbWVzdGFtcCArICciPiZuYnNwOycgKyBjbG9zZVRleHQgKyAnJm5ic3A7PC9zcGFuPicpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgJ21pZ3JhdGVkJzogewogICAgICAgICAgICAgIGxldCB0ZXh0VG9BZGQ7CiAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uRGV0YWlscy5taWdyYXRlZF90bykgewogICAgICAgICAgICAgICAgY29uc3QgbWlncmF0ZWRUb1NpdGUgPSBxdWVzdGlvbkRldGFpbHMubWlncmF0ZWRfdG8ub3RoZXJfc2l0ZS5uYW1lOwogICAgICAgICAgICAgICAgdGV4dFRvQWRkID0gJ21pZ3JhdGVkIHRvICcgKyBtaWdyYXRlZFRvU2l0ZTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHF1ZXN0aW9uRGV0YWlscy5taWdyYXRlZF9mcm9tKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtaWdyYXRlZEZyb21TaXRlID0gcXVlc3Rpb25EZXRhaWxzLm1pZ3JhdGVkX2Zyb20ub3RoZXJfc2l0ZS5uYW1lOwogICAgICAgICAgICAgICAgdGV4dFRvQWRkID0gJ21pZ3JhdGVkIGZyb20gJyArIG1pZ3JhdGVkRnJvbVNpdGU7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNveC53YXJuKCdzdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkOiB1bmtub3duIG1pZ3JhdGlvbiBzdGF0ZScpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgJChxdWVzdGlvbi5hbmNob3IpLmFmdGVyKCcmbmJzcDs8c3BhbiBjbGFzcz1cJ3N0YW5kT3V0RHVwZUNsb3NlTWlncmF0ZWQtbWlncmF0ZWRcJyB0aXRsZT1cJycgKyB0ZXh0VG9BZGQgKyAnXCc+Jm5ic3A7bWlncmF0ZWQmbmJzcDs8L3NwYW4+Jyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZFF1ZXN0aW9uU3RhdGVJblJldmlldygpIHsKICAgICAgICBjb25zdCAkYW5jaG9yID0gJCgnLnN1bW1hcnkgaDIgYScpOwogICAgICAgIGNvbnN0ICRhVGV4dCA9ICRhbmNob3IuaHRtbCgpOwogICAgICAgIGlmICgkKCdbY2xhc3NePSJzdGFuZE91dER1cGVDbG9zZU1pZ3JhdGVkIl0nKS5sZW5ndGggfHwgISRhbmNob3IubGVuZ3RoIHx8ICEkYVRleHQubWF0Y2goL2Nsb3NlZHxkdXBsaWNhdGUvKSkgcmV0dXJuOwoKICAgICAgICAkYW5jaG9yLmh0bWwoJGFUZXh0LnJlcGxhY2UoLyBcWyhjbG9zZWR8ZHVwbGljYXRlKVxdLywgJycpKTsKICAgICAgICAkYW5jaG9yLmFmdGVyKGAmbmJzcDs8c3BhbiBjbGFzcz0ic3RhbmRPdXREdXBlQ2xvc2VNaWdyYXRlZC0keyRhVGV4dC5tYXRjaCgvY2xvc2VkfGR1cGxpY2F0ZS8pWzBdfSI+JHskYVRleHQubWF0Y2goL2Nsb3NlZHxkdXBsaWNhdGUvKVswXX08L3NwYW4+PC9hPmApOwogICAgICB9CgogICAgICBhZGRMYWJlbHMoKTsKICAgICAgY29uc3QgdGFyZ2V0TWFpblBhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVlc3Rpb24tbWluaS1saXN0Jyk7CiAgICAgIGNvbnN0IHRhcmdldFF1ZXN0aW9uc1BhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVlc3Rpb25zJyk7CiAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUoW3RhcmdldE1haW5QYWdlLCB0YXJnZXRRdWVzdGlvbnNQYWdlXSwgJyNxdWVzdGlvbnMsICNxdWVzdGlvbi1taW5pLWxpc3QnLCBhZGRMYWJlbHMpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZFF1ZXN0aW9uU3RhdGVJblJldmlldyk7CiAgICB9LAoKICAgIGVkaXRSZWFzb25Ub29sdGlwOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBzaG93aW5nIHRoZSBsYXRlc3QgcmV2aXNpb24ncyBjb21tZW50IGFzIGEgdG9vbHRpcCBvbiAnZWRpdCBbZGF0ZV0gYXQgW3RpbWVdJwoKICAgICAgZnVuY3Rpb24gYWRkVG9vbHRpcHMoKSB7CiAgICAgICAgY29uc3QgaWRzID0gW107CiAgICAgICAgY29uc3QgJHBvc3RzID0gW107CiAgICAgICAgJCgnLnF1ZXN0aW9uLCAuYW5zd2VyJykuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgIGlmICgkKHRoaXMpLmZpbmQoJy5wb3N0LXNpZ25hdHVyZScpLmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgJHBvc3RzLnB1c2goJCh0aGlzKSk7CiAgICAgICAgICAgIGNvbnN0IGlkID0gJCh0aGlzKS5hdHRyKCdkYXRhLXF1ZXN0aW9uaWQnKSB8fCAkKHRoaXMpLmF0dHIoJ2RhdGEtYW5zd2VyaWQnKTsKICAgICAgICAgICAgaWRzLnB1c2goaWQpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlmICghaWRzLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICBzb3guaGVscGVycy5nZXRGcm9tQVBJKHsKICAgICAgICAgIGVuZHBvaW50OiAncG9zdHMnLAogICAgICAgICAgY2hpbGRFbmRwb2ludDogJ3JldmlzaW9ucycsCiAgICAgICAgICBzaXRlbmFtZTogc294LnNpdGUudXJsLAogICAgICAgICAgZmlsdGVyOiAnIVNXSmFMMDJSTkZrWGNfd2U0aScsCiAgICAgICAgICBpZHMsCiAgICAgICAgICBmZWF0dXJlSWQ6ICdlZGl0UmVhc29uVG9vbHRpcCcsCiAgICAgICAgICBjYWNoZUR1cmF0aW9uOiA1LCAvLyBDYWNoZSBmb3IgNSBtaW51dGVzCiAgICAgICAgfSwgcmV2aXNpb25zID0+IHsKICAgICAgICAgICRwb3N0cy5mb3JFYWNoKCRwb3N0ID0+IHsKICAgICAgICAgICAgY29uc3QgaWQgPSAkcG9zdC5hdHRyKCdkYXRhLXF1ZXN0aW9uaWQnKSB8fCAkcG9zdC5hdHRyKCdkYXRhLWFuc3dlcmlkJyk7CiAgICAgICAgICAgIGNvbnN0IHJldmlzaW9uID0gcmV2aXNpb25zLmZpbmQociA9PiByLnJldmlzaW9uX3R5cGUgPT09ICdzaW5nbGVfdXNlcicgJiYgci5wb3N0X2lkID09PSAraWQpOwogICAgICAgICAgICBpZiAocmV2aXNpb24pIHsKICAgICAgICAgICAgICBjb25zdCBzcGFuID0gc294LmhlbHBlcnMubmV3RWxlbWVudCgnc3BhbicsIHsKICAgICAgICAgICAgICAgICdjbGFzcyc6ICdzb3gtcmV2aXNpb24tY29tbWVudCcsCiAgICAgICAgICAgICAgICAndGl0bGUnOiByZXZpc2lvbi5jb21tZW50LAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHNveC5kZWJ1ZyhgZWRpdFJlYXNvblRvb2x0aXAsIGFkZGluZyB0ZXh0IHRvIHRvb2x0aXAgZm9yIHBvc3QgJHtpZH06ICcke3JldmlzaW9uLmNvbW1lbnR9J2ApOwogICAgICAgICAgICAgICRwb3N0LmZpbmQoJy5wb3N0LXNpZ25hdHVyZTplcSgwKScpLmZpbmQoJy51c2VyLWFjdGlvbi10aW1lIGEnKS53cmFwSW5uZXIoc3Bhbik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBhZGRUb29sdGlwcygpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZFRvb2x0aXBzKTsKICAgIH0sCgogICAgYWRkU0JTQnRuOiBmdW5jdGlvbihzZXR0aW5ncykgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGFkZGluZyBhIGJ1dHRvbiB0byB0aGUgZWRpdG9yIHRvb2xiYXIgdG8gdG9nZ2xlIHNpZGUtYnktc2lkZSBlZGl0aW5nCiAgICAgIC8vIFRoYW5rcyBzemVnbyAoQGh0dHBzOi8vZ2l0aHViLmNvbS9zemVnbykgZm9yIGNvbXBsZXRlbHkgcmV3cml0aW5nIHRoaXMhIGh0dHBzOi8vZ2l0aHViLmNvbS9zaHU4L1NFLUFuc3dlcnNfc2NyaXB0cy9wdWxsLzIKICAgICAgLy8gVGhpcyBpcyBhIGhlYXZpbHkgbW9kaWZpZWQgdmVyc2lvbiBieSBzemVnbyA8aHR0cHM6Ly9naXRodWIuY29tL3N6ZWdvL1NFLUFuc3dlcnNfc2NyaXB0cy9ibG9iL21hc3Rlci9zaWRlLWJ5LXNpZGUtZWRpdGluZy51c2VyLmpzPjoKCiAgICAgIGZ1bmN0aW9uIHN0YXJ0U0JTKHRvQXBwZW5kKSB7CiAgICAgICAgLy92YXJpYWJsZXMgdG8gcmVkdWNlIERPTSBzZWFyY2hlcwogICAgICAgIGNvbnN0IHdtZGlucHV0ID0gJCgnI3dtZC1pbnB1dCcgKyB0b0FwcGVuZCk7CiAgICAgICAgY29uc3Qgd21kcHJldmlldyA9ICQoJyN3bWQtcHJldmlldycgKyB0b0FwcGVuZCk7CiAgICAgICAgY29uc3QgcG9zdGVkaXRvciA9ICQoJyNwb3N0LWVkaXRvcicgKyB0b0FwcGVuZCk7CiAgICAgICAgY29uc3QgZHJhZnRzYXZlZCA9ICQoJyNkcmFmdC1zYXZlZCcgKyB0b0FwcGVuZCk7CiAgICAgICAgY29uc3QgZHJhZnRkaXNjYXJkZWQgPSAkKCcjZHJhZnQtZGlzY2FyZGVkJyArIHRvQXBwZW5kKTsKICAgICAgICBjb25zdCBlZGl0Y29tbWVudGRpdiA9ICQoJyNlZGl0LWNvbW1lbnQnICsgdG9BcHBlbmQpLnBhcmVudCgpLnBhcmVudCgpOyAvL2VkaXQgY29tbWVudCBtYWluIHBhcmVudCBkaXYgaGFzIG5vIGNsYXNzIG9yIElECgogICAgICAgICQoJyN3bWQtYnV0dG9uLWJhcicgKyB0b0FwcGVuZCkudG9nZ2xlQ2xhc3MoJ3Nicy1vbicpOwoKICAgICAgICBkcmFmdHNhdmVkLnRvZ2dsZUNsYXNzKCdzYnMtb24nKTsKICAgICAgICBkcmFmdGRpc2NhcmRlZC50b2dnbGVDbGFzcygnc2JzLW9uJyk7CiAgICAgICAgcG9zdGVkaXRvci50b2dnbGVDbGFzcygnc2JzLW9uJyk7CiAgICAgICAgcG9zdGVkaXRvci5maW5kKCcud21kLWNvbnRhaW5lcicpLnRvZ2dsZUNsYXNzKCdzYnMtb24nKTsKICAgICAgICBwb3N0ZWRpdG9yLmZpbmQoJy53bWQtY29udGFpbmVyJykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ3Nicy1vbi1sZWZ0LXNpZGUnKTsKICAgICAgICB3bWRpbnB1dC5wYXJlbnQoKS50b2dnbGVDbGFzcygnc2JzLW9uJyk7IC8vd21kaW5wdXQucGFyZW50KCkgaGFzIGNsYXNzIHdtZC1jb250YWluZXIKICAgICAgICB3bWRwcmV2aWV3LnRvZ2dsZUNsYXNzKCdzYnMtb24nKTsKCiAgICAgICAgaWYgKHNveC5sb2NhdGlvbi5vbignL2VkaXQtdGFnLXdpa2kvJykpICQoJyNwb3N0LWZvcm0nKS50b2dnbGVDbGFzcygnc2JzLW9uJyk7IC8vaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8yNDcKICAgICAgICBpZiAoc294LmxvY2F0aW9uLm9uKCcvZWRpdCcpKSAkKCcucG9zdC1lZGl0b3InKS5uZXh0KCkuY3NzKCdjbGVhcicsICdib3RoJyk7CgogICAgICAgIGlmICh0b0FwcGVuZC5sZW5ndGggPiAwKSB7IC8vb3B0aW9ucyBzcGVjaWZpYyB0byBtYWtpbmcgZWRpdHMgb24gZXhpc3RpbmcgcXVlc3Rpb25zL2Fuc3dlcnMKICAgICAgICAgIHBvc3RlZGl0b3IuZmluZCgnLmhpZGUtcHJldmlldycpLnRvZ2dsZUNsYXNzKCdzYnMtb24nKTsgLy9uZWVkZWQgdG8gc3RvcCB0aGUgdGFnIGJveCBmcm9tIGJlaW5nICdvbiB0b3Agb2YnIHRoZSB0ZXh0YXJlYSBibG9ja2luZyB0ZXh0IGZyb20gYmVpbmcgZW50ZXJpbmcKICAgICAgICAgIGVkaXRjb21tZW50ZGl2LnRvZ2dsZUNsYXNzKCdzYnMtb24gZWRpdC1jb21tZW50Jyk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigncXVlc3Rpb25zL2FzaycpID4gLTEpIHsgLy9leHRyYSBDU1MgZm9yICdhc2snIHBhZ2UKICAgICAgICAgIHdtZHByZXZpZXcudG9nZ2xlQ2xhc3MoJ3Nicy1uZXdxJyk7CiAgICAgICAgICBkcmFmdHNhdmVkLnRvZ2dsZUNsYXNzKCdzYnMtbmV3cScpOwogICAgICAgICAgZHJhZnRkaXNjYXJkZWQudG9nZ2xlQ2xhc3MoJ3Nicy1uZXdxJyk7CgogICAgICAgICAgJCgnI3RhZy1lZGl0b3InKS50b2dnbGVDbGFzcygnc2JzLW9uIGVkaXQtY29tbWVudCcpOyAvL25lZWRlZCB0byBzdG9wIHRoZSB0YWcgYm94IGZyb20gYmVpbmcgJ29uIHRvcCBvZicgdGhlIHRleHRhcmVhIGJsb2NraW5nIHRleHQgZnJvbSBiZWluZyBlbnRlcmluZwogICAgICAgICAgJCgnI3F1ZXN0aW9uLW9ubHktc2VjdGlvbicpLmNoaWxkcmVuKCcuZm9ybS1pdGVtJykudG9nZ2xlQ2xhc3MoJ3Nicy1vbiBzYnMtbmV3cScpOwoKICAgICAgICAgIC8vc3dhcCB0aGUgb3JkZXIgb2YgdGhpbmdzIHRvIHByZXZlbnQgZHJhZnQgc2F2ZWQvZGlzY2FyZGVkIG1lc3NhZ2VzIGZyb20KICAgICAgICAgIC8vIG1vdmluZyB0aGUgcHJldmlldyBwYW5lIGFyb3VuZAogICAgICAgICAgaWYgKHdtZHByZXZpZXcuaGFzQ2xhc3MoJ3Nicy1vbicpKSB7CiAgICAgICAgICAgIGRyYWZ0c2F2ZWQuYmVmb3JlKHdtZHByZXZpZXcpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZHJhZnRkaXNjYXJkZWQuYWZ0ZXIod21kcHJldmlldyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICh3bWRwcmV2aWV3Lmhhc0NsYXNzKCdzYnMtb24nKSkgeyAvL3NicyB3YXMgdG9nZ2xlZCBvbgogICAgICAgICAgJCgnI3NpZGViYXInKS5hZGRDbGFzcygnc2JzLW9uJyk7CiAgICAgICAgICAkKCcjY29udGVudCcpLmFkZENsYXNzKCdzYnMtb24nKTsKICAgICAgICAgICQoJy50YWctZWRpdG9yJykucGFyZW50KCkucGFyZW50KCkucmVtb3ZlQXR0cignc3R5bGUnKTsgLy9yZW1vdmUgc3R5bGUgZnJvbSBib3RoIGRpdiBzdHlsZT0ncG9zaXRpb246cmVsYXRpdmUnCiAgICAgICAgICAkKCcudGFnLWVkaXRvcicpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUF0dHIoJ3N0eWxlJyk7IC8vcmVtb3ZlIHN0eWxlIGZyb20gYm90aCBkaXYgc3R5bGU9J3Bvc2l0aW9uOnJlbGF0aXZlJwoKICAgICAgICAgIGlmICh0b0FwcGVuZC5sZW5ndGggPiAwKSB7IC8vY3VycmVudCBzYnMgdG9nZ2xlIGlzIGZvciBhbiBlZGl0CiAgICAgICAgICAgICQoJy52b3RlY2VsbCcpLmFkZENsYXNzKCdzYnMtb24nKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL3N0cmV0Y2ggdGhlIHRleHQgaW5wdXQgd2luZG93IHRvIG1hdGNoIHRoZSBwcmV2aWV3IGxlbmd0aAogICAgICAgICAgLy8gLSAiMjE1IiBjYW1lIGZyb20gdHJpYWwgYW5kIGVycm9yCiAgICAgICAgICAvLyAtIENhbiB0aGlzIGJlIGRvbmUgdXNpbmcgdG9nZ2xlQ2xhc3M/CiAgICAgICAgICBjb25zdCBwcmV2aWV3SGVpZ2h0ID0gd21kcHJldmlldy5oZWlnaHQoKTsKICAgICAgICAgIGlmIChwcmV2aWV3SGVpZ2h0ID4gMjE1KSB7IC8vZGVmYXVsdCBpbnB1dCBib3ggaXMgMjAwcHggdGFsbCwgb25seSBzY2FsZSBpZiBuZWNlc3NhcnkKICAgICAgICAgICAgd21kaW5wdXQuaGVpZ2h0KHByZXZpZXdIZWlnaHQgLSAxNSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsgLy9zYnMgd2FzIHRvZ2dsZWQgb2ZmCiAgICAgICAgICAvL2NoZWNrIGlmIHNicyBpcyBvZmYgZm9yIGFsbCBleGlzdGluZyBxdWVzdGlvbnMgYW5kIGFuc3dlcnMKICAgICAgICAgIGlmICghJCgnLnF1ZXN0aW9uJykuZmluZCgnLndtZC1wcmV2aWV3LnNicy1vbicpLmxlbmd0aCAmJiAhJCgnLmFuc3dlcicpLmZpbmQoJy53bWQtcHJldmlldy5zYnMtb24nKS5sZW5ndGgpIHsKICAgICAgICAgICAgJCgnLnZvdGVjZWxsJykucmVtb3ZlQ2xhc3MoJ3Nicy1vbicpOwoKICAgICAgICAgICAgaWYgKCEoJCgnI3dtZC1wcmV2aWV3JykuaGFzQ2xhc3MoJ3Nicy1vbicpKSkgeyAvL3NicyBpcyBvZmYgZm9yIGV2ZXJ5dGhpbmcKICAgICAgICAgICAgICAkKCcjc2lkZWJhcicpLnJlbW92ZUNsYXNzKCdzYnMtb24nKTsKICAgICAgICAgICAgICAkKCcjY29udGVudCcpLnJlbW92ZUNsYXNzKCdzYnMtb24nKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIC8vcmV0dXJuIGlucHV0IHRleHQgd2luZG93IHRvIG9yaWdpbmFsIHNpemUKICAgICAgICAgIC8vIC0gQ2FuIHRoaXMgYmUgZG9uZSB1c2luZyB0b2dnbGVDbGFzcz8KICAgICAgICAgIHdtZGlucHV0LmhlaWdodCgyMDApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gU0JTKGpOb2RlKSB7CiAgICAgICAgak5vZGUgPSAkKGpOb2RlKTsKICAgICAgICBpZiAoak5vZGUuaXMoJ3RleHRhcmVhJykpIGpOb2RlID0gak5vZGUuY2xvc2VzdCgnLndtZC1jb250YWluZXInKS5maW5kKCdbaWRePSJ3bWQtcmVkby1idXR0b24iXScpOwogICAgICAgIGlmIChqTm9kZS5pcygnLmlubGluZS1lZGl0b3IsIC53bWQtYnV0dG9uLWJhciwgLnJldmlldy1jb250ZW50JykpIGpOb2RlID0gak5vZGUuZmluZCgnW2lkXj0id21kLXJlZG8tYnV0dG9uIl0nKTsKICAgICAgICBpZiAoIWpOb2RlLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICBjb25zdCBpdGVtaWQgPSBqTm9kZVswXS5pZC5yZXBsYWNlKC9eXEQrL2csICcnKTsKICAgICAgICBjb25zdCB0b0FwcGVuZCA9IChpdGVtaWQubGVuZ3RoID4gMCA/ICctJyArIGl0ZW1pZCA6ICcnKTsgLy9oZWxwcyBzZWxlY3QgdGFncyBzcGVjaWZpYyB0byB0aGUgcXVlc3Rpb24vYW5zd2VyIGJlaW5nCiAgICAgICAgLy8gZWRpdGVkIChvciBuZXcgcXVlc3Rpb24vYW5zd2VyIGJlaW5nIHdyaXR0ZW4pCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBpZiAoak5vZGUuY2xvc2VzdCgnLnBvc3QtZWRpdG9yJykuZmluZCgnLnNveC1zYnMtdG9nZ2xlJykubGVuZ3RoKSByZXR1cm47IC8vZG9uJ3QgYWRkIGFnYWluIGlmIGFscmVhZHkgZXhpc3RzCgogICAgICAgICAgY29uc3Qgc2JzQnRuID0gJzxsaSBjbGFzcz0id21kLWJ1dHRvbiBzb3gtc2JzLXRvZ2dsZSIgdGl0bGU9InNpZGUtYnktc2lkZS1lZGl0aW5nIiBzdHlsZT0ibGVmdDogNTAwcHg7d2lkdGg6IDE3MHB4OyI+IFwKPGRpdiBpZD0id21kLXNicy1idXR0b24nICsgdG9BcHBlbmQgKyAnIiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTogbm9uZTsiPlNCUzwvZGl2PjwvbGk+JzsKICAgICAgICAgIGpOb2RlLmFmdGVyKHNic0J0bik7CgogICAgICAgICAgLy9hZGQgY2xpY2sgbGlzdGVuZXIgdG8gc2JzQnRuCiAgICAgICAgICBqTm9kZS5uZXh0KCkub24oJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBzdGFydFNCUyh0b0FwcGVuZCk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAoc2V0dGluZ3Muc2JzQnlEZWZhdWx0KSB7CiAgICAgICAgICAgIHN0YXJ0U0JTKHRvQXBwZW5kKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvL2FkZCBjbGljayBsaXN0ZW5lcnMgZm9yICJTYXZlIEVkaXRzIiBhbmQgImNhbmNlbCIgYnV0dG9ucwogICAgICAgICAgLy8gLSBhbHNvIGdldHMgYWRkZWQgdG8gdGhlICJQb3N0IE5ldyBRdWVzdGlvbiIgYW5kICJQb3N0IE5ldyBBbnN3ZXIiIGJ1dHRvbiBhcyBhbiBpbm5vY3VvdXMgKEkgdGhpbmspIHNpZGUgZWZmZWN0CiAgICAgICAgICAkKCcjcG9zdC1lZGl0b3InICsgdG9BcHBlbmQpLnNpYmxpbmdzKCcuZm9ybS1zdWJtaXQnKS5jaGlsZHJlbigpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoJCh0aGlzKS5wYXJlbnQoKS5zaWJsaW5ncygnLnNicy1vbicpLmxlbmd0aCkgeyAvL3NicyB3YXMgb24sIHNvIHR1cm4gaXQgb2ZmCiAgICAgICAgICAgICAgc3RhcnRTQlModG9BcHBlbmQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfQoKICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCdxdWVzdGlvbnMvYXNrJykgPCAwKSB7IC8vbm90IHBvc3RpbmcgYSBuZXcgcXVlc3Rpb24KICAgICAgICAvL2dldCBxdWVzdGlvbiBhbmQgYW5zd2VyIElEcyBmb3Iga2VlcGluZyB0cmFjayBvZiB0aGUgZXZlbnQgbGlzdGVuZXJzCiAgICAgICAgLy9hbnN3ZXJzIGhhdmUgYW5jaG9yIHRhZ3MgYmVmb3JlIHRoZW0gb2YgdGhlIGZvcm0gPGEgbmFtZT0iIyI+LCB3aGVyZSAjIGlzIHRoZSBhbnN3ZXIgSUQKICAgICAgICBjb25zdCBhbmNob3JMaXN0ID0gJCgnI2Fuc3dlcnMgPiBhJyk7CiAgICAgICAgY29uc3QgbnVtQW5jaG9ycyA9IGFuY2hvckxpc3QubGVuZ3RoOwogICAgICAgIGNvbnN0IGl0ZW1JRHMgPSBbXTsKCiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbnVtQW5jaG9ycyAtIDI7IGkrKykgeyAvL3RoZSBmaXJzdCBhbmQgbGFzdCBhbmNob3JzIGFyZW4ndCBhbnN3ZXJzCiAgICAgICAgICBpdGVtSURzLnB1c2goYW5jaG9yTGlzdFtpXS5uYW1lKTsKICAgICAgICB9CiAgICAgICAgaXRlbUlEcy5wdXNoKCQoJy5xdWVzdGlvbicpLmRhdGEoJ3F1ZXN0aW9uaWQnKSk7CgogICAgICAgIC8vZXZlbnQgbGlzdGVuZXJzIGZvciBhZGRpbmcgdGhlIHNicyB0b2dnbGUgYnV0dG9ucyBmb3IgZWRpdGluZyBleGlzdGluZyBxdWVzdGlvbnMgb3IgYW5zd2VycwogICAgICAgIGNvbnN0IHRhcmdldFF1ZXN0aW9uQ2VsbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwb3N0Y2VsbCcpOwogICAgICAgIGNvbnN0IHRhcmdldEFuc3dlckNlbGxzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYW5zd2VyY2VsbCcpOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IG51bUFuY2hvcnMgLSAyOyBpKyspIHsKICAgICAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUoWy4uLnRhcmdldEFuc3dlckNlbGxzLCAuLi50YXJnZXRRdWVzdGlvbkNlbGxzXSwgJyN3bWQtcmVkby1idXR0b24tJyArIGl0ZW1JRHNbaV0sIFNCUyk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvL2V2ZW50IGxpc3RlbmVyIGZvciBhZGRpbmcgdGhlIHNicyB0b2dnbGUgYnV0dG9uIGZvciBwb3N0aW5nIG5ldyBxdWVzdGlvbnMgb3IgYW5zd2VycwogICAgICAkKGRvY3VtZW50KS5vbignc294LWVkaXQtd2luZG93JywgKGUsIHRhcmdldCkgPT4gewogICAgICAgIGlmICgkKHRhcmdldCkuaXMoJy53bWQtYnV0dG9uLWJhcicpKSByZXR1cm47IC8vZG9uJ3Qgd2FudCB0byBjYXRjaCBleHRyYSBtdXRhdGlvbiBldmVudCBmb3IgYnV0dG9uIGJhcgogICAgICAgIFNCUyh0YXJnZXQpOwogICAgICB9KTsKCiAgICB9LAoKICAgIGFkZEF1dGhvck5hbWVUb0luYm94Tm90aWZpY2F0aW9uczogZnVuY3Rpb24oc2V0dGluZ3MpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IFRvIGFkZCB0aGUgYXV0aG9yJ3MgbmFtZSB0byBpbmJveCBub3RpZmljYXRpb25zCgogICAgICBmdW5jdGlvbiBzZXRBdXRob3JOYW1lKG5vZGUpIHsKICAgICAgICAvL2ZvciBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzM0NwogICAgICAgIGNvbnN0IHByZXBlbmRUb01lc3NhZ2UgPSBPYmplY3Qua2V5cyhzZXR0aW5ncykubGVuZ3RoICE9PSAwID8gc2V0dGluZ3MuYWRkTmFtZUJlZm9yZU1lc3NhZ2VPckF0VG9wIDogZmFsc2U7CiAgICAgICAgY29uc3QgbGluayA9IG5vZGUuZmlyc3RFbGVtZW50Q2hpbGQuaHJlZjsKICAgICAgICBpZiAoIWxpbmspIHJldHVybjsKICAgICAgICBsZXQgaWQ7CiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHsKICAgICAgICAgIGNvbW1lbnRzOiBbJ3Bvc3RzL2NvbW1lbnRzJywgJyFTV0puYU40WmVjZEhjKmlBRHUnXSwKICAgICAgICAgIGFuc3dlcnM6IFsnY29tL2EvJywgJyExelNuKmc3eFBVSVFyLnlDbWtBaXUnXSwKICAgICAgICAgICdzdWdnZXN0ZWQtZWRpdHMnOiBbJy9zdWdnZXN0ZWQtZWRpdHMvJywgJyFTaDJvTDJCUVEyVyhyb1V5eTknXSwKICAgICAgICB9OwoKICAgICAgICBsZXQgZmlsdGVyOwogICAgICAgIGNvbnN0IHNpdGVuYW1lID0gc294LmhlbHBlcnMuZ2V0U2l0ZU5hbWVGcm9tTGluayhsaW5rKTsKCiAgICAgICAgbGV0IGFwaUNhbGxUeXBlID0gbnVsbDsKICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBtYXRjaGVzKSB7CiAgICAgICAgICBpZiAobWF0Y2hlcy5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIGxpbmsuaW5kZXhPZihtYXRjaGVzW2tleV1bMF0pID4gLTEpIHsKICAgICAgICAgICAgYXBpQ2FsbFR5cGUgPSBrZXk7CiAgICAgICAgICAgIGlkID0gc294LmhlbHBlcnMuZ2V0SURGcm9tTGluayhsaW5rKTsKICAgICAgICAgICAgZmlsdGVyID0gbWF0Y2hlc1trZXldWzFdOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFhcGlDYWxsVHlwZSkgewogICAgICAgICAgc294LmxvZ2luZm8oJ1NPWCBkb2VzIG5vdCBjdXJyZW50bHkgc3VwcG9ydCBnZXQgYXV0aG9yIGluZm9ybWF0aW9uIGZvciB0eXBlOiAnICsgYXBpQ2FsbFR5cGUpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgc294LmRlYnVnKCdhZGRBdXRob3JOYW1lVG9JbmJveE5vdGlmaWNhdGlvbnM6ICcsIG5vZGUsIGlkKTsKCiAgICAgICAgc294LmhlbHBlcnMuZ2V0RnJvbUFQSSh7CiAgICAgICAgICBlbmRwb2ludDogYXBpQ2FsbFR5cGUsCiAgICAgICAgICBpZHM6IGlkLAogICAgICAgICAgc2l0ZW5hbWUsCiAgICAgICAgICBmaWx0ZXIsCiAgICAgICAgICB1c2VDYWNoZTogZmFsc2UsIC8vIFNpbmdsZSBJRCBzbyBubyBwb2ludAogICAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICAgIHNveC5kZWJ1ZygnYWRkQXV0aG9yTmFtZVRvSW5ib3hOb3RpZmljYXRpb25zIEpTT04gcmV0dXJuZWQgZnJvbSBBUEknLCBpdGVtcyk7CgogICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8yMzMKICAgICAgICAgIGNvbnN0IHRlbXBvcmFyeURJViA9ICQoJzxkaXY+Jyk7CiAgICAgICAgICBpZiAoIWl0ZW1zLmxlbmd0aCkgcmV0dXJuOwoKICAgICAgICAgIGNvbnN0IGF1dGhvciA9IChsaW5rLmluZGV4T2YoJy9zdWdnZXN0ZWQtZWRpdHMvJykgPiAtMSA/IGl0ZW1zWzBdLnByb3Bvc2luZ191c2VyLmRpc3BsYXlfbmFtZSA6IGl0ZW1zWzBdLm93bmVyLmRpc3BsYXlfbmFtZSk7CiAgICAgICAgICBjb25zdCAkYXV0aG9yID0gJCgnPHNwYW4vPicsIHsKICAgICAgICAgICAgY2xhc3M6ICdzb3gtbm90aWZpY2F0aW9uLWF1dGhvcicsCiAgICAgICAgICAgIHRleHQ6IChwcmVwZW5kVG9NZXNzYWdlID8gJycgOiAnIGJ5ICcpICsgdGVtcG9yYXJ5RElWLmh0bWwoYXV0aG9yKS50ZXh0KCkgKyAocHJlcGVuZFRvTWVzc2FnZSA/ICc6ICcgOiAnJyksIC8vaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8zNDcKICAgICAgICAgIH0pOwoKICAgICAgICAgIGNvbnN0ICRoZWFkZXIgPSAkKG5vZGUucXVlcnlTZWxlY3RvcignLml0ZW0taGVhZGVyJykpOwogICAgICAgICAgY29uc3QgJHR5cGUgPSAkaGVhZGVyLmZpbmQoJy5pdGVtLXR5cGUnKS5jbG9uZSgpOwogICAgICAgICAgY29uc3QgJGNyZWF0aW9uID0gJGhlYWRlci5maW5kKCcuaXRlbS1jcmVhdGlvbicpLmNsb25lKCk7CgogICAgICAgICAgaWYgKHByZXBlbmRUb01lc3NhZ2UpIHsKICAgICAgICAgICAgJChub2RlKS5maW5kKCcuaXRlbS1zdW1tYXJ5JykucHJlcGVuZCgkYXV0aG9yKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vZml4IGNvbmZsaWN0IHdpdGggc291cCBmaXggbXNlMjA3NTI2IC0gaHR0cHM6Ly9naXRodWIuY29tL3Z5em5ldi9zb3VwL2Jsb2IvbWFzdGVyL1NPVVAudXNlci5qcyNMNDg5CiAgICAgICAgICAgICRoZWFkZXIuZW1wdHkoKS5hcHBlbmQoJHR5cGUpLmFwcGVuZCgkYXV0aG9yKS5hcHBlbmQoJGNyZWF0aW9uKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgY29uc3QgaW5ib3hDbGFzcyA9ICdpbmJveC1kaWFsb2cnOwogICAgICBjb25zdCBQUk9DRVNTRURfQ0xBU1MgPSAnc294LWF1dGhvck5hbWVBZGRlZCc7CiAgICAgIGNvbnN0IE1BWF9QUk9DRVNTRURfQVRfT05DRSA9IDIwOwoKICAgICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLi1zZWNvbmRhcnknKTsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUodGFyZ2V0LCAnLmluYm94LWl0ZW0nLCAoKSA9PiB7CiAgICAgICAgICBjb25zdCBpbmJveERpYWxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoaW5ib3hDbGFzcylbMF07CiAgICAgICAgICBsZXQgZWxpZ2libGVFbGVtZW50cyA9IFsuLi5pbmJveERpYWxvZy5xdWVyeVNlbGVjdG9yQWxsKCcuaW5ib3gtaXRlbScpXTsKICAgICAgICAgIGVsaWdpYmxlRWxlbWVudHMgPSBlbGlnaWJsZUVsZW1lbnRzLnNsaWNlKDAsIE1BWF9QUk9DRVNTRURfQVRfT05DRSk7CgogICAgICAgICAgY29uc3QgdW5wcm9jZXNzZWRFbGVtZW50cyA9IGVsaWdpYmxlRWxlbWVudHMuZmlsdGVyKGUgPT4gIWUuY2xhc3NMaXN0LmNvbnRhaW5zKFBST0NFU1NFRF9DTEFTUykpOwogICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB1bnByb2Nlc3NlZEVsZW1lbnRzLmxlbmd0aDsgeCsrKSB7CiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB1bnByb2Nlc3NlZEVsZW1lbnRzW3hdOwogICAgICAgICAgICBzZXRBdXRob3JOYW1lKGVsZW1lbnQpOwogICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoUFJPQ0VTU0VEX0NMQVNTKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICBmbGFnT3V0Y29tZVRpbWU6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGFkZGluZyB0aGUgZmxhZyBvdXRjb21lIHRpbWUgdG8gdGhlIGZsYWcgcGFnZQogICAgICAvL2h0dHBzOi8vZ2l0aHViLmNvbS9zaHU4L1N0YWNrLU92ZXJmbG93LU9wdGlvbmFsLUZlYXR1cmVzL3B1bGwvMzIKCiAgICAgICQoJy5mbGFnLW91dGNvbWUnKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICQodGhpcykuYXBwZW5kKCcg4oCTICcgKyAkKHRoaXMpLmF0dHIoJ3RpdGxlJykpOwogICAgICB9KTsKICAgIH0sCgogICAgc2Nyb2xsVG9Ub3A6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRm9yIGFkZGluZyBhIGJ1dHRvbiBhdCB0aGUgYm90dG9tIHJpZ2h0IHBhcnQgb2YgdGhlIHNjcmVlbiB0byBzY3JvbGwgYmFjayB0byB0aGUgdG9wCiAgICAgIC8vaHR0cHM6Ly9naXRodWIuY29tL3NodTgvU3RhY2stT3ZlcmZsb3ctT3B0aW9uYWwtRmVhdHVyZXMvcHVsbC8zNAoKICAgICAgJCgnPGRpdi8+JywgewogICAgICAgIGlkOiAnc294LXNjcm9sbFRvVG9wJywKICAgICAgICBjbGljazogZnVuY3Rpb24oZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoewogICAgICAgICAgICBzY3JvbGxUb3A6IDAsCiAgICAgICAgICB9LCA1MCk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKICAgICAgfSkuYXBwZW5kKHNveC5zcHJpdGVzLmdldFN2ZygndG9wJywgJ1Njcm9sbCB0byB0b3AgKFNPWCknKSkuYXBwZW5kVG8oJ2JvZHknKTsKCiAgICAgIGlmICgkKHdpbmRvdykuc2Nyb2xsVG9wKCkgPCAyMDApICQoJyNzb3gtc2Nyb2xsVG9Ub3AnKS5oaWRlKCk7CgogICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCkgewogICAgICAgIGlmICgkKHRoaXMpLnNjcm9sbFRvcCgpID4gMjAwKSB7CiAgICAgICAgICAkKCcjc294LXNjcm9sbFRvVG9wJykuZmFkZUluKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICQoJyNzb3gtc2Nyb2xsVG9Ub3AnKS5mYWRlT3V0KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgZmxhZ1BlcmNlbnRhZ2VzOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEZvciBhZGRpbmcgcGVyY2VudGFnZXMgdG8gdGhlIGZsYWcgc3VtbWFyeSBvbiB0aGUgZmxhZyBwYWdlCiAgICAgIC8vQnkgQGVua2k7IGh0dHBzOi8vZ2l0aHViLmNvbS9zaHU4L1N0YWNrLU92ZXJmbG93LU9wdGlvbmFsLUZlYXR1cmVzL3B1bGwvMzgsIGh0dHA6Ly9tZXRhLnN0YWNrb3ZlcmZsb3cuY29tL3EvMzEwODgxLzM1NDE4ODEsIGh0dHA6Ly9zdGFja2FwcHMuY29tL3EvNjc3My8yNjA4OAoKICAgICAgY29uc3QgZ3JvdXAgPSB7CiAgICAgICAgUE9TVDogMSwKICAgICAgICBTUEFNOiAyLAogICAgICAgIE9GRkVOU0lWRTogMywKICAgICAgICBDT01NRU5UOiA0LAogICAgICB9OwogICAgICBjb25zdCB0eXBlID0gewogICAgICAgIFdBSVRJTkc6ICd3YWl0aW5nJywKICAgICAgICBIRUxQRlVMOiAnaGVscGZ1bCcsCiAgICAgICAgREVDTElORUQ6ICdkZWNsaW5lZCcsCiAgICAgICAgRElTUFVURUQ6ICdkaXNwdXRlZCcsCiAgICAgICAgQUdFREFXQVk6ICdhZ2VkIGF3YXknLAogICAgICAgIFJFVFJBQ1RFRDogJ3JldHJhY3RlZCcsCiAgICAgIH07CgogICAgICBsZXQgY291bnQ7CiAgICAgIGxldCBwZXJjZW50YWdlOwoKICAgICAgZnVuY3Rpb24gYWRkUGVyY2VudGFnZShncm91cCwgdHlwZSwgcGVyY2VudGFnZSkgewogICAgICAgIGNvbnN0ICRzcGFuID0gJCgnPHNwYW4vPicsIHsKICAgICAgICAgIHRleHQ6IGAoJHtwZXJjZW50YWdlfSUpYCwKICAgICAgICAgIHN0eWxlOiAnbWFyZ2luLWxlZnQ6NXB4OyBjb2xvcjogIzk5OTsgZm9udC1zaXplOiAxMnB4OycsCiAgICAgICAgfSk7CiAgICAgICAgJChgbGkgPiBhW2hyZWYqPSJncm91cD0ke2dyb3VwfSJdOmNvbnRhaW5zKCIke3R5cGV9IilgKS5maW5kKCdkaXY6Zmlyc3QnKS5hZnRlcigkc3Bhbik7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVBlcmNlbnRhZ2UoY291bnQsIHRvdGFsKSB7CiAgICAgICAgY29uc3QgcGVyY2VudCA9IChjb3VudCAvIHRvdGFsKSAqIDEwMDsKICAgICAgICByZXR1cm4gK3BlcmNlbnQudG9GaXhlZCgyKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZ2V0RmxhZ0NvdW50KGdyb3VwLCB0eXBlKSB7CiAgICAgICAgbGV0IGZsYWdDb3VudCA9IDA7CiAgICAgICAgY29uc3QgJGdyb3VwSGVhZGVyID0gJChgbGkgPiBhW2hyZWY9Ij9ncm91cD0ke2dyb3VwfSJdYCk7CiAgICAgICAgZmxhZ0NvdW50ICs9IE51bWJlcigkZ3JvdXBIZWFkZXIubmV4dCgpLmZpbmQoYGxpOmNvbnRhaW5zKCIke3R5cGV9IilgKQogICAgICAgICAgLmZpbmQoJ2RpdjpsYXN0JykKICAgICAgICAgIC50ZXh0KCkKICAgICAgICAgIC5yZXBsYWNlKC9bXERdL2csICcnKSk7IC8vIFN0cmlwIGFueSBub24tZGlnaXQgY2hhcmFjdGVycyAoZS5nLiBjb21tYXMpCiAgICAgICAgcmV0dXJuIGZsYWdDb3VudDsKICAgICAgfQoKICAgICAgLy8gQWRkIHBlcmNlbnRhZ2VzCiAgICAgIGZvciAoY29uc3QgZ3JvdXBLZXkgaW4gZ3JvdXApIHsKICAgICAgICBjb25zdCBpdGVtID0gZ3JvdXBbZ3JvdXBLZXldOwoKICAgICAgICAvLyBTdHJpcCBhbnkgbm9uLWRpZ2l0IGNoYXJhY3RlcnMgKGUuZy4gY29tbWFzKQogICAgICAgIGNvbnN0IHRvdGFsID0gKyQoYGxpID4gYVtocmVmPSI/Z3JvdXA9JHtpdGVtfSJdYCkuZmluZCgnZGl2Omxhc3QnKS50ZXh0KCkucmVwbGFjZSgvW1xEXS9nLCAnJyk7CgogICAgICAgIGZvciAoY29uc3QgdHlwZUtleSBpbiB0eXBlKSB7CiAgICAgICAgICBjb25zdCB0eXBlSXRlbSA9IHR5cGVbdHlwZUtleV07CiAgICAgICAgICBjb3VudCA9IGdldEZsYWdDb3VudChpdGVtLCB0eXBlSXRlbSk7CiAgICAgICAgICBwZXJjZW50YWdlID0gY2FsY3VsYXRlUGVyY2VudGFnZShjb3VudCwgdG90YWwpOwogICAgICAgICAgYWRkUGVyY2VudGFnZShpdGVtLCB0eXBlSXRlbSwgcGVyY2VudGFnZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIGxpbmtlZFBvc3RzSW5saW5lOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IERpc3BsYXlzIGxpbmtlZCBwb3N0cyBpbmxpbmUgd2l0aCBhbiBhcnJvdwoKICAgICAgZnVuY3Rpb24gZ2V0SWRGcm9tVXJsKHVybCkgewogICAgICAgIGxldCBpZE1hdGNoOwogICAgICAgIGlmICh1cmwubWF0Y2goJy9hfHEvJykpIHsKICAgICAgICAgIC8vIGVnLiBodHRwOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9hLzI2NzY0LzI2MDg0MSBvciBodHRwOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xLzI2NzU2LzI2MDg0MQogICAgICAgICAgaWRNYXRjaCA9IHVybC5tYXRjaCgvXC8oPzphfHEpXC8oXGQrKS8pOwogICAgICAgIH0gZWxzZSBpZiAodXJsLmluY2x1ZGVzKCcvcXVlc3Rpb25zLycpKSB7CiAgICAgICAgICAvLyBJZiBVUkwgaW5jbHVkZXMgJyMnLCBwcm9iYWJseSBhbiBhbnN3ZXIsIGVnLiBodHRwOi8vbWV0YS5zdGFja2V4Y2hhbmdlLmNvbS9xdWVzdGlvbnMvMjY3NTYvaG93LWRvLWktdXNlLWEtc21hbGwtZm9udC1zaXplLWluLXF1ZXN0aW9ucy1hbmQtYW5zd2Vycy8yNjc2NCMyNjc2NAogICAgICAgICAgLy8gT2hlcndpc2UsIGl0J3MgYSBxdWVzdGlvbgogICAgICAgICAgaWRNYXRjaCA9IHVybC5tYXRjaCgvIz8oXGQrKS8pOwogICAgICAgIH0KICAgICAgICBpZiAoaWRNYXRjaCkgcmV0dXJuIGlkTWF0Y2hbMV07CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZEJ1dHRvbigpIHsKICAgICAgICAkKCcucG9zdC10ZXh0IGEsIC5jb21tZW50cyAuY29tbWVudC1jb3B5IGEnKS5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgY29uc3QgdXJsID0gJCh0aGlzKS5hdHRyKCdocmVmJyk7CgogICAgICAgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDgxNTY2NS8zNTQxODgxCiAgICAgICAgICBpZiAodXJsICYmCiAgICAgICAgICAgICAgIXVybC5pbmNsdWRlcygnI2NvbW1lbnQnKSAmJgogICAgICAgICAgICAgICF1cmwuaW5jbHVkZXMoJy9lZGl0LycpICYmIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zb3NjcmlwdGVkL3NveC9pc3N1ZXMvMjgxCiAgICAgICAgICAgICAgIXVybC5pbmNsdWRlcygnL3RhZ2dlZC8nKSAmJgogICAgICAgICAgICAgICF1cmwuaW5jbHVkZXMoJ3dlYi5hcmNoaXZlLm9yZycpICYmICAvLyBNYWtlIHN1cmUgdGhpcyBpc24ndCBhIFdlYiBBcmNoaXZlIFVSTAogICAgICAgICAgICAgICF1cmwuaW5jbHVkZXMoJy9jLycpICYmIC8vIE1ha2Ugc3VyZSBpdCdzIG5vdCBhIFNPIFRlYW1zIHBvc3QKICAgICAgICAgICAgICBnZXRJZEZyb21VcmwodXJsKSAmJiAvLyBnZXRJZEZyb21VcmwodXJsKSBtYWtlcyBzdXJlIGl0IHdvbid0IGZhaWwgbGF0ZXIgb24KICAgICAgICAgICAgICAhJCh0aGlzKS5wcmV2KCkuaXMoJy5leHBhbmQtcG9zdC1zb3gnKSkgewogICAgICAgICAgICAkKHRoaXMpLmJlZm9yZSgnPGEgY2xhc3M9ImV4cGFuZGVyLWFycm93LXNtYWxsLWhpZGUgZXhwYW5kLXBvc3Qtc294IiBzdHlsZT0iYm9yZGVyLWJvdHRvbTowIj48L2E+Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGFkZEJ1dHRvbigpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZEJ1dHRvbik7CgogICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnYS5leHBhbmQtcG9zdC1zb3gnLCBmdW5jdGlvbigpIHsKICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnZXhwYW5kZXItYXJyb3ctc21hbGwtc2hvdycpKSB7CiAgICAgICAgICAkKHRoaXMpLnJlbW92ZUNsYXNzKCdleHBhbmRlci1hcnJvdy1zbWFsbC1zaG93Jyk7CiAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdleHBhbmRlci1hcnJvdy1zbWFsbC1oaWRlJyk7CiAgICAgICAgICAkKCcubGlua2VkUG9zdHNJbmxpbmUtbG9hZGVkLWJvZHktc294JykucmVtb3ZlKCk7CiAgICAgICAgfSBlbHNlIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdleHBhbmRlci1hcnJvdy1zbWFsbC1oaWRlJykpIHsKICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2V4cGFuZGVyLWFycm93LXNtYWxsLWhpZGUnKTsKICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2V4cGFuZGVyLWFycm93LXNtYWxsLXNob3cnKTsKICAgICAgICAgIGNvbnN0ICR0aGF0ID0gJCh0aGlzKTsKICAgICAgICAgIGNvbnN0IGlkID0gZ2V0SWRGcm9tVXJsKCQodGhpcykubmV4dCgpLmF0dHIoJ2hyZWYnKSk7CiAgICAgICAgICBjb25zdCB1cmwgPSAkKHRoaXMpLm5leHQoKS5hdHRyKCdocmVmJyk7CiAgICAgICAgICBpZiAoIXVybC5tYXRjaCgvaHR0cHM/OlwvXC8vKSkgdXJsID0gJ2h0dHBzOi8vJyArIHVybDsKICAgICAgICAgIHNveC5oZWxwZXJzLmdldEZyb21BUEkoewogICAgICAgICAgICBlbmRwb2ludDogJ3Bvc3RzJywKICAgICAgICAgICAgaWRzOiBpZCwKICAgICAgICAgICAgc2l0ZW5hbWU6IHNveC5oZWxwZXJzLmdldFNpdGVOYW1lRnJvbUxpbmsodXJsKSwKICAgICAgICAgICAgZmlsdGVyOiAnISlxRmNfM0NidkZTNDBEcUUwUk91JywKICAgICAgICAgICAgZmVhdHVyZUlkOiAnbGlua2VkUG9zdHNJbmxpbmUnLAogICAgICAgICAgICBjYWNoZUR1cmF0aW9uOiA2MCwgLy8gQ2FjaGUgZm9yIDYwIG1pbnV0ZXMKICAgICAgICAgIH0sIHJlc3VsdHMgPT4gewogICAgICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAkdGhhdC5uZXh0KCkuYWZ0ZXIoJzxkaXYgY2xhc3M9ImxpbmtlZFBvc3RzSW5saW5lLWxvYWRlZC1ib2R5LXNveCI+PGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiPicgKyByZXN1bHRzWzBdLnRpdGxlICsgJzwvZGl2Pjxicj4nICsgcmVzdWx0c1swXS5ib2R5ICsgJzwvZGl2PicpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICR0aGF0Lm5leHQoKS5hZnRlcignPGRpdiBjbGFzcz0ibGlua2VkUG9zdHNJbmxpbmUtbG9hZGVkLWJvZHktc294Ij48c3Ryb25nPlBvc3Qgd2FzIG5vdCBmb3VuZCB0aHJvdWdoIHRoZSBBUEkuIEl0IG1heSBoYXZlIGJlZW4gZGVsZXRlZDwvMz48L3N0cm9uZz4nKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGlkZUhpcmVNZTogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBIaWRlcyB0aGUgTG9va2luZyBmb3IgYSBKb2IgbW9kdWxlIGZyb20gdGhlIHNpZGViYXIKCiAgICAgICQoJyNoaXJlbWUnKS5yZW1vdmUoKTsKICAgIH0sCgogICAgaGlkZUNvbW11bml0eUJ1bGxldGluOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEhpZGVzIHRoZSBDb21tdW5pdHkgQnVsbGV0aW4gbW9kdWxlIGZyb20gdGhlIHNpZGViYXIKCiAgICAgICQoJyNzaWRlYmFyJykuY2hpbGRyZW4oKS5maXJzdCgpLnJlbW92ZSgpOwogICAgfSwKCiAgICBoaWRlSnVzdEhvdE1ldGFQb3N0czogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBIaWRlIGp1c3QgdGhlICdIb3QgTWV0YSBQb3N0cycgc2VjdGlvbnMgaW4gdGhlIENvbW11bml0eSBCdWxsZXRpbgoKICAgICAgY29uc3QgJGhvdE1ldGFQb3N0c0hlYWRlciA9ICQoJyNzaWRlYmFyIGRpdjpjb250YWlucygiSG90IE1ldGEgUG9zdHMiKTplcSgxKScpOwogICAgICBpZiAoJGhvdE1ldGFQb3N0c0hlYWRlci5sZW5ndGgpIHsKICAgICAgICAkaG90TWV0YVBvc3RzSGVhZGVyLm5leHRBbGwoKS5yZW1vdmUoKTsKICAgICAgICAkaG90TWV0YVBvc3RzSGVhZGVyLnJlbW92ZSgpOwogICAgICB9CiAgICB9LAoKICAgIGhpZGVDaGF0U2lkZWJhcjogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBIaWRlcyB0aGUgQ2hhdCBtb2R1bGUgZnJvbSB0aGUgc2lkZWJhcgoKICAgICAgJCgnI3NpZGViYXIgI2NoYXQtZmVhdHVyZScpLnJlbW92ZSgpOwogICAgfSwKCiAgICBoaWRlTG92ZVRoaXNTaXRlOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEhpZGVzIHRoZSAiTG92ZSBUaGlzIFNpdGU/IiAod2Vla2x5IG5ld3NsZXR0ZXIpIG1vZHVsZSBmcm9tIHRoZSBzaWRlYmFyCgogICAgICAkKCcjc2lkZWJhciAjbmV3c2xldHRlci1hZCcpLnJlbW92ZSgpOwogICAgfSwKCiAgICBjaGF0RWFzeUFjY2VzczogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBBZGRzIG9wdGlvbnMgdG8gZ2l2ZSBhIHVzZXIgcmVhZC93cml0ZS9ubyBhY2Nlc3MgaW4gY2hhdCBmcm9tIHRoZWlyIHVzZXIgcG9wdXAgZGlhbG9nCgogICAgICAkKGRvY3VtZW50KS5vbignc294LWNoYXQtdXNlci1wb3B1cCcsIChlLCBub2RlKSA9PiB7CiAgICAgICAgY29uc3QgJG5vZGUgPSAkKG5vZGUpLnBhcmVudCgpOwogICAgICAgIGNvbnN0IGlkID0gJG5vZGUuZmluZCgnYScpWzBdLmhyZWYuc3BsaXQoJy8nKVs0XTsKCiAgICAgICAgLy9OT1RFOiAkKG5vZGUpICE9PSAkbm9kZQogICAgICAgIGlmICgkKG5vZGUpLmZpbmQoJy5jaGF0RWFzeUFjY2VzcycpLmxlbmd0aCkgcmV0dXJuOwogICAgICAgIGlmICgkKCcuY2hhdEVhc3lBY2Nlc3MnKS5sZW5ndGgpICQoJy5jaGF0RWFzeUFjY2VzcycpLnJlbW92ZSgpOwoKICAgICAgICAvL05PVEU6ICQobm9kZSkgIT09ICRub2RlCiAgICAgICAgJChub2RlKS5hcHBlbmQoJzxkaXYgY2xhc3M9ImNoYXRFYXN5QWNjZXNzIj5naXZlIDxiIGlkPSJyZWFkLW9ubHkiPnJlYWQ8L2I+IC8gPGIgaWQ9InJlYWQtd3JpdGUiPndyaXRlPC9iPiAvIDxiIGlkPSJyZW1vdmUiPm5vPC9iPiBhY2Nlc3M8L2Rpdj4nKTsKICAgICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLmNoYXRFYXN5QWNjZXNzIGInLCBmdW5jdGlvbigpIHsKICAgICAgICAgIGNvbnN0ICR0aGF0ID0gJCh0aGlzKTsKICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybDogJ2h0dHBzOi8vY2hhdC5zdGFja2V4Y2hhbmdlLmNvbS9yb29tcy9zZXR1c2VyYWNjZXNzLycgKyBsb2NhdGlvbi5ocmVmLnNwbGl0KCcvJylbNF0sCiAgICAgICAgICAgIHR5cGU6ICdwb3N0JywKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICdma2V5Jzogd2luZG93LmZrZXkoKS5ma2V5LAogICAgICAgICAgICAgICd1c2VyQWNjZXNzJzogJHRoYXQuYXR0cignaWQnKSwKICAgICAgICAgICAgICAnYWNsVXNlcklkJzogaWQsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICBpZiAoZCA9PT0gJycpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCdTdWNjZXNzZnVsbHkgY2hhbmdlZCB1c2VyIGFjY2VzcycpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhbGVydChkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAoKICAgIHRvcEFuc3dlcnM6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogQWRkcyBhIGJveCBhYm92ZSBhbnN3ZXJzIHRvIHNob3cgdGhlIG1vc3QgaGlnaGx5LXNjb3JpbmcgYW5zd2VycwoKICAgICAgbGV0IGNvdW50ID0gMDsKICAgICAgY29uc3QgJHRvcEFuc3dlcnMgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgaWQ6ICdzb3gtdG9wLWFuc3dlcnMnLAogICAgICAgIHN0eWxlOiAncGFkZGluZy1ib3R0b206IDEwcHg7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWFlYmVjOycsCiAgICAgIH0pOwoKICAgICAgY29uc3QgJHRhYmxlID0gJCgnPHRhYmxlLz4nLCB7CiAgICAgICAgc3R5bGU6ICdtYXJnaW46MCBhdXRvOycsCiAgICAgIH0pOwoKICAgICAgY29uc3QgJHJvdyA9ICQoJzx0ci8+Jyk7CgogICAgICAkdGFibGUuYXBwZW5kKCRyb3cpLmFwcGVuZFRvKCR0b3BBbnN3ZXJzKTsKCiAgICAgIGZ1bmN0aW9uIHNjb3JlKGUpIHsKICAgICAgICByZXR1cm4gKyQoZSkucGFyZW50KCkuZmluZCgnLmpzLXZvdGUtY291bnQnKS50ZXh0KCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNvbXBhcmVCeVNjb3JlKGEsIGIpIHsKICAgICAgICByZXR1cm4gc2NvcmUoYikgLSBzY29yZShhKTsKICAgICAgfQoKICAgICAgJCgnOm5vdCguZGVsZXRlZC1hbnN3ZXIpIC5hbnN3ZXJjZWxsJykuc2xpY2UoMSkuc29ydChjb21wYXJlQnlTY29yZSkuc2xpY2UoMCwgNSkuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICBjb3VudCsrOwogICAgICAgIGNvbnN0IGlkID0gJCh0aGlzKS5jbG9zZXN0KCcuYW5zd2VyJykuYXR0cignZGF0YS1hbnN3ZXJpZCcpOwogICAgICAgIGNvbnN0IHNjb3JlID0gJCh0aGlzKS5wcmV2KCkuZmluZCgnLmpzLXZvdGUtY291bnQnKS50ZXh0KCk7CiAgICAgICAgbGV0IGljb24gPSAndm90ZS11cC1vZmYnOwoKICAgICAgICBpZiAoc2NvcmUgPiAwKSB7CiAgICAgICAgICBpY29uID0gJ3ZvdGUtdXAtb24nOwogICAgICAgIH0KICAgICAgICBpZiAoc2NvcmUgPCAwKSB7CiAgICAgICAgICBpY29uID0gJ3ZvdGUtZG93bi1vbic7CiAgICAgICAgfQoKICAgICAgICBjb25zdCAkY29sdW1uID0gJCgnPHRkLz4nLCB7CiAgICAgICAgICBzdHlsZTogJ3dpZHRoOiAxMDBweDsgdGV4dC1hbGlnbjogY2VudGVyOycsCiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0ICRsaW5rID0gJCgnPGEvPicsIHsKICAgICAgICAgIGhyZWY6ICcjJyArIGlkLAogICAgICAgIH0pOwoKICAgICAgICBjb25zdCAkaWNvbiA9ICQoJzxpLz4nLCB7CiAgICAgICAgICBjbGFzczogaWNvbiwKICAgICAgICAgIHN0eWxlOiAnbWFyZ2luLWJvdHRvbTogMDsnLAogICAgICAgIH0pOwoKICAgICAgICAkbGluay5hcHBlbmQoJGljb24pLmFwcGVuZCgnU2NvcmU6ICcgKyBzY29yZSk7CiAgICAgICAgJGNvbHVtbi5hcHBlbmQoJGxpbmspLmFwcGVuZFRvKCRyb3cpOwogICAgICB9KTsKCiAgICAgIGlmIChjb3VudCA+IDAgJiYgISQoJyNzb3gtdG9wLWFuc3dlcnMnKS5sZW5ndGgpIHsKICAgICAgICAkKCcjYW5zd2VycyBkaXYuYW5zd2VyOmZpcnN0JykuYmVmb3JlKCR0b3BBbnN3ZXJzKTsKICAgICAgICAkdGFibGUuY3NzKCd3aWR0aCcsIGNvdW50ICogMTAwICsgJ3B4Jyk7CiAgICAgIH0KICAgIH0sCgogICAgdGFidWxhclJldmlld2VyU3RhdHM6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRGlzcGxheSByZXZpZXdlciBzdGF0cyBvbiAvcmV2aWV3L3N1Z2dlc3RlZC1lZGl0cyBpbiB0YWJsZSBmb3JtCiAgICAgIC8vIElkZWEgYnkgbG9scmVwcGVhdGxvbCBAIGh0dHA6Ly9tZXRhLnN0YWNrZXhjaGFuZ2UuY29tL2EvMjc3NDQ2IDopCgogICAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbmJhci1mdWxsJyk7CgogICAgICBmdW5jdGlvbiBkaXNwbGF5U3RhdHMoKSB7CiAgICAgICAgaWYgKCQoJy5zb3gtdGFidWxhclJldmlld2VyU3RhdHMtdGFibGUnKS5sZW5ndGggfHwgJCgnLnJldmlldy1hY3Rpb25zJykuY2hpbGRyZW4oKS5sZW5ndGggPT0gNSkgcmV0dXJuOwogICAgICAgIGxldCB0YWJsZSA9ICc8dGFibGUgY2xhc3M9InNveC10YWJ1bGFyUmV2aWV3ZXJTdGF0cy10YWJsZSI+PHRib2R5Pjx0cj48dGggYWxpZ249ImNlbnRlciI+VXNlcjwvdGg+PHRoPkFwcHJvdmVkPC90aD48dGg+UmVqZWN0ZWQ8L3RoPjx0aD5JbXByb3ZlZDwvdGg+PC90cj4nOwoKICAgICAgICAkKCcuanMtcmV2aWV3LW1vcmUtaW5zdHJ1Y3Rpb25zIHVsIGxpJykuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgIGNvbnN0ICR0aGlzID0gJCh0aGlzKTsKICAgICAgICAgIGNvbnN0IHVzZXJuYW1lID0gJHRoaXMuZmluZCgnYScpLnRleHQoKSA/ICR0aGlzLmZpbmQoJ2EnKS50ZXh0KCkgOiAnQW5vbnltb3VzPC9zcGFuPicKICAgICAgICAgIGNvbnN0IGxpbmsgPSAkdGhpcy5maW5kKCdhJykuYXR0cignaHJlZicpID8gYGEgaHJlZj0iJHskdGhpcy5maW5kKCdhJykuYXR0cignaHJlZicpfSJgIDogJ3NwYW4nCiAgICAgICAgICBjb25zdCBzdGF0ZSA9ICR0aGlzLnRleHQoKS5tYXRjaCgvXGQrKD89XHNlZGl0XHNzdWdnZXN0aW9ucz8pL2cpOwogICAgICAgICAgdGFibGUgKz0gYDx0cj48dGQ+PCR7bGlua30+JHt1c2VybmFtZX08L3RkPjx0ZD4ke3N0YXRlWzBdfTwvdGQ+PHRkPiR7c3RhdGVbMV19PC90ZD48dGQ+JHtzdGF0ZVsyXSA/IHN0YXRlWzJdIDogJ04vQSd9PC90ZD48L3RyPmA7CiAgICAgICAgfSk7CiAgICAgICAgdGFibGUgKz0gJzwvdGJvZHk+PC90YWJsZT4nOwoKICAgICAgICAkKCcuanMtcmV2aWV3LW1vcmUtaW5zdHJ1Y3Rpb25zIConKS5yZW1vdmUoKTsKICAgICAgICAkKCcuanMtcmV2aWV3LW1vcmUtaW5zdHJ1Y3Rpb25zJykuYXBwZW5kKHRhYmxlKTsKICAgICAgfQoKICAgICAgZGlzcGxheVN0YXRzKCk7CiAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUodGFyZ2V0LCAnLmpzLXJldmlldy1tb3JlLWluc3RydWN0aW9ucycsICgpID0+IHtkaXNwbGF5U3RhdHMoKX0pOwogICAgfSwKCiAgICBsaW5rZWRUb0Zyb206IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogQWRkIGFuIGFycm93IHRvIGxpbmtlZCBwb3N0cyBpbiB0aGUgc2lkZWJhciB0byBzaG93IHdoZXRoZXIgdGhleSBhcmUgbGlua2VkIHRvIG9yIGxpbmtlZCBmcm9tCgogICAgICBmdW5jdGlvbiBnZXRTcHJpdGUoc3RhdGUsIHRvb2x0aXApIHsKICAgICAgICByZXR1cm4gc294LnNwcml0ZXMuZ2V0U3ZnKGBjaGV2cm9uXyR7c3RhdGV9YCwgdG9vbHRpcCkuYWRkQ2xhc3MoJ3NveC1saW5rZWRUb0Zyb20tY2hldnJvbicpOwogICAgICB9CgogICAgICBjb25zdCBjdXJyZW50UGFnZUlkID0gK2xvY2F0aW9uLmhyZWYubWF0Y2goL1wvKFxkKylcLy8pWzFdOwogICAgICBzb3guaGVscGVycy5nZXRGcm9tQVBJKHsKICAgICAgICBlbmRwb2ludDogJ3F1ZXN0aW9ucycsCiAgICAgICAgY2hpbGRFbmRwb2ludDogJ2xpbmtlZCcsCiAgICAgICAgaWRzOiBjdXJyZW50UGFnZUlkLAogICAgICAgIHNpdGVuYW1lOiBzb3guc2l0ZS51cmwsCiAgICAgICAgZmlsdGVyOiAnIS1NT2lObTQwRHY5cVdJNGRCcWpPNUZCUzhwKk9EQ1dxUCcsCiAgICAgICAgZmVhdHVyZUlkOiAnbGlua2VkVG9Gcm9tJywKICAgICAgICBjYWNoZUR1cmF0aW9uOiAzMCwgLy8gQ2FjaGUgZm9yIDMwIG1pbnV0ZXMKICAgICAgfSwgcGFnZXNUaGF0TGlua1RvVGhpc1BhZ2UgPT4gewogICAgICAgICQoJy5saW5rZWQgLnNwYWNlciBhLnF1ZXN0aW9uLWh5cGVybGluaycpLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgY29uc3QgaWQgPSArJCh0aGlzKS5hdHRyKCdocmVmJykubWF0Y2goL1wvKFxkKylcLy8pWzFdOwoKICAgICAgICAgIGlmICgkKCdhW2hyZWYqPSInICsgaWQgKyAnIl0nKS5ub3QoJyNzaWRlYmFyIGEnKS5sZW5ndGgpIHsKICAgICAgICAgICAgLy8gSWYgYSBsaW5rIGZyb20gJ2xpbmtlZCBxdWVzdGlvbnMnIGRvZXMgZXhpc3QgZWxzZXdoZXJlIG9uIHRoaXMgcGFnZQogICAgICAgICAgICAvLyBUaGVuIHdlIGtub3cgdGhhdCB0aGlzIHBhZ2UgZGVmaW5pdGVseSByZWZlcmVuY2VzIHRoZSBsaW5rZWQgcG9zdAogICAgICAgICAgICAkKHRoaXMpLmFwcGVuZChnZXRTcHJpdGUoJ3JpZ2h0JywgJ0N1cnJlbnQgcGFnZSBsaW5rcyB0byB0aGlzIHF1ZXN0aW9uJykpOwoKICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGxpbmtlZCBwb3N0IF9taWdodF8gYWxzbyByZWZlcmVuY2UgdGhlIGN1cnJlbnQgcGFnZSwgc28gbGV0J3MgY2hlY2s6CiAgICAgICAgICAgIGlmIChwYWdlc1RoYXRMaW5rVG9UaGlzUGFnZS5maW5kKHF1ZXN0aW9uID0+IHF1ZXN0aW9uLnF1ZXN0aW9uX2lkID09PSBjdXJyZW50UGFnZUlkICYmIHF1ZXN0aW9uLnF1c3Rpb25faWQgPT09IGlkKSkgewogICAgICAgICAgICAgIC8vIFRoZSBjdXJyZW50IHBhZ2UgaXMgbGlua2VkIHRvIGZyb20gcXVlc3Rpb25faWQgKHdoaWNoIGlzIGFsc28gdGhlIGN1cnJlbnQgYW5jaG9yIGluIHRoZSBsb29wKQogICAgICAgICAgICAgIHNveC5kZWJ1ZyhgbGlua2VkVG9Gcm9tOiBsaW5rIHRvIGN1cnJlbnQgcGFnZSAoJHtjdXJyZW50UGFnZUlkfSkgZXhpc3RzIG9uIHF1ZXN0aW9uICR7aWR9YCk7CiAgICAgICAgICAgICAgJCh0aGlzKS5hcHBlbmQoZ2V0U3ByaXRlKCdsZWZ0JywgJ1RoaXMgcXVlc3Rpb24gbGlua3MgdG8gdGhlIGN1cnJlbnQgcGFnZScpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzb3guZGVidWcoYGxpbmtlZFRvRnJvbTogbGluayB0byBjdXJyZW50IHBhZ2Ugbm90IGZvdW5kIG9uIHF1ZXN0aW9uICR7aWR9YCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIElmIGEgbGluayBmcm9tICdsaW5rZWQgcXVlc3Rpb25zJyBkb2Vzbid0IGV4aXN0IG9uIHRoZSByZXN0IG9mIHRoZSBwYWdlCiAgICAgICAgICAgIC8vIFRoZW4gaXQgbXVzdCBiZSB0aGVyZSBfb25seV8gZHVlIHRvIHRoZSBmYWN0IHRoYXQgdGhlIGxpbmtlZCBwb3N0IHJlZmVyZW5jZXMgdGhlIGN1cnJlbnQgcGFnZQogICAgICAgICAgICAkKHRoaXMpLmFwcGVuZChnZXRTcHJpdGUoJ2xlZnQnLCAnVGhpcyBxdWVzdGlvbiBsaW5rcyB0byB0aGUgY3VycmVudCBwYWdlJykpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgYWxpZ25CYWRnZXNCeUNsYXNzOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFsaWducyBiYWRnZXMgYnkgdGhlaXIgY2xhc3MgKGJyb256ZS9zaWx2ZXIvZ29sZCkgb24gdXNlciBwcm9maWxlcwoKICAgICAgY29uc3QgYWNzID0ge307CiAgICAgIGNvbnN0ICRiYWRnZXMgPSAkKCcudXNlci1hY2NvdW50cyB0ciAuYmFkZ2VzJyk7CgogICAgICAkYmFkZ2VzLmVhY2goZnVuY3Rpb24oaSkgewogICAgICAgIGxldCBiOyBsZXQgczsgbGV0IGc7CiAgICAgICAgaWYgKCQodGhpcykuZmluZCgnPnNwYW5bdGl0bGUqPSJicm9uemUgYmFkZ2UiXScpLmxlbmd0aCkgewogICAgICAgICAgYiA9ICQodGhpcykuZmluZCgnPnNwYW5bdGl0bGUqPSJicm9uemUgYmFkZ2UiXSAuYmFkZ2Vjb3VudCcpLnRleHQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKCQodGhpcykuZmluZCgnPnNwYW5bdGl0bGUqPSJzaWx2ZXIgYmFkZ2UiXScpLmxlbmd0aCkgewogICAgICAgICAgcyA9ICQodGhpcykuZmluZCgnPnNwYW5bdGl0bGUqPSJzaWx2ZXIgYmFkZ2UiXSAuYmFkZ2Vjb3VudCcpLnRleHQoKTsKICAgICAgICB9CiAgICAgICAgaWYgKCQodGhpcykuZmluZCgnPnNwYW5bdGl0bGUqPSJnb2xkIGJhZGdlIl0nKS5sZW5ndGgpIHsKICAgICAgICAgIGcgPSAkKHRoaXMpLmZpbmQoJz5zcGFuW3RpdGxlKj0iZ29sZCBiYWRnZSJdIC5iYWRnZWNvdW50JykudGV4dCgpOwogICAgICAgIH0KICAgICAgICBhY3NbaV0gPSB7CiAgICAgICAgICAnYnJvbnplJzogYiwKICAgICAgICAgICdzaWx2ZXInOiBzLAogICAgICAgICAgJ2dvbGQnOiBnLAogICAgICAgIH07CiAgICAgIH0pOwogICAgICAkLmVhY2goYWNzLCBrID0+IHsKICAgICAgICBjb25zdCAkYmFkZ2VzVGQgPSAkYmFkZ2VzLmVxKGspOwogICAgICAgICRiYWRnZXNUZC5odG1sKCcnKTsKICAgICAgICBpZiAoYWNzW2tdLmdvbGQpIHsKICAgICAgICAgICRiYWRnZXNUZC5hcHBlbmQoJzxzcGFuIHRpdGxlPSInICsgYWNzW2tdLmdvbGQgKyAnIGdvbGQgYmFkZ2VzIj48c3BhbiBjbGFzcz0iYmFkZ2UxIj48L3NwYW4+PHNwYW4gY2xhc3M9ImJhZGdlY291bnQiPicgKyBhY3Nba10uZ29sZCArICc8L3NwYW4+PC9zcGFuPicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkYmFkZ2VzVGQuYXBwZW5kKCc8c3Bhbj48c3BhbiBjbGFzcz0iYmFkZ2UxIiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTpub25lIj48L3NwYW4+PHNwYW4gY2xhc3M9ImJhZGdlY291bnQiPjwvc3Bhbj48L3NwYW4+Jyk7CiAgICAgICAgfQogICAgICAgIGlmIChhY3Nba10uc2lsdmVyKSB7CiAgICAgICAgICAkYmFkZ2VzVGQuYXBwZW5kKCc8c3BhbiB0aXRsZT0iJyArIGFjc1trXS5zaWx2ZXIgKyAnIHNpbHZlciBiYWRnZXMiPjxzcGFuIGNsYXNzPSJiYWRnZTIiPjwvc3Bhbj48c3BhbiBjbGFzcz0iYmFkZ2Vjb3VudCI+JyArIGFjc1trXS5zaWx2ZXIgKyAnPC9zcGFuPjwvc3Bhbj4nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgJGJhZGdlc1RkLmFwcGVuZCgnPHNwYW4+PHNwYW4gY2xhc3M9ImJhZGdlMSIgc3R5bGU9ImJhY2tncm91bmQtaW1hZ2U6bm9uZSI+PC9zcGFuPjxzcGFuIGNsYXNzPSJiYWRnZWNvdW50Ij48L3NwYW4+PC9zcGFuPicpOwogICAgICAgIH0KICAgICAgICBpZiAoYWNzW2tdLmJyb256ZSkgewogICAgICAgICAgJGJhZGdlc1RkLmFwcGVuZCgnPHNwYW4gdGl0bGU9IicgKyBhY3Nba10uYnJvbnplICsgJyBicm9uemUgYmFkZ2VzIj48c3BhbiBjbGFzcz0iYmFkZ2UzIj48L3NwYW4+PHNwYW4gY2xhc3M9ImJhZGdlY291bnQiPicgKyBhY3Nba10uYnJvbnplICsgJzwvc3Bhbj48L3NwYW4+Jyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICRiYWRnZXNUZC5hcHBlbmQoJzxzcGFuPjxzcGFuIGNsYXNzPSJiYWRnZTEiIHN0eWxlPSJiYWNrZ3JvdW5kLWltYWdlOm5vbmUiPjwvc3Bhbj48c3BhbiBjbGFzcz0iYmFkZ2Vjb3VudCI+PC9zcGFuPjwvc3Bhbj4nKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgJCgnLnVzZXItYWNjb3VudHMgLmJhZGdlcyBzcGFuJykuY3NzKHsKICAgICAgICAnbWluLXdpZHRoJzogJzIwcHgnLAogICAgICAgICdkaXNwbGF5JzogJ2lubGluZS1ibG9jaycsCiAgICAgIH0pOwoKICAgIH0sCgogICAgcXVpY2tBdXRob3JJbmZvOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IFNob3dzIHdoZW4gdGhlIHBvc3QncyBhdXRob3Igd2FzIGxhc3QgYWN0aXZlIGFuZCB0aGVpciByZWdpc3RyYXRpb24gc3RhdGUKCiAgICAgIGZ1bmN0aW9uIGFkZExhc3RTZWVuKHVzZXJEZXRhaWxzRnJvbUFQSSkgewogICAgICAgICQoJy51c2VyLWRldGFpbHMgYVtocmVmXj0iL3VzZXJzIl0nKS5lYWNoKGZ1bmN0aW9uKCkgewoKICAgICAgICAgIGNvbnN0IHBhcmVudERJViA9ICQodGhpcykucGFyZW50KCkucGFyZW50KCk7CiAgICAgICAgICBjb25zdCBpZCA9IHNveC5oZWxwZXJzLmdldElERnJvbUFuY2hvcih0aGlzKTsKICAgICAgICAgIGlmICghaWQgfHwgISh1c2VyRGV0YWlsc0Zyb21BUElbaWRdICYmICFwYXJlbnRESVYuZmluZCgnLnNveC1sYXN0LXNlZW4nKS5sZW5ndGgpKSByZXR1cm47CgogICAgICAgICAgY29uc3QgbGFzdFNlZW5EYXRlID0gbmV3IERhdGUodXNlckRldGFpbHNGcm9tQVBJW2lkXS5sYXN0X3NlZW4pOwoKICAgICAgICAgIGNvbnN0ICRkaXYgPSAkKCc8ZGl2Lz4nLCB7CiAgICAgICAgICAgICdjbGFzcyc6ICdzb3gtcXVpY2tBdXRob3JJbmZvLWRldGFpbHMnLAogICAgICAgICAgICB0aXRsZTogJ1NPWDogbGFzdCBzZWVuJywKICAgICAgICAgIH0pLmFwcGVuZChzb3guc3ByaXRlcy5nZXRTdmcoJ2FjY2Vzc190aW1lJykpCiAgICAgICAgICAgIC5hcHBlbmQoJCgnPHRpbWUvPicsIHsKICAgICAgICAgICAgICAnY2xhc3MnOiAndGltZWFnbyBzb3gtbGFzdC1zZWVuJywKICAgICAgICAgICAgICBkYXRldGltZTogbGFzdFNlZW5EYXRlLnRvSVNPU3RyaW5nKCksCiAgICAgICAgICAgICAgdGl0bGU6IGxhc3RTZWVuRGF0ZS50b0pTT04oKS5yZXBsYWNlKCdUJywgJyAnKS5yZXBsYWNlKCcuMDAwJywgJycpLCAvLyBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzIwNDogaGFja3kgYnV0IHNob3J0IHdheSAnLjAwMCcgYWx3YXlzIHdvcmtzIGJlY2F1c2UgU0UgZG9lc24ndCBkbyBzdWNoIHByZWNpc2UgdGltZXMKICAgICAgICAgICAgICB2YWx1ZTogbGFzdFNlZW5EYXRlLnRvTG9jYWxlU3RyaW5nKCksCiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAkKHBhcmVudERJVikubGFzdCgpLmFwcGVuZCgkZGl2KTsKICAgICAgICAgIGlmICh1c2VyRGV0YWlsc0Zyb21BUElbaWRdLnR5cGUgPT09ICd1bnJlZ2lzdGVyZWQnKSB7CiAgICAgICAgICAgICQodGhpcykuYWZ0ZXIoJzxzcGFuIHRpdGxlPSJTT1g6IHRoaXMgdXNlciBpcyB1bnJlZ2lzdGVyZWQiIGNsYXNzPSJzb3gtcXVpY2tBdXRob3JJbmZvLXVucmVnaXN0ZXJlZCI+KHVucmVnaXN0ZXJlZCk8L3NwYW4+Jyk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgICQoJ3RpbWUudGltZWFnbycpLnRpbWVhZ28oKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZ2V0SWRzQW5kQWRkRGV0YWlscyhwb3N0QXV0aG9ycykgewogICAgICAgIGNvbnN0IEZJTFRFUl9VU0VSX0xBU1RTRUVOX1RZUEUgPSAnISpNeEwySDJWcDNpUElLTHUnOwoKICAgICAgICAkKCcudXNlci1kZXRhaWxzIGFbaHJlZl49Ii91c2VycyJdJykuZWFjaChmdW5jdGlvbigpIHsKCiAgICAgICAgICBsZXQgdXNlcmlkOyBsZXQgdXNlcm5hbWU7CgogICAgICAgICAgaWYgKHRoaXMpIHsKICAgICAgICAgICAgdXNlcmlkID0gc294LmhlbHBlcnMuZ2V0SURGcm9tQW5jaG9yKHRoaXMpOwogICAgICAgICAgICB1c2VybmFtZSA9IHRoaXMuaW5uZXJUZXh0OwoKICAgICAgICAgICAgaWYgKHVzZXJpZCA+IDApIHBvc3RBdXRob3JzW3VzZXJpZF0gPSB1c2VybmFtZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNveC5sb2dpbmZvKCdDb3VsZCBub3QgZmluZCB1c2VyIHVzZXIgbGluayBmb3I6ICcsIHRoaXMpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBzb3guaGVscGVycy5nZXRGcm9tQVBJKHsKICAgICAgICAgIGVuZHBvaW50OiAndXNlcnMnLAogICAgICAgICAgaWRzOiBPYmplY3Qua2V5cyhwb3N0QXV0aG9ycyksCiAgICAgICAgICBzaXRlbmFtZTogc294LnNpdGUuY3VycmVudEFwaVBhcmFtZXRlciwKICAgICAgICAgIGZpbHRlcjogRklMVEVSX1VTRVJfTEFTVFNFRU5fVFlQRSwKICAgICAgICAgIHNvcnQ6ICdjcmVhdGlvbicsCiAgICAgICAgICBmZWF0dXJlSWQ6ICdxdWlja0F1dGhvckluZm8nLAogICAgICAgIH0sIGl0ZW1zID0+IHsKICAgICAgICAgIGNvbnN0IHVzZXJEZXRhaWxzRnJvbUFQSSA9IHt9OwogICAgICAgICAgaXRlbXMuZm9yRWFjaCh1c2VyID0+IHsKICAgICAgICAgICAgdXNlckRldGFpbHNGcm9tQVBJW3VzZXIudXNlcl9pZF0gPSB7CiAgICAgICAgICAgICAgJ2xhc3Rfc2Vlbic6IHVzZXIubGFzdF9hY2Nlc3NfZGF0ZSAqIDEwMDAsCiAgICAgICAgICAgICAgJ3R5cGUnOiB1c2VyLnVzZXJfdHlwZSwKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwoKICAgICAgICAgIHNveC5kZWJ1ZygncXVpY2tBdXRob3JJbmZvIHVzZXJEZXRhaWxzRnJvbUFQSScsIHVzZXJEZXRhaWxzRnJvbUFQSSk7CiAgICAgICAgICBhZGRMYXN0U2Vlbih1c2VyRGV0YWlsc0Zyb21BUEkpOwoKICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCdzb3gtbmV3LWNvbW1lbnQnLCAoKSA9PiB7IC8vbWFrZSBzdXJlIGl0IGRvZXNuJ3QgZGlzYXBwZWFyIHdoZW4gYWRkaW5nIGEgbmV3IGNvbW1lbnQhCiAgICAgICAgICAgIGFkZExhc3RTZWVuKHVzZXJEZXRhaWxzRnJvbUFQSSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8ga2V5OmlkLCB2YWx1ZTp1c2VybmFtZQogICAgICBjb25zdCBwb3N0QXV0aG9ycyA9IHt9OwoKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctcmV2aWV3LXBvc3QtYXBwZWFyZWQnLCAoKSA9PiB7CiAgICAgICAgZ2V0SWRzQW5kQWRkRGV0YWlscyhwb3N0QXV0aG9ycyk7CiAgICAgIH0pOwoKICAgICAgZ2V0SWRzQW5kQWRkRGV0YWlscyhwb3N0QXV0aG9ycyk7CiAgICB9LAoKICAgIGhpZGRlbkNvbW1lbnRzSW5kaWNhdG9yOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IERhcmtlbnMgdGhlIGJvcmRlciB1bmRlcm5lYXRoIGNvbW1lbnRzIGlmIHRoZXJlIGFyZSBoaWRkZW4gY29tbWVudHMgdW5kZXJuZWF0aCBpdAoKICAgICAgJCgnLnF1ZXN0aW9uLCAuYW5zd2VyJykuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICBpZiAoJCh0aGlzKS5maW5kKCcuanMtc2hvdy1saW5rLmNvbW1lbnRzLWxpbms6dmlzaWJsZScpLmxlbmd0aCkgewogICAgICAgICAgY29uc3QgcG9zdElkID0gJCh0aGlzKS5hdHRyKCdkYXRhLXF1ZXN0aW9uaWQnKSB8fCAkKHRoaXMpLmF0dHIoJ2RhdGEtYW5zd2VyaWQnKTsKICAgICAgICAgIGNvbnN0IHggPSBbXTsKICAgICAgICAgIGNvbnN0IHkgPSBbXTsKICAgICAgICAgIGNvbnN0IHByb3RvY29sID0gbG9jYXRpb24ucHJvdG9jb2w7CiAgICAgICAgICBjb25zdCBob3N0bmFtZSA9IGxvY2F0aW9uLmhvc3RuYW1lOwogICAgICAgICAgY29uc3QgYmFzZVVybCA9IHByb3RvY29sICsgJy8vJyArIGhvc3RuYW1lOwoKICAgICAgICAgICQuZ2V0KGJhc2VVcmwgKyAnL3Bvc3RzLycgKyBwb3N0SWQgKyAnL2NvbW1lbnRzJywgZCA9PiB7CiAgICAgICAgICAgIGNvbnN0ICRjb21tZW50Q29weSA9ICQoJyNjb21tZW50cy0nICsgcG9zdElkICsgJyAuY29tbWVudC10ZXh0IC5jb21tZW50LWNvcHknKTsKCiAgICAgICAgICAgICQoZCkuZmluZCgnLmNvbW1lbnQtdGV4dCcpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgeC5wdXNoKCQodGhpcykuZmluZCgnLmNvbW1lbnQtY29weScpLnRleHQoKSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgJGNvbW1lbnRDb3B5LmZpbHRlcihkID0+IHsKICAgICAgICAgICAgICB5LnB1c2goeC5pbmRleE9mKCRjb21tZW50Q29weS5lcShkKS50ZXh0KCkpKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBpZiAoeVtpXSAhPSB5W2kgKyAxXSAtIDEpIHsKICAgICAgICAgICAgICAgICRjb21tZW50Q29weS5maWx0ZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiAkKHRoaXMpLnRleHQoKSA9PSB4W3lbaV1dOwogICAgICAgICAgICAgICAgfSkucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuZmluZCgnLmNvbW1lbnQtYWN0aW9ucywgLmNvbW1lbnQtdGV4dCcpLmNzcygnYm9yZGVyLWJvdHRvbS1jb2xvcicsICdncmF5Jyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBob3ROZXR3b3JrUXVlc3Rpb25zRmlsdGVyaW5nOiBmdW5jdGlvbihzZXR0aW5ncykgewogICAgICAvLyBEZXNjcmlwdGlvbjogRmlsdGVyIGhvdCBuZXR3b3JrIHF1ZXN0aW9ucyBpbiB0aGUgc2lkZWJhciBiYXNlZCBvbiB0aGVpciBhdHRyaWJ1dGVzIHN1Y2ggYXMgdGl0bGUsIHNpdGUsIGV0Yy4KCiAgICAgIGZ1bmN0aW9uIGNyZWF0ZVJlZ2V4KGxpc3QpIHsKICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cCgnXFxiJyArIGxpc3QucmVwbGFjZSgnLCcsICd8JykucmVwbGFjZSgnICcsICcnKSArICdcXGInLCAnaScpOwogICAgICB9CgogICAgICBjb25zdCBXT1JEU19UT19CTE9DSyA9IHNldHRpbmdzLndvcmRzVG9CbG9jazsKICAgICAgbGV0IFNJVEVTX1RPX0JMT0NLID0gc2V0dGluZ3Muc2l0ZXNUb0Jsb2NrOwogICAgICBjb25zdCBUSVRMRVNfVE9fSElERSA9IHNldHRpbmdzLnRpdGxlc1RvSGlkZVJlZ2V4ICYmIHNldHRpbmdzLnRpdGxlc1RvSGlkZVJlZ2V4LnNwbGl0KCcsJyk7CgogICAgICBpZiAoU0lURVNfVE9fQkxPQ0spIFNJVEVTX1RPX0JMT0NLID0gU0lURVNfVE9fQkxPQ0suc3BsaXQoJywnKTsKCiAgICAgICQoJyNob3QtbmV0d29yay1xdWVzdGlvbnMgbGkgYScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgbGV0IGk7CgogICAgICAgIC8vIE5PVEU6IHRvIGhpZGUgcXVlc3Rpb25zLCB3ZSB1c2UgYSBjbGFzcyB0aGF0IGhhcyAnZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Jy4KICAgICAgICAvLyBUaGlzIGlzIHRvIG1ha2Ugc3VyZSBxdWVzdGlvbnMgdGhhdCB3ZXJlIHByZXZpb3VzbHkgaGlkZGVuIGRvbid0IGFwcGVhciBhZnRlcgogICAgICAgIC8vIHRoZSB1c2VyIGNsaWNrcyAnbW9yZSBob3QgcXVlc3Rpb25zJywgYmVjYXVzZSB0aGUgcXVlc3Rpb25zIGFyZSAqYWxyZWFkeSogb24KICAgICAgICAvLyB0aGUgcGFnZSBiZWZvcmUgdGhlIGJ1dHRvbiBpcyBjbGlja2VkLCBidXQganVzdCBoaWRkZW4hCgogICAgICAgIGlmIChXT1JEU19UT19CTE9DSykgewogICAgICAgICAgaWYgKGNyZWF0ZVJlZ2V4KFdPUkRTX1RPX0JMT0NLKS50ZXN0KHRoaXMuaW5uZXJUZXh0KSkgJCh0aGlzKS5wYXJlbnQoKS5hZGRDbGFzcygnc294LWhvdC1uZXR3b3JrLXF1ZXN0aW9uLWZpbHRlci1oaWRlJyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoU0lURVNfVE9fQkxPQ0spIHsKICAgICAgICAgIGNvbnN0IGhyZWYgPSB0aGlzLmhyZWY7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFNJVEVTX1RPX0JMT0NLLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzb3gubG9jYXRpb24ubWF0Y2hXaXRoUGF0dGVybihTSVRFU19UT19CTE9DS1tpXSwgaHJlZikpIHsKICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKCdzb3gtaG90LW5ldHdvcmstcXVlc3Rpb24tZmlsdGVyLWhpZGUnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKFRJVExFU19UT19ISURFKSB7CiAgICAgICAgICBjb25zdCB0aXRsZSA9IHRoaXMuaW5uZXJUZXh0OwogICAgICAgICAgZm9yIChpID0gMDsgaSA8IFRJVExFU19UT19ISURFLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0aXRsZS5tYXRjaChuZXcgUmVnRXhwKFRJVExFU19UT19ISURFW2ldKSkpIHsKICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmhpZGUoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIHdhcm5Ob3RMb2dnZWRJbjogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBBZGQgYSBzbWFsbCBub3RpY2UgYXQgdGhlIGJvdHRvbSBsZWZ0IG9mIHRoZSBzY3JlZW4gaWYgeW91IGFyZSBub3QgbG9nZ2VkIGluIHdoZW4gYnJvd3NpbmcgYW4gU0Ugc2l0ZQoKICAgICAgY29uc3QgZGl2ID0gJCgnPGRpdi8+JywgewogICAgICAgIGlkOiAnbG9nZ2VkSW5SZW1pbmRlcicsCiAgICAgICAgc3R5bGU6ICdwb3NpdGlvbjogZml4ZWQ7IHJpZ2h0OiAwOyBib3R0b206IDUwcHg7IGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjAwLCAyMDAsIDIwMCwgMSk7IHdpZHRoOiAyMDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiA1cHg7IGNvbG9yOiBibGFjazsgZm9udC13ZWlnaHQ6Ym9sZCcsCiAgICAgICAgaHRtbDogJ1NPWDogWW91IGFyZSBub3QgbG9nZ2VkIGluLiBZb3Ugc2hvdWxkIDxhIGhyZWY9Ii91c2Vycy9sb2dpbiI+bG9nIGluPC9hPiB0byBjb250aW51ZSBlbmpveWluZyBTRS4nLAogICAgICB9KTsKCiAgICAgIGZ1bmN0aW9uIGNoZWNrQW5kQWRkUmVtaW5kZXIoKSB7CiAgICAgICAgaWYgKCFzb3gudXNlci5sb2dnZWRJbiAmJiAhc294LmxvY2F0aW9uLm9uKCd3aW50ZXJiYXNoJykpIHsKICAgICAgICAgIGlmICghJCgnI2xvZ2dlZEluUmVtaW5kZXInKS5sZW5ndGgpICQoJy5jb250YWluZXInKS5hcHBlbmQoZGl2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgJCgnI2xvZ2dlZEluUmVtaW5kZXInKS5yZW1vdmUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY2hlY2tBbmRBZGRSZW1pbmRlcigpOwogICAgICBzZXRJbnRlcnZhbChjaGVja0FuZEFkZFJlbWluZGVyLCAzMDAwMDApOyAvLzUgbWlucwogICAgfSwKCiAgICBkaXNhYmxlVm90ZUJ1dHRvbnM6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogZGlzYWJsZXMgdm90ZSBidXR0b25zIG9uIHlvdXIgb3duIG9yIGRlbGV0ZWQgcG9zdHMsIHdoaWNoIHlvdSBjYW5ub3Qgdm90ZSBvbgogICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzMwOSwgaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8zMzUKCiAgICAgIC8vR3JheXMgb3V0IHZvdGVzLCB2b3RlIGNvdW50IGZvciBkZWxldGVkIHBvc3RzCiAgICAgIGlmICgkKCcuZGVsZXRlZC1hbnN3ZXInKS5sZW5ndGgpIHsKICAgICAgICAkKCcuZGVsZXRlZC1hbnN3ZXIgLnZvdGUtZG93bi1vZmYsIC5kZWxldGVkLWFuc3dlciAudm90ZS11cC1vZmYsIC5kZWxldGVkLWFuc3dlciAudm90ZS1jb3VudC1wb3N0JykuY3NzKHsKICAgICAgICAgICdjdXJzb3InOiAnZGVmYXVsdCcsCiAgICAgICAgICAnb3BhY2l0eSc6ICcwLjUnLAogICAgICAgICAgJ3BvaW50ZXItZXZlbnRzJzogJ25vbmUnLCAvL2Rpc2FibGVzIHRoZSBhbmNob3IgdGFnIChqUXVlcnkgb2ZmKCkgZG9lc24ndCB3b3JrKQogICAgICAgIH0pOwogICAgICB9CgogICAgICAvL0dyYXlzIG91dCB2b3RlcyBvbiBvd24gcG9zdHMKICAgICAgJCgnLmFuc3dlciwgLnF1ZXN0aW9uJykKICAgICAgICAuZmluZCgnLnVzZXItZGV0YWlsczpsYXN0IGEnKQogICAgICAgIC5maWx0ZXIoJ2FbaHJlZio9JyArIHNveC51c2VyLmlkICsgJ10nKQogICAgICAgIC5jbG9zZXN0KCcuYW5zd2VyLCAucXVlc3Rpb24nKQogICAgICAgIC5maW5kKCcudm90ZWNlbGwgYnV0dG9uW2NsYXNzKj0ianMtdm90ZSJdJykKICAgICAgICAubm90KCdbaWQqPSJ2b3RlLWFjY2VwdCJdJykgLy9odHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzE2NQogICAgICAgIC5yZW1vdmVDbGFzcygnc294LWJldHRlci1jc3MnKQogICAgICAgIC5jc3MoewogICAgICAgICAgJ2N1cnNvcic6ICdkZWZhdWx0JywKICAgICAgICAgICdvcGFjaXR5JzogJzAuNScsCiAgICAgICAgICAncG9pbnRlci1ldmVudHMnOiAnbm9uZScsIC8vZGlzYWJsZXMgdGhlIGFuY2hvciB0YWcgKGpRdWVyeSBvZmYoKSBkb2Vzbid0IHdvcmspCiAgICAgICAgfSkKICAgICAgICAucGFyZW50KCkuYXR0cigndGl0bGUnLCAnWW91IGNhbm5vdCB2b3RlIG9uIHlvdXIgb3duIHBvc3RzLicpOyAvLy5wYXJlbnQoKSBpcyB0byBhZGQgdGhlIHRpdGxlIHRvIHRoZSAudm90ZSBkaXYKICAgIH0sCgogICAgcmVwbHlUb093bkNoYXRNZXNzYWdlczogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBBZGRzIGEgcmVwbHkgYnV0dG9uIHRvIHlvdXIgb3duIGNoYXQgbWVzc2FnZXMgc28geW91IGNhbiByZXBseSB0byB5b3VyIG93biBtZXNzYWdlcyBlYXNpZXIgYW5kIHF1aWNrZXIKICAgICAgLy8gSSB1c2UgJChkb2N1bWVudCkub24gaW5zdGVhZCBvZiAuZWFjaCwgc2luY2UgdXNpbmcgLmVhY2ggd291bGRuJ3QgYXBwbHkgdG8gbWVzc2FnZXMgbG9hZGVkIHZpYSAiTG9hZCBtb3JlIG1lc3NhZ2VzIiBhbmQgIkxvYWQgdG8gbXkgbGFzdCBtZXNzYWdlIgoKICAgICAgJChkb2N1bWVudCkub24oJ21vdXNlZW50ZXInLCAnLm1pbmUgLm1lc3NhZ2UnLCBmdW5jdGlvbigpIHsKICAgICAgICAvL1JlbW92ZSBleGNlc3Mgc3BhY2luZyB0byB0aGUgbGVmdCBvZiB0aGUgYnV0dG9uIChieSBlbXB0eWluZyAubWV0YSwgd2hpY2ggaGFzICImbmJzcCIgaW4gaXQpLCBhbmQgc2V0IHRoZSBidXR0b24gY29sb3IgdG8gdGhlIGJhY2tncm91bmQgY29sb3IKICAgICAgICAkKHRoaXMpLmZpbmQoJy5tZXRhJykuZW1wdHkoKS5jc3MoewogICAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiAkKHRoaXMpLnBhcmVudCgpLmNzcygnYmFja2dyb3VuZC1jb2xvcicpLAogICAgICAgICAgJ3BhZGRpbmctcmlnaHQnOiAnMXB4JywKICAgICAgICB9KS5zaG93KCkuYXBwZW5kKHJlcGx5U3Bhbik7CiAgICAgICAgLy9UaGUgInBhZGRpbmctcmlnaHQ6IDFweCIgaXMgdG8gYXZvaWQgc29tZSB3ZWlyZCBidWcgSSBjYW4ndCBmaWd1cmUgb3V0IGhvdyB0byBmaXgKICAgICAgfSkub24oJ21vdXNlbGVhdmUnLCAnLm1pbmUgLm1lc3NhZ2UnLCBmdW5jdGlvbigpIHsKICAgICAgICAkKHRoaXMpLmZpbmQoJy5tZXRhJykuaGlkZSgpLmZpbmQoJy5uZXdyZXBseScpLnJlbW92ZSgpOwogICAgICB9KQoKICAgICAgLy9EbyB0aGUgc2FtZSB0aGluZyBpZiB5b3UgaG92ZXIgb3ZlciB0aGUgdGltZXN0YW1wCiAgICAgICAgLm9uKCdtb3VzZWVudGVyJywgJy5taW5lIC50aW1lc3RhbXAnLCBmdW5jdGlvbigpIHsKICAgICAgICAgICQodGhpcykubmV4dCgpLmZpbmQoJy5tZXRhJykuZW1wdHkoKS5jc3MoewogICAgICAgICAgICAnYmFja2dyb3VuZC1jb2xvcic6ICQodGhpcykucGFyZW50KCkuY3NzKCdiYWNrZ3JvdW5kLWNvbG9yJyksCiAgICAgICAgICAgICdwYWRkaW5nLXJpZ2h0JzogJzFweCcsCiAgICAgICAgICB9KS5zaG93KCkuYXBwZW5kKHJlcGx5U3Bhbik7CiAgICAgICAgfSkub24oJ21vdXNlbGVhdmUnLCAnLm1pbmUgLnRpbWVzdGFtcCcsIGZ1bmN0aW9uKCkgewogICAgICAgICAgJCh0aGlzKS5uZXh0KCkuZmluZCgnLm1ldGEnKS5oaWRlKCkuZmluZCgnLm5ld3JlcGx5JykucmVtb3ZlKCk7CiAgICAgICAgfSkKCiAgICAgICAgLm9uKCdjbGljaycsICcubmV3cmVwbHkuYWRkZWQtYnktc294JywgZSA9PiB7CiAgICAgICAgICBjb25zdCAkbWVzc2FnZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJy5tZXNzYWdlJyk7CiAgICAgICAgICBjb25zdCBpZCA9ICRtZXNzYWdlLmF0dHIoJ2lkJykuc3BsaXQoJy0nKVsxXTsKICAgICAgICAgIGNvbnN0IHJlc3QgPSAkKCcjaW5wdXQnKS5mb2N1cygpLnZhbCgpLnJlcGxhY2UoL146KFswLTldKylccysvLCAnJyk7CiAgICAgICAgICAkKCcjaW5wdXQnKS52YWwoJzonICsgaWQgKyAnICcgKyByZXN0KS5mb2N1cygpOwogICAgICAgIH0pOwoKICAgICAgY29uc3QgcmVwbHlTcGFuID0gJCgnPHNwYW4vPicsIHsKICAgICAgICBjbGFzczogJ25ld3JlcGx5IGFkZGVkLWJ5LXNveCcsCiAgICAgICAgJ3RpdGxlJzogJ2xpbmsgbXkgbmV4dCBjaGF0IG1lc3NhZ2UgYXMgYSByZXBseSB0byB0aGlzJywKICAgICAgfSk7CiAgICB9LAoKICAgIGhpZGVDZXJ0YWluUXVlc3Rpb25zOiBmdW5jdGlvbihzZXR0aW5ncykgewogICAgICAvLyBEZXNjcmlwdGlvbjogSGlkZSBjZXJ0YWluIHF1ZXN0aW9ucyBkZXBlbmRpbmcgb24geW91ciBjaG9pY2VzCgogICAgICBpZiAoc2V0dGluZ3MuZHVwbGljYXRlIHx8IHNldHRpbmdzLmNsb3NlZCB8fCBzZXR0aW5ncy5taWdyYXRlZCB8fCBzZXR0aW5ncy5vbkhvbGQpIHsKICAgICAgICAkKCcucXVlc3Rpb24tc3VtbWFyeScpLmVhY2goZnVuY3Rpb24oKSB7IC8vRmluZCB0aGUgcXVlc3Rpb25zIGFuZCBhZGQgdGhlaXIgaWQncyBhbmQgc3RhdHVzZXMgdG8gYW4gb2JqZWN0CiAgICAgICAgICBjb25zdCAkcXVlc3Rpb24gPSAkKHRoaXMpOwogICAgICAgICAgY29uc3QgJGFuY2hvciA9ICQodGhpcykuZmluZCgnLnN1bW1hcnkgYTplcSgwKScpOwogICAgICAgICAgY29uc3QgdGV4dCA9ICRhbmNob3IudGV4dCgpLnRyaW0oKTsKCiAgICAgICAgICBpZiAodGV4dC5zdWJzdHIodGV4dC5sZW5ndGggLSAxMSkgPT0gJ1tkdXBsaWNhdGVdJyB8fCAkcXVlc3Rpb24uYXR0cignZGF0YS1zb3gtcXVlc3Rpb24tc3RhdGUnKSA9PSAnZHVwbGljYXRlJykgewogICAgICAgICAgICBpZiAoc2V0dGluZ3MuZHVwbGljYXRlKSAkcXVlc3Rpb24uaGlkZSgpOwoKICAgICAgICAgIH0gZWxzZSBpZiAodGV4dC5zdWJzdHIodGV4dC5sZW5ndGggLSA4KSA9PSAnW2Nsb3NlZF0nIHx8ICRxdWVzdGlvbi5hdHRyKCdkYXRhLXNveC1xdWVzdGlvbi1zdGF0ZScpID09ICdjbG9zZWQnKSB7CiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5jbG9zZWQpICRxdWVzdGlvbi5oaWRlKCk7CgogICAgICAgICAgfSBlbHNlIGlmICh0ZXh0LnN1YnN0cih0ZXh0Lmxlbmd0aCAtIDEwKSA9PSAnW21pZ3JhdGVkXScgfHwgJHF1ZXN0aW9uLmF0dHIoJ2RhdGEtc294LXF1ZXN0aW9uLXN0YXRlJykgPT0gJ21pZ3JhdGVkJykgewogICAgICAgICAgICBpZiAoc2V0dGluZ3MubWlncmF0ZWQpICRxdWVzdGlvbi5oaWRlKCk7CgogICAgICAgICAgfSBlbHNlIGlmICh0ZXh0LnN1YnN0cih0ZXh0Lmxlbmd0aCAtIDkpID09ICdbb24gaG9sZF0nIHx8ICRxdWVzdGlvbi5hdHRyKCdkYXRhLXNveC1xdWVzdGlvbi1zdGF0ZScpID09ICdvbiBob2xkJykgewogICAgICAgICAgICBpZiAoc2V0dGluZ3Mub25Ib2xkKSAkcXVlc3Rpb24uaGlkZSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmIChzZXR0aW5ncy5kZWxldGVkQW5zd2VycykgewogICAgICAgIGNvbnN0IGxlbmd0aCA9ICQoJy5hbnN3ZXIuZGVsZXRlZC1hbnN3ZXInKS5oaWRlKCkubGVuZ3RoOwogICAgICAgICQoJy5hbnN3ZXJzLXN1YmhlYWRlciBoMicpLmFwcGVuZCgnICgnICsgbGVuZ3RoICsgJyBkZWxldGVkICYgaGlkZGVuKScpOwogICAgICB9CiAgICB9LAoKICAgIGlubGluZUVkaXRvckV2ZXJ5d2hlcmU6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogRW5hYmxlZCBpbmxpbmUgZWRpdG9yIG9uIGFsbCBzaXRlcwogICAgICAvLyBXcml0dGVuIGJ5IEBuaWNhZWw6IGh0dHA6Ly9zdGFja2FwcHMuY29tL3F1ZXN0aW9ucy82MjE2L2lubGluZS1lZGl0b3ItcmVnYXJkbGVzcy1vZi1yZXB1dGF0aW9uLCBhbmQgY29waWVkIHdpdGggbmljYWVsJ3MgcGVybWlzc2lvbgoKICAgICAgaWYgKHNveC5TdGFjaykgewogICAgICAgICQoJy5zdWdnZXN0LWVkaXQtcG9zdCcpLnJlbW92ZUNsYXNzKCdzdWdnZXN0LWVkaXQtcG9zdCcpLmFkZENsYXNzKCdlZGl0LXBvc3QnKTsKICAgICAgICBzb3guU3RhY2sudXNpbmcoJ2lubGluZUVkaXRpbmcnLCAoKSA9PiB7CiAgICAgICAgICBzb3guU3RhY2suaW5saW5lRWRpdGluZy5pbml0KCk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc294Lndhcm4oJ2lubGluZUVkaXRvckV2ZXJ5d2hlcmUgZXJyb3I6IHNveC5TdGFjay51c2luZyBub3QgZm91bmQnKTsKICAgICAgICBzb3guZGVidWcoJ2lubGluZUVkaXRvckV2ZXJ5d2hlcmU6IFN0YWNrIG9iamVjdDonLCBzb3guU3RhY2spOwogICAgICB9CiAgICB9LAoKICAgIGZsYWdQZXJjZW50YWdlQmFyOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFkZHMgYSBjb2xvdXJlZCBwZXJjZW50YWdlIGJhciBhYm92ZSB0aGUgcGFuZSBvbiB0aGUgcmlnaHQgb2YgdGhlIGZsYWcgc3VtbWFyeSBwYWdlIHRvIHNob3cgcGVyY2VudGFnZSBvZiBoZWxwZnVsIGZsYWdzCgogICAgICBsZXQgaGVscGZ1bEZsYWdzID0gMDsKICAgICAgJCgnbGkgPiBhOmNvbnRhaW5zKFwnaGVscGZ1bFwnKScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgaGVscGZ1bEZsYWdzICs9IHBhcnNlSW50KCQodGhpcykuZmluZCgnZGl2Omxhc3QnKS50ZXh0KCkucmVwbGFjZSgnLCcsICcnKSk7CiAgICAgIH0pOwoKICAgICAgbGV0IGRlY2xpbmVkRmxhZ3MgPSAwOwogICAgICAkKCdsaSA+IGE6Y29udGFpbnMoXCdkZWNsaW5lZFwnKScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgZGVjbGluZWRGbGFncyArPSBwYXJzZUludCgkKHRoaXMpLmZpbmQoJ2RpdjpsYXN0JykudGV4dCgpLnJlcGxhY2UoJywnLCAnJykpOwogICAgICB9KTsKCiAgICAgIGlmIChoZWxwZnVsRmxhZ3MgPiAwKSB7CiAgICAgICAgbGV0IHBlcmNlbnRIZWxwZnVsID0gTnVtYmVyKE1hdGgucm91bmQoKGhlbHBmdWxGbGFncyAvIChoZWxwZnVsRmxhZ3MgKyBkZWNsaW5lZEZsYWdzKSkgKiAxMDAgKyAnZTInKSArICdlLTInKTsKICAgICAgICBpZiAocGVyY2VudEhlbHBmdWwgPiAxMDApIHBlcmNlbnRIZWxwZnVsID0gMTAwOwoKICAgICAgICBsZXQgcGVyY2VudENvbG9yOwogICAgICAgIGlmIChwZXJjZW50SGVscGZ1bCA+PSA5MCkgewogICAgICAgICAgcGVyY2VudENvbG9yID0gJ2xpbWVncmVlbic7CiAgICAgICAgfSBlbHNlIGlmIChwZXJjZW50SGVscGZ1bCA+PSA4MCkgewogICAgICAgICAgcGVyY2VudENvbG9yID0gJ2RhcmtvcmFuZ2UnOwogICAgICAgIH0gZWxzZSBpZiAocGVyY2VudEhlbHBmdWwgPCA4MCkgewogICAgICAgICAgcGVyY2VudENvbG9yID0gJ3JlZCc7CiAgICAgICAgfQoKICAgICAgICAvL3RoaXMgaXMgZm9yIHRoZSBkeW5hbWljIHBhcnQ7IHRoZSByZXN0IG9mIHRoZSBDU1MgaXMgaW4gdGhlIG1haW4gQ1NTIGZpbGUKICAgICAgICBHTV9hZGRTdHlsZShgI3NveC1mbGFnUGVyY2VudFByb2dyZXNzQmFyOmFmdGVyIHsKICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICR7cGVyY2VudENvbG9yfTsKICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAke3BlcmNlbnRIZWxwZnVsfSU7CiAgICAgICAgICAgICAgICAgICAgfWApOwoKICAgICAgICAkKCcjZmxhZy1zdW1tYXJ5LWZpbHRlcicpLmFmdGVyKCc8aDMgaWQ9XCdzb3gtZmxhZ1BlcmNlbnRIZWxwZnVsXCcgdGl0bGU9XCdvbmx5IGhlbHBmdWwgYW5kIGRlY2xpbmVkIGZsYWdzIGFyZSBjb3VudGVkXCcgY2xhc3M9XCd3cmFwLWRpdlwnPjxzcGFuIGlkPVwncGVyY2VudFwnPicgKyBwZXJjZW50SGVscGZ1bCArICclPC9zcGFuPiBoZWxwZnVsPC9oMz4nKTsKICAgICAgICAkKCcjc294LWZsYWdQZXJjZW50SGVscGZ1bCBzcGFuI3BlcmNlbnQnKS5jc3MoJ2NvbG9yJywgcGVyY2VudENvbG9yKTsKCiAgICAgICAgJCgnI3NveC1mbGFnUGVyY2VudEhlbHBmdWwnKS5hZnRlcignPGRpdiBpZD1cJ3NveC1mbGFnUGVyY2VudFByb2dyZXNzQmFyXCcgY2xhc3M9XCd3cmFwLWRpdlwnPjwvZGl2PicpOwogICAgICAgICQoJy53cmFwLWRpdicpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCdzb3gtZmxhZ1BlcmNlbnRQcm9ncmVzc0Jhci1jb250YWluZXJcJz48L2Rpdj4nKTsKICAgICAgfQogICAgfSwKCiAgICBzaG93TWV0YVJldmlld0NvdW50OiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFkZHMgdGhlIHRvdGFsIGNvdW50IG9mIG1ldGEgcmV2aWV3cyBvbiB0aGUgbWFpbiBzaXRlIG9uIHRoZSAvcmV2aWV3IHBhZ2UKCiAgICAgIC8vIENPUlMgcHJveHkKICAgICAgY29uc3QgcHJveHlVcmwgPSAnaHR0cHM6Ly9jb3JzLWFueXdoZXJlLmhlcm9rdWFwcC5jb20vJzsKICAgICAgY29uc3QgbWV0YVVybCA9IHNveC5TdGFjay5vcHRpb25zLnNpdGUuY2hpbGRVcmw7CiAgICAgIGNvbnN0IHJlcXVlc3RVcmwgPSBwcm94eVVybCArIG1ldGFVcmwgKyAnL3Jldmlldyc7CgogICAgICAkLmdldChyZXF1ZXN0VXJsLCBkID0+IHsKICAgICAgICBjb25zdCAkZG9jID0gJChkKTsKICAgICAgICBsZXQgdG90YWwgPSAwOwoKICAgICAgICAkZG9jLmZpbmQoJyNjb250ZW50IC5ncmlkLmJ0IC5mcy1zdWJoZWFkaW5nJykuZWFjaCgoKSA9PiB0b3RhbCArPSArJCh0aGlzKS50ZXh0KCkpOwoKICAgICAgICBjb25zdCAkbGFzdFJldmlld1JvdyA9ICQoJyNjb250ZW50IC5ncmlkLmJ0JykubGFzdCgpOwoKICAgICAgICAvLyBDbG9uZSB0aGUgZXhpc3RpbmcgYm90dG9tLW1vc3QgcmV2aWV3IGRpdgogICAgICAgIGNvbnN0ICRtZXRhRGFzaGJvYXJkRWwgPSAkbGFzdFJldmlld1Jvdy5jbG9uZSgpOwoKICAgICAgICAvLyBDYWNoZSB0aGUgbGVmdCBhbmQgcmlnaHQgc2VjdGlvbnMsIGdldCBpbW1lZGlhdGUgZGl2cyBvbmx5IHdpdGggYD5gCiAgICAgICAgY29uc3QgJHNlY3Rpb25zID0gJG1ldGFEYXNoYm9hcmRFbC5maW5kKCc+ZGl2Jyk7CgogICAgICAgIGNvbnN0ICRsZWZ0U2VjdGlvbiA9ICRzZWN0aW9ucy5maXJzdCgpOwogICAgICAgIC8vIFNldCBudW1iZXIgb2YgcmV2aWV3cwogICAgICAgICRsZWZ0U2VjdGlvbi5maW5kKCcuZnMtc3ViaGVhZGluZycpLnRleHQodG90YWwpLmF0dHIoJ3RpdGxlJywgdG90YWwpOwogICAgICAgIC8vIFNldCAncmV2aWV3cycgdGV4dCAoaW5zdGVhZCBvZiBlLmcuICdlZGl0cycpCiAgICAgICAgJGxlZnRTZWN0aW9uLmZpbmQoJy5tdDInKS50ZXh0KCdyZXZpZXdzJyk7CgogICAgICAgIGNvbnN0ICRyaWdodFNlY3Rpb24gPSAkc2VjdGlvbnMubGFzdCgpOwogICAgICAgICRyaWdodFNlY3Rpb24uZmluZCgnYScpLmZpcnN0KCkudGV4dCgnTWV0YSBSZXZpZXdzJykuYXR0cignaHJlZicsIGAke21ldGFVcmx9L3Jldmlld2ApOwogICAgICAgICRyaWdodFNlY3Rpb24uZmluZCgnLmZzLWJvZHkyJykudGV4dCgnU09YOiBUb3RhbCByZXZpZXdzIGF2YWlsYWJsZSBvbiB0aGlzIHNpdGVcJ3MgbWV0YSBhdCB0aGUgbW9tZW50Jyk7CiAgICAgICAgLy8gUmVtb3ZlIHRoZSB1c2VyIGF2YXRhcnMgZnJvbSB0aGUgbmV3IHJvdwogICAgICAgICRyaWdodFNlY3Rpb24uZmluZCgnPmRpdicpLmxhc3QoKS5yZW1vdmUoKTsKCiAgICAgICAgJGxhc3RSZXZpZXdSb3cuYWZ0ZXIoJG1ldGFEYXNoYm9hcmRFbCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBjb3B5Q29kZTogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBBZGQgYSBidXR0b24gdG8gY29kZSBpbiBwb3N0cyB0byBsZXQgeW91IGNvcHkgaXQKCiAgICAgIC8vYnV0dG9uIHVzZXMgQ1NTIG1haW5seSBmcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzMwODEwMzIyLzM1NDE4ODEKICAgICAgZnVuY3Rpb24gYWRkQnV0dG9uKCkgewogICAgICAgIC8vaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8yMTgjaXNzdWVjb21tZW50LTI4MTE0ODMyNyByZWFzb24gZm9yIHNlbGVjdG9yOgogICAgICAgIC8vaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTEwNjE2NTcvMzU0MTg4MQoKICAgICAgICAkKCdwcmU6bm90KDpoYXMoLnNveC1jb3B5Q29kZUJ1dHRvbikpJykuYmVmb3JlKHNveC5zcHJpdGVzLmdldFN2ZygnY29weScsICdDb3B5IGNvZGUgdG8gY2xpcGJvYXJkIChTT1gpJykuYWRkQ2xhc3MoJ3NveC1jb3B5Q29kZUJ1dHRvbicpKTsKCiAgICAgICAgJCgncHJlJykuaG92ZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgICAkKHRoaXMpLnByZXYoJy5zb3gtY29weUNvZGVCdXR0b24nKS5zaG93KCk7CiAgICAgICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAkKHRoaXMpLnByZXYoJy5zb3gtY29weUNvZGVCdXR0b24nKS5oaWRlKCk7CiAgICAgICAgfSk7CgogICAgICAgICQoJy5zb3gtY29weUNvZGVCdXR0b24nKS5ob3ZlcihmdW5jdGlvbigpIHsKICAgICAgICAgICQodGhpcykuc2hvdygpOwogICAgICAgIH0sIGZ1bmN0aW9uKCkgewogICAgICAgICAgJCh0aGlzKS5oaWRlKCk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGFkZEJ1dHRvbigpOwogICAgICAkKGRvY3VtZW50KS5vbignc294LW5ldy1yZXZpZXctcG9zdC1hcHBlYXJlZCcsIGFkZEJ1dHRvbik7CgogICAgICAkKGRvY3VtZW50KS5vbignY2xpY2snLCAnLnNveC1jb3B5Q29kZUJ1dHRvbicsIGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0IGNvcHlDb2RlVGV4dGFyZWFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc294LWNvcHlDb2RlVGV4dGFyZWEnKTsKICAgICAgICBpZiAoIWNvcHlDb2RlVGV4dGFyZWFzLmxlbmd0aCkgJCgnYm9keScpLmFwcGVuZCgnPHRleHRhcmVhIGNsYXNzPSJzb3gtY29weUNvZGVUZXh0YXJlYSI+Jyk7CgogICAgICAgIGNvbnN0IHRleHRUb0NvcHkgPSAkKHRoaXMpLm5leHQoJ3ByZScpLnRleHQoKTsKICAgICAgICBjb3B5Q29kZVRleHRhcmVhc1swXS52YWx1ZSA9IHRleHRUb0NvcHk7CiAgICAgICAgY29weUNvZGVUZXh0YXJlYXNbMF0uc2VsZWN0KCk7CiAgICAgICAgR01fc2V0Q2xpcGJvYXJkKHRleHRUb0NvcHkpOwogICAgICAgICQodGhpcykuZWZmZWN0KCdoaWdobGlnaHQnLCB7CiAgICAgICAgICBjb2xvcjogJ3doaXRlJywKICAgICAgICB9LCAzMDAwKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGRhaWx5UmV2aWV3QmFyOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFkZHMgYSBwcm9ncmVzcyBiYXIgc2hvd2luZyBob3cgbWFueSByZXZpZXdzIHlvdSBoYXZlIGxlZnQgaW4gdGhlIGRheQoKICAgICAgZnVuY3Rpb24gYWRkQmFyKCkgewogICAgICAgICQuZ2V0KGBodHRwczovLyR7bG9jYXRpb24uaG9zdG5hbWV9L3Jldmlldy8ke2xvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJylbMl19L3N0YXRzYCwgZCA9PiB7CiAgICAgICAgICBjb25zdCBjb3VudCA9ICskKGQpLmZpbmQoJy5yZXZpZXctc3RhdHMtY291bnQtY3VycmVudC11c2VyJykuZmlyc3QoKS50ZXh0KCkudHJpbSgpOwogICAgICAgICAgY29uc3Qgd2lkdGggPSBjb3VudCA8PSAyMCA/IChjb3VudCAvIDIwKSAqIDEwMCA6IChjb3VudCAvIDQwKSAqIDEwMDsKICAgICAgICAgIGNvbnN0ICRzb3hEYWlseVJldmlld0NvdW50ID0gJCgnI3NveC1kYWlseS1yZXZpZXctY291bnQnKTsKCiAgICAgICAgICBpZiAoJCgnI3NveC1kYWlseVJldmlld0JhcicpLmxlbmd0aCkgcmV0dXJuOwogICAgICAgICAgJCgnI2JhZGdlLXByb2dyZXNzJykuYWZ0ZXIoCiAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJncmlkIGMtcG9pbnRlciBmbG9hdC1yaWdodCBtdDE2IGgxMiIgaWQ9InNveC1kYWlseVJldmlld0JhciI+CiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZ3JpZC0tY2VsbCBtcjQgZnMtY2FwdGlvbiI+JHtjb3VudH08L2Rpdj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImdyaWQtLWNlbGwgaDEyIHB0MiI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzLXByb2dyZXNzIG1yMTYgaDggd3MxIj4KICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icy1wcm9ncmVzcy0tYmFyIGg4IiByb2xlPSJwcm9ncmVzc2JhciIgYXJpYS12YWx1ZW5vdz0iMTAwIiBhcmlhLXZhbHVlbWluPSIwIiBhcmlhLXZhbHVlbWF4PSIxMDAiIHN0eWxlPSJ3aWR0aDogJHt3aWR0aH0lIj48L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj5gCiAgICAgICAgICApOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBhZGRCYXIoKTsKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctcmV2aWV3LXBvc3QtYXBwZWFyZWQnLCBhZGRCYXIpOwogICAgfSwKCiAgICBvcGVuTGlua3NJbk5ld1RhYjogZnVuY3Rpb24oc2V0dGluZ3MpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IE9wZW4gYW55IGxpbmtzIHRvIHRoZSBzcGVjaWZpZWQgc2l0ZXMgaW4gYSBuZXcgdGFiIGJ5IGRlZmF1bHQKCiAgICAgIHNldHRpbmdzID0gc2V0dGluZ3MubGlua3NUb09wZW5Jbk5ld1RhYjsKICAgICAgaWYgKCFzZXR0aW5ncykgcmV0dXJuOwoKICAgICAgc2V0dGluZ3MgPSBzZXR0aW5ncy5yZXBsYWNlKCcgJywgJycpLnNwbGl0KCcsJyk7CiAgICAgIGlmIChzZXR0aW5ncy5sZW5ndGgpIHsgLy9odHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzMwMAogICAgICAgICQoJy5wb3N0LXRleHQgYScpLmVhY2goZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zdCBocmVmID0gJCh0aGlzKS5hdHRyKCdocmVmJyk7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNldHRpbmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzb3gubG9jYXRpb24ubWF0Y2hXaXRoUGF0dGVybihzZXR0aW5nc1tpXSwgaHJlZikpIHsKICAgICAgICAgICAgICAkKHRoaXMpLmFwcGVuZChzb3guc3ByaXRlcy5nZXRTdmcoJ2xhdW5jaCcsICdTT1g6IHRoaXMgbGluayB3aWxsIG9wZW4gaW4gYSBuZXcgdGFiJykuYWRkQ2xhc3MoJ3NveC1vcGVuTGlua3NJbk5ld1RhYi1leHRlcm5hbExpbmsnKSk7CiAgICAgICAgICAgICAgJCh0aGlzKS5wcm9wKCd0YXJnZXQnLCAnX2JsYW5rJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICBmaW5kQW5kUmVwbGFjZTogZnVuY3Rpb24oKSB7IC8vU2FsdmFnZWQgZnJvbSBvbGQgJ2VuaGFuY2VkIGVkaXRvcicgZmVhdHVyZQogICAgICAvLyBEZXNjcmlwdGlvbjogYWRkcyBhICdmaW5kIGFuZCByZXBsYWNlJyBvcHRpb24gdG8gdGhlIG1hcmtkb3duIGVkaXRvcgoKICAgICAgZnVuY3Rpb24gc3RhcnRMb29wKCkgewogICAgICAgICQoJ3RleHRhcmVhW2lkXj0id21kLWlucHV0Il0ucHJvY2Vzc2VkJykuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgIG1haW4oJCh0aGlzKS5hdHRyKCdpZCcpKTsKICAgICAgICB9KTsKCiAgICAgICAgJCgnLmVkaXQtcG9zdCcpLmNsaWNrKGZ1bmN0aW9uKCkgewogICAgICAgICAgY29uc3QgJHRoYXQgPSAkKHRoaXMpOwogICAgICAgICAgY29uc3QgdGFyZ2V0UXVlc3Rpb25DZWxscyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Bvc3RjZWxsJyk7CiAgICAgICAgICBjb25zdCB0YXJnZXRBbnN3ZXJDZWxscyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Fuc3dlcmNlbGwnKTsKICAgICAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUoWy4uLnRhcmdldFF1ZXN0aW9uQ2VsbHMsIC4uLnRhcmdldEFuc3dlckNlbGxzXSwgJyN3bWQtcmVkby1idXR0b24tJyArICR0aGF0LmF0dHIoJ2hyZWYnKS5zcGxpdCgnLycpWzJdLCAoKSA9PiB7CiAgICAgICAgICAgIG1haW4oJHRoYXQucGFyZW50cygndGFibGUnKS5maW5kKCcuaW5saW5lLWVkaXRvciB0ZXh0YXJlYS5wcm9jZXNzZWQnKS5hdHRyKCdpZCcpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmdW5jdGlvbiBtYWluKHdtZCkgewogICAgICAgIGNvbnN0IHMgPSAnIycgKyB3bWQ7IC8vcyBpcyB0aGUgc2VsZWN0b3Igd2UgcGFzcyBvbnRvIGVhY2ggZnVuY3Rpb24gc28gdGhlIGFjdGlvbiBpcyBhcHBsaWVkIHRvIHRoZSBjb3JyZWN0IHRleHRhcmVhIChhbmQgbm90LCBmb3IgZXhhbXBsZSB0aGUgJ2FkZCBhbnN3ZXInIHRleHRhcmVhICphbmQqIHRoZSAnZWRpdCcgdGV4dGFyZWEhKQogICAgICAgIGlmICgkKHMpLnBhcmVudHMoJy53bWQtY29udGFpbmVyJykuZmluZCgnI2ZpbmRSZXBsYWNlJykubGVuZ3RoKSByZXR1cm47CgogICAgICAgICQoJy53bWQtYnV0dG9uLWJhcicpLmNzcygnbWFyZ2luLXRvcCcsICcwJyk7IC8vaHR0cHM6Ly9naXRodWIuY29tL3Nvc2NyaXB0ZWQvc294L2lzc3Vlcy8yMDMKCiAgICAgICAgJChzKS5iZWZvcmUoJzxkaXYgY2xhc3M9XCdmaW5kUmVwbGFjZVRvb2xiYXJcJz48c3BhbiBpZD1cJ2ZpbmRSZXBsYWNlXCc+RmluZCAmIFJlcGxhY2U8L3NwYW4+PC9kaXY+Jyk7CgogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcjZmluZFJlcGxhY2UnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICBpZiAoJCgnLmZpbmRSZXBsYWNlSW5wdXRzJykubGVuZ3RoKSB7CiAgICAgICAgICAgICQoJy5maW5kUmVwbGFjZUlucHV0cycpLnJlbW92ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5hcHBlbmQoJzxkaXYgY2xhc3M9XCdmaW5kUmVwbGFjZUlucHV0c1wnPjxpbnB1dCBpZD1cJ2ZpbmRcJyB0eXBlPVwndGV4dFwnIHBsYWNlaG9sZGVyPVwnRmluZFwnPjxpbnB1dCBpZD1cJ21vZGlmaWVyXCcgdHlwZT1cJ3RleHRcJyBwbGFjZWhvbGRlcj1cJ01vZGlmaWVyXCc+PGlucHV0IGlkPVwncmVwbGFjZVwnIHR5cGU9XCd0ZXh0XCcgcGxhY2Vob2xkZXI9XCdSZXBsYWNlIHdpdGhcJz48aW5wdXQgaWQ9XCdyZXBsYWNlR29cJyB0eXBlPVwnYnV0dG9uXCcgdmFsdWU9XCdHb1wnPjwvZGl2PicpOwogICAgICAgICAgfQogICAgICAgICAgJChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5maW5kUmVwbGFjZVRvb2xiYXIgI3JlcGxhY2VHbycsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoJCgnLmZpbmRSZXBsYWNlVG9vbGJhciAjZmluZCcpLnZhbCgpLCAkKCcuZmluZFJlcGxhY2VUb29sYmFyICNtb2RpZmllcicpLnZhbCgpKTsKICAgICAgICAgICAgY29uc3Qgb2xkdmFsID0gJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCd0ZXh0YXJlYScpLnZhbCgpOwogICAgICAgICAgICBjb25zdCBuZXd2YWwgPSBvbGR2YWwucmVwbGFjZShyZWdleCwgJCgnLmZpbmRSZXBsYWNlVG9vbGJhciAjcmVwbGFjZScpLnZhbCgpKTsKICAgICAgICAgICAgJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCd0ZXh0YXJlYScpLnZhbChuZXd2YWwpOwoKICAgICAgICAgICAgaWYgKHNveC5TdGFjay5NYXJrZG93bkVkaXRvcikgc294LlN0YWNrLk1hcmtkb3duRWRpdG9yLnJlZnJlc2hBbGxQcmV2aWV3cygpOwogICAgICAgICAgfSk7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIH0pOwoKICAgICAgICAkKHMpLmtleWRvd24oZSA9PiB7CiAgICAgICAgICBpZiAoZS53aGljaCA9PSA3MCAmJiBlLmN0cmxLZXkpIHsgLy9jdHJsK2YgKGZpbmQrcmVwbGFjZSkKICAgICAgICAgICAgJCgnI2ZpbmRSZXBsYWNlJykudHJpZ2dlcignY2xpY2snKTsKICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgJChkb2N1bWVudCkub24oJ3NveC1lZGl0LXdpbmRvdycsIHN0YXJ0TG9vcCk7CiAgICAgIHN0YXJ0TG9vcCgpOwogICAgfSwKCiAgICBvbmx5U2hvd0NvbW1lbnRBY3Rpb25zT25Ib3ZlcjogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBPbmx5IHNob3cgdGhlIGNvbW1lbnQgYWN0aW9ucyAoZmxhZy91cHZvdGUpIHdoZW4gaG92ZXJpbmcgb3ZlciBhIGNvbW1lbnQKCiAgICAgIGZ1bmN0aW9uIGFkZENTUygpIHsKICAgICAgICAvLyBEZWxheSBuZWVkZWQgYmVjYXVzZSBvZiBodHRwczovL2dpdGh1Yi5jb20vc29zY3JpcHRlZC9zb3gvaXNzdWVzLzM3OSNpc3N1ZWNvbW1lbnQtNDYwMDAxODU0CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiAkKCcuY29tbWVudCcpLmFkZENsYXNzKCdzb3gtb25seVNob3dDb21tZW50QWN0aW9uc09uSG92ZXInKSwgMTAwKTsKICAgICAgfQoKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1uZXctY29tbWVudCcsIGFkZENTUyk7CiAgICAgIGFkZENTUygpOwogICAgfSwKCiAgICBzaG93VGFnV2lraUxpbmtPblRhZ1BvcHVwOiBmdW5jdGlvbigpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEFkZCBhICd3aWtpJyBsaW5rIHRvIHRoZSBuZXcgdGFnIHBvcHVwcyB0aGF0IGFwcGVhciBvbiBob3ZlcgoKICAgICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnF1ZXN0aW9uLXBhZ2UnKTsKICAgICAgc294LmhlbHBlcnMub2JzZXJ2ZSh0YXJnZXQsICcudGFnLXBvcHVwJywgKCkgPT4gewogICAgICAgIC8vZXh0cmFjdCBmcm9tIGZlZWQgVVJMIGJ1dHRvbgogICAgICAgIGNvbnN0IHRhZ05hbWUgPSAkKCcudGFnLXBvcHVwIC5mbG9hdC1yaWdodCBhJykuYXR0cignaHJlZicpLm1hdGNoKCcvZmVlZHMvdGFnLyguKiknKVsxXTsKICAgICAgICBjb25zdCB3aWtpVXJsID0gJy8vJyArIHNveC5zaXRlLnVybCArICcvdGFncy8nICsgdGFnTmFtZSArICcvaW5mbyc7CgogICAgICAgICQoJy50YWctcG9wdXAgLm1yODpsYXN0JykuYWZ0ZXIoJCgnPHNwYW4vPicsIHsKICAgICAgICAgICdjbGFzcyc6ICdzb3gtdGFnLXBvcHVwLXdpa2ktbGluaycsCiAgICAgICAgICAnaHRtbCc6ICc8YSBocmVmPSInICsgd2lraVVybCArICciPndpa2k8L2E+JywKICAgICAgICAgICd0aXRsZSc6ICd2aWV3IHRhZyB3aWtpIChhZGRlZCBieSBTT1gpJywKICAgICAgICB9KSk7CiAgICAgIH0pOwogICAgfSwKCiAgICBhZGRUaW1lbGluZUFuZFJldmlzaW9uTGlua3M6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogQWRkIHJldmlzaW9uIGxpbmsgdG8gdGhlIGJvdHRvbSBvZiBlYWNoIHBvc3QgZm9yIHF1aWNrIGFjY2VzcwoKICAgICAgLy8gTm90ZTogVGhpcyBmZWF0dXJlIHVzZWQgdG8gYWRkIGEgdGltZWxpbmUgYnV0dG9uIHRvbywgYnV0IHRoaXMgd2FzIG5hdGl2ZWx5CiAgICAgIC8vIGltcGxlbWVudGVkIGFzIG9mIDIwMjAtMTYtMDEsIHNlZSBodHRwczovL21ldGEuc3RhY2tleGNoYW5nZS5jb20vYS8zNDIzMTYuCiAgICAgIC8vIFRoZSBmdW5jdGlvbiBuYW1lIGlzIHVuY2hhbmdlZCB0byBuZXdlciB2ZXJzaW9ucyBkb24ndCBhdXRvLXJlbW92ZSB0aGUgZmVhdHVyZQogICAgICAvLyBmb3IgdXNlcnMgd2l0aCBpdCBlbmFibGVkCgogICAgICAkKCcucXVlc3Rpb24sIC5hbnN3ZXInKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBjb25zdCBpZCA9ICQodGhpcykuYXR0cignZGF0YS1xdWVzdGlvbmlkJykgfHwgJCh0aGlzKS5hdHRyKCdkYXRhLWFuc3dlcmlkJyk7CiAgICAgICAgJCh0aGlzKS5maW5kKCcucG9zdC1tZW51JykuYXBwZW5kKCQoJzxhLz4nLCB7CiAgICAgICAgICAnaHJlZic6ICcvLycgKyBzb3guc2l0ZS51cmwgKyAnL3Bvc3RzLycgKyBpZCArICcvcmV2aXNpb25zJywKICAgICAgICAgICd0ZXh0JzogJ3JldmlzaW9ucycsCiAgICAgICAgfSkpOwogICAgICB9KTsKICAgIH0sCgogICAgaGlkZVdlbGNvbWVCYWNrTWVzc2FnZTogZnVuY3Rpb24oKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBIaWRlIHRoZSAnd2VsY29tZSBiYWNrLi4uZG9uJ3QgZm9yZ2V0IHRvIHZvdGUnIG1lc3NhZ2Ugd2hlbiB2aXNpdGluZyBhIHNpdGUgYWZ0ZXIgYSB3aGlsZQoKICAgICAgZnVuY3Rpb24gcmVtb3ZlTWVzc2FnZShlbCkgewogICAgICAgIGlmICghZWwpIHJldHVybjsKICAgICAgICBpZiAoJChlbCkudGV4dCgpLm1hdGNoKC93ZWxjb21lIGJhY2svZ2kpKSB7CiAgICAgICAgICAkKGVsKS5yZW1vdmUoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHNveC5oZWxwZXJzLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgJyNvdmVybGF5LWhlYWRlcicsIGVsID0+IHJlbW92ZU1lc3NhZ2UoZWwpKTsKICAgICAgcmVtb3ZlTWVzc2FnZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheS1oZWFkZXInKSk7CiAgICB9LAoKICAgIGFkZE9uVG9waWNMaW5rVG9TaXRlU3dpdGNoZXI6IGZ1bmN0aW9uKCkgewogICAgICAvLyBEZXNjcmlwdGlvbjogUmVwbGFjZXMgJ2hlbHAnIHdpdGggYW4gJ29uLXRvcGljJyBsaW5rIGluIHRoZSBzaXRlIHN3aXRjaGVyIGRyb3Bkb3duCgogICAgICAkKCcudG9wLWJhciAucmVsYXRlZC1saW5rcycpLmZpbmQoJ2EnKS5lcSgwKS5yZXBsYWNlV2l0aCgnPGEgaHJlZj0iL2hlbHAvb24tdG9waWMiPm9uLXRvcGljPC9hPicpOwogICAgfSwKCiAgICBjdXN0b21NYWdpY0xpbmtzOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBBZGRzIGN1c3RvbSBtYWdpYyBsaW5rcyB0byB0aGUgcG9zdCBhbmQgY29tbWVudCBlZGl0b3JzCgogICAgICBjb25zdCBtYWdpY0xpbmtzID0gSlNPTi5wYXJzZShHTV9nZXRWYWx1ZSgnU09YLWN1c3RvbU1hZ2ljTGlua3MnLCAnW10nKSk7CiAgICAgIC8vIG1hZ2ljTGlua3MgPSBbIHsgdGV4dDogJ2VkaXQvcScsIHJlcGxhY2VtZW50OiAnRWRpdCBRdWVzdGlvbicsIGxpbms6ICckQkFTRVVSTCQvcG9zdHMvJFFVRVNUSU9OSUQkL2VkaXQnIH1dOwoKICAgICAgZnVuY3Rpb24gdXBkYXRlR01WYWx1ZShtYWdpY0xpbmtzKSB7CiAgICAgICAgR01fc2V0VmFsdWUoJ1NPWC1jdXN0b21NYWdpY0xpbmtzJywgSlNPTi5zdHJpbmdpZnkobWFnaWNMaW5rcykpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBnZW5lcmF0ZVNldHRpbmdzVGFibGVIdG1sKG1hZ2ljTGlua3MpIHsKICAgICAgICBjb25zdCAkbWFnaWNMaW5rc1RhYmxlID0gJChgCiAgICAgICAgPHRhYmxlIGNsYXNzPSdzb3gtY3VzdG9tTWFnaWNMaW5rcy1zZXR0aW5ncy10YWJsZSc+CiAgICAgICAgICA8dHI+CiAgICAgICAgICAgIDx0aD5UZXh0PC90aD4KICAgICAgICAgICAgPHRoPlJlcGxhY2VtZW50PC90aD4KICAgICAgICAgICAgPHRoPkxpbms8L3RoPgogICAgICAgICAgPC90cj4KICAgICAgICA8L3RhYmxlPmApOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFnaWNMaW5rcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgY3VycmVudExpbmsgPSBtYWdpY0xpbmtzW2ldOwogICAgICAgICAgY29uc3QgJHNhdmVCdXR0b24gPSAkKCc8YnV0dG9uLz4nLCB7CiAgICAgICAgICAgICd0ZXh0JzogJ3NhdmUnLAogICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgY29uc3QgJHBhcmVudFRyID0gJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKTsKICAgICAgICAgICAgICBjb25zdCBpbmRleCA9ICRwYXJlbnRUci5hdHRyKCdkYXRhLW1hZ2ljLWxpbmstaW5kZXgnKTsKICAgICAgICAgICAgICBtYWdpY0xpbmtzW2luZGV4XS50ZXh0ID0gJHBhcmVudFRyLmZpbmQoJy5tYWdpYy1saW5rLXRleHQnKS50ZXh0KCk7CiAgICAgICAgICAgICAgbWFnaWNMaW5rc1tpbmRleF0ucmVwbGFjZW1lbnQgPSAkcGFyZW50VHIuZmluZCgnLm1hZ2ljLWxpbmstcmVwbGFjZW1lbnQnKS50ZXh0KCk7CiAgICAgICAgICAgICAgbWFnaWNMaW5rc1tpbmRleF0ubGluayA9ICRwYXJlbnRUci5maW5kKCcubWFnaWMtbGluay1saW5rJykudGV4dCgpOwogICAgICAgICAgICAgIHdpbmRvdy5hbGVydCgnWW91ciBjaGFuZ2VzIHdlcmUgc2F2ZWQhJyk7CiAgICAgICAgICAgICAgdXBkYXRlR01WYWx1ZShtYWdpY0xpbmtzKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pOwogICAgICAgICAgY29uc3QgJGRlbGV0ZUJ1dHRvbiA9ICQoJzxidXR0b24vPicsIHsKICAgICAgICAgICAgJ3RleHQnOiAnZGVsZXRlJywKICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIG1hZ2ljTGlua3Muc3BsaWNlKCQodGhpcykucGFyZW50KCkuYXR0cignZGF0YS1tYWdpYy1saW5rLWluZGV4JyksIDEpOwogICAgICAgICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkucmVtb3ZlKCk7CiAgICAgICAgICAgICAgdXBkYXRlR01WYWx1ZShtYWdpY0xpbmtzKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pOwogICAgICAgICAgY29uc3QgJGxpbmtEZXRhaWxzID0gJCgKICAgICAgICAgICAgYDx0ciBjbGFzcz0nc294LW1hZ2ljLWxpbmstZGV0YWlscycgZGF0YS1tYWdpYy1saW5rLWluZGV4PSR7aX0+CiAgICAgICAgICAgICAgPHRkIGNvbnRlbnRlZGl0YWJsZSBjbGFzcz0nbWFnaWMtbGluay10ZXh0Jz4ke2N1cnJlbnRMaW5rLnRleHR9PC90ZD4KICAgICAgICAgICAgICA8dGQgY29udGVudGVkaXRhYmxlIGNsYXNzPSdtYWdpYy1saW5rLXJlcGxhY2VtZW50Jz4ke2N1cnJlbnRMaW5rLnJlcGxhY2VtZW50fTwvdGQ+CiAgICAgICAgICAgICAgPHRkIGNvbnRlbnRlZGl0YWJsZSBjbGFzcz0nbWFnaWMtbGluay1saW5rJz4ke2N1cnJlbnRMaW5rLmxpbmt9PC90ZD4KICAgICAgICAgICAgPC90cj5gKTsKICAgICAgICAgICRsaW5rRGV0YWlscy5hcHBlbmQoJCgnPHRkLz4nKS5hcHBlbmQoJHNhdmVCdXR0b24pKS5hcHBlbmQoJCgnPHRkLz4nKS5hcHBlbmQoJGRlbGV0ZUJ1dHRvbikpOwogICAgICAgICAgJG1hZ2ljTGlua3NUYWJsZS5hcHBlbmQoJGxpbmtEZXRhaWxzKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRtYWdpY0xpbmtzVGFibGU7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHJlcGxhY2VQbGFjZWhvbGRlcnModGV4dCwgJHRleHRhcmVhKSB7CiAgICAgICAgY29uc3QgYmFzZVVybCA9ICQobG9jYXRpb24pLmF0dHIoJ3Byb3RvY29sJykgKyAnLy8nICsgJChsb2NhdGlvbikuYXR0cignaG9zdG5hbWUnKTsKICAgICAgICBjb25zdCBsb2NhbE1ldGFCYXNlID0gJChsb2NhdGlvbikuYXR0cigncHJvdG9jb2wnKSArICcvL21ldGEuJyArICQobG9jYXRpb24pLmF0dHIoJ2hvc3RuYW1lJyk7CiAgICAgICAgY29uc3QgcXVlc3Rpb25JZCA9ICQoJy5xdWVzdGlvbicpLmRhdGEoJ3F1ZXN0aW9uaWQnKTsKICAgICAgICBjb25zdCBhbnN3ZXJJZCA9ICR0ZXh0YXJlYS5jbG9zZXN0KCcuYW5zd2VyJykuZGF0YSgnYW5zd2VyaWQnKTsKCiAgICAgICAgcmV0dXJuIHRleHQKICAgICAgICAgIC5yZXBsYWNlKC9cJEJBU0VVUkxcJC9pZywgYmFzZVVybCkKICAgICAgICAgIC5yZXBsYWNlKC9cJE1FVEFCQVNFVVJMXCQvaWcsIGxvY2FsTWV0YUJhc2UpCiAgICAgICAgICAucmVwbGFjZSgvXCRRVUVTVElPTklEXCQvaWcsIHF1ZXN0aW9uSWQpCiAgICAgICAgICAucmVwbGFjZSgvXCRBTlNXRVJJRFwkL2lnLCBhbnN3ZXJJZCk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIG1hZ2ljTGluaygkZWwpIHsKICAgICAgICBjb25zdCAkdGV4dGFyZWEgPSAkZWwuaXMoJ3RleHRhcmVhJykgPyAkZWwgOiAkZWwucGFyZW50cygnZm9ybScpLmZpbmQoJ3RleHRhcmVhJykuZXEoMCk7CiAgICAgICAgbGV0IG5ld1ZhbCA9ICR0ZXh0YXJlYS52YWwoKTsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hZ2ljTGlua3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRNYWdpY0xpbmsgPSBtYWdpY0xpbmtzW2ldOwogICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnRUZXh0ID0gY3VycmVudE1hZ2ljTGluay5yZXBsYWNlbWVudDsKICAgICAgICAgIGNvbnN0IHVybCA9IHJlcGxhY2VQbGFjZWhvbGRlcnMoY3VycmVudE1hZ2ljTGluay5saW5rLCAkdGV4dGFyZWEpOwogICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKCdcXFsnICsgY3VycmVudE1hZ2ljTGluay50ZXh0ICsgJ1xcXScsICdnJyk7CiAgICAgICAgICBuZXdWYWwgPSBuZXdWYWwucmVwbGFjZShyZWdleCwgJ1snICsgcmVwbGFjZW1lbnRUZXh0ICsgJ10oJyArIHVybCArICcpJyk7CiAgICAgICAgfQogICAgICAgICR0ZXh0YXJlYS52YWwobmV3VmFsKTsKICAgICAgfQoKICAgICAgaWYgKHNveC5zaXRlLmhyZWYuaW5kZXhPZignL3F1ZXN0aW9ucycpICE9PSAtMSkgewogICAgICAgICQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgJy5jb21tZW50LWZvcm0gdGV4dGFyZWEnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMykgbWFnaWNMaW5rKCQodGhpcykpOwogICAgICAgIH0pOwogICAgICAgICQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuY29tbWVudC1mb3JtIGlucHV0W3R5cGU9InN1Ym1pdCJdLCAuZm9ybS1zdWJtaXQgI3N1Ym1pdC1idXR0b24sIGZvcm0uaW5saW5lLXBvc3QgYnV0dG9uW2lkKj0ic3VibWl0LWJ1dHRvbi0iXScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIG1hZ2ljTGluaygkKHRoaXMpKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gY3JlYXRlU2V0dGluZ3NEaWFsb2cobWFnaWNMaW5rcykgewogICAgICAgIGNvbnN0ICRzZXR0aW5nc0RpYWxvZyA9IHNveC5oZWxwZXJzLmNyZWF0ZU1vZGFsKHsKICAgICAgICAgICdoZWFkZXInOiAnU09YOiBNYWdpYyBMaW5rIFNldHRpbmdzJywKICAgICAgICAgICdjc3MnOiB7CiAgICAgICAgICAgICdtaW4td2lkdGgnOiAnNTAlJywKICAgICAgICAgIH0sCiAgICAgICAgICAnaHRtbCc6ICc8aT50aGUgdGFibGUgY2VsbHMgYmVsb3cgYXJlIGVkaXRhYmxlOyBiZSBzdXJlIHRvIHNhdmUgYW55IGNoYW5nZXMhPC9pPjxicj48YnI+PGRpdiBjbGFzcz0idGFibGUtY29udGFpbmVyIj48L2Rpdj4nLAogICAgICAgIH0pOwogICAgICAgIGNvbnN0ICRzZXR0aW5nc0RpYWxvZ0NvbnRlbnQgPSAkc2V0dGluZ3NEaWFsb2cuZmluZCgnLnNveC1jdXN0b20tZGlhbG9nLWNvbnRlbnQnKTsKCiAgICAgICAgY29uc3QgJG5ld01hZ2ljTGlua0J1dHRvbiA9ICQoJzxidXR0b24vPicsIHsKICAgICAgICAgICd0ZXh0JzogJ25ldyBsaW5rJywKICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc3QgdGV4dCA9IHdpbmRvdy5wcm9tcHQoJ0VudGVyIHRoZSBtYWdpYyBsaW5rIHRleHQgKGUuZy4gZWRpdC9xKScpOwogICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHdpbmRvdy5wcm9tcHQoJ0VudGVyIHRoZSB0ZXh0IHlvdSB3b3VsZCBsaWtlIHRoZSBsaW5rIHRvIHNob3cgYXMgKGUuZy4gRWRpdCBRdWVzdGlvbiknKTsKICAgICAgICAgICAgY29uc3QgbGluayA9IHdpbmRvdy5wcm9tcHQoJ0VudGVyIHRoZSByZXBsYWNlbWVudCBsaW5rLCB1c2luZyB0aGUgcGxhY2Vob2xkZXJzIGFzIHJlcXVpcmVkJyk7CgogICAgICAgICAgICBpZiAodGV4dCAmJiByZXBsYWNlbWVudCAmJiBsaW5rKSB7CiAgICAgICAgICAgICAgbWFnaWNMaW5rcy5wdXNoKHsKICAgICAgICAgICAgICAgIHRleHQsCiAgICAgICAgICAgICAgICByZXBsYWNlbWVudCwKICAgICAgICAgICAgICAgIGxpbmssCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdXBkYXRlR01WYWx1ZShtYWdpY0xpbmtzKTsKICAgICAgICAgICAgICAkc2V0dGluZ3NEaWFsb2dDb250ZW50LmZpbmQoJy50YWJsZS1jb250YWluZXIgdGFibGUnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAkc2V0dGluZ3NEaWFsb2dDb250ZW50LmZpbmQoJy50YWJsZS1jb250YWluZXInKS5hcHBlbmQoZ2VuZXJhdGVTZXR0aW5nc1RhYmxlSHRtbChtYWdpY0xpbmtzKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KCdQbGVhc2UgZW50ZXIgZGV0YWlscyBmb3IgYWxsIHRocmVlIGZpZWxkcycpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgICAgICRzZXR0aW5nc0RpYWxvZ0NvbnRlbnQuZmluZCgnLnRhYmxlLWNvbnRhaW5lcicpLmFwcGVuZChnZW5lcmF0ZVNldHRpbmdzVGFibGVIdG1sKG1hZ2ljTGlua3MpKTsKICAgICAgICAkc2V0dGluZ3NEaWFsb2dDb250ZW50LmFwcGVuZCgkbmV3TWFnaWNMaW5rQnV0dG9uKTsKCiAgICAgICAgJCgnYm9keScpLmFwcGVuZCgkc2V0dGluZ3NEaWFsb2cpOwogICAgICB9CgogICAgICBzb3guaGVscGVycy5hZGRCdXR0b25Ub0hlbHBNZW51KHsKICAgICAgICAnaWQnOiAnbWFnaWNMaW5rc1NldHRpbmdzTGluaycsCiAgICAgICAgJ2xpbmtUZXh0JzogJ01hZ2ljIExpbmtzJywKICAgICAgICAnc3VtbWFyeSc6ICdFZGl0IHlvdXIgY3VzdG9tIG1hZ2ljIGxpbmtzJywKICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjcmVhdGVTZXR0aW5nc0RpYWxvZyhtYWdpY0xpbmtzKTsKICAgICAgICB9LAogICAgICB9KTsKICAgIH0sCgogICAgb3BlbkltYWdlc0FzTW9kYWxzOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBXaGVuIGNsaWNraW5nIG9uIGltZ3VyIGltYWdlcywgc2hvdyBhIGxhcmdlciB2ZXJzaW9uIGluIGEgbW9kYWwKCiAgICAgIGNvbnN0IG1vZGFsQXR0cmlidXRlcyA9IHsKICAgICAgICBoZWFkZXI6ICdTT1g6IExpbmtlZCBJbWFnZScsCiAgICAgICAgY3NzOiB7CiAgICAgICAgICAnbWluLXdpZHRoJzogJzkwJScsCiAgICAgICAgICAnbWluLWhlaWdodCc6ICc5MCUnLAogICAgICAgIH0sCiAgICAgICAgaWQ6ICdzb3gtbGlua2VkLWltYWdlLW1vZGFsJywKICAgICAgfTsKCiAgICAgIGZ1bmN0aW9uIHNob3dNb2RhbE9uY2xpY2soKSB7CiAgICAgICAgY29uc3QgcG9zdHMgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvc3QtdGV4dCBpbWcsIC5jb21tZW50LWNvcHkgaW1nJyldOwogICAgICAgIHBvc3RzLmZvckVhY2goaW1nID0+IHsKICAgICAgICAgIGlmICghaW1nLnNyYyB8fCAhaW1nLnNyYy5tYXRjaCgvaSg/Olwuc3RhY2spP1wuaW1ndXJcLmNvbVwvW2EtekEtWjAtOV0qXC5wbmckLykpIHJldHVybjsKCiAgICAgICAgICBpbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHsKICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAvLyBDcmVhdGUgbW9kYWwgb24gY2xpY2sgaW5zdGVhZCBvZiBvdXRzaWRlOyBtb2RhbCBpcyByZW1vdmVkIHdoZW4gY2xvc2VkCiAgICAgICAgICAgIC8vIHNvIHJlZmVyZW5jZSB3b3VsZCBiZWNvbWUgaW52YWxpZAogICAgICAgICAgICBtb2RhbEF0dHJpYnV0ZXMuaGVhZGVyID0gYFNPWDogTGlua2VkIEltYWdlIDxhIGNsYXNzPSdzb3gtb3BlbkltYWdlc0FzTW9kYWxzLXNvdXJjZUxpbmsnIHRhcmdldD0nX2JsYW5rJyByZWw9J25vb3BlbmVyIG5vcmVmZXJyZXInIGhyZWY9JyR7aW1nLnNyY30nPnNvdXJjZTwvYT5gOwogICAgICAgICAgICBjb25zdCAkbW9kYWwgPSBzb3guaGVscGVycy5jcmVhdGVNb2RhbChtb2RhbEF0dHJpYnV0ZXMpOwogICAgICAgICAgICAkbW9kYWwuZmluZCgnLnNveC1jdXN0b20tZGlhbG9nLWNvbnRlbnQnKS5odG1sKGA8aW1nIHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIHNyYz0nJHtpbWcuc3JjfScgLz5gKTsKICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc294LWxpbmtlZC1pbWFnZS1tb2RhbCcpKSAkKCdib2R5JykuYXBwZW5kKCRtb2RhbCk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgICBzZXRUaW1lb3V0KHNob3dNb2RhbE9uY2xpY2ssIDI1MDApOyAvLyBhdXRvU2hvd0NvbW1lbnRJbWFnZXMgcnVucyBhZnRlciAyIHNlY29uZHMsIHNvIHRoaXMgYWN0dWFsbHkgbmV2ZXIgZXhlY3V0ZXMhCiAgICB9LAoKICAgIGFkZFRhZ3NUb0hOUXM6IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IFNob3cgSE5RIHRhZ3Mgb24gaG92ZXIgaW4gdGhlIHNpZGViYXIKCiAgICAgIGNvbnN0IEZJTFRFUl9RVUVTVElPTl9UQUdTID0gJyEpNUlXLTVRdWYqY1Y1TFRvZShKMEJqU0JYVzE5JzsKICAgICAgY29uc3QgUExBQ0VIT0xERVIgPSAnZmV0Y2hpbmcgdGFncy4uLic7CgogICAgICBmdW5jdGlvbiBpbnNlcnRUYWdzTGlzdChhbmNob3IpIHsKICAgICAgICBpZiAoJChhbmNob3IpLnBhcmVudCgpLmZpbmQoJy5zb3gtaG5xLXF1ZXN0aW9uLXRhZ3MtdG9vbHRpcCcpLmxlbmd0aCkgcmV0dXJuOwogICAgICAgICQoYW5jaG9yKS5hZnRlcignPHNwYW4gY2xhc3M9InNveC1obnEtcXVlc3Rpb24tdGFncy10b29sdGlwIj4nICsgYW5jaG9yLmRhdGFzZXQudGFncyArICc8L3NwYW4+Jyk7CiAgICAgIH0KCiAgICAgICQoJyNob3QtbmV0d29yay1xdWVzdGlvbnMgaDQnKS5jc3MoJ2Rpc3BsYXknLCAnaW5saW5lJykuYWZ0ZXIoJCgnPHNwYW4vPicsIHsKICAgICAgICAnc3R5bGUnOiAnY29sb3I6ICBncmV5OyBkaXNwbGF5OiBibG9jazsgbWFyZ2luLWJvdHRvbTogMTBweDsnLAogICAgICAgICd0ZXh0JzogJ1NPWDogaG92ZXIgb3ZlciB0aXRsZXMgdG8gc2hvdyB0YWdzJywKICAgICAgfSkpOwoKICAgICAgWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNob3QtbmV0d29yay1xdWVzdGlvbnMgbGkgYScpXS5mb3JFYWNoKGVsID0+IHsKICAgICAgICBjb25zdCBpZCA9IHNveC5oZWxwZXJzLmdldElERnJvbUFuY2hvcihlbCk7CiAgICAgICAgY29uc3Qgc2l0ZW5hbWUgPSBzb3guaGVscGVycy5nZXRTaXRlTmFtZUZyb21BbmNob3IoZWwpOwoKICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gewogICAgICAgICAgaWYgKCFlbC5kYXRhc2V0LnRhZ3MpIHsKICAgICAgICAgICAgc294LmhlbHBlcnMuZ2V0RnJvbUFQSSh7CiAgICAgICAgICAgICAgZW5kcG9pbnQ6ICdxdWVzdGlvbnMnLAogICAgICAgICAgICAgIGlkczogaWQsCiAgICAgICAgICAgICAgc2l0ZW5hbWUsCiAgICAgICAgICAgICAgZmlsdGVyOiBGSUxURVJfUVVFU1RJT05fVEFHUywKICAgICAgICAgICAgICB1c2VDYWNoZTogZmFsc2UsIC8vIFNpbmdsZSBJRCwgc28gbm8gcG9pbnQKICAgICAgICAgICAgfSwgaXRlbXMgPT4gewogICAgICAgICAgICAgIGVsLmRhdGFzZXQudGFncyA9IGl0ZW1zWzBdLnRhZ3Muam9pbignLCAnKTsKICAgICAgICAgICAgICBpbnNlcnRUYWdzTGlzdChlbCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBlbC5kYXRhc2V0LnRhZ3MgPSBQTEFDRUhPTERFUjsKICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVsLmRhdGFzZXQudGFncyAhPT0gJ3VuZGVmaW5lZCcgJiYgZWwuZGF0YXNldC50YWdzICE9PSBQTEFDRUhPTERFUikgewogICAgICAgICAgICBpbnNlcnRUYWdzTGlzdChlbCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpbnNlcnRUYWdzTGlzdChlbCwgUExBQ0VIT0xERVIpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4gewogICAgICAgICAgY29uc3QgdG9vbHRpcCA9IGVsLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLnNveC1obnEtcXVlc3Rpb24tdGFncy10b29sdGlwJyk7CiAgICAgICAgICBpZiAodG9vbHRpcCkgdG9vbHRpcC5yZW1vdmUoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAoKICAgIHNjcm9sbENoYXRSb29tc0xpc3Q6IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gRGVzY3JpcHRpb246IEVuYWJsZSBzY3JvbGxpbmcgZm9yIHJvb20gbGlzdCBpbiB1c2VyY2FyZHMgYW5kIHNpZGViYXIgd2hlbiB0aGVyZSBhcmUgbWFueSByb29tcwoKICAgICAgJChkb2N1bWVudCkub24oJ3NveC1jaGF0LXVzZXItcG9wdXAnLCAoZSwgbm9kZSkgPT4gewogICAgICAgIGlmIChub2RlLmNsYXNzTGlzdC5jb250YWlucygnc294LXNjcm9sbENoYXRSb29tc0xpc3QtdXNlci1wb3B1cCcpKSByZXR1cm47CiAgICAgICAgbm9kZS5jbGFzc0xpc3QuYWRkKCdzb3gtc2Nyb2xsQ2hhdFJvb21zTGlzdC11c2VyLXBvcHVwJyk7CiAgICAgIH0pOwoKICAgICAgY29uc3Qgcm9vbXNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXktcm9vbXMnKS5wYXJlbnRFbGVtZW50OwogICAgICBpZiAocm9vbXNDb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzb3gtc2Nyb2xsQ2hhdFJvb21zTGlzdC1zaWRlYmFyJykpIHJldHVybjsKICAgICAgcm9vbXNDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnc294LXNjcm9sbENoYXRSb29tc0xpc3Qtc2lkZWJhcicpOwogICAgfSwKCiAgICBjb3B5Q29tbWVudE1hcmtkb3duOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIERlc2NyaXB0aW9uOiBBZGRzIGJ1dHRvbiB0byBjb3B5IHRoZSBtYXJrZG93biBvZiBhIGNvbW1lbnQgbmV4dCB0byB0aGVtCgogICAgICAkKCcuY29tbWVudC1ib2R5JykuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc3QgJGNvbW1lbnQgPSAkKHRoaXMpOwogICAgICAgIGNvbnN0ICRzb3hSZXBseUxpbmsgPSAkY29tbWVudC5maW5kKCcuc294UmVwbHlMaW5rJyk7CiAgICAgICAgY29uc3QgJGNvcHlCdG4gPSBzb3guc3ByaXRlcy5nZXRTdmcoJ2NvcHknLCAnU09YOiBjb3B5IGNvbW1lbnQgbWFya2Rvd24nLCB7CiAgICAgICAgICBjdXJzb3I6ICdwb2ludGVyJywKICAgICAgICAgIGRpc3BsYXk6ICdub25lJywKICAgICAgICB9KTsKCiAgICAgICAgY29uc3QgY29tbWVudElkID0gKyRjb21tZW50LnBhcmVudCgpLnBhcmVudCgpLmF0dHIoJ2RhdGEtY29tbWVudC1pZCcpOwogICAgICAgICRjb3B5QnRuLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHNveC5oZWxwZXJzLmdldEZyb21BUEkoewogICAgICAgICAgICBlbmRwb2ludDogJ2NvbW1lbnRzJywKICAgICAgICAgICAgaWRzOiBbY29tbWVudElkXSwKICAgICAgICAgICAgZmlsdGVyOiAnISpKeGJCNk42dyhMR1ZfSlInLAogICAgICAgICAgICBzaXRlbmFtZTogc294LnNpdGUudXJsLAogICAgICAgICAgICBmZWF0dXJlSWQ6ICdjb3B5Q29tbWVudE1hcmtkb3duJywKICAgICAgICAgICAgY2FjaGVEdXJhdGlvbjogMTAsIC8vIENhY2hlIGZvciAxMCBtaW51dGVzCiAgICAgICAgICB9LCBpdGVtcyA9PiB7CiAgICAgICAgICAgIGlmIChpdGVtc1swXSAmJiBpdGVtc1swXS5ib2R5X21hcmtkb3duKSB7CiAgICAgICAgICAgICAgR01fc2V0Q2xpcGJvYXJkKGl0ZW1zWzBdLmJvZHlfbWFya2Rvd24pOwogICAgICAgICAgICAgIHdpbmRvdy5hbGVydCgnQ29waWVkIGNvbW1lbnQgbWFya2Rvd24gdG8gY2xpcGJvYXJkIScpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHdpbmRvdy5hbGVydCgnVGhlcmUgd2FzIGFuIGVycm9yIGdldHRpbmcgdGhlIGNvbW1lbnQgbWFya2Rvd24uIFBsZWFzZSByYWlzZSBhbiBpc3N1ZSBvbiBHaXRIdWIhJyk7CiAgICAgICAgICAgICAgc294LmVycm9yKCdjb3B5Q29tbWVudE1hcmtkb3duOiBjb3VsZCBub3QgZ2V0IG1hcmtkb3duIGZyb20gQVBJLiBSZXR1cm5lZCBkYXRhIGZvciBjb21tZW50IElEICcgKyBjb21tZW50SWQgKycgd2FzJywgaXRlbXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKCRzb3hSZXBseUxpbmsubGVuZ3RoKSB7CiAgICAgICAgICAkc294UmVwbHlMaW5rLmJlZm9yZSgkY29weUJ0bik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICRjb21tZW50LmZpbmQoJ3NwYW4nKS5sYXN0KCkuYWZ0ZXIoJGNvcHlCdG4pOwogICAgICAgIH0KCiAgICAgICAgJGNvbW1lbnQuaG92ZXIoZnVuY3Rpb24gKCkgewogICAgICAgICAgJGNvcHlCdG4uc2hvdygpOwogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICRjb3B5QnRuLmhpZGUoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfTsKfSkod2luZG93LnNveCA9IHdpbmRvdy5zb3ggfHwge30sIGpRdWVyeSk7Cg=="}]},{"name":"Resize Image On \"Open image in new tab\"","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":["https://*.douban.com/view/ark_article_cover/*","https://*.doubanio.com/view/ark_article_cover/*"],"orig_includes":[],"orig_matches":["http://*.googleusercontent.com/*","https://*.googleusercontent.com/*","http://*.media.tumblr.com/*","https://*.media.tumblr.com/*","http://secure.static.tumblr.com/*","https://secure.static.tumblr.com/*","http://*.bp.blogspot.com/*","https://*.bp.blogspot.com/*","http://*.sinaimg.cn/*","https://*.sinaimg.cn/*","http://*.sinaimg.com/*","https://*.sinaimg.com/*","http://*.twimg.com/*","https://*.twimg.com/*","http://*.zhimg.com/*","https://*.zhimg.com/*","http://*.douban.com/view/*","https://*.douban.com/view/*","http://*.doubanio.com/view/*","https://*.doubanio.com/view/*","http://imgsrc.baidu.com/*","https://imgsrc.baidu.com/*","http://imgsa.baidu.com/*","https://imgsa.baidu.com/*","http://*.hiphotos.baidu.com/*","https://*.hiphotos.baidu.com/*","http://*.bdimg.com/*","https://*.bdimg.com/*","http://images.akamai.steamusercontent.com/*","https://images.akamai.steamusercontent.com/*","http://steamuserimages-a.akamaihd.net/*","https://steamuserimages-a.akamaihd.net/*","http://*.artstation.com/*","https://*.artstation.com/*","http://i.ytimg.com/*","https://i.ytimg.com/*","http://*.ggpht.com/*","https://*.ggpht.com/*","http://*.pinimg.com/*","https://*.pinimg.com/*","http://*.hdslb.com/*","https://*.hdslb.com/*","http://*.alicdn.com/*","https://*.alicdn.com/*"],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1609797443674,"data":{}},"enabled":true,"position":8,"file_url":"https://greasyfork.org/scripts/2312-resize-image-on-open-image-in-new-tab/code/Resize%20Image%20On%20%22Open%20image%20in%20new%20tab%22.user.js","uuid":"d84aef74-1a57-41ed-839c-0f5df5c7b18c","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgUmVzaXplIEltYWdlIE9uICJPcGVuIGltYWdlIGluIG5ldyB0YWIiCi8vIEBuYW1lOnpoLUNOIOWPs+mUruWcqOaWsOagh+etvuS4reaJk+W8gOWbvueJh+aXtuaYvuekuuacgOS8mOWMluWbvuWDj+i0qOmHjwovLyBAdmVyc2lvbiAgICAwLjYuNAovLyBAZGVzY3JpcHRpb24gIFN1cHBvcnQ6IEdvb2dsZShHKyBibG9nc3BvdCBZb3VUdWJlKVxUdW1ibHJcVHdpdHRlclxTdGVhbShPbmx5IHVzZXIgY29udGVudClcQXJ0U3RhdGlvblxQaW5pbWdcV2VpYm8gKEFuZCBtb3JlLi4uCi8vIEBkZXNjcmlwdGlvbjp6aC1DTiDmlK/mjIHvvJrosLfmrYwoRysgYmxvZ3Nwb3QgWW91VHViZSnjgIFUdW1ibHLjgIHmjqjnibnjgIFTdGVhbeOAgeaWsOa1quW+ruWNmuOAgeefpeS5juOAgeixhueTo+OAgeeZvuW6pui0tOWQp+OAgea3mOWune+8iOWkqeeMq++8ieOAgUFydFN0YXRpb27jgIFQaW5pbWcg562JCi8vIEBydW4tYXQgICAgIGRvY3VtZW50LXN0YXJ0Ci8vIEBncmFudCAgICAgIEdNX3htbGh0dHBSZXF1ZXN0Ci8vIEBncmFudCAgICAgIEdNX2Rvd25sb2FkCi8vIEBtYXRjaCAgICAgIGh0dHA6Ly8qLmdvb2dsZXVzZXJjb250ZW50LmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5nb29nbGV1c2VyY29udGVudC5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi5tZWRpYS50dW1ibHIuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cHM6Ly8qLm1lZGlhLnR1bWJsci5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vc2VjdXJlLnN0YXRpYy50dW1ibHIuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cHM6Ly9zZWN1cmUuc3RhdGljLnR1bWJsci5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi5icC5ibG9nc3BvdC5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovLyouYnAuYmxvZ3Nwb3QuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cDovLyouc2luYWltZy5jbi8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5zaW5haW1nLmNuLyoKLy8gQG1hdGNoICAgICAgaHR0cDovLyouc2luYWltZy5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovLyouc2luYWltZy5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi50d2ltZy5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovLyoudHdpbWcuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cDovLyouemhpbWcuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cHM6Ly8qLnpoaW1nLmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHA6Ly8qLmRvdWJhbi5jb20vdmlldy8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5kb3ViYW4uY29tL3ZpZXcvKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi5kb3ViYW5pby5jb20vdmlldy8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5kb3ViYW5pby5jb20vdmlldy8qCi8vIEBleGNsdWRlICAgIGh0dHBzOi8vKi5kb3ViYW4uY29tL3ZpZXcvYXJrX2FydGljbGVfY292ZXIvKgovLyBAZXhjbHVkZSAgICBodHRwczovLyouZG91YmFuaW8uY29tL3ZpZXcvYXJrX2FydGljbGVfY292ZXIvKgovLyBAbWF0Y2ggICAgICBodHRwOi8vaW1nc3JjLmJhaWR1LmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vaW1nc3JjLmJhaWR1LmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHA6Ly9pbWdzYS5iYWlkdS5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovL2ltZ3NhLmJhaWR1LmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHA6Ly8qLmhpcGhvdG9zLmJhaWR1LmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5oaXBob3Rvcy5iYWlkdS5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi5iZGltZy5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovLyouYmRpbWcuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cDovL2ltYWdlcy5ha2FtYWkuc3RlYW11c2VyY29udGVudC5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovL2ltYWdlcy5ha2FtYWkuc3RlYW11c2VyY29udGVudC5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vc3RlYW11c2VyaW1hZ2VzLWEuYWthbWFpaGQubmV0LyoKLy8gQG1hdGNoICAgICAgaHR0cHM6Ly9zdGVhbXVzZXJpbWFnZXMtYS5ha2FtYWloZC5uZXQvKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi5hcnRzdGF0aW9uLmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5hcnRzdGF0aW9uLmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHA6Ly9pLnl0aW1nLmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vaS55dGltZy5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwOi8vKi5nZ3BodC5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovLyouZ2dwaHQuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cDovLyoucGluaW1nLmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHBzOi8vKi5waW5pbWcuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cDovLyouaGRzbGIuY29tLyoKLy8gQG1hdGNoICAgICAgaHR0cHM6Ly8qLmhkc2xiLmNvbS8qCi8vIEBtYXRjaCAgICAgIGh0dHA6Ly8qLmFsaWNkbi5jb20vKgovLyBAbWF0Y2ggICAgICBodHRwczovLyouYWxpY2RuLmNvbS8qCi8vIEBuYW1lc3BhY2UgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy91c2Vycy8yNjQ2Ci8vIEBjb250cmlidXRpb25VUkwgaHR0cDovL2Nsc28udGsvZG9uYXRlLwovLyBAY29udHJpYnV0aW9uQW1vdW50IDYuNjYKLy8gQGNvcHlyaWdodCAgMjAxNC0yMDE4LCBDTEUKLy8gPT0vVXNlclNjcmlwdD09Cgp2YXIgdXJsID0gZG9jdW1lbnQubG9jYXRpb24udG9TdHJpbmcoKTsKdmFyIG0gPSBudWxsOwoKZnVuY3Rpb24gZ2V0UXVlcnlQYXJhbXMocXMpIHsKICAgIC8vYnkgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTA5OTY3MAogICAgcXMgPSBxcy5zcGxpdCgnKycpLmpvaW4oJyAnKTsKICAgIHZhciBwYXJhbXMgPSB7fSwKICAgICAgICB0b2tlbnMsCiAgICAgICAgcmUgPSAvWz8mXT8oW149XSspPShbXiZdKikvZzsKICAgIHdoaWxlICgodG9rZW5zID0gcmUuZXhlYyhxcykpKSB7CiAgICAgICAgcGFyYW1zW2RlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMV0pXSA9IGRlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMl0pOwogICAgfQogICAgcmV0dXJuIHBhcmFtczsKfQoKLy9nb29nbGUKaWYoIChtID0gdXJsLm1hdGNoKC9eKGh0dHBzPzpcL1wvbGhcZCtcLmdvb2dsZXVzZXJjb250ZW50XC5jb21cLy4rXC8pKFteXC9dKykoXC9bXlwvXSsoXC4oanBnfGpwZWd8Z2lmfHBuZ3xibXB8d2VicCkpPykoPzpcPy4rKT8kL2kpKSApIHsKCWlmKG1bMl0gIT0gInMwIikgewoJCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXSArICJzMCIgKyBtWzNdOwoJfQp9CmVsc2UgaWYoIChtID0gdXJsLm1hdGNoKC9eKGh0dHBzPzpcL1wvbGhcZCtcLmdvb2dsZXVzZXJjb250ZW50XC5jb21cLy4rPSkoLispKD86XD8uKyk/JC9pKSkgKSB7CglpZihtWzJdICE9ICJzMCIpIHsKCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAiczAiOwoJfQp9CmVsc2UgaWYoIChtID0gdXJsLm1hdGNoKC9eKGh0dHBzPzpcL1wvXHcrXC5nZ3BodFwuY29tXC8uK1wvKShbXlwvXSspKFwvW15cL10rKFwuKGpwZ3xqcGVnfGdpZnxwbmd8Ym1wfHdlYnApKT8pKD86XD8uKyk/JC9pKSkgKSB7CglpZihtWzJdICE9ICJzMCIpIHsKCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAiczAiICsgbVszXTsKCX0KfQoKLy9ibG9nc3BvdAplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cL1x3K1wuYnBcLmJsb2dzcG90XC5jb21cLy4rXC8pKFteXC9dKykoXC9bXlwvXSsoXC4oanBnfGpwZWd8Z2lmfHBuZ3xibXB8d2VicCkpPykoPzpcPy4rKT8kL2kpKSApIHsKCWlmKG1bMl0gIT0gInMwIikgewoJCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXSArICJzMCIgKyBtWzNdOwoJfQp9CgovL3lvdXR1YmUKZWxzZSBpZiggKG0gPSB1cmwubWF0Y2goL15odHRwcz86XC9cL2lcLnl0aW1nLmNvbVwvYW5fd2VicFwvKFteXC9dKylcL1x3K1wuKGpwZ3xqcGVnfGdpZnxwbmd8Ym1wfHdlYnApKFw/LispPyQvaSkpICkgewoJdmFyIGFqYXggPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCWFqYXgub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkgewoJCWlmKGFqYXguc3RhdHVzPT0yMDApIHsKCQkJZG9jdW1lbnQubG9jYXRpb24gPSAiaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS8iICsgbVsxXSArICIvbWF4cmVzZGVmYXVsdC5qcGciOwoJCX1lbHNlIGlmKGFqYXguc3RhdHVzPT00MDQpIHsKCQkJZG9jdW1lbnQubG9jYXRpb24gPSAiaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS8iICsgbVsxXSArICIvaHFkZWZhdWx0LmpwZyI7CgkJfQoJfTsKCWFqYXgub3BlbigiSEVBRCIsICJodHRwczovL2kueXRpbWcuY29tL3ZpLyIgKyBtWzFdICsgIi9tYXhyZXNkZWZhdWx0LmpwZyIsIHRydWUpOwoJYWpheC5zZW5kKCk7Cn0KZWxzZSBpZiggKG0gPSB1cmwubWF0Y2goL14oaHR0cHM/OlwvXC9pXC55dGltZy5jb21cL3ZpXC9bXlwvXStcLykoXHcrKShcLihqcGd8anBlZ3xnaWZ8cG5nfGJtcHx3ZWJwKSkoXD8uKyk/JC9pKSkgKSB7CglpZihtWzJdICE9ICJtYXhyZXNkZWZhdWx0IikgewoJCXZhciBhamF4ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CgkJYWpheC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKSB7CgkJCWlmKGFqYXguc3RhdHVzPT0yMDApIHsKCQkJCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXSArICJtYXhyZXNkZWZhdWx0IiArIG1bM107CgkJCX1lbHNlIGlmKGFqYXguc3RhdHVzPT00MDQpIHsKCQkJCWlmKG1bNV0gfHwgbVsyXSA9PT0gIm1xZGVmYXVsdCIpCgkJCQkJZG9jdW1lbnQubG9jYXRpb24gPSBtWzFdICsgImhxZGVmYXVsdCIgKyBtWzNdOwoJCQl9CgkJfTsKCQlhamF4Lm9wZW4oIkhFQUQiLCBtWzFdICsgIm1heHJlc2RlZmF1bHQiICsgbVszXSwgdHJ1ZSk7CgkJYWpheC5zZW5kKCk7Cgl9Cn0KZWxzZSBpZiggKG0gPSB1cmwubWF0Y2goL14oaHR0cHM/OlwvXC9cdytcLmdncGh0XC5jb21cLy4rKT0oPzpbc3x3fGhdKShcZCspKC4rKT8kL2kpKSApIHsKCWlmKCBtWzJdIT0iMCIgKXsKCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAiPXMwIjsKCX0KfQoKLy90dW1ibHIgZGlzYWJsZWQgcmF3IGltYWdlcyBub3cgOigKZWxzZSBpZiggKG0gPSB1cmwubWF0Y2goL14oaHR0cHM/OlwvXC9cZCtcLm1lZGlhXC50dW1ibHJcLmNvbVwvLip0dW1ibHJfXHcrXykoXGQrKShcLihqcGd8anBlZ3xnaWZ8cG5nfGJtcHx3ZWJwKSkoPzpcPy4rKT8kL2kpKSApIHsKCWlmKG1bMl08MTI4MCkgewoJCXZhciBhamF4ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CgkJYWpheC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZnVuY3Rpb24oKSB7CgkJCWlmKGFqYXguc3RhdHVzPT0yMDApIHsKCQkJCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXSArICIxMjgwIiArIG1bM107CgkJCX0KCQl9OwoJCWFqYXgub3BlbigiSEVBRCIsIG1bMV0rIjEyODAiK21bM10sIHRydWUpOwoJCWFqYXguc2VuZCgpOwoJfQp9CgovL3R3aXR0ZXIKZWxzZSBpZiggKG0gPSB1cmwubWF0Y2goL14oaHR0cHM/OlwvXC9cdytcLnR3aW1nXC5jb21cL21lZGlhXC9bXlwvOl0rKVwuKGpwZ3xqcGVnfGdpZnxwbmd8Ym1wfHdlYnApKDpcdyspPyQvaSkpICkgewoJdmFyIGZvcm1hdCA9IG1bMl07IGlmKG1bMl09PSJqcGVnIikgZm9ybWF0ID0gImpwZyI7Cglkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAiP2Zvcm1hdD0iICsgZm9ybWF0ICsgIiZuYW1lPW9yaWciOwp9CmVsc2UgaWYoIChtID0gdXJsLm1hdGNoKC9eKGh0dHBzPzpcL1wvXHcrXC50d2ltZ1wuY29tXC8uKykoXD8uKykkL2kpKSApIHsKCXZhciBwYXJzID0gZ2V0UXVlcnlQYXJhbXMoZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoKTsKCWlmKCFwYXJzLmZvcm1hdCB8fCAhcGFycy5uYW1lKSByZXR1cm47CglpZihwYXJzLm5hbWUgPT0gIm9yaWciKSByZXR1cm47Cglkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAiP2Zvcm1hdD0iICsgcGFycy5mb3JtYXQgKyAiJm5hbWU9b3JpZyI7Cn0KCi8vU3RlYW0gKE9ubHkgdXNlciBjb250ZW50KQplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cLyhpbWFnZXNcLmFrYW1haVwuc3RlYW11c2VyY29udGVudFwuY29tfHN0ZWFtdXNlcmltYWdlcy1hXC5ha2FtYWloZFwubmV0KVwvW15cP10rKVw/LiskL2kpKSApewoJZG9jdW1lbnQubG9jYXRpb24gPSBtWzFdOwp9CgovL+aAp+a1quW+ruWNmgplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cLyg/Oig/Ond3fHd4fHdzfHR2YXh8dHZhKVxkK3x3eHR8d3QpXC5zaW5haW1nXC4oPzpjbnxjb20pXC8pKFtcd1wuXSspKFwvLispKD86XD8uKyk/JC9pKSkgKSB7CglpZihtWzJdICE9ICJsYXJnZSIpIHsKCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAibGFyZ2UiICsgbVszXTsKCX0KfQoKLy96aGlodQplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cLy4rXC56aGltZ1wuY29tXC8pKD86XGQrXC8pPyhbXHdcLV0rXykoXHcrKShcLihqcGd8anBlZ3xnaWZ8cG5nfGJtcHx3ZWJwKSkoPzpcPy4rKT8kL2kpKSApewoJaWYobVszXSE9InIiKSB7CgkJZG9jdW1lbnQubG9jYXRpb24gPSBtWzFdICsgbVsyXSArICJyIiArIG1bNF07Cgl9Cn0KCi8vZG91YmFuIE5FRUQgVEVTVAplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cL1x3K1wuZG91YmFuKD86aW8pP1wuY29tXC92aWV3XC8uK1wvKShcdyspKFwvcHVibGljXC8uK1wuKGpwZ3xqcGVnfGdpZnxwbmd8Ym1wfHdlYnApKSg/Olw/LispPyQvaSkpICl7CglpZihtWzJdICE9ICJyIil7CgkJdmFyIGFqYXggPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKCQlhamF4Lm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpIHsKCQkJaWYoYWpheC5zdGF0dXM9PTIwMCkgewoJCQkJZG9jdW1lbnQubG9jYXRpb24gPSBtWzFdICsgInIiICsgbVszXTsKCQkJfSBlbHNlIGlmIChhamF4LnN0YXR1cz09NDA0KXsKCQkJCWlmKG1bMl0gIT0gImwiKSBkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAibCIgKyBtWzNdOwoJCQl9CgkJfTsKCQlhamF4Lm9wZW4oIkhFQUQiLCBtWzFdICsgInIiICsgbVszXSwgdHJ1ZSk7CgkJYWpheC5zZW5kKCk7Cgl9Cn0KCi8vYXJ0c3RhdGlvbgplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cL2Nkblx3K1wuYXJ0c3RhdGlvblwuY29tXC8uK1wvKShcZHs0LH1cLykoXHcrKShcL1teXC9dKykkL2kpKSApewoJaWYobVszXSAhPSAib3JpZ2luYWwiKXsKCQl2YXIgYWpheCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwoJCWFqYXgub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkgewoJCQlpZihhamF4LnN0YXR1cz09MjAwKSB7CgkJCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAib3JpZ2luYWwiICsgbVs0XTsKCQkJfWVsc2UgaWYoYWpheC5zdGF0dXM9PTQwNCkgewoJCQkJaWYobVszXSAhPSAibGFyZ2UiKXsKCQkJCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAibGFyZ2UiICsgbVs0XTsKCQkJCX0KCQkJfQoJCX07CgkJYWpheC5vcGVuKCJIRUFEIiwgbVsxXSsib3JpZ2luYWwiK21bM10sIHRydWUpOwoJCWFqYXguc2VuZCgpOwoJfQp9CmVsc2UgaWYoIChtID0gdXJsLm1hdGNoKC9eKGh0dHBzPzpcL1wvY2RuXHcrXC5hcnRzdGF0aW9uXC5jb21cLy4rXC8pKFx3KykoXC9bXlwvXSspJC9pKSkgKXsKCS8vaWYobVsyXSAhPSAib3JpZ2luYWwiKSB7CgkvLwlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAib3JpZ2luYWwiICsgbVszXTsKCS8vfQoJaWYobVsyXSAhPSAib3JpZ2luYWwiKXsKCQl2YXIgYWpheCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwoJCWFqYXgub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCkgewoJCQlpZihhamF4LnN0YXR1cz09MjAwKSB7CgkJCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAib3JpZ2luYWwiICsgbVszXTsKCQkJfWVsc2UgaWYoYWpheC5zdGF0dXM9PTQwNCkgewoJCQkJaWYobVsyXSAhPSAibGFyZ2UiKXsKCQkJCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAibGFyZ2UiICsgbVszXTsKCQkJCX0KCQkJfQoJCX07CgkJYWpheC5vcGVuKCJIRUFEIiwgbVsxXSsib3JpZ2luYWwiK21bM10sIHRydWUpOwoJCWFqYXguc2VuZCgpOwoJfQp9CgovL3BpbmltZwplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cL2lcLnBpbmltZ1wuY29tXC8pKFx3KykoXC8uKykkL2kpKSApewoJaWYobVsyXSAhPSAib3JpZ2luYWxzIikgewoJCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXSArICJvcmlnaW5hbHMiICsgbVszXTsKCX0KfQplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cL3MtbWVkaWFbXHctXStcLnBpbmltZ1wuY29tXC8pKFx3KykoXC8uKykkL2kpKSApeyAvL25lZWQgZGVsZXRlPwoJaWYobVsyXSAhPSAib3JpZ2luYWxzIikgewoJCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXSArICJvcmlnaW5hbHMiICsgbVszXTsKCX0KfQoKLy9iaWxpYmlsaQplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cL1x3K1wuaGRzbGJcLmNvbVwvLitcLihqcGd8anBlZ3xnaWZ8cG5nfGJtcHx3ZWJwKSkoQHxfKS4rJC9pKSkgKSB7Cglkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV07Cn0KCi8vdGFvYmFvKHRtYWxsKQplbHNlIGlmKCAobSA9IHVybC5tYXRjaCgvXihodHRwcz86XC9cLyg/OmltZ3xnbWEpXC5hbGljZG5cLmNvbVwvLitcLihqcGd8anBlZ3xnaWZ8cG5nfGJtcHx3ZWJwKSlfLiskL2kpKSApIHsKCWRvY3VtZW50LmxvY2F0aW9uID0gbVsxXTsKfQoKCgovL+eZvuW6pui0tOWQp++8iOeEtuiAjOWvueS6jueUu+i0qOaPkOWNh+S7gOS5iOeahOW5tuayoeacieS7gOS5iOWNteeUqC4uLu+8iQplbHNlIGlmKCAhKG0gPSB1cmwubWF0Y2goL15odHRwcz86XC9cL2ltZ3NyY1wuYmFpZHVcLmNvbVwvZm9ydW1cL3BpY1wvaXRlbVwvLisvaSkpICl7CglpZiggKG0gPSB1cmwubWF0Y2goL14oaHR0cHM/KTpcL1wvKD86aW1nc3JjfGltZ3NhfFx3K1wuaGlwaG90b3MpXC4oPzpiZGltZ3xiYWlkdSlcLmNvbVwvKD86Zm9ydW18YWxidW0pXC8uK1wvKFx3K1wuKD86anBnfGpwZWd8Z2lmfHBuZ3xibXB8d2VicCkpKD86XD8uKyk/JC9pKSkgKXsKCQlkb2N1bWVudC5sb2NhdGlvbiA9IG1bMV0gKyAiOi8vaW1nc3JjLmJhaWR1LmNvbS9mb3J1bS9waWMvaXRlbS8iICsgbVsyXTsKCX0KfQo="}]}